/*! For license information please see 258.31d76f80.js.LICENSE.txt */
(self.webpackChunkcn_coursework=self.webpackChunkcn_coursework||[]).push([["258"],{700:function(){},779:function(e,t,r){var i,n;function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(3>arguments.length?e:r):n.value}}).apply(this,arguments)}function o(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,i=c(e);return r=t?Reflect.construct(i,arguments,c(this).constructor):i.apply(this,arguments),h(this,r)}}function h(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){return g(e)||S(e)||_(e)||p()}function f(e,t){return g(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s=[],o=!0,a=!1;try{for(r=r.call(e);!(o=(i=r.next()).done)&&(s.push(i.value),!(t&&s.length===t));o=!0);}catch(e){a=!0,n=e}finally{try{o||null==r.return||r.return()}finally{if(a)throw n}}return s}}(e,t)||_(e,t)||p()}function p(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e){if(Array.isArray(e))return e}function m(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function v(e,t){for(var r,i=0;i<t.length;i++)(r=t[i]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function b(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e){return function(e){if(Array.isArray(e))return w(e)}(e)||S(e)||_(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}function S(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}i=this,n=function(){var e,t,i,n=Math.abs,a=String.fromCharCode,p=Math.floor;function g(e){return g[e]}return g["../../package.json"]={name:"coffeescript",description:"Unfancy JavaScript",keywords:["javascript","language","coffeescript","compiler"],author:"Jeremy Ashkenas",version:"2.7.0",license:"MIT",engines:{node:">=6"},directories:{lib:"./lib/coffeescript"},main:"./lib/coffeescript/index",module:"./lib/coffeescript-browser-compiler-modern/coffeescript.js",browser:"./lib/coffeescript-browser-compiler-legacy/coffeescript.js",bin:{coffee:"./bin/coffee",cake:"./bin/cake"},files:["bin","lib","register.js","repl.js"],scripts:{test:"node ./bin/cake test","test-harmony":"node --harmony ./bin/cake test"},homepage:"https://coffeescript.org",bugs:"https://github.com/jashkenas/coffeescript/issues",repository:{type:"git",url:"git://github.com/jashkenas/coffeescript.git"},devDependencies:{"@babel/core":"~7.17.8","@babel/preset-env":"~7.16.11","babel-preset-minify":"~0.5.1",codemirror:"~5.65.2",docco:"~0.9.1","highlight.js":"~11.5.0",jison:"~0.4.18","markdown-it":"~12.3.2",puppeteer:"~13.5.2",underscore:"~1.13.2",webpack:"~5.71.0"}},g["./helpers"]=function(){var e={};return(function(){var t,r,i,n,s,o,a,l,h,u,c,d,f,g,m,v=[].indexOf;e.starts=function(e,t,r){return t===e.substr(r,t.length)},e.ends=function(e,t,r){var i;return i=t.length,t===e.substr(e.length-i-(r||0),i)},e.repeat=f=function(e,t){var r;for(r="";0<t;)1&t&&(r+=e),t>>>=1,e+=e;return r},e.compact=function(e){var t,r,i,n;for(n=[],t=0,i=e.length;t<i;t++)(r=e[t])&&n.push(r);return n},e.count=function(e,t){var r,i;if(r=i=0,!t.length)return 1/0;for(;i=1+e.indexOf(t,i);)r++;return r},e.merge=function(e,t){return a(a({},e),t)},a=e.extend=function(e,t){var r,i;for(r in t)i=t[r],e[r]=i;return e},e.flatten=l=function(e){var t,r,i,n;for(r=[],i=0,n=e.length;i<n;i++)t=e[i],"[object Array]"===Object.prototype.toString.call(t)?r=r.concat(l(t)):r.push(t);return r},e.del=function(e,t){var r;return r=e[t],delete e[t],r},e.some=null==(d=Array.prototype.some)?function(e){var t,r;for(t=0,r=this.length;t<r;t++)if(e(this[t]))return!0;return!1}:d,e.invertLiterate=function(e){var t,r,i,n,s,o,a,l,h;for(l=[],t=/^\s*$/,i=/^[\t ]/,a=/^(?:\t?| {0,3})(?:[\*\-\+]|[0-9]{1,9}\.)[ \t]/,n=!1,h=e.split("\n"),r=0,s=h.length;r<s;r++)o=h[r],t.test(o)?(n=!1,l.push(o)):n||a.test(o)?(n=!0,l.push("# ".concat(o))):!n&&i.test(o)?l.push(o):(n=!0,l.push("# ".concat(o)));return l.join("\n")},n=function(e,t){return t?{first_line:e.first_line,first_column:e.first_column,last_line:t.last_line,last_column:t.last_column,last_line_exclusive:t.last_line_exclusive,last_column_exclusive:t.last_column_exclusive,range:[e.range[0],t.range[1]]}:e},e.extractAllCommentTokens=function(e){var t,r,i,n,s,o,a,l,h,u,c,d,f;for(t={},i=0,a=e.length;i<a;i++)if((f=e[i]).comments)for(u=f.comments,n=0,l=u.length;n<l;n++)t[(r=u[n]).locationData.range[0]]=r;for(d=Object.keys(t).sort(function(e,t){return e-t}),c=[],s=0,h=d.length;s<h;s++)o=d[s],c.push(t[o]);return c},s=function(e){return"".concat(e.range[0],"-").concat(e.range[1])},e.buildTokenDataDictionary=o=function(e){var t,r,i,n,o,a,l;for(o={},r=0,i=e.length;r<i;r++)(n=e[r]).comments&&(null==o[a=s(n[2])]&&(o[a]={}),n.comments)&&(l=null==(t=o[a]).comments?t.comments=[]:t.comments).push.apply(l,x(n.comments));return o},e.addDataToNode=function(e,t,r,a,l){var h=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];return function(u){var c,d,f,p,g;return c=n(null==(f=null==r?void 0:r.locationData)?t:f,null==(p=null==l?void 0:l.locationData)?a:p),null!=(null==u?void 0:u.updateLocationDataIfMissing)&&null!=t?u.updateLocationDataIfMissing(c,h):u.locationData=c,null==e.tokenData&&(e.tokenData=o(e.parser.tokens)),null!=u.locationData&&(d=s(u.locationData),null!=(null==(g=e.tokenData[d])?void 0:g.comments)&&i(e.tokenData[d].comments,u)),u}},e.attachCommentsToNode=i=function(e,t){var r;if(null!=e&&0!==e.length)return null==t.comments&&(t.comments=[]),(r=t.comments).push.apply(r,x(e))},e.locationDataToString=function(e){var t;return"2"in e&&"first_line"in e[2]?t=e[2]:"first_line"in e&&(t=e),t?"".concat(t.first_line+1,":").concat(t.first_column+1,"-")+"".concat(t.last_line+1,":").concat(t.last_column+1):"No location data"},e.anonymousFileName=(t=0,function(){return"<anonymous-".concat(t++,">")}),e.baseFileName=function(e){var t,r,i=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return(r=n?/\\|\//:/\//,e=(t=e.split(r))[t.length-1],i&&0<=e.indexOf("."))?((t=e.split(".")).pop(),"coffee"===t[t.length-1]&&1<t.length&&t.pop(),t.join(".")):e},e.isCoffee=function(e){return/\.((lit)?coffee|coffee\.md)$/.test(e)},e.isLiterate=function(e){return/\.(litcoffee|coffee\.md)$/.test(e)},e.throwSyntaxError=function(e,t){var r;throw(r=SyntaxError(e)).location=t,r.toString=g,r.stack=r.toString(),r},e.updateSyntaxError=function(e,t,r){return e.toString===g&&(e.code||(e.code=t),e.filename||(e.filename=r),e.stack=e.toString()),e},g=function(){if(!(this.code&&this.location))return Error.prototype.toString.call(this);var e,t,r,i,n,s,o,a,l,h,u,c,d,p,g=this.location;return o=g.first_line,s=g.first_column,l=g.last_line,a=g.last_column,null==l&&(l=o),null==a&&(a=s),n=(null==(u=this.filename)?void 0:u.startsWith("<anonymous"))?"[stdin]":this.filename||"[stdin]",e=this.code.split("\n")[o],i=o===l?a+1:e.length,h=e.slice(0,s).replace(/[^\s]/g," ")+f("^",i-s),"undefined"!=typeof process&&null!==process&&(r=(null==(c=process.stdout)?void 0:c.isTTY)&&(null==(d=process.env)||!d.NODE_DISABLE_COLORS)),(null==(p=this.colorful)?r:p)&&(t=function(e){return"\x1b[1;31m".concat(e,"\x1b[0m")},e=e.slice(0,s)+t(e.slice(s,i))+e.slice(i),h=t(h)),"".concat(n,":").concat(o+1,":").concat(s+1,": error: ").concat(this.message,"\n").concat(e,"\n").concat(h)},e.nameWhitespaceCharacter=function(e){return" "===e?"space":"\n"===e?"newline":"\r"===e?"carriage return":"	"===e?"tab":e},e.parseNumber=function(e){var t;return null==e?0/0:null==(t=function(){switch(e.charAt(1)){case"b":return 2;case"o":return 8;case"x":return 16;default:return null}}())?parseFloat(e.replace(/_/g,"")):parseInt(e.slice(2).replace(/_/g,""),t)},e.isFunction=function(e){return"[object Function]"===Object.prototype.toString.call(e)},e.isNumber=u=function(e){return"[object Number]"===Object.prototype.toString.call(e)},e.isString=c=function(e){return"[object String]"===Object.prototype.toString.call(e)},e.isBoolean=h=function(e){return!0===e||!1===e||"[object Boolean]"===Object.prototype.toString.call(e)},e.isPlainObject=function(e){return"object"===y(e)&&!!e&&!Array.isArray(e)&&!u(e)&&!c(e)&&!h(e)},m=function(e){var t,r,i;return(i=function(e){var t;return t=e.toString(16),"\\u".concat(f("0",4-t.length)).concat(t)},65536>e)?i(e):(t=p((e-65536)/1024)+55296,r=(e-65536)%1024+56320,"".concat(i(t)).concat(i(r)))},e.replaceUnicodeCodePointEscapes=function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=i.flags,s=i.error,o=i.delimiter,a=void 0===o?"":o;return t=null!=n&&0>v.call(n,"u"),e.replace(r,function(e,r,i,n){var o;return r||(1114111<(o=parseInt(i,16))&&s("unicode code point escapes greater than \\u{10ffff} are not allowed",{offset:n+a.length,length:i.length+4}),t?m(o):e)})},r=/(\\\\)|\\u\{([\da-fA-F]+)\}/g}).call(this),e}(),g["./rewriter"]=function(){var e={};return(function(){var t,r,i,n,s,o,a,l,h,u,c,d,p,v,y,_,S,w,T,P,E,C,A,I,M,R=[].indexOf,O={}.hasOwnProperty,k=g("./helpers");for(M=k.throwSyntaxError,w=k.extractAllCommentTokens,A=function(e,t){var r,i,n,s,o;if(e.comments){if(t.comments&&0!==t.comments.length){for(o=[],s=e.comments,i=0,n=s.length;i<n;i++)(r=s[i]).unshift?o.push(r):t.comments.push(r);t.comments=o.concat(t.comments)}else t.comments=e.comments;return delete e.comments}},T=function(e,t,r,i){var n;return(n=[e,t]).generated=!0,r&&(n.origin=r),i&&A(i,n),n},e.Rewriter=(function(){var e=function(){"use strict";function e(){m(this,e)}return b(e,[{key:"rewrite",value:function(e){var t,r,i;return this.tokens=e,("undefined"!=typeof process&&null!==process?null==(t=process.env)?void 0:t.DEBUG_TOKEN_STREAM:void 0)&&(process.env.DEBUG_REWRITTEN_TOKEN_STREAM&&console.log("Initial token stream:"),console.log((function(){var e,t,r,n;for(r=this.tokens,n=[],e=0,t=r.length;e<t;e++)i=r[e],n.push(i[0]+"/"+i[1]+(i.comments?"*":""));return n}).call(this).join(" "))),this.removeLeadingNewlines(),this.closeOpenCalls(),this.closeOpenIndexes(),this.normalizeLines(),this.tagPostfixConditionals(),this.addImplicitBracesAndParens(),this.rescueStowawayComments(),this.addLocationDataToGeneratedTokens(),this.enforceValidJSXAttributes(),this.fixIndentationLocationData(),this.exposeTokenDataToGrammar(),("undefined"!=typeof process&&null!==process?null==(r=process.env)?void 0:r.DEBUG_REWRITTEN_TOKEN_STREAM:void 0)&&(process.env.DEBUG_TOKEN_STREAM&&console.log("Rewritten token stream:"),console.log((function(){var e,t,r,n;for(r=this.tokens,n=[],e=0,t=r.length;e<t;e++)i=r[e],n.push(i[0]+"/"+i[1]+(i.comments?"*":""));return n}).call(this).join(" "))),this.tokens}},{key:"scanTokens",value:function(e){var t,r,i;for(i=this.tokens,t=0;r=i[t];)t+=e.call(this,r,t,i);return!0}},{key:"detectEnd",value:function(e,t,r){var i,n,s,l,h,u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};for(h=this.tokens,i=0;l=h[e];){if(0===i&&t.call(this,l,e))return r.call(this,l,e);if((n=l[0],0<=R.call(a,n))?i+=1:(s=l[0],0<=R.call(o,s)&&(i-=1)),0>i)return u.returnOnNegativeLevel?void 0:r.call(this,l,e);e+=1}return e-1}},{key:"removeLeadingNewlines",value:function(){var e,t,r,i,n,s,o;for(s=this.tokens,e=t=0,i=s.length;t<i&&"TERMINATOR"===f(s[e],1)[0];e=++t);if(0!==e){for(o=this.tokens.slice(0,e),r=0,n=o.length;r<n;r++)A(o[r],this.tokens[e]);return this.tokens.splice(0,e)}}},{key:"closeOpenCalls",value:function(){var e,t;return t=function(e){var t;return")"===(t=e[0])||"CALL_END"===t},e=function(e){return e[0]="CALL_END"},this.scanTokens(function(r,i){return"CALL_START"===r[0]&&this.detectEnd(i+1,t,e),1})}},{key:"closeOpenIndexes",value:function(){var e,t,r;return r=null,t=function(e){var t;return"]"===(t=e[0])||"INDEX_END"===t},e=function(e,t){return this.tokens.length>=t&&":"===this.tokens[t+1][0]?(r[0]="[",e[0]="]"):e[0]="INDEX_END"},this.scanTokens(function(i,n){return"INDEX_START"===i[0]&&(r=i,this.detectEnd(n+1,t,e)),1})}},{key:"indexOfTag",value:function(e){for(var t,r,i,n,s=arguments.length,o=Array(1<s?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];for(t=r=0,i=o.length;0<=i?r<i:r>i;t=0<=i?++r:--r)if(null!=o[t]&&("string"==typeof o[t]&&(o[t]=[o[t]]),n=this.tag(e+t+0),0>R.call(o[t],n)))return -1;return e+t+0-1}},{key:"looksObjectish",value:function(e){var t,r;return -1!==this.indexOfTag(e,"@",null,":")||-1!==this.indexOfTag(e,null,":")||!!(-1!==(r=this.indexOfTag(e,a))&&(t=null,this.detectEnd(r+1,function(e){var t;return t=e[0],0<=R.call(o,t)},function(e,r){return t=r}),":"===this.tag(t+1)))}},{key:"findTagsBackwards",value:function(e,t){var r,i,n,s,l,h,u;for(r=[];0<=e&&(r.length||(s=this.tag(e),0>R.call(t,s)&&(l=this.tag(e),0>R.call(a,l)||this.tokens[e].generated)&&(h=this.tag(e),0>R.call(p,h))));)i=this.tag(e),0<=R.call(o,i)&&r.push(this.tag(e)),n=this.tag(e),0<=R.call(a,n)&&r.length&&r.pop(),e-=1;return u=this.tag(e),0<=R.call(t,u)}},{key:"addImplicitBracesAndParens",value:function(){var e,t;return e=[],t=null,this.scanTokens(function(n,s,d){var g,m,v,b,y,x,_,w,P,E,C,A,I,M,O,k,N,L,D,B,F,V,G,U,z,j,H,W,q,X,$,Y,Z,K,J,Q,ee,et,er,ei,en,es=this;if(en=f(n,1)[0],B=f(F=0<s?d[s-1]:[],1)[0],k=f(N=s<d.length-1?d[s+1]:[],1)[0],K=function(){return e[e.length-1]},J=s,v=function(e){return s-J+e},C=function(e){var t;return null==e||null==(t=e[2])?void 0:t.ours},I=function(e){return C(e)&&"{"===(null==e?void 0:e[0])},A=function(e){return C(e)&&"("===(null==e?void 0:e[0])},_=function(){return C(K())},w=function(){return A(K())},E=function(){return I(K())},P=function(){var e;return _()&&"CONTROL"===(null==(e=K())?void 0:e[0])},Q=function(t){return e.push(["(",t,{ours:!0}]),d.splice(t,0,T("CALL_START","(",["","implicit function call",n[2]],F))},g=function(){return e.pop(),d.splice(s,0,T("CALL_END",")",["","end of input",n[2]],F)),s+=1},ee=function(t){var r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=i.startsLine,o=i.continuationLineIndent;return e.push(["{",t,{sameLine:!0,startsLine:void 0===s||s,ours:!0,continuationLineIndent:o}]),(r=new String("{")).generated=!0,d.splice(t,0,T("{",r,n,F))},m=function(t){return t=null==t?s:t,e.pop(),d.splice(t,0,T("}","}",n,F)),s+=1},b=function(e){var t;return t=null,es.detectEnd(e,function(e){return"TERMINATOR"===e[0]},function(e,r){return t=r},{returnOnNegativeLevel:!0}),null!=t&&es.looksObjectish(t+1)},(w()||E())&&0<=R.call(i,en)||E()&&":"===B&&"FOR"===en)return e.push(["CONTROL",s,{ours:!0}]),v(1);if("INDENT"===en&&_()){if("=>"!==B&&"->"!==B&&"["!==B&&"("!==B&&","!==B&&"{"!==B&&"ELSE"!==B&&"="!==B)for(;w()||E()&&":"!==B;)w()?g():m();return P()&&e.pop(),e.push([en,s]),v(1)}if(0<=R.call(a,en))return e.push([en,s]),v(1);if(0<=R.call(o,en)){for(;_();)w()?g():E()?m():e.pop();t=e.pop()}if(x=function(){var e,t;return!!(es.findTagsBackwards(s,["FOR"])&&es.findTagsBackwards(s,["FORIN","FOROF","FORFROM"])||es.findTagsBackwards(s,["WHILE","UNTIL","LOOP","LEADING_WHEN"]))&&(e=!1,t=n[2].first_line,es.detectEnd(s,function(e){var t;return t=e[0],0<=R.call(p,t)},function(r,i){var n=f(d[i-1]||[],3);return B=n[0],e=t===n[2].first_line&&("->"===B||"=>"===B)},{returnOnNegativeLevel:!0}),e)},(0<=R.call(u,en)&&n.spaced||"?"===en&&0<s&&!d[s-1].spaced)&&(0<=R.call(l,k)||"..."===k&&(V=this.tag(s+2),0<=R.call(l,V))&&!this.findTagsBackwards(s,["INDEX_START","["])||0<=R.call(c,k)&&!N.spaced&&!N.newLine)&&!x())return"?"===en&&(en=n[0]="FUNC_EXIST"),Q(s+1),v(2);if(0<=R.call(u,en)&&-1<this.indexOfTag(s+1,"INDENT")&&this.looksObjectish(s+2)&&!this.findTagsBackwards(s,["CLASS","EXTENDS","IF","CATCH","SWITCH","LEADING_WHEN","FOR","WHILE","UNTIL"])&&("{"!==(G=W=null==(U=K())?void 0:U[0])&&"["!==G||C(K())||!this.findTagsBackwards(s,W)))return Q(s+1),e.push(["INDENT",s+2]),v(3);if(":"===en){if(ei=0>=(W=(function(){var e;switch(!1){case e=this.tag(s-1),0>R.call(o,e):var r=f(t,2);return er=r[0],et=r[1],"["===er&&0<et&&"@"===this.tag(et-1)&&!d[et-1].spaced?et-1:et;case"@"!==this.tag(s-2):return s-2;default:return s-1}}).call(this))||(z=this.tag(W-1),0<=R.call(p,z))||d[W-1].newLine,K()){var eo=f(K(),2);if(Z=eo[0],X=eo[1],Y=e[e.length-2],("{"===Z||"INDENT"===Z&&"{"===(null==Y?void 0:Y[0])&&!C(Y)&&this.findTagsBackwards(X-1,["{"]))&&(ei||","===this.tag(W-1)||"{"===this.tag(W-1))&&(j=this.tag(W-1),0>R.call(S,j)))return v(1)}return ee(W,{startsLine:!!ei,continuationLineIndent:(1<s?d[s-2]:[]).continuationLineIndent}),v(2)}if(0<=R.call(p,en))for(M=e.length-1;0<=M&&C($=e[M]);M+=-1)I($)&&($[2].sameLine=!1);if("TERMINATOR"===en&&n.endsContinuationLineIndentation)for(D=n.endsContinuationLineIndentation.preContinuationLineIndent;E()&&null!=(y=K()[2].continuationLineIndent)&&y>D;)m();if(O="OUTDENT"===B||F.newLine,0<=R.call(h,en)||0<=R.call(r,en)&&O||(".."===en||"..."===en)&&this.findTagsBackwards(s,["INDEX_START"]))for(;_();){var ea=f(K(),3);Z=ea[0],X=ea[1];var el=ea[2];if(q=el.sameLine,ei=el.startsLine,w()&&","!==B||","===B&&"TERMINATOR"===en&&null==k)g();else if(E()&&q&&"TERMINATOR"!==en&&":"!==B&&!(("POST_IF"===en||"FOR"===en||"WHILE"===en||"UNTIL"===en)&&ei&&b(s+1)))m();else if(E()&&"TERMINATOR"===en&&","!==B&&!(ei&&this.looksObjectish(s+1)))m();else if(P()&&"CLASS"===d[K()[1]][0]&&"TERMINATOR"===en)e.pop();else break}if(","===en&&!this.looksObjectish(s+1)&&E()&&"FOROF"!==(H=this.tag(s+2))&&"FORIN"!==H&&("TERMINATOR"!==k||!this.looksObjectish(s+2)))for(L="OUTDENT"===k?1:0;E();)m(s+L);return v(1)})}},{key:"enforceValidJSXAttributes",value:function(){return this.scanTokens(function(e,t,r){var i,n;return e.jsxColon&&"STRING_START"!==(n=(i=r[t+1])[0])&&"STRING"!==n&&"("!==n&&M("expected wrapped or quoted JSX attribute",i[2]),1})}},{key:"rescueStowawayComments",value:function(){var e,t,r,i;return t=function(e,t,r,i){return"TERMINATOR"!==r[t][0]&&r[i](T("TERMINATOR","\n",r[t])),r[i](T("JS","",r[t],e))},e=function(e,t){var r,i;for(r=e+1;r!==t.length&&(i=t[r][0],0<=R.call(n,i));){if("INTERPOLATION_END"===t[r][0])return!0;r++}return!1},i=function(e,r,i){var s,o,a,l,h,u;for(s=r;s!==i.length&&(l=i[s][0],0<=R.call(n,l));)s++;if(!(s===i.length||(h=i[s][0],0<=R.call(n,h)))){for(u=e.comments,o=0,a=u.length;o<a;o++)u[o].unshift=!0;return A(e,i[s]),1}return t(e,s=i.length-1,i,"push"),1},r=function(e,r,i){var s,o,a;for(s=r;-1!==s&&(o=i[s][0],0<=R.call(n,o));)s--;return -1===s||(a=i[s][0],0<=R.call(n,a))?(t(e,0,i,"unshift"),3):(A(e,i[s]),1)},this.scanTokens(function(t,s,o){var a,l,h,u,c;if(!t.comments)return 1;if(c=1,h=t[0],0<=R.call(n,h)){for(a={comments:[]},l=t.comments.length-1;-1!==l;)!1===t.comments[l].newLine&&!1===t.comments[l].here&&(a.comments.unshift(t.comments[l]),t.comments.splice(l,1)),l--;0!==a.comments.length&&(c=r(a,s-1,o)),0!==t.comments.length&&i(t,s,o)}else if(!e(s,o)){for(a={comments:[]},l=t.comments.length-1;-1!==l;)!t.comments[l].newLine||t.comments[l].unshift||"JS"===t[0]&&t.generated||(a.comments.unshift(t.comments[l]),t.comments.splice(l,1)),l--;0!==a.comments.length&&(c=i(a,s+1,o))}return 0===(null==(u=t.comments)?void 0:u.length)&&delete t.comments,c})}},{key:"addLocationDataToGeneratedTokens",value:function(){return this.scanTokens(function(e,t,r){var i,n,s,o,a,l,h;if(e[2]||!(e.generated||e.explicit))return 1;if(e.fromThen&&"INDENT"===e[0])return e[2]=e.origin[2],1;if("{"===e[0]&&(s=null==(l=r[t+1])?void 0:l[2])){var u=s;n=u.first_line,i=u.first_column,a=f(u.range,1)[0]}else(o=null==(h=r[t-1])?void 0:h[2])?(n=o.last_line,i=o.last_column,a=f(o.range,2)[1],i+=1):(n=i=0,a=0);return e[2]={first_line:n,first_column:i,last_line:n,last_column:i,last_line_exclusive:n,last_column_exclusive:i,range:[a,a]},1})}},{key:"fixIndentationLocationData",value:function(){var e,t=this;return null==this.allComments&&(this.allComments=w(this.tokens)),e=function(e,r){var i,n,s,o,a,l,h,u,c=r.afterPosition,d=r.indentSize,f=r.first,p=r.indented;if(u=e[2].range[0],a=function(e){return(!e.outdented||null!=d&&e.indentSize>d)&&(!p||e.indented)&&e.locationData.range[0]<u&&e.locationData.range[0]>c},f){for(o=null,n=(l=t.allComments).length-1;0<=n;n+=-1)if(a(i=l[n]))o=i;else if(o)break;return o}for(s=(h=t.allComments).length-1;0<=s;s+=-1)if(a(i=h[s]))return i;return null},this.scanTokens(function(t,r,i){var n,s,o,a,l,h,u,c,d;if("INDENT"!==(h=t[0])&&"OUTDENT"!==h&&(!t.generated||"CALL_END"!==t[0]||null!=(u=t.data)&&u.closingTagNameToken)&&(!t.generated||"}"!==t[0]))return 1;if(n="INDENT"===t[0],l=(null==(c=t.prevToken)?i[r-1]:c)[2],d=t.explicit||t.generated)for(s=t,o=r;(s.explicit||s.generated)&&o!==i.length-1;)s=i[o++];return a=e(d?s:t,{afterPosition:l.range[0],indentSize:t.indentSize,first:n,indented:d}),n&&(null==a||!a.newLine)||t.generated&&"CALL_END"===t[0]&&(null==a?void 0:a.indented)||(null!=a&&(l=a.locationData),t[2]={first_line:null==a?l.last_line:l.first_line,first_column:null==a?l.last_column:n?0:l.first_column,last_line:l.last_line,last_column:l.last_column,last_line_exclusive:l.last_line_exclusive,last_column_exclusive:l.last_column_exclusive,range:n&&null!=a?[l.range[0]-a.indentSize,l.range[1]]:l.range}),1})}},{key:"normalizeLines",value:function(){var e,t,i,n,o,a,l,h,u,c=this;return u=o=h=null,l=null,a=null,n=[],i=function(e,t){var i,n,o,h;return";"!==e[1]&&(i=e[0],0<=R.call(y,i))&&!("TERMINATOR"===e[0]&&(n=this.tag(t+1),0<=R.call(s,n)))&&!("ELSE"===e[0]&&("THEN"!==u||a||l))&&("CATCH"!==(o=e[0])&&"FINALLY"!==o||"->"!==u&&"=>"!==u)||(h=e[0],0<=R.call(r,h)&&(this.tokens[t-1].newLine||"OUTDENT"===this.tokens[t-1][0]))},e=function(e,t){return"ELSE"===e[0]&&"THEN"===u&&n.pop(),this.tokens.splice(","===this.tag(t-1)?t-1:t,0,h)},t=function(e,t){var r,i,s;if(!(0<(s=n.length)))return t;return r=n.pop(),(i=f(c.indentation(e[r]),2)[1])[1]=2*s,e.splice(t,0,i),i[1]=2,e.splice(t+1,0,i),c.detectEnd(t+2,function(e){var t;return"OUTDENT"===(t=e[0])||"TERMINATOR"===t},function(t,r){if("OUTDENT"===this.tag(r)&&"OUTDENT"===this.tag(r+1))return e.splice(r,2)}),t+2},this.scanTokens(function(r,c,d){var p,g,m,v,b,y,S;if(p=("->"===(S=f(r,1)[0])||"=>"===S)&&this.findTagsBackwards(c,["IF","WHILE","FOR","UNTIL","SWITCH","WHEN","LEADING_WHEN","[","INDEX_START"])&&!this.findTagsBackwards(c,["THEN","..","..."]),"TERMINATOR"===S){if("ELSE"===this.tag(c+1)&&"OUTDENT"!==this.tag(c-1))return d.splice.apply(d,[c,1].concat(x(this.indentation()))),1;if(v=this.tag(c+1),0<=R.call(s,v))return";"===r[1]&&"OUTDENT"===this.tag(c+1)&&(d[c+1].prevToken=r,A(r,d[c+1])),d.splice(c,1),0}if("CATCH"===S){for(g=m=1;2>=m;g=++m)if("OUTDENT"===(b=this.tag(c+g))||"TERMINATOR"===b||"FINALLY"===b)return d.splice.apply(d,[c+g,0].concat(x(this.indentation()))),2+g}if(("->"===S||"=>"===S)&&(","===(y=this.tag(c+1))||"]"===y||"."===this.tag(c+1)&&r.newLine)){var w=f(this.indentation(d[c]),2);return o=w[0],h=w[1],d.splice(c+1,0,o,h),1}if(0<=R.call(_,S)&&"INDENT"!==this.tag(c+1)&&("ELSE"!==S||"IF"!==this.tag(c+1))&&!p){u=S;var T=f(this.indentation(d[c]),2);return o=T[0],h=T[1],"THEN"===u&&(o.fromThen=!0),"THEN"===S&&(l=this.findTagsBackwards(c,["LEADING_WHEN"])&&"IF"===this.tag(c+1),a=this.findTagsBackwards(c,["IF"])&&"IF"===this.tag(c+1)),"THEN"===S&&this.findTagsBackwards(c,["IF"])&&n.push(c),"ELSE"===S&&"OUTDENT"!==this.tag(c-1)&&(c=t(d,c)),d.splice(c+1,0,o),this.detectEnd(c+2,i,e),"THEN"===S&&d.splice(c,1),1}return 1})}},{key:"tagPostfixConditionals",value:function(){var e,t,r;return r=null,t=function(e,t){var r,i;return i=f(e,1)[0],r=f(this.tokens[t-1],1)[0],"TERMINATOR"===i||"INDENT"===i&&0>R.call(_,r)},e=function(e){if("INDENT"!==e[0]||e.generated&&!e.fromThen)return r[0]="POST_"+r[0]},this.scanTokens(function(i,n){return"IF"===i[0]&&(r=i,this.detectEnd(n+1,t,e)),1})}},{key:"exposeTokenDataToGrammar",value:function(){return this.scanTokens(function(e){var t,r,i,n;if(e.generated||e.data&&0!==Object.keys(e.data).length){for(t in e[1]=new String(e[1]),i=null==(r=e.data)?{}:r)O.call(i,t)&&(n=i[t],e[1][t]=n);e.generated&&(e[1].generated=!0)}return 1})}},{key:"indentation",value:function(e){var t,r;return t=["INDENT",2],r=["OUTDENT",2],e?(t.generated=r.generated=!0,t.origin=r.origin=e):t.explicit=r.explicit=!0,[t,r]}},{key:"tag",value:function(e){var t;return null==(t=this.tokens[e])?void 0:t[0]}}]),e}();return e.prototype.generate=T,e}).call(this),t=[["(",")"],["[","]"],["{","}"],["INDENT","OUTDENT"],["CALL_START","CALL_END"],["PARAM_START","PARAM_END"],["INDEX_START","INDEX_END"],["STRING_START","STRING_END"],["INTERPOLATION_START","INTERPOLATION_END"],["REGEX_START","REGEX_END"]],e.INVERSES=d={},a=[],o=[],P=0,C=t.length;P<C;P++){var N=f(t[P],2);E=N[0],I=N[1],a.push(d[I]=E),o.push(d[E]=I)}s=["CATCH","THEN","ELSE","FINALLY"].concat(o),u=["IDENTIFIER","PROPERTY","SUPER",")","CALL_END","]","INDEX_END","@","THIS"],l=["IDENTIFIER","JSX_TAG","PROPERTY","NUMBER","INFINITY","NAN","STRING","STRING_START","REGEX","REGEX_START","JS","NEW","PARAM_START","CLASS","IF","TRY","SWITCH","THIS","DYNAMIC_IMPORT","IMPORT_META","NEW_TARGET","UNDEFINED","NULL","BOOL","UNARY","DO","DO_IIFE","YIELD","AWAIT","UNARY_MATH","SUPER","THROW","@","->","=>","[","(","{","--","++"],h=["POST_IF","FOR","WHILE","UNTIL","WHEN","BY","LOOP","TERMINATOR"],_=["ELSE","->","=>","TRY","FINALLY","THEN"],y=["TERMINATOR","CATCH","FINALLY","ELSE","OUTDENT","LEADING_WHEN"],p=["TERMINATOR","INDENT","OUTDENT"],r=[".","?.","::","?::"],i=["IF","TRY","FINALLY","CATCH","CLASS","SWITCH"],n=["(",")","[","]","{","}",":",".","..","...",",","=","++","--","?","AS","AWAIT","CALL_START","CALL_END","DEFAULT","DO","DO_IIFE","ELSE","EXTENDS","EXPORT","FORIN","FOROF","FORFROM","IMPORT","INDENT","INDEX_SOAK","INTERPOLATION_START","INTERPOLATION_END","LEADING_WHEN","OUTDENT","PARAM_END","REGEX_START","REGEX_END","RETURN","STRING_END","THROW","UNARY","YIELD"].concat((c=["+","-"]).concat(h.concat(r.concat(i)))),e.UNFINISHED=S=["\\",".","?.","?::","UNARY","DO","DO_IIFE","MATH","UNARY_MATH","+","-","**","SHIFT","RELATION","COMPARE","&","^","|","&&","||","BIN?","EXTENDS"]}).call(this),e}(),g["./lexer"]=function(){var e={};return(function(){var t,r,i,n,s,o,a,l,h,u,c,p,v,y,_,S,w,T,P,E,C,A,I,M,R,O,k,N,L,D,B,F,V,G,U,z,j,H,W,q,X,$,Y,Z,K,J,Q,ee,et,er,ei,en,es,eo,ea,el,eh,eu,ec,ed,ef,ep,eg,em,ev,eb,ey,ex,e_,eS,ew,eT,eP,eE=[].indexOf,eC=[].slice,eA=g("./rewriter");K=eA.Rewriter,A=eA.INVERSES,ea=eA.UNFINISHED;var eI=g("./helpers");ef=eI.count,eI.starts,eI.compact,eI.repeat,eg=eI.invertLiterate,ex=eI.merge,ec=eI.attachCommentsToNode,eI.locationDataToString,eP=eI.throwSyntaxError,ew=eI.replaceUnicodeCodePointEscapes,ep=eI.flatten,e_=eI.parseNumber,e.Lexer=function(){"use strict";function e(){m(this,e),this.error=this.error.bind(this)}return b(e,[{key:"tokenize",value:function(e){var t,r,i,n,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(this.literate=s.literate,this.indent=0,this.baseIndent=0,this.continuationLineAdditionalIndent=0,this.outdebt=0,this.indents=[],this.indentLiteral="",this.ends=[],this.tokens=[],this.seenFor=!1,this.seenImport=!1,this.seenExport=!1,this.importSpecifierList=!1,this.exportSpecifierList=!1,this.jsxDepth=0,this.jsxObjAttribute={},this.chunkLine=s.line||0,this.chunkColumn=s.column||0,this.chunkOffset=s.offset||0,this.locationDataCompensations=s.locationDataCompensations||{},e=this.clean(e),i=0;this.chunk=e.slice(i);){t=this.identifierToken()||this.commentToken()||this.whitespaceToken()||this.lineToken()||this.stringToken()||this.numberToken()||this.jsxToken()||this.regexToken()||this.jsToken()||this.literalToken();var o=f(this.getLineAndColumnFromChunk(t),3);if(this.chunkLine=o[0],this.chunkColumn=o[1],this.chunkOffset=o[2],i+=t,s.untilBalanced&&0===this.ends.length)return{tokens:this.tokens,index:i}}return this.closeIndentation(),(r=this.ends.pop())&&this.error("missing ".concat(r.tag),(null==(n=r.origin)?r:n)[2]),!1===s.rewrite?this.tokens:new K().rewrite(this.tokens)}},{key:"clean",value:function(e){var r,i,n=this;return i=0,e.charCodeAt(0)===t&&(e=e.slice(1),this.locationDataCompensations[0]=1,i+=1),eh.test(e)&&(e="\n".concat(e),this.chunkLine--,null==(r=this.locationDataCompensations)[0]&&(r[0]=0),this.locationDataCompensations[0]-=1),e=e.replace(/\r/g,function(e,t){return n.locationDataCompensations[i+t]=1,""}).replace(en,""),this.literate&&(e=eg(e)),e}},{key:"identifierToken",value:function(){if(!(d=((u=this.atJSXTag())?M:T).exec(this.chunk)))return 0;var e,t,i,a,l,h,u,c,d,p,g,m,v,b,y,x,_,S,w,P,E,C,A,I,R,O,k,N,B,F=f(d,3);if(c=F[0],l=F[1],t=F[2],h=l.length,p=void 0,"own"===l&&"FOR"===this.tag())return this.token("OWN",l),l.length;if("from"===l&&"YIELD"===this.tag())return this.token("FROM",l),l.length;if("as"===l&&this.seenImport){if("*"===this.value())this.tokens[this.tokens.length-1][0]="IMPORT_ALL";else if(v=this.value(!0),0<=eE.call(o,v)){g=this.prev();var V=["IDENTIFIER",this.value(!0)];g[0]=V[0],g[1]=V[1]}if("DEFAULT"===(b=this.tag())||"IMPORT_ALL"===b||"IDENTIFIER"===b)return this.token("AS",l),l.length}if("as"===l&&this.seenExport){if("IDENTIFIER"===(S=this.tag())||"DEFAULT"===S)return this.token("AS",l),l.length;if(w=this.value(!0),0<=eE.call(o,w)){g=this.prev();var G=["IDENTIFIER",this.value(!0)];return g[0]=G[0],g[1]=G[1],this.token("AS",l),l.length}}if("default"===l&&this.seenExport&&("EXPORT"===(P=this.tag())||"AS"===P))return this.token("DEFAULT",l),l.length;if("assert"===l&&(this.seenImport||this.seenExport)&&"STRING"===this.tag())return this.token("ASSERT",l),l.length;if("do"===l&&(O=/^(\s*super)(?!\(\))/.exec(this.chunk.slice(3)))){this.token("SUPER","super"),this.token("CALL_START","("),this.token("CALL_END",")");var U=f(O,2);return c=U[0],U[1].length+3}if(g=this.prev(),k=t||null!=g&&("."===(E=g[0])||"?."===E||"::"===E||"?::"===E||!g.spaced&&"@"===g[0])?"PROPERTY":"IDENTIFIER",B={},"IDENTIFIER"===k&&(0<=eE.call(L,l)||0<=eE.call(o,l))&&!(this.exportSpecifierList&&0<=eE.call(o,l))?"WHEN"===(k=l.toUpperCase())&&(C=this.tag(),0<=eE.call(D,C))?k="LEADING_WHEN":"FOR"===k?this.seenFor={endsLength:this.ends.length}:"UNLESS"===k?k="IF":"IMPORT"===k?this.seenImport=!0:"EXPORT"===k?this.seenExport=!0:0<=eE.call(es,k)?k="UNARY":0<=eE.call(Y,k)&&("INSTANCEOF"!==k&&this.seenFor?(k="FOR"+k,this.seenFor=!1):(k="RELATION","!"===this.value()&&(p=this.tokens.pop(),B.invert=null==(A=null==(I=p.data)?void 0:I.original)?p[1]:A))):"IDENTIFIER"===k&&this.seenFor&&"from"===l&&em(g)?(k="FORFROM",this.seenFor=!1):"PROPERTY"===k&&g&&(g.spaced&&(R=g[0],0<=eE.call(r,R))&&/^[gs]et$/.test(g[1])&&1<this.tokens.length&&"."!==(y=this.tokens[this.tokens.length-2][0])&&"?."!==y&&"@"!==y?this.error("'".concat(g[1],"' cannot be used as a keyword, or as a function call without parentheses"),g[2]):"."===g[0]&&1<this.tokens.length&&"UNARY"===(m=this.tokens[this.tokens.length-2])[0]&&"new"===m[1]?m[0]="NEW_TARGET":"."===g[0]&&1<this.tokens.length&&"IMPORT"===(m=this.tokens[this.tokens.length-2])[0]&&"import"===m[1]?(this.seenImport=!1,m[0]="IMPORT_META"):2<this.tokens.length&&(m=this.tokens[this.tokens.length-2],("@"===(x=g[0])||"THIS"===x)&&m&&m.spaced&&/^[gs]et$/.test(m[1])&&"."!==(_=this.tokens[this.tokens.length-3][0])&&"?."!==_&&"@"!==_&&this.error("'".concat(m[1],"' cannot be used as a keyword, or as a function call without parentheses"),m[2]))),"IDENTIFIER"===k&&0<=eE.call(Z,l)&&!u&&this.error("reserved word '".concat(l,"'"),{length:l.length}),"PROPERTY"===k||this.exportSpecifierList||this.importSpecifierList||(0<=eE.call(n,l)&&(e=l,l=s[l],B.original=e),k="!"===l?"UNARY":"=="===l||"!="===l?"COMPARE":"true"===l||"false"===l?"BOOL":"break"===l||"continue"===l||"debugger"===l?"STATEMENT":"&&"===l||"||"===l?l:k),N=this.token(k,l,{length:h,data:B}),e&&(N.origin=[k,e,N[2]]),p){var z=[p[2].first_line,p[2].first_column,p[2].range[0]];N[2].first_line=z[0],N[2].first_column=z[1],N[2].range[0]=z[2]}return t&&(i=c.lastIndexOf(u?"=":":"),a=this.token(":",":",{offset:i}),u&&(a.jsxColon=!0)),u&&"IDENTIFIER"===k&&":"!==g[0]&&this.token(",",",",{length:0,origin:N,generated:!0}),c.length}},{key:"numberToken",value:function(){var e,t,r,i,n,s;if(!(t=z.exec(this.chunk)))return 0;switch(e=(r=t[0]).length,!1){case!/^0[BOX]/.test(r):this.error("radix prefix in '".concat(r,"' must be lowercase"),{offset:1});break;case!/^(?!0x).*E/.test(r):this.error("exponential notation in '".concat(r,"' must be indicated with a lowercase 'e'"),{offset:r.indexOf("E")});break;case!/^0\d*[89]/.test(r):this.error("decimal literal '".concat(r,"' must not be prefixed with '0'"),{length:e});break;case!/^0\d+/.test(r):this.error("octal literal '".concat(r,"' must be prefixed with '0o'"),{length:e})}return s={parsedValue:i=e_(r)},"INFINITY"==(n=2e308===i?"INFINITY":"NUMBER")&&(s.original=r),this.token(n,r,{length:e,data:s}),e}},{key:"stringToken",value:function(){var e,t,r,i,n,s,o,a,l,h,u,c,d,g,m=this;if(!(h=f(ei.exec(this.chunk)||[],1)[0]))return 0;(l=this.prev())&&"from"===this.value()&&(this.seenImport||this.seenExport)&&(l[0]="FROM"),c="'"===h?er:'"'===h?ee:"'''"===h?y:'"""'===h?p:void 0;var b=this.matchWithInterpolations(c,h);if(g=b.tokens,i=b.index,n=3===h.length)for(o=null,r=(function(){var e,t,r;for(r=[],s=e=0,t=g.length;e<t;s=++e)"NEOSTRING"===(d=g[s])[0]&&r.push(d[1]);return r})().join("#{}");a=v.exec(r);)e=a[1],(null===o||0<(u=e.length)&&u<o.length)&&(o=e);return h.charAt(0),this.mergeInterpolationTokens(g,{quote:h,indent:o,endOffset:i},function(e){return m.validateUnicodeCodePointEscapes(e,{delimiter:h})}),this.atJSXTag()&&this.token(",",",",{length:0,origin:this.prev,generated:!0}),i}},{key:"commentToken",value:function(){var e,t,r,i,n,s,o,l,h,u,d,p,g,m,v,b,y,x,_,S,w,T,P,E,C,A,I=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.chunk,M=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},R=M.heregex,O=M.returnCommentTokens,k=M.offsetInChunk,N=void 0===k?0:k;if(!(_=I.match(a)))return 0;var L=f(_,5);return r=L[0],h=L[1],l=L[2],u=L[3],x=L[4],n=null,g=/^\s*\n+\s*#/.test(r),l?((S=c.exec(l))&&this.error("block comments cannot contain ".concat(S[0]),{offset:3+S.index,length:S[0].length}),I=(I=I.replace("###".concat(l,"###"),"")).replace(/^\n+/,""),this.lineToken({chunk:I}),n=[{content:i=l,length:r.length-h.length-u.length,leadingWhitespace:h}]):(v="",i=x.replace(/^(\n*)/,function(e){return v=e,""}),C="",o=!1,n=i.split("\n").map(function(e){var t,r;return -1<e.indexOf("#")?(r="",t={content:i=e.replace(/^([ |\t]*)#/,function(e,t){return r=t,""}),length:1+i.length,leadingWhitespace:"".concat(o?"":v).concat(C).concat(r),precededByBlankLine:!!C},o=!0,C="",t):void(C+="\n".concat(e))}).filter(function(e){return e})),s=function(e){var t,r=e.leadingWhitespace,i=e.nonInitial;if(t=r.lastIndexOf("\n"),null==l&&i)null==t&&(t=-1);else if(!(-1<t))return null;return r.length-1-t},t=(function(){var t,r,o;for(o=[],d=t=0,r=n.length;t<r;d=++t){var a=n[d];i=a.content,y=a.length,b=a.leadingWhitespace,E=a.precededByBlankLine,m=(T=0!==d)?1:0,N+=m+b.length,w=null==(p=s({leadingWhitespace:b,nonInitial:T}))||-1===p,e={content:i,here:null!=l,newLine:g||T,locationData:this.makeLocationData({offsetInChunk:N,length:y}),precededByBlankLine:E,indentSize:p,indented:!w&&p>this.indent,outdented:!w&&p<this.indent},R&&(e.heregex=!0),N+=y,o.push(e)}return o}).call(this),(A=this.prev())?ec(t,A):(t[0].newLine=!0,this.lineToken({chunk:this.chunk.slice(r.length),offset:r.length}),(P=this.makeToken("JS","",{offset:r.length,generated:!0})).comments=t,this.tokens.push(P),this.newlineToken(r.length)),void 0!==O&&O?t:r.length}},{key:"jsToken",value:function(){var e,t,r,i;return"`"===this.chunk.charAt(0)&&(t=(r=w.exec(this.chunk))||I.exec(this.chunk))?(i=t[1],e=t[0].length,this.token("JS",i,{length:e,data:{here:!!r}}),e):0}},{key:"regexToken",value:function(){var e,t,i,n,s,o,a,l,h,u,c,d,p,g,m,v,b,y,x,w,T,P=this;switch(!1){case!(g=X.exec(this.chunk)):this.error("regular expressions cannot begin with ".concat(g[2]),{offset:g.index+g[1].length});break;case!(g=this.matchWithInterpolations(_,"///")):var E=g;for(T=E.tokens,d=E.index,a=[];m=S.exec(this.chunk.slice(0,d));){n=m.index;var C=f(m,3);C[0],p=C[1],i=C[2],a.push({comment:i,offsetInChunk:n+p.length})}o=ep((function(){var e,t,r;for(r=[],e=0,t=a.length;e<t;e++)s=a[e],r.push(this.commentToken(s.comment,Object.assign(s,{heregex:!0,returnCommentTokens:!0})));return r}).call(this));break;case!(g=W.exec(this.chunk)):var A=f(g,3);if(w=A[0],e=A[1],t=A[2],this.validateEscapes(e,{isRegex:!0,offsetInChunk:1}),d=w.length,b=this.prev()){if(b.spaced&&(y=b[0],0<=eE.call(r,y))){if(!t||H.test(w))return 0}else if(x=b[0],0<=eE.call(U,x))return 0}t||this.error("missing / (unclosed regex)");break;default:return 0}var I=f(q.exec(this.chunk.slice(d)),1);switch(h=d+(u=I[0]).length,v=this.makeToken("REGEX",null,{length:h}),!1){case!!el.test(u):this.error("invalid regular expression flags ".concat(u),{offset:d,length:u.length});break;case!(w||1===T.length):l=e?"/":"///",null==e&&(e=T[0][1]),this.validateUnicodeCodePointEscapes(e,{delimiter:l}),this.token("REGEX","/".concat(e,"/").concat(u),{length:h,origin:v,data:{delimiter:l}});break;default:this.token("REGEX_START","(",{length:0,origin:v,generated:!0}),this.token("IDENTIFIER","RegExp",{length:0,generated:!0}),this.token("CALL_START","(",{length:0,generated:!0}),this.mergeInterpolationTokens(T,{double:!0,heregex:{flags:u},endOffset:h-u.length,quote:"///"},function(e){return P.validateUnicodeCodePointEscapes(e,{delimiter:l})}),u&&(this.token(",",",",{offset:d-1,length:0,generated:!0}),this.token("STRING",'"'+u+'"',{offset:d,length:u.length})),this.token(")",")",{offset:h,length:0,generated:!0}),this.token("REGEX_END",")",{offset:h,length:0,generated:!0})}return(null==o?void 0:o.length)&&eu(this.tokens[this.tokens.length-1],{heregexCommentTokens:o}),h}},{key:"lineToken",value:function(){var e,t,r,i,n,s,o,a,l,h,u,c=Math.min,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},f=d.chunk,p=void 0===f?this.chunk:f,g=d.offset,m=void 0===g?0:g;if(!(n=G.exec(p)))return 0;if(i=n[0],((e="\\"===(null==(l=this.prev())?void 0:l[0]))||(null==(h=this.seenFor)?void 0:h.endsLength)<this.ends.length)&&this.seenFor||(this.seenFor=!1),e&&this.seenImport||this.importSpecifierList||(this.seenImport=!1),e&&this.seenExport||this.exportSpecifierList||(this.seenExport=!1),u=i.length-1-i.lastIndexOf("\n"),a=this.unfinished(),o=0<u?i.slice(-u):"",!/^(.?)\1*$/.exec(o))return this.error("mixed indentation",{offset:i.length}),i.length;if(s=c(o.length,this.indentLiteral.length),o.slice(0,s)!==this.indentLiteral.slice(0,s))return this.error("indentation mismatch",{offset:i.length}),i.length;if(u-this.continuationLineAdditionalIndent===this.indent)return a?this.suppressNewlines():this.newlineToken(m),i.length;if(u>this.indent){if(a)return e||(this.continuationLineAdditionalIndent=u-this.indent),this.continuationLineAdditionalIndent&&(l.continuationLineIndent=this.indent+this.continuationLineAdditionalIndent),this.suppressNewlines(),i.length;if(!this.tokens.length)return this.baseIndent=this.indent=u,this.indentLiteral=o,i.length;t=u-this.indent+this.outdebt,this.token("INDENT",t,{offset:m+i.length-u,length:u}),this.indents.push(t),this.ends.push({tag:"OUTDENT"}),this.outdebt=this.continuationLineAdditionalIndent=0,this.indent=u,this.indentLiteral=o}else u<this.baseIndent?this.error("missing indentation",{offset:m+i.length}):(r=0<this.continuationLineAdditionalIndent,this.continuationLineAdditionalIndent=0,this.outdentToken({moveOut:this.indent-u,noNewlines:a,outdentLength:i.length,offset:m,indentSize:u,endsContinuationLineIndentation:r}));return i.length}},{key:"outdentToken",value:function(e){var t,r,i,n,s=e.moveOut,o=e.noNewlines,a=e.outdentLength,l=void 0===a?0:a,h=e.offset,u=e.indentSize,c=e.endsContinuationLineIndentation;for(t=this.indent-s;0<s;)this.indents[this.indents.length-1]?this.outdebt&&s<=this.outdebt?(this.outdebt-=s,s=0):(r=this.indents.pop()+this.outdebt,l&&(i=this.chunk[l],0<=eE.call(P,i))&&(t-=r-s,s=r),this.outdebt=0,this.pair("OUTDENT"),this.token("OUTDENT",s,{length:l,indentSize:u+s-r}),s-=r):this.outdebt=s=0;return r&&(this.outdebt-=s),this.suppressSemicolons(),"TERMINATOR"===this.tag()||o||(n=this.token("TERMINATOR","\n",{offset:(void 0===h?0:h)+l,length:0}),c&&(n.endsContinuationLineIndentation={preContinuationLineIndent:this.indent})),this.indent=t,this.indentLiteral=this.indentLiteral.slice(0,t),this}},{key:"whitespaceToken",value:function(){var e,t,r;return(e=eh.exec(this.chunk))||"\n"===this.chunk.charAt(0)?((r=this.prev())&&(r[e?"spaced":"newLine"]=!0),e?e[0].length:0):0}},{key:"newlineToken",value:function(e){return this.suppressSemicolons(),"TERMINATOR"!==this.tag()&&this.token("TERMINATOR","\n",{offset:e,length:0}),this}},{key:"suppressNewlines",value:function(){var e;return"\\"===(e=this.prev())[1]&&(e.comments&&1<this.tokens.length&&ec(e.comments,this.tokens[this.tokens.length-2]),this.tokens.pop()),this}},{key:"jsxToken",value:function(){var e,t,r,i,n,s,o,a,h,u,c,p,g,m,v,b,y,x,_,S,w,T,P=this;if(i=this.chunk[0],b=0<this.tokens.length?this.tokens[this.tokens.length-1][0]:"","<"===i){if(!((p=O.exec(this.chunk.slice(1))||R.exec(this.chunk.slice(1)))&&(0<this.jsxDepth||!(v=this.prev())||v.spaced||(_=v[0],0>eE.call(l,_)))))return 0;var E=f(p,2);if(E[0],n=o=E[1],0<=eE.call(o,".")){var A=d(o.split("."));o=A[0],y=A.slice(1)}else y=[];for(S=this.token("JSX_TAG",o,{length:o.length+1,data:{openingBracketToken:this.makeToken("<","<"),tagNameToken:this.makeToken("IDENTIFIER",o,{offset:1})}}),g=o.length+1,h=0,c=y.length;h<c;h++)x=y[h],this.token(".",".",{offset:g}),g+=1,this.token("PROPERTY",x,{offset:g}),g+=x.length;return this.token("CALL_START","(",{generated:!0}),this.token("[","[",{generated:!0}),this.ends.push({tag:"/>",origin:S,name:o,properties:y}),this.jsxDepth++,n.length+1}if(u=this.atJSXTag()){if("/>"===this.chunk.slice(0,2))return this.pair("/>"),this.token("]","]",{length:2,generated:!0}),this.token("CALL_END",")",{length:2,generated:!0,data:{selfClosingSlashToken:this.makeToken("/","/"),closingBracketToken:this.makeToken(">",">",{offset:1})}}),this.jsxDepth--,2;if("{"===i)return":"===b?(w=this.token("(","{"),this.jsxObjAttribute[this.jsxDepth]=!1,eu(this.tokens[this.tokens.length-3],{jsx:!0})):(w=this.token("{","{"),this.jsxObjAttribute[this.jsxDepth]=!0),this.ends.push({tag:"}",origin:w}),1;if(">"===i){m=this.pair("/>").origin,this.token("]","]",{generated:!0,data:{closingBracketToken:this.makeToken(">",">")}}),this.token(",","JSX_COMMA",{generated:!0});var I=this.matchWithInterpolations(C,">","</",N);return T=I.tokens,t=I.index,this.mergeInterpolationTokens(T,{endOffset:t,jsx:!0},function(e){return P.validateUnicodeCodePointEscapes(e,{delimiter:">"})}),(p=O.exec(this.chunk.slice(t))||R.exec(this.chunk.slice(t)))&&p[1]==="".concat(u.name).concat((function(){var e,t,r,i;for(r=u.properties,i=[],e=0,t=r.length;e<t;e++)x=r[e],i.push(".".concat(x));return i})().join(""))||this.error("expected corresponding JSX closing tag for ".concat(u.name),u.origin.data.tagNameToken[2]),e=t+(s=f(p,2)[1]).length,">"!==this.chunk[e]&&this.error("missing closing > after tag name",{offset:e,length:1}),r=this.token("CALL_END",")",{offset:t-2,length:s.length+3,generated:!0,data:{closingTagOpeningBracketToken:this.makeToken("<","<",{offset:t-2}),closingTagSlashToken:this.makeToken("/","/",{offset:t-1}),closingTagNameToken:this.makeToken("IDENTIFIER",s,{offset:t}),closingTagClosingBracketToken:this.makeToken(">",">",{offset:t+s.length})}}),eu(m,r.data),this.jsxDepth--,e+1}return 0}return this.atJSXTag(1)&&"}"===i?(this.pair(i),this.jsxObjAttribute[this.jsxDepth]?(this.token("}","}"),this.jsxObjAttribute[this.jsxDepth]=!1):this.token(")","}"),this.token(",",",",{generated:!0}),1):0}},{key:"atJSXTag",value:function(){var e,t,r,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(0===this.jsxDepth)return!1;for(e=this.ends.length-1;"OUTDENT"===(null==(r=this.ends[e])?void 0:r.tag)||0<i--;)e--;return"/>"===(null==(t=this.ends[e])?void 0:t.tag)&&t}},{key:"literalToken",value:function(){var e,t,n,s,o,a,l,c,d,p,g,m,v,b;return((e=j.exec(this.chunk))?(b=f(e,1)[0],i.test(b)&&this.tagParameters()):b=this.chunk.charAt(0),m=b,(s=this.prev())&&0<=eE.call(["="].concat(x(u)),b)&&(g=!1,"="!==b||"||"!==(o=s[1])&&"&&"!==o||s.spaced||(s[0]="COMPOUND_ASSIGN",s[1]+="=",(null==(a=s.data)?void 0:a.original)&&(s.data.original+="="),s[2].range=[s[2].range[0],s[2].range[1]+1],s[2].last_column+=1,s[2].last_column_exclusive+=1,s=this.tokens[this.tokens.length-2],g=!0),s&&"PROPERTY"!==s[0]&&(n=null==(l=s.origin)?s:l,(t=ev(s[1],n[1]))&&this.error(t,n[2])),g))?b.length:(("("===b&&"IMPORT"===(null==s?void 0:s[0])&&(s[0]="DYNAMIC_IMPORT"),"{"===b&&this.seenImport?this.importSpecifierList=!0:this.importSpecifierList&&"}"===b?this.importSpecifierList=!1:"{"===b&&"EXPORT"===(null==s?void 0:s[0])?this.exportSpecifierList=!0:this.exportSpecifierList&&"}"===b&&(this.exportSpecifierList=!1),";"===b)?(c=null==s?void 0:s[0],0<=eE.call(["="].concat(x(ea)),c)&&this.error("unexpected ;"),this.seenFor=this.seenImport=this.seenExport=!1,m="TERMINATOR"):"*"===b&&"EXPORT"===(null==s?void 0:s[0])?m="EXPORT_ALL":0<=eE.call(V,b)?m="MATH":0<=eE.call(h,b)?m="COMPARE":0<=eE.call(u,b)?m="COMPOUND_ASSIGN":0<=eE.call(es,b)?m="UNARY":0<=eE.call(eo,b)?m="UNARY_MATH":0<=eE.call(J,b)?m="SHIFT":"?"===b&&(null==s?void 0:s.spaced)?m="BIN?":s&&("("===b&&!s.spaced&&(d=s[0],0<=eE.call(r,d))?("?"===s[0]&&(s[0]="FUNC_EXIST"),m="CALL_START"):"["===b&&(p=s[0],0<=eE.call(E,p)&&!s.spaced||"::"===s[0])&&(m="INDEX_START",s[0]==="?")&&(s[0]="INDEX_SOAK")),v=this.makeToken(m,b),"("===b||"{"===b||"["===b?this.ends.push({tag:A[b],origin:v}):(")"===b||"}"===b||"]"===b)&&this.pair(b),this.tokens.push(this.makeToken(m,b)),b.length)}},{key:"tagParameters",value:function(){var e,t,r,i,n;if(")"!==this.tag())return this.tagDoIife();for(r=[],e=(n=this.tokens).length,(t=n[--e])[0]="PARAM_END";i=n[--e];)switch(i[0]){case")":r.push(i);break;case"(":case"CALL_START":if(!r.length)return"("===i[0]?(i[0]="PARAM_START",this.tagDoIife(e-1)):(t[0]="CALL_END",this);r.pop()}return this}},{key:"tagDoIife",value:function(e){var t;return"DO"!==(null==(t=this.tokens[null==e?this.tokens.length-1:e])?void 0:t[0])||(t[0]="DO_IIFE"),this}},{key:"closeIndentation",value:function(){return this.outdentToken({moveOut:this.indent,indentSize:0})}},{key:"matchWithInterpolations",value:function(t,r){var i,n,s,o,a,l,h,u,c,d,p,g,m,v,b,y,_,S=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r,w=3<arguments.length&&void 0!==arguments[3]?arguments[3]:/^#\{/;if(_=[],d=r.length,this.chunk.slice(0,d)!==r)return null;for(b=this.chunk.slice(d);y=f(t.exec(b),1)[0],this.validateEscapes(y,{isRegex:"/"===r.charAt(0),offsetInChunk:d}),_.push(this.makeToken("NEOSTRING",y,{offset:d})),b=b.slice(y.length),d+=y.length,h=w.exec(b);){;a=f(h,1)[0].length-1;var T=f(this.getLineAndColumnFromChunk(d+a),3);l=T[0],s=T[1],c=T[2],v=b.slice(a);var P=new e().tokenize(v,{line:l,column:s,offset:c,untilBalanced:!0,locationDataCompensations:this.locationDataCompensations});u=P.tokens,(i="}"===b[(o=P.index+a)-1])&&(p=f(u,1)[0],n=f(eC.call(u,-1),1)[0],p[0]="INTERPOLATION_START",p[1]="(",p[2].first_column-=a,p[2].range=[p[2].range[0]-a,p[2].range[1]],n[0]="INTERPOLATION_END",n[1]=")",n.origin=["","end of interpolation",n[2]]),"TERMINATOR"===(null==(g=u[1])?void 0:g[0])&&u.splice(1,1),"INDENT"===(null==(m=u[u.length-3])?void 0:m[0])&&"OUTDENT"===u[u.length-2][0]&&u.splice(-3,2),i||(p=this.makeToken("INTERPOLATION_START","(",{offset:d,length:0,generated:!0}),n=this.makeToken("INTERPOLATION_END",")",{offset:d+o,length:0,generated:!0}),u=[p].concat(x(u),[n])),_.push(["TOKENS",u]),b=b.slice(o),d+=o}return b.slice(0,S.length)!==S&&this.error("missing ".concat(S),{length:r.length}),{tokens:_,index:d+S.length}}},{key:"mergeInterpolationTokens",value:function(e,t,r){var i,n,s,o,a,l,h,u,c,d,p,g,m,v,b,y,_,S,w,T,P,E,C,A,I,M;for(S=t.quote,u=t.indent,s=t.double,l=t.heregex,o=t.endOffset,d=t.jsx,1<e.length&&(y=this.token("STRING_START","(",{length:null==(w=null==S?void 0:S.length)?0:w,data:{quote:S},generated:null==S||!S.length})),this.tokens.length,i=e.length-1,h=c=0,m=e.length;c<m;h=++c){var R,O,k=f(C=e[h],2);switch(E=k[0],M=k[1],E){case"TOKENS":if(2===M.length&&(M[0].comments||M[1].comments)){for((_=this.makeToken("JS","",{generated:!0}))[2]=M[0][2],p=0,v=M.length;p<v;p++)(I=M[p]).comments&&(null==_.comments&&(_.comments=[]),(O=_.comments).push.apply(O,x(I.comments)));M.splice(1,0,_)}M[0],A=M;break;case"NEOSTRING":n=r.call(this,C[1],h),0===h&&eu(C,{initialChunk:!0}),h===i&&eu(C,{finalChunk:!0}),eu(C,{indent:u,quote:S,double:s}),l&&eu(C,{heregex:l}),d&&eu(C,{jsx:d}),C[0]="STRING",C[1]='"'+n+'"',1===e.length&&null!=S&&(C[2].first_column-=S.length,"\n"===C[1].substr(-2,1)?(C[2].last_line+=1,C[2].last_column=S.length-1):(C[2].last_column+=S.length,2===C[1].length&&(C[2].last_column-=1)),C[2].last_column_exclusive+=S.length,C[2].range=[C[2].range[0]-S.length,C[2].range[1]+S.length]),A=[C]}(R=this.tokens).push.apply(R,x(A))}if(y)return g=f(eC.call(e,-1),1)[0],y.origin=["STRING",null,{first_line:y[2].first_line,first_column:y[2].first_column,last_line:g[2].last_line,last_column:g[2].last_column,last_line_exclusive:g[2].last_line_exclusive,last_column_exclusive:g[2].last_column_exclusive,range:[y[2].range[0],g[2].range[1]]}],(null==S?void 0:S.length)||(y[2]=y.origin[2]),this.token("STRING_END",")",{offset:o-(null==S?"":S).length,length:null==(T=null==S?void 0:S.length)?0:T,generated:null==S||!S.length})}},{key:"pair",value:function(e){var t,r,i,n,s;return(i=this.ends,e!==(s=null==(r=f(eC.call(i,-1),1)[0])?void 0:r.tag))?("OUTDENT"!==s&&this.error("unmatched ".concat(e)),n=this.indents,t=f(eC.call(n,-1),1)[0],this.outdentToken({moveOut:t,noNewlines:!0}),this.pair(e)):this.ends.pop()}},{key:"getLocationDataCompensation",value:function(e,t){var r,i,n,s;for(s=0,n=t,i=e;i<=t&&(i!==t||e===n);)null!=(r=this.locationDataCompensations[i])&&(s+=r,t+=r),i++;return s}},{key:"getLineAndColumnFromChunk",value:function(e){var t,r,i,n,s,o,a;return(i=this.getLocationDataCompensation(this.chunkOffset,this.chunkOffset+e),0===e)?[this.chunkLine,this.chunkColumn+i,this.chunkOffset+i]:((n=ef(a=e>=this.chunk.length?this.chunk:this.chunk.slice(0,+(e-1)+1||9e9),"\n"),t=this.chunkColumn,0<n)?(o=a.split("\n"),t=f(eC.call(o,-1),1)[0].length,0>(s=this.getLocationDataCompensation(this.chunkOffset,this.chunkOffset+e-t))&&(s=0),r=this.getLocationDataCompensation(this.chunkOffset+e+s-t,this.chunkOffset+e+s)):(t+=a.length,r=i),[this.chunkLine+n,t+r,this.chunkOffset+e+i])}},{key:"makeLocationData",value:function(e){var t,r,i,n=e.offsetInChunk,s=e.length;i={range:[]};var o=f(this.getLineAndColumnFromChunk(n),3);i.first_line=o[0],i.first_column=o[1],i.range[0]=o[2],r=0<s?s-1:0;var a=f(this.getLineAndColumnFromChunk(n+r),3);i.last_line=a[0],i.last_column=a[1],t=a[2];var l=f(this.getLineAndColumnFromChunk(n+r+(0<s?1:0)),2);return i.last_line_exclusive=l[0],i.last_column_exclusive=l[1],i.range[1]=0<s?t+1:t,i}},{key:"makeToken",value:function(e,t){var r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=i.offset,s=i.length,o=void 0===s?t.length:s,a=i.origin,l=i.generated,h=i.indentSize;return r=[e,t,this.makeLocationData({offsetInChunk:void 0===n?0:n,length:o})],a&&(r.origin=a),l&&(r.generated=!0),null!=h&&(r.indentSize=h),r}},{key:"token",value:function(e,t){var r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=i.offset,s=i.length,o=i.origin,a=i.data,l=i.generated,h=i.indentSize;return r=this.makeToken(e,t,{offset:n,length:s,origin:o,generated:l,indentSize:h}),a&&eu(r,a),this.tokens.push(r),r}},{key:"tag",value:function(){var e,t;return e=this.tokens,null==(t=f(eC.call(e,-1),1)[0])?void 0:t[0]}},{key:"value",value:function(){var e,t,r=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];return e=this.tokens,t=f(eC.call(e,-1),1)[0],r&&null!=(null==t?void 0:t.origin)?t.origin[1]:null==t?void 0:t[1]}},{key:"prev",value:function(){return this.tokens[this.tokens.length-1]}},{key:"unfinished",value:function(){var e;return B.test(this.chunk)||(e=this.tag(),0<=eE.call(ea,e))}},{key:"validateUnicodeCodePointEscapes",value:function(e,t){return ew(e,ex(t,{error:this.error}))}},{key:"validateEscapes",value:function(e){var t,r,i,n,s,o,a,l,h,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(n=(u.isRegex?$:et).exec(e))return n[0],t=n[1],o=n[2],r=n[3],h=n[4],l=n[5],s=o?"octal escape sequences are not allowed":"invalid escape sequence",i="\\".concat(o||r||h||l),this.error("".concat(s," ").concat(i),{offset:(null==(a=u.offsetInChunk)?0:a)+n.index+t.length,length:i.length})}},{key:"suppressSemicolons",value:function(){var e,t,r;for(r=[];";"===this.value();)this.tokens.pop(),(e=null==(t=this.prev())?void 0:t[0],0<=eE.call(["="].concat(x(ea)),e))?r.push(this.error("unexpected ;")):r.push(void 0);return r}},{key:"error",value:function(e){var t,r,i,n,s,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return eP(e,"first_line"in o?o:(i=(t=f(this.getLineAndColumnFromChunk(null==(n=o.offset)?0:n),2))[0],{first_line:i,first_column:r=t[1],last_column:r+(null==(s=o.length)?1:s)-1}))}}]),e}(),ev=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e;switch(!1){case 0>eE.call([].concat(x(L),x(o)),e):return"keyword '".concat(t,"' can't be assigned");case 0>eE.call(Q,e):return"'".concat(t,"' can't be assigned");case 0>eE.call(Z,e):return"reserved word '".concat(t,"' can't be assigned");default:return!1}},e.isUnassignable=ev,em=function(e){var t;return"IDENTIFIER"===e[0]||"FOR"!==e[0]&&"{"!==(t=e[1])&&"["!==t&&","!==t&&":"!==t},eu=function(e,t){return Object.assign(null==e.data?e.data={}:e.data,t)},L=["true","false","null","this","new","delete","typeof","in","instanceof","return","throw","break","continue","debugger","yield","await","if","else","switch","for","while","do","try","catch","finally","class","extends","super","import","export","default"],o=["undefined","Infinity","NaN","then","unless","until","loop","of","by","when"],s={and:"&&",or:"||",is:"==",isnt:"!=",not:"!",yes:"true",no:"false",on:"true",off:"false"},n=function(){var e;for(eb in e=[],s)e.push(eb);return e}(),o=o.concat(n),Z=["case","function","var","void","with","const","let","enum","native","implements","interface","package","private","protected","public","static"],Q=["arguments","eval"],e.JS_FORBIDDEN=L.concat(Z).concat(Q),t=65279,T=/^(?!\d)((?:(?!\s)[$\w\x7f-\uffff])+)([^\n\S]*:(?!:))?/,k=/(?:(?!\s)[\-$\w\x7f-\uffff])+/.source,O=RegExp("^(?![\\d<])(".concat(k,"(?:\\s*:\\s*").concat(k,"|(?:\\s*\\.\\s*").concat(k,")+)?)")),R=/^()>/,M=RegExp("^(?!\\d)(".concat(k,"(?:\\s*:\\s*").concat(k,")?)([^\\S]*=(?!=))?")),z=/^0b[01](?:_?[01])*n?|^0o[0-7](?:_?[0-7])*n?|^0x[\da-f](?:_?[\da-f])*n?|^\d+n|^(?:\d(?:_?\d)*)?\.?(?:\d(?:_?\d)*)+(?:e[+-]?(?:\d(?:_?\d)*)+)?/i,j=/^(?:[-=]>|[-+*\/%<>&|^!?=]=|>>>=?|([-+:])\1|([&|<>*\/%])\2=?|\?(\.|::)|\.{2,3})/,eh=/^[^\n\S]+/,a=/^(\s*)###([^#][\s\S]*?)(?:###([^\n\S]*)|###$)|^((?:\s*#(?!##[^#]).*)+)/,i=/^[-=]>/,G=/^(?:\n[^\n\S]*)+/,I=/^`(?!``)((?:[^`\\]|\\[\s\S])*)`/,w=/^```((?:[^`\\]|\\[\s\S]|`(?!``))*)```/,ei=/^(?:'''|"""|'|")/,er=/^(?:[^\\']|\\[\s\S])*/,ee=/^(?:[^\\"#]|\\[\s\S]|\#(?!\{))*/,y=/^(?:[^\\']|\\[\s\S]|'(?!''))*/,p=/^(?:[^\\"#]|\\[\s\S]|"(?!"")|\#(?!\{))*/,C=/^(?:[^\{<])*/,N=/^(?:\{|<(?!\/))/,v=/\n+([^\n\S]*)(?=\S)/g,W=/^\/(?!\/)((?:[^[\/\n\\]|\\[^\n]|\[(?:\\[^\n]|[^\]\n\\])*\])*)(\/)?/,q=/^\w*/,el=/^(?!.*(.).*\1)[gimsuy]*$/,_=/^(?:[^\\\/#\s]|\\[\s\S]|\/(?!\/\/)|\#(?!\{)|\s+(?:#(?!\{).*)?)*/,S=/(\s+)(#(?!{).*)/gm,X=/^(\/|\/{3}\s*)(\*)/,H=/^\/=?\s/,c=/\*\//,B=/^\s*(?:,|\??\.(?![.\d])|\??::)/,et=/((?:^|[^\\])(?:\\\\)*)\\(?:(0\d|[1-7])|(x(?![\da-fA-F]{2}).{0,2})|(u\{(?![\da-fA-F]{1,}\})[^}]*\}?)|(u(?!\{|[\da-fA-F]{4}).{0,4}))/,$=/((?:^|[^\\])(?:\\\\)*)\\(?:(0\d)|(x(?![\da-fA-F]{2}).{0,2})|(u\{(?![\da-fA-F]{1,}\})[^}]*\}?)|(u(?!\{|[\da-fA-F]{4}).{0,4}))/,en=/\s+$/,u=["-=","+=","/=","*=","%=","||=","&&=","?=","<<=",">>=",">>>=","&=","^=","|=","**=","//=","%%="],es=["NEW","TYPEOF","DELETE"],eo=["!","~"],J=["<<",">>",">>>"],h=["==","!=","<",">","<=",">="],V=["*","/","%","//","%%"],Y=["IN","OF","INSTANCEOF"],E=(r=["IDENTIFIER","PROPERTY",")","]","?","@","THIS","SUPER","DYNAMIC_IMPORT"]).concat(["NUMBER","INFINITY","NAN","STRING","STRING_END","REGEX","REGEX_END","BOOL","NULL","UNDEFINED","}","::"]),l=["IDENTIFIER",")","]","NUMBER"],U=E.concat(["++","--"]),D=["INDENT","OUTDENT","TERMINATOR"],P=[")","}","]"]}).call(this),e}(),g["./parser"]=(t={exports:e={}},i=function(){function e(){this.yy={}}var t=function(e,t,r,i){for(r=r||{},i=e.length;i--;r[e[i]]=t);return r},r=[1,24],i=[1,59],n=[1,98],s=[1,99],o=[1,94],a=[1,100],l=[1,101],h=[1,96],u=[1,97],c=[1,68],d=[1,70],p=[1,71],g=[1,72],m=[1,73],v=[1,74],b=[1,76],y=[1,80],x=[1,77],_=[1,78],S=[1,62],w=[1,45],T=[1,38],P=[1,83],E=[1,84],C=[1,81],A=[1,82],I=[1,93],M=[1,57],R=[1,63],O=[1,64],k=[1,79],N=[1,50],L=[1,58],D=[1,75],B=[1,88],F=[1,89],V=[1,90],G=[1,91],U=[1,56],z=[1,87],j=[1,40],H=[1,41],W=[1,61],q=[1,42],X=[1,43],$=[1,44],Y=[1,46],Z=[1,47],K=[1,102],J=[1,6,35,52,155],Q=[1,6,33,35,52,74,76,96,137,144,155,158,166],ee=[1,120],et=[1,121],er=[1,122],ei=[1,117],en=[1,105],es=[1,104],eo=[1,103],ea=[1,106],el=[1,107],eh=[1,108],eu=[1,109],ec=[1,110],ed=[1,111],ef=[1,112],ep=[1,113],eg=[1,114],em=[1,115],ev=[1,116],eb=[1,124],ey=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],ex=[2,222],e_=[1,130],eS=[1,135],ew=[1,131],eT=[1,132],eP=[1,133],eE=[1,136],eC=[1,129],eA=[1,6,33,35,52,74,76,96,137,144,155,157,158,159,165,166,183],eI=[1,6,33,35,46,47,52,74,76,91,96,105,106,107,110,111,112,115,119,135,136,137,144,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],eM=[2,129],eR=[2,133],eO=[6,33,91,96],ek=[2,106],eN=[1,148],eL=[1,147],eD=[1,142],eB=[1,151],eF=[1,156],eV=[1,154],eG=[1,160],eU=[1,166],ez=[1,162],ej=[1,163],eH=[1,165],eW=[1,170],eq=[1,6,33,35,46,47,52,66,74,76,91,96,105,106,107,110,111,112,115,119,135,136,137,144,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],eX=[2,126],e$=[1,6,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],eY=[2,31],eZ=[1,195],eK=[1,196],eJ=[2,93],eQ=[1,202],e1=[1,208],e0=[1,223],e2=[1,218],e3=[1,227],e5=[1,224],e6=[1,229],e4=[1,230],e9=[1,232],e8=[2,227],e7=[1,234],te=[14,32,33,39,40,44,46,47,54,55,59,60,61,62,63,64,73,75,82,85,87,88,89,93,94,108,109,117,120,122,131,139,149,153,154,157,159,162,165,176,182,185,186,187,188,189,190,191,192],tt=[1,6,33,35,46,47,52,66,74,76,91,96,105,106,107,110,111,112,115,119,121,135,136,137,144,155,157,158,159,165,166,183,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205],tr=[1,247],ti=[1,248],tn=[2,156],ts=[1,264],to=[1,265],ta=[1,267],tl=[1,277],th=[1,278],tu=[1,6,33,35,46,47,52,70,74,76,91,96,105,106,107,110,111,112,115,119,135,136,137,144,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],tc=[1,6,33,35,36,46,47,52,66,70,74,76,91,96,105,106,107,110,111,112,115,119,121,128,135,136,137,144,155,157,158,159,165,166,173,174,175,183,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205],td=[1,6,33,35,46,47,49,51,52,57,70,74,76,91,96,105,106,107,110,111,112,115,119,123,135,136,137,144,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],tf=[1,283],tp=[46,47,136],tg=[1,322],tm=[1,321],tv=[6,33],tb=[2,104],ty=[1,328],tx=[6,33,35,91,96],t_=[6,33,35,66,76,91,96],tS=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,189,190,194,195,196,197,198,199,200,201,202,203,204],tw=[2,377],tT=[2,378],tP=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,189,190,194,196,197,198,199,200,201,202,203,204],tE=[46,47,105,106,110,111,112,115,135,136],tC=[1,357],tA=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183],tI=[2,91],tM=[1,375],tR=[1,377],tO=[1,382],tk=[1,384],tN=[6,33,74,96],tL=[2,247],tD=[2,248],tB=[1,6,33,35,46,47,52,66,74,76,91,96,105,106,107,110,111,112,115,119,135,136,137,144,155,157,158,159,165,166,173,174,175,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],tF=[1,398],tV=[14,32,33,35,39,40,44,46,47,54,55,59,60,61,62,63,64,73,74,75,76,82,85,87,88,89,93,94,96,108,109,117,120,122,131,139,149,153,154,157,159,162,165,176,182,185,186,187,188,189,190,191,192],tG=[1,400],tU=[6,33,35,74,96],tz=[6,14,32,33,35,39,40,44,46,47,54,55,59,60,61,62,63,64,73,74,75,76,82,85,87,88,89,93,94,96,108,109,117,120,122,131,139,149,153,154,157,159,162,165,176,182,185,186,187,188,189,190,191,192],tj=[6,33,35,74,96,137],tH=[1,6,33,35,46,47,52,57,74,76,91,96,105,106,107,110,111,112,115,119,135,136,137,144,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],tW=[1,411],tq=[1,6,33,35,46,47,52,66,70,74,76,91,96,105,106,107,110,111,112,115,119,121,135,136,137,144,155,157,158,159,165,166,173,174,175,183,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205],tX=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,166,183],t$=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,158,166,183],tY=[2,300],tZ=[173,174,175],tK=[96,173,174,175],tJ=[6,33,119],tQ=[1,431],t1=[6,33,35,96,119],t0=[6,33,35,70,96,119],t2=[6,33,35,66,70,76,96,105,106,110,111,112,115,119,135,136],t3=[6,33,35,76,96,105,106,110,111,112,115,119,135,136],t5=[46,47,49,51],t6=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,189,190,196,197,198,199,200,201,202,203,204],t4=[2,367],t9=[2,366],t8=[35,107],t7=[14,32,35,39,40,44,46,47,54,55,59,60,61,62,63,64,73,75,82,85,87,88,89,93,94,107,108,109,117,120,122,131,139,149,153,154,157,159,162,165,176,182,185,186,187,188,189,190,191,192],re=[2,233],rt=[6,33,35],rr=[2,105],ri=[1,470],rn=[1,471],rs=[1,6,33,35,46,47,52,74,76,91,96,105,106,107,110,111,112,115,119,135,136,137,144,151,152,155,157,158,159,165,166,178,180,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],ro=[1,337],ra=[35,178,180],rl=[1,6,35,52,74,76,91,96,107,119,137,144,155,158,166,183],rh=[1,509],ru=[1,516],rc=[1,6,33,35,52,74,76,96,137,144,155,158,166,183],rd=[2,120],rf=[1,529],rp=[33,35,74],rg=[1,537],rm=[6,33,35,96,137],rv=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,178,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],rb=[1,6,33,35,52,74,76,96,137,144,155,158,166,178],ry=[2,314],rx=[2,315],r_=[2,330],rS=[1,557],rw=[1,558],rT=[6,33,35,119],rP=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,159,165,166,183],rE=[6,33,35,96],rC=[1,6,33,35,52,74,76,91,96,107,119,137,144,151,155,157,158,159,165,166,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],rA=[33,96],rI=[1,611],rM=[1,612],rR=[1,619],rO=[1,620],rk=[1,638],rN=[1,639],rL=[2,285],rD=[2,288],rB=[2,301],rF=[2,316],rV=[2,320],rG=[2,317],rU=[2,321],rz=[2,318],rj=[2,319],rH=[2,331],rW=[2,332],rq=[1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,183],rX=[2,322],r$=[2,324],rY=[2,326],rZ=[2,328],rK=[2,323],rJ=[2,325],rQ=[2,327],r1=[2,329],r0={trace:function(){},yy:{},symbols_:{error:2,Root:3,Body:4,Line:5,TERMINATOR:6,Expression:7,ExpressionLine:8,Statement:9,FuncDirective:10,YieldReturn:11,AwaitReturn:12,Return:13,STATEMENT:14,Import:15,Export:16,Value:17,Code:18,Operation:19,Assign:20,If:21,Try:22,While:23,For:24,Switch:25,Class:26,Throw:27,Yield:28,CodeLine:29,IfLine:30,OperationLine:31,YIELD:32,INDENT:33,Object:34,OUTDENT:35,FROM:36,Block:37,Identifier:38,IDENTIFIER:39,JSX_TAG:40,Property:41,PROPERTY:42,AlphaNumeric:43,NUMBER:44,String:45,STRING:46,STRING_START:47,Interpolations:48,STRING_END:49,InterpolationChunk:50,INTERPOLATION_START:51,INTERPOLATION_END:52,Regex:53,REGEX:54,REGEX_START:55,Invocation:56,REGEX_END:57,Literal:58,JS:59,UNDEFINED:60,NULL:61,BOOL:62,INFINITY:63,NAN:64,Assignable:65,"=":66,AssignObj:67,ObjAssignable:68,ObjRestValue:69,":":70,SimpleObjAssignable:71,ThisProperty:72,"[":73,"]":74,"@":75,"...":76,ObjSpreadExpr:77,ObjSpreadIdentifier:78,Parenthetical:79,Super:80,This:81,SUPER:82,OptFuncExist:83,Arguments:84,DYNAMIC_IMPORT:85,Accessor:86,RETURN:87,AWAIT:88,PARAM_START:89,ParamList:90,PARAM_END:91,FuncGlyph:92,"->":93,"=>":94,OptComma:95,",":96,Param:97,ParamVar:98,Array:99,Splat:100,SimpleAssignable:101,Range:102,DoIife:103,MetaProperty:104,".":105,INDEX_START:106,INDEX_END:107,NEW_TARGET:108,IMPORT_META:109,"?.":110,"::":111,"?::":112,Index:113,IndexValue:114,INDEX_SOAK:115,Slice:116,"{":117,AssignList:118,"}":119,CLASS:120,EXTENDS:121,IMPORT:122,ASSERT:123,ImportDefaultSpecifier:124,ImportNamespaceSpecifier:125,ImportSpecifierList:126,ImportSpecifier:127,AS:128,DEFAULT:129,IMPORT_ALL:130,EXPORT:131,ExportSpecifierList:132,EXPORT_ALL:133,ExportSpecifier:134,FUNC_EXIST:135,CALL_START:136,CALL_END:137,ArgList:138,THIS:139,Elisions:140,ArgElisionList:141,OptElisions:142,RangeDots:143,"..":144,Arg:145,ArgElision:146,Elision:147,SimpleArgs:148,TRY:149,Catch:150,FINALLY:151,CATCH:152,THROW:153,"(":154,")":155,WhileLineSource:156,WHILE:157,WHEN:158,UNTIL:159,WhileSource:160,Loop:161,LOOP:162,ForBody:163,ForLineBody:164,FOR:165,BY:166,ForStart:167,ForSource:168,ForLineSource:169,ForVariables:170,OWN:171,ForValue:172,FORIN:173,FOROF:174,FORFROM:175,SWITCH:176,Whens:177,ELSE:178,When:179,LEADING_WHEN:180,IfBlock:181,IF:182,POST_IF:183,IfBlockLine:184,UNARY:185,DO:186,DO_IIFE:187,UNARY_MATH:188,"-":189,"+":190,"--":191,"++":192,"?":193,MATH:194,"**":195,SHIFT:196,COMPARE:197,"&":198,"^":199,"|":200,"&&":201,"||":202,"BIN?":203,RELATION:204,COMPOUND_ASSIGN:205,$accept:0,$end:1},terminals_:{2:"error",6:"TERMINATOR",14:"STATEMENT",32:"YIELD",33:"INDENT",35:"OUTDENT",36:"FROM",39:"IDENTIFIER",40:"JSX_TAG",42:"PROPERTY",44:"NUMBER",46:"STRING",47:"STRING_START",49:"STRING_END",51:"INTERPOLATION_START",52:"INTERPOLATION_END",54:"REGEX",55:"REGEX_START",57:"REGEX_END",59:"JS",60:"UNDEFINED",61:"NULL",62:"BOOL",63:"INFINITY",64:"NAN",66:"=",70:":",73:"[",74:"]",75:"@",76:"...",82:"SUPER",85:"DYNAMIC_IMPORT",87:"RETURN",88:"AWAIT",89:"PARAM_START",91:"PARAM_END",93:"->",94:"=>",96:",",105:".",106:"INDEX_START",107:"INDEX_END",108:"NEW_TARGET",109:"IMPORT_META",110:"?.",111:"::",112:"?::",115:"INDEX_SOAK",117:"{",119:"}",120:"CLASS",121:"EXTENDS",122:"IMPORT",123:"ASSERT",128:"AS",129:"DEFAULT",130:"IMPORT_ALL",131:"EXPORT",133:"EXPORT_ALL",135:"FUNC_EXIST",136:"CALL_START",137:"CALL_END",139:"THIS",144:"..",149:"TRY",151:"FINALLY",152:"CATCH",153:"THROW",154:"(",155:")",157:"WHILE",158:"WHEN",159:"UNTIL",162:"LOOP",165:"FOR",166:"BY",171:"OWN",173:"FORIN",174:"FOROF",175:"FORFROM",176:"SWITCH",178:"ELSE",180:"LEADING_WHEN",182:"IF",183:"POST_IF",185:"UNARY",186:"DO",187:"DO_IIFE",188:"UNARY_MATH",189:"-",190:"+",191:"--",192:"++",193:"?",194:"MATH",195:"**",196:"SHIFT",197:"COMPARE",198:"&",199:"^",200:"|",201:"&&",202:"||",203:"BIN?",204:"RELATION",205:"COMPOUND_ASSIGN"},productions_:[0,[3,0],[3,1],[4,1],[4,3],[4,2],[5,1],[5,1],[5,1],[5,1],[10,1],[10,1],[9,1],[9,1],[9,1],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[8,1],[8,1],[8,1],[28,1],[28,2],[28,4],[28,3],[37,2],[37,3],[38,1],[38,1],[41,1],[43,1],[43,1],[45,1],[45,3],[48,1],[48,2],[50,3],[50,5],[50,2],[50,1],[53,1],[53,3],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[20,3],[20,4],[20,5],[67,1],[67,1],[67,3],[67,5],[67,3],[67,5],[71,1],[71,1],[71,1],[68,1],[68,3],[68,4],[68,1],[69,2],[69,2],[69,2],[69,2],[77,1],[77,1],[77,1],[77,1],[77,1],[77,3],[77,2],[77,3],[77,3],[78,2],[78,2],[13,2],[13,4],[13,1],[11,3],[11,2],[12,3],[12,2],[18,5],[18,2],[29,5],[29,2],[92,1],[92,1],[95,0],[95,1],[90,0],[90,1],[90,3],[90,4],[90,6],[97,1],[97,2],[97,2],[97,3],[97,1],[98,1],[98,1],[98,1],[98,1],[100,2],[100,2],[101,1],[101,2],[101,2],[101,1],[65,1],[65,1],[65,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[80,3],[80,4],[80,6],[104,3],[104,3],[86,2],[86,2],[86,2],[86,2],[86,1],[86,1],[86,1],[113,3],[113,5],[113,2],[114,1],[114,1],[34,4],[118,0],[118,1],[118,3],[118,4],[118,6],[26,1],[26,2],[26,3],[26,4],[26,2],[26,3],[26,4],[26,5],[15,2],[15,4],[15,4],[15,6],[15,4],[15,6],[15,5],[15,7],[15,7],[15,9],[15,6],[15,8],[15,9],[15,11],[126,1],[126,3],[126,4],[126,4],[126,6],[127,1],[127,3],[127,1],[127,3],[124,1],[125,3],[16,3],[16,5],[16,2],[16,4],[16,5],[16,6],[16,3],[16,5],[16,4],[16,6],[16,5],[16,7],[16,7],[16,9],[132,1],[132,3],[132,4],[132,4],[132,6],[134,1],[134,3],[134,3],[134,1],[134,3],[56,3],[56,3],[56,3],[56,2],[83,0],[83,1],[84,2],[84,4],[81,1],[81,1],[72,2],[99,2],[99,3],[99,4],[143,1],[143,1],[102,5],[102,5],[116,3],[116,2],[116,3],[116,2],[116,2],[116,1],[138,1],[138,3],[138,4],[138,4],[138,6],[145,1],[145,1],[145,1],[145,1],[141,1],[141,3],[141,4],[141,4],[141,6],[146,1],[146,2],[142,1],[142,2],[140,1],[140,2],[147,1],[147,2],[148,1],[148,1],[148,3],[148,3],[22,2],[22,3],[22,4],[22,5],[150,3],[150,3],[150,2],[27,2],[27,4],[79,3],[79,5],[156,2],[156,4],[156,2],[156,4],[160,2],[160,4],[160,4],[160,2],[160,4],[160,4],[23,2],[23,2],[23,2],[23,2],[23,1],[161,2],[161,2],[24,2],[24,2],[24,2],[24,2],[163,2],[163,4],[163,2],[164,4],[164,2],[167,2],[167,3],[167,3],[172,1],[172,1],[172,1],[172,1],[170,1],[170,3],[168,2],[168,2],[168,4],[168,4],[168,4],[168,4],[168,4],[168,4],[168,6],[168,6],[168,6],[168,6],[168,6],[168,6],[168,6],[168,6],[168,2],[168,4],[168,4],[169,2],[169,2],[169,4],[169,4],[169,4],[169,4],[169,4],[169,4],[169,6],[169,6],[169,6],[169,6],[169,6],[169,6],[169,6],[169,6],[169,2],[169,4],[169,4],[25,5],[25,5],[25,7],[25,7],[25,4],[25,6],[177,1],[177,2],[179,3],[179,4],[181,3],[181,5],[21,1],[21,3],[21,3],[21,3],[184,3],[184,5],[30,1],[30,3],[30,3],[30,3],[31,2],[31,2],[31,2],[19,2],[19,2],[19,2],[19,2],[19,2],[19,2],[19,4],[19,2],[19,2],[19,2],[19,2],[19,2],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,5],[19,4],[103,2]],performAction:function(e,t,r,i,n,s,o){var a,l,h,u,c,d,p,g,m,v,b,y,x=s.length-1;switch(n){case 1:return this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Root(new i.Block));case 2:return this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Root(s[x]));case 3:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(i.Block.wrap([s[x]]));break;case 4:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(s[x-2].push(s[x]));break;case 5:this.$=s[x-1];break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 41:case 52:case 54:case 64:case 69:case 70:case 71:case 72:case 75:case 80:case 81:case 82:case 83:case 84:case 104:case 105:case 116:case 117:case 118:case 119:case 125:case 126:case 129:case 135:case 149:case 247:case 248:case 249:case 251:case 264:case 265:case 308:case 309:case 364:case 370:this.$=s[x];break;case 13:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.StatementLiteral(s[x]));break;case 31:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Op(s[x],new i.Value(new i.Literal(""))));break;case 32:case 374:case 375:case 376:case 378:case 379:case 382:case 405:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op(s[x-1],s[x]));break;case 33:case 383:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Op(s[x-3],s[x-1]));break;case 34:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Op(s[x-2].concat(s[x-1]),s[x]));break;case 35:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Block);break;case 36:case 150:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(s[x-1]);break;case 37:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.IdentifierLiteral(s[x]));break;case 38:;this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.JSXTag(s[x].toString(),{tagNameLocationData:s[x].tagNameToken[2],closingTagOpeningBracketLocationData:null==(a=s[x].closingTagOpeningBracketToken)?void 0:a[2],closingTagSlashLocationData:null==(l=s[x].closingTagSlashToken)?void 0:l[2],closingTagNameLocationData:null==(h=s[x].closingTagNameToken)?void 0:h[2],closingTagClosingBracketLocationData:null==(u=s[x].closingTagClosingBracketToken)?void 0:u[2]}));break;case 39:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.PropertyName(s[x].toString()));break;case 40:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.NumberLiteral(s[x].toString(),{parsedValue:s[x].parsedValue}));break;case 42:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.StringLiteral(s[x].slice(1,-1),{quote:s[x].quote,initialChunk:s[x].initialChunk,finalChunk:s[x].finalChunk,indent:s[x].indent,double:s[x].double,heregex:s[x].heregex}));break;case 43:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.StringWithInterpolations(i.Block.wrap(s[x-1]),{quote:s[x-2].quote,startQuote:i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.Literal(s[x-2].toString()))}));break;case 44:case 107:case 157:case 183:case 208:case 242:case 256:case 260:case 312:case 358:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)([s[x]]);break;case 45:case 257:case 261:case 359:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(s[x-1].concat(s[x]));break;case 46:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Interpolation(s[x-1]));break;case 47:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Interpolation(s[x-2]));break;case 48:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Interpolation);break;case 49:case 293:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(s[x]);break;case 50:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.RegexLiteral(s[x].toString(),{delimiter:s[x].delimiter,heregexCommentTokens:s[x].heregexCommentTokens}));break;case 51:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.RegexWithInterpolations(s[x-1],{heregexCommentTokens:s[x].heregexCommentTokens}));break;case 53:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.PassthroughLiteral(s[x].toString(),{here:s[x].here,generated:s[x].generated}));break;case 55:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.UndefinedLiteral(s[x]));break;case 56:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.NullLiteral(s[x]));break;case 57:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.BooleanLiteral(s[x].toString(),{originalValue:s[x].original}));break;case 58:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.InfinityLiteral(s[x].toString(),{originalValue:s[x].original}));break;case 59:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.NaNLiteral(s[x]));break;case 60:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Assign(s[x-2],s[x]));break;case 61:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Assign(s[x-3],s[x]));break;case 62:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Assign(s[x-4],s[x-1]));break;case 63:case 122:case 127:case 128:case 130:case 131:case 132:case 133:case 134:case 136:case 137:case 310:case 311:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Value(s[x]));break;case 65:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Assign(i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.Value(s[x-2])),s[x],"object",{operatorToken:i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))}));break;case 66:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Assign(i.addDataToNode(i,o[x-4],s[x-4],null,null,!0)(new i.Value(s[x-4])),s[x-1],"object",{operatorToken:i.addDataToNode(i,o[x-3],s[x-3],null,null,!0)(new i.Literal(s[x-3]))}));break;case 67:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Assign(i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.Value(s[x-2])),s[x],null,{operatorToken:i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))}));break;case 68:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Assign(i.addDataToNode(i,o[x-4],s[x-4],null,null,!0)(new i.Value(s[x-4])),s[x-1],null,{operatorToken:i.addDataToNode(i,o[x-3],s[x-3],null,null,!0)(new i.Literal(s[x-3]))}));break;case 73:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Value(new i.ComputedPropertyName(s[x-1])));break;case 74:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Value(i.addDataToNode(i,o[x-3],s[x-3],null,null,!0)(new i.ThisLiteral(s[x-3])),[i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.ComputedPropertyName(s[x-1]))],"this"));break;case 76:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Splat(new i.Value(s[x-1])));break;case 77:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Splat(new i.Value(s[x]),{postfix:!1}));break;case 78:case 120:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Splat(s[x-1]));break;case 79:case 121:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Splat(s[x],{postfix:!1}));break;case 85:case 220:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.SuperCall(i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.Super),s[x],s[x-1].soak,s[x-2]));break;case 86:case 221:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.DynamicImportCall(i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.DynamicImport),s[x]));break;case 87:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Call(new i.Value(s[x-2]),s[x],s[x-1].soak));break;case 88:case 219:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Call(s[x-2],s[x],s[x-1].soak));break;case 89:case 90:case 124:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Value(s[x-1]).add(s[x]));break;case 91:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Return(s[x]));break;case 92:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Return(new i.Value(s[x-1])));break;case 93:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Return);break;case 94:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.YieldReturn(s[x],{returnKeyword:i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))}));break;case 95:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.YieldReturn(null,{returnKeyword:i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Literal(s[x]))}));break;case 96:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.AwaitReturn(s[x],{returnKeyword:i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))}));break;case 97:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.AwaitReturn(null,{returnKeyword:i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Literal(s[x]))}));break;case 98:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Code(s[x-3],s[x],s[x-1],i.addDataToNode(i,o[x-4],s[x-4],null,null,!0)(new i.Literal(s[x-4]))));break;case 99:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Code([],s[x],s[x-1]));break;case 100:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Code(s[x-3],i.addDataToNode(i,o[x],s[x],null,null,!0)(i.Block.wrap([s[x]])),s[x-1],i.addDataToNode(i,o[x-4],s[x-4],null,null,!0)(new i.Literal(s[x-4]))));break;case 101:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Code([],i.addDataToNode(i,o[x],s[x],null,null,!0)(i.Block.wrap([s[x]])),s[x-1]));break;case 102:case 103:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.FuncGlyph(s[x]));break;case 106:case 156:case 258:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)([]);break;case 108:case 158:case 184:case 209:case 243:case 252:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(s[x-2].concat(s[x]));break;case 109:case 159:case 185:case 210:case 244:case 253:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(s[x-3].concat(s[x]));break;case 110:case 160:case 187:case 212:case 246:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(s[x-5].concat(s[x-2]));break;case 111:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Param(s[x]));break;case 112:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Param(s[x-1],null,!0));break;case 113:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Param(s[x],null,{postfix:!1}));break;case 114:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Param(s[x-2],s[x]));break;case 115:case 250:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Expansion);break;case 123:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(s[x-1].add(s[x]));break;case 138:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Super(i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Access(s[x])),i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.Literal(s[x-2]))));break;case 139:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Super(i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Index(s[x-1])),i.addDataToNode(i,o[x-3],s[x-3],null,null,!0)(new i.Literal(s[x-3]))));break;case 140:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(new i.Super(i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.Index(s[x-2])),i.addDataToNode(i,o[x-5],s[x-5],null,null,!0)(new i.Literal(s[x-5]))));break;case 141:case 142:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.MetaProperty(i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.IdentifierLiteral(s[x-2])),i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Access(s[x]))));break;case 143:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Access(s[x]));break;case 144:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Access(s[x],{soak:!0}));break;case 145:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)([i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Access(new i.PropertyName("prototype"),{shorthand:!0})),i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Access(s[x]))]);break;case 146:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)([i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Access(new i.PropertyName("prototype"),{shorthand:!0,soak:!0})),i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Access(s[x]))]);break;case 147:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Access(new i.PropertyName("prototype"),{shorthand:!0}));break;case 148:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Access(new i.PropertyName("prototype"),{shorthand:!0,soak:!0}));break;case 151:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(s[x-2]);break;case 152:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(i.extend(s[x],{soak:!0}));break;case 153:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Index(s[x]));break;case 154:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Slice(s[x]));break;case 155:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Obj(s[x-2],s[x-3].generated));break;case 161:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Class);break;case 162:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Class(null,null,s[x]));break;case 163:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Class(null,s[x]));break;case 164:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Class(null,s[x-1],s[x]));break;case 165:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Class(s[x]));break;case 166:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Class(s[x-1],null,s[x]));break;case 167:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Class(s[x-2],s[x]));break;case 168:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Class(s[x-3],s[x-1],s[x]));break;case 169:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.ImportDeclaration(null,s[x]));break;case 170:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.ImportDeclaration(null,s[x-2],s[x]));break;case 171:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(s[x-2],null),s[x]));break;case 172:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(s[x-4],null),s[x-2],s[x]));break;case 173:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(null,s[x-2]),s[x]));break;case 174:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(null,s[x-4]),s[x-2],s[x]));break;case 175:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(null,new i.ImportSpecifierList([])),s[x]));break;case 176:this.$=i.addDataToNode(i,o[x-6],s[x-6],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(null,new i.ImportSpecifierList([])),s[x-2],s[x]));break;case 177:this.$=i.addDataToNode(i,o[x-6],s[x-6],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(null,new i.ImportSpecifierList(s[x-4])),s[x]));break;case 178:this.$=i.addDataToNode(i,o[x-8],s[x-8],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(null,new i.ImportSpecifierList(s[x-6])),s[x-2],s[x]));break;case 179:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(s[x-4],s[x-2]),s[x]));break;case 180:this.$=i.addDataToNode(i,o[x-7],s[x-7],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(s[x-6],s[x-4]),s[x-2],s[x]));break;case 181:this.$=i.addDataToNode(i,o[x-8],s[x-8],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(s[x-7],new i.ImportSpecifierList(s[x-4])),s[x]));break;case 182:this.$=i.addDataToNode(i,o[x-10],s[x-10],o[x],s[x],!0)(new i.ImportDeclaration(new i.ImportClause(s[x-9],new i.ImportSpecifierList(s[x-6])),s[x-2],s[x]));break;case 186:case 211:case 245:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(s[x-2]);break;case 188:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.ImportSpecifier(s[x]));break;case 189:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ImportSpecifier(s[x-2],s[x]));break;case 190:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.ImportSpecifier(i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.DefaultLiteral(s[x]))));break;case 191:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ImportSpecifier(i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.DefaultLiteral(s[x-2])),s[x]));break;case 192:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.ImportDefaultSpecifier(s[x]));break;case 193:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ImportNamespaceSpecifier(new i.Literal(s[x-2]),s[x]));break;case 194:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ExportNamedDeclaration(new i.ExportSpecifierList([])));break;case 195:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.ExportNamedDeclaration(new i.ExportSpecifierList(s[x-2])));break;case 196:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.ExportNamedDeclaration(s[x]));break;case 197:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.ExportNamedDeclaration(i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Assign(s[x-2],s[x],null,{moduleDeclaration:"export"}))));break;case 198:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.ExportNamedDeclaration(i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Assign(s[x-3],s[x],null,{moduleDeclaration:"export"}))));break;case 199:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(new i.ExportNamedDeclaration(i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Assign(s[x-4],s[x-1],null,{moduleDeclaration:"export"}))));break;case 200:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ExportDefaultDeclaration(s[x]));break;case 201:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.ExportDefaultDeclaration(new i.Value(s[x-1])));break;case 202:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.ExportAllDeclaration(new i.Literal(s[x-2]),s[x]));break;case 203:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(new i.ExportAllDeclaration(new i.Literal(s[x-4]),s[x-2],s[x]));break;case 204:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.ExportNamedDeclaration(new i.ExportSpecifierList([]),s[x]));break;case 205:this.$=i.addDataToNode(i,o[x-6],s[x-6],o[x],s[x],!0)(new i.ExportNamedDeclaration(new i.ExportSpecifierList([]),s[x-2],s[x]));break;case 206:this.$=i.addDataToNode(i,o[x-6],s[x-6],o[x],s[x],!0)(new i.ExportNamedDeclaration(new i.ExportSpecifierList(s[x-4]),s[x]));break;case 207:this.$=i.addDataToNode(i,o[x-8],s[x-8],o[x],s[x],!0)(new i.ExportNamedDeclaration(new i.ExportSpecifierList(s[x-6]),s[x-2],s[x]));break;case 213:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.ExportSpecifier(s[x]));break;case 214:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ExportSpecifier(s[x-2],s[x]));break;case 215:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ExportSpecifier(s[x-2],i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.DefaultLiteral(s[x]))));break;case 216:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.ExportSpecifier(i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.DefaultLiteral(s[x]))));break;case 217:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.ExportSpecifier(i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.DefaultLiteral(s[x-2])),s[x]));break;case 218:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.TaggedTemplateCall(s[x-2],s[x],s[x-1].soak));break;case 222:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)({soak:!1});break;case 223:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)({soak:!0});break;case 224:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)([]);break;case 225:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)((s[x-2].implicit=s[x-3].generated,s[x-2]));break;case 226:case 227:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Value(new i.ThisLiteral(s[x])));break;case 228:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Value(i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.ThisLiteral(s[x-1])),[i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Access(s[x]))],"this"));break;case 229:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Arr([]));break;case 230:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Arr(s[x-1]));break;case 231:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Arr([].concat(s[x-2],s[x-1])));break;case 232:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)({exclusive:!1});break;case 233:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)({exclusive:!0});break;case 234:case 235:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Range(s[x-3],s[x-1],s[x-2].exclusive?"exclusive":"inclusive"));break;case 236:case 238:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Range(s[x-2],s[x],s[x-1].exclusive?"exclusive":"inclusive"));break;case 237:case 239:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Range(s[x-1],null,s[x].exclusive?"exclusive":"inclusive"));break;case 240:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Range(null,s[x],s[x-1].exclusive?"exclusive":"inclusive"));break;case 241:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Range(null,null,s[x].exclusive?"exclusive":"inclusive"));break;case 254:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(s[x-2].concat(s[x-1]));break;case 255:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(s[x-5].concat(s[x-4],s[x-2],s[x-1]));break;case 259:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)([].concat(s[x]));break;case 262:this.$=i.addDataToNode(i,o[x],s[x],o[x],s[x],!0)(new i.Elision);break;case 263:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(s[x-1]);break;case 266:case 267:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)([].concat(s[x-2],s[x]));break;case 268:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Try(s[x]));break;case 269:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Try(s[x-1],s[x]));break;case 270:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Try(s[x-2],null,s[x],i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))));break;case 271:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Try(s[x-3],s[x-2],s[x],i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))));break;case 272:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Catch(s[x],s[x-1]));break;case 273:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Catch(s[x],i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Value(s[x-1]))));break;case 274:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Catch(s[x]));break;case 275:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Throw(s[x]));break;case 276:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Throw(new i.Value(s[x-1])));break;case 277:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Parens(s[x-1]));break;case 278:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Parens(s[x-2]));break;case 279:case 283:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.While(s[x]));break;case 280:case 284:case 285:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.While(s[x-2],{guard:s[x]}));break;case 281:case 286:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.While(s[x],{invert:!0}));break;case 282:case 287:case 288:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.While(s[x-2],{invert:!0,guard:s[x]}));break;case 289:case 290:case 298:case 299:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(s[x-1].addBody(s[x]));break;case 291:case 292:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(Object.assign(s[x],{postfix:!0}).addBody(i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(i.Block.wrap([s[x-1]]))));break;case 294:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.While(i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.BooleanLiteral("true")),{isLoop:!0}).addBody(s[x]));break;case 295:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.While(i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.BooleanLiteral("true")),{isLoop:!0}).addBody(i.addDataToNode(i,o[x],s[x],null,null,!0)(i.Block.wrap([s[x]]))));break;case 296:case 297:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)((s[x].postfix=!0,s[x].addBody(s[x-1])));break;case 300:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.For([],{source:i.addDataToNode(i,o[x],s[x],null,null,!0)(new i.Value(s[x]))}));break;case 301:case 303:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.For([],{source:i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(new i.Value(s[x-2])),step:s[x]}));break;case 302:case 304:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(s[x-1].addSource(s[x]));break;case 305:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.For([],{name:s[x][0],index:s[x][1]}));break;case 306:;this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)((d=(p=f(s[x],2))[0],c=p[1],new i.For([],{name:d,index:c,await:!0,awaitTag:i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))})));break;case 307:;this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)((m=(v=f(s[x],2))[0],g=v[1],new i.For([],{name:m,index:g,own:!0,ownTag:i.addDataToNode(i,o[x-1],s[x-1],null,null,!0)(new i.Literal(s[x-1]))})));break;case 313:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)([s[x-2],s[x]]);break;case 314:case 333:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)({source:s[x]});break;case 315:case 334:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)({source:s[x],object:!0});break;case 316:case 317:case 335:case 336:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)({source:s[x-2],guard:s[x]});break;case 318:case 319:case 337:case 338:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)({source:s[x-2],guard:s[x],object:!0});break;case 320:case 321:case 339:case 340:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)({source:s[x-2],step:s[x]});break;case 322:case 323:case 324:case 325:case 341:case 342:case 343:case 344:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)({source:s[x-4],guard:s[x-2],step:s[x]});break;case 326:case 327:case 328:case 329:case 345:case 346:case 347:case 348:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)({source:s[x-4],step:s[x-2],guard:s[x]});break;case 330:case 349:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)({source:s[x],from:!0});break;case 331:case 332:case 350:case 351:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)({source:s[x-2],guard:s[x],from:!0});break;case 352:case 353:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Switch(s[x-3],s[x-1]));break;case 354:case 355:this.$=i.addDataToNode(i,o[x-6],s[x-6],o[x],s[x],!0)(new i.Switch(s[x-5],s[x-3],i.addDataToNode(i,o[x-2],s[x-2],o[x-1],s[x-1],!0)(s[x-1])));break;case 356:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Switch(null,s[x-1]));break;case 357:this.$=i.addDataToNode(i,o[x-5],s[x-5],o[x],s[x],!0)(new i.Switch(null,s[x-3],i.addDataToNode(i,o[x-2],s[x-2],o[x-1],s[x-1],!0)(s[x-1])));break;case 360:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.SwitchWhen(s[x-1],s[x]));break;case 361:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!1)(i.addDataToNode(i,o[x-3],s[x-3],o[x-1],s[x-1],!0)(new i.SwitchWhen(s[x-2],s[x-1])));break;case 362:case 368:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.If(s[x-1],s[x],{type:s[x-2]}));break;case 363:case 369:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(s[x-4].addElse(i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.If(s[x-1],s[x],{type:s[x-2]}))));break;case 365:case 371:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(s[x-2].addElse(s[x]));break;case 366:case 367:case 372:case 373:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.If(s[x],i.addDataToNode(i,o[x-2],s[x-2],null,null,!0)(i.Block.wrap([s[x-2]])),{type:s[x-1],postfix:!0}));break;case 377:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op(s[x-1].toString(),s[x],void 0,void 0,{originalOperator:s[x-1].original}));break;case 380:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op("-",s[x]));break;case 381:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op("+",s[x]));break;case 384:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op("--",s[x]));break;case 385:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op("++",s[x]));break;case 386:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op("--",s[x-1],null,!0));break;case 387:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Op("++",s[x-1],null,!0));break;case 388:this.$=i.addDataToNode(i,o[x-1],s[x-1],o[x],s[x],!0)(new i.Existence(s[x-1]));break;case 389:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Op("+",s[x-2],s[x]));break;case 390:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Op("-",s[x-2],s[x]));break;case 391:case 392:case 393:case 395:case 396:case 397:case 400:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Op(s[x-1],s[x-2],s[x]));break;case 394:case 398:case 399:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Op(s[x-1].toString(),s[x-2],s[x],void 0,{originalOperator:s[x-1].original}));break;case 401:;this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Op(s[x-1].toString(),s[x-2],s[x],void 0,{invertOperator:null==(b=null==(y=s[x-1].invert)?void 0:y.original)?s[x-1].invert:b}));break;case 402:this.$=i.addDataToNode(i,o[x-2],s[x-2],o[x],s[x],!0)(new i.Assign(s[x-2],s[x],s[x-1].toString(),{originalContext:s[x-1].original}));break;case 403:this.$=i.addDataToNode(i,o[x-4],s[x-4],o[x],s[x],!0)(new i.Assign(s[x-4],s[x-1],s[x-3].toString(),{originalContext:s[x-3].original}));break;case 404:this.$=i.addDataToNode(i,o[x-3],s[x-3],o[x],s[x],!0)(new i.Assign(s[x-3],s[x],s[x-2].toString(),{originalContext:s[x-2].original}))}},table:[{1:[2,1],3:1,4:2,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{1:[3]},{1:[2,2],6:K},t(J,[2,3]),t(Q,[2,6],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(Q,[2,7]),t(Q,[2,8],{167:123,160:125,163:126,157:ee,159:et,165:er,183:eb}),t(Q,[2,9]),t(ey,[2,16],{83:127,86:128,113:134,46:ex,47:ex,136:ex,105:e_,106:eS,110:ew,111:eT,112:eP,115:eE,135:eC}),t(ey,[2,17],{113:134,86:137,105:e_,106:eS,110:ew,111:eT,112:eP,115:eE}),t(ey,[2,18]),t(ey,[2,19]),t(ey,[2,20]),t(ey,[2,21]),t(ey,[2,22]),t(ey,[2,23]),t(ey,[2,24]),t(ey,[2,25]),t(ey,[2,26]),t(ey,[2,27]),t(Q,[2,28]),t(Q,[2,29]),t(Q,[2,30]),t(eA,[2,12]),t(eA,[2,13]),t(eA,[2,14]),t(eA,[2,15]),t(Q,[2,10]),t(Q,[2,11]),t(eI,eM,{66:[1,138]}),t(eI,[2,130]),t(eI,[2,131]),t(eI,[2,132]),t(eI,eR),t(eI,[2,134]),t(eI,[2,135]),t(eI,[2,136]),t(eI,[2,137]),t(eO,ek,{90:139,97:140,98:141,38:143,72:144,99:145,34:146,39:n,40:s,73:eN,75:eL,76:eD,117:I}),{5:150,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,33:eB,34:66,37:149,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:152,8:153,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:157,8:158,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:159,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:167,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:168,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:169,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:eW,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:[1,171],88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{17:173,18:174,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:175,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,89:eG,92:161,93:P,94:E,99:65,101:172,102:32,103:34,104:37,108:C,109:A,117:I,139:k,154:D,187:eH},{17:173,18:174,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:175,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,89:eG,92:161,93:P,94:E,99:65,101:176,102:32,103:34,104:37,108:C,109:A,117:I,139:k,154:D,187:eH},t(eq,eX,{191:[1,177],192:[1,178],205:[1,179]}),t(ey,[2,364],{178:[1,180]}),{33:eB,37:181},{33:eB,37:182},{33:eB,37:183},t(ey,[2,293]),{33:eB,37:184},{33:eB,37:185},{7:186,8:187,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:[1,188],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(e$,[2,161],{58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,99:65,34:66,43:67,53:69,38:85,72:86,45:95,92:161,17:173,18:174,65:175,37:189,101:191,33:eB,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,89:eG,93:P,94:E,108:C,109:A,117:I,121:[1,190],139:k,154:D,187:eH}),{7:192,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,193],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t([1,6,35,52,74,76,96,137,144,155,157,158,159,165,166,183,193,194,195,196,197,198,199,200,201,202,203,204],eY,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:194,14:r,32:eF,33:eZ,36:eK,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:[1,197],88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,162:V,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),t(Q,[2,370],{178:[1,198]}),{18:200,29:199,89:T,92:39,93:P,94:E},t([1,6,35,52,74,76,96,137,144,155,157,158,159,165,166,183],eJ,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:201,14:r,32:eF,33:eQ,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,162:V,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),{38:207,39:n,40:s,45:203,46:a,47:l,117:[1,206],124:204,125:205,130:e1},{26:210,38:211,39:n,40:s,117:[1,209],120:M,129:[1,212],133:[1,213]},t(eq,[2,127]),t(eq,[2,128]),t(eI,[2,52]),t(eI,[2,53]),t(eI,[2,54]),t(eI,[2,55]),t(eI,[2,56]),t(eI,[2,57]),t(eI,[2,58]),t(eI,[2,59]),{4:214,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,33:[1,215],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:216,8:217,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:e0,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,74:e2,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,96:e5,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,140:219,141:220,145:225,146:222,147:221,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{83:228,105:e6,106:e4,135:eC,136:ex},{84:231,136:e9},t(eI,[2,226]),t(eI,e8,{41:233,42:e7}),{105:[1,235]},{105:[1,236]},t(te,[2,102]),t(te,[2,103]),t(tt,[2,122]),t(tt,[2,125]),{7:237,8:238,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:239,8:240,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:241,8:242,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:244,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:eB,34:66,37:243,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{34:253,38:250,39:n,40:s,72:251,73:b,75:eL,88:tr,99:252,102:245,117:I,170:246,171:ti,172:249},{168:254,169:255,173:[1,256],174:[1,257],175:[1,258]},t([6,33,96,119],tn,{45:95,118:259,67:260,68:261,69:262,71:263,43:266,77:268,38:269,41:270,72:271,78:272,34:273,79:274,80:275,81:276,39:n,40:s,42:e7,44:o,46:a,47:l,73:ts,75:to,76:ta,82:tl,85:th,117:I,139:k,154:D}),t(tu,[2,40]),t(tu,[2,41]),t(eI,[2,50]),{17:173,18:174,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:279,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:175,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,89:eG,92:161,93:P,94:E,99:65,101:280,102:32,103:34,104:37,108:C,109:A,117:I,139:k,154:D,187:eH},t(tc,[2,37]),t(tc,[2,38]),t(td,[2,42]),{45:284,46:a,47:l,48:281,50:282,51:tf},t(J,[2,5],{7:4,8:5,9:6,10:7,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,11:27,12:28,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,181:49,160:51,156:52,161:53,163:54,164:55,184:60,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,5:285,14:r,32:i,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:w,89:T,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:z,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z}),t(ey,[2,388]),{7:286,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:287,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:288,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:289,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:290,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:291,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:292,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:293,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:294,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:295,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:296,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:297,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:298,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:299,8:300,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(ey,[2,292]),t(ey,[2,297]),{7:239,8:301,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:241,8:302,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{34:253,38:250,39:n,40:s,72:251,73:b,75:eL,88:tr,99:252,102:303,117:I,170:246,171:ti,172:249},{168:254,173:[1,304],174:[1,305],175:[1,306]},{7:307,8:308,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(ey,[2,291]),t(ey,[2,296]),{45:309,46:a,47:l,84:310,136:e9},t(tt,[2,123]),t(tp,[2,223]),{41:311,42:e7},{41:312,42:e7},t(tt,[2,147],{41:313,42:e7}),t(tt,[2,148],{41:314,42:e7}),t(tt,[2,149]),{7:317,8:319,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:[1,316],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:tg,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,114:315,116:318,117:I,120:M,122:R,131:O,139:k,143:320,144:tm,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{106:eS,113:323,115:eE},t(tt,[2,124]),{6:[1,325],7:324,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,326],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tv,tb,{95:329,91:[1,327],96:ty}),t(tx,[2,107]),t(tx,[2,111],{66:[1,331],76:[1,330]}),t(tx,[2,115],{38:143,72:144,99:145,34:146,98:332,39:n,40:s,73:eN,75:eL,117:I}),t(t_,[2,116]),t(t_,[2,117]),t(t_,[2,118]),t(t_,[2,119]),{41:233,42:e7},{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:e0,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,74:e2,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,96:e5,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,140:219,141:220,145:225,146:222,147:221,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(eI,[2,99]),t(Q,[2,101]),{4:336,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,34:66,35:[1,335],38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tS,tw,{160:118,163:119,167:123,193:eo}),t(Q,[2,374]),{7:169,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:eW,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{157:ee,159:et,160:125,163:126,165:er,167:123,183:eb},t([1,6,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,193,194,195,196,197,198,199,200,201,202,203,204],eY,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:194,14:r,32:eF,33:eZ,36:eK,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,162:V,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),t(tS,tT,{160:118,163:119,167:123,193:eo}),t(Q,[2,375]),t(tP,[2,379],{160:118,163:119,167:123,193:eo,195:el}),t(eO,ek,{97:140,98:141,38:143,72:144,99:145,34:146,90:338,39:n,40:s,73:eN,75:eL,76:eD,117:I}),{33:eB,37:149},{7:339,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:340,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{157:ee,159:et,160:125,163:126,165:er,167:123,183:[1,341]},{18:200,89:eG,92:161,93:P,94:E},{7:342,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tP,[2,380],{160:118,163:119,167:123,193:eo,195:el}),t(tP,[2,381],{160:118,163:119,167:123,193:eo,195:el}),t(tS,[2,382],{160:118,163:119,167:123,193:eo}),{34:343,117:I},t(Q,[2,97],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:344,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:eJ,159:eJ,165:eJ,183:eJ,162:V,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),t(ey,[2,384],{46:eX,47:eX,105:eX,106:eX,110:eX,111:eX,112:eX,115:eX,135:eX,136:eX}),t(tp,ex,{83:127,86:128,113:134,105:e_,106:eS,110:ew,111:eT,112:eP,115:eE,135:eC}),{86:137,105:e_,106:eS,110:ew,111:eT,112:eP,113:134,115:eE},t(tE,eM),t(ey,[2,385],{46:eX,47:eX,105:eX,106:eX,110:eX,111:eX,112:eX,115:eX,135:eX,136:eX}),t(ey,[2,386]),t(ey,[2,387]),{6:[1,347],7:345,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,346],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{33:eB,37:348,182:[1,349]},t(ey,[2,268],{150:350,151:[1,351],152:[1,352]}),t(ey,[2,289]),t(ey,[2,290]),t(ey,[2,298]),t(ey,[2,299]),{33:[1,353],157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[1,354]},{177:355,179:356,180:tC},t(ey,[2,162]),{7:358,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(e$,[2,165],{37:359,33:eB,46:eX,47:eX,105:eX,106:eX,110:eX,111:eX,112:eX,115:eX,135:eX,136:eX,121:[1,360]}),t(tA,[2,275],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{34:361,117:I},t(tA,[2,32],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{34:362,117:I},{7:363,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t([1,6,35,52,74,76,96,137,144,155,158,166],[2,95],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:364,14:r,32:eF,33:eQ,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:eJ,159:eJ,165:eJ,183:eJ,162:V,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),{33:eB,37:365,182:[1,366]},t(Q,[2,376]),t(eI,[2,405]),t(eA,tI,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{34:367,117:I},t(eA,[2,169],{123:[1,368]}),{36:[1,369],96:[1,370]},{36:[1,371]},{33:tM,38:376,39:n,40:s,119:[1,372],126:373,127:374,129:tR},t([36,96],[2,192]),{128:[1,378]},{33:tO,38:383,39:n,40:s,119:[1,379],129:tk,132:380,134:381},t(eA,[2,196]),{66:[1,385]},{7:386,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,387],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{36:[1,388]},{6:K,155:[1,389]},{4:390,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tN,tL,{160:118,163:119,167:123,143:391,76:[1,392],144:tm,157:ee,159:et,165:er,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tN,tD,{143:393,76:tg,144:tm}),t(tB,[2,229]),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,74:[1,394],75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,96:e5,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,145:396,147:395,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t([6,33,74],tb,{142:397,95:399,96:tF}),t(tV,[2,260],{6:tG}),t(tU,[2,251]),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:e0,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,96:e5,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,140:402,141:401,145:225,146:222,147:221,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tz,[2,262]),t(tU,[2,256]),t(tj,[2,249]),t(tj,[2,250],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:403,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),{84:404,136:e9},{41:405,42:e7},{7:406,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,407],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tH,[2,221]),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:tW,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,137:[1,408],138:409,139:k,145:410,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tq,[2,228]),t(tq,[2,39]),{41:412,42:e7},{41:413,42:e7},{33:eB,37:414,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:eB,37:415},t(tX,[2,283],{160:118,163:119,167:123,157:ee,158:[1,416],159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{33:[2,279],158:[1,417]},t(tX,[2,286],{160:118,163:119,167:123,157:ee,158:[1,418],159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{33:[2,281],158:[1,419]},t(ey,[2,294]),t(t$,[2,295],{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{33:tY,166:[1,420]},t(tZ,[2,305]),{34:253,38:250,39:n,40:s,72:251,73:eN,75:eL,99:252,117:I,170:421,172:249},{34:253,38:250,39:n,40:s,72:251,73:eN,75:eL,99:252,117:I,170:422,172:249},t(tZ,[2,312],{96:[1,423]}),t(tK,[2,308]),t(tK,[2,309]),t(tK,[2,310]),t(tK,[2,311]),t(ey,[2,302]),{33:[2,304]},{7:424,8:425,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:426,8:427,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:428,8:429,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tJ,tb,{95:430,96:tQ}),t(t1,[2,157]),t(t1,[2,63],{70:[1,432]}),t(t1,[2,64]),t(t0,[2,72],{113:134,83:435,86:436,66:[1,433],76:[1,434],105:e_,106:eS,110:ew,111:eT,112:eP,115:eE,135:eC,136:ex}),{7:437,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t([76,105,106,110,111,112,115,135,136],e8,{41:233,42:e7,73:[1,438]}),t(t0,[2,75]),{34:273,38:269,39:n,40:s,41:270,42:e7,71:439,72:271,75:y,77:440,78:272,79:274,80:275,81:276,82:tl,85:th,117:I,139:k,154:D},{76:[1,441],83:442,86:443,105:e_,106:eS,110:ew,111:eT,112:eP,113:134,115:eE,135:eC,136:ex},t(t2,[2,69]),t(t2,[2,70]),t(t2,[2,71]),t(t3,[2,80]),t(t3,[2,81]),t(t3,[2,82]),t(t3,[2,83]),t(t3,[2,84]),{83:444,105:e6,106:e4,135:eC,136:ex},{84:445,136:e9},t(tE,eR,{57:[1,446]}),t(tE,eX),{45:284,46:a,47:l,49:[1,447],50:448,51:tf},t(t5,[2,44]),{4:449,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,33:[1,450],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,52:[1,451],53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(t5,[2,49]),t(J,[2,4]),t(t6,[2,389],{160:118,163:119,167:123,193:eo,194:ea,195:el}),t(t6,[2,390],{160:118,163:119,167:123,193:eo,194:ea,195:el}),t(tP,[2,391],{160:118,163:119,167:123,193:eo,195:el}),t(tP,[2,392],{160:118,163:119,167:123,193:eo,195:el}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,196,197,198,199,200,201,202,203,204],[2,393],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,197,198,199,200,201,202,203],[2,394],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,204:ev}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,198,199,200,201,202,203],[2,395],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,204:ev}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,199,200,201,202,203],[2,396],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,204:ev}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,200,201,202,203],[2,397],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,204:ev}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,201,202,203],[2,398],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,204:ev}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,202,203],[2,399],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,204:ev}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,203],[2,400],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,204:ev}),t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,166,183,197,198,199,200,201,202,203,204],[2,401],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh}),t(t$,t4,{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(Q,[2,373]),{158:[1,452]},{158:[1,453]},t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,158,159,165,183,189,190,193,194,195,196,197,198,199,200,201,202,203,204],tY,{166:[1,454]}),{7:455,8:456,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:457,8:458,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:459,8:460,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(t$,t9,{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(Q,[2,372]),t(tH,[2,218]),t(tH,[2,219]),t(tt,[2,143]),t(tt,[2,144]),t(tt,[2,145]),t(tt,[2,146]),{107:[1,461]},{7:317,8:319,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:tg,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,114:462,116:318,117:I,120:M,122:R,131:O,139:k,143:320,144:tm,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(t8,[2,153],{160:118,163:119,167:123,143:463,76:tg,144:tm,157:ee,159:et,165:er,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(t8,[2,154]),{76:tg,143:464,144:tm},t(t8,[2,241],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:465,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),t(t7,[2,232]),t(t7,re),t(tt,[2,152]),t(tA,[2,60],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{7:466,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:467,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{92:468,93:P,94:E},t(rt,rr,{98:141,38:143,72:144,99:145,34:146,97:469,39:n,40:s,73:eN,75:eL,76:eD,117:I}),{6:ri,33:rn},t(tx,[2,112]),{7:472,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tx,[2,113]),t(tj,tL,{160:118,163:119,167:123,76:[1,473],157:ee,159:et,165:er,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tj,tD),t(rs,[2,35]),{6:K,35:[1,474]},{7:475,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tv,tb,{95:329,91:[1,476],96:ty}),t(tS,tw,{160:118,163:119,167:123,193:eo}),t(tS,tT,{160:118,163:119,167:123,193:eo}),{7:477,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{33:eB,37:414,157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{35:[1,478]},t(Q,[2,96],{160:118,163:119,167:123,157:tI,159:tI,165:tI,183:tI,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,[2,402],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{7:479,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:480,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(ey,[2,365]),{7:481,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(ey,[2,269],{151:[1,482]}),{33:eB,37:483},{33:eB,34:485,37:486,38:484,39:n,40:s,117:I},{177:487,179:356,180:tC},{177:488,179:356,180:tC},{35:[1,489],178:[1,490],179:491,180:tC},t(ra,[2,358]),{7:493,8:494,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,148:492,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(rl,[2,163],{160:118,163:119,167:123,37:495,33:eB,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(ey,[2,166]),{7:496,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{35:[1,497]},{35:[1,498]},t(tA,[2,34],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(Q,[2,94],{160:118,163:119,167:123,157:tI,159:tI,165:tI,183:tI,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(Q,[2,371]),{7:500,8:499,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{35:[1,501]},{34:502,117:I},{45:503,46:a,47:l},{117:[1,505],125:504,130:e1},{45:506,46:a,47:l},{36:[1,507]},t(tJ,tb,{95:508,96:rh}),t(t1,[2,183]),{33:tM,38:376,39:n,40:s,126:510,127:374,129:tR},t(t1,[2,188],{128:[1,511]}),t(t1,[2,190],{128:[1,512]}),{38:513,39:n,40:s},t(eA,[2,194],{36:[1,514]}),t(tJ,tb,{95:515,96:ru}),t(t1,[2,208]),{33:tO,38:383,39:n,40:s,129:tk,132:517,134:381},t(t1,[2,213],{128:[1,518]}),t(t1,[2,216],{128:[1,519]}),{6:[1,521],7:520,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,522],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(rc,[2,200],{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{34:523,117:I},{45:524,46:a,47:l},t(eI,[2,277]),{6:K,35:[1,525]},{7:526,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t([14,32,39,40,44,46,47,54,55,59,60,61,62,63,64,73,75,82,85,87,88,89,93,94,108,109,117,120,122,131,139,149,153,154,157,159,162,165,176,182,185,186,187,188,189,190,191,192],re,{6:rd,33:rd,74:rd,96:rd}),{7:527,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tB,[2,230]),t(tV,[2,261],{6:tG}),t(tU,[2,257]),{33:rf,74:[1,528]},t([6,33,35,74],rr,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,181:49,160:51,156:52,161:53,163:54,164:55,184:60,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,9:155,147:221,145:225,100:226,7:333,8:334,146:530,140:531,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,76:e3,82:x,85:_,87:S,88:eV,89:T,93:P,94:E,96:e5,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:z,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z}),t(rp,[2,258],{6:[1,532]}),t(tz,[2,263]),t(rt,tb,{95:399,142:533,96:tF}),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,96:e5,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,145:396,147:395,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tj,[2,121],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tH,[2,220]),t(eI,[2,138]),{107:[1,534],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{7:535,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tH,[2,224]),t([6,33,137],tb,{95:536,96:rg}),t(rm,[2,242]),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:tW,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,138:538,139:k,145:410,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(eI,[2,141]),t(eI,[2,142]),t(rv,[2,362]),t(rb,[2,368]),{7:539,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:540,8:541,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:542,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:543,8:544,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:545,8:546,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tZ,[2,306]),t(tZ,[2,307]),{34:253,38:250,39:n,40:s,72:251,73:eN,75:eL,99:252,117:I,172:547},{33:ry,157:ee,158:[1,548],159:et,160:118,163:119,165:er,166:[1,549],167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,333],158:[1,550],166:[1,551]},{33:rx,157:ee,158:[1,552],159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,334],158:[1,553]},{33:r_,157:ee,158:[1,554],159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,349],158:[1,555]},{6:rS,33:rw,119:[1,556]},t(rT,rr,{45:95,68:261,69:262,71:263,43:266,77:268,38:269,41:270,72:271,78:272,34:273,79:274,80:275,81:276,67:559,39:n,40:s,42:e7,44:o,46:a,47:l,73:ts,75:to,76:ta,82:tl,85:th,117:I,139:k,154:D}),{7:560,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,561],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:562,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,33:[1,563],34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(t1,[2,76]),{84:564,136:e9},t(t3,[2,89]),{74:[1,565],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{7:566,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(t1,[2,77],{113:134,83:435,86:436,105:e_,106:eS,110:ew,111:eT,112:eP,115:eE,135:eC,136:ex}),t(t1,[2,79],{113:134,83:442,86:443,105:e_,106:eS,110:ew,111:eT,112:eP,115:eE,135:eC,136:ex}),t(t1,[2,78]),{84:567,136:e9},t(t3,[2,90]),{84:568,136:e9},t(t3,[2,86]),t(eI,[2,51]),t(td,[2,43]),t(t5,[2,45]),{6:K,52:[1,569]},{4:570,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(t5,[2,48]),{7:571,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:572,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:573,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t([1,6,33,35,52,74,76,91,96,107,119,137,144,155,157,159,165,183],ry,{160:118,163:119,167:123,158:[1,574],166:[1,575],189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{158:[1,576],166:[1,577]},t(rP,rx,{160:118,163:119,167:123,158:[1,578],189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{158:[1,579]},t(rP,r_,{160:118,163:119,167:123,158:[1,580],189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{158:[1,581]},t(tt,[2,150]),{35:[1,582]},t(t8,[2,237],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:583,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),t(t8,[2,239],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,181:49,160:51,156:52,161:53,163:54,164:55,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,92:161,9:164,7:584,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,82:x,85:_,87:S,88:eV,89:eG,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z}),t(t8,[2,240],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,[2,61],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{35:[1,585],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{5:587,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:i,33:eB,34:66,37:586,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:w,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tx,[2,108]),{34:146,38:143,39:n,40:s,72:144,73:eN,75:eL,76:eD,97:588,98:141,99:145,117:I},t(rE,ek,{97:140,98:141,38:143,72:144,99:145,34:146,90:589,39:n,40:s,73:eN,75:eL,76:eD,117:I}),t(tx,[2,114],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tj,rd),t(rs,[2,36]),t(t$,t4,{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{92:590,93:P,94:E},t(t$,t9,{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(ey,[2,383]),{35:[1,591],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},t(tA,[2,404],{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{33:eB,37:592,157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:eB,37:593},t(ey,[2,270]),{33:eB,37:594},{33:eB,37:595},t(rC,[2,274]),{35:[1,596],178:[1,597],179:491,180:tC},{35:[1,598],178:[1,599],179:491,180:tC},t(ey,[2,356]),{33:eB,37:600},t(ra,[2,359]),{33:eB,37:601,96:[1,602]},t(rA,[2,264],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(rA,[2,265]),t(ey,[2,164]),t(rl,[2,167],{160:118,163:119,167:123,37:603,33:eB,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(ey,[2,276]),t(ey,[2,33]),{33:eB,37:604},{157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},t(eA,[2,92]),t(eA,[2,170]),t(eA,[2,171],{123:[1,605]}),{36:[1,606]},{33:tM,38:376,39:n,40:s,126:607,127:374,129:tR},t(eA,[2,173],{123:[1,608]}),{45:609,46:a,47:l},{6:rI,33:rM,119:[1,610]},t(rT,rr,{38:376,127:613,39:n,40:s,129:tR}),t(rt,tb,{95:614,96:rh}),{38:615,39:n,40:s},{38:616,39:n,40:s},{36:[2,193]},{45:617,46:a,47:l},{6:rR,33:rO,119:[1,618]},t(rT,rr,{38:383,134:621,39:n,40:s,129:tk}),t(rt,tb,{95:622,96:ru}),{38:623,39:n,40:s,129:[1,624]},{38:625,39:n,40:s},t(rc,[2,197],{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{7:626,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:627,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{35:[1,628]},t(eA,[2,202],{123:[1,629]}),{155:[1,630]},{74:[1,631],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{74:[1,632],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},t(tB,[2,231]),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:e0,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,96:e5,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,140:402,141:633,145:225,146:222,147:221,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tU,[2,252]),t(rp,[2,259],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,181:49,160:51,156:52,161:53,163:54,164:55,184:60,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,9:155,100:226,7:333,8:334,147:395,145:396,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,76:e3,82:x,85:_,87:S,88:eV,89:T,93:P,94:E,96:e5,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:z,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z}),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,96:e5,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,140:402,145:225,146:634,147:221,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{33:rf,35:[1,635]},t(eI,[2,139]),{35:[1,636],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{6:rk,33:rN,137:[1,637]},t([6,33,35,137],rr,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,181:49,160:51,156:52,161:53,163:54,164:55,184:60,99:65,34:66,43:67,53:69,38:85,72:86,167:92,45:95,9:155,100:226,7:333,8:334,145:640,14:r,32:eF,39:n,40:s,44:o,46:a,47:l,54:h,55:u,59:c,60:d,61:p,62:g,63:m,64:v,73:b,75:y,76:e3,82:x,85:_,87:S,88:eV,89:T,93:P,94:E,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,157:B,159:F,162:V,165:G,176:U,182:z,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z}),t(rt,tb,{95:641,96:rg}),t(t$,[2,284],{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{33:rL,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,280]},t(t$,[2,287],{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{33:rD,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,282]},{33:rB,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,303]},t(tZ,[2,313]),{7:642,8:643,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:644,8:645,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:646,8:647,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:648,8:649,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:650,8:651,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:652,8:653,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:654,8:655,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:656,8:657,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(tB,[2,155]),{34:273,38:269,39:n,40:s,41:270,42:e7,43:266,44:o,45:95,46:a,47:l,67:658,68:261,69:262,71:263,72:271,73:ts,75:to,76:ta,77:268,78:272,79:274,80:275,81:276,82:tl,85:th,117:I,139:k,154:D},t(rE,tn,{45:95,67:260,68:261,69:262,71:263,43:266,77:268,38:269,41:270,72:271,78:272,34:273,79:274,80:275,81:276,118:659,39:n,40:s,42:e7,44:o,46:a,47:l,73:ts,75:to,76:ta,82:tl,85:th,117:I,139:k,154:D}),t(t1,[2,158]),t(t1,[2,65],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{7:660,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(t1,[2,67],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{7:661,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(t3,[2,87]),t(t0,[2,73]),{74:[1,662],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},t(t3,[2,88]),t(t3,[2,85]),t(t5,[2,46]),{6:K,35:[1,663]},t(t$,rL,{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(t$,rD,{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(t$,rB,{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{7:664,8:665,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:666,8:667,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:668,8:669,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:670,8:671,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:672,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:673,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:674,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:675,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{107:[1,676]},t(t8,[2,236],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(t8,[2,238],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(ey,[2,62]),t(eI,[2,98]),t(Q,[2,100]),t(tx,[2,109]),t(rt,tb,{95:677,96:ty}),{33:eB,37:586},t(ey,[2,403]),t(rv,[2,363]),t(ey,[2,271]),t(rC,[2,272]),t(rC,[2,273]),t(ey,[2,352]),{33:eB,37:678},t(ey,[2,353]),{33:eB,37:679},{35:[1,680]},t(ra,[2,360],{6:[1,681]}),{7:682,8:683,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(ey,[2,168]),t(rb,[2,369]),{34:684,117:I},{45:685,46:a,47:l},t(tJ,tb,{95:686,96:rh}),{34:687,117:I},t(eA,[2,175],{123:[1,688]}),{36:[1,689]},{38:376,39:n,40:s,127:690,129:tR},{33:tM,38:376,39:n,40:s,126:691,127:374,129:tR},t(t1,[2,184]),{6:rI,33:rM,35:[1,692]},t(t1,[2,189]),t(t1,[2,191]),t(eA,[2,204],{123:[1,693]}),t(eA,[2,195],{36:[1,694]}),{38:383,39:n,40:s,129:tk,134:695},{33:tO,38:383,39:n,40:s,129:tk,132:696,134:381},t(t1,[2,209]),{6:rR,33:rO,35:[1,697]},t(t1,[2,214]),t(t1,[2,215]),t(t1,[2,217]),t(rc,[2,198],{160:118,163:119,167:123,157:ee,159:et,165:er,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{35:[1,698],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},t(eA,[2,201]),{34:699,117:I},t(eI,[2,278]),t(eI,[2,234]),t(eI,[2,235]),t(rt,tb,{95:399,142:700,96:tF}),t(tU,[2,253]),t(tU,[2,254]),{107:[1,701]},t(tH,[2,225]),{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,145:702,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:333,8:334,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,33:tW,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,76:e3,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,100:226,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,138:703,139:k,145:410,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},t(rm,[2,243]),{6:rk,33:rN,35:[1,704]},{33:rF,157:ee,159:et,160:118,163:119,165:er,166:[1,705],167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,335],166:[1,706]},{33:rV,157:ee,158:[1,707],159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,339],158:[1,708]},{33:rG,157:ee,159:et,160:118,163:119,165:er,166:[1,709],167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,336],166:[1,710]},{33:rU,157:ee,158:[1,711],159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,340],158:[1,712]},{33:rz,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,337]},{33:rj,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,338]},{33:rH,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,350]},{33:rW,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,351]},t(t1,[2,159]),t(rt,tb,{95:713,96:tQ}),{35:[1,714],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{35:[1,715],157:ee,159:et,160:118,163:119,165:er,167:123,183:ro,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},t(t0,[2,74]),{52:[1,716]},t(rq,rF,{160:118,163:119,167:123,166:[1,717],189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{166:[1,718]},t(rP,rV,{160:118,163:119,167:123,158:[1,719],189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{158:[1,720]},t(rq,rG,{160:118,163:119,167:123,166:[1,721],189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{166:[1,722]},t(rP,rU,{160:118,163:119,167:123,158:[1,723],189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),{158:[1,724]},t(tA,rz,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rj,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rH,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rW,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tt,[2,151]),{6:ri,33:rn,35:[1,725]},{35:[1,726]},{35:[1,727]},t(ey,[2,357]),t(ra,[2,361]),t(rA,[2,266],{160:118,163:119,167:123,157:ee,159:et,165:er,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(rA,[2,267]),t(eA,[2,172]),t(eA,[2,179],{123:[1,728]}),{6:rI,33:rM,119:[1,729]},t(eA,[2,174]),{34:730,117:I},{45:731,46:a,47:l},t(t1,[2,185]),t(rt,tb,{95:732,96:rh}),t(t1,[2,186]),{34:733,117:I},{45:734,46:a,47:l},t(t1,[2,210]),t(rt,tb,{95:735,96:ru}),t(t1,[2,211]),t(eA,[2,199]),t(eA,[2,203]),{33:rf,35:[1,736]},t(eI,[2,140]),t(rm,[2,244]),t(rt,tb,{95:737,96:rg}),t(rm,[2,245]),{7:738,8:739,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:740,8:741,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:742,8:743,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:744,8:745,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:746,8:747,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:748,8:749,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:750,8:751,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{7:752,8:753,9:155,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:T,92:39,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:z,184:60,185:j,186:H,187:W,188:q,189:X,190:$,191:Y,192:Z},{6:rS,33:rw,35:[1,754]},t(t1,[2,66]),t(t1,[2,68]),t(t5,[2,47]),{7:755,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:756,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:757,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:758,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:759,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:760,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:761,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},{7:762,9:164,13:23,14:r,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:eF,34:66,38:85,39:n,40:s,43:67,44:o,45:95,46:a,47:l,53:69,54:h,55:u,56:33,58:30,59:c,60:d,61:p,62:g,63:m,64:v,65:29,72:86,73:b,75:y,79:31,80:36,81:35,82:x,85:_,87:S,88:eV,89:eG,92:161,93:P,94:E,99:65,101:48,102:32,103:34,104:37,108:C,109:A,117:I,120:M,122:R,131:O,139:k,149:N,153:L,154:D,156:52,157:B,159:F,160:51,161:53,162:V,163:54,164:55,165:G,167:92,176:U,181:49,182:eU,185:ez,186:ej,187:eH,188:q,189:X,190:$,191:Y,192:Z},t(tx,[2,110]),t(ey,[2,354]),t(ey,[2,355]),{34:763,117:I},{36:[1,764]},t(eA,[2,176]),t(eA,[2,177],{123:[1,765]}),{6:rI,33:rM,35:[1,766]},t(eA,[2,205]),t(eA,[2,206],{123:[1,767]}),{6:rR,33:rO,35:[1,768]},t(tU,[2,255]),{6:rk,33:rN,35:[1,769]},{33:rX,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,341]},{33:r$,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,343]},{33:rY,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,345]},{33:rZ,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,347]},{33:rK,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,342]},{33:rJ,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,344]},{33:rQ,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,346]},{33:r1,157:ee,159:et,160:118,163:119,165:er,167:123,183:ei,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev},{33:[2,348]},t(t1,[2,160]),t(tA,rX,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,r$,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rY,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rZ,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rK,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rJ,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,rQ,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(tA,r1,{160:118,163:119,167:123,189:en,190:es,193:eo,194:ea,195:el,196:eh,197:eu,198:ec,199:ed,200:ef,201:ep,202:eg,203:em,204:ev}),t(eA,[2,180]),{45:770,46:a,47:l},{34:771,117:I},t(t1,[2,187]),{34:772,117:I},t(t1,[2,212]),t(rm,[2,246]),t(eA,[2,181],{123:[1,773]}),t(eA,[2,178]),t(eA,[2,207]),{34:774,117:I},t(eA,[2,182])],defaultActions:{255:[2,304],513:[2,193],541:[2,280],544:[2,282],546:[2,303],651:[2,337],653:[2,338],655:[2,350],657:[2,351],739:[2,341],741:[2,343],743:[2,345],745:[2,347],747:[2,342],749:[2,344],751:[2,346],753:[2,348]},parseError:function(e,t){if(t.recoverable)this.trace(e);else{var r=Error(e);throw r.hash=t,r}},parse:function(e){var t=this,r=[0],i=[null],n=[],s=this.table,o="",a=0,l=0,h=0,u=n.slice.call(arguments,1),c=Object.create(this.lexer),d={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(d.yy[f]=this.yy[f]);c.setInput(e,d.yy),d.yy.lexer=c,d.yy.parser=this,void 0===c.yylloc&&(c.yylloc={});var p=c.yylloc;n.push(p);var g=c.options&&c.options.ranges;this.parseError="function"==typeof d.yy.parseError?d.yy.parseError:Object.getPrototypeOf(this).parseError;for(var m,v,b,y,x,_,S,w,T,P={};;){if(b=r[r.length-1],this.defaultActions[b]?y=this.defaultActions[b]:(null==m&&(m=function(){var e;return"number"!=typeof(e=c.lex()||1)&&(e=t.symbols_[e]||e),e}()),y=s[b]&&s[b][m]),void 0===y||!y.length||!y[0]){var E="";for(_ in T=[],s[b])this.terminals_[_]&&_>2&&T.push("'"+this.terminals_[_]+"'");E=c.showPosition?"Parse error on line "+(a+1)+":\n"+c.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==m?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(E,{text:c.match,token:this.terminals_[m]||m,line:c.yylineno,loc:p,expected:T})}if(y[0]instanceof Array&&1<y.length)throw Error("Parse Error: multiple actions possible at state: "+b+", token: "+m);switch(y[0]){case 1:r.push(m),i.push(c.yytext),n.push(c.yylloc),r.push(y[1]),m=null,v?(m=v,v=null):(l=c.yyleng,o=c.yytext,a=c.yylineno,p=c.yylloc,0<h&&h--);break;case 2:if(S=this.productions_[y[1]][1],P.$=i[i.length-S],P._$={first_line:n[n.length-(S||1)].first_line,last_line:n[n.length-1].last_line,first_column:n[n.length-(S||1)].first_column,last_column:n[n.length-1].last_column},g&&(P._$.range=[n[n.length-(S||1)].range[0],n[n.length-1].range[1]]),void 0!==(x=this.performAction.apply(P,[o,l,a,d.yy,y[1],i,n].concat(u))))return x;S&&(r=r.slice(0,-1*S*2),i=i.slice(0,-1*S),n=n.slice(0,-1*S)),r.push(this.productions_[y[1]][0]),i.push(P.$),n.push(P._$),w=s[r[r.length-2]][r[r.length-1]],r.push(w);break;case 3:return!0}}return!0}};return e.prototype=r0,r0.Parser=e,new e}(),e.parser=i,e.Parser=i.Parser,e.parse=function(){return i.parse.apply(i,arguments)},e.main=function(){},g.main===t&&e.main(process.argv.slice(1)),t.exports),g["./scope"]=function(){var e={};return(function(){var t,r=[].indexOf;e.Scope=function(){"use strict";function e(t,r,i,n){var s,o;m(this,e),this.parent=t,this.expressions=r,this.method=i,this.referencedVars=n,this.variables=[{name:"arguments",type:"arguments"}],this.comments={},this.positions={},this.parent||(this.utilities={}),this.root=null==(s=null==(o=this.parent)?void 0:o.root)?this:s}return b(e,[{key:"add",value:function(e,t,r){return this.shared&&!r?this.parent.add(e,t,r):Object.prototype.hasOwnProperty.call(this.positions,e)?this.variables[this.positions[e]].type=t:this.positions[e]=this.variables.push({name:e,type:t})-1}},{key:"namedMethod",value:function(){var e;return(null==(e=this.method)?void 0:e.name)||!this.parent?this.method:this.parent.namedMethod()}},{key:"find",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"var";return!!this.check(e)||(this.add(e,t),!1)}},{key:"parameter",value:function(e){return this.shared&&this.parent.check(e,!0)?void 0:this.add(e,"param")}},{key:"check",value:function(e){var t;return!!(this.type(e)||(null==(t=this.parent)?void 0:t.check(e)))}},{key:"temporary",value:function(e,t){var r,i,n,s,o=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return o?(r=122-(s=e.charCodeAt(0)),i=a(s+t%(r+1)),n=p(t/(r+1)),"".concat(i).concat(n||"")):"".concat(e).concat(t||"")}},{key:"type",value:function(e){var t,r,i,n;for(i=this.variables,t=0,r=i.length;t<r;t++)if((n=i[t]).name===e)return n.type;return null}},{key:"freeVariable",value:function(e){var t,i,n,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(t=0;n=this.temporary(e,t,s.single),this.check(n)||0<=r.call(this.root.referencedVars,n);)t++;return(null==(i=s.reserve)||i)&&this.add(n,"var",!0),n}},{key:"assign",value:function(e,t){return this.add(e,{value:t,assigned:!0},!0),this.hasAssignments=!0}},{key:"hasDeclarations",value:function(){return!!this.declaredVariables().length}},{key:"declaredVariables",value:function(){var e;return(function(){var t,r,i,n;for(i=this.variables,n=[],t=0,r=i.length;t<r;t++)"var"===(e=i[t]).type&&n.push(e.name);return n}).call(this).sort()}},{key:"assignedVariables",value:function(){var e,t,r,i,n;for(r=this.variables,i=[],e=0,t=r.length;e<t;e++)(n=r[e]).type.assigned&&i.push("".concat(n.name," = ").concat(n.type.value));return i}}]),e}()}).call(this),e}(),g["./nodes"]=function(){var e={};return(function(){var t,r,i,a,p,v,y,_,S,w,T,P,E,C,A,I,M,R,O,k,N,L,D,B,F,V,G,U,z,j,H,W,q,X,$,Y,Z,K,J,Q,ee,et,er,ei,en,es,eo,ea,el,eh,eu,ec,ed,ef,ep,eg,em,ev,eb,ey,ex,e_,eS,ew,eT,eP,eE,eC,eA,eI,eM,eR,eO,ek,eN,eL,eD,eB,eF,eV,eG,eU,ez,ej,eH,eW,eq,eX,e$,eY,eZ,eK,eJ,eQ,e1,e0,e2,e3,e5,e6,e4,e9,e8,e7,te,tt,tr,ti,tn,ts,to,ta,tl,th,tu,tc,td,tf,tp,tg,tm,tv,tb,ty,tx,t_,tS,tw,tT,tP,tE,tC,tA,tI,tM,tR,tO,tk,tN,tL,tD,tB,tF,tV,tG,tU,tz,tj,tH,tW,tq,tX,t$,tY,tZ,tK,tJ,tQ,t1,t0,t2,t3,t5=[].indexOf,t6=[].splice,t4=[].slice;Error.stackTraceLimit=2e308,eJ=g("./scope").Scope;var t9=g("./lexer");tB=t9.isUnassignable,eb=t9.JS_FORBIDDEN;var t8=g("./helpers");tv=t8.compact,tT=t8.flatten,t_=t8.extend,tz=t8.merge,tb=t8.del,t8.starts,t8.ends,t8.some,tp=t8.addDataToNode,tm=t8.attachCommentsToNode,tG=t8.locationDataToString,tQ=t8.throwSyntaxError,t$=t8.replaceUnicodeCodePointEscapes,t8.isFunction,t8.isPlainObject,tL=t8.isNumber,tX=t8.parseNumber,e.extend=t_,e.addDataToNode=tp,td=function(){return!0},ek=function(){return!1},tt=function(){return this},eO=function(){return this.negated=!this.negated,this},e.CodeFragment=C=function(){"use strict";function e(t,r){var i;m(this,e),this.code="".concat(r),this.type=(null==t||null==(i=t.constructor)?void 0:i.name)||"unknown",this.locationData=null==t?void 0:t.locationData,this.comments=null==t?void 0:t.comments}return b(e,[{key:"toString",value:function(){return"".concat(this.code).concat(this.locationData?": "+tG(this.locationData):"")}}]),e}(),tP=function(e){var t;return(function(){var r,i,n;for(n=[],r=0,i=e.length;r<i;r++)t=e[r],n.push(t.code);return n})().join("")},e.Base=p=(function(){var e=function(){"use strict";function e(){m(this,e)}return b(e,[{key:"compile",value:function(e,t){return tP(this.compileToFragments(e,t))}},{key:"compileWithoutComments",value:function(e,t){var r,i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"compile";return this.comments&&(this.ignoreTheseCommentsTemporarily=this.comments,delete this.comments),(i=this.unwrapAll()).comments&&(i.ignoreTheseCommentsTemporarily=i.comments,delete i.comments),r=this[n](e,t),this.ignoreTheseCommentsTemporarily&&(this.comments=this.ignoreTheseCommentsTemporarily,delete this.ignoreTheseCommentsTemporarily),i.ignoreTheseCommentsTemporarily&&(i.comments=i.ignoreTheseCommentsTemporarily,delete i.ignoreTheseCommentsTemporarily),r}},{key:"compileNodeWithoutComments",value:function(e,t){return this.compileWithoutComments(e,t,"compileNode")}},{key:"compileToFragments",value:function(e,t){var r,i;return e=t_({},e),t&&(e.level=t),(i=this.unfoldSoak(e)||this).tab=e.indent,r=e.level!==eP&&i.isStatement(e)?i.compileClosure(e):i.compileNode(e),this.compileCommentFragments(e,i,r),r}},{key:"compileToFragmentsWithoutComments",value:function(e,t){return this.compileWithoutComments(e,t,"compileToFragments")}},{key:"compileClosure",value:function(e){var r,i,n,s,o,a,l;switch(this.checkForPureStatementInExpression(),e.sharedScope=!0,n=new E([],v.wrap([this])),r=[],this.contains(function(e){return e instanceof e4})?n.bound=!0:((i=this.contains(tR))||this.contains(tO))&&(r=[new ts],i?(s="apply",r.push(new K("arguments"))):s="call",n=new tu(n,[new t(new ej(s))])),o=new _(n,r).compileNode(e),!1){case!(n.isGenerator||(null==(a=n.base)?void 0:a.isGenerator)):o.unshift(this.makeCode("(yield* ")),o.push(this.makeCode(")"));break;case!(n.isAsync||(null==(l=n.base)?void 0:l.isAsync)):o.unshift(this.makeCode("(await ")),o.push(this.makeCode(")"))}return o}},{key:"compileCommentFragments",value:function(e,t,r){var i,n,s,o,a,l,h,u;if(!t.comments)return r;for(u=function(e){var t;return e.unshift?t0(r,e):(0!==r.length&&(t=r[r.length-1],e.newLine&&""!==t.code&&!/\n\s*$/.test(t.code)&&(e.code="\n".concat(e.code))),r.push(e))},h=t.comments,a=0,l=h.length;a<l;a++)s=h[a],0>t5.call(this.compiledComments,s)&&(this.compiledComments.push(s),(o=s.here?new Y(s).compileNode(e):new eE(s).compileNode(e)).isHereComment&&!o.newLine||t.includeCommentFragments()?u(o):(0===r.length&&r.push(this.makeCode("")),o.unshift?(null==(i=r[0]).precedingComments&&(i.precedingComments=[]),r[0].precedingComments.push(o)):(null==(n=r[r.length-1]).followingComments&&(n.followingComments=[]),r[r.length-1].followingComments.push(o))));return r}},{key:"cache",value:function(e,t,r){var n,s;return(null==r?this.shouldCache():r(this))?(n=new K(e.scope.freeVariable("ref")),s=new i(n,this),t?[s.compileToFragments(e,t),[this.makeCode(n.value)]]:[s,n]):[n=t?this.compileToFragments(e,t):this,n]}},{key:"hoist",value:function(){var e,t,r;return this.hoisted=!0,r=new Z(this),e=this.compileNode,t=this.compileToFragments,this.compileNode=function(t){return r.update(e,t)},this.compileToFragments=function(e){return r.update(t,e)},r}},{key:"cacheToCodeFragments",value:function(e){return[tP(e[0]),tP(e[1])]}},{key:"makeReturn",value:function(e,t){var r;return t?void(this.canBeReturned=!0):(r=this.unwrapAll(),e?new _(new eC("".concat(e,".push")),[r]):new eX(r))}},{key:"contains",value:function(e){var t;return t=void 0,this.traverseChildren(!1,function(r){if(e(r))return t=r,!1}),t}},{key:"lastNode",value:function(e){return 0===e.length?null:e[e.length-1]}},{key:"toString",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.constructor.name;return e="\n"+t+r,this.soak&&(e+="?"),this.eachChild(function(r){return e+=r.toString(t+te)}),e}},{key:"checkForPureStatementInExpression",value:function(){var e;if(e=this.jumps())return e.error("cannot use a pure statement in an expression")}},{key:"ast",value:function(e,t){var r;return e=this.astInitialize(e,t),r=this.astNode(e),null!=this.astNode&&this.canBeReturned&&Object.assign(r,{returns:!0}),r}},{key:"astInitialize",value:function(e,t){return e=Object.assign({},e),null!=t&&(e.level=t),e.level>eP&&this.checkForPureStatementInExpression(),this.isStatement(e)&&e.level!==eP&&null!=e.scope&&this.makeReturn(null,!0),e}},{key:"astNode",value:function(e){return Object.assign({},{type:this.astType(e)},this.astProperties(e),this.astLocationData())}},{key:"astProperties",value:function(){return{}}},{key:"astType",value:function(){return this.constructor.name}},{key:"astLocationData",value:function(){return tF(this.locationData)}},{key:"isStatementAst",value:function(e){return this.isStatement(e)}},{key:"eachChild",value:function(e){var t,r,i,n,s,o,a;if(!this.children)return this;for(o=this.children,r=0,n=o.length;r<n;r++)if(this[t=o[r]]){for(a=tT([this[t]]),i=0,s=a.length;i<s;i++)if(!1===e(a[i]))return this}return this}},{key:"traverseChildren",value:function(e,t){return this.eachChild(function(r){if(!1!==t(r))return r.traverseChildren(e,t)})}},{key:"replaceInContext",value:function(e,t){var r,i,n,s,o,a,l,h,u,c;if(!this.children)return!1;for(u=this.children,o=0,l=u.length;o<l;o++)if(n=this[r=u[o]]){if(Array.isArray(n))for(s=a=0,h=n.length;a<h;s=++a){if(e(i=n[s]))return t6.apply(n,[s,s-s+1].concat(t(i,this))),!0;if(i.replaceInContext(e,t))return!0}else{if(e(n))return this[r]=t(n,this),!0;if(n.replaceInContext(e,t))return!0}}}},{key:"invert",value:function(){return new eV("!",this)}},{key:"unwrapAll",value:function(){var e;for(e=this;e!==(e=e.unwrap());)continue;return e}},{key:"updateLocationDataIfMissing",value:function(e,t){return(t&&(this.forceUpdateLocation=!0),this.locationData&&!this.forceUpdateLocation)?this:(delete this.forceUpdateLocation,this.locationData=e,this.eachChild(function(t){return t.updateLocationDataIfMissing(e)}))}},{key:"withLocationDataFrom",value:function(e){var t=e.locationData;return this.updateLocationDataIfMissing(t)}},{key:"withLocationDataAndCommentsFrom",value:function(e){var t;return this.withLocationDataFrom(e),(null==(t=e.comments)?void 0:t.length)&&(this.comments=t),this}},{key:"error",value:function(e){return tQ(e,this.locationData)}},{key:"makeCode",value:function(e){return new C(this,e)}},{key:"wrapInParentheses",value:function(e){return[this.makeCode("(")].concat(x(e),[this.makeCode(")")])}},{key:"wrapInBraces",value:function(e){return[this.makeCode("{")].concat(x(e),[this.makeCode("}")])}},{key:"joinFragmentArrays",value:function(e,t){var r,i,n,s,o;for(r=[],n=s=0,o=e.length;s<o;n=++s)i=e[n],n&&r.push(this.makeCode(t)),r=r.concat(i);return r}}]),e}();return e.prototype.children=[],e.prototype.isStatement=ek,e.prototype.compiledComments=[],e.prototype.includeCommentFragments=ek,e.prototype.jumps=ek,e.prototype.shouldCache=td,e.prototype.isChainable=ek,e.prototype.isAssignable=ek,e.prototype.isNumber=ek,e.prototype.unwrap=tt,e.prototype.unfoldSoak=ek,e.prototype.assigns=ek,e}).call(this),e.HoistTarget=Z=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).source=e,i.options={},i.targetFragments={fragments:[]},i}o(t,e);var r=l(t);return b(t,[{key:"isStatement",value:function(e){return this.source.isStatement(e)}},{key:"update",value:function(e,t){return this.targetFragments.fragments=e.call(this.source,tz(t,this.options))}},{key:"compileToFragments",value:function(e,t){return this.options.indent=e.indent,this.options.level=null==t?e.level:t,[this.targetFragments]}},{key:"compileNode",value:function(e){return this.compileToFragments(e)}},{key:"compileClosure",value:function(e){return this.compileToFragments(e)}}],[{key:"expand",value:function(e){var t,r,i,n;for(r=i=e.length-1;0<=i;r=i+=-1)(t=e[r]).fragments&&t6.apply(e,[r,r-r+1].concat(this.expand(t.fragments)));return e}}]),t}(p),e.Root=e$=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).body=e,i.isAsync=new E([],i.body).isAsync,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r;return(e.indent=e.bare?"":te,e.level=eP,e.compiling=!0,this.initializeScope(e),t=this.body.compileRoot(e),e.bare)?t:(r="".concat(this.isAsync?"async ":"","function"),[].concat(this.makeCode("(".concat(r,"() {\n")),t,this.makeCode("\n}).call(this);\n")))}},{key:"initializeScope",value:function(e){var t,r,i,n,s,o;for(e.scope=new eJ(null,this.body,null,null==(n=e.referencedVars)?[]:n),s=e.locals||[],o=[],t=0,r=s.length;t<r;t++)i=s[t],o.push(e.scope.parameter(i));return o}},{key:"commentsAst",value:function(){var e,t,r,i,n,s;for(null==this.allComments&&(this.allComments=(function(){var e,r,i,n,s;for(n=null==(i=this.allCommentTokens)?[]:i,s=[],e=0,r=n.length;e<r;e++)(t=n[e]).heregex||(t.here?s.push(new Y(t)):s.push(new eE(t)));return s}).call(this)),n=this.allComments,s=[],r=0,i=n.length;r<i;r++)e=n[r],s.push(e.ast());return s}},{key:"astNode",value:function(e){return e.level=eP,this.initializeScope(e),s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"File"}},{key:"astProperties",value:function(e){return this.body.isRootBlock=!0,{program:Object.assign(this.body.ast(e),this.astLocationData()),comments:this.commentsAst()}}}]),t}(p);return e.prototype.children=["body"],e}).call(this),e.Block=v=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).expressions=tv(tT(e||[])),i}o(t,e);var r=l(t);return b(t,[{key:"push",value:function(e){return this.expressions.push(e),this}},{key:"pop",value:function(){return this.expressions.pop()}},{key:"unshift",value:function(e){return this.expressions.unshift(e),this}},{key:"unwrap",value:function(){return 1===this.expressions.length?this.expressions[0]:this}},{key:"isEmpty",value:function(){return!this.expressions.length}},{key:"isStatement",value:function(e){var t,r,i;for(i=this.expressions,t=0,r=i.length;t<r;t++)if(i[t].isStatement(e))return!0;return!1}},{key:"jumps",value:function(e){var t,r,i,n;for(n=this.expressions,t=0,i=n.length;t<i;t++)if(r=n[t].jumps(e))return r}},{key:"makeReturn",value:function(e,t){var r,i,n,s,o,a,l,h;if(o=this.expressions.length,l=this.expressions,(s=(null==(s=f(t4.call(l,-1),1)[0])?void 0:s.unwrap())||!1)&&s instanceof eU&&1<s.body.expressions.length){i=s.body.expressions;var u=f(t4.call(i,-2),2);a=u[0],n=u[1],a=a.unwrap(),n=n.unwrap(),a instanceof ec&&n instanceof ec&&i[i.length-1].error("Adjacent JSX elements must be wrapped in an enclosing tag")}if(t)return void(null!=(h=this.expressions[o-1])&&h.makeReturn(e,t));for(;o--;){r=this.expressions[o],this.expressions[o]=r.makeReturn(e),r instanceof eX&&!r.expression&&this.expressions.splice(o,1);break}return this}},{key:"compile",value:function(e,r){return e.scope?s(c(t.prototype),"compile",this).call(this,e,r):new e$(this).withLocationDataFrom(this).compile(e,r)}},{key:"compileNode",value:function(e){var r,i,n,s,o,a,l,h,u,c;for(this.tab=e.indent,c=e.level===eP,i=[],u=this.expressions,s=o=0,l=u.length;o<l;s=++o){if((h=u[s]).hoisted){h.compileToFragments(e);continue}(h=h.unfoldSoak(e)||h)instanceof t?i.push(h.compileNode(e)):c?(h.front=!0,n=h.compileToFragments(e),!h.isStatement(e)&&(n=tA(n,this),""===(a=f(t4.call(n,-1),1)[0]).code||a.isComment||n.push(this.makeCode(";"))),i.push(n)):i.push(h.compileToFragments(e,eS))}return c?this.spaced?[].concat(this.joinFragmentArrays(i,"\n\n"),this.makeCode("\n")):this.joinFragmentArrays(i,"\n"):(r=i.length?this.joinFragmentArrays(i,", "):[this.makeCode("void 0")],1<i.length&&e.level>=eS?this.wrapInParentheses(r):r)}},{key:"compileRoot",value:function(e){var t;return this.spaced=!0,t=this.compileWithDeclarations(e),Z.expand(t),this.compileComments(t)}},{key:"compileWithDeclarations",value:function(e){for(a=[],f=[],p=this.expressions,l=h=0,c=p.length;h<c&&(o=(o=p[l]).unwrap())instanceof eC;l=++h);if(e=tz(e,{level:eP}),l){g=this.expressions.splice(l,9e9);var t,r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,v,b,y=[this.spaced,!1];v=y[0],this.spaced=y[1];var _=[this.compileNode(e),v];a=_[0],this.spaced=_[1],this.expressions=g}if(f=this.compileNode(e),(m=e.scope).expressions===this){if(s=e.scope.hasDeclarations(),t=m.hasAssignments,s||t){if(l&&a.push(this.makeCode("\n")),a.push(this.makeCode("".concat(this.tab,"var "))),s)for(i=m.declaredVariables(),n=u=0,d=i.length;u<d;n=++u)r=i[n],a.push(this.makeCode(r)),Object.prototype.hasOwnProperty.call(e.scope.comments,r)&&(b=a).push.apply(b,x(e.scope.comments[r])),n!==i.length-1&&a.push(this.makeCode(", "));t&&(s&&a.push(this.makeCode(",\n".concat(this.tab+te))),a.push(this.makeCode(m.assignedVariables().join(",\n".concat(this.tab+te))))),a.push(this.makeCode(";\n".concat(this.spaced?"\n":"")))}else a.length&&f.length&&a.push(this.makeCode("\n"))}return a.concat(f)}},{key:"compileComments",value:function(e){var t,r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,v,b,y,x,_,S,w,T,P;for(s=a=0,u=e.length;a<u;s=++a){if((i=e[s]).precedingComments){for(n="",l=(y=e.slice(0,s+1)).length-1;0<=l;l+=-1)if(m=y[l],o=/^ {2,}/m.exec(m.code)){n=o[0];break}else if(0<=t5.call(m.code,"\n"))break;for(t="\n".concat(n)+(function(){var e,t,s,o;for(s=i.precedingComments,o=[],e=0,t=s.length;e<t;e++)(r=s[e]).isHereComment&&r.multiline?o.push(tq(r.code,n,!1)):o.push(r.code);return o})().join("\n".concat(n)).replace(/^(\s*)$/gm,""),v=h=(x=e.slice(0,s+1)).length-1;0<=h;v=h+=-1){if(-1===(f=(m=x[v]).code.lastIndexOf("\n"))){if(0===v)m.code="\n"+m.code,f=0;else{if(!m.isStringWithInterpolations||"{"!==m.code)continue;t=t.slice(1)+"\n",f=1}}delete i.precedingComments,m.code=m.code.slice(0,f)+t+m.code.slice(f);break}}if(i.followingComments){if(w=i.followingComments[0].trail,n="",!(w&&1===i.followingComments.length))for(p=!1,_=e.slice(s),g=0,c=_.length;g<c;g++)if(T=_[g],p){if(o=/^ {2,}/m.exec(T.code)){n=o[0];break}else if(0<=t5.call(T.code,"\n"))break}else{if(!(0<=t5.call(T.code,"\n")))continue;p=!0}for(t=(1===s&&/^\s+$/.test(e[0].code)?"":w?" ":"\n".concat(n))+(function(){var e,t,s,o;for(s=i.followingComments,o=[],t=0,e=s.length;t<e;t++)(r=s[t]).isHereComment&&r.multiline?o.push(tq(r.code,n,!1)):o.push(r.code);return o})().join("\n".concat(n)).replace(/^(\s*)$/gm,""),S=e.slice(s),P=b=0,d=S.length;b<d;P=++b){if(-1===(f=(T=S[P]).code.indexOf("\n"))){if(P===e.length-1)T.code+="\n",f=T.code.length;else{if(!T.isStringWithInterpolations||"}"!==T.code)continue;t="".concat(t,"\n"),f=0}}delete i.followingComments,"\n"===T.code&&(t=t.replace(/^\n/,"")),T.code=T.code.slice(0,f)+t+T.code.slice(f);break}}}return e}},{key:"astNode",value:function(e){return null!=e.level&&e.level!==eP&&this.expressions.length?new eQ(this.expressions).withLocationDataFrom(this).ast(e):s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isRootBlock?"Program":this.isClassBody?"ClassBody":"BlockStatement"}},{key:"astProperties",value:function(e){var t,r,i,n,s,o,a,l;for(r=tb(e,"checkForDirectives"),(this.isRootBlock||r)&&tZ(this.expressions,{notFinalExpression:r}),i=[],t=[],l=this.expressions,o=0,a=l.length;o<a;o++)if(null==(s=(n=l[o]).ast(e)))continue;else n instanceof M?i.push(s):n.isStatementAst(e)?t.push(s):t.push(Object.assign({type:"ExpressionStatement",expression:s},n.astLocationData()));return{body:t,directives:i}}},{key:"astLocationData",value:function(){return this.isRootBlock&&null==this.locationData?void 0:s(c(t.prototype),"astLocationData",this).call(this)}}],[{key:"wrap",value:function(e){return 1===e.length&&e[0]instanceof t?e[0]:new t(e)}}]),t}(p);return e.prototype.children=["expressions"],e}).call(this),e.Directive=M=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).value=e,i}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){return{value:Object.assign({},this.value.ast(e),{type:"DirectiveLiteral"})}}}]),t}(p),e.Literal=eC=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).value=e,i}o(t,e);var r=l(t);return b(t,[{key:"assigns",value:function(e){return e===this.value}},{key:"compileNode",value:function(){return[this.makeCode(this.value)]}},{key:"astProperties",value:function(){return{value:this.value}}},{key:"toString",value:function(){return" ".concat(this.isStatement()?s(c(t.prototype),"toString",this).call(this):this.constructor.name,": ").concat(this.value)}}]),t}(p);return e.prototype.shouldCache=ek,e}).call(this),e.NumberLiteral=eD=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.parsedValue;return m(this,t),(i=r.call(this)).value=e,i.parsedValue=s,null==i.parsedValue&&(tL(i.value)?(i.parsedValue=i.value,i.value="".concat(i.value)):i.parsedValue=tX(i.value)),i}o(t,e);var r=l(t);return b(t,[{key:"isBigInt",value:function(){return/n$/.test(this.value)}},{key:"astType",value:function(){return this.isBigInt()?"BigIntLiteral":"NumericLiteral"}},{key:"astProperties",value:function(){return{value:this.isBigInt()?this.parsedValue.toString():this.parsedValue,extra:{rawValue:this.isBigInt()?this.parsedValue.toString():this.parsedValue,raw:this.value}}}}]),t}(eC),e.InfinityLiteral=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.originalValue;return m(this,t),(i=r.call(this)).value=e,i.originalValue=void 0===s?"Infinity":s,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(){return[this.makeCode("2e308")]}},{key:"astNode",value:function(e){return"Infinity"===this.originalValue?s(c(t.prototype),"astNode",this).call(this,e):new eD(this.value).withLocationDataFrom(this).ast(e)}},{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:"Infinity",declaration:!1}}}]),t}(eD),e.NaNLiteral=function(e){"use strict";function t(){return m(this,t),r.call(this,"NaN")}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t;return t=[this.makeCode("0/0")],e.level>=ew?this.wrapInParentheses(t):t}},{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:"NaN",declaration:!1}}}]),t}(eD),e.StringLiteral=e3=function(e){"use strict";function t(e){var i,n,s,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},l=a.quote,h=a.initialChunk,u=a.finalChunk,c=a.indent,d=a.double,f=a.heregex;return m(this,t),(o=r.call(this,"")).originalValue=e,o.quote=l,o.initialChunk=h,o.finalChunk=u,o.indent=c,o.double=d,o.heregex=f,"///"===o.quote&&(o.quote=null),o.fromSourceString=null!=o.quote,null==o.quote&&(o.quote='"'),i=o.isFromHeredoc(),s=o.originalValue,o.heregex?s=t$(s=s.replace($,"$1$2"),{flags:o.heregex.flags}):(s=s.replace(eK,"$1"),s=o.fromSourceString?i?(o.indent&&(n=RegExp("\\n".concat(o.indent),"g")),n&&(s=s.replace(n,"\n")),o.initialChunk&&(s=s.replace(ey,"")),o.finalChunk&&(s=s.replace(tr,"")),s):s.replace(eZ,function(e,t){return o.initialChunk&&0===t||o.finalChunk&&t+e.length===s.length?"":" "}):s),o.delimiter=o.quote.charAt(0),o.value=tU(s,{delimiter:o.delimiter,double:o.double}),o.unquotedValueForTemplateLiteral=tU(s,{delimiter:"`",double:o.double,escapeNewlines:!1,includeDelimiters:!1,convertTrailingNullEscapes:!0}),o.unquotedValueForJSX=tU(s,{double:o.double,escapeNewlines:!1,includeDelimiters:!1,escapeDelimiter:!1}),o}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return this.shouldGenerateTemplateLiteral()?e5.fromStringLiteral(this).compileNode(e):this.jsx?[this.makeCode(this.unquotedValueForJSX)]:s(c(t.prototype),"compileNode",this).call(this,e)}},{key:"withoutQuotesInLocationData",value:function(){var e,r,i;return r="\n"===this.originalValue.slice(-1),i=Object.assign({},this.locationData),i.first_column+=this.quote.length,r?(i.last_line-=1,i.last_column=i.last_line===i.first_line?i.first_column+this.originalValue.length-1:this.originalValue.slice(0,-1).length-1-this.originalValue.slice(0,-1).lastIndexOf("\n")):i.last_column-=this.quote.length,i.last_column_exclusive-=this.quote.length,i.range=[i.range[0]+this.quote.length,i.range[1]-this.quote.length],(e=new t(this.originalValue,{quote:this.quote,initialChunk:this.initialChunk,finalChunk:this.finalChunk,indent:this.indent,double:this.double,heregex:this.heregex})).locationData=i,e}},{key:"isFromHeredoc",value:function(){return 3===this.quote.length}},{key:"shouldGenerateTemplateLiteral",value:function(){return this.isFromHeredoc()}},{key:"astNode",value:function(e){return this.shouldGenerateTemplateLiteral()?e5.fromStringLiteral(this).ast(e):s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astProperties",value:function(){return{value:this.originalValue,extra:{raw:"".concat(this.delimiter).concat(this.originalValue).concat(this.delimiter)}}}}]),t}(eC),e.RegexLiteral=eW=(function(){var e=function(e){"use strict";function t(e){var i,n,s,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},l=a.delimiter,h=a.heregexCommentTokens;return m(this,t),(o=r.call(this,"")).delimiter=void 0===l?"/":l,o.heregexCommentTokens=void 0===h?[]:h,n="///"===o.delimiter,i=e.lastIndexOf("/"),o.flags=e.slice(i+1),s=o.originalValue=e.slice(1,i),n&&(s=s.replace($,"$1$2")),s=t$(s,{flags:o.flags}),o.value="".concat(tU(s,{delimiter:"/"})).concat(o.flags),o}o(t,e);var r=l(t);return b(t,[{key:"astType",value:function(){return"RegExpLiteral"}},{key:"astProperties",value:function(e){var t;return{value:void 0,pattern:f(this.REGEX_REGEX.exec(this.value),2)[1],flags:this.flags,delimiter:this.delimiter,originalPattern:this.originalValue,extra:{raw:this.value,originalRaw:"".concat(this.delimiter).concat(this.originalValue).concat(this.delimiter).concat(this.flags),rawValue:void 0},comments:(function(){var r,i,n,s;for(n=this.heregexCommentTokens,s=[],r=0,i=n.length;r<i;r++)(t=n[r]).here?s.push(new Y(t).ast(e)):s.push(new eE(t).ast(e));return s}).call(this)}}}]),t}(eC);return e.prototype.REGEX_REGEX=/^\/(.*)\/\w*$/,e}).call(this),e.PassthroughLiteral=ez=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.here,o=n.generated;return m(this,t),(i=r.call(this,"")).originalValue=e,i.here=s,i.generated=o,i.value=i.originalValue.replace(/\\+(`|$)/g,function(e){var t=Math.ceil;return e.slice(-t(e.length/2))}),i}o(t,e);var r=l(t);return b(t,[{key:"astNode",value:function(e){return this.generated?null:s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astProperties",value:function(){return{value:this.originalValue,here:!!this.here}}}]),t}(eC),e.IdentifierLiteral=K=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"eachName",value:function(e){return e(this)}},{key:"astType",value:function(){return this.jsx?"JSXIdentifier":"Identifier"}},{key:"astProperties",value:function(){return{name:this.value,declaration:!!this.isDeclaration}}}]),t}(eC);return e.prototype.isAssignable=td,e}).call(this),e.PropertyName=ej=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astType",value:function(){return this.jsx?"JSXIdentifier":"Identifier"}},{key:"astProperties",value:function(){return{name:this.value,declaration:!1}}}]),t}(eC);return e.prototype.isAssignable=td,e}).call(this),e.ComputedPropertyName=A=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return[this.makeCode("[")].concat(x(this.value.compileToFragments(e,eS)),[this.makeCode("]")])}},{key:"astNode",value:function(e){return this.value.ast(e)}}]),t}(ej),e.StatementLiteral=e2=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"jumps",value:function(e){return("break"!==this.value||(null==e?void 0:e.loop)||(null==e?void 0:e.block))&&("continue"!==this.value||null!=e&&e.loop)?void 0:this}},{key:"compileNode",value:function(){return[this.makeCode("".concat(this.tab).concat(this.value,";"))]}},{key:"astType",value:function(){switch(this.value){case"continue":return"ContinueStatement";case"break":return"BreakStatement";case"debugger":return"DebuggerStatement"}}}]),t}(eC);return e.prototype.isStatement=td,e.prototype.makeReturn=tt,e}).call(this),e.ThisLiteral=ts=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this,"this")).shorthand="@"===e,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r;return t=(null==(r=e.scope.method)?void 0:r.bound)?e.scope.method.context:this.value,[this.makeCode(t)]}},{key:"astType",value:function(){return"ThisExpression"}},{key:"astProperties",value:function(){return{shorthand:this.shorthand}}}]),t}(eC),e.UndefinedLiteral=th=function(e){"use strict";function t(){return m(this,t),r.call(this,"undefined")}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return[this.makeCode(e.level>=ex?"(void 0)":"void 0")]}},{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:this.value,declaration:!1}}}]),t}(eC),e.NullLiteral=eL=function(e){"use strict";function t(){return m(this,t),r.call(this,"null")}o(t,e);var r=l(t);return b(t)}(eC),e.BooleanLiteral=y=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.originalValue;return m(this,t),(i=r.call(this,e)).originalValue=s,null==i.originalValue&&(i.originalValue=i.value),i}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(){return{value:"true"===this.value,name:this.originalValue}}}]),t}(eC),e.DefaultLiteral=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:"default",declaration:!1}}}]),t}(eC),e.Return=eX=(function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.belongsToFuncDirectiveReturn;return m(this,t),(i=r.call(this)).expression=e,i.belongsToFuncDirectiveReturn=s,i}o(t,e);var r=l(t);return b(t,[{key:"compileToFragments",value:function(e,r){var i,n;return!(i=null==(n=this.expression)?void 0:n.makeReturn())||i instanceof t?s(c(t.prototype),"compileToFragments",this).call(this,e,r):i.compileToFragments(e,r)}},{key:"compileNode",value:function(e){var t,r,i,n;if(t=[],this.expression)for(t=this.expression.compileToFragments(e,eT),t0(t,this.makeCode("".concat(this.tab,"return "))),i=0,n=t.length;i<n;i++)if((r=t[i]).isHereComment&&0<=t5.call(r.code,"\n"))r.code=tq(r.code,this.tab);else if(r.isLineComment)r.code="".concat(this.tab).concat(r.code);else break;else t.push(this.makeCode("".concat(this.tab,"return")));return t.push(this.makeCode(";")),t}},{key:"checkForPureStatementInExpression",value:function(){return this.belongsToFuncDirectiveReturn?void 0:s(c(t.prototype),"checkForPureStatementInExpression",this).call(this)}},{key:"astType",value:function(){return"ReturnStatement"}},{key:"astProperties",value:function(e){var t,r;return{argument:null==(t=null==(r=this.expression)?void 0:r.ast(e,eT))?null:t}}}]),t}(p);return e.prototype.children=["expression"],e.prototype.isStatement=td,e.prototype.makeReturn=tt,e.prototype.jumps=tt,e}).call(this),e.FuncDirectiveReturn=q=(function(){var e=function(e){"use strict";function t(e,i){var n,s=i.returnKeyword;return m(this,t),(n=r.call(this,e)).returnKeyword=s,n}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return this.checkScope(e),s(c(t.prototype),"compileNode",this).call(this,e)}},{key:"checkScope",value:function(e){if(null==e.scope.parent)return this.error("".concat(this.keyword," can only occur inside functions"))}},{key:"astNode",value:function(e){return this.checkScope(e),new eV(this.keyword,new eX(this.expression,{belongsToFuncDirectiveReturn:!0}).withLocationDataFrom(null==this.expression?this.returnKeyword:{locationData:tH(this.returnKeyword.locationData,this.expression.locationData)})).withLocationDataFrom(this).ast(e)}}]),t}(eX);return e.prototype.isStatementAst=ek,e}).call(this),e.YieldReturn=tf=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t)}(q);return e.prototype.keyword="yield",e}).call(this),e.AwaitReturn=a=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t)}(q);return e.prototype.keyword="await",e}).call(this),e.Value=tu=(function(){var e=function(e){"use strict";function t(e,r,i){var s,o,a,l=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];return m(this,t),(a=n.call(this),!r&&e instanceof t)?h(a,e):(a.base=e,a.properties=r||[],a.tag=i,i&&(a[i]=!0),a.isDefaultValue=l,(null==(s=a.base)?void 0:s.comments)&&a.base instanceof ts&&null!=(null==(o=a.properties[0])?void 0:o.name)&&tW(a.base,a.properties[0].name),a)}o(t,e);var n=l(t);return b(t,[{key:"add",value:function(e){return this.properties=this.properties.concat(e),this.forceUpdateLocation=!0,this}},{key:"hasProperties",value:function(){return 0!==this.properties.length}},{key:"bareLiteral",value:function(e){return!this.properties.length&&this.base instanceof e}},{key:"isArray",value:function(){return this.bareLiteral(r)}},{key:"isRange",value:function(){return this.bareLiteral(eH)}},{key:"shouldCache",value:function(){return this.hasProperties()||this.base.shouldCache()}},{key:"isAssignable",value:function(e){return this.hasProperties()||this.base.isAssignable(e)}},{key:"isNumber",value:function(){return this.bareLiteral(eD)}},{key:"isString",value:function(){return this.bareLiteral(e3)}},{key:"isRegex",value:function(){return this.bareLiteral(eW)}},{key:"isUndefined",value:function(){return this.bareLiteral(th)}},{key:"isNull",value:function(){return this.bareLiteral(eL)}},{key:"isBoolean",value:function(){return this.bareLiteral(y)}},{key:"isAtomic",value:function(){var e,t,r,i;for(i=this.properties.concat(this.base),e=0,t=i.length;e<t;e++)if((r=i[e]).soak||r instanceof _||r instanceof eV&&"do"===r.operator)return!1;return!0}},{key:"isNotCallable",value:function(){return this.isNumber()||this.isString()||this.isRegex()||this.isArray()||this.isRange()||this.isSplice()||this.isObject()||this.isUndefined()||this.isNull()||this.isBoolean()}},{key:"isStatement",value:function(e){return!this.properties.length&&this.base.isStatement(e)}},{key:"isJSXTag",value:function(){return this.base instanceof em}},{key:"assigns",value:function(e){return!this.properties.length&&this.base.assigns(e)}},{key:"jumps",value:function(e){return!this.properties.length&&this.base.jumps(e)}},{key:"isObject",value:function(e){return!this.properties.length&&this.base instanceof eB&&(!e||this.base.generated)}},{key:"isElision",value:function(){return this.base instanceof r&&this.base.hasElision()}},{key:"isSplice",value:function(){var e;return e=this.properties,f(t4.call(e,-1),1)[0]instanceof e1}},{key:"looksStatic",value:function(e){var t,r,i;return!!(((i=this.base)instanceof ts||(t=this.base).value===e)&&1===this.properties.length&&"prototype"!==(null==(r=this.properties[0].name)?void 0:r.value))&&{staticClassName:null==i?t:i}}},{key:"unwrap",value:function(){return this.properties.length?this:this.base}},{key:"cacheReference",value:function(e){var r,n,s,o,a;return(a=this.properties,s=f(t4.call(a,-1),1)[0],!(2>this.properties.length)||this.base.shouldCache()||null!=s&&s.shouldCache())?((r=new t(this.base,this.properties.slice(0,-1))).shouldCache()&&(n=new K(e.scope.freeVariable("base")),r=new t(new eU(new i(n,r)))),s)?(s.shouldCache()&&(o=new K(e.scope.freeVariable("name")),s=new eo(new i(o,s.index)),o=new eo(o)),[r.add(s),new t(n||r.base,[o||s])]):[r,n]:[this,this]}},{key:"compileNode",value:function(e){var t,r,i,n,s;for(this.base.front=this.front,t=(s=this.properties).length&&null!=this.base.cached?this.base.cached:this.base.compileToFragments(e,s.length?ex:null),s.length&&eY.test(tP(t))&&t.push(this.makeCode(".")),r=0,i=s.length;r<i;r++)n=s[r],t.push.apply(t,x(n.compileToFragments(e)));return t}},{key:"unfoldSoak",value:function(e){var r=this;return null==this.unfoldedSoak?this.unfoldedSoak=function(){var n,s,o,a,l,h,u,c,d,f;if(o=r.base.unfoldSoak(e))return(f=o.body.properties).push.apply(f,x(r.properties)),o;for(c=r.properties,s=a=0,l=c.length;a<l;s=++a)if((h=c[s]).soak)return h.soak=!1,n=new t(r.base,r.properties.slice(0,s)),d=new t(r.base,r.properties.slice(s)),n.shouldCache()&&(u=new K(e.scope.freeVariable("ref")),n=new eU(new i(u,n)),d.base=u),new J(new D(n),d,{soak:!0});return!1}():this.unfoldedSoak}},{key:"eachName",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.checkAssignability;return this.hasProperties()?e(this):!(void 0===r||r)||this.base.isAssignable()?this.base.eachName(e):this.error("tried to assign to unassignable value")}},{key:"object",value:function(){var e,r;return this.hasProperties()?(e=this.properties.slice(0,this.properties.length-1),(r=new t(this.base,e,this.tag,this.isDefaultValue)).locationData=0===e.length?this.base.locationData:tH(this.base.locationData,e[e.length-1].locationData),r):this}},{key:"containsSoak",value:function(){var e,t,r;if(!this.hasProperties())return!1;for(r=this.properties,e=0,t=r.length;e<t;e++)if(r[e].soak)return!0;return!!(this.base instanceof _&&this.base.soak)}},{key:"astNode",value:function(e){return this.hasProperties()?s(c(t.prototype),"astNode",this).call(this,e):this.base.ast(e)}},{key:"astType",value:function(){return this.isJSXTag()?"JSXMemberExpression":this.containsSoak()?"OptionalMemberExpression":"MemberExpression"}},{key:"astProperties",value:function(e){var t,r,i,n;return i=this.properties,r=f(t4.call(i,-1),1)[0],this.isJSXTag()&&(r.name.jsx=!0),t=r instanceof eo||!((null==(n=r.name)?void 0:n.unwrap())instanceof ej),{object:this.object().ast(e,ex),property:r.ast(e,t?eT:void 0),computed:t,optional:!!r.soak,shorthand:!!r.shorthand}}},{key:"astLocationData",value:function(){return this.isJSXTag()?tj(tF(this.base.tagNameLocationData),tF(this.properties[this.properties.length-1].locationData)):s(c(t.prototype),"astLocationData",this).call(this)}}]),t}(p);return e.prototype.children=["base","properties"],e}).call(this),e.MetaProperty=(function(){var e=function(e){"use strict";function r(e,t){var n;return m(this,r),(n=i.call(this)).meta=e,n.property=t,n}o(r,e);var i=l(r);return b(r,[{key:"checkValid",value:function(e){if("new"===this.meta.value){if(!(this.property instanceof t&&"target"===this.property.name.value))return this.error("the only valid meta property for new is new.target");if(null==e.scope.parent)return this.error("new.target can only occur inside functions")}else if("import"===this.meta.value&&!(this.property instanceof t&&"meta"===this.property.name.value))return this.error("the only valid meta property for import is import.meta")}},{key:"compileNode",value:function(e){var t;return this.checkValid(e),(t=[]).push.apply(t,x(this.meta.compileToFragments(e,ex))),t.push.apply(t,x(this.property.compileToFragments(e))),t}},{key:"astProperties",value:function(e){return this.checkValid(e),{meta:this.meta.ast(e,ex),property:this.property.ast(e)}}}]),r}(p);return e.prototype.children=["meta","property"],e}).call(this),e.HereComment=Y=function(e){"use strict";function t(e){var i,n=e.content,s=e.newLine,o=e.unshift,a=e.locationData;return m(this,t),(i=r.call(this)).content=n,i.newLine=s,i.unshift=o,i.locationData=a,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(){var e,t,r,i,n,s,o,a,l;if(a=0<=t5.call(this.content,"\n")){for(r=null,l=this.content.split("\n"),i=0,s=l.length;i<s;i++)o=l[i],n=/^\s*/.exec(o)[0],(!r||n.length<r.length)&&(r=n);r&&(this.content=this.content.replace(RegExp("\\n".concat(r),"g"),"\n"))}return(t=/\n\s*[#|\*]/.test(this.content))&&(this.content=this.content.replace(/^([ \t]*)#(?=\s)/gm," *")),this.content="/*".concat(this.content).concat(t?" ":"","*/"),(e=this.makeCode(this.content)).newLine=this.newLine,e.unshift=this.unshift,e.multiline=a,e.isComment=e.isHereComment=!0,e}},{key:"astType",value:function(){return"CommentBlock"}},{key:"astProperties",value:function(){return{value:this.content}}}]),t}(p),e.LineComment=eE=function(e){"use strict";function t(e){var i,n=e.content,s=e.newLine,o=e.unshift,a=e.locationData,l=e.precededByBlankLine;return m(this,t),(i=r.call(this)).content=n,i.newLine=s,i.unshift=o,i.locationData=a,i.precededByBlankLine=l,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t;return(t=this.makeCode(/^\s*$/.test(this.content)?"":"".concat(this.precededByBlankLine?"\n".concat(e.indent):"","//").concat(this.content))).newLine=this.newLine,t.unshift=this.unshift,t.trail=!this.newLine&&!this.unshift,t.isComment=t.isLineComment=!0,t}},{key:"astType",value:function(){return"CommentLine"}},{key:"astProperties",value:function(){return{value:this.content}}}]),t}(p),e.JSXIdentifier=ep=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astType",value:function(){return"JSXIdentifier"}}]),t}(K),e.JSXTag=em=function(e){"use strict";function t(e,i){var n,s=i.tagNameLocationData,o=i.closingTagOpeningBracketLocationData,a=i.closingTagSlashLocationData,l=i.closingTagNameLocationData,h=i.closingTagClosingBracketLocationData;return m(this,t),(n=r.call(this,e)).tagNameLocationData=s,n.closingTagOpeningBracketLocationData=o,n.closingTagSlashLocationData=a,n.closingTagNameLocationData=l,n.closingTagClosingBracketLocationData=h,n}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(){return{name:this.value}}}]),t}(ep),e.JSXExpressionContainer=ef=(function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.locationData;return m(this,t),(i=r.call(this)).expression=e,i.expression.jsxAttribute=!0,i.locationData=null==s?i.expression.locationData:s,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return this.expression.compileNode(e)}},{key:"astProperties",value:function(e){return{expression:tg(this.expression,e)}}}]),t}(p);return e.prototype.children=["expression"],e}).call(this),e.JSXEmptyExpression=ed=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t)}(p),e.JSXText=ev=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).value=e.unquotedValueForJSX,i.locationData=e.locationData,i}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(){return{value:this.value,extra:{raw:this.value}}}}]),t}(p),e.JSXAttribute=eh=(function(){var e=function(e){"use strict";function t(e){var i,n,s=e.name,o=e.value;return m(this,t),(n=r.call(this)).name=s,n.value=null==o?null:(o=o.base)instanceof e3&&!o.shouldGenerateTemplateLiteral()?o:new ef(o),null!=(i=n.value)&&(i.comments=o.comments),n}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r;return(t=this.name.compileToFragments(e,eS),null==this.value)?t:(r=this.value.compileToFragments(e,eS),t.concat(this.makeCode("="),r))}},{key:"astProperties",value:function(e){var t,r,i;return t=this.name,0<=t5.call(t.value,":")&&(t=new eg(t)),{name:t.ast(e),value:null==(r=null==(i=this.value)?void 0:i.ast(e))?null:r}}}]),t}(p);return e.prototype.children=["name","value"],e}).call(this),e.JSXAttributes=eu=(function(){var e=function(e){"use strict";function t(e){for(m(this,t),(i=r.call(this)).attributes=[],d=e.objects,o=0,l=d.length;o<l;o++){var i,n,s,o,a,l,h,u,c,d,f,p,g;if(u=d[o],i.checkValidAttribute(u),(s=u.base)instanceof K)(n=new eh({name:new ep(s.value).withLocationDataAndCommentsFrom(s)})).locationData=s.locationData,i.attributes.push(n);else if(s.generated)for(f=s.properties,a=0,h=f.length;a<h;a++){c=f[a];g=c.variable,p=c.value,(n=new eh({name:new ep(g.base.value).withLocationDataAndCommentsFrom(g.base),value:p})).locationData=c.locationData,i.attributes.push(n)}else(n=s.properties[0]).jsx=!0,n.locationData=s.locationData,i.attributes.push(n)}return i.locationData=e.locationData,i}o(t,e);var r=l(t);return b(t,[{key:"checkValidAttribute",value:function(e){var t,r;if(r=(null==(t=e.base)?void 0:t.properties)||[],!(t instanceof eB||t instanceof K)||t instanceof eB&&!t.generated&&(1<r.length||!(r[0]instanceof e0)))return e.error('Unexpected token. Allowed JSX attributes are: id="val", src={source}, {props...} or attribute.')}},{key:"compileNode",value:function(e){var t,r,i,n,s;for(r=[],s=this.attributes,i=0,n=s.length;i<n;i++)t=s[i],r.push(this.makeCode(" ")),r.push.apply(r,x(t.compileToFragments(e,eP)));return r}},{key:"astNode",value:function(e){var t,r,i,n,s;for(n=this.attributes,s=[],r=0,i=n.length;r<i;r++)t=n[r],s.push(t.ast(e));return s}}]),t}(p);return e.prototype.children=["attributes"],e}).call(this),e.JSXNamespacedName=eg=(function(){var e=function(e){"use strict";function t(e){m(this,t),i=r.call(this);var i,n,s,o=f(e.value.split(":"),2);return s=o[0],n=o[1],i.namespace=new ep(s).withLocationDataFrom({locationData:tS(s.length)(e.locationData)}),i.name=new ep(n).withLocationDataFrom({locationData:tw(n.length)(e.locationData)}),i.locationData=e.locationData,i}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){return{namespace:this.namespace.ast(e),name:this.name.ast(e)}}}]),t}(p);return e.prototype.children=["namespace","name"],e}).call(this),e.JSXElement=ec=(function(){var e=function(e){"use strict";function t(e){var i,n=e.tagName,s=e.attributes,o=e.content;return m(this,t),(i=r.call(this)).tagName=n,i.attributes=s,i.content=o,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r,i;return(null!=(r=this.content)&&(r.base.jsx=!0),(t=[this.makeCode("<")]).push.apply(t,x(i=this.tagName.compileToFragments(e,ex))),t.push.apply(t,x(this.attributes.compileToFragments(e))),this.content)?(t.push(this.makeCode(">")),t.push.apply(t,x(this.content.compileNode(e,eS))),t.push.apply(t,[this.makeCode("</")].concat(x(i),[this.makeCode(">")]))):t.push(this.makeCode(" />")),t}},{key:"isFragment",value:function(){return!this.tagName.base.value.length}},{key:"astNode",value:function(e){var r;return this.openingElementLocationData=tF(this.attributes.locationData),(r=this.tagName.base).locationData=r.tagNameLocationData,null!=this.content&&(this.closingElementLocationData=tj(tF(r.closingTagOpeningBracketLocationData),tF(r.closingTagClosingBracketLocationData))),s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isFragment()?"JSXFragment":"JSXElement"}},{key:"elementAstProperties",value:function(e){var t,r,i,n,s,o,a,l,h=this;if(n=Object.assign({type:"JSXOpeningElement",name:(l=function(){var t;return(null==(t=h.tagName.unwrap())?void 0:t.value)&&0<=t5.call(t.value,":")&&(t=new eg(t)),t.ast(e)})(),selfClosing:null==this.closingElementLocationData,attributes:this.attributes.ast(e)},this.openingElementLocationData),t=null,null!=this.closingElementLocationData&&("JSXMemberExpression"===(o=(t=Object.assign({type:"JSXClosingElement",name:Object.assign(l(),tF(this.tagName.base.closingTagNameLocationData))},this.closingElementLocationData)).name.type)||"JSXNamespacedName"===o)){if(s=t.range[0]-n.range[0]+1,r=t.loc.start.column-n.loc.start.column+1,a=function(e){return e.range=[e.range[0]+s,e.range[1]+s],e.start+=s,e.end+=s,e.loc.start={line:h.closingElementLocationData.loc.start.line,column:e.loc.start.column+r},e.loc.end={line:h.closingElementLocationData.loc.start.line,column:e.loc.end.column+r}},"JSXMemberExpression"===t.name.type){for(i=t.name;"JSXMemberExpression"===i.type;)i!==t.name&&a(i),a(i.property),i=i.object;a(i)}else a(t.name.namespace),a(t.name.name)}return{openingElement:n,closingElement:t}}},{key:"fragmentAstProperties",value:function(){var e;return e=Object.assign({type:"JSXOpeningFragment"},this.openingElementLocationData),{openingFragment:e,closingFragment:Object.assign({type:"JSXClosingFragment"},this.closingElementLocationData)}}},{key:"contentAst",value:function(e){var r,i,n,s,o,a,l,h,u,c,d;if(!this.content||("function"==typeof(r=this.content.base).isEmpty?r.isEmpty():void 0))return[];for(s=this.content.unwrapAll(),n=(function(){var r,i,n,h;if(s instanceof e3)return[new ev(s)];for(n=this.content.unwrapAll().extractElements(e,{includeInterpolationWrappers:!0,isJsx:!0}),h=[],r=0,i=n.length;r<i;r++)(o=n[r])instanceof e3?h.push(new ev(o)):null==(l=o.expression)?((a=new ed).locationData=ty({interpolationNode:o,openingBrace:"{",closingBrace:"}"}),h.push(new ef(a,{locationData:o.locationData}))):(d=l.unwrapAll())instanceof t&&d.locationData.range[0]===o.locationData.range[0]?h.push(d):h.push(new ef(d,{locationData:o.locationData}));return h}).call(this),c=[],h=0,u=n.length;h<u;h++)(i=n[h])instanceof ev&&0===i.value.length||c.push(i.ast(e));return c}},{key:"astProperties",value:function(e){return Object.assign(this.isFragment()?this.fragmentAstProperties(e):this.elementAstProperties(e),{children:this.contentAst(e)})}},{key:"astLocationData",value:function(){return null==this.closingElementLocationData?this.openingElementLocationData:tj(this.openingElementLocationData,this.closingElementLocationData)}}]),t}(p);return e.prototype.children=["tagName","attributes","content"],e}).call(this),e.Call=_=(function(){var e=function(e){"use strict";function r(e){var t,n,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],o=2<arguments.length?arguments[2]:void 0,a=3<arguments.length?arguments[3]:void 0;return m(this,r),((n=i.call(this)).variable=e,n.args=s,n.soak=o,n.token=a,n.implicit=n.args.implicit,n.isNew=!1,n.variable instanceof tu&&n.variable.isNotCallable()&&n.variable.error("literal is not a function"),n.variable.base instanceof em)?h(n,new ec({tagName:n.variable,attributes:new eu(n.args[0].base),content:n.args[1]})):("RegExp"===(null==(t=n.variable.base)?void 0:t.value)&&0!==n.args.length&&tW(n.variable,n.args[0]),n)}o(r,e);var i=l(r);return b(r,[{key:"updateLocationDataIfMissing",value:function(e){var t,i;return this.locationData&&this.needsUpdatedStartLocation&&(this.locationData=Object.assign({},this.locationData,{first_line:e.first_line,first_column:e.first_column,range:[e.range[0],this.locationData.range[1]]}),(t=(null==(i=this.variable)?void 0:i.base)||this.variable).needsUpdatedStartLocation&&(this.variable.locationData=Object.assign({},this.variable.locationData,{first_line:e.first_line,first_column:e.first_column,range:[e.range[0],this.variable.locationData.range[1]]}),t.updateLocationDataIfMissing(e)),delete this.needsUpdatedStartLocation),s(c(r.prototype),"updateLocationDataIfMissing",this).call(this,e)}},{key:"newInstance",value:function(){var e,t;return(e=(null==(t=this.variable)?void 0:t.base)||this.variable)instanceof r&&!e.isNew?e.newInstance():this.isNew=!0,this.needsUpdatedStartLocation=!0,this}},{key:"unfoldSoak",value:function(e){var t,i,n,s,o,a,l,h;if(this.soak){if(this.variable instanceof e6)s=new eC(this.variable.compile(e)),h=new tu(s),null==this.variable.accessor&&this.variable.error("Unsupported reference to 'super'");else{if(i=t1(e,this,"variable"))return i;var u=f(new tu(this.variable).cacheReference(e),2);s=u[0],h=u[1]}return(h=new r(h,this.args)).isNew=this.isNew,s=new eC("typeof ".concat(s.compile(e),' === "function"')),new J(s,new tu(h),{soak:!0})}for(t=this,a=[];;){if(t.variable instanceof r){a.push(t),t=t.variable;continue}if(!(t.variable instanceof tu)||(a.push(t),!((t=t.variable.base)instanceof r)))break}for(l=a.reverse(),n=0,o=l.length;n<o;n++)t=l[n],i&&(t.variable instanceof r?t.variable=i:t.variable.base=i),i=t1(e,t,"variable");return i}},{key:"compileNode",value:function(e){if(this.checkForNewSuper(),null!=(h=this.variable)&&(h.front=this.front),s=[],p=(null==(u=this.variable)||null==(c=u.properties)?void 0:c[0])instanceof t,0<(function(){var e,t,i,n;for(i=this.args||[],n=[],e=0,t=i.length;e<t;e++)(r=i[e])instanceof E&&n.push(r);return n}).call(this).length&&p&&!this.variable.base.cached){var r,i,n,s,o,a,l,h,u,c,d,p;n=f(this.variable.base.cache(e,ex,function(){return!1}),1)[0],this.variable.base.cached=n}for(d=this.args,i=a=0,l=d.length;a<l;i=++a)r=d[i],i&&s.push(this.makeCode(", ")),s.push.apply(s,x(r.compileToFragments(e,eS)));return o=[],this.isNew&&o.push(this.makeCode("new ")),o.push.apply(o,x(this.variable.compileToFragments(e,ex))),o.push.apply(o,[this.makeCode("(")].concat(x(s),[this.makeCode(")")])),o}},{key:"checkForNewSuper",value:function(){if(this.isNew&&this.variable instanceof e6)return this.variable.error("Unsupported reference to 'super'")}},{key:"containsSoak",value:function(){var e;return!!this.soak||null!=(e=this.variable)&&"function"==typeof e.containsSoak&&e.containsSoak()}},{key:"astNode",value:function(e){var t;return this.soak&&this.variable instanceof e6&&(null==(t=e.scope.namedMethod())?void 0:t.ctor)&&this.variable.error("Unsupported reference to 'super'"),this.checkForNewSuper(),s(c(r.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isNew?"NewExpression":this.containsSoak()?"OptionalCallExpression":"CallExpression"}},{key:"astProperties",value:function(e){var t;return{callee:this.variable.ast(e,ex),arguments:(function(){var r,i,n,s;for(n=this.args,s=[],r=0,i=n.length;r<i;r++)t=n[r],s.push(t.ast(e,eS));return s}).call(this),optional:!!this.soak,implicit:!!this.implicit}}}]),r}(p);return e.prototype.children=["variable","args"],e}).call(this),e.SuperCall=e4=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"isStatement",value:function(e){var t;return(null==(t=this.expressions)?void 0:t.length)&&e.level===eP}},{key:"compileNode",value:function(e){var r,i,n,o;if(null==(i=this.expressions)||!i.length)return s(c(t.prototype),"compileNode",this).call(this,e);if(o=new eC(tP(s(c(t.prototype),"compileNode",this).call(this,e))),n=new v(this.expressions.slice()),e.level>eP){var a=f(o.cache(e,null,td),2);o=a[0],r=a[1],n.push(r)}return n.unshift(o),n.compileToFragments(e,e.level===eP?e.level:eS)}}]),t}(_);return e.prototype.children=_.prototype.children.concat(["expressions"]),e}).call(this),e.Super=e6=(function(){var e=function(e){"use strict";function t(e,i){var n;return m(this,t),(n=r.call(this)).accessor=e,n.superLiteral=i,n}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r,n,s,o,a,l,h;return this.checkInInstanceMethod(e),null==(r=e.scope.namedMethod()).ctor&&null==this.accessor&&(n=r.name,r.variable,(n.shouldCache()||n instanceof eo&&n.index.isAssignable())&&(s=new K(e.scope.parent.freeVariable("name")),n.index=new i(s,n.index)),this.accessor=null==s?n:new eo(s)),(null==(o=this.accessor)||null==(a=o.name)?void 0:a.comments)&&(l=this.accessor.name.comments,delete this.accessor.name.comments),t=new tu(new eC("super"),this.accessor?[this.accessor]:[]).compileToFragments(e),l&&tm(l,this.accessor.name),t}},{key:"checkInInstanceMethod",value:function(e){var t;if(null==(t=e.scope.namedMethod())||!t.isMethod)return this.error("cannot use super outside of an instance method")}},{key:"astNode",value:function(e){var r;return this.checkInInstanceMethod(e),null==this.accessor?s(c(t.prototype),"astNode",this).call(this,e):new tu(new t().withLocationDataFrom(null==(r=this.superLiteral)?this:r),[this.accessor]).withLocationDataFrom(this).ast(e)}}]),t}(p);return e.prototype.children=["accessor"],e}).call(this),e.RegexWithInterpolations=(function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.heregexCommentTokens;return m(this,t),(i=r.call(this)).call=e,i.heregexCommentTokens=void 0===s?[]:s,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return this.call.compileNode(e)}},{key:"astType",value:function(){return"InterpolatedRegExpLiteral"}},{key:"astProperties",value:function(e){var t,r,i;return{interpolatedPattern:this.call.args[0].ast(e),flags:null==(r=null==(i=this.call.args[1])?void 0:i.unwrap().originalValue)?"":r,comments:(function(){var r,i,n,s;for(n=this.heregexCommentTokens,s=[],r=0,i=n.length;r<i;r++)(t=n[r]).here?s.push(new Y(t).ast(e)):s.push(new eE(t).ast(e));return s}).call(this)}}}]),t}(p);return e.prototype.children=["call"],e}).call(this),e.TaggedTemplateCall=function(e){"use strict";function t(e,i,n){return m(this,t),i instanceof e3&&(i=e5.fromStringLiteral(i)),r.call(this,e,[i],n)}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return this.variable.compileToFragments(e,ex).concat(this.args[0].compileToFragments(e,eS))}},{key:"astType",value:function(){return"TaggedTemplateExpression"}},{key:"astProperties",value:function(e){return{tag:this.variable.ast(e,ex),quasi:this.args[0].ast(e,eS)}}}]),t}(_),e.Extends=(function(){var e=function(e){"use strict";function t(e,i){var n;return m(this,t),(n=r.call(this)).child=e,n.parent=i,n}o(t,e);var r=l(t);return b(t,[{key:"compileToFragments",value:function(e){return new _(new tu(new eC(t2("extend",e))),[this.child,this.parent]).compileToFragments(e)}}]),t}(p);return e.prototype.children=["child","parent"],e}).call(this),e.Access=t=(function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.soak,o=n.shorthand;return m(this,t),(i=r.call(this)).name=e,i.soak=s,i.shorthand=o,i}o(t,e);var r=l(t);return b(t,[{key:"compileToFragments",value:function(e){var t;return t=this.name.compileToFragments(e),this.name.unwrap()instanceof ej?[this.makeCode(".")].concat(x(t)):[this.makeCode("[")].concat(x(t),[this.makeCode("]")])}},{key:"astNode",value:function(e){return this.name.ast(e)}}]),t}(p);return e.prototype.children=["name"],e.prototype.shouldCache=ek,e}).call(this),e.Index=eo=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).index=e,i}o(t,e);var r=l(t);return b(t,[{key:"compileToFragments",value:function(e){return[].concat(this.makeCode("["),this.index.compileToFragments(e,eT),this.makeCode("]"))}},{key:"shouldCache",value:function(){return this.index.shouldCache()}},{key:"astNode",value:function(e){return this.index.ast(e)}}]),t}(p);return e.prototype.children=["index"],e}).call(this),e.Range=eH=(function(){var e=function(e){"use strict";function t(e,i,n){var s;return m(this,t),(s=r.call(this)).from=e,s.to=i,s.exclusive="exclusive"===n,s.equals=s.exclusive?"":"=",s}o(t,e);var r=l(t);return b(t,[{key:"compileVariables",value:function(e){t=tb(e=tz(e,{top:!0}),"shouldCache");var t,r,i=f(this.cacheToCodeFragments(this.from.cache(e,eS,t)),2);this.fromC=i[0],this.fromVar=i[1];var n=f(this.cacheToCodeFragments(this.to.cache(e,eS,t)),2);if(this.toC=n[0],this.toVar=n[1],r=tb(e,"step")){var s=f(this.cacheToCodeFragments(r.cache(e,eS,t)),2);this.step=s[0],this.stepVar=s[1]}return this.fromNum=this.from.isNumber()?tX(this.fromVar):null,this.toNum=this.to.isNumber()?tX(this.toVar):null,this.stepNum=(null==r?void 0:r.isNumber())?tX(this.stepVar):null}},{key:"compileNode",value:function(e){if(this.fromVar||this.compileVariables(e),!e.index)return this.compileArray(e);a=null!=this.fromNum&&null!=this.toNum,s=tb(e,"index"),u=(o=tb(e,"name"))&&o!==s,b=a&&!u?"var ".concat(s," = ").concat(this.fromC):"".concat(s," = ").concat(this.fromC),this.toC!==this.toVar&&(b+=", ".concat(this.toC)),this.step!==this.stepVar&&(b+=", ".concat(this.step)),h="".concat(s," <").concat(this.equals),n="".concat(s," >").concat(this.equals);var t,r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,v,b,y=[this.fromNum,this.toNum];return i=y[0],m=y[1],p="".concat(null==(c=this.stepNum)?this.stepVar:c," !== 0"),f="".concat(null==(d=this.stepNum)?this.stepVar:d," > 0"),l="".concat(h," ").concat(a?m:this.toVar),v="".concat(n," ").concat(a?m:this.toVar),r=null==this.step?a?"".concat(i<=m?h:n," ").concat(m):"(".concat(this.fromVar," <= ").concat(this.toVar," ? ").concat(l," : ").concat(v,")"):null!=this.stepNum&&0!==this.stepNum?0<this.stepNum?"".concat(l):"".concat(v):"".concat(p," && (").concat(f," ? ").concat(l," : ").concat(v,")"),t=this.stepVar?"".concat(this.stepVar," > 0"):"".concat(this.fromVar," <= ").concat(this.toVar),g=this.stepVar?"".concat(s," += ").concat(this.stepVar):a?u?i<=m?"++".concat(s):"--".concat(s):i<=m?"".concat(s,"++"):"".concat(s,"--"):u?"".concat(t," ? ++").concat(s," : --").concat(s):"".concat(t," ? ").concat(s,"++ : ").concat(s,"--"),u&&(b="".concat(o," = ").concat(b)),u&&(g="".concat(o," = ").concat(g)),[this.makeCode("".concat(b,"; ").concat(r,"; ").concat(g))]}},{key:"compileArray",value:function(e){var t,r,i,s,o,a,l,h,u,c,d,f,p;return(l=null!=this.fromNum&&null!=this.toNum)&&20>=n(this.fromNum-this.toNum)?(c=(function(){for(var e=[],t=d=this.fromNum,r=this.toNum;d<=r?t<=r:t>=r;d<=r?t++:t--)e.push(t);return e}).apply(this),this.exclusive&&c.pop(),[this.makeCode("[".concat(c.join(", "),"]"))]):(a=this.tab+te,o=e.scope.freeVariable("i",{single:!0,reserve:!1}),f=e.scope.freeVariable("results",{reserve:!1}),u="\n".concat(a,"var ").concat(f," = [];"),l?(e.index=o,r=tP(this.compileNode(e))):(p="".concat(o," = ").concat(this.fromC)+(this.toC===this.toVar?"":", ".concat(this.toC)),i="".concat(this.fromVar," <= ").concat(this.toVar),r="var ".concat(p,"; ").concat(i," ? ").concat(o," <").concat(this.equals," ").concat(this.toVar," : ").concat(o," >").concat(this.equals," ").concat(this.toVar,"; ").concat(i," ? ").concat(o,"++ : ").concat(o,"--")),h="{ ".concat(f,".push(").concat(o,"); }\n").concat(a,"return ").concat(f,";\n").concat(e.indent),((s=function(e){return null==e?void 0:e.contains(tR)})(this.from)||s(this.to))&&(t=", arguments"),[this.makeCode("(function() {".concat(u,"\n").concat(a,"for (").concat(r,")").concat(h,"}).apply(this").concat(null==t?"":t,")"))])}},{key:"astProperties",value:function(e){var t,r,i,n;return{from:null==(t=null==(r=this.from)?void 0:r.ast(e))?null:t,to:null==(i=null==(n=this.to)?void 0:n.ast(e))?null:i,exclusive:this.exclusive}}}]),t}(p);return e.prototype.children=["from","to"],e}).call(this),e.Slice=e1=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).range=e,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r,i,n,s,o,a=this.range;return s=a.to,(null==(i=a.from)?void 0:i.shouldCache())&&(i=new tu(new eU(i))),(null==s?void 0:s.shouldCache())&&(s=new tu(new eU(s))),n=(null==i?void 0:i.compileToFragments(e,eT))||[this.makeCode("0")],s&&(r=tP(t=s.compileToFragments(e,eT)),(this.range.exclusive||-1!=+r)&&(o=", "+(this.range.exclusive?r:s.isNumber()?"".concat(+r+1):(t=s.compileToFragments(e,ex),"+".concat(tP(t)," + 1 || 9e9"))))),[this.makeCode(".slice(".concat(tP(n)).concat(o||"",")"))]}},{key:"astNode",value:function(e){return this.range.ast(e)}}]),t}(p);return e.prototype.children=["range"],e}).call(this),e.Obj=eB=(function(){var e=function(e){"use strict";function t(e){var r,i=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return m(this,t),(r=n.call(this)).generated=i,r.objects=r.properties=e||[],r}o(t,e);var n=l(t);return b(t,[{key:"isAssignable",value:function(e){var t,n,s,o,a,l;for(a=this.properties,t=0,n=a.length;t<n;t++)if((s=tB((o=a[t]).unwrapAll().value))&&o.error(s),o instanceof i&&"object"===o.context&&!((null==(l=o.value)?void 0:l.base)instanceof r)&&(o=o.value),!o.isAssignable(e))return!1;return!0}},{key:"shouldCache",value:function(){return!this.isAssignable()}},{key:"hasSplat",value:function(){var e,t,r;for(r=this.properties,e=0,t=r.length;e<t;e++)if(r[e]instanceof e0)return!0;return!1}},{key:"reorderProperties",value:function(){var e,t,r;return e=this.properties,r=this.getAndCheckSplatProps(),t=e.splice(r[0],1),this.objects=this.properties=[].concat(e,t)}},{key:"compileNode",value:function(e){if(this.hasSplat()&&this.lhs&&this.reorderProperties(),y=this.properties,this.generated)for(a=0,p=y.length;a<p;a++)(v=y[a])instanceof tu&&v.error("cannot have an implicit value in an implicit object");for(n=e.indent+=te,d=this.lastNode(this.properties),this.propagateLhs(),o=!0,_=this.properties,h=0,g=_.length;h<g;h++)(b=_[h])instanceof i&&"object"===b.context&&(o=!1);for((t=[]).push(this.makeCode(o?"":"\n")),r=c=0,m=y.length;c<m;r=++c){if(b=y[r],l=r===y.length-1?"":o?", ":b===d?"\n":",\n",s=o?"":n,(u=b instanceof i&&"object"===b.context?b.variable:b instanceof i?(this.lhs||b.operatorToken.error("unexpected ".concat(b.operatorToken.value)),b.variable):b)instanceof tu&&u.hasProperties()&&("object"!==b.context&&u.this||u.error("invalid object key"),u=u.properties[0].name,b=new i(u,b,"object")),u===b){if(b.shouldCache()){var t,r,n,s,o,a,l,h,u,c,d,p,g,m,v,b,y,_,S,w,T=f(b.base.cache(e),2);u=T[0],S=T[1],u instanceof K&&(u=new ej(u.value)),b=new i(u,S,"object")}else if(u instanceof tu&&u.base instanceof A){if(b.base.value.shouldCache()){var P=f(b.base.value.cache(e),2);u=P[0],S=P[1],u instanceof K&&(u=new A(u.value)),b=new i(u,S,"object")}else b=new i(u,b.base.value,"object")}else"function"==typeof b.bareLiteral&&b.bareLiteral(K)||b instanceof e0||(b=new i(b,b,"object"))}s&&t.push(this.makeCode(s)),(w=t).push.apply(w,x(b.compileToFragments(e,eP))),l&&t.push(this.makeCode(l))}return t.push(this.makeCode(o?"":"\n".concat(this.tab))),t=this.wrapInBraces(t),this.front?this.wrapInParentheses(t):t}},{key:"getAndCheckSplatProps",value:function(){var e,t,r;if(this.hasSplat()&&this.lhs)return t=this.properties,1<(null==(r=function(){var r,i,n;for(n=[],e=r=0,i=t.length;r<i;e=++r)t[e]instanceof e0&&n.push(e);return n}())?void 0:r.length)&&t[r[1]].error("multiple spread elements are disallowed"),r}},{key:"assigns",value:function(e){var t,r,i;for(i=this.properties,t=0,r=i.length;t<r;t++)if(i[t].assigns(e))return!0;return!1}},{key:"eachName",value:function(e){var t,r,n,s,o;for(s=this.properties,o=[],t=0,r=s.length;t<r;t++)(n=s[t])instanceof i&&"object"===n.context&&(n=n.value),null==(n=n.unwrapAll()).eachName?o.push(void 0):o.push(n.eachName(e));return o}},{key:"expandProperty",value:function(e){var t,r,n,s;return s=e.variable,t=e.context,n=e.operatorToken,(r=e instanceof i&&"object"===t?s:e instanceof i?(this.lhs||n.error("unexpected ".concat(n.value)),s):e)instanceof tu&&r.hasProperties()?("object"!==t&&r.this||r.error("invalid object key"),new eF(e instanceof i?{fromAssign:e}:{key:e})):r===e?e instanceof e0?e:new eF({key:e}):new eF({fromAssign:e})}},{key:"expandProperties",value:function(){var e,t,r,i,n;for(i=this.properties,n=[],e=0,t=i.length;e<t;e++)r=i[e],n.push(this.expandProperty(r));return n}},{key:"propagateLhs",value:function(e){var n,s,o,a,l,h;if(e&&(this.lhs=!0),this.lhs){for(a=this.properties,l=[],n=0,s=a.length;n<s;n++)(o=a[n])instanceof i&&"object"===o.context?(h=o.value.unwrapAll())instanceof r||h instanceof t?l.push(h.propagateLhs(!0)):h instanceof i?l.push(h.nestedLhs=!0):l.push(void 0):o instanceof i?l.push(o.nestedLhs=!0):o instanceof e0?l.push(o.propagateLhs(!0)):l.push(void 0);return l}}},{key:"astNode",value:function(e){return this.getAndCheckSplatProps(),s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.lhs?"ObjectPattern":"ObjectExpression"}},{key:"astProperties",value:function(e){var t;return{implicit:!!this.generated,properties:(function(){var r,i,n,s;for(n=this.expandProperties(),s=[],r=0,i=n.length;r<i;r++)t=n[r],s.push(t.ast(e));return s}).call(this)}}}]),t}(p);return e.prototype.children=["properties"],e}).call(this),e.ObjectProperty=eF=function(e){"use strict";function t(e){var i,n,s=e.key,o=e.fromAssign;return m(this,t),n=r.call(this),o?(n.key=o.variable,i=o.value,"object"===o.context?n.value=i:(n.value=o,n.shorthand=!0),n.locationData=o.locationData):(n.key=s,n.shorthand=!0,n.locationData=s.locationData),n}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){var t,r,i,n;return t=this.key instanceof tu&&this.key.base instanceof A||this.key.unwrap()instanceof e5,{key:(null==(r=this.key.ast(e,eS))?void 0:r.declaration)?Object.assign({},r,{declaration:!1}):r,value:null==(i=null==(n=this.value)?void 0:n.ast(e,eS))?r:i,shorthand:!!this.shorthand,computed:!!t,method:!1}}}]),t}(p),e.Arr=r=(function(){var e=function(e){"use strict";function t(e){var i,n=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return m(this,t),(i=r.call(this)).lhs=n,i.objects=e||[],i.propagateLhs(),i}o(t,e);var r=l(t);return b(t,[{key:"hasElision",value:function(){var e,t,r;for(r=this.objects,e=0,t=r.length;e<t;e++)if(r[e]instanceof k)return!0;return!1}},{key:"isAssignable",value:function(e){var t,r,i,n,s,o,a,l,h=null==e?{}:e;r=h.allowExpansion,i=h.allowNontrailingSplat;var u=h.allowEmptyArray;if(t=void 0!==u&&u,!this.objects.length)return t;for(l=this.objects,n=s=0,o=l.length;s<o;n=++s)if(a=l[n],!i&&a instanceof e0&&n+1!==this.objects.length||!(r&&a instanceof B||a.isAssignable(e)&&(!a.isAtomic||a.isAtomic())))return!1;return!0}},{key:"shouldCache",value:function(){return!this.isAssignable()}},{key:"compileNode",value:function(e){var t,r,i,n,s,o,a,l,h,u,c,d,p,g,m,v,b,y,_,S,w,T,P,E,C;if(!this.objects.length)return[this.makeCode("[]")];for(e.indent+=te,s=function(e){var t=f(e,1)[0];return"Elision"===t.type&&","===t.code.trim()},w=!1,t=[],P=this.objects,y=h=0,d=P.length;h<d;y=++h)(C=(b=P[y]).unwrapAll()).comments&&0===C.comments.filter(function(e){return!e.here}).length&&(C.includeCommentFragments=td);for(_=(r=(function(){var t,r,i,n;for(i=this.objects,n=[],t=0,r=i.length;t<r;t++)b=i[t],n.push(b.compileToFragments(e,eS));return n}).call(this)).length,a=!1,l=u=0,p=r.length;u<p;l=++u){for(o=r[l],c=0,g=o.length;c<g;c++)(i=o[c]).isHereComment?i.code=i.code.trim():0!==l&&!1===a&&tC(i)&&(a=!0);0!==l&&w&&(!s(o)||l===_-1)&&t.push(this.makeCode(", ")),w=w||!s(o),t.push.apply(t,x(o))}if(a||0<=t5.call(tP(t),"\n")){for(n=S=0,m=t.length;S<m;n=++S)(i=t[n]).isHereComment?i.code="".concat(tq(i.code,e.indent,!1),"\n").concat(e.indent):", "!==i.code||null!=i&&i.isElision||"StringLiteral"===(E=i.type)||"StringWithInterpolations"===E||(i.code=",\n".concat(e.indent));t.unshift(this.makeCode("[\n".concat(e.indent))),t.push(this.makeCode("\n".concat(this.tab,"]")))}else{for(T=0,v=t.length;T<v;T++)(i=t[T]).isHereComment&&(i.code="".concat(i.code," "));t.unshift(this.makeCode("[")),t.push(this.makeCode("]"))}return t}},{key:"assigns",value:function(e){var t,r,i;for(i=this.objects,t=0,r=i.length;t<r;t++)if(i[t].assigns(e))return!0;return!1}},{key:"eachName",value:function(e){var t,r,i,n,s;for(n=this.objects,s=[],t=0,r=n.length;t<r;t++)i=(i=n[t]).unwrapAll(),s.push(i.eachName(e));return s}},{key:"propagateLhs",value:function(e){var r,n,s,o,a,l;if(e&&(this.lhs=!0),this.lhs){for(o=this.objects,a=[],r=0,n=o.length;r<n;r++)((s=o[r])instanceof e0||s instanceof B)&&(s.lhs=!0),(l=s.unwrapAll())instanceof t||l instanceof eB?a.push(l.propagateLhs(!0)):l instanceof i?a.push(l.nestedLhs=!0):a.push(void 0);return a}}},{key:"astType",value:function(){return this.lhs?"ArrayPattern":"ArrayExpression"}},{key:"astProperties",value:function(e){var t;return{elements:(function(){var r,i,n,s;for(n=this.objects,s=[],r=0,i=n.length;r<i;r++)t=n[r],s.push(t.ast(e,eS));return s}).call(this)}}}]),t}(p);return e.prototype.children=["objects"],e}).call(this),e.Class=w=(function(){var e=function(e){"use strict";function r(e,t,i){var s;return m(this,r),(s=n.call(this)).variable=e,s.parent=t,s.body=i,null==s.body&&(s.body=new v,s.hasGeneratedBody=!0),s}o(r,e);var n=l(r);return b(r,[{key:"compileNode",value:function(e){var t,r,n;if(this.name=this.determineName(),t=this.walkBody(e),this.parent instanceof tu&&!this.parent.hasProperties()&&(n=this.parent.base.value),this.hasNameClash=null!=this.name&&this.name===n,r=this,t||this.hasNameClash?r=new L(r,t):null==this.name&&e.level===eP&&(r=new eU(r)),this.boundMethods.length&&this.parent&&(null==this.variable&&(this.variable=new K(e.scope.freeVariable("_class"))),null==this.variableRef)){var s=f(this.variable.cache(e),2);this.variable=s[0],this.variableRef=s[1]}this.variable&&(r=new i(this.variable,r,null,{moduleDeclaration:this.moduleDeclaration})),this.compileNode=this.compileClassDeclaration;try{return r.compileToFragments(e)}finally{delete this.compileNode}}},{key:"compileClassDeclaration",value:function(e){var t,r,i;return(this.externalCtor||this.boundMethods.length)&&null==this.ctor&&(this.ctor=this.makeDefaultConstructor()),null!=(t=this.ctor)&&(t.noReturn=!0),this.boundMethods.length&&this.proxyBoundMethods(),e.indent+=te,(i=[]).push(this.makeCode("class ")),this.name&&i.push(this.makeCode(this.name)),null!=(null==(r=this.variable)?void 0:r.comments)&&this.compileCommentFragments(e,this.variable,i),this.name&&i.push(this.makeCode(" ")),this.parent&&i.push.apply(i,[this.makeCode("extends ")].concat(x(this.parent.compileToFragments(e)),[this.makeCode(" ")])),i.push(this.makeCode("{")),!this.body.isEmpty()&&(this.body.spaced=!0,i.push(this.makeCode("\n")),i.push.apply(i,x(this.body.compileToFragments(e,eP))),i.push(this.makeCode("\n".concat(this.tab)))),i.push(this.makeCode("}")),i}},{key:"determineName",value:function(){var e,r,i,n,s;return this.variable&&(n=this.variable.properties,(i=(s=f(t4.call(n,-1),1)[0])?s instanceof t&&s.name:this.variable.base)instanceof K||i instanceof ej)?(r=i.value,s||(e=tB(r))&&this.variable.error(e),0<=t5.call(eb,r)?"_".concat(r):r):null}},{key:"walkBody",value:function(e){var t,r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,b;for(this.ctor=null,this.boundMethods=[],a=[],n=this.body.expressions,o=0,m=n.slice(),h=0,c=m.length;h<c;h++)if((i=m[h])instanceof tu&&i.isObject(!0)){for(p=i.base.properties,s=[],r=0,b=0,g=function(){if(r>b)return s.push(new tu(new eB(p.slice(b,r),!0)))};t=p[r];)(l=this.addInitializerExpression(t,e))&&(g(),s.push(l),a.push(l),b=r+1),r++;g(),t6.apply(n,[o,o-o+1].concat(s)),o+=s.length}else(l=this.addInitializerExpression(i,e))&&(a.push(l),n[o]=l),o+=1;for(u=0,d=a.length;u<d;u++)(f=a[u])instanceof E&&(f.ctor?(this.ctor&&f.error("Cannot define more than one constructor in a class"),this.ctor=f):f.isStatic&&f.bound?f.context=this.name:f.bound&&this.boundMethods.push(f));return e.compiling?a.length===n.length?void 0:(this.body.expressions=function(){var e,t,r;for(r=[],e=0,t=a.length;e<t;e++)i=a[e],r.push(i.hoist());return r}(),new v(n)):void 0}},{key:"addInitializerExpression",value:function(e,t){return e.unwrapAll()instanceof ez?e:this.validInitializerMethod(e)?this.addInitializerMethod(e):!t.compiling&&this.validClassProperty(e)?this.addClassProperty(e):!t.compiling&&this.validClassPrototypeProperty(e)?this.addClassPrototypeProperty(e):null}},{key:"validInitializerMethod",value:function(e){return!!(e instanceof i&&e.value instanceof E)&&(!("object"!==e.context||e.variable.hasProperties())||e.variable.looksStatic(this.name)&&(this.name||!e.value.bound))}},{key:"addInitializerMethod",value:function(e){var r,i,n,s;return s=e.variable,r=e.value,n=e.operatorToken,r.isMethod=!0,r.isStatic=s.looksStatic(this.name),r.isStatic?r.name=s.properties[0]:(i=s.base,r.name=new(i.shouldCache()?eo:t)(i),r.name.updateLocationDataIfMissing(i.locationData),(i instanceof e3?"constructor"===i.originalValue:"constructor"===i.value)&&(r.ctor=this.parent?"derived":"base"),r.bound&&r.ctor&&r.error("Cannot define a constructor as a bound (fat arrow) function")),r.operatorToken=n,r}},{key:"validClassProperty",value:function(e){return e instanceof i&&e.variable.looksStatic(this.name)}},{key:"addClassProperty",value:function(e){var t,r,i,n;return n=e.variable,i=e.value,t=e.operatorToken,r=n.looksStatic(this.name).staticClassName,new T({name:n.properties[0],isStatic:!0,staticClassName:r,value:i,operatorToken:t}).withLocationDataFrom(e)}},{key:"validClassPrototypeProperty",value:function(e){return e instanceof i&&"object"===e.context&&!e.variable.hasProperties()}},{key:"addClassPrototypeProperty",value:function(e){var t,r;return r=e.variable,t=e.value,new P({name:r.base,value:t}).withLocationDataFrom(e)}},{key:"makeDefaultConstructor",value:function(){var e,r,n;return n=this.addInitializerMethod(new i(new tu(new ej("constructor")),new E)),this.body.unshift(n),this.parent&&n.body.push(new e4(new e6,[new e0(new K("arguments"))])),this.externalCtor&&(r=new tu(this.externalCtor,[new t(new ej("apply"))]),e=[new ts,new K("arguments")],n.body.push(new _(r,e)),n.body.makeReturn()),n}},{key:"proxyBoundMethods",value:function(){var e,r;return this.ctor.thisAssignments=(function(){var n,s,o,a;for(o=this.boundMethods,a=[],n=0,s=o.length;n<s;n++)e=o[n],this.parent&&(e.classVariable=this.variableRef),r=new tu(new ts,[e.name]),a.push(new i(r,new _(new tu(r,[new t(new ej("bind"))]),[new ts])));return a}).call(this),null}},{key:"declareName",value:function(e){var t,r,i;if((r=null==(i=this.variable)?void 0:i.unwrap())instanceof K)return t=e.scope.find(r.value),r.isDeclaration=!t}},{key:"isStatementAst",value:function(){return!0}},{key:"astNode",value:function(e){var t,i,n;return(i=this.body.jumps())&&i.error("Class bodies cannot contain pure statements"),(t=this.body.contains(tR))&&t.error("Class bodies shouldn't reference arguments"),this.declareName(e),this.name=this.determineName(),this.body.isClassBody=!0,this.hasGeneratedBody&&(this.body.locationData=t3(this.locationData)),this.walkBody(e),tZ(this.body.expressions),null!=(n=this.ctor)&&(n.noReturn=!0),s(c(r.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(e){return e.level===eP?"ClassDeclaration":"ClassExpression"}},{key:"astProperties",value:function(e){var t,r,i,n;return{id:null==(t=null==(r=this.variable)?void 0:r.ast(e))?null:t,superClass:null==(i=null==(n=this.parent)?void 0:n.ast(e,eT))?null:i,body:this.body.ast(e,eP)}}}]),r}(p);return e.prototype.children=["variable","parent","body"],e}).call(this),e.ExecutableClassBody=L=(function(){var e=function(e){"use strict";function r(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new v;return m(this,r),(t=n.call(this)).class=e,t.body=i,t}o(r,e);var n=l(r);return b(r,[{key:"compileNode",value:function(e){var r,n,s,o,a,l,h,u,c,d,f,p;return(h=this.body.jumps())&&h.error("Class bodies cannot contain pure statements"),(s=this.body.contains(tR))&&s.error("Class bodies shouldn't reference arguments"),c=[],n=[new ts],p=new E(c,this.body),u=new eU(new _(new tu(p,[new t(new ej("call"))]),n)),this.body.spaced=!0,e.classScope=p.makeScope(e.scope),this.name=null==(f=this.class.name)?e.classScope.freeVariable(this.defaultClassVariableName):f,l=new K(this.name),o=this.walkBody(),this.setContext(),this.class.hasNameClash&&(d=new K(e.classScope.freeVariable("superClass")),p.params.push(new eG(d)),n.push(this.class.parent),this.class.parent=d),this.externalCtor&&(a=new K(e.classScope.freeVariable("ctor",{reserve:!1})),this.class.externalCtor=a,this.externalCtor.variable.base=a),this.name===this.class.name?this.body.expressions.unshift(this.class):this.body.expressions.unshift(new i(new K(this.name),this.class)),(r=this.body.expressions).unshift.apply(r,x(o)),this.body.push(l),u.compileToFragments(e)}},{key:"walkBody",value:function(){var e,t,r,n=this;for(e=[],r=0;(t=this.body.expressions[r])&&t instanceof tu&&t.isString();)t.hoisted?r++:e.push.apply(e,x(this.body.expressions.splice(r,1)));return this.traverseChildren(!1,function(e){var t,r,s,o,a,l;if(e instanceof w||e instanceof Z)return!1;if(t=!0,e instanceof v){for(l=e.expressions,r=s=0,o=l.length;s<o;r=++s)(a=l[r])instanceof tu&&a.isObject(!0)?(t=!1,e.expressions[r]=n.addProperties(a.base.properties)):a instanceof i&&a.variable.looksStatic(n.name)&&(a.value.isStatic=!0);e.expressions=tT(e.expressions)}return t}),e}},{key:"setContext",value:function(){var e=this;return this.body.traverseChildren(!1,function(t){return t instanceof ts?t.value=e.name:t instanceof E&&t.bound&&(t.isStatic||!t.name)?t.context=e.name:void 0})}},{key:"addProperties",value:function(e){var r,n,s,o,a,l;return tv((function(){var h,u,c;for(c=[],h=0,u=e.length;h<u;h++)n=null==(l=(r=e[h]).variable)?void 0:l.base,a=r.value,delete r.context,"constructor"===n.value?(a instanceof E&&n.error("constructors must be defined at the top level of a class body"),r=this.externalCtor=new i(new tu,a)):r.variable.this?r.value instanceof E&&(r.value.isStatic=!0):(s=n instanceof A?new eo(n.value):new(n.shouldCache()?eo:t)(n),o=new t(new ej("prototype")),l=new tu(new ts,[o,s]),r.variable=l),c.push(r);return c}).call(this))}}]),r}(p);return e.prototype.children=["class","body"],e.prototype.defaultClassVariableName="_Class",e}).call(this),e.ClassProperty=T=(function(){var e=function(e){"use strict";function t(e){var i,n=e.name,s=e.isStatic,o=e.staticClassName,a=e.value,l=e.operatorToken;return m(this,t),(i=r.call(this)).name=n,i.isStatic=s,i.staticClassName=o,i.value=a,i.operatorToken=l,i}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){var t,r,i,n;return{key:this.name.ast(e,eS),value:this.value.ast(e,eS),static:!!this.isStatic,computed:this.name instanceof eo||this.name instanceof A,operator:null==(t=null==(r=this.operatorToken)?void 0:r.value)?"=":t,staticClassName:null==(i=null==(n=this.staticClassName)?void 0:n.ast(e))?null:i}}}]),t}(p);return e.prototype.children=["name","value","staticClassName"],e.prototype.isStatement=td,e}).call(this),e.ClassPrototypeProperty=P=(function(){var e=function(e){"use strict";function t(e){var i,n=e.name,s=e.value;return m(this,t),(i=r.call(this)).name=n,i.value=s,i}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){return{key:this.name.ast(e,eS),value:this.value.ast(e,eS),computed:this.name instanceof A||this.name instanceof e5}}}]),t}(p);return e.prototype.children=["name","value"],e.prototype.isStatement=td,e}).call(this),e.ModuleDeclaration=eI=(function(){var e=function(e){"use strict";function t(e,i,n){var s;return m(this,t),(s=r.call(this)).clause=e,s.source=i,s.assertions=n,s.checkSource(),s}o(t,e);var r=l(t);return b(t,[{key:"checkSource",value:function(){if(null!=this.source&&this.source instanceof e5)return this.source.error("the name of the module to be imported from must be an uninterpolated string")}},{key:"checkScope",value:function(e,t){if(0!==e.indent.length)return this.error("".concat(t," statements must be at top-level scope"))}},{key:"astAssertions",value:function(e){var t;return null==(null==(t=this.assertions)?void 0:t.properties)?[]:this.assertions.properties.map(function(t){var r,i,n,s,o=t.ast(e);return s=o.start,r=o.end,n=o.loc,i=o.left,{type:"ImportAttribute",start:s,end:r,loc:n,key:i,value:o.right}})}}]),t}(p);return e.prototype.children=["clause","source","assertions"],e.prototype.isStatement=td,e.prototype.jumps=tt,e.prototype.makeReturn=tt,e}).call(this),e.ImportDeclaration=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r;return this.checkScope(e,"import"),e.importedSymbols=[],(t=[]).push(this.makeCode("".concat(this.tab,"import "))),null!=this.clause&&t.push.apply(t,x(this.clause.compileNode(e))),null!=(null==(r=this.source)?void 0:r.value)&&(null!==this.clause&&t.push(this.makeCode(" from ")),t.push(this.makeCode(this.source.value)),null!=this.assertions)&&(t.push(this.makeCode(" assert ")),t.push.apply(t,x(this.assertions.compileToFragments(e)))),t.push(this.makeCode(";")),t}},{key:"astNode",value:function(e){return e.importedSymbols=[],s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astProperties",value:function(e){var t,r,i;return i={specifiers:null==(t=null==(r=this.clause)?void 0:r.ast(e))?[]:t,source:this.source.ast(e),assertions:this.astAssertions(e)},this.clause&&(i.importKind="value"),i}}]),t}(eI),e.ImportClause=(function(){var e=function(e){"use strict";function t(e,i){var n;return m(this,t),(n=r.call(this)).defaultBinding=e,n.namedImports=i,n}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t;return t=[],null!=this.defaultBinding&&(t.push.apply(t,x(this.defaultBinding.compileNode(e))),null!=this.namedImports&&t.push(this.makeCode(", "))),null!=this.namedImports&&t.push.apply(t,x(this.namedImports.compileNode(e))),t}},{key:"astNode",value:function(e){var t,r;return tv(tT([null==(t=this.defaultBinding)?void 0:t.ast(e),null==(r=this.namedImports)?void 0:r.ast(e)]))}}]),t}(p);return e.prototype.children=["defaultBinding","namedImports"],e}).call(this),e.ExportDeclaration=V=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r,n;return this.checkScope(e,"export"),this.checkForAnonymousClassExport(),(t=[]).push(this.makeCode("".concat(this.tab,"export "))),this instanceof G&&t.push(this.makeCode("default ")),!(this instanceof G)&&(this.clause instanceof i||this.clause instanceof w)&&(t.push(this.makeCode("var ")),this.clause.moduleDeclaration="export"),t=null!=this.clause.body&&this.clause.body instanceof v?t.concat(this.clause.compileToFragments(e,eP)):t.concat(this.clause.compileNode(e)),null!=(null==(r=this.source)?void 0:r.value)&&(t.push(this.makeCode(" from ".concat(this.source.value))),null!=this.assertions)&&(t.push(this.makeCode(" assert ")),(n=t).push.apply(n,x(this.assertions.compileToFragments(e)))),t.push(this.makeCode(";")),t}},{key:"checkForAnonymousClassExport",value:function(){if(!(this instanceof G)&&this.clause instanceof w&&!this.clause.variable)return this.clause.error("anonymous classes cannot be exported")}},{key:"astNode",value:function(e){return this.checkForAnonymousClassExport(),s(c(t.prototype),"astNode",this).call(this,e)}}]),t}(eI),e.ExportNamedDeclaration=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){var t,r,i,n;return n={source:null==(r=null==(i=this.source)?void 0:i.ast(e))?null:r,assertions:this.astAssertions(e),exportKind:"value"},t=this.clause.ast(e),this.clause instanceof j?(n.specifiers=t,n.declaration=null):(n.specifiers=[],n.declaration=t),n}}]),t}(V),e.ExportDefaultDeclaration=G=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){return{declaration:this.clause.ast(e),assertions:this.astAssertions(e)}}}]),t}(V),e.ExportAllDeclaration=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){return{source:this.source.ast(e),assertions:this.astAssertions(e),exportKind:"value"}}}]),t}(V),e.ModuleSpecifierList=eR=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).specifiers=e,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r,i,n,s,o,a;if(t=[],e.indent+=te,r=(function(){var t,r,i,n;for(i=this.specifiers,n=[],t=0,r=i.length;t<r;t++)a=i[t],n.push(a.compileToFragments(e,eS));return n}).call(this),0!==this.specifiers.length){for(t.push(this.makeCode("{\n".concat(e.indent))),n=s=0,o=r.length;s<o;n=++s)i=r[n],n&&t.push(this.makeCode(",\n".concat(e.indent))),t.push.apply(t,x(i));t.push(this.makeCode("\n}"))}else t.push(this.makeCode("{}"));return t}},{key:"astNode",value:function(e){var t,r,i,n,s;for(i=this.specifiers,n=[],t=0,r=i.length;t<r;t++)s=i[t],n.push(s.ast(e));return n}}]),t}(p);return e.prototype.children=["specifiers"],e}).call(this),e.ImportSpecifierList=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t)}(eR),e.ExportSpecifierList=j=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t)}(eR),e.ModuleSpecifier=eM=(function(){var e=function(e){"use strict";function t(e,i,n){var s,o,a,l,h;return m(this,t),(s=r.call(this)).original=e,s.alias=i,s.moduleDeclarationType=n,(s.original.comments||(null==(o=s.alias)?void 0:o.comments))&&(s.comments=[],s.original.comments&&(l=s.comments).push.apply(l,x(s.original.comments)),(null==(a=s.alias)?void 0:a.comments)&&(h=s.comments).push.apply(h,x(s.alias.comments))),s.identifier=null==s.alias?s.original.value:s.alias.value,s}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t;return this.addIdentifierToScope(e),(t=[]).push(this.makeCode(this.original.value)),null!=this.alias&&t.push(this.makeCode(" as ".concat(this.alias.value))),t}},{key:"addIdentifierToScope",value:function(e){return e.scope.find(this.identifier,this.moduleDeclarationType)}},{key:"astNode",value:function(e){return this.addIdentifierToScope(e),s(c(t.prototype),"astNode",this).call(this,e)}}]),t}(p);return e.prototype.children=["original","alias"],e}).call(this),e.ImportSpecifier=ei=function(e){"use strict";function t(e,i){return m(this,t),r.call(this,e,i,"import")}o(t,e);var r=l(t);return b(t,[{key:"addIdentifierToScope",value:function(e){var r;return(r=this.identifier,0<=t5.call(e.importedSymbols,r)||e.scope.check(this.identifier))?this.error("'".concat(this.identifier,"' has already been declared")):e.importedSymbols.push(this.identifier),s(c(t.prototype),"addIdentifierToScope",this).call(this,e)}},{key:"astProperties",value:function(e){var t,r,i;return{imported:t=this.original.ast(e),local:null==(r=null==(i=this.alias)?void 0:i.ast(e))?t:r,importKind:null}}}]),t}(eM),e.ImportDefaultSpecifier=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){return{local:this.original.ast(e)}}}]),t}(ei),e.ImportNamespaceSpecifier=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){return{local:this.alias.ast(e)}}}]),t}(ei),e.ExportSpecifier=function(e){"use strict";function t(e,i){return m(this,t),r.call(this,e,i,"export")}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){var t,r,i;return{local:t=this.original.ast(e),exported:null==(r=null==(i=this.alias)?void 0:i.ast(e))?t:r}}}]),t}(eM),e.DynamicImport=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(){return[this.makeCode("import")]}},{key:"astType",value:function(){return"Import"}}]),t}(p),e.DynamicImportCall=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){return this.checkArguments(),s(c(t.prototype),"compileNode",this).call(this,e)}},{key:"checkArguments",value:function(){var e;if(!(1<=(e=this.args.length)&&2>=e))return this.error("import() accepts either one or two arguments")}},{key:"astNode",value:function(e){return this.checkArguments(),s(c(t.prototype),"astNode",this).call(this,e)}}]),t}(_),e.Assign=i=(function(){var e=function(e){"use strict";function i(e,t,r){var s,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};m(this,i),(s=n.call(this)).variable=e,s.value=t,s.context=r,s.param=o.param,s.subpattern=o.subpattern,s.operatorToken=o.operatorToken,s.moduleDeclaration=o.moduleDeclaration;var a=o.originalContext;return s.originalContext=void 0===a?s.context:a,s.propagateLhs(),s}o(i,e);var n=l(i);return b(i,[{key:"isStatement",value:function(e){return(null==e?void 0:e.level)===eP&&null!=this.context&&(this.moduleDeclaration||0<=t5.call(this.context,"?"))}},{key:"checkNameAssignability",value:function(e,t){if("import"===e.scope.type(t.value))return t.error("'".concat(t.value,"' is read-only"))}},{key:"assigns",value:function(e){return this["object"===this.context?"value":"variable"].assigns(e)}},{key:"unfoldSoak",value:function(e){return t1(e,this,"variable")}},{key:"addScopeVariables",value:function(e){var t,r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=i.allowAssignmentToExpansion,s=i.allowAssignmentToNontrailingSplat,o=i.allowAssignmentToEmptyArray,a=i.allowAssignmentToComplexSplat;if(!(this.context&&"**="!==this.context))return(t=this.variable.unwrapAll()).isAssignable({allowExpansion:void 0!==n&&n,allowNontrailingSplat:void 0!==s&&s,allowEmptyArray:void 0!==o&&o,allowComplexSplat:void 0!==a&&a})||this.variable.error("'".concat(this.variable.compile(e),"' can't be assigned")),t.eachName(function(t){var i,n,s,o;if("function"!=typeof t.hasProperties||!t.hasProperties())return((o=tB(t.value))&&t.error(o),r.checkNameAssignability(e,t),r.moduleDeclaration)?(e.scope.add(t.value,r.moduleDeclaration),t.isDeclaration=!0):r.param?e.scope.add(t.value,"alwaysDeclare"===r.param?"var":"param"):(i=e.scope.find(t.value),null==t.isDeclaration&&(t.isDeclaration=!i),t.comments&&!e.scope.comments[t.value]&&!(r.value instanceof w)&&t.comments.every(function(e){return e.here&&!e.multiline}))?((s=new K(t.value)).comments=t.comments,n=[],r.compileCommentFragments(e,s,n),e.scope.comments[t.value]=n):void 0})}},{key:"compileNode",value:function(e){var t,r,i,n,s,o,a,l,h,u,c,p;if(i=this.variable instanceof tu){if((this.variable.isArray()||this.variable.isObject())&&!this.variable.isAssignable())return this.variable.isObject()&&this.variable.base.hasSplat()?this.compileObjectDestruct(e):this.compileDestructuring(e);if(this.variable.isSplice())return this.compileSplice(e);if(this.isConditional())return this.compileConditional(e);if("//="===(a=this.context)||"%%="===a)return this.compileSpecialMath(e)}return this.addScopeVariables(e),this.value instanceof E&&(this.value.isStatic?this.value.name=this.variable.properties[0]:2<=(null==(l=this.variable.properties)?void 0:l.length)&&(s=d(h=this.variable.properties).slice(0),o=(p=f(t6.call(s,-2),2))[0],n=p[1],"prototype"===(null==(u=o.name)?void 0:u.value)&&(this.value.name=n))),(c=this.value.compileToFragments(e,eS),r=this.variable.compileToFragments(e,eS),"object"===this.context)?(this.variable.shouldCache()&&(r.unshift(this.makeCode("[")),r.push(this.makeCode("]"))),r.concat(this.makeCode(": "),c)):(t=r.concat(this.makeCode(" ".concat(this.context||"="," ")),c),e.level>eS||i&&this.variable.base instanceof eB&&!this.nestedLhs&&!0!==this.param?this.wrapInParentheses(t):t)}},{key:"compileObjectDestruct",value:function(e){var t,r,n,s;return this.variable.base.reorderProperties(),r=this.variable.base.properties,s=f(t4.call(r,-1),1)[0].name,t=[],n=new tu(new K(e.scope.freeVariable("ref"))),r.splice(-1,1,new e0(n)),t.push(new i(new tu(new eB(r)),this.value).compileToFragments(e,eS)),t.push(new i(new tu(s),n).compileToFragments(e,eS)),this.joinFragmentArrays(t,", ")}},{key:"compileDestructuring",value:function(e){var n,s,o,a,l,h,u,c,d,p,g,m,v,b,y,S,w,T,P,E,C,A,I,M,R,O,N,L,D,B,F,V,G,U,z=this;if(F=e.level===eP,V=this.value,0===(T=(w=this.variable.base.objects).length))return o=V.compileToFragments(e),e.level>=ew?this.wrapInParentheses(o):o;y=f(w,1)[0],this.disallowLoneExpansion();var j=this.getAndCheckSplatsAndExpansions();return D=j.splats,c=j.expans,B=j.splatsAndExpans,m=0<(null==D?void 0:D.length),g=0<(null==c?void 0:c.length),U=tP(G=V.compileToFragments(e,eS)),s=[],E=function(t,r){return s.push(new i(t,r,null,{param:z.param,subpattern:!0}).compileToFragments(e,eS))},m&&((O=w[D[0]].name.unwrap())instanceof r||O instanceof eB)&&(L=new K(e.scope.freeVariable("ref")),w[D[0]].name=L,N=function(){return E(new tu(O),L)}),(!(V.unwrap()instanceof K)||this.variable.assigns(U))&&(C=e.scope.freeVariable("ref"),s.push([this.makeCode(C+" = ")].concat(x(G))),G=[this.makeCode(C)],U=C),a=(R=function(r){return function(i,n){var s,o,a=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return i instanceof tu||(i=new K(i)),s=[i,new eD(n)],a&&s.push(new eD(a)),o=new tu(new K(t2(r,e)),[new t(new ej("call"))]),new tu(new _(o,s))}})("slice"),l=R("splice"),p=function(e){var t,r,n,s;for(s=[],t=r=0,n=e.length;r<n;t=++r)(y=e[t])instanceof i&&"object"===y.context&&s.push(t);return s},S=function(e){var t,r;for(t=0,r=e.length;t<r;t++)if(!(y=e[t]).isAssignable())return!0;return!1},h=function(e){return p(e).length||S(e)||1===T},b=function(e,r,n){var s,o,l,h,u,c,d,f;for(d=[],o=h=0,u=e.length;h<u;o=++h)if(!((y=e[o])instanceof k)){if(y instanceof i&&"object"===y.context){var p=y;l=p.variable.base,(r=p.value)instanceof i&&(r=r.variable),s=(l=r.this?r.properties[0].name:new ej(r.unwrap().value)).unwrap()instanceof ej,f=new tu(V,[new(s?t:eo)(l)])}else r=function(){if(!1==!(y instanceof e0))return new tu(y.name);return y}(),f=function(){if(!1==!(y instanceof e0))return a(n,o);return new tu(new eC(n),[new eo(new eD(o))])}();(c=tB(r.unwrap().value))&&r.error(c),d.push(E(r,f))}return d},n=function(e,t,i){return t=new tu(new r(e,!0)),E(t,i instanceof tu?i:new tu(new eC(i)))},P=function(e,t,r){return h(e)?b(e,t,r):n(e,t,r)},B.length?(u=B[0],v=w.slice(0,u+(m?1:0)),M=w.slice(u+1),0!==v.length&&P(v,G,U),0!==M.length&&(A=function(){switch(!1){case!m:return l(new tu(w[u].name),-1*M.length);case!g:return a(U,-1*M.length)}}(),h(M)&&(I=A,A=e.scope.freeVariable("ref"),s.push([this.makeCode(A+" = ")].concat(x(I.compileToFragments(e,eS))))),P(M,G,A))):P(w,G,U),"function"==typeof N&&N(),F||this.subpattern||s.push(G),d=this.joinFragmentArrays(s,", "),e.level<eS?d:this.wrapInParentheses(d)}},{key:"disallowLoneExpansion",value:function(){var e,t;if(this.variable.base instanceof r&&1===(null==(t=this.variable.base.objects)?void 0:t.length)&&(e=f(t,1)[0])instanceof B)return e.error("Destructuring assignment has no target")}},{key:"getAndCheckSplatsAndExpansions",value:function(){var e,t,i,n,s,o;return this.variable.base instanceof r?(n=this.variable.base.objects,s=function(){var e,r,s;for(s=[],t=e=0,r=n.length;e<r;t=++e)(i=n[t])instanceof e0&&s.push(t);return s}(),e=function(){var e,r,s;for(s=[],t=e=0,r=n.length;e<r;t=++e)(i=n[t])instanceof B&&s.push(t);return s}(),1<(o=[].concat(x(s),x(e))).length&&n[o.sort()[1]].error("multiple splats/expansions are disallowed in an assignment"),{splats:s,expans:e,splatsAndExpans:o}):{splats:[],expans:[],splatsAndExpans:[]}}},{key:"compileConditional",value:function(e){var t,r,n,s=f(this.variable.cacheReference(e),2);return r=s[0],n=s[1],r.properties.length||!(r.base instanceof eC)||r.base instanceof ts||e.scope.check(r.base.value)||this.throwUnassignableConditionalError(r.base.value),0<=t5.call(this.context,"?")?(e.isExistentialEquals=!0,new J(new D(r),n,{type:"if"}).addElse(new i(n,this.value,"=")).compileToFragments(e)):(t=new eV(this.context.slice(0,-1),r,new i(n,this.value,"=")).compileToFragments(e),e.level<=eS?t:this.wrapInParentheses(t))}},{key:"compileSpecialMath",value:function(e){var t,r,n=f(this.variable.cacheReference(e),2);return t=n[0],r=n[1],new i(t,new eV(this.context.slice(0,-1),r,this.value)).compileToFragments(e)}},{key:"compileSplice",value:function(e){var t,r,i,n,s,o,a,l,h,u,c=this.variable.properties.pop().range;if(i=c.from,a=c.to,r=c.exclusive,(l=this.variable.unwrapAll()).comments&&(tW(l,this),delete this.variable.comments),o=this.variable.compile(e),i){var d=f(this.cacheToCodeFragments(i.cache(e,ew)),2);n=d[0],s=d[1]}else n=s="0";a?(null==i?void 0:i.isNumber())&&a.isNumber()?(a=a.compile(e)-s,r||(a+=1)):(a=a.compile(e,ex)+" - "+s,r||(a+=" + 1")):a="9e9";var p=f(this.value.cache(e,eS),2);return h=p[0],u=p[1],t=[].concat(this.makeCode("".concat(t2("splice",e),".apply(").concat(o,", [").concat(n,", ").concat(a,"].concat(")),h,this.makeCode(")), "),u),e.level>eP?this.wrapInParentheses(t):t}},{key:"eachName",value:function(e){return this.variable.unwrapAll().eachName(e)}},{key:"isDefaultAssignment",value:function(){return this.param||this.nestedLhs}},{key:"propagateLhs",value:function(){var e,t;return(null==(e=this.variable)?void 0:"function"==typeof e.isArray?e.isArray():void 0)||(null==(t=this.variable)?void 0:"function"==typeof t.isObject?t.isObject():void 0)?this.variable.base.propagateLhs(!0):void 0}},{key:"throwUnassignableConditionalError",value:function(e){return this.variable.error('the variable "'.concat(e,"\" can't be assigned with ").concat(this.context," because it has not been declared before"))}},{key:"isConditional",value:function(){var e;return"||="===(e=this.context)||"&&="===e||"?="===e}},{key:"astNode",value:function(e){var t;return this.disallowLoneExpansion(),this.getAndCheckSplatsAndExpansions(),this.isConditional()&&(t=this.variable.unwrap())instanceof K&&!e.scope.check(t.value)&&this.throwUnassignableConditionalError(t.value),this.addScopeVariables(e,{allowAssignmentToExpansion:!0,allowAssignmentToNontrailingSplat:!0,allowAssignmentToEmptyArray:!0,allowAssignmentToComplexSplat:!0}),s(c(i.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isDefaultAssignment()?"AssignmentPattern":"AssignmentExpression"}},{key:"astProperties",value:function(e){var t,r;return r={right:this.value.ast(e,eS),left:this.variable.ast(e,eS)},this.isDefaultAssignment()||(r.operator=null==(t=this.originalContext)?"=":t),r}}]),i}(p);return e.prototype.children=["variable","value"],e.prototype.isAssignable=td,e.prototype.isStatementAst=ek,e}).call(this),e.FuncGlyph=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).glyph=e,i}o(t,e);var r=l(t);return b(t)}(p),e.Code=E=(function(){var e=function(e){"use strict";function t(e,r,i,s){var o,l;return m(this,t),(o=n.call(this)).funcGlyph=i,o.paramStart=s,o.params=e||[],o.body=r||new v,o.bound="=>"===(null==(l=o.funcGlyph)?void 0:l.glyph),o.isGenerator=!1,o.isAsync=!1,o.isMethod=!1,o.body.traverseChildren(!1,function(e){if((e instanceof eV&&e.isYield()||e instanceof tf)&&(o.isGenerator=!0),(e instanceof eV&&e.isAwait()||e instanceof a)&&(o.isAsync=!0),e instanceof W&&e.isAwait())return o.isAsync=!0}),o.propagateLhs(),o}o(t,e);var n=l(t);return b(t,[{key:"isStatement",value:function(){return this.isMethod}},{key:"makeScope",value:function(e){return new eJ(e,this.body,this)}},{key:"compileNode",value:function(e){for(this.checkForAsyncOrGeneratorConstructor(),this.bound&&((null==(R=e.scope.method)?void 0:R.bound)&&(this.context=e.scope.method.context),this.context||(this.context="this")),this.updateOptions(e),A=[],l=[],j=null==(O=null==(k=this.thisAssignments)?void 0:k.slice())?[]:O,I=[],c=!1,u=!1,this.checkForDuplicateParams(),this.disallowLoneExpansionAndMultipleSplats(),this.eachParamName(function(t,r,n,s){var o,a;if(r.this)return t=r.properties[0].name.value,0<=t5.call(eb,t)&&(t="_".concat(t)),a=new K(e.scope.freeVariable(t,{reserve:!1})),o=n.name instanceof eB&&s instanceof i&&"="===s.operatorToken.value?new i(new K(t),a,"object"):a,n.renameParam(r,o),j.push(new i(r,a))}),N=this.params,d=p=0,v=N.length;p<v;d=++p)(E=N[d]).splat||E instanceof B?(c=!0,E.splat?(E.name instanceof r||E.name instanceof eB?(z=e.scope.freeVariable("arg"),A.push(M=new tu(new K(z))),l.push(new i(new tu(E.name),M))):(A.push(M=E.asReference(e)),z=tP(M.compileNodeWithoutComments(e))),E.shouldCache()&&l.push(new i(new tu(E.name),M))):(z=e.scope.freeVariable("args"),A.push(new tu(new K(z)))),e.scope.parameter(z)):((E.shouldCache()||u)&&(E.assignedInBody=!0,u=!0,null==E.value?l.push(new i(new tu(E.name),E.asReference(e),null,{param:"alwaysDeclare"})):(a=new eV("===",E,new th),f=new i(new tu(E.name),E.value),l.push(new J(a,f)))),c?(I.push(E),null==E.value||E.shouldCache()||(a=new eV("===",E,new th),f=new i(new tu(E.name),E.value),l.push(new J(a,f))),null!=(null==(L=E.name)?void 0:L.value)&&e.scope.add(E.name.value,"var",!0)):(M=E.shouldCache()?E.asReference(e):null==E.value||E.assignedInBody?E:new i(new tu(E.name),E.value,null,{param:!0}),E.name instanceof r||E.name instanceof eB?(E.name.lhs=!0,E.shouldCache()||E.name.eachName(function(t){return e.scope.parameter(t.value)})):(C=null==E.value?M:E,e.scope.parameter(tP(C.compileToFragmentsWithoutComments(e)))),A.push(M)));for(0!==I.length&&l.unshift(new i(new tu(new r([new e0(new K(z))].concat(x(function(){var t,r,i;for(i=[],t=0,r=I.length;t<r;t++)E=I[t],i.push(E.asReference(e));return i}())))),new tu(new K(z)))),H=this.body.isEmpty(),this.disallowSuperInParamDefaults(),this.checkSuperCallsInConstructorBody(),!this.expandCtorSuper(j)&&(W=this.body.expressions).unshift.apply(W,x(j)),(t=this.body.expressions).unshift.apply(t,x(l)),this.isMethod&&this.bound&&!this.isStatic&&this.classVariable&&(o=new tu(new eC(t2("boundMethodCheck",e))),this.body.expressions.unshift(new _(o,[new tu(new ts),this.classVariable]))),H||this.noReturn||this.body.makeReturn(),this.bound&&this.isGenerator&&(this.body.contains(function(e){return e instanceof eV&&"yield"===e.operator})||this).error("yield cannot occur inside bound (fat arrow) functions"),T=[],this.isMethod&&this.isStatic&&T.push("static"),this.isAsync&&T.push("async"),this.isMethod||this.bound?this.isGenerator&&T.push("*"):T.push("function".concat(this.isGenerator?"*":"")),U=[this.makeCode("(")],null!=(null==(D=this.paramStart)?void 0:D.comments)&&this.compileCommentFragments(e,this.paramStart,U),d=g=0,b=A.length;g<b;d=++g)E=A[d],0!==d&&U.push(this.makeCode(", ")),c&&d===A.length-1&&U.push(this.makeCode("...")),G=e.scope.variables.length,U.push.apply(U,x(E.compileToFragments(e,eT))),G!==e.scope.variables.length&&(h=e.scope.variables.splice(G),(q=e.scope.parent.variables).push.apply(q,x(h)));if(U.push(this.makeCode(")")),null!=(null==(F=this.funcGlyph)?void 0:F.comments)){for(V=this.funcGlyph.comments,m=0,y=V.length;m<y;m++)V[m].unshift=!1;this.compileCommentFragments(e,this.funcGlyph,U)}if(this.body.isEmpty()||(s=this.body.compileWithDeclarations(e)),this.isMethod){var t,n,s,o,a,l,h,u,c,d,f,p,g,m,v,b,y,S,w,T,P,E,C,A,I,M,R,O,k,N,L,D,F,V,G,U,z,j,H,W,q,X=[e.scope,e.scope.parent];w=X[0],e.scope=X[1],"."===(P=this.name.compileToFragments(e))[0].code&&P.shift(),e.scope=w}return n=this.joinFragmentArrays((function(){var e,t,r;for(r=[],t=0,e=T.length;t<e;t++)S=T[t],r.push(this.makeCode(S));return r}).call(this)," "),T.length&&P&&n.push(this.makeCode(" ")),P&&n.push.apply(n,x(P)),n.push.apply(n,x(U)),this.bound&&!this.isMethod&&n.push(this.makeCode(" =>")),n.push(this.makeCode(" {")),(null==s?void 0:s.length)&&n.push.apply(n,[this.makeCode("\n")].concat(x(s),[this.makeCode("\n".concat(this.tab))])),n.push(this.makeCode("}")),this.isMethod?tA(n,this):this.front||e.level>=ex?this.wrapInParentheses(n):n}},{key:"updateOptions",value:function(e){return e.scope=tb(e,"classScope")||this.makeScope(e.scope),e.scope.shared=tb(e,"sharedScope"),e.indent+=te,delete e.bare,delete e.isExistentialEquals}},{key:"checkForDuplicateParams",value:function(){var e;return e=[],this.eachParamName(function(t,r){return 0<=t5.call(e,t)&&r.error("multiple parameters named '".concat(t,"'")),e.push(t)})}},{key:"eachParamName",value:function(e){var t,r,i,n,s;for(n=this.params,s=[],t=0,r=n.length;t<r;t++)i=n[t],s.push(i.eachName(e));return s}},{key:"traverseChildren",value:function(e,r){if(e)return s(c(t.prototype),"traverseChildren",this).call(this,e,r)}},{key:"replaceInContext",value:function(e,r){return!!this.bound&&s(c(t.prototype),"replaceInContext",this).call(this,e,r)}},{key:"disallowSuperInParamDefaults",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.forAst;return!!this.ctor&&this.eachSuperCall(v.wrap(this.params),function(e){return e.error("'super' is not allowed in constructor parameter defaults")},{checkForThisBeforeSuper:!t})}},{key:"checkSuperCallsInConstructorBody",value:function(){var e,t=this;return!!this.ctor&&(e=this.eachSuperCall(this.body,function(e){if("base"===t.ctor)return e.error("'super' is only allowed in derived class constructors")}))}},{key:"flagThisParamInDerivedClassConstructorWithoutCallingSuper",value:function(e){return e.error("Can't use @params in derived class constructors without calling super")}},{key:"checkForAsyncOrGeneratorConstructor",value:function(){if(this.ctor&&(this.isAsync&&this.name.error("Class constructor may not be async"),this.isGenerator))return this.name.error("Class constructor may not be a generator")}},{key:"disallowLoneExpansionAndMultipleSplats",value:function(){var e,t,r,i,n,s;for(s=!1,i=this.params,n=[],e=0,t=i.length;e<t;e++)(r=i[e]).splat||r instanceof B?(s?r.error("only one splat or expansion parameter is allowed per function definition"):r instanceof B&&1===this.params.length&&r.error("an expansion parameter cannot be the only parameter in a function definition"),n.push(s=!0)):n.push(void 0);return n}},{key:"expandCtorSuper",value:function(e){var t,r,i,n;return!!this.ctor&&(n=this.eachSuperCall(this.body,function(t){return t.expressions=e}),t=e.length&&e.length!==(null==(i=this.thisAssignments)?void 0:i.length),"derived"===this.ctor&&!n&&t&&(r=e[0].variable,this.flagThisParamInDerivedClassConstructorWithoutCallingSuper(r)),n)}},{key:"eachSuperCall",value:function(e,r){var i,n=this,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=s.checkForThisBeforeSuper;return i=!1,e.traverseChildren(!0,function(e){var s;return e instanceof e4?(e.variable.accessor||(s=e.args.filter(function(e){return!(e instanceof w)&&(!(e instanceof t)||e.bound)}),v.wrap(s).traverseChildren(!0,function(e){if(e.this)return e.error("Can't call super with @params in derived class constructors")})),i=!0,r(e)):(void 0===o||o)&&e instanceof ts&&"derived"===n.ctor&&!i&&e.error("Can't reference 'this' before calling super in derived class constructors"),!(e instanceof e4)&&(!(e instanceof t)||e.bound)}),i}},{key:"propagateLhs",value:function(){var e,t,i,n,s,o;for(s=this.params,o=[],e=0,t=s.length;e<t;e++){n=s[e];(i=n.name)instanceof r||i instanceof eB?o.push(i.propagateLhs(!0)):n instanceof B?o.push(n.lhs=!0):o.push(void 0)}return o}},{key:"astAddParamsToScope",value:function(e){return this.eachParamName(function(t){return e.scope.add(t,"param")})}},{key:"astNode",value:function(e){var r,i=this;return this.updateOptions(e),this.checkForAsyncOrGeneratorConstructor(),this.checkForDuplicateParams(),this.disallowSuperInParamDefaults({forAst:!0}),this.disallowLoneExpansionAndMultipleSplats(),r=this.checkSuperCallsInConstructorBody(),"derived"!==this.ctor||r||this.eachParamName(function(e,t){if(t.this)return i.flagThisParamInDerivedClassConstructorWithoutCallingSuper(t)}),this.astAddParamsToScope(e),this.body.isEmpty()||this.noReturn||this.body.makeReturn(null,!0),s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isMethod?"ClassMethod":this.bound?"ArrowFunctionExpression":"FunctionExpression"}},{key:"paramForAst",value:function(e){var t,r,n;return e instanceof B?e:(t=e.name,n=e.value,(r=e.splat)?new e0(t,{lhs:!0,postfix:r.postfix}).withLocationDataFrom(e):null==n?t:new i(t,n,null,{param:!0}).withLocationDataFrom({locationData:tH(t.locationData,n.locationData)}))}},{key:"methodAstProperties",value:function(e){var t,r,i,n,s,o=this;return t=function(){return o.name instanceof eo||o.name instanceof A||o.name.name instanceof A},{static:!!this.isStatic,key:this.name.ast(e),computed:t(),kind:this.ctor?"constructor":"method",operator:null==(r=null==(i=this.operatorToken)?void 0:i.value)?"=":r,staticClassName:null==(n=null==(s=this.isStatic.staticClassName)?void 0:s.ast(e))?null:n,bound:!!this.bound}}},{key:"astProperties",value:function(e){var t,r;return Object.assign({params:(function(){var r,i,n,s;for(n=this.params,s=[],r=0,i=n.length;r<i;r++)t=n[r],s.push(this.paramForAst(t).ast(e));return s}).call(this),body:this.body.ast(Object.assign({},e,{checkForDirectives:!0}),eP),generator:!!this.isGenerator,async:!!this.isAsync,id:null,hasIndentedBody:this.body.locationData.first_line>(null==(r=this.funcGlyph)?void 0:r.locationData.first_line)},this.isMethod?this.methodAstProperties(e):{})}},{key:"astLocationData",value:function(){var e,r;return(r=s(c(t.prototype),"astLocationData",this).call(this),this.isMethod)?(e=tj(this.name.astLocationData(),r),null!=this.isStatic.staticClassName&&(e=tj(this.isStatic.staticClassName.astLocationData(),e)),e):r}}]),t}(p);return e.prototype.children=["params","body"],e.prototype.jumps=ek,e}).call(this),e.Param=eG=(function(){var e=function(e){"use strict";function t(e,i,n){var s,o,a;return m(this,t),(s=r.call(this)).name=e,s.value=i,s.splat=n,(o=tB(s.name.unwrapAll().value))&&s.name.error(o),s.name instanceof eB&&s.name.generated&&(a=s.name.objects[0].operatorToken).error("unexpected ".concat(a.value)),s}o(t,e);var r=l(t);return b(t,[{key:"compileToFragments",value:function(e){return this.name.compileToFragments(e,eS)}},{key:"compileToFragmentsWithoutComments",value:function(e){return this.name.compileToFragmentsWithoutComments(e,eS)}},{key:"asReference",value:function(e){var t,r;return this.reference?this.reference:((r=this.name).this?(t=r.properties[0].name.value,0<=t5.call(eb,t)&&(t="_".concat(t)),r=new K(e.scope.freeVariable(t))):r.shouldCache()&&(r=new K(e.scope.freeVariable("arg"))),(r=new tu(r)).updateLocationDataIfMissing(this.locationData),this.reference=r)}},{key:"shouldCache",value:function(){return this.name.shouldCache()}},{key:"eachName",value:function(e){var t,r,n,s,o,a,l,h,u,c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.name;if(r=function(e){var t;if((t=tB(e.value))&&e.error(t),!e.isAssignable())return e.error("'".concat(e.value,"' can't be assigned"))},t=function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return e("@".concat(t.properties[0].name.value),t,c,r)},d instanceof _&&d.error("Function invocation can't be assigned"),d instanceof eC)return r(d),e(d.value,d,this);if(d instanceof tu)return t(d);for(u=null==(h=d.objects)?[]:h,n=0,s=u.length;n<s;n++)o=l=u[n],l instanceof i&&null==l.context&&(l=l.variable),l instanceof i?(l=l.value instanceof i?l.value.variable:l.value,this.eachName(e,l.unwrap())):l instanceof e0?e((a=l.name.unwrap()).value,a,this):l instanceof tu?l.isArray()||l.isObject()?this.eachName(e,l.base):l.this?t(l,o):(r(l.base),e(l.base.value,l.base,this)):l instanceof k||l instanceof B||l.error("illegal parameter ".concat(l.compile()))}},{key:"renameParam",value:function(e,t){var r,n;return r=function(t){return t===e},n=function(e,r){var n;return r instanceof eB?(n=e,e.this&&(n=e.properties[0].name),e.this&&n.value===t.value?new tu(t):new i(new tu(n),t,"object")):t},this.replaceInContext(r,n)}}]),t}(p);return e.prototype.children=["name","value"],e}).call(this),e.Splat=e0=(function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.lhs,o=n.postfix;return m(this,t),(i=r.call(this)).lhs=s,i.postfix=void 0===o||o,i.name=e.compile?e:new eC(e),i}o(t,e);var r=l(t);return b(t,[{key:"shouldCache",value:function(){return!1}},{key:"isAssignable",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.allowComplexSplat;return this.name instanceof eB||this.name instanceof eU?void 0!==t&&t:this.name.isAssignable()&&(!this.name.isAtomic||this.name.isAtomic())}},{key:"assigns",value:function(e){return this.name.assigns(e)}},{key:"compileNode",value:function(e){var t;return t=[this.makeCode("...")].concat(x(this.name.compileToFragments(e,ew))),this.jsx?[this.makeCode("{")].concat(x(t),[this.makeCode("}")]):t}},{key:"unwrap",value:function(){return this.name}},{key:"propagateLhs",value:function(e){var t;return e&&(this.lhs=!0),this.lhs&&"function"==typeof(t=this.name).propagateLhs?t.propagateLhs(!0):void 0}},{key:"astType",value:function(){return this.jsx?"JSXSpreadAttribute":this.lhs?"RestElement":"SpreadElement"}},{key:"astProperties",value:function(e){return{argument:this.name.ast(e,ew),postfix:this.postfix}}}]),t}(p);return e.prototype.children=["name"],e}).call(this),e.Expansion=B=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(){return this.throwLhsError()}},{key:"asReference",value:function(){return this}},{key:"eachName",value:function(){}},{key:"throwLhsError",value:function(){return this.error("Expansion must be used inside a destructuring assignment or parameter list")}},{key:"astNode",value:function(e){return this.lhs||this.throwLhsError(),s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"RestElement"}},{key:"astProperties",value:function(){return{argument:null}}}]),t}(p);return e.prototype.shouldCache=ek,e}).call(this),e.Elision=k=(function(){var e=function(e){"use strict";function t(){return m(this,t),r.apply(this,arguments)}o(t,e);var r=l(t);return b(t,[{key:"compileToFragments",value:function(e,r){var i;return(i=s(c(t.prototype),"compileToFragments",this).call(this,e,r)).isElision=!0,i}},{key:"compileNode",value:function(){return[this.makeCode(", ")]}},{key:"asReference",value:function(){return this}},{key:"eachName",value:function(){}},{key:"astNode",value:function(){return null}}]),t}(p);return e.prototype.isAssignable=td,e.prototype.shouldCache=ek,e}).call(this),e.While=tc=(function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.invert,o=n.guard,a=n.isLoop;return m(this,t),(i=r.call(this)).condition=e,i.inverted=s,i.guard=o,i.isLoop=a,i}o(t,e);var r=l(t);return b(t,[{key:"makeReturn",value:function(e,r){return e?s(c(t.prototype),"makeReturn",this).call(this,e,r):(this.returns=!this.jumps(),r?void(this.returns&&this.body.makeReturn(e,r)):this)}},{key:"addBody",value:function(e){return this.body=e,this}},{key:"jumps",value:function(){var e,t,r,i;if(!(e=this.body.expressions).length)return!1;for(t=0,i=e.length;t<i;t++)if(r=e[t].jumps({loop:!0}))return r;return!1}},{key:"compileNode",value:function(e){var t,r,i,n;return e.indent+=te,n="",(r=this.body).isEmpty()?r=this.makeCode(""):(this.returns&&(r.makeReturn(i=e.scope.freeVariable("results")),n="".concat(this.tab).concat(i," = [];\n")),this.guard&&(1<r.expressions.length?r.expressions.unshift(new J(new eU(this.guard).invert(),new e2("continue"))):this.guard&&(r=v.wrap([new J(this.guard,r)]))),r=[].concat(this.makeCode("\n"),r.compileToFragments(e,eP),this.makeCode("\n".concat(this.tab)))),t=[].concat(this.makeCode(n+this.tab+"while ("),this.processedCondition().compileToFragments(e,eT),this.makeCode(") {"),r,this.makeCode("}")),this.returns&&t.push(this.makeCode("\n".concat(this.tab,"return ").concat(i,";"))),t}},{key:"processedCondition",value:function(){return null==this.processedConditionCache?this.processedConditionCache=this.inverted?this.condition.invert():this.condition:this.processedConditionCache}},{key:"astType",value:function(){return"WhileStatement"}},{key:"astProperties",value:function(e){var t,r;return{test:this.condition.ast(e,eT),body:this.body.ast(e,eP),guard:null==(t=null==(r=this.guard)?void 0:r.ast(e))?null:t,inverted:!!this.inverted,postfix:!!this.postfix,loop:!!this.isLoop}}}]),t}(p);return e.prototype.children=["condition","guard","body"],e.prototype.isStatement=td,e}).call(this),e.Op=eV=(function(){var e,r,n=function(n){"use strict";function a(t,r,i,n){var s,o,l,c,f,p,g=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},v=g.invertOperator,b=g.originalOperator;return m(this,a),((p=d.call(this)).invertOperator=v,p.originalOperator=void 0===b?t:b,"new"===t)?((o=f=r.unwrap())instanceof _||(o=f.base)instanceof _)&&!o.do&&!o.isNew?h(p,new tu(o.newInstance(),o===f?[]:f.properties)):(r instanceof eU||r.unwrap()instanceof K||("function"==typeof r.hasProperties?r.hasProperties():void 0)||(r=new eU(r)),(s=new _(r,[])).locationData=p.locationData,s.isNew=!0,h(p,s)):(p.operator=e[t]||t,p.first=r,p.second=i,p.flip=!!n,("--"===(c=p.operator)||"++"===c)&&(l=tB(p.first.unwrapAll().value))&&p.first.error(l),h(p,u(p)))}o(a,n);var d=l(a);return b(a,[{key:"isNumber",value:function(){var e;return this.isUnary()&&("+"===(e=this.operator)||"-"===e)&&this.first instanceof tu&&this.first.isNumber()}},{key:"isAwait",value:function(){return"await"===this.operator}},{key:"isYield",value:function(){var e;return"yield"===(e=this.operator)||"yield*"===e}},{key:"isUnary",value:function(){return!this.second}},{key:"shouldCache",value:function(){return!this.isNumber()}},{key:"isChainable",value:function(){var e;return"<"===(e=this.operator)||">"===e||">="===e||"<="===e||"==="===e||"!=="===e}},{key:"isChain",value:function(){return this.isChainable()&&this.first.isChainable()}},{key:"invert",value:function(){var e,t,i,n,s;if(this.isInOperator())return this.invertOperator="!",this;if(this.isChain()){for(e=!0,t=this;t&&t.operator;)e&&(e=t.operator in r),t=t.first;if(!e)return new eU(this).invert();for(t=this;t&&t.operator;)t.invert=!t.invert,t.operator=r[t.operator],t=t.first;return this}return(n=r[this.operator])?(this.operator=n,this.first.unwrap()instanceof a&&this.first.invert(),this):this.second?new eU(this).invert():"!"===this.operator&&(i=this.first.unwrap())instanceof a&&("!"===(s=i.operator)||"in"===s||"instanceof"===s)?i:new a("!",this)}},{key:"unfoldSoak",value:function(e){var t;return("++"===(t=this.operator)||"--"===t||"delete"===t)&&t1(e,this,"first")}},{key:"generateDo",value:function(e){var t,r,n,s,o,a,l;for(o=[],l=(e instanceof i&&(a=e.value.unwrap())instanceof E?a:e).params||[],r=0,n=l.length;r<n;r++)(s=l[r]).value?(o.push(s.value),delete s.value):o.push(s);return(t=new _(e,o)).do=!0,t}},{key:"isInOperator",value:function(){return"in"===this.originalOperator}},{key:"compileNode",value:function(e){var t,r,i,n,s;if(this.isInOperator())return r=new es(this.first,this.second),(this.invertOperator?r.invert():r).compileNode(e);if(this.invertOperator)return this.invertOperator=null,this.invert().compileNode(e);if("do"===this.operator)return a.prototype.generateDo(this.first).compileNode(e);if((i=this.isChain())||(this.first.front=this.front),this.checkDeleteOperand(e),this.isYield()||this.isAwait())return this.compileContinuation(e);if(this.isUnary())return this.compileUnary(e);if(i)return this.compileChain(e);switch(this.operator){case"?":return this.compileExistence(e,this.second.isDefaultValue);case"//":return this.compileFloorDivision(e);case"%%":return this.compileModulo(e);default:return n=this.first.compileToFragments(e,ew),s=this.second.compileToFragments(e,ew),t=[].concat(n,this.makeCode(" ".concat(this.operator," ")),s),e.level<=ew?t:this.wrapInParentheses(t)}}},{key:"compileChain",value:function(e){var t,r,i=f(this.first.second.cache(e),2);return this.first.second=i[0],r=i[1],t=this.first.compileToFragments(e,ew).concat(this.makeCode(" ".concat(this.invert?"&&":"||"," ")),r.compileToFragments(e),this.makeCode(" ".concat(this.operator," ")),this.second.compileToFragments(e,ew)),this.wrapInParentheses(t)}},{key:"compileExistence",value:function(e,t){var r,n;return this.first.shouldCache()?(n=new K(e.scope.freeVariable("ref")),r=new eU(new i(n,this.first))):n=r=this.first,new J(new D(r,t),n,{type:"if"}).addElse(this.second).compileToFragments(e)}},{key:"compileUnary",value:function(e){var t,r,i;return(r=[],t=this.operator,r.push([this.makeCode(t)]),"!"===t&&this.first instanceof D)?(this.first.negated=!this.first.negated,this.first.compileToFragments(e)):e.level>=ex?new eU(this).compileToFragments(e):(i="+"===t||"-"===t,("typeof"===t||"delete"===t||i&&this.first instanceof a&&this.first.operator===t)&&r.push([this.makeCode(" ")]),i&&this.first instanceof a&&(this.first=new eU(this.first)),r.push(this.first.compileToFragments(e,ew)),this.flip&&r.reverse(),this.joinFragmentArrays(r,""))}},{key:"compileContinuation",value:function(e){var t,r,i;return r=[],t=this.operator,this.isAwait()||this.checkContinuation(e),!(0<=t5.call(Object.keys(this.first),"expression"))||this.first instanceof to?(e.level>=eT&&r.push([this.makeCode("(")]),r.push([this.makeCode(t)]),""!==(null==(i=this.first.base)?void 0:i.value)&&r.push([this.makeCode(" ")]),r.push(this.first.compileToFragments(e,ew)),e.level>=eT&&r.push([this.makeCode(")")])):null!=this.first.expression&&r.push(this.first.expression.compileToFragments(e,ew)),this.joinFragmentArrays(r,"")}},{key:"checkContinuation",value:function(e){var t;if(null==e.scope.parent&&this.error("".concat(this.operator," can only occur inside functions")),(null==(t=e.scope.method)?void 0:t.bound)&&e.scope.method.isGenerator)return this.error("yield cannot occur inside bound (fat arrow) functions")}},{key:"compileFloorDivision",value:function(e){var r,i,n;return i=new tu(new K("Math"),[new t(new ej("floor"))]),n=this.second.shouldCache()?new eU(this.second):this.second,r=new a("/",this.first,n),new _(i,[r]).compileToFragments(e)}},{key:"compileModulo",value:function(e){var t;return t=new tu(new eC(t2("modulo",e))),new _(t,[this.first,this.second]).compileToFragments(e)}},{key:"toString",value:function(e){return s(c(a.prototype),"toString",this).call(this,e,this.constructor.name+" "+this.operator)}},{key:"checkDeleteOperand",value:function(e){if("delete"===this.operator&&e.scope.check(this.first.unwrapAll().value))return this.error("delete operand may not be argument or var")}},{key:"astNode",value:function(e){return this.isYield()&&this.checkContinuation(e),this.checkDeleteOperand(e),s(c(a.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){if(this.isAwait())return"AwaitExpression";if(this.isYield())return"YieldExpression";if(this.isChain())return"ChainedComparison";switch(this.operator){case"||":case"&&":case"?":return"LogicalExpression";case"++":case"--":return"UpdateExpression";default:return this.isUnary()?"UnaryExpression":"BinaryExpression"}}},{key:"operatorAst",value:function(){return"".concat(this.invertOperator?"".concat(this.invertOperator," "):"").concat(this.originalOperator)}},{key:"chainAstProperties",value:function(e){var t,r,i,n;for(n=[this.operatorAst()],i=[this.second],t=this.first;;)if(n.unshift(t.operatorAst()),i.unshift(t.second),!(t=t.first).isChainable()){i.unshift(t);break}return{operators:n,operands:function(){var t,n,s;for(s=[],t=0,n=i.length;t<n;t++)r=i[t],s.push(r.ast(e,ew));return s}()}}},{key:"astProperties",value:function(e){var t,r,i,n,s;if(this.isChain())return this.chainAstProperties(e);if(r=this.first.ast(e,ew),s=null==(n=this.second)?void 0:n.ast(e,ew),i=this.operatorAst(),!1==!this.isUnary())return t=this.isYield()&&""===this.first.unwrap().value?null:r,this.isAwait()?{argument:t}:this.isYield()?{argument:t,delegate:"yield*"===this.operator}:{argument:t,operator:i,prefix:!this.flip};return{left:r,right:s,operator:i}}}]),a}(p);return e={"==":"===","!=":"!==",of:"in",yieldfrom:"yield*"},r={"!==":"===","===":"!=="},n.prototype.children=["first","second"],n}).call(this),e.In=es=(function(){var e=function(e){"use strict";function t(e,i){var n;return m(this,t),(n=r.call(this)).object=e,n.array=i,n}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r,i,n;if(this.array instanceof tu&&this.array.isArray()&&this.array.base.objects.length){for(n=this.array.base.objects,r=0,i=n.length;r<i;r++)if(n[r]instanceof e0){t=!0;break}if(!t)return this.compileOrTest(e)}return this.compileLoopTest(e)}},{key:"compileOrTest",value:function(e){var t,r,i,n,s,o,a,l,h,u,c=f(this.object.cache(e,ew),2);h=c[0],a=c[1];var d=f(this.negated?[" !== "," && "]:[" === "," || "],2);for(t=d[0],r=d[1],u=[],l=this.array.base.objects,i=s=0,o=l.length;s<o;i=++s)n=l[i],i&&u.push(this.makeCode(r)),u=u.concat(i?a:h,this.makeCode(t),n.compileToFragments(e,ex));return e.level<ew?u:this.wrapInParentheses(u)}},{key:"compileLoopTest",value:function(e){var t,r,i,n=f(this.object.cache(e,eS),2);return(i=n[0],r=n[1],t=[].concat(this.makeCode(t2("indexOf",e)+".call("),this.array.compileToFragments(e,eS),this.makeCode(", "),r,this.makeCode(") "+(this.negated?"< 0":">= 0"))),tP(i)===tP(r))?t:(t=i.concat(this.makeCode(", "),t),e.level<eS?t:this.wrapInParentheses(t))}},{key:"toString",value:function(e){return s(c(t.prototype),"toString",this).call(this,e,this.constructor.name+(this.negated?"!":""))}}]),t}(p);return e.prototype.children=["object","array"],e.prototype.invert=eO,e}).call(this),e.Try=(function(){var e=function(e){"use strict";function t(e,i,n,s){var o;return m(this,t),(o=r.call(this)).attempt=e,o.catch=i,o.ensure=n,o.finallyTag=s,o}o(t,e);var r=l(t);return b(t,[{key:"jumps",value:function(e){var t;return this.attempt.jumps(e)||(null==(t=this.catch)?void 0:t.jumps(e))}},{key:"makeReturn",value:function(e,t){var r,i;return t?(null!=(r=this.attempt)&&r.makeReturn(e,t),void(null!=(i=this.catch)&&i.makeReturn(e,t))):(this.attempt&&(this.attempt=this.attempt.makeReturn(e)),this.catch&&(this.catch=this.catch.makeReturn(e)),this)}},{key:"compileNode",value:function(e){var t,r,i,n,s;return n=e.indent,e.indent+=te,s=this.attempt.compileToFragments(e,eP),t=this.catch?this.catch.compileToFragments(tz(e,{indent:n}),eP):this.ensure||this.catch?[]:(i=e.scope.freeVariable("error",{reserve:!1}),[this.makeCode(" catch (".concat(i,") {}"))]),r=this.ensure?[].concat(this.makeCode(" finally {\n"),this.ensure.compileToFragments(e,eP),this.makeCode("\n".concat(this.tab,"}"))):[],[].concat(this.makeCode("".concat(this.tab,"try {\n")),s,this.makeCode("\n".concat(this.tab,"}")),t,r)}},{key:"astType",value:function(){return"TryStatement"}},{key:"astProperties",value:function(e){var t,r;return{block:this.attempt.ast(e,eP),handler:null==(t=null==(r=this.catch)?void 0:r.ast(e))?null:t,finalizer:null==this.ensure?null:Object.assign(this.ensure.ast(e,eP),tj(tF(this.finallyTag.locationData),this.ensure.astLocationData()))}}}]),t}(p);return e.prototype.children=["attempt","catch","ensure"],e.prototype.isStatement=td,e}).call(this),e.Catch=(function(){var e=function(e){"use strict";function t(e,i){var n,s,o;return m(this,t),(n=r.call(this)).recovery=e,n.errorVariable=i,null!=(o=n.errorVariable)&&"function"==typeof(s=o.unwrap()).propagateLhs&&s.propagateLhs(!0),n}o(t,e);var r=l(t);return b(t,[{key:"jumps",value:function(e){return this.recovery.jumps(e)}},{key:"makeReturn",value:function(e,t){var r;if(r=this.recovery.makeReturn(e,t),!t)return this.recovery=r,this}},{key:"compileNode",value:function(e){var t,r;return e.indent+=te,t=e.scope.freeVariable("error",{reserve:!1}),r=new K(t),this.checkUnassignable(),this.errorVariable&&this.recovery.unshift(new i(this.errorVariable,r)),[].concat(this.makeCode(" catch ("),r.compileToFragments(e),this.makeCode(") {\n"),this.recovery.compileToFragments(e,eP),this.makeCode("\n".concat(this.tab,"}")))}},{key:"checkUnassignable",value:function(){var e;if(this.errorVariable&&(e=tB(this.errorVariable.unwrapAll().value)))return this.errorVariable.error(e)}},{key:"astNode",value:function(e){var r;return this.checkUnassignable(),null!=(r=this.errorVariable)&&r.eachName(function(t){var r;return r=e.scope.find(t.value),t.isDeclaration=!r}),s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"CatchClause"}},{key:"astProperties",value:function(e){var t,r;return{param:null==(t=null==(r=this.errorVariable)?void 0:r.ast(e))?null:t,body:this.recovery.ast(e,eP)}}}]),t}(p);return e.prototype.children=["recovery","errorVariable"],e.prototype.isStatement=td,e}).call(this),e.Throw=to=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).expression=e,i}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t;return t=this.expression.compileToFragments(e,eS),t0(t,this.makeCode("throw ")),t.unshift(this.makeCode(this.tab)),t.push(this.makeCode(";")),t}},{key:"astType",value:function(){return"ThrowStatement"}},{key:"astProperties",value:function(e){return{argument:this.expression.ast(e,eS)}}}]),t}(p);return e.prototype.children=["expression"],e.prototype.isStatement=td,e.prototype.jumps=ek,e.prototype.makeReturn=tt,e}).call(this),e.Existence=D=(function(){var e=function(e){"use strict";function t(e){var i,n,s=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return m(this,t),(n=r.call(this)).expression=e,n.comparisonTarget=s?"undefined":"null",i=[],n.expression.traverseChildren(!0,function(e){var t,r,n,s;if(e.comments){for(s=e.comments,r=0,n=s.length;r<n;r++)t=s[r],0>t5.call(i,t)&&i.push(t);return delete e.comments}}),tm(i,u(n)),tW(n.expression,u(n)),n}o(t,e);var r=l(t);return b(t,[{key:"compileNode",value:function(e){var t,r,i;if(this.expression.front=this.front,i=this.expression.compile(e,ew),this.expression.unwrap()instanceof K&&!e.scope.check(i)){var n=f(this.negated?["===","||"]:["!==","&&"],2);t=n[0],r=n[1],i="typeof ".concat(i," ").concat(t,' "undefined"')+("undefined"===this.comparisonTarget?"":" ".concat(r," ").concat(i," ").concat(t," ").concat(this.comparisonTarget))}else t="null"===this.comparisonTarget?this.negated?"==":"!=":this.negated?"===":"!==",i="".concat(i," ").concat(t," ").concat(this.comparisonTarget);return[this.makeCode(e.level<=e_?i:"(".concat(i,")"))]}},{key:"astType",value:function(){return"UnaryExpression"}},{key:"astProperties",value:function(e){return{argument:this.expression.ast(e),operator:"?",prefix:!1}}}]),t}(p);return e.prototype.children=["expression"],e.prototype.invert=eO,e}).call(this),e.Parens=eU=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).body=e,i}o(t,e);var r=l(t);return b(t,[{key:"unwrap",value:function(){return this.body}},{key:"shouldCache",value:function(){return this.body.shouldCache()}},{key:"compileNode",value:function(e){var t,r,i,n,s;return(s=null==(n=(r=this.body.unwrap()).comments)?void 0:n.some(function(e){return e.here&&!e.unshift&&!e.newLine}),r instanceof tu&&r.isAtomic()&&!this.jsxAttribute&&!s)?(r.front=this.front,r.compileToFragments(e)):(i=r.compileToFragments(e,eT),t=e.level<ew&&!s&&(r instanceof eV&&!r.isInOperator()||r.unwrap()instanceof _||r instanceof W&&r.returns)&&(e.level<e_||3>=i.length),this.jsxAttribute?this.wrapInBraces(i):t?i:this.wrapInParentheses(i))}},{key:"astNode",value:function(e){return this.body.unwrap().ast(e,eT)}}]),t}(p);return e.prototype.children=["body"],e}).call(this),e.StringWithInterpolations=e5=(function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.quote,o=n.startQuote,a=n.jsxAttribute;return m(this,t),(i=r.call(this)).body=e,i.quote=s,i.startQuote=o,i.jsxAttribute=a,i}o(t,e);var r=l(t);return b(t,[{key:"unwrap",value:function(){return this}},{key:"shouldCache",value:function(){return this.body.shouldCache()}},{key:"extractElements",value:function(e){var t,r,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.includeInterpolationWrappers,o=n.isJsx;return r=this.body.unwrap(),t=[],i=[],r.traverseChildren(!1,function(r){var n,a,l,h,u,c,d,f,p,g,m,v,b;if(r instanceof e3)return r.comments&&(i.push.apply(i,x(r.comments)),delete r.comments),t.push(r),!0;if(r instanceof el){if(0!==i.length){for(h=0,c=i.length;h<c;h++)(n=i[h]).unshift=!0,n.newLine=!0;tm(i,r)}return(m=null==(f=r.expression)?void 0:f.unwrapAll())instanceof ez&&m.generated&&!(o&&e.compiling)?e.compiling?((a=new e3("").withLocationDataFrom(r)).comments=m.comments,r.comments&&(v=null==a.comments?a.comments=[]:a.comments).push.apply(v,x(r.comments)),t.push(new tu(a))):((l=new el().withLocationDataFrom(r)).comments=r.comments,t.push(l)):(r.expression||s)&&(r.comments&&(b=null==(p=r.expression)?void 0:null==p.comments?p.comments=[]:p.comments).push.apply(b,x(r.comments)),t.push(s?r:r.expression)),!1}if(r.comments){if(0===t.length||t[t.length-1]instanceof e3)i.push.apply(i,x(r.comments));else{for(g=r.comments,u=0,d=g.length;u<d;u++)(n=g[u]).unshift=!1,n.newLine=!0;tm(r.comments,t[t.length-1])}delete r.comments}return!0}),t}},{key:"compileNode",value:function(e){var r,i,n,s,o,a,l,h,u;if(null==this.comments&&(this.comments=null==(l=this.startQuote)?void 0:l.comments),this.jsxAttribute)return(u=new eU(new t(this.body))).jsxAttribute=!0,u.compileNode(e);for(n=this.extractElements(e,{isJsx:this.jsx}),s=[],this.jsx||s.push(this.makeCode("`")),o=0,a=n.length;o<a;o++)(i=n[o])instanceof e3?(h=this.jsx?i.unquotedValueForJSX:i.unquotedValueForTemplateLiteral,s.push(this.makeCode(h))):(this.jsx||s.push(this.makeCode("$")),r=i.compileToFragments(e,eT),(!this.isNestedTag(i)||r.some(function(e){var t;return null==(t=e.comments)?void 0:t.some(function(e){return!1===e.here})}))&&((r=this.wrapInBraces(r))[0].isStringWithInterpolations=!0,r[r.length-1].isStringWithInterpolations=!0),s.push.apply(s,x(r)));return this.jsx||s.push(this.makeCode("`")),s}},{key:"isNestedTag",value:function(e){var t;return t="function"==typeof e.unwrapAll?e.unwrapAll():void 0,this.jsx&&t instanceof ec}},{key:"astType",value:function(){return"TemplateLiteral"}},{key:"astProperties",value:function(e){var t,r,i,n,s,o,a,l,h,u,c;for(r=this.extractElements(e,{includeInterpolationWrappers:!0}),l=f(t4.call(r,-1),1)[0],c=[],s=[],o=a=0,h=r.length;a<h;o=++a)(t=r[o])instanceof e3?c.push(new tn(t.originalValue,{tail:t===l}).withLocationDataFrom(t).ast(e)):(u=null==(n=t.expression)?((i=new N).locationData=ty({interpolationNode:t,openingBrace:"#{",closingBrace:"}"}),i):n.unwrapAll(),s.push(tg(u,e)));return{expressions:s,quasis:c,quote:this.quote}}}],[{key:"fromStringLiteral",value:function(e){var r,i;return r=e.withoutQuotesInLocationData(),i=new tu(r).withLocationDataFrom(r),new t(v.wrap([i]),{quote:e.quote,jsxAttribute:e.jsxAttribute}).withLocationDataFrom(e)}}]),t}(p);return e.prototype.children=["body"],e}).call(this),e.TemplateElement=tn=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.tail;return m(this,t),(i=r.call(this)).value=e,i.tail=s,i}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(){return{value:{raw:this.value},tail:!!this.tail}}}]),t}(p),e.Interpolation=el=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).expression=e,i}o(t,e);var r=l(t);return b(t)}(p);return e.prototype.children=["expression"],e}).call(this),e.EmptyInterpolation=N=function(e){"use strict";function t(){return m(this,t),r.call(this)}o(t,e);var r=l(t);return b(t)}(p),e.For=W=(function(){var e=function(e){"use strict";function t(e,i){var n;return m(this,t),(n=r.call(this)).addBody(e),n.addSource(i),n}o(t,e);var r=l(t);return b(t,[{key:"isAwait",value:function(){var e;return null!=(e=this.await)&&e}},{key:"addBody",value:function(e){var t,r;return this.body=v.wrap([e]),(r=this.body.expressions).length&&null==(t=this.body).locationData&&(t.locationData=tH(r[0].locationData,r[r.length-1].locationData)),this}},{key:"addSource",value:function(e){var t,r,i,n,s,o,a,l,h,u,c,d,f=this,p=e.source;for(this.source=void 0!==p&&p,s=0,a=(r=["name","index","guard","step","own","ownTag","await","awaitTag","object","from"]).length;s<a;s++)this[t=r[s]]=null==(h=e[t])?this[t]:h;if(!this.source)return this;if(this.from&&this.index&&this.index.error("cannot use index with for-from"),this.own&&!this.object&&this.ownTag.error("cannot use own with for-".concat(this.from?"from":"in")),this.object){var g=[this.index,this.name];this.name=g[0],this.index=g[1]}for(((null==(u=this.index)?void 0:"function"==typeof u.isArray?u.isArray():void 0)||(null==(c=this.index)?void 0:"function"==typeof c.isObject?c.isObject():void 0))&&this.index.error("index cannot be a pattern matching expression"),this.await&&!this.from&&this.awaitTag.error("await must be used with for-from"),this.range=this.source instanceof tu&&this.source.base instanceof eH&&!this.source.properties.length&&!this.from,this.pattern=this.name instanceof tu,this.pattern&&"function"==typeof(n=this.name.unwrap()).propagateLhs&&n.propagateLhs(!0),this.range&&this.index&&this.index.error("indexes do not apply to range loops"),this.range&&this.pattern&&this.name.error("cannot pattern match over range loops"),this.returns=!1,o=0,l=(d=["source","guard","step","name","index"]).length;o<l;o++)this[i=d[o]]&&(this[i].traverseChildren(!0,function(e){var t,r,n,s;if(e.comments){for(s=e.comments,r=0,n=s.length;r<n;r++)(t=s[r]).newLine=t.unshift=!0;return tW(e,f[i])}}),tW(this[i],this));return this}},{key:"compileNode",value:function(e){var t,r,n,s,o,a,l,h,u,c,d,p,g,m,b,y,x,_,S,w,T,P,E,C,A,I,M,R,O,k,N,L,D,B,F;if(A=(t=v.wrap([this.body])).expressions,(null==(w=f(t4.call(A,-1),1)[0])?void 0:w.jumps())instanceof eX&&(this.returns=!1),k=this.range?this.source.base:this.source,O=e.scope,this.pattern||(P=this.name&&this.name.compile(e,eS)),y=this.index&&this.index.compile(e,eS),P&&!this.pattern&&O.find(P),!y||this.index instanceof tu||O.find(y),this.returns&&(R=O.freeVariable("results")),this.from?this.pattern&&(x=O.freeVariable("x",{single:!0})):x=this.object&&y||O.freeVariable("i",{single:!0}),S=(_=(this.range||this.from)&&P||y||x)===x?"":"".concat(_," = "),this.step&&!this.range){var V=f(this.cacheToCodeFragments(this.step.cache(e,eS,tY)),2);N=V[0],D=V[1],this.step.isNumber()&&(L=tX(D))}return this.pattern&&(P=x),F="",g="",l="",m=this.tab+te,this.range?d=k.compileToFragments(tz(e,{index:x,name:P,step:this.step,shouldCache:tY})):(B=this.source.compile(e,eS),!P&&!this.own||this.source.unwrap()instanceof K||(l+="".concat(this.tab).concat(C=O.freeVariable("ref")," = ").concat(B,";\n"),B=C),!P||this.pattern||this.from||(E="".concat(P," = ").concat(B,"[").concat(_,"]")),this.object||this.from||(N!==D&&(l+="".concat(this.tab).concat(N,";\n")),h=0>L,this.step&&null!=L&&h||(T=O.freeVariable("len")),o="".concat(S).concat(x," = 0, ").concat(T," = ").concat(B,".length"),a="".concat(S).concat(x," = ").concat(B,".length - 1"),n="".concat(x," < ").concat(T),s="".concat(x," >= 0"),this.step?(null==L?(n="".concat(D," > 0 ? ").concat(n," : ").concat(s),o="(".concat(D," > 0 ? (").concat(o,") : ").concat(a,")")):h&&(n=s,o=a),b="".concat(x," += ").concat(D)):b="".concat(_===x?"".concat(x,"++"):"++".concat(x)),d=[this.makeCode("".concat(o,"; ").concat(n,"; ").concat(S).concat(b))])),this.returns&&(I="".concat(this.tab).concat(R," = [];\n"),M="\n".concat(this.tab,"return ").concat(R,";"),t.makeReturn(R)),this.guard&&(1<t.expressions.length?t.expressions.unshift(new J(new eU(this.guard).invert(),new e2("continue"))):this.guard&&(t=v.wrap([new J(this.guard,t)]))),this.pattern&&t.expressions.unshift(new i(this.name,this.from?new K(_):new eC("".concat(B,"[").concat(_,"]")))),E&&(F="\n".concat(m).concat(E,";")),this.object?(d=[this.makeCode("".concat(_," in ").concat(B))],this.own&&(g="\n".concat(m,"if (!").concat(t2("hasProp",e),".call(").concat(B,", ").concat(_,")) continue;"))):this.from&&(d=this.await?(d=new eV("await",new eU(new eC("".concat(_," of ").concat(B))))).compileToFragments(e,eP):[this.makeCode("".concat(_," of ").concat(B))]),(r=t.compileToFragments(tz(e,{indent:m}),eP))&&0<r.length&&(r=[].concat(this.makeCode("\n"),r,this.makeCode("\n"))),p=[this.makeCode(l)],I&&p.push(this.makeCode(I)),c=this.await?"for ":"for (",u=this.await?"":")",p=p.concat(this.makeCode(this.tab),this.makeCode(c),d,this.makeCode("".concat(u," {").concat(g).concat(F)),r,this.makeCode(this.tab),this.makeCode("}")),M&&p.push(this.makeCode(M)),p}},{key:"astNode",value:function(e){var r,i,n;return r=function(t){var r;return r=e.scope.find(t.value),t.isDeclaration=!r},null!=(i=this.name)&&i.eachName(r,{checkAssignability:!1}),null!=(n=this.index)&&n.eachName(r,{checkAssignability:!1}),s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"For"}},{key:"astProperties",value:function(e){var t,r,i,n,s,o,a,l,h;return{source:null==(t=this.source)?void 0:t.ast(e),body:this.body.ast(e,eP),guard:null==(r=null==(i=this.guard)?void 0:i.ast(e))?null:r,name:null==(n=null==(s=this.name)?void 0:s.ast(e))?null:n,index:null==(o=null==(a=this.index)?void 0:a.ast(e))?null:o,step:null==(l=null==(h=this.step)?void 0:h.ast(e))?null:l,postfix:!!this.postfix,own:!!this.own,await:!!this.await,style:(function(){switch(!1){case!this.from:return"from";case!this.object:return"of";case!this.name:return"in";default:return"range"}}).call(this)}}}]),t}(tc);return e.prototype.children=["body","source","guard","step"],e}).call(this),e.Switch=(function(){var e=function(e){"use strict";function t(e,i,n){var s;return m(this,t),(s=r.call(this)).subject=e,s.cases=i,s.otherwise=n,s}o(t,e);var r=l(t);return b(t,[{key:"jumps",value:function(){var e,t,r,i,n,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{block:!0};for(i=this.cases,e=0,r=i.length;e<r;e++)if(t=i[e].block.jumps(s))return t;return null==(n=this.otherwise)?void 0:n.jumps(s)}},{key:"makeReturn",value:function(e,t){var r,i,n,s;for(n=this.cases,r=0,i=n.length;r<i;r++)n[r].block.makeReturn(e,t);return e&&(this.otherwise||(this.otherwise=new v([new eC("void 0")]))),null!=(s=this.otherwise)&&s.makeReturn(e,t),this}},{key:"compileNode",value:function(e){for(l=e.indent+te,h=e.indent=l+te,o=[].concat(this.makeCode(this.tab+"switch ("),this.subject?this.subject.compileToFragments(e,eT):this.makeCode("false"),this.makeCode(") {\n")),p=this.cases,a=u=0,d=p.length;u<d;a=++u){var t,r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,v=p[a];for(n=v.conditions,t=v.block,g=tT([n]),c=0,f=g.length;c<f;c++)i=g[c],this.subject||(i=i.invert()),o=o.concat(this.makeCode(l+"case "),i.compileToFragments(e,eT),this.makeCode(":\n"));if(0<(r=t.compileToFragments(e,eP)).length&&(o=o.concat(r,this.makeCode("\n"))),a===this.cases.length-1&&!this.otherwise)break;(s=this.lastNode(t.expressions))instanceof eX||s instanceof to||s instanceof eC&&s.jumps()&&"debugger"!==s.value||o.push(i.makeCode(h+"break;\n"))}return this.otherwise&&this.otherwise.expressions.length&&(m=o).push.apply(m,[this.makeCode(l+"default:\n")].concat(x(this.otherwise.compileToFragments(e,eP)),[this.makeCode("\n")])),o.push(this.makeCode(this.tab+"}")),o}},{key:"astType",value:function(){return"SwitchStatement"}},{key:"casesAst",value:function(e){var t,r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,v,b,y;for(i=[],f=this.cases,t=s=0,u=f.length;s<u;t=++s){var x=a=f[t];for(y=x.conditions,n=x.block,h=(y=tT([y])).length-1,b=o=0,c=y.length;o<c;b=++o)m=y[b],v=b===h?n:null,r=m.locationData,(null==v?void 0:v.expressions.length)&&(r=tH(r,v.expressions[v.expressions.length-1].locationData)),0===b&&(r=tH(r,a.locationData,{justLeading:!0})),b===h&&(r=tH(r,a.locationData,{justEnding:!0})),i.push(new e8(m,v,{trailing:b===h}).withLocationDataFrom({locationData:r}))}for((null==(p=this.otherwise)?void 0:p.expressions.length)&&i.push(new e8(null,this.otherwise).withLocationDataFrom(this.otherwise)),g=[],l=0,d=i.length;l<d;l++)a=i[l],g.push(a.ast(e));return g}},{key:"astProperties",value:function(e){var t,r;return{discriminant:null==(t=null==(r=this.subject)?void 0:r.ast(e,eT))?null:t,cases:this.casesAst(e)}}}]),t}(p);return e.prototype.children=["subject","cases","otherwise"],e.prototype.isStatement=td,e}).call(this),e8=(function(){var e=function(e){"use strict";function t(e,i){var n,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=s.trailing;return m(this,t),(n=r.call(this)).test=e,n.block=i,n.trailing=o,n}o(t,e);var r=l(t);return b(t,[{key:"astProperties",value:function(e){var t,r,i,n;return{test:null==(t=null==(r=this.test)?void 0:r.ast(e,eT))?null:t,consequent:null==(i=null==(n=this.block)?void 0:n.ast(e,eP).body)?[]:i,trailing:!!this.trailing}}}]),t}(p);return e.prototype.children=["test","block"],e}).call(this),e.SwitchWhen=(function(){var e=function(e){"use strict";function t(e,i){var n;return m(this,t),(n=r.call(this)).conditions=e,n.block=i,n}o(t,e);var r=l(t);return b(t)}(p);return e.prototype.children=["conditions","block"],e}).call(this),e.If=J=(function(){var e=function(e){"use strict";function t(e,i){var n,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return m(this,t),(n=r.call(this)).condition=e,n.body=i,n.elseBody=null,n.isChain=!1,n.soak=s.soak,n.postfix=s.postfix,n.type=s.type,n.condition.comments&&tW(n.condition,u(n)),n}o(t,e);var r=l(t);return b(t,[{key:"bodyNode",value:function(){var e;return null==(e=this.body)?void 0:e.unwrap()}},{key:"elseBodyNode",value:function(){var e;return null==(e=this.elseBody)?void 0:e.unwrap()}},{key:"addElse",value:function(e){return this.isChain?(this.elseBodyNode().addElse(e),this.locationData=tH(this.locationData,this.elseBodyNode().locationData)):(this.isChain=e instanceof t,this.elseBody=this.ensureBlock(e),this.elseBody.updateLocationDataIfMissing(e.locationData),null!=this.locationData&&null!=this.elseBody.locationData&&(this.locationData=tH(this.locationData,this.elseBody.locationData))),this}},{key:"isStatement",value:function(e){var t;return(null==e?void 0:e.level)===eP||this.bodyNode().isStatement(e)||(null==(t=this.elseBodyNode())?void 0:t.isStatement(e))}},{key:"jumps",value:function(e){var t;return this.body.jumps(e)||(null==(t=this.elseBody)?void 0:t.jumps(e))}},{key:"compileNode",value:function(e){return this.isStatement(e)?this.compileStatement(e):this.compileExpression(e)}},{key:"makeReturn",value:function(e,t){var r,i;return t?(null!=(r=this.body)&&r.makeReturn(e,t),void(null!=(i=this.elseBody)&&i.makeReturn(e,t))):(e&&(this.elseBody||(this.elseBody=new v([new eC("void 0")]))),this.body&&(this.body=new v([this.body.makeReturn(e)])),this.elseBody&&(this.elseBody=new v([this.elseBody.makeReturn(e)])),this)}},{key:"ensureBlock",value:function(e){return e instanceof v?e:new v([e])}},{key:"compileStatement",value:function(e){var r,i,n,s,o,a,l;return(n=tb(e,"chainChild"),o=tb(e,"isExistentialEquals"))?new t(this.processedCondition().invert(),this.elseBodyNode(),{type:"if"}).compileToFragments(e):(l=e.indent+te,s=this.processedCondition().compileToFragments(e,eT),i=this.ensureBlock(this.body).compileToFragments(tz(e,{indent:l})),a=[].concat(this.makeCode("if ("),s,this.makeCode(") {\n"),i,this.makeCode("\n".concat(this.tab,"}"))),n||a.unshift(this.makeCode(this.tab)),this.elseBody)?(r=a.concat(this.makeCode(" else ")),this.isChain?(e.chainChild=!0,r=r.concat(this.elseBody.unwrap().compileToFragments(e,eP))):r=r.concat(this.makeCode("{\n"),this.elseBody.compileToFragments(tz(e,{indent:l}),eP),this.makeCode("\n".concat(this.tab,"}"))),r):a}},{key:"compileExpression",value:function(e){var t,r,i,n;return i=this.processedCondition().compileToFragments(e,e_),r=this.bodyNode().compileToFragments(e,eS),t=this.elseBodyNode()?this.elseBodyNode().compileToFragments(e,eS):[this.makeCode("void 0")],n=i.concat(this.makeCode(" ? "),r,this.makeCode(" : "),t),e.level>=e_?this.wrapInParentheses(n):n}},{key:"unfoldSoak",value:function(){return this.soak&&this}},{key:"processedCondition",value:function(){return null==this.processedConditionCache?this.processedConditionCache="unless"===this.type?this.condition.invert():this.condition:this.processedConditionCache}},{key:"isStatementAst",value:function(e){return e.level===eP}},{key:"astType",value:function(e){return this.isStatementAst(e)?"IfStatement":"ConditionalExpression"}},{key:"astProperties",value:function(e){var t,r,i,n,s;return t=this.isStatementAst(e),{test:this.condition.ast(e,t?eT:e_),consequent:t?this.body.ast(e,eP):this.bodyNode().ast(e,eP),alternate:this.isChain?this.elseBody.unwrap().ast(e,t?eP:e_):t||1!==(null==(r=this.elseBody)||null==(i=r.expressions)?void 0:i.length)?null==(n=null==(s=this.elseBody)?void 0:s.ast(e,eP))?null:n:this.elseBody.expressions[0].ast(e,eP),postfix:!!this.postfix,inverted:"unless"===this.type}}}]),t}(p);return e.prototype.children=["condition","body","elseBody"],e}).call(this),e.Sequence=eQ=(function(){var e=function(e){"use strict";function t(e){var i;return m(this,t),(i=r.call(this)).expressions=e,i}o(t,e);var r=l(t);return b(t,[{key:"astNode",value:function(e){return 1===this.expressions.length?this.expressions[0].ast(e):s(c(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"SequenceExpression"}},{key:"astProperties",value:function(e){var t;return{expressions:(function(){var r,i,n,s;for(n=this.expressions,s=[],r=0,i=n.length;r<i;r++)t=n[r],s.push(t.ast(e));return s}).call(this)}}}]),t}(p);return e.prototype.children=["expressions"],e}).call(this),tl={modulo:function(){return"function(a, b) { return (+a % (b = +b) + b) % b; }"},boundMethodCheck:function(){return"function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } }"},hasProp:function(){return"{}.hasOwnProperty"},indexOf:function(){return"[].indexOf"},slice:function(){return"[].slice"},splice:function(){return"[].splice"}},eP=1,eT=2,eS=3,e_=4,ew=5,ex=6,te="  ",eY=/^[+-]?\d+$/,eZ=/\s*\n\s*/g,ey=/^[^\n\S]*\n/,tr=/\n[^\n\S]*$/,eK=/((?:\\\\)+)|\\[^\S\n]*\n\s*/g,$=/((?:\\\\)+)|\\(\s)|\s+(?:#.*)?/g,t2=function(e,t){var r,i;return e in(i=t.scope.root).utilities?i.utilities[e]:(r=i.freeVariable(e),i.assign(r,tl[e](t)),i.utilities[e]=r)},tq=function(e,t){var r,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return r="\n"===e[e.length-1],e=(e=(i?t:"")+e.replace(/\n/g,"$&".concat(t))).replace(/\s+$/,""),r&&(e+="\n"),e},tA=function(e,t){var r,i,n,s;for(i=n=0,s=e.length;n<s;i=++n)if((r=e[i]).isHereComment)r.code=tq(r.code,t.tab);else{e.splice(i,0,t.makeCode("".concat(t.tab)));break}return e},tC=function(e){var t,r,i;if(!e.comments)return!1;for(i=e.comments,t=0,r=i.length;t<r;t++)if(!1===i[t].here)return!0;return!1},tW=function(e,t){if(null!=e&&e.comments)return tm(e.comments,t),delete e.comments},t0=function(e,t){var r,i,n,s;for(i=!1,r=n=0,s=e.length;n<s;r=++n)if(!e[r].isComment){e.splice(r,0,t),i=!0;break}return i||e.push(t),e},tR=function(e){return e instanceof K&&"arguments"===e.value},tO=function(e){return e instanceof ts||e instanceof E&&e.bound},tY=function(e){return e.shouldCache()||("function"==typeof e.isAssignable?e.isAssignable():void 0)},t1=function(e,t,r){var i;if(i=t[r].unfoldSoak(e))return t[r]=i.body,i.body=new tu(t),i},tU=function(e){var t,r,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.delimiter,o=n.escapeNewlines,a=n.double,l=n.includeDelimiters,h=n.escapeDelimiter,u=void 0===h||h,c=n.convertTrailingNullEscapes;return""===e&&"/"===s&&(e="(?:)"),t="`"===s,i=RegExp("(\\\\\\\\)|(\\\\0(?=\\d))".concat(c?/|(\\0)$/.source:"").concat(u?RegExp("|\\\\?(".concat(s,")")).source:"").concat(t?/|\\?(\$\{)/.source:"","|\\\\?(?:").concat(o?"(\n)|":"","(\\r)|(\\u2028)|(\\u2029))|(\\\\.)"),"g"),e=e.replace(i,function(e,r,i){for(var n,s,l,h,d,f,p,g,m=arguments.length,v=Array(3<m?m-3:0),b=3;b<m;b++)v[b-3]=arguments[b];switch(g=c?v.shift():void 0,s=u?v.shift():void 0,p=t?v.shift():void 0,l=o?v.shift():void 0,n=v[0],h=v[1],f=v[2],d=v[3],!1){case!r:return a?r+r:r;case!i:case!g:return"\\x00";case!s:return"\\".concat(s);case!p:return"\\${";case!l:return"\\n";case!n:return"\\r";case!h:return"\\u2028";case!f:return"\\u2029";case!d:return a?"\\".concat(d):d}}),r=void 0===l||l?s:"","".concat(r).concat(e).concat(r)},tZ=function(e){var t,r,i,n,s,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=o.notFinalExpression;for(r=0,i=e.length-1,n=[];r<=i&&!(r===i&&a);){if((s=null==(t=e[r])?void 0:"function"==typeof t.unwrap?t.unwrap():void 0)instanceof ez&&s.generated){r++;continue}if(!(t instanceof tu&&t.isString()&&!t.unwrap().shouldGenerateTemplateLiteral()))break;e[r]=new M(t).withLocationDataFrom(t),n.push(r++)}return n},tg=function(e,t){var r;return(r=e.unwrap())instanceof v&&1<r.expressions.length?(r.makeReturn(null,!0),r.ast(t,eP)):e.ast(t,eT)},tV=function(e,t){return e<t?e:t},tE=function(e,t){return e>t?e:t},tI=function(e,t){return e.line>t.line||e.line===t.line&&e.column>t.column},tN=function(e,t){return e.first_line>t.first_line||e.first_line===t.first_line&&e.first_column>t.first_column},tk=function(e,t){return e.last_line>t.last_line||e.last_line===t.last_line&&e.last_column>t.last_column},e.mergeLocationData=tH=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=r.justLeading,n=r.justEnding;return Object.assign(n?{first_line:e.first_line,first_column:e.first_column}:tN(e,t)?{first_line:t.first_line,first_column:t.first_column}:{first_line:e.first_line,first_column:e.first_column},i?{last_line:e.last_line,last_column:e.last_column,last_line_exclusive:e.last_line_exclusive,last_column_exclusive:e.last_column_exclusive}:tk(e,t)?{last_line:e.last_line,last_column:e.last_column,last_line_exclusive:e.last_line_exclusive,last_column_exclusive:e.last_column_exclusive}:{last_line:t.last_line,last_column:t.last_column,last_line_exclusive:t.last_line_exclusive,last_column_exclusive:t.last_column_exclusive},{range:[n?e.range[0]:tV(e.range[0],t.range[0]),i?e.range[1]:tE(e.range[1],t.range[1])]})},e.mergeAstLocationData=tj=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=r.justLeading,n=r.justEnding;return{loc:{start:n?e.loc.start:tI(e.loc.start,t.loc.start)?t.loc.start:e.loc.start,end:i?e.loc.end:tI(e.loc.end,t.loc.end)?e.loc.end:t.loc.end},range:[n?e.range[0]:tV(e.range[0],t.range[0]),i?e.range[1]:tE(e.range[1],t.range[1])],start:n?e.start:tV(e.start,t.start),end:i?e.end:tE(e.end,t.end)}},e.jisonLocationDataToAstLocationData=tF=function(e){var t=e.first_line,r=e.first_column,i=e.last_line_exclusive,n=e.last_column_exclusive,s=e.range;return{loc:{start:{line:t+1,column:r},end:{line:i+1,column:n}},range:[s[0],s[1]],start:s[0],end:s[1]}},t3=function(e){var t=f(e.range,2)[1],r=e.last_line_exclusive,i=e.last_column_exclusive;return{first_line:r,first_column:i,last_line:r,last_column:i,last_line_exclusive:r,last_column_exclusive:i,range:[t,t]}},tS=function(e){return function(t){var r=f(t.range,1)[0],i=t.first_line,n=t.first_column;return{first_line:i,first_column:n,last_line:i,last_column:n+e-1,last_line_exclusive:i,last_column_exclusive:n+e,range:[r,r+e]}}},tw=function(e){return function(t){var r=f(t.range,2)[1],i=t.last_line,n=t.last_column;return{first_line:i,first_column:n-(e-1),last_line:i,last_column:n,last_line_exclusive:t.last_line_exclusive,last_column_exclusive:t.last_column_exclusive,range:[r-e,r]}}},ty=function(e){var t=e.interpolationNode,r=e.openingBrace,i=e.closingBrace;return{first_line:t.locationData.first_line,first_column:t.locationData.first_column+r.length,last_line:t.locationData.last_line,last_column:t.locationData.last_column-i.length,last_line_exclusive:t.locationData.last_line,last_column_exclusive:t.locationData.last_column,range:[t.locationData.range[0]+r.length,t.locationData.range[1]-i.length]}}}).call(this),e}(),g["./sourcemap"]=function(){var e={exports:{}};return(function(){var t,r;t=function(){"use strict";function e(t){m(this,e),this.line=t,this.columns=[]}return b(e,[{key:"add",value:function(e,t){var r=f(t,2),i=r[0],n=r[1],s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return this.columns[e]&&s.noReplace?void 0:this.columns[e]={line:this.line,column:e,sourceLine:i,sourceColumn:n}}},{key:"sourceLocation",value:function(e){for(var t;!((t=this.columns[e])||0>=e);)e--;return t&&[t.sourceLine,t.sourceColumn]}}]),e}(),r=(function(){var e,r,i,s,o=function(){"use strict";function o(){m(this,o),this.lines=[]}return b(o,[{key:"add",value:function(e,r){var i,n,s,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=f(r,2);return s=a[0],n=a[1],((i=this.lines)[s]||(i[s]=new t(s))).add(n,e,o)}},{key:"sourceLocation",value:function(e){for(var t,r=f(e,2),i=r[0],n=r[1];!((t=this.lines[i])||0>=i);)i--;return t&&t.sourceLocation(n)}},{key:"generate",value:function(){var e,t,r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,v=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;for(m=0,i=0,s=0,n=0,c=!1,e="",d=this.lines,h=t=0,o=d.length;t<o;h=++t)if(l=d[h]){for(f=l.columns,r=0,a=f.length;r<a;r++)if(u=f[r]){for(;m<u.line;)i=0,c=!1,e+=";",m++;c&&(e+=",",c=!1),e+=this.encodeVlq(u.column-i),i=u.column,e+=this.encodeVlq(0),e+=this.encodeVlq(u.sourceLine-s),s=u.sourceLine,e+=this.encodeVlq(u.sourceColumn-n),n=u.sourceColumn,c=!0}}return p=v.sourceFiles?v.sourceFiles:v.filename?[v.filename]:["<anonymous>"],g={version:3,file:v.generatedFile||"",sourceRoot:v.sourceRoot||"",sources:p,names:[],mappings:e},(v.sourceMap||v.inlineMap)&&(g.sourcesContent=[b]),g}},{key:"encodeVlq",value:function(e){var t,o,a,l;for(t="",a=0>e?1:0,l=(n(e)<<1)+a;l||!t;)o=l&s,(l>>=i)&&(o|=r),t+=this.encodeBase64(o);return t}},{key:"encodeBase64",value:function(t){return e[t]||function(){throw Error("Cannot Base64 encode value: ".concat(t))}()}}],[{key:"registerCompiled",value:function(e,t,r){if(null!=r)return o.sourceMaps[e]=r}},{key:"getSourceMap",value:function(e){return o.sourceMaps[e]}}]),o}();return o.sourceMaps=Object.create(null),s=(r=1<<(i=5))-1,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o}).call(this),e.exports=r}).call(this),e.exports}(),g["./coffeescript"]=function(){var e={};return(function(){var t,r,i,n,s,o,l,h,u,c,d,p;t=g("./lexer").Lexer,c=g("./parser").parser,l=g("./helpers"),r=g("./sourcemap"),u=g("../../package.json"),e.VERSION=u.version,e.FILE_EXTENSIONS=[".coffee",".litcoffee",".coffee.md"],e.helpers=l;o=r.getSourceMap,d=r.registerCompiled,e.registerCompiled=d,i=function(e){switch(!1){case"function"!=typeof Buffer:return Buffer.from(e).toString("base64");case"function"!=typeof btoa:return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return a("0x"+t)}));default:throw Error("Unable to base64 encode inline sourcemap.")}},p=function(e){return function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{return e.call(this,t,r)}catch(e){if("string"!=typeof t)throw e;throw l.updateSyntaxError(e,t,r.filename)}}},e.compile=p(function(e){var t,s,o,a,u,f,p,g,m,v,b,x,_,S,w,T,P,E,C,A,I,M,R,O,k,N,L,D,B,F=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(g=(F=Object.assign({},F)).sourceMap||F.inlineMap||null==F.filename,u=F.filename||l.anonymousFileName(),n(u,e),g&&(w=new r),k=h.tokenize(e,F),F.referencedVars=function(){var e,t,r;for(r=[],e=0,t=k.length;e<t;e++)"IDENTIFIER"===(O=k[e])[0]&&r.push(O[1]);return r}(),null==F.bare||!0!==F.bare){for(v=0,_=k.length;v<_;v++)if("IMPORT"===(C=(O=k[v])[0])||"EXPORT"===C){F.bare=!0;break}}if(P=c.parse(k),F.ast)return P.allCommentTokens=l.extractAllCommentTokens(k),I=(e.match(/\r?\n/g)||"").length+1,A=/.*$/.exec(e)[0],t=P.ast(F),E=[0,e.length],t.start=t.program.start=E[0],t.end=t.program.end=E[1],t.range=t.program.range=E,t.loc.start=t.program.loc.start={line:1,column:0},t.loc.end.line=t.program.loc.end.line=I,t.loc.end.column=t.program.loc.end.column=A.length,t.tokens=k,t;for(p=P.compileToFragments(F),o=0,F.header&&(o+=1),F.shiftLine&&(o+=1),s=0,x="",b=0,S=p.length;b<S;b++)f=p[b],g&&(f.locationData&&!/^[;\s]*$/.test(f.code)&&w.add([f.locationData.first_line,f.locationData.first_column],[o,s],{noReplace:!0}),o+=T=l.count(f.code,"\n"),T?s=f.code.length-(f.code.lastIndexOf("\n")+1):s+=f.code.length),x+=f.code;if(F.header&&(m="Generated by CoffeeScript ".concat(this.VERSION),x="// ".concat(m,"\n").concat(x)),g&&(B=w.generate(F,e)),F.transpile){if("object"!==y(F.transpile))throw Error("The transpile option must be given an object with options to pass to Babel");N=F.transpile.transpile,delete F.transpile.transpile,L=Object.assign({},F.transpile),B&&null==L.inputSourceMap&&(L.inputSourceMap=B),x=(D=N(x,L)).code,B&&D.map&&(B=D.map)}return F.inlineMap&&(a=i(JSON.stringify(B)),M="//# sourceMappingURL=data:application/json;base64,".concat(a),R="//# sourceURL=".concat(u),x="".concat(x,"\n").concat(M,"\n").concat(R)),d(u,e,w),F.sourceMap?{js:x,sourceMap:w,v3SourceMap:JSON.stringify(B,null,2)}:x}),e.tokens=p(function(e,t){return h.tokenize(e,t)}),e.nodes=p(function(e,t){return"string"==typeof e&&(e=h.tokenize(e,t)),c.parse(e)}),e.run=e.eval=e.register=function(){throw Error("require index.coffee, not this file")},h=new t,c.lexer={yylloc:{range:[]},options:{ranges:!0},lex:function(){var e,t;if(t=c.tokens[this.pos++]){var r=f(t,3);e=r[0],this.yytext=r[1],this.yylloc=r[2],c.errorToken=t.origin||t,this.yylineno=this.yylloc.first_line}else e="";return e},setInput:function(e){return c.tokens=e,this.pos=0},upcomingInput:function(){return""}},c.yy=g("./nodes"),c.yy.parseError=function(e,t){t.token,s=c.errorToken,o=c.tokens;var r,i,n,s,o,a=f(s,3);return i=a[0],n=a[1],r=a[2],n=function(){switch(!1){case s!==o[o.length-1]:return"end of input";case"INDENT"!==i&&"OUTDENT"!==i:return"indentation";case"IDENTIFIER"!==i&&"NUMBER"!==i&&"INFINITY"!==i&&"STRING"!==i&&"STRING_START"!==i&&"REGEX"!==i&&"REGEX_START"!==i:return i.replace(/_START$/,"").toLowerCase();default:return l.nameWhitespaceCharacter(n)}}(),l.throwSyntaxError("unexpected ".concat(n),r)},e.patchStackTrace=function(){var t,r;return t=function(e,t){var r,i,n,s,o,a,l,h,u,c,d;return s=void 0,n="",e.isNative()?n="native":(e.isEval()?(s=e.getScriptNameOrSourceURL())||(n="".concat(e.getEvalOrigin(),", ")):s=e.getFileName(),s||(s="<anonymous>"),l=e.getLineNumber(),n=(u=t(s,l,i=e.getColumnNumber()))?"".concat(s,":").concat(u[0],":").concat(u[1]):"".concat(s,":").concat(l,":").concat(i)),o=e.getFunctionName(),a=e.isConstructor(),e.isToplevel()||a?a?"new ".concat(o||"<anonymous>"," (").concat(n,")"):o?"".concat(o," (").concat(n,")"):n:(h=e.getMethodName(),d=e.getTypeName(),o?(c=r="",d&&o.indexOf(d)&&(c="".concat(d,".")),h&&o.indexOf(".".concat(h))!==o.length-h.length-1&&(r=" [as ".concat(h,"]")),"".concat(c).concat(o).concat(r," (").concat(n,")")):"".concat(d,".").concat(h||"<anonymous>"," (").concat(n,")"))},r=function(e,t,r){var i,n;return null!=(n=o(e,t,r))&&(i=n.sourceLocation([t-1,r-1])),null==i?null:[i[0]+1,i[1]+1]},Error.prepareStackTrace=function(i,n){var s,o;return o=function(){var i,o,a;for(a=[],i=0,o=n.length;i<o&&(s=n[i]).getFunction()!==e.run;i++)a.push("    at ".concat(t(s,r)));return a}(),"".concat(i.toString(),"\n").concat(o.join("\n"),"\n")}},n=function(e,t){var r,i,n,s;if(1<(null==(r=null==(s=null==(i=t.split(/$/m)[0])?void 0:i.match(/^#!\s*([^\s]+\s*)(.*)/))||null==(n=s[2])?void 0:n.split(/\s/).filter(function(e){return""!==e}))?void 0:r.length))return console.error("The script to be run begins with a shebang line with more than one\nargument. This script will fail on platforms such as Linux which only\nallow a single argument."),console.error("The shebang line was: '".concat(i,"' in file '").concat(e,"'")),console.error("The arguments were: ".concat(JSON.stringify(r)))}}).call(this),e}(),g["./browser"]=function(){var e={exports:{}};return(function(){var t,i,n=[].indexOf;t=g("./coffeescript");i=t.compile,t.eval=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return null==t.bare&&(t.bare=!0),("undefined"!=typeof window&&null!==window?window:r.g).eval(i(e,t))},t.run=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t.bare=!0,t.shiftLine=!0,Function(i(e,t))()},e.exports=t,"undefined"==typeof window||null===window||("undefined"!=typeof btoa&&null!==btoa&&"undefined"!=typeof JSON&&null!==JSON&&(i=function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r.inlineMap=!0,t.compile(e,r)}),t.load=function(e,r){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];return n.sourceFiles=[e],(i=window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new window.XMLHttpRequest).open("GET",e,!0),"overrideMimeType"in i&&i.overrideMimeType("text/plain"),i.onreadystatechange=function(){var o,a;if(4===i.readyState){if(0!==(a=i.status)&&200!==a)throw Error("Could not load ".concat(e));o=[i.responseText,n],!s&&t.run.apply(t,x(o));if(r)return r(o)}},i.send(null)},t.runScripts=function(){var e,r,i,s,o,a,l,h,u;for(u=window.document.getElementsByTagName("script"),r=["text/coffeescript","text/literate-coffeescript"],e=function(){var e,t,i,s;for(s=[],e=0,t=u.length;e<t;e++)i=(h=u[e]).type,0<=n.call(r,i)&&s.push(h);return s}(),o=0,i=function(){var r;if((r=e[o])instanceof Array)return t.run.apply(t,x(r)),o++,i()},s=a=0,l=e.length;a<l;s=++a)(function(n,s){var o,a;o={literate:n.type===r[1]},(a=n.src||n.getAttribute("data-src"))?(o.filename=a,t.load(a,function(t){return e[s]=t,i()},o,!0)):(o.filename=n.id&&""!==n.id?n.id:"coffeescript".concat(0===s?"":s),o.sourceFiles=["embedded"],e[s]=[n.innerHTML,o])})(e[s],s);return i()},this===window&&(window.addEventListener?window.addEventListener("DOMContentLoaded",t.runScripts,!1):window.attachEvent("onload",t.runScripts)))}).call(this),e.exports}(),g["./browser"]}(),"function"==typeof define&&define.amd?define(function(){return n}):i.CoffeeScript=n},729:function(e){var t,r;t=0,r=function(){return function e(t,r,i){var n,s,o=window,a="application/octet-stream",l=i||a,h=t,u=!r&&!i&&h,c=document.createElement("a"),d=function(e){return String(e)},f=o.Blob||o.MozBlob||o.WebKitBlob||d,p=r||"download";if(f=f.call?f.bind(o):Blob,"true"===String(this)&&(l=(h=[h,l])[0],h=h[1]),u&&u.length<2048&&(p=u.split("/").pop().split("?")[0],c.href=u,-1!==c.href.indexOf(u))){var g=new XMLHttpRequest;return g.open("GET",u,!0),g.responseType="blob",g.onload=function(t){e(t.target.response,p,a)},setTimeout(function(){g.send()},0),g}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(h)){if(!(h.length>2096103.424)||f===d)return navigator.msSaveBlob?navigator.msSaveBlob(y(h),p):x(h);l=(h=y(h)).type||a}else if(/([\x80-\xff])/.test(h)){for(var m=0,v=new Uint8Array(h.length),b=v.length;m<b;++m)v[m]=h.charCodeAt(m);h=new f([v],{type:l})}function y(e){for(var t=e.split(/[:;,]/),r=t[1],i=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),n=i.length,s=0,o=new Uint8Array(n);s<n;++s)o[s]=i.charCodeAt(s);return new f([o],{type:r})}function x(e,t){if("download"in c)return c.href=e,c.setAttribute("download",p),c.className="download-js-link",c.innerHTML="downloading...",c.style.display="none",document.body.appendChild(c),setTimeout(function(){c.click(),document.body.removeChild(c),!0===t&&setTimeout(function(){o.URL.revokeObjectURL(c.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),!window.open(e)&&confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var r=document.createElement("iframe");document.body.appendChild(r),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),r.src=e,setTimeout(function(){document.body.removeChild(r)},333)}if(n=h instanceof f?h:new f([h],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(n,p);if(o.URL)x(o.URL.createObjectURL(n),!0);else{if("string"==typeof n||n.constructor===d)try{return x("data:"+l+";base64,"+o.btoa(n))}catch(e){return x("data:"+l+","+encodeURIComponent(n))}(s=new FileReader).onload=function(e){x(this.result)},s.readAsDataURL(n)}return!0}},"function"==typeof define&&define.amd?define([],r):e.exports=r()},295:function(e,t,r){var i;i=function(){return(function e(t,r,i){function n(o,a){if(!r[o]){if(!t[o]){if(s)return s(o,!0);var l=Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=r[o]={exports:{}};t[o][0].call(h.exports,function(e){return n(t[o][1][e]||e)},h,h.exports,e,t,r,i)}return r[o].exports}for(var s=void 0,o=0;o<i.length;o++)n(i[o]);return n})({1:[function(e,t,r){"use strict";let i=e("fs"),n=e("fast-csv"),s=e("dayjs/plugin/customParseFormat"),o=e("dayjs/plugin/utc"),a=e("dayjs").extend(s).extend(o),l=e("../utils/stream-buf"),{fs:{exists:h}}=e("../utils/utils"),u={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};t.exports=class{constructor(e){this.workbook=e,this.worksheet=null}async readFile(e,t){if(t=t||{},!await h(e))throw Error("File not found: "+e);let r=i.createReadStream(e),n=await this.read(r,t);return r.close(),n}read(e,t){return t=t||{},new Promise((r,i)=>{let s=this.workbook.addWorksheet(t.sheetName),o=t.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],l=t.map||function(e){if(""===e)return null;let t=Number(e);if(!Number.isNaN(t)&&t!==1/0)return t;let r=o.reduce((t,r)=>{if(t)return t;let i=a(e,r,!0);return i.isValid()?i:null},null);if(r)return new Date(r.valueOf());let i=u[e];return void 0!==i?i:e},h=n.parse(t.parserOptions).on("data",e=>{s.addRow(e.map(l))}).on("end",()=>{h.emit("worksheet",s)});h.on("worksheet",r).on("error",i),e.pipe(h)})}createInputStream(){throw Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(e,t){return new Promise((r,i)=>{t=t||{};let s=this.workbook.getWorksheet(t.sheetName||t.sheetId),o=n.format(t.formatterOptions);e.on("finish",()=>{r()}),o.on("error",i),o.pipe(e);let{dateFormat:l,dateUTC:h}=t,u=t.map||(e=>{if(e){if(e.text||e.hyperlink)return e.hyperlink||e.text||"";if(e.formula||e.result)return e.result||"";if(e instanceof Date)return l?h?a.utc(e).format(l):a(e).format(l):h?a.utc(e).format():a(e).format();if(e.error)return e.error;if("object"==typeof e)return JSON.stringify(e)}return e}),c=void 0===t.includeEmptyRows||t.includeEmptyRows,d=1;s&&s.eachRow((e,t)=>{if(c)for(;d++<t-1;)o.write([]);let{values:r}=e;r.shift(),o.write(r.map(u)),d=t}),o.end()})}writeFile(e,t){let r={encoding:(t=t||{}).encoding||"utf8"},n=i.createWriteStream(e,r);return this.write(n,t)}async writeBuffer(e){let t=new l;return await this.write(t,e),t.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,t,r){"use strict";let i=e("../utils/col-cache");class n{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.worksheet=e,t){if("string"==typeof t){let e=i.decodeAddress(t);this.nativeCol=e.col+r,this.nativeColOff=0,this.nativeRow=e.row+r,this.nativeRowOff=0}else void 0!==t.nativeCol?(this.nativeCol=t.nativeCol||0,this.nativeColOff=t.nativeColOff||0,this.nativeRow=t.nativeRow||0,this.nativeRowOff=t.nativeRowOff||0):void 0!==t.col?(this.col=t.col+r,this.row=t.row+r):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0)}else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(e){return e instanceof n||null==e?e:new n(e)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(e){this.nativeCol=Math.floor(e),this.nativeColOff=Math.floor((e-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(e){this.nativeRow=Math.floor(e),this.nativeRowOff=Math.floor((e-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(e){this.nativeCol=e.nativeCol,this.nativeColOff=e.nativeColOff,this.nativeRow=e.nativeRow,this.nativeRowOff=e.nativeRowOff}}t.exports=n},{"../utils/col-cache":19}],3:[function(e,t,r){"use strict";let i=e("../utils/col-cache"),n=e("../utils/under-dash"),s=e("./enums"),{slideFormula:o}=e("../utils/shared-formula"),a=e("./note");class l{constructor(e,t,r){if(!e||!t)throw Error("A Cell needs a Row");this._row=e,this._column=t,i.validateAddress(r),this._address=r,this._value=h.create(l.Types.Null,this),this.style=this._mergeStyle(e.style,t.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(e){this.style.numFmt=e}get font(){return this.style.font}set font(e){this.style.font=e}get alignment(){return this.style.alignment}set alignment(e){this.style.alignment=e}get border(){return this.style.border}set border(e){this.style.border=e}get fill(){return this.style.fill}set fill(e){this.style.fill=e}get protection(){return this.style.protection}set protection(e){this.style.protection=e}_mergeStyle(e,t,r){let i=e&&e.numFmt||t&&t.numFmt;i&&(r.numFmt=i);let n=e&&e.font||t&&t.font;n&&(r.font=n);let s=e&&e.alignment||t&&t.alignment;s&&(r.alignment=s);let o=e&&e.border||t&&t.border;o&&(r.border=o);let a=e&&e.fill||t&&t.fill;a&&(r.fill=a);let l=e&&e.protection||t&&t.protection;return l&&(r.protection=l),r}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===l.Types.Merge}merge(e,t){this._value.release(),this._value=h.create(l.Types.Merge,this,e),t||(this.style=e.style)}unmerge(){this.type===l.Types.Merge&&(this._value.release(),this._value=h.create(l.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(e){return this._value.type===l.Types.Merge&&this._value.isMergedTo(e)}get master(){return this.type===l.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===l.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(e){this.type!==l.Types.Merge?(this._value.release(),this._value=h.create(h.getType(e),this,e)):this._value.master.value=e}get note(){return this._comment&&this._comment.note}set note(e){this._comment=new a(e)}get text(){return this._value.toString()}get html(){return n.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(e){this.type===l.Types.String&&(this._value=h.create(l.Types.Hyperlink,this,{text:this._value.value,hyperlink:e}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){let{worksheet:e}=this._row;return{sheetName:e.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(e){this.names=[e]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(e){let{definedNames:t}=this.workbook;t.removeAllNames(this.fullAddress),e.forEach(e=>{t.addEx(this.fullAddress,e)})}addName(e){this.workbook.definedNames.addEx(this.fullAddress,e)}removeName(e){this.workbook.definedNames.removeEx(this.fullAddress,e)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(e){this._dataValidations.add(this.address,e)}get model(){let{model:e}=this._value;return e.style=this.style,this._comment&&(e.comment=this._comment.model),e}set model(e){this._value.release(),this._value=h.create(e.type,this),this._value.model=e,e.comment&&"note"===e.comment.type&&(this._comment=a.fromModel(e.comment)),e.style?this.style=e.style:this.style={}}}l.Types=s.ValueType;let h={getType:e=>null==e?l.Types.Null:e instanceof String||"string"==typeof e?l.Types.String:"number"==typeof e?l.Types.Number:"boolean"==typeof e?l.Types.Boolean:e instanceof Date?l.Types.Date:e.text&&e.hyperlink?l.Types.Hyperlink:e.formula||e.sharedFormula?l.Types.Formula:e.richText?l.Types.RichText:e.sharedString?l.Types.SharedString:e.error?l.Types.Error:l.Types.JSON,types:[{t:l.Types.Null,f:class{constructor(e){this.model={address:e.address,type:l.Types.Null}}get value(){return null}set value(e){}get type(){return l.Types.Null}get effectiveType(){return l.Types.Null}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){}toString(){return""}}},{t:l.Types.Number,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Number,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Number}get effectiveType(){return l.Types.Number}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.String,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.String}get effectiveType(){return l.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:l.Types.Date,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Date,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Date}get effectiveType(){return l.Types.Date}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.Hyperlink,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Hyperlink,text:t?t.text:void 0,hyperlink:t?t.hyperlink:void 0},t&&t.tooltip&&(this.model.tooltip=t.tooltip)}get value(){let e={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(e.tooltip=this.model.tooltip),e}set value(e){this.model={text:e.text,hyperlink:e.hyperlink},e.tooltip&&(this.model.tooltip=e.tooltip)}get text(){return this.model.text}set text(e){this.model.text=e}get hyperlink(){return this.model.hyperlink}set hyperlink(e){this.model.hyperlink=e}get type(){return l.Types.Hyperlink}get effectiveType(){return l.Types.Hyperlink}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:l.Types.Formula,f:class{constructor(e,t){this.cell=e,this.model={address:e.address,type:l.Types.Formula,shareType:t?t.shareType:void 0,ref:t?t.ref:void 0,formula:t?t.formula:void 0,sharedFormula:t?t.sharedFormula:void 0,result:t?t.result:void 0}}_copyModel(e){let t={},r=r=>{let i=e[r];i&&(t[r]=i)};return r("formula"),r("result"),r("ref"),r("shareType"),r("sharedFormula"),t}get value(){return this._copyModel(this.model)}set value(e){this.model=this._copyModel(e)}validate(e){switch(h.getType(e)){case l.Types.Null:case l.Types.String:case l.Types.Number:case l.Types.Date:break;case l.Types.Hyperlink:case l.Types.Formula:default:throw Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(e){this.model.formula=e}get formulaType(){return this.model.formula?s.FormulaType.Master:this.model.sharedFormula?s.FormulaType.Shared:s.FormulaType.None}get result(){return this.model.result}set result(e){this.model.result=e}get type(){return l.Types.Formula}get effectiveType(){let e=this.model.result;return null==e?s.ValueType.Null:e instanceof String||"string"==typeof e?s.ValueType.String:"number"==typeof e?s.ValueType.Number:e instanceof Date?s.ValueType.Date:e.text&&e.hyperlink?s.ValueType.Hyperlink:e.formula?s.ValueType.Formula:s.ValueType.Null}get address(){return this.model.address}set address(e){this.model.address=e}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){let{worksheet:e}=this.cell,t=e.findCell(this.model.sharedFormula);this._translatedFormula=t&&o(t.formula,t.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:l.Types.Merge,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Merge,master:t?t.address:void 0},this._master=t,t&&t.addMergeRef()}get value(){return this._master.value}set value(e){e instanceof l?(this._master&&this._master.releaseMergeRef(),e.addMergeRef(),this._master=e):this._master.value=e}isMergedTo(e){return e===this._master}get master(){return this._master}get type(){return l.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:l.Types.JSON,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:JSON.stringify(t),rawValue:t}}get value(){return this.model.rawValue}set value(e){this.model.rawValue=e,this.model.value=JSON.stringify(e)}get type(){return l.Types.String}get effectiveType(){return l.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:l.Types.SharedString,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.SharedString,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.SharedString}get effectiveType(){return l.Types.SharedString}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.RichText,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}toString(){return this.model.value.richText.map(e=>e.text).join("")}get type(){return l.Types.RichText}get effectiveType(){return l.Types.RichText}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:l.Types.Boolean,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Boolean,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Boolean}get effectiveType(){return l.Types.Boolean}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:l.Types.Error,f:class{constructor(e,t){this.model={address:e.address,type:l.Types.Error,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Error}get effectiveType(){return l.Types.Error}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((e,t)=>(e[t.t]=t.f,e),[]),create(e,t,r){let i=this.types[e];if(!i)throw Error("Could not create Value of type "+e);return new i(t,r)}};t.exports=l},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,t,r){"use strict";let i=e("../utils/under-dash"),n=e("./enums"),s=e("../utils/col-cache");class o{constructor(e,t,r){this._worksheet=e,this._number=t,!1!==r&&(this.defn=r)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return s.n2l(this._number)}get isCustomWidth(){return void 0!==this.width&&9!==this.width}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(e){e?(this.key=e.key,this.width=void 0!==e.width?e.width:9,this.outlineLevel=e.outlineLevel,e.style?this.style=e.style:this.style={},this.header=e.header,this._hidden=!!e.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(e){void 0!==e?(this._header=e,this.headers.forEach((e,t)=>{this._worksheet.getCell(t+1,this.number).value=e})):this._header=void 0}get key(){return this._key}set key(e){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=e,e&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(e){return this.width===e.width&&this.hidden===e.hidden&&this.outlineLevel===e.outlineLevel&&i.isEqual(this.style,e.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;let e=this.style;return!e||!(e.font||e.numFmt||e.alignment||e.border||e.fill||e.protection)}get headerCount(){return this.headers.length}eachCell(e,t){let r=this.number;t||(t=e,e=null),this._worksheet.eachRow(e,(e,i)=>{t(e.getCell(r),i)})}get values(){let e=[];return this.eachCell((t,r)=>{t&&t.type!==n.ValueType.Null&&(e[r]=t.value)}),e}set values(e){if(!e)return;let t=this.number,r=0;e.hasOwnProperty("0")&&(r=1),e.forEach((e,i)=>{this._worksheet.getCell(i+r,t).value=e})}_applyStyle(e,t){return this.style[e]=t,this.eachCell(r=>{r[e]=t}),t}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}static toModel(e){let t=[],r=null;return e&&e.forEach((e,i)=>{e.isDefault?r&&(r=null):r&&e.equivalentTo(r)?r.max=i+1:(r={min:i+1,max:i+1,width:void 0!==e.width?e.width:9,style:e.style,isCustomWidth:e.isCustomWidth,hidden:e.hidden,outlineLevel:e.outlineLevel,collapsed:e.collapsed},t.push(r))}),t.length?t:void 0}static fromModel(e,t){let r=[],i=1,n=0;for(t=(t=t||[]).sort(function(e,t){return e.min-t.min});n<t.length;){let s=t[n++];for(;i<s.min;)r.push(new o(e,i++));for(;i<=s.max;)r.push(new o(e,i++,s))}return r.length?r:null}}t.exports=o},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,t,r){"use strict";t.exports=class{constructor(e){this.model=e||{}}add(e,t){return this.model[e]=t}find(e){return this.model[e]}remove(e){this.model[e]=void 0}}},{}],6:[function(e,t,r){"use strict";let i=e("../utils/under-dash"),n=e("../utils/col-cache"),s=e("../utils/cell-matrix"),o=e("./range"),a=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;t.exports=class{constructor(){this.matrixMap={}}getMatrix(e){return this.matrixMap[e]||(this.matrixMap[e]=new s)}add(e,t){let r=n.decodeEx(e);this.addEx(r,t)}addEx(e,t){let r=this.getMatrix(t);if(e.top)for(let t=e.left;t<=e.right;t++)for(let i=e.top;i<=e.bottom;i++){let s={sheetName:e.sheetName,address:n.n2l(t)+i,row:i,col:t};r.addCellEx(s)}else r.addCellEx(e)}remove(e,t){let r=n.decodeEx(e);this.removeEx(r,t)}removeEx(e,t){this.getMatrix(t).removeCellEx(e)}removeAllNames(e){i.each(this.matrixMap,t=>{t.removeCellEx(e)})}forEach(e){i.each(this.matrixMap,(t,r)=>{t.forEach(t=>{e(r,t)})})}getNames(e){return this.getNamesEx(n.decodeEx(e))}getNamesEx(e){return i.map(this.matrixMap,(t,r)=>t.findCellEx(e)&&r).filter(Boolean)}_explore(e,t){let r,i;t.mark=!1;let{sheetName:n}=t,s=new o(t.row,t.col,t.row,t.col,n);function a(r,i){let o=e.findCellAt(n,r,t.col);return!(!o||!o.mark)&&(s[i]=r,o.mark=!1,!0)}for(i=t.row-1;a(i,"top");i--);for(i=t.row+1;a(i,"bottom");i++);function l(t,r){let o=[];for(i=s.top;i<=s.bottom;i++){let r=e.findCellAt(n,i,t);if(!r||!r.mark)return!1;o.push(r)}s[r]=t;for(let e=0;e<o.length;e++)o[e].mark=!1;return!0}for(r=t.col-1;l(r,"left");r--);for(r=t.col+1;l(r,"right");r++);return s}getRanges(e,t){return(t=t||this.matrixMap[e])?(t.forEach(e=>{e.mark=!0}),{name:e,ranges:t.map(e=>e.mark&&this._explore(t,e)).filter(Boolean).map(e=>e.$shortRange)}):{name:e,ranges:[]}}normaliseMatrix(e,t){e.forEachInSheet(t,(e,t,r)=>{e&&(e.row===t&&e.col===r||(e.row=t,e.col=r,e.address=n.n2l(r)+t))})}spliceRows(e,t,r,n){i.each(this.matrixMap,i=>{i.spliceRows(e,t,r,n),this.normaliseMatrix(i,e)})}spliceColumns(e,t,r,n){i.each(this.matrixMap,i=>{i.spliceColumns(e,t,r,n),this.normaliseMatrix(i,e)})}get model(){return i.map(this.matrixMap,(e,t)=>this.getRanges(t,e)).filter(e=>e.ranges.length)}set model(e){let t=this.matrixMap={};e.forEach(e=>{let r=t[e.name]=new s;e.ranges.forEach(e=>{a.test(e.split("!").pop()||"")&&r.addCell(e)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,t,r){"use strict";t.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,t,r){"use strict";let i=e("../utils/col-cache"),n=e("./anchor");t.exports=class{constructor(e,t){this.worksheet=e,this.model=t}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw Error("Invalid Image Type")}}set model(e){let{type:t,imageId:r,range:s,hyperlinks:o}=e;if(this.type=t,this.imageId=r,"image"===t){if("string"==typeof s){let e=i.decode(s);this.range={tl:new n(this.worksheet,{col:e.left,row:e.top},-1),br:new n(this.worksheet,{col:e.right,row:e.bottom},0),editAs:"oneCell"}}else this.range={tl:new n(this.worksheet,s.tl,0),br:s.br&&new n(this.worksheet,s.br,0),ext:s.ext,editAs:s.editAs,hyperlinks:o||s.hyperlinks}}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,t,r){"use strict";let i=e("../utils/under-dash");class n{constructor(e){this.note=e}get model(){let e=null;if("string"==typeof this.note)e={type:"note",note:{texts:[{text:this.note}]}};else e={type:"note",note:this.note};return i.deepMerge({},n.DEFAULT_CONFIGS,e)}set model(e){let{note:t}=e,{texts:r}=t;1===r.length&&1===Object.keys(r[0]).length?this.note=r[0].text:this.note=t}static fromModel(e){let t=new n;return t.model=e,t}}n.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},t.exports=n},{"../utils/under-dash":26}],10:[function(e,t,r){"use strict";let i=e("../utils/col-cache");class n{constructor(){this.decode(arguments)}setTLBR(e,t,r,n,s){if(arguments.length<4){let n=i.decodeAddress(e),o=i.decodeAddress(t);this.model={top:Math.min(n.row,o.row),left:Math.min(n.col,o.col),bottom:Math.max(n.row,o.row),right:Math.max(n.col,o.col),sheetName:r},this.setTLBR(n.row,n.col,o.row,o.col,s)}else this.model={top:Math.min(e,r),left:Math.min(t,n),bottom:Math.max(e,r),right:Math.max(t,n),sheetName:s}}decode(e){switch(e.length){case 5:this.setTLBR(e[0],e[1],e[2],e[3],e[4]);break;case 4:this.setTLBR(e[0],e[1],e[2],e[3]);break;case 3:this.setTLBR(e[0],e[1],e[2]);break;case 2:this.setTLBR(e[0],e[1]);break;case 1:{let t=e[0];if(t instanceof n)this.model={top:t.model.top,left:t.model.left,bottom:t.model.bottom,right:t.model.right,sheetName:t.sheetName};else if(t instanceof Array)this.decode(t);else if(t.top&&t.left&&t.bottom&&t.right)this.model={top:t.top,left:t.left,bottom:t.bottom,right:t.right,sheetName:t.sheetName};else{let e=i.decodeEx(t);e.top?this.model={top:e.top,left:e.left,bottom:e.bottom,right:e.right,sheetName:e.sheetName}:this.model={top:e.row,left:e.col,bottom:e.row,right:e.col,sheetName:e.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw Error("Invalid number of arguments to _getDimensions() - "+e.length)}}get top(){return this.model.top||1}set top(e){this.model.top=e}get left(){return this.model.left||1}set left(e){this.model.left=e}get bottom(){return this.model.bottom||1}set bottom(e){this.model.bottom=e}get right(){return this.model.right||1}set right(e){this.model.right=e}get sheetName(){return this.model.sheetName}set sheetName(e){this.model.sheetName=e}get _serialisedSheetName(){let{sheetName:e}=this.model;return e?/^[a-zA-Z0-9]*$/.test(e)?e+"!":`'${e}'!`:""}expand(e,t,r,i){(!this.model.top||e<this.top)&&(this.top=e),(!this.model.left||t<this.left)&&(this.left=t),(!this.model.bottom||r>this.bottom)&&(this.bottom=r),(!this.model.right||i>this.right)&&(this.right=i)}expandRow(e){if(e){let{dimensions:t,number:r}=e;t&&this.expand(r,t.min,r,t.max)}}expandToAddress(e){let t=i.decodeEx(e);this.expand(t.row,t.col,t.row,t.col)}get tl(){return i.n2l(this.left)+this.top}get $t$l(){return`$${i.n2l(this.left)}$${this.top}`}get br(){return i.n2l(this.right)+this.bottom}get $b$r(){return`$${i.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(e){return(!e.sheetName||!this.sheetName||e.sheetName===this.sheetName)&&!(e.bottom<this.top)&&!(e.top>this.bottom)&&!(e.right<this.left)&&!(e.left>this.right)}contains(e){let t=i.decodeEx(e);return this.containsEx(t)}containsEx(e){return(!e.sheetName||!this.sheetName||e.sheetName===this.sheetName)&&e.row>=this.top&&e.row<=this.bottom&&e.col>=this.left&&e.col<=this.right}forEachAddress(e){for(let t=this.left;t<=this.right;t++)for(let r=this.top;r<=this.bottom;r++)e(i.encodeAddress(r,t),r,t)}}t.exports=n},{"../utils/col-cache":19}],11:[function(e,t,r){"use strict";let i=e("../utils/under-dash"),n=e("./enums"),s=e("../utils/col-cache"),o=e("./cell");t.exports=class{constructor(e,t){this._worksheet=e,this._number=t,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(e){return this._cells[e-1]}getCellEx(e){let t=this._cells[e.col-1];return!t&&(t=new o(this,this._worksheet.getColumn(e.col),e.address),this._cells[e.col-1]=t),t}getCell(e){if("string"==typeof e){let t=this._worksheet.getColumnKey(e);e=t?t.number:s.l2n(e)}return this._cells[e-1]||this.getCellEx({address:s.encodeAddress(this._number,e),row:this._number,col:e})}splice(e,t){let r,i,n;let s=e+t;for(var o=arguments.length,a=Array(o>2?o-2:0),l=2;l<o;l++)a[l-2]=arguments[l];let h=a.length-t,u=this._cells.length;if(h<0)for(r=e+a.length;r<=u;r++)n=this._cells[r-1],(i=this._cells[r-h-1])?((n=this.getCell(r)).value=i.value,n.style=i.style,n._comment=i._comment):n&&(n.value=null,n.style={},n._comment=void 0);else if(h>0)for(r=u;r>=s;r--)(i=this._cells[r-1])?((n=this.getCell(r+h)).value=i.value,n.style=i.style,n._comment=i._comment):this._cells[r+h-1]=void 0;for(r=0;r<a.length;r++)(n=this.getCell(e+r)).value=a[r],n.style={},n._comment=void 0}eachCell(e,t){if(t||(t=e,e=null),e&&e.includeEmpty){let e=this._cells.length;for(let r=1;r<=e;r++)t(this.getCell(r),r)}else this._cells.forEach((e,r)=>{e&&e.type!==n.ValueType.Null&&t(e,r+1)})}addPageBreak(e,t){let r=this._worksheet,i=Math.max(0,e-1)||0,n=Math.max(0,t-1)||16838,s={id:this._number,max:n,man:1};i&&(s.min=i),r.rowBreaks.push(s)}get values(){let e=[];return this._cells.forEach(t=>{t&&t.type!==n.ValueType.Null&&(e[t.col]=t.value)}),e}set values(e){if(this._cells=[],e){if(e instanceof Array){let t=0;e.hasOwnProperty("0")&&(t=1),e.forEach((e,r)=>{void 0!==e&&(this.getCellEx({address:s.encodeAddress(this._number,r+t),row:this._number,col:r+t}).value=e)})}else this._worksheet.eachColumnKey((t,r)=>{void 0!==e[r]&&(this.getCellEx({address:s.encodeAddress(this._number,t.number),row:this._number,col:t.number}).value=e[r])})}}get hasValues(){return i.some(this._cells,e=>e&&e.type!==n.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let e=0;return this.eachCell(()=>{e++}),e}get dimensions(){let e=0,t=0;return this._cells.forEach(r=>{r&&r.type!==n.ValueType.Null&&((!e||e>r.col)&&(e=r.col),t<r.col&&(t=r.col))}),e>0?{min:e,max:t}:null}_applyStyle(e,t){return this.style[e]=t,this._cells.forEach(r=>{r&&(r[e]=t)}),t}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){let e=[],t=0,r=0;return this._cells.forEach(i=>{if(i){let n=i.model;n&&((!t||t>i.col)&&(t=i.col),r<i.col&&(r=i.col),e.push(n))}}),this.height||e.length?{cells:e,number:this.number,min:t,max:r,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(e){let t;if(e.number!==this._number)throw Error("Invalid row number in model");this._cells=[],e.cells.forEach(e=>{if(e.type===o.Types.Merge);else{let r;if(e.address)r=s.decodeAddress(e.address);else if(t){let{row:e}=t,i=t.col+1;r={row:e,col:i,address:s.encodeAddress(e,i),$col$row:`$${s.n2l(i)}$${e}`}}t=r,this.getCellEx(r).model=e}}),e.height?this.height=e.height:delete this.height,this.hidden=e.hidden,this.outlineLevel=e.outlineLevel||0,this.style=e.style&&JSON.parse(JSON.stringify(e.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,t,r){"use strict";let i=e("../utils/col-cache");class n{constructor(e,t,r){this.table=e,this.column=t,this.index=r}_set(e,t){this.table.cacheState(),this.column[e]=t}get name(){return this.column.name}set name(e){this._set("name",e)}get filterButton(){return this.column.filterButton}set filterButton(e){this.column.filterButton=e}get style(){return this.column.style}set style(e){this.column.style=e}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(e){this._set("totalsRowLabel",e)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(e){this._set("totalsRowFunction",e)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(e){this._set("totalsRowResult",e)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(e){this._set("totalsRowFormula",e)}}t.exports=class{constructor(e,t){this.worksheet=e,t&&(this.table=t,this.validate(),this.store())}getFormula(e){switch(e.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${e.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${e.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${e.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${e.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${e.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${e.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${e.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${e.name}])`;case"custom":return e.totalsRowFormula;default:throw Error("Invalid Totals Row Function: "+e.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){let{table:e}=this,t=(e,t,r)=>{void 0===e[t]&&(e[t]=r)};t(e,"headerRow",!0),t(e,"totalsRow",!1),t(e,"style",{}),t(e.style,"theme","TableStyleMedium2"),t(e.style,"showFirstColumn",!1),t(e.style,"showLastColumn",!1),t(e.style,"showRowStripes",!1),t(e.style,"showColumnStripes",!1);let r=(e,t)=>{if(!e)throw Error(t)};r(e.ref,"Table must have ref"),r(e.columns,"Table must have column definitions"),r(e.rows,"Table must have row definitions"),e.tl=i.decodeAddress(e.ref);let{row:n,col:s}=e.tl;r(n>0,"Table must be on valid row"),r(s>0,"Table must be on valid col");let{width:o,filterHeight:a,tableHeight:l}=this;e.autoFilterRef=i.encode(n,s,n+a-1,s+o-1),e.tableRef=i.encode(n,s,n+l-1,s+o-1),e.columns.forEach((e,i)=>{r(e.name,`Column ${i} must have a name`),0===i?t(e,"totalsRowLabel","Total"):(t(e,"totalsRowFunction","none"),e.totalsRowFormula=this.getFormula(e))})}store(){let e=(e,t)=>{t&&Object.keys(t).forEach(r=>{e[r]=t[r]})},{worksheet:t,table:r}=this,{row:i,col:n}=r.tl,s=0;if(r.headerRow){let o=t.getRow(i+s++);r.columns.forEach((t,r)=>{let{style:i,name:s}=t,a=o.getCell(n+r);a.value=s,e(a,i)})}if(r.rows.forEach(o=>{let a=t.getRow(i+s++);o.forEach((t,i)=>{let s=a.getCell(n+i);s.value=t,e(s,r.columns[i].style)})}),r.totalsRow){let o=t.getRow(i+s++);r.columns.forEach((t,r)=>{let i=o.getCell(n+r);if(0===r)i.value=t.totalsRowLabel;else{let e=this.getFormula(t);i.value=e?{formula:t.totalsRowFormula,result:t.totalsRowResult}:null}e(i,t.style)})}}load(e){let{table:t}=this,{row:r,col:i}=t.tl,n=0;if(t.headerRow){let s=e.getRow(r+n++);t.columns.forEach((e,t)=>{s.getCell(i+t).value=e.name})}if(t.rows.forEach(t=>{let s=e.getRow(r+n++);t.forEach((e,t)=>{s.getCell(i+t).value=e})}),t.totalsRow){let s=e.getRow(r+n++);t.columns.forEach((e,t)=>{let r=s.getCell(i+t);0===t?r.value=e.totalsRowLabel:this.getFormula(e)&&(r.value={formula:e.totalsRowFormula,result:e.totalsRowResult})})}}get model(){return this.table}set model(e){this.table=e}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();let e=i.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let t=0;t<this._cache.tableHeight;t++){let r=this.worksheet.getRow(e.row+t);for(let t=0;t<this._cache.width;t++)r.getCell(e.col+t).value=null}else{for(let t=this.tableHeight;t<this._cache.tableHeight;t++){let r=this.worksheet.getRow(e.row+t);for(let t=0;t<this._cache.width;t++)r.getCell(e.col+t).value=null}for(let t=0;t<this.tableHeight;t++){let r=this.worksheet.getRow(e.row+t);for(let t=this.width;t<this._cache.width;t++)r.getCell(e.col+t).value=null}}this.store()}addRow(e,t){this.cacheState(),void 0===t?this.table.rows.push(e):this.table.rows.splice(t,0,e)}removeRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cacheState(),this.table.rows.splice(e,t)}getColumn(e){return new n(this,this.table.columns[e],e)}addColumn(e,t,r){this.cacheState(),void 0===r?(this.table.columns.push(e),this.table.rows.forEach((e,r)=>{e.push(t[r])})):(this.table.columns.splice(r,0,e),this.table.rows.forEach((e,i)=>{e.splice(r,0,t[i])}))}removeColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cacheState(),this.table.columns.splice(e,t),this.table.rows.forEach(r=>{r.splice(e,t)})}_assign(e,t,r){this.cacheState(),e[t]=r}get ref(){return this.table.ref}set ref(e){this._assign(this.table,"ref",e)}get name(){return this.table.name}set name(e){this.table.name=e}get displayName(){return this.table.displyName||this.table.name}set displayNamename(e){this.table.displayName=e}get headerRow(){return this.table.headerRow}set headerRow(e){this._assign(this.table,"headerRow",e)}get totalsRow(){return this.table.totalsRow}set totalsRow(e){this._assign(this.table,"totalsRow",e)}get theme(){return this.table.style.name}set theme(e){this.table.style.name=e}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(e){this.table.style.showFirstColumn=e}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(e){this.table.style.showLastColumn=e}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(e){this.table.style.showRowStripes=e}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(e){this.table.style.showColumnStripes=e}}},{"../utils/col-cache":19}],13:[function(e,t,r){"use strict";let i=e("./worksheet"),n=e("./defined-names"),s=e("../xlsx/xlsx"),o=e("../csv/csv");t.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new n}get xlsx(){return this._xlsx||(this._xlsx=new s(this)),this._xlsx}get csv(){return this._csv||(this._csv=new o(this)),this._csv}get nextId(){for(let e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addWorksheet(e,t){let r=this.nextId;t&&("string"==typeof t?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),t={properties:{tabColor:{argb:t}}}):(t.argb||t.theme||t.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),t={properties:{tabColor:t}}));let n=this._worksheets.reduce((e,t)=>(t&&t.orderNo)>e?t.orderNo:e,0),s=new i(Object.assign({},t,{id:r,name:e,orderNo:n+1,workbook:this}));return this._worksheets[r]=s,s}removeWorksheetEx(e){delete this._worksheets[e.id]}removeWorksheet(e){let t=this.getWorksheet(e);t&&t.destroy()}getWorksheet(e){return void 0===e?this._worksheets.find(Boolean):"number"==typeof e?this._worksheets[e]:"string"==typeof e?this._worksheets.find(t=>t&&t.name===e):void 0}get worksheets(){return this._worksheets.slice(1).sort((e,t)=>e.orderNo-t.orderNo).filter(Boolean)}eachSheet(e){this.worksheets.forEach(t=>{e(t,t.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(e){let t=this.media.length;return this.media.push(Object.assign({},e,{type:"image"})),t}getImage(e){return this.media[e]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(e=>e.model),sheets:this.worksheets.map(e=>e.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(e){this.creator=e.creator,this.lastModifiedBy=e.lastModifiedBy,this.lastPrinted=e.lastPrinted,this.created=e.created,this.modified=e.modified,this.company=e.company,this.manager=e.manager,this.title=e.title,this.subject=e.subject,this.keywords=e.keywords,this.category=e.category,this.description=e.description,this.language=e.language,this.revision=e.revision,this.contentStatus=e.contentStatus,this.properties=e.properties,this.calcProperties=e.calcProperties,this._worksheets=[],e.worksheets.forEach(t=>{let{id:r,name:n,state:s}=t,o=e.sheets&&e.sheets.findIndex(e=>e.id===r);(this._worksheets[r]=new i({id:r,name:n,orderNo:o,state:s,workbook:this})).model=t}),this._definedNames.model=e.definedNames,this.views=e.views,this._themes=e.themes,this.media=e.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,t,r){"use strict";let i=e("../utils/under-dash"),n=e("../utils/col-cache"),s=e("./range"),o=e("./row"),a=e("./column"),l=e("./enums"),h=e("./image"),u=e("./table"),c=e("./data-validations"),d=e("../utils/encryptor"),{copyStyle:f}=e("../utils/copy-style");t.exports=class{constructor(e){e=e||{},this._workbook=e.workbook,this.id=e.id,this.orderNo=e.orderNo,this.name=e.name,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:0xffffffff,verticalDpi:0xffffffff,fitToPage:!(!e.pageSetup||!e.pageSetup.fitToWidth&&!e.pageSetup.fitToHeight||e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.dataValidations=new c,this.views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(e){if(void 0===e&&(e="sheet"+this.id),this._name!==e){if("string"!=typeof e)throw Error("The name has to be a string.");if(""===e)throw Error("The name can't be empty.");if("History"===e)throw Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(e))throw Error(`Worksheet name ${e} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(e))throw Error("The first or last character of worksheet name cannot be a single quotation mark: "+e);if(e&&e.length>31&&(console.warn(`Worksheet name ${e} exceeds 31 chars. This will be truncated`),e=e.substring(0,31)),this._workbook._worksheets.find(t=>t&&t.name.toLowerCase()===e.toLowerCase()))throw Error("Worksheet name already exists: "+e);this._name=e}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){let e=new s;return this._rows.forEach(t=>{if(t){let r=t.dimensions;r&&e.expand(t.number,r.min,t.number,r.max)}}),e}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce((e,t)=>Math.max(e,(t.header?1:t.headers&&t.headers.length)||0),0);let t=1,r=this._columns=[];e.forEach(e=>{let i=new a(this,t++,!1);r.push(i),i.defn=e})}getColumnKey(e){return this._keys[e]}setColumnKey(e,t){this._keys[e]=t}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){i.each(this._keys,e)}getColumn(e){if("string"==typeof e){let t=this._keys[e];if(t)return t;e=n.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let t=this._columns.length+1;for(;t<=e;)this._columns.push(new a(this,t++))}return this._columns[e-1]}spliceColumns(e,t){let r=this._rows.length;for(var i=arguments.length,n=Array(i>2?i-2:0),s=2;s<i;s++)n[s-2]=arguments[s];if(n.length>0)for(let i=0;i<r;i++){let r=[e,t];n.forEach(e=>{r.push(e[i]||null)});let s=this.getRow(i+1);s.splice.apply(s,r)}else this._rows.forEach(r=>{r&&r.splice(e,t)});let o=n.length-t,a=e+t,l=this._columns.length;if(o<0)for(let t=e+n.length;t<=l;t++)this.getColumn(t).defn=this.getColumn(t-o).defn;else if(o>0)for(let e=l;e>=a;e--)this.getColumn(e+o).defn=this.getColumn(e).defn;for(let t=e;t<e+n.length;t++)this.getColumn(t).defn=null;this.workbook.definedNames.spliceColumns(this.name,e,t,n.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let e=0;return this.eachRow(t=>{e=Math.max(e,t.cellCount)}),e}get actualColumnCount(){let e=[],t=0;return this.eachRow(r=>{r.eachCell(r=>{let{col:i}=r;e[i]||(e[i]=!0,t++)})}),t}_commitRow(){}get _lastRowNumber(){let e=this._rows,t=e.length;for(;t>0&&void 0===e[t-1];)t--;return t}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){return this._rows[e-1]}findRows(e,t){return this._rows.slice(e-1,e-1+t)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let e=0;return this.eachRow(()=>{e++}),e}getRow(e){let t=this._rows[e-1];return t||(t=this._rows[e-1]=new o(this,e)),t}getRows(e,t){if(t<1)return;let r=[];for(let i=e;i<e+t;i++)r.push(this.getRow(i));return r}addRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"n",r=this._nextRow,i=this.getRow(r);return i.values=e,this._setStyleOption(r,"i"===t[0]?t:"n"),i}addRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"n",r=[];return e.forEach(e=>{r.push(this.addRow(e,t))}),r}insertRow(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"n";return this.spliceRows(e,0,t),this._setStyleOption(e,r),this.getRow(e)}insertRows(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"n";if(this.spliceRows(e,0,...t),"n"!==r)for(let i=0;i<t.length;i++)"o"===r[0]&&void 0!==this.findRow(t.length+e+i)?this._copyStyle(t.length+e+i,e+i,"+"===r[1]):"i"===r[0]&&void 0!==this.findRow(e-1)&&this._copyStyle(e-1,e+i,"+"===r[1]);return this.getRows(e,t.length)}_setStyleOption(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"n";"o"===t[0]&&void 0!==this.findRow(e+1)?this._copyStyle(e+1,e,"+"===t[1]):"i"===t[0]&&void 0!==this.findRow(e-1)&&this._copyStyle(e-1,e,"+"===t[1])}_copyStyle(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getRow(e),n=this.getRow(t);n.style=f(i.style),i.eachCell({includeEmpty:r},(e,t)=>{n.getCell(t).style=f(e.style)}),n.height=i.height}duplicateRow(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._rows[e-1],n=Array(t).fill(i.values);this.spliceRows(e+1,r?0:t,...n);for(let r=0;r<t;r++){let t=this._rows[e+r];t.style=i.style,t.height=i.height,i.eachCell({includeEmpty:!0},(e,r)=>{t.getCell(r).style=e.style})}}spliceRows(e,t){let r,i;let n=e+t;for(var s=arguments.length,o=Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];let l=o.length,h=l-t,u=this._rows.length;if(h<0)for(e===u&&(this._rows[u-1]=void 0),r=n;r<=u;r++)if(i=this._rows[r-1]){let e=this.getRow(r+h);e.values=i.values,e.style=i.style,e.height=i.height,i.eachCell({includeEmpty:!0},(t,r)=>{e.getCell(r).style=t.style}),this._rows[r-1]=void 0}else this._rows[r+h-1]=void 0;else if(h>0)for(r=u;r>=n;r--)if(i=this._rows[r-1]){let e=this.getRow(r+h);e.values=i.values,e.style=i.style,e.height=i.height,i.eachCell({includeEmpty:!0},(t,r)=>{if(e.getCell(r).style=t.style,"MergeValue"===t._value.constructor.name){let e=this.getRow(t._row._number+l).getCell(r),i=t._value._master,n=this.getRow(i._row._number+l).getCell(i._column._number);e.merge(n)}})}else this._rows[r+h-1]=void 0;for(r=0;r<l;r++){let t=this.getRow(e+r);t.style={},t.values=o[r]}this.workbook.definedNames.spliceRows(this.name,e,t,l)}eachRow(e,t){if(t||(t=e,e=void 0),e&&e.includeEmpty){let e=this._rows.length;for(let r=1;r<=e;r++)t(this.getRow(r),r)}else this._rows.forEach(e=>{e&&e.hasValues&&t(e,e.number)})}getSheetValues(){let e=[];return this._rows.forEach(t=>{t&&(e[t.number]=t.values)}),e}findCell(e,t){let r=n.getAddress(e,t),i=this._rows[r.row-1];return i?i.findCell(r.col):void 0}getCell(e,t){let r=n.getAddress(e,t);return this.getRow(r.row).getCellEx(r)}mergeCells(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=new s(t);this._mergeCellsInternal(i)}mergeCellsWithoutStyle(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=new s(t);this._mergeCellsInternal(i,!0)}_mergeCellsInternal(e,t){i.each(this._merges,t=>{if(t.intersects(e))throw Error("Cannot merge already merged cells")});let r=this.getCell(e.top,e.left);for(let i=e.top;i<=e.bottom;i++)for(let n=e.left;n<=e.right;n++)(i>e.top||n>e.left)&&this.getCell(i,n).merge(r,t);this._merges[r.address]=e}_unMergeMaster(e){let t=this._merges[e.address];if(t){for(let e=t.top;e<=t.bottom;e++)for(let r=t.left;r<=t.right;r++)this.getCell(e,r).unmerge();delete this._merges[e.address]}}get hasMerges(){return i.some(this._merges,Boolean)}unMergeCells(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=new s(t);for(let e=i.top;e<=i.bottom;e++)for(let t=i.left;t<=i.right;t++){let r=this.findCell(e,t);r&&(r.type===l.ValueType.Merge?this._unMergeMaster(r.master):this._merges[r.address]&&this._unMergeMaster(r))}}fillFormula(e,t,r){let i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"shared",{top:o,left:a,bottom:l,right:h}=n.decode(e),u=h-a+1,c=n.encodeAddress(o,a),d="shared"===s;i="function"==typeof r?r:Array.isArray(r)?Array.isArray(r[0])?(e,t)=>r[e-o][t-a]:(e,t)=>r[(e-o)*u+(t-a)]:()=>{};let f=!0;for(let r=o;r<=l;r++)for(let n=a;n<=h;n++)f?(this.getCell(r,n).value={shareType:s,formula:t,ref:e,result:i(r,n)},f=!1):this.getCell(r,n).value=d?{sharedFormula:c,result:i(r,n)}:i(r,n)}addImage(e,t){this._media.push(new h(this,{type:"image",imageId:e,range:t}))}getImages(){return this._media.filter(e=>"image"===e.type)}addBackgroundImage(e){this._media.push(new h(this,{type:"background",imageId:e}))}getBackgroundImageId(){let e=this._media.find(e=>"background"===e.type);return e&&e.imageId}protect(e,t){return new Promise(r=>{this.sheetProtection={sheet:!0},t&&"spinCount"in t&&(t.spinCount=Number.isFinite(t.spinCount)?Math.round(Math.max(0,t.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=d.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=t&&"spinCount"in t?t.spinCount:1e5,this.sheetProtection.hashValue=d.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),t&&(this.sheetProtection=Object.assign(this.sheetProtection,t),!e&&"spinCount"in t&&delete this.sheetProtection.spinCount),r()})}unprotect(){this.sheetProtection=null}addTable(e){let t=new u(this,e);return this.tables[e.name]=t,t}getTable(e){return this.tables[e]}removeTable(e){delete this.tables[e]}getTables(){return Object.values(this.tables)}addConditionalFormatting(e){this.conditionalFormattings.push(e)}removeConditionalFormatting(e){"number"==typeof e?this.conditionalFormattings.splice(e,1):this.conditionalFormattings=e instanceof Function?this.conditionalFormattings.filter(e):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(e){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=e}get model(){let e={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(e=>e.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(e=>e.model),conditionalFormattings:this.conditionalFormattings};e.cols=a.toModel(this.columns);let t=e.rows=[],r=e.dimensions=new s;return this._rows.forEach(e=>{let i=e&&e.model;i&&(r.expand(i.number,i.min,i.number,i.max),t.push(i))}),e.merges=[],i.each(this._merges,t=>{e.merges.push(t.range)}),e}_parseRows(e){this._rows=[],e.rows.forEach(e=>{let t=new o(this,e.number);this._rows[t.number-1]=t,t.model=e})}_parseMergeCells(e){i.each(e.mergeCells,e=>{this.mergeCellsWithoutStyle(e)})}set model(e){this.name=e.name,this._columns=a.fromModel(this,e.cols),this._parseRows(e),this._parseMergeCells(e),this.dataValidations=new c(e.dataValidations),this.properties=e.properties,this.pageSetup=e.pageSetup,this.headerFooter=e.headerFooter,this.views=e.views,this.autoFilter=e.autoFilter,this._media=e.media.map(e=>new h(this,e)),this.sheetProtection=e.sheetProtection,this.tables=e.tables.reduce((e,t)=>{let r=new u;return r.model=t,e[t.name]=r,e},{}),this.conditionalFormattings=e.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,t,r){"use strict";e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");let i={Workbook:e("./doc/workbook")},n=e("./doc/enums");Object.keys(n).forEach(e=>{i[e]=n[e]}),t.exports=i},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,t,r){"use strict";let i="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");r.bufferToString=function(e){return"string"==typeof e?e:i?i.decode(e):e.toString()}},{}],17:[function(e,t,r){"use strict";let i="undefined"==typeof TextEncoder?null:new TextEncoder("utf-8"),{Buffer:n}=e("buffer");r.stringToBuffer=function(e){return"string"!=typeof e?e:i?n.from(i.encode(e).buffer):n.from(e)}},{buffer:220}],18:[function(e,t,r){"use strict";let i=e("./under-dash"),n=e("./col-cache");t.exports=class{constructor(e){this.template=e,this.sheets={}}addCell(e){this.addCellEx(n.decodeEx(e))}getCell(e){return this.findCellEx(n.decodeEx(e),!0)}findCell(e){return this.findCellEx(n.decodeEx(e),!1)}findCellAt(e,t,r){let i=this.sheets[e],n=i&&i[t];return n&&n[r]}addCellEx(e){if(e.top)for(let t=e.top;t<=e.bottom;t++)for(let r=e.left;r<=e.right;r++)this.getCellAt(e.sheetName,t,r);else this.findCellEx(e,!0)}getCellEx(e){return this.findCellEx(e,!0)}findCellEx(e,t){let r=this.findSheet(e,t),i=this.findSheetRow(r,e,t);return this.findRowCell(i,e,t)}getCellAt(e,t,r){let i=this.sheets[e]||(this.sheets[e]=[]),s=i[t]||(i[t]=[]);return s[r]||(s[r]={sheetName:e,address:n.n2l(r)+t,row:t,col:r})}removeCellEx(e){let t=this.findSheet(e);if(!t)return;let r=this.findSheetRow(t,e);r&&delete r[e.col]}forEachInSheet(e,t){let r=this.sheets[e];r&&r.forEach((e,r)=>{e&&e.forEach((e,i)=>{e&&t(e,r,i)})})}forEach(e){i.each(this.sheets,(t,r)=>{this.forEachInSheet(r,e)})}map(e){let t=[];return this.forEach(r=>{t.push(e(r))}),t}findSheet(e,t){let r=e.sheetName;return this.sheets[r]?this.sheets[r]:t?this.sheets[r]=[]:void 0}findSheetRow(e,t,r){let{row:i}=t;return e&&e[i]?e[i]:r?e[i]=[]:void 0}findRowCell(e,t,r){let{col:i}=t;return e&&e[i]?e[i]:r?e[i]=this.template?Object.assign(t,JSON.parse(JSON.stringify(this.template))):t:void 0}spliceRows(e,t,r,i){let n=this.sheets[e];if(n){let e=[];for(let t=0;t<i;t++)e.push([]);n.splice(t,r,...e)}}spliceColumns(e,t,r,n){let s=this.sheets[e];if(s){let e=[];for(let t=0;t<n;t++)e.push(null);i.each(s,i=>{i.splice(t,r,...e)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,t,r){"use strict";let i=/^[A-Z]+\d+$/,n={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:e=>e<=26?1:e<=676?2:3,_fill(e){let t,r,i,n,s,o=1;if(e>=4)throw Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&e>=1){for(;o<=26;)t=this._dictionary[o-1],this._n2l[o]=t,this._l2n[t]=o,o++;this._l2nFill=1}if(this._l2nFill<2&&e>=2){for(o=27;o<=702;)i=(r=o-27)%26,n=Math.floor(r/26),t=this._dictionary[n]+this._dictionary[i],this._n2l[o]=t,this._l2n[t]=o,o++;this._l2nFill=2}if(this._l2nFill<3&&e>=3){for(o=703;o<=16384;)i=(r=o-703)%26,n=Math.floor(r/26)%26,s=Math.floor(r/676),t=this._dictionary[s]+this._dictionary[n]+this._dictionary[i],this._n2l[o]=t,this._l2n[t]=o,o++;this._l2nFill=3}},l2n(e){if(this._l2n[e]||this._fill(e.length),!this._l2n[e])throw Error("Out of bounds. Invalid column letter: "+e);return this._l2n[e]},n2l(e){if(e<1||e>16384)throw Error(e+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[e]||this._fill(this._level(e)),this._n2l[e]},_hash:{},validateAddress(e){if(!i.test(e))throw Error("Invalid Address: "+e);return!0},decodeAddress(e){let t=e.length<5&&this._hash[e];if(t)return t;let r=!1,i="",n=0,s=!1,o="",a=0;for(let t,l=0;l<e.length;l++)if(t=e.charCodeAt(l),!s&&t>=65&&t<=90)r=!0,i+=e[l],n=26*n+t-64;else if(t>=48&&t<=57)s=!0,o+=e[l],a=10*a+t-48;else if(s&&r&&36!==t)break;if(r){if(n>16384)throw Error("Out of bounds. Invalid column letter: "+i)}else n=void 0;s||(a=void 0);let l={address:e=i+o,col:n,row:a,$col$row:`$${i}$${o}`};return n<=100&&a<=100&&(this._hash[e]=l,this._hash[l.$col$row]=l),l},getAddress(e,t){if(t){let r=this.n2l(t)+e;return this.decodeAddress(r)}return this.decodeAddress(e)},decode(e){let t=e.split(":");if(2===t.length){let e=this.decodeAddress(t[0]),r=this.decodeAddress(t[1]),i={top:Math.min(e.row,r.row),left:Math.min(e.col,r.col),bottom:Math.max(e.row,r.row),right:Math.max(e.col,r.col)};return i.tl=this.n2l(i.left)+i.top,i.br=this.n2l(i.right)+i.bottom,i.dimensions=`${i.tl}:${i.br}`,i}return this.decodeAddress(e)},decodeEx(e){let t=e.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),r=t[1]||t[2],i=t[3],n=i.split(":");if(n.length>1){let e=this.decodeAddress(n[0]),t=this.decodeAddress(n[1]),i=Math.min(e.row,t.row),s=Math.min(e.col,t.col),o=Math.max(e.row,t.row),a=Math.max(e.col,t.col);return e=this.n2l(s)+i,t=this.n2l(a)+o,{top:i,left:s,bottom:o,right:a,sheetName:r,tl:{address:e,col:s,row:i,$col$row:`$${this.n2l(s)}$${i}`,sheetName:r},br:{address:t,col:a,row:o,$col$row:`$${this.n2l(a)}$${o}`,sheetName:r},dimensions:`${e}:${t}`}}if(i.startsWith("#"))return r?{sheetName:r,error:i}:{error:i};let s=this.decodeAddress(i);return r?{sheetName:r,...s}:s},encodeAddress:(e,t)=>n.n2l(t)+e,encode(){switch(arguments.length){case 2:return n.encodeAddress(arguments[0],arguments[1]);case 4:return`${n.encodeAddress(arguments[0],arguments[1])}:${n.encodeAddress(arguments[2],arguments[3])}`;default:throw Error("Can only encode with 2 or 4 arguments")}},inRange(e,t){let[r,i,,n,s]=e,[o,a]=t;return o>=r&&o<=n&&a>=i&&a<=s}};t.exports=n},{}],20:[function(e,t,r){"use strict";let i=(e,t)=>({...e,...t.reduce((t,r)=>(e[r]&&(t[r]={...e[r]}),t),{})}),n=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];e[r]&&(t[r]=i(e[r],n))};r.copyStyle=e=>{if(!e)return e;if(0===Object.keys(e).length)return{};let t={...e};return n(e,t,"font",["color"]),n(e,t,"alignment"),n(e,t,"protection"),e.border&&(n(e,t,"border"),n(e.border,t.border,"top",["color"]),n(e.border,t.border,"left",["color"]),n(e.border,t.border,"bottom",["color"]),n(e.border,t.border,"right",["color"]),n(e.border,t.border,"diagonal",["color"])),e.fill&&(n(e,t,"fill",["fgColor","bgColor","center"]),e.fill.stops&&(t.fill.stops=e.fill.stops.map(e=>i(e,["color"])))),t}},{}],21:[function(e,t,r){(function(r){(function(){"use strict";let i=e("crypto");t.exports={hash(e){let t=i.createHash(e);for(var n=arguments.length,s=Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return t.update(r.concat(s)),t.digest()},convertPasswordToHash(e,t,n,s){if(t=t.toLowerCase(),0>i.getHashes().indexOf(t))throw Error(`Hash algorithm '${t}' not supported!`);let o=r.from(e,"utf16le"),a=this.hash(t,r.from(n,"base64"),o);for(let e=0;e<s;e++){let i=r.alloc(4);i.writeUInt32LE(e,0),a=this.hash(t,a,i)}return a.toString("base64")},randomBytes:e=>i.randomBytes(e)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,t,r){"use strict";let{SaxesParser:i}=e("saxes"),{PassThrough:n}=e("readable-stream"),{bufferToString:s}=e("./browser-buffer-decode");t.exports=async function*(e){let t;e.pipe&&!e[Symbol.asyncIterator]&&(e=e.pipe(new n));let r=new i;r.on("error",e=>{t=e});let o=[];for await(let i of(r.on("opentag",e=>o.push({eventType:"opentag",value:e})),r.on("text",e=>o.push({eventType:"text",value:e})),r.on("closetag",e=>o.push({eventType:"closetag",value:e})),e)){if(r.write(s(i)),t)throw t;yield o,o=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,t,r){"use strict";let i=e("./col-cache"),n=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,s=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;t.exports={slideFormula:function(e,t,r){let o=i.decode(t),a=i.decode(r);return e.replace(n,(e,t,r,n,l)=>{if(l)return e;let h=s.exec(n);if(h){let r=h[1],n=h[2].toUpperCase(),s=h[3],l=h[4];if(n.length>3||3===n.length&&n>"XFD")return e;let u=i.l2n(n),c=parseInt(l,10);return r||(u+=a.col-o.col),s||(c+=a.row-o.row),(t||"")+(r||"")+i.n2l(u)+(s||"")+c}return e})}}},{"./col-cache":19}],24:[function(e,t,r){(function(r,i){(function(){"use strict";let n=e("readable-stream"),s=e("./utils"),o=e("./string-buf");class a{constructor(e,t){this._data=e,this._encoding=t}get length(){return this.toBuffer().length}copy(e,t,r,i){return this.toBuffer().copy(e,t,r,i)}toBuffer(){return this._buffer||(this._buffer=i.from(this._data,this._encoding)),this._buffer}}class l{constructor(e){this._data=e}get length(){return this._data.length}copy(e,t,r,i){return this._data._buf.copy(e,t,r,i)}toBuffer(){return this._data.toBuffer()}}class h{constructor(e){this._data=e}get length(){return this._data.length}copy(e,t,r,i){this._data.copy(e,t,r,i)}toBuffer(){return this._data}}class u{constructor(e){this.size=e,this.buffer=i.alloc(e),this.iRead=0,this.iWrite=0}toBuffer(){if(0===this.iRead&&this.iWrite===this.size)return this.buffer;let e=i.alloc(this.iWrite-this.iRead);return this.buffer.copy(e,0,this.iRead,this.iWrite),e}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(e){let t;return 0===e?null:(void 0===e||e>=this.length?(t=this.toBuffer(),this.iRead=this.iWrite):(t=i.alloc(e),this.buffer.copy(t,0,this.iRead,e),this.iRead+=e),t)}write(e,t,r){let i=Math.min(r,this.size-this.iWrite);return e.copy(this.buffer,this.iWrite,t,t+i),this.iWrite+=i,i}}let c=function(e){e=e||{},this.bufSize=e.bufSize||1048576,this.buffers=[],this.batch=e.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};s.inherits(c,n.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return i.concat(this.buffers.map(e=>e.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){let e=this.buffers[this.buffers.length-1];if(!e.full)return e}let e=new u(this.bufSize);return this.buffers.push(e),e},async _pipe(e){await Promise.all(this.pipes.map(function(t){return new Promise(r=>{t.write(e.toBuffer(),()=>{r()})})}))},_writeToBuffers(e){let t=0,r=e.length;for(;t<r;)t+=this._getWritableBuffer().write(e,t,r-t)},async write(e,t,n){let u;if(t instanceof Function&&(n=t,t="utf8"),n=n||s.nop,e instanceof o)u=new l(e);else if(e instanceof i)u=new h(e);else{if(!("string"==typeof e||e instanceof String||e instanceof ArrayBuffer))throw Error("Chunk must be one of type String, Buffer or StringBuf.");u=new a(e,t)}if(this.pipes.length){if(this.batch)for(this._writeToBuffers(u);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(u),r.nextTick(n)):(await this._pipe(u),n())}else this.paused||this.emit("data",u.toBuffer()),this._writeToBuffers(u),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(e,t,r){let i=e=>{e?r(e):(this._flush(),this.pipes.forEach(e=>{e.end()}),this.emit("finish"))};e?this.write(e,t,i):i()},read(e){let t;if(e){for(t=[];e&&this.buffers.length&&!this.buffers[0].eod;){let r=this.buffers[0],i=r.read(e);e-=i.length,t.push(i),r.eod&&r.full&&this.buffers.shift()}return i.concat(t)}return t=this.buffers.map(e=>e.toBuffer()).filter(Boolean),this.buffers=[],i.concat(t)},setEncoding(e){this.encoding=e},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(e){this.pipes.push(e),!this.paused&&this.buffers.length&&this.end()},unpipe(e){this.pipes=this.pipes.filter(t=>t!==e)},unshift(){throw Error("Not Implemented")},wrap(){throw Error("Not Implemented")}}),t.exports=c}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,t,r){(function(e){(function(){"use strict";t.exports=class{constructor(t){this._buf=e.alloc(t&&t.size||16384),this._encoding=t&&t.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=e.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(e){e=e||0,this._buffer=void 0,this._inPos=e}_grow(t){let r=2*this._buf.length;for(;r<t;)r*=2;let i=e.alloc(r);this._buf.copy(i,0),this._buf=i}addText(e){this._buffer=void 0;let t=this._inPos+this._buf.write(e,this._inPos,this._encoding);for(;t>=this._buf.length-4;)this._grow(this._inPos+e.length),t=this._inPos+this._buf.write(e,this._inPos,this._encoding);this._inPos=t}addStringBuf(e){e.length&&(this._buffer=void 0,this.length+e.length>this.capacity&&this._grow(this.length+e.length),e._buf.copy(this._buf,this._inPos,0,e.length),this._inPos+=e.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,t,r){"use strict";let{toString:i}=Object.prototype,n=/["&<>]/,s={each:function(e,t){e&&(Array.isArray(e)?e.forEach(t):Object.keys(e).forEach(r=>{t(e[r],r)}))},some:function(e,t){return!!e&&(Array.isArray(e)?e.some(t):Object.keys(e).some(r=>t(e[r],r)))},every:function(e,t){return!e||(Array.isArray(e)?e.every(t):Object.keys(e).every(r=>t(e[r],r)))},map:function(e,t){return e?Array.isArray(e)?e.map(t):Object.keys(e).map(r=>t(e[r],r)):[]},keyBy:(e,t)=>e.reduce((e,r)=>(e[r[t]]=r,e),{}),isEqual:function(e,t){let r;let i=typeof e,n=typeof t,o=Array.isArray(e),a=Array.isArray(t);if(i!==n)return!1;if("object"==typeof e){if(o||a)return!(!o||!a)&&e.length===t.length&&e.every((e,r)=>{let i=t[r];return s.isEqual(e,i)});if(null===e||null===t)return e===t;if(r=Object.keys(e),Object.keys(t).length!==r.length)return!1;for(let e of r)if(!t.hasOwnProperty(e))return!1;return s.every(e,(e,r)=>{let i=t[r];return s.isEqual(e,i)})}return e===t},escapeHtml(e){let t=n.exec(e);if(!t)return e;let r="",i="",s=0,o=t.index;for(;o<e.length;o++){switch(e.charAt(o)){case'"':i="&quot;";break;case"&":i="&amp;";break;case"'":i="&apos;";break;case"<":i="&lt;";break;case">":i="&gt;";break;default:continue}s!==o&&(r+=e.substring(s,o)),s=o+1,r+=i}return s!==o?r+e.substring(s,o):r},strcmp:(e,t)=>e<t?-1:e>t?1:0,isUndefined:e=>"[object Undefined]"===i.call(e),isObject:e=>"[object Object]"===i.call(e),deepMerge(){let e,t,r;let i=arguments[0]||{},{length:n}=arguments;function o(n,o){e=i[o],r=Array.isArray(n),s.isObject(n)||r?(r?(r=!1,t=e&&Array.isArray(e)?e:[]):t=e&&s.isObject(e)?e:{},i[o]=s.deepMerge(t,n)):s.isUndefined(n)||(i[o]=n)}for(let e=0;e<n;e++)s.each(arguments[e],o);return i}};t.exports=s},{}],27:[function(e,t,i){(function(r,i){(function(){"use strict";let n=e("fs"),s=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,o={nop(){},promiseImmediate:e=>new Promise(t=>{r.setImmediate?i(()=>{t(e)}):setTimeout(()=>{t(e)},1)}),inherits:function(e,t,r,i){e.super_=t,i||(i=r,r=null),r&&Object.keys(r).forEach(t=>{Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))});let n={constructor:{value:e,enumerable:!1,writable:!1,configurable:!0}};i&&Object.keys(i).forEach(e=>{n[e]=Object.getOwnPropertyDescriptor(i,e)}),e.prototype=Object.create(t.prototype,n)},dateToExcel:(e,t)=>25569+e.getTime()/864e5-(t?1462:0),excelToDate:(e,t)=>new Date(Math.round(24*(e-25569+(t?1462:0))*36e5)),parsePath(e){let t=e.lastIndexOf("/");return{path:e.substring(0,t),name:e.substring(t+1)}},getRelsPath(e){let t=o.parsePath(e);return`${t.path}/_rels/${t.name}.rels`},xmlEncode(e){let t=s.exec(e);if(!t)return e;let r="",i="",n=0,o=t.index;for(;o<e.length;o++){let t=e.charCodeAt(o);switch(t){case 34:i="&quot;";break;case 38:i="&amp;";break;case 39:i="&apos;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;case 127:i="";break;default:if(t<=31&&(t<=8||t>=11&&13!==t)){i="";break}continue}n!==o&&(r+=e.substring(n,o)),n=o+1,i&&(r+=i)}return n!==o?r+e.substring(n,o):r},xmlDecode:e=>e.replace(/&([a-z]*);/g,e=>{switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return e}}),validInt(e){let t=parseInt(e,10);return Number.isNaN(t)?0:t},isDateFmt:e=>!!e&&null!==(e=(e=e.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/),fs:{exists:e=>new Promise(t=>{n.access(e,n.constants.F_OK,e=>{t(!e)})})},toIsoDateString:e=>e.toIsoString().subsstr(0,10),parseBoolean:e=>!0===e||"true"===e||1===e||"1"===e};t.exports=o}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,t,r){"use strict";let i=e("./under-dash"),n=e("./utils");function s(e,t,r){e.push(` ${t}="${n.xmlEncode(r.toString())}"`)}function o(e,t){if(t){let r=[];i.each(t,(e,t)=>{void 0!==e&&s(r,t,e)}),e.push(r.join(""))}}class a{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(e){let t=this._xml;t.push("<?xml"),o(t,e),t.push("?>\n")}openNode(e,t){let r=this.tos,i=this._xml;r&&this.open&&i.push(">"),this._stack.push(e),i.push("<"),i.push(e),o(i,t),this.leaf=!0,this.open=!0}addAttribute(e,t){if(!this.open)throw Error("Cannot write attributes to node if it is not open");void 0!==t&&s(this._xml,e,t)}addAttributes(e){if(!this.open)throw Error("Cannot write attributes to node if it is not open");o(this._xml,e)}writeText(e){let t=this._xml;this.open&&(t.push(">"),this.open=!1),this.leaf=!1,t.push(n.xmlEncode(e.toString()))}writeXml(e){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(e)}closeNode(){let e=this._stack.pop(),t=this._xml;this.leaf?t.push("/>"):(t.push("</"),t.push(e),t.push(">")),this.open=!1,this.leaf=!1}leafNode(e,t,r){this.openNode(e,t),void 0!==r&&this.writeText(r),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){let e=this._rollbacks.pop();this._xml.length>e.xml&&this._xml.splice(e.xml,this._xml.length-e.xml),this._stack.length>e.stack&&this._stack.splice(e.stack,this._stack.length-e.stack),this.leaf=e.leaf,this.open=e.open}get xml(){return this.closeAll(),this._xml.join("")}}a.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},t.exports=a},{"./under-dash":26,"./utils":27}],29:[function(e,t,r){(function(r){(function(){"use strict";let i=e("events"),n=e("jszip"),s=e("./stream-buf"),{stringToBuffer:o}=e("./browser-buffer-encode");class a extends i.EventEmitter{constructor(e){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},e),this.zip=new n,this.stream=new s}append(e,t){t.hasOwnProperty("base64")&&t.base64?this.zip.file(t.name,e,{base64:!0}):(r.browser&&"string"==typeof e&&(e=o(e)),this.zip.file(t.name,e))}async finalize(){let e=await this.zip.generateAsync(this.options);this.stream.end(e),this.emit("finish")}read(e){return this.stream.read(e)}setEncoding(e){return this.stream.setEncoding(e)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(e,t){return this.stream.pipe(e,t)}unpipe(e){return this.stream.unpipe(e)}unshift(e){return this.stream.unshift(e)}wrap(e){return this.stream.wrap(e)}}t.exports={ZipWriter:a}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,t,r){"use strict";t.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,t,r){"use strict";t.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,t,r){"use strict";let i=e("../../utils/parse-sax"),n=e("../../utils/xml-stream");class s{prepare(){}render(){}parseOpen(e){}parseText(e){}parseClose(e){}reconcile(e,t){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(e=>{e instanceof s?e.reset():e.xform&&e.xform.reset()})}mergeModel(e){this.model=Object.assign(this.model||{},e)}async parse(e){for await(let t of e)for(let{eventType:e,value:r}of t)if("opentag"===e)this.parseOpen(r);else if("text"===e)this.parseText(r);else if("closetag"===e&&!this.parseClose(r.name))return this.model;return this.model}async parseStream(e){return this.parse(i(e))}get xml(){return this.toXml(this.model)}toXml(e){let t=new n;return this.render(t,e),t.xml}static toAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e){if(r)return t}else if(r||e!==t)return e.toString()}static toStringAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.toAttribute(e,t,r)}static toStringValue(e,t){return void 0===e?t:e}static toBoolAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e){if(r)return t}else if(r||e!==t)return e?"1":"0"}static toBoolValue(e,t){return void 0===e?t:"1"===e}static toIntAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.toAttribute(e,t,r)}static toIntValue(e,t){return void 0===e?t:parseInt(e,10)}static toFloatAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.toAttribute(e,t,r)}static toFloatValue(e,t){return void 0===e?t:parseFloat(e)}}t.exports=s},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("../../../utils/col-cache");function s(e){try{return n.decodeEx(e),!0}catch(e){return!1}}t.exports=class extends i{render(e,t){e.openNode("definedName",{name:t.name,localSheetId:t.localSheetId}),e.writeText(t.ranges.join(",")),e.closeNode()}parseOpen(e){if("definedName"===e.name)return this._parsedName=e.attributes.name,this._parsedLocalSheetId=e.attributes.localSheetId,this._parsedText=[],!0;return!1}parseText(e){this._parsedText.push(e)}parseClose(){return this.model={name:this._parsedName,ranges:function(e){let t=[],r=!1,i="";return e.split(",").forEach(e=>{if(!e)return;let n=(e.match(/'/g)||[]).length;if(!n)return void(r?i+=e+",":s(e)&&t.push(e));let o=n%2==0;!r&&o&&s(e)?t.push(e):r&&!o?(r=!1,s(i+e)&&t.push(i+e),i=""):(r=!0,i+=e+",")}),t}(this._parsedText.join(""))},void 0!==this._parsedLocalSheetId&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,t,r){"use strict";let i=e("../../../utils/utils"),n=e("../base-xform");t.exports=class extends n{render(e,t){e.leafNode("sheet",{sheetId:t.id,name:t.name,state:t.state,"r:id":t.rId})}parseOpen(e){return"sheet"===e.name&&(this.model={name:i.xmlDecode(e.attributes.name),id:parseInt(e.attributes.sheetId,10),state:e.attributes.state,rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{render(e,t){e.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:t.fullCalcOnLoad?1:void 0})}parseOpen(e){return"calcPr"===e.name&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{render(e,t){e.leafNode("workbookPr",{date1904:t.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(e){return"workbookPr"===e.name&&(this.model={date1904:"1"===e.attributes.date1904},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{render(e,t){let r={xWindow:t.x||0,yWindow:t.y||0,windowWidth:t.width||12e3,windowHeight:t.height||24e3,firstSheet:t.firstSheet,activeTab:t.activeTab};t.visibility&&"visible"!==t.visibility&&(r.visibility=t.visibility),e.leafNode("workbookView",r)}parseOpen(e){if("workbookView"===e.name){let t=this.model={},r=function(e,r,i){let n=void 0!==r?t[e]=parseInt(r,10):i;void 0!==n&&(t[e]=n)};return r("x",e.attributes.xWindow,0),r("y",e.attributes.yWindow,0),r("width",e.attributes.windowWidth,25e3),r("height",e.attributes.windowHeight,1e4),function(e,r,i){let n=void 0!==r?t[e]=r:i;void 0!==n&&(t[e]=n)}("visibility",e.attributes.visibility,"visible"),r("activeTab",e.attributes.activeTab,void 0),r("firstSheet",e.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../../../utils/col-cache"),s=e("../../../utils/xml-stream"),o=e("../base-xform"),a=e("../static-xform"),l=e("../list-xform"),h=e("./defined-name-xform"),u=e("./sheet-xform"),c=e("./workbook-view-xform"),d=e("./workbook-properties-xform"),f=e("./workbook-calc-properties-xform");class p extends o{constructor(){super(),this.map={fileVersion:p.STATIC_XFORMS.fileVersion,workbookPr:new d,bookViews:new l({tag:"bookViews",count:!1,childXform:new c}),sheets:new l({tag:"sheets",count:!1,childXform:new u}),definedNames:new l({tag:"definedNames",count:!1,childXform:new h}),calcPr:new f}}prepare(e){e.sheets=e.worksheets;let t=[],r=0;e.sheets.forEach(e=>{if(e.pageSetup&&e.pageSetup.printArea&&e.pageSetup.printArea.split("&&").forEach(i=>{let n=i.split(":"),s={name:"_xlnm.Print_Area",ranges:[`'${e.name}'!$${n[0]}:$${n[1]}`],localSheetId:r};t.push(s)}),e.pageSetup&&(e.pageSetup.printTitlesRow||e.pageSetup.printTitlesColumn)){let i=[];if(e.pageSetup.printTitlesColumn){let t=e.pageSetup.printTitlesColumn.split(":");i.push(`'${e.name}'!$${t[0]}:$${t[1]}`)}if(e.pageSetup.printTitlesRow){let t=e.pageSetup.printTitlesRow.split(":");i.push(`'${e.name}'!$${t[0]}:$${t[1]}`)}let n={name:"_xlnm.Print_Titles",ranges:i,localSheetId:r};t.push(n)}r++}),t.length&&(e.definedNames=e.definedNames.concat(t)),(e.media||[]).forEach((e,t)=>{e.name=e.type+(t+1)})}render(e,t){e.openXml(s.StdDocAttributes),e.openNode("workbook",p.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(e),this.map.workbookPr.render(e,t.properties),this.map.bookViews.render(e,t.views),this.map.sheets.render(e,t.sheets),this.map.definedNames.render(e,t.definedNames),this.map.calcPr.render(e,t.calcProperties),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("workbook"===e.name)return!0;return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("workbook"===e)return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;return!0}reconcile(e){let t=(e.workbookRels||[]).reduce((e,t)=>(e[t.Id]=t,e),{}),r=[],s,o=0;(e.sheets||[]).forEach(i=>{let n=t[i.rId];n&&(s=e.worksheetHash["xl/"+n.Target.replace(/^(\s|\/xl\/)+/,"")])&&(s.name=i.name,s.id=i.id,s.state=i.state,r[o++]=s)});let a=[];i.each(e.definedNames,e=>{if("_xlnm.Print_Area"===e.name){if(s=r[e.localSheetId]){s.pageSetup||(s.pageSetup={});let t=n.decodeEx(e.ranges[0]);s.pageSetup.printArea=s.pageSetup.printArea?`${s.pageSetup.printArea}&&${t.dimensions}`:t.dimensions}}else if("_xlnm.Print_Titles"===e.name){if(s=r[e.localSheetId]){s.pageSetup||(s.pageSetup={});let t=e.ranges.join(","),r=/\$/g,i=t.match(/\$\d+:\$\d+/);if(i&&i.length){let e=i[0];s.pageSetup.printTitlesRow=e.replace(r,"")}let n=t.match(/\$[A-Z]+:\$[A-Z]+/);if(n&&n.length){let e=n[0];s.pageSetup.printTitlesColumn=e.replace(r,"")}}}else a.push(e)}),e.definedNames=a,e.media.forEach((e,t)=>{e.index=t})}}p.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},p.STATIC_XFORMS={fileVersion:new a({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},t.exports=p},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,t,r){"use strict";let i=e("../strings/rich-text-xform"),n=e("../../../utils/utils"),s=e("../base-xform"),o=t.exports=function(e){this.model=e};n.inherits(o,s,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new i),this._richTextXform},render(e,t){t=t||this.model,e.openNode("comment",{ref:t.ref,authorId:0}),e.openNode("text"),t&&t.note&&t.note.texts&&t.note.texts.forEach(t=>{this.richTextXform.render(e,t)}),e.closeNode(),e.closeNode()},parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"comment":return this.model={type:"note",note:{texts:[]},...e.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(e),!0;default:return!1}},parseText(e){this.parser&&this.parser.parseText(e)},parseClose(e){switch(e){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../../../utils/utils"),s=e("../base-xform"),o=e("./comment-xform"),a=t.exports=function(){this.map={comment:new o}};n.inherits(a,s,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(e,t){t=t||this.model,e.openXml(i.StdDocAttributes),e.openNode("comments",a.COMMENTS_ATTRIBUTES),e.openNode("authors"),e.leafNode("author",null,"Author"),e.closeNode(),e.openNode("commentList"),t.comments.forEach(t=>{this.map.comment.render(e,t)}),e.closeNode(),e.closeNode()},parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(e),!0;default:return!1}},parseText(e){this.parser&&this.parser.parseText(e)},parseClose(e){switch(e){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,t,r){"use strict";let i=e("../../base-xform");t.exports=class extends i{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,t,r){(t===r[2]||"x:SizeWithCells"===this.tag&&t===r[1])&&e.leafNode(this.tag)}parseOpen(e){if(e.name===this.tag)return this.model={},this.model[this.tag]=!0,!0;return!1}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,t,r){"use strict";let i=e("../../base-xform");t.exports=class extends i{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(e){if(e.name===this.tag)return this.text="",!0;return!1}parseText(e){this.text=e}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"x:Anchor"}getAnchorRect(e){let t=Math.floor(e.left),r=Math.floor(68*(e.left-t)),i=Math.floor(e.top),n=Math.floor(18*(e.top-i)),s=Math.floor(e.right),o=Math.floor(68*(e.right-s)),a=Math.floor(e.bottom);return[t,r,i,n,s,o,a,Math.floor(18*(e.bottom-a))]}getDefaultRect(e){let t=e.col,r=Math.max(e.row-2,0);return[t,6,r,14,t+2,2,r+4,16]}render(e,t){let r=t.anchor?this.getAnchorRect(t.anchor):this.getDefaultRect(t.refAddress);e.leafNode("x:Anchor",null,r.join(", "))}parseOpen(e){if(e.name===this.tag)return this.text="",!0;return!1}parseText(e){this.text=e}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./vml-anchor-xform"),s=e("./style/vml-protection-xform"),o=e("./style/vml-position-xform"),a=["twoCells","oneCells","absolute"];t.exports=class extends i{constructor(){super(),this.map={"x:Anchor":new n,"x:Locked":new s({tag:"x:Locked"}),"x:LockText":new s({tag:"x:LockText"}),"x:SizeWithCells":new o({tag:"x:SizeWithCells"}),"x:MoveWithCells":new o({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(e,t){let{protection:r,editAs:i}=t.note;e.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(e,i,a),this.map["x:SizeWithCells"].render(e,i,a),this.map["x:Anchor"].render(e,t),this.map["x:Locked"].render(e,r.locked),e.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(e,r.lockText),e.leafNode("x:Row",null,t.refAddress.row-1),e.leafNode("x:Column",null,t.refAddress.col-1),e.closeNode()}parseOpen(e){if(e.name===this.tag)this.reset(),this.model={anchor:[],protection:{},editAs:""};else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.normalizeModel(),!1;return!0}normalizeModel(){let e=Object.keys(Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model)).length;this.model.editAs=a[e],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../base-xform"),s=e("./vml-shape-xform");class o extends n{constructor(){super(),this.map={"v:shape":new s}}get tag(){return"xml"}render(e,t){e.openXml(i.StdDocAttributes),e.openNode(this.tag,o.DRAWING_ATTRIBUTES),e.openNode("o:shapelayout",{"v:ext":"edit"}),e.leafNode("o:idmap",{"v:ext":"edit",data:1}),e.closeNode(),e.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),e.leafNode("v:stroke",{joinstyle:"miter"}),e.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),e.closeNode(),t.comments.forEach((t,r)=>{this.map["v:shape"].render(e,t,r)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset(),this.model={comments:[]};else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;if(e===this.tag)return!1;return!0}reconcile(e,t){e.anchors.forEach(e=>{e.br?this.map["xdr:twoCellAnchor"].reconcile(e,t):this.map["xdr:oneCellAnchor"].reconcile(e,t)})}}o.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},t.exports=o},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./vml-textbox-xform"),s=e("./vml-client-data-xform");class o extends i{constructor(){super(),this.map={"v:textbox":new n,"x:ClientData":new s}}get tag(){return"v:shape"}render(e,t,r){e.openNode("v:shape",o.V_SHAPE_ATTRIBUTES(t,r)),e.leafNode("v:fill",{color2:"infoBackground [80]"}),e.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),e.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(e,t),this.map["x:ClientData"].render(e,t),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset(),this.model={margins:{insetmode:e.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;return!0}}o.V_SHAPE_ATTRIBUTES=(e,t)=>({id:"_x0000_s"+(1025+t),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":e.note.margins&&e.note.margins.insetmode}),t.exports=o},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"v:textbox"}conversionUnit(e,t,r){return`${parseFloat(e)*t.toFixed(2)}${r}`}reverseConversionUnit(e){return(e||"").split(",").map(e=>Number(parseFloat(this.conversionUnit(parseFloat(e),.1,"")).toFixed(2)))}render(e,t){let r={style:"mso-direction-alt:auto"};if(t&&t.note){let{inset:e}=t.note&&t.note.margins;Array.isArray(e)&&(e=e.map(e=>this.conversionUnit(e,10,"mm")).join(",")),e&&(r.inset=e)}e.openNode("v:textbox",r),e.leafNode("div",{style:"text-align:left"}),e.closeNode()}parseOpen(e){if(e.name===this.tag)return this.model={inset:this.reverseConversionUnit(e.attributes.inset)},!0;return!0}parseText(){}parseClose(e){if(e===this.tag)return!1;return!0}}},{"../base-xform":32}],48:[function(e,t,r){"use strict";let i=e("./base-xform");t.exports=class extends i{createNewModel(e){return{}}parseOpen(e){return this.parser=this.parser||this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag&&(this.model=this.createNewModel(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}onParserClose(e,t){this.model[e]=t.model}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.onParserClose(e,this.parser),this.parser=void 0),!0):e!==this.tag}}},{"./base-xform":32}],49:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{render(e,t){e.openNode("HeadingPairs"),e.openNode("vt:vector",{size:2,baseType:"variant"}),e.openNode("vt:variant"),e.leafNode("vt:lpstr",void 0,"Worksheets"),e.closeNode(),e.openNode("vt:variant"),e.leafNode("vt:i4",void 0,t.length),e.closeNode(),e.closeNode(),e.closeNode()}parseOpen(e){return"HeadingPairs"===e.name}parseText(){}parseClose(e){return"HeadingPairs"!==e}}},{"../base-xform":32}],50:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{render(e,t){e.openNode("TitlesOfParts"),e.openNode("vt:vector",{size:t.length,baseType:"lpstr"}),t.forEach(t=>{e.leafNode("vt:lpstr",void 0,t.name)}),e.closeNode(),e.closeNode()}parseOpen(e){return"TitlesOfParts"===e.name}parseText(){}parseClose(e){return"TitlesOfParts"!==e}}},{"../base-xform":32}],51:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../base-xform"),s=e("../simple/string-xform"),o=e("./app-heading-pairs-xform"),a=e("./app-titles-of-parts-xform");class l extends n{constructor(){super(),this.map={Company:new s({tag:"Company"}),Manager:new s({tag:"Manager"}),HeadingPairs:new o,TitleOfParts:new a}}render(e,t){e.openXml(i.StdDocAttributes),e.openNode("Properties",l.PROPERTY_ATTRIBUTES),e.leafNode("Application",void 0,"Microsoft Excel"),e.leafNode("DocSecurity",void 0,"0"),e.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(e,t.worksheets),this.map.TitleOfParts.render(e,t.worksheets),this.map.Company.render(e,t.company||""),this.map.Manager.render(e,t.manager),e.leafNode("LinksUpToDate",void 0,"false"),e.leafNode("SharedDoc",void 0,"false"),e.leafNode("HyperlinksChanged",void 0,"false"),e.leafNode("AppVersion",void 0,"16.0300"),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("Properties"===e.name)return!0;return this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("Properties"===e)return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;return!0}}l.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3,6}/,"")},l.DateAttrs={"xsi:type":"dcterms:W3CDTF"},l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},t.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../base-xform");class s extends n{render(e,t){e.openXml(i.StdDocAttributes),e.openNode("Types",s.PROPERTY_ATTRIBUTES);let r={};(t.media||[]).forEach(t=>{if("image"===t.type){let i=t.extension;r[i]||(r[i]=!0,e.leafNode("Default",{Extension:i,ContentType:"image/"+i}))}}),e.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),e.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),e.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),t.worksheets.forEach(t=>{let r=`/xl/worksheets/sheet${t.id}.xml`;e.leafNode("Override",{PartName:r,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),e.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),e.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),t.sharedStrings&&t.sharedStrings.count&&e.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),t.tables&&t.tables.forEach(t=>{e.leafNode("Override",{PartName:"/xl/tables/"+t.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),t.drawings&&t.drawings.forEach(t=>{e.leafNode("Override",{PartName:`/xl/drawings/${t.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),t.commentRefs&&(e.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),t.commentRefs.forEach(t=>{let{commentName:r}=t;e.leafNode("Override",{PartName:`/xl/${r}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),e.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),e.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),e.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}s.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},t.exports=s},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../base-xform"),s=e("../simple/date-xform"),o=e("../simple/string-xform"),a=e("../simple/integer-xform");class l extends n{constructor(){super(),this.map={"dc:creator":new o({tag:"dc:creator"}),"dc:title":new o({tag:"dc:title"}),"dc:subject":new o({tag:"dc:subject"}),"dc:description":new o({tag:"dc:description"}),"dc:identifier":new o({tag:"dc:identifier"}),"dc:language":new o({tag:"dc:language"}),"cp:keywords":new o({tag:"cp:keywords"}),"cp:category":new o({tag:"cp:category"}),"cp:lastModifiedBy":new o({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new s({tag:"cp:lastPrinted",format:l.DateFormat}),"cp:revision":new a({tag:"cp:revision"}),"cp:version":new o({tag:"cp:version"}),"cp:contentStatus":new o({tag:"cp:contentStatus"}),"cp:contentType":new o({tag:"cp:contentType"}),"dcterms:created":new s({tag:"dcterms:created",attrs:l.DateAttrs,format:l.DateFormat}),"dcterms:modified":new s({tag:"dcterms:modified",attrs:l.DateAttrs,format:l.DateFormat})}}render(e,t){e.openXml(i.StdDocAttributes),e.openNode("cp:coreProperties",l.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(e,t.creator),this.map["dc:title"].render(e,t.title),this.map["dc:subject"].render(e,t.subject),this.map["dc:description"].render(e,t.description),this.map["dc:identifier"].render(e,t.identifier),this.map["dc:language"].render(e,t.language),this.map["cp:keywords"].render(e,t.keywords),this.map["cp:category"].render(e,t.category),this.map["cp:lastModifiedBy"].render(e,t.lastModifiedBy),this.map["cp:lastPrinted"].render(e,t.lastPrinted),this.map["cp:revision"].render(e,t.revision),this.map["cp:version"].render(e,t.version),this.map["cp:contentStatus"].render(e,t.contentStatus),this.map["cp:contentType"].render(e,t.contentType),this.map["dcterms:created"].render(e,t.created),this.map["dcterms:modified"].render(e,t.modified),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw Error("Unexpected xml node in parseClose: "+e)}}}l.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3}/,"")},l.DateAttrs={"xsi:type":"dcterms:W3CDTF"},l.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},t.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{render(e,t){e.leafNode("Relationship",t)}parseOpen(e){if("Relationship"===e.name)return this.model=e.attributes,!0;return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../base-xform"),s=e("./relationship-xform");class o extends n{constructor(){super(),this.map={Relationship:new s}}render(e,t){t=t||this._values,e.openXml(i.StdDocAttributes),e.openNode("Relationships",o.RELATIONSHIPS_ATTRIBUTES),t.forEach(t=>{this.map.Relationship.render(e,t)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("Relationships"===e.name)return this.model=[],!0;if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.push(this.parser.model),this.parser=void 0),!0;if("Relationships"===e)return!1;throw Error("Unexpected xml node in parseClose: "+e)}}o.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},t.exports=o},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset(),this.model={range:{editAs:e.attributes.editAs||"oneCell"}};else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(e){this.parser&&this.parser.parseText(e)}reconcilePicture(e,t){if(e&&e.rId){let r=t.rels[e.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(r){let e=r[1],i=t.mediaIndex[e];return t.media[i]}}}}},{"../base-xform":32}],57:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./blip-xform");t.exports=class extends i{constructor(){super(),this.map={"a:blip":new n}}get tag(){return"xdr:blipFill"}render(e,t){e.openNode(this.tag),this.map["a:blip"].render(e,t),e.openNode("a:stretch"),e.leafNode("a:fillRect"),e.closeNode(),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset();else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model=this.map["a:blip"].model,!1;return!0}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"a:blip"}render(e,t){e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":t.rId,cstate:"print"})}parseOpen(e){if(e.name===this.tag)return this.model={rId:e.attributes["r:embed"]},!0;return!0}parseText(){}parseClose(e){if(e===this.tag)return!1;return!0}}},{"../base-xform":32}],59:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"xdr:cNvPicPr"}render(e){e.openNode(this.tag),e.leafNode("a:picLocks",{noChangeAspect:"1"}),e.closeNode()}parseOpen(e){e.name,this.tag;return!0}parseText(){}parseClose(e){if(e===this.tag)return!1;return!0}}},{"../base-xform":32}],60:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./hlink-click-xform"),s=e("./ext-lst-xform");t.exports=class extends i{constructor(){super(),this.map={"a:hlinkClick":new n,"a:extLst":new s}}get tag(){return"xdr:cNvPr"}render(e,t){e.openNode(this.tag,{id:t.index,name:"Picture "+t.index}),this.map["a:hlinkClick"].render(e,t),this.map["a:extLst"].render(e,t),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset();else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model=this.map["a:hlinkClick"].model,!1;return!0}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("../simple/integer-xform");t.exports=class extends i{constructor(e){super(),this.tag=e.tag,this.map={"xdr:col":new n({tag:"xdr:col",zero:!0}),"xdr:colOff":new n({tag:"xdr:colOff",zero:!0}),"xdr:row":new n({tag:"xdr:row",zero:!0}),"xdr:rowOff":new n({tag:"xdr:rowOff",zero:!0})}}render(e,t){e.openNode(this.tag),this.map["xdr:col"].render(e,t.nativeCol),this.map["xdr:colOff"].render(e,t.nativeColOff),this.map["xdr:row"].render(e,t.nativeRow),this.map["xdr:rowOff"].render(e,t.nativeRowOff),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset();else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;return!0}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,t,r){"use strict";let i=e("../../../utils/col-cache"),n=e("../../../utils/xml-stream"),s=e("../base-xform"),o=e("./two-cell-anchor-xform"),a=e("./one-cell-anchor-xform");class l extends s{constructor(){super(),this.map={"xdr:twoCellAnchor":new o,"xdr:oneCellAnchor":new a}}prepare(e){e.anchors.forEach((e,t)=>{var r;e.anchorType=("string"==typeof(r=e).range?i.decode(r.range):r.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor",this.map[e.anchorType].prepare(e,{index:t})})}get tag(){return"xdr:wsDr"}render(e,t){e.openXml(n.StdDocAttributes),e.openNode(this.tag,l.DRAWING_ATTRIBUTES),t.anchors.forEach(t=>{this.map[t.anchorType].render(e,t)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset(),this.model={anchors:[]};else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;if(e===this.tag)return!1;return!0}reconcile(e,t){e.anchors.forEach(e=>{e.br?this.map["xdr:twoCellAnchor"].reconcile(e,t):this.map["xdr:oneCellAnchor"].reconcile(e,t)})}}l.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},t.exports=l},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"a:extLst"}render(e){e.openNode(this.tag),e.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),e.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),e.closeNode(),e.closeNode()}parseOpen(e){e.name,this.tag;return!0}parseText(){}parseClose(e){if(e===this.tag)return!1;return!0}}},{"../base-xform":32}],64:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{constructor(e){super(),this.tag=e.tag,this.map={}}render(e,t){e.openNode(this.tag);let r=Math.floor(9525*t.width),i=Math.floor(9525*t.height);e.addAttribute("cx",r),e.addAttribute("cy",i),e.closeNode()}parseOpen(e){return e.name===this.tag&&(this.model={width:parseInt(e.attributes.cx||"0",10)/9525,height:parseInt(e.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"a:hlinkClick"}render(e,t){t.hyperlinks&&t.hyperlinks.rId&&e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":t.hyperlinks.rId,tooltip:t.hyperlinks.tooltip})}parseOpen(e){if(e.name===this.tag)return this.model={hyperlinks:{rId:e.attributes["r:id"],tooltip:e.attributes.tooltip}},!0;return!0}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./c-nv-pr-xform"),s=e("./c-nv-pic-pr-xform");t.exports=class extends i{constructor(){super(),this.map={"xdr:cNvPr":new n,"xdr:cNvPicPr":new s}}get tag(){return"xdr:nvPicPr"}render(e,t){e.openNode(this.tag),this.map["xdr:cNvPr"].render(e,t),this.map["xdr:cNvPicPr"].render(e,t),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset();else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model=this.map["xdr:cNvPr"].model,!1;return!0}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,t,r){"use strict";let i=e("./base-cell-anchor-xform"),n=e("../static-xform"),s=e("./cell-position-xform"),o=e("./ext-xform"),a=e("./pic-xform");t.exports=class extends i{constructor(){super(),this.map={"xdr:from":new s({tag:"xdr:from"}),"xdr:ext":new o({tag:"xdr:ext"}),"xdr:pic":new a,"xdr:clientData":new n({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(e,t){this.map["xdr:pic"].prepare(e.picture,t)}render(e,t){e.openNode(this.tag,{editAs:t.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,t.range.tl),this.map["xdr:ext"].render(e,t.range.ext),this.map["xdr:pic"].render(e,t.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;return!0}reconcile(e,t){e.medium=this.reconcilePicture(e.picture,t)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("../static-xform"),s=e("./blip-fill-xform"),o=e("./nv-pic-pr-xform"),a=e("./sp-pr");t.exports=class extends i{constructor(){super(),this.map={"xdr:nvPicPr":new o,"xdr:blipFill":new s,"xdr:spPr":new n(a)}}get tag(){return"xdr:pic"}prepare(e,t){e.index=t.index+1}render(e,t){e.openNode(this.tag),this.map["xdr:nvPicPr"].render(e,t),this.map["xdr:blipFill"].render(e,t),this.map["xdr:spPr"].render(e,t),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)this.reset();else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;if(e===this.tag)return!1;return!0}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,t,r){"use strict";t.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,t,r){"use strict";let i=e("./base-cell-anchor-xform"),n=e("../static-xform"),s=e("./cell-position-xform"),o=e("./pic-xform");t.exports=class extends i{constructor(){super(),this.map={"xdr:from":new s({tag:"xdr:from"}),"xdr:to":new s({tag:"xdr:to"}),"xdr:pic":new o,"xdr:clientData":new n({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(e,t){this.map["xdr:pic"].prepare(e.picture,t)}render(e,t){e.openNode(this.tag,{editAs:t.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,t.range.tl),this.map["xdr:to"].render(e,t.range.br),this.map["xdr:pic"].render(e,t.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;return!0}reconcile(e,t){e.medium=this.reconcilePicture(e.picture,t)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,t,r){"use strict";let i=e("./base-xform");t.exports=class extends i{constructor(e){super(),this.tag=e.tag,this.always=!!e.always,this.count=e.count,this.empty=e.empty,this.$count=e.$count||"count",this.$=e.$,this.childXform=e.childXform,this.maxItems=e.maxItems}prepare(e,t){let{childXform:r}=this;e&&e.forEach((e,i)=>{t.index=i,r.prepare(e,t)})}render(e,t){if(this.always||t&&t.length){e.openNode(this.tag,this.$),this.count&&e.addAttribute(this.$count,t&&t.length||0);let{childXform:r}=this;(t||[]).forEach((t,i)=>{r.render(e,t,i)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)return this.model=[],!0;return!!this.childXform.parseOpen(e)&&(this.parser=this.childXform,!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(e,t){if(e){let{childXform:r}=this;e.forEach(e=>{r.reconcile(e,t)})}}}},{"./base-xform":32}],72:[function(e,t,r){"use strict";let i=e("../../../utils/col-cache"),n=e("../base-xform");t.exports=class extends n{get tag(){return"autoFilter"}render(e,t){if(t){if("string"==typeof t)e.leafNode("autoFilter",{ref:t});else{let r=function(e){return"string"==typeof e?e:i.getAddress(e.row,e.column).address},n=r(t.from),s=r(t.to);n&&s&&e.leafNode("autoFilter",{ref:`${n}:${s}`})}}}parseOpen(e){"autoFilter"===e.name&&(this.model=e.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,t,r){"use strict";let i=e("../../../utils/utils"),n=e("../base-xform"),s=e("../../../doc/range"),o=e("../../../doc/enums"),a=e("../strings/rich-text-xform");function l(e){if(null==e)return o.ValueType.Null;if(e instanceof String||"string"==typeof e)return o.ValueType.String;if("number"==typeof e)return o.ValueType.Number;if("boolean"==typeof e)return o.ValueType.Boolean;if(e instanceof Date)return o.ValueType.Date;if(e.text&&e.hyperlink)return o.ValueType.Hyperlink;if(e.formula)return o.ValueType.Formula;if(e.error)return o.ValueType.Error;throw Error("I could not understand type of value")}t.exports=class extends n{constructor(){super(),this.richTextXForm=new a}get tag(){return"c"}prepare(e,t){let r=t.styles.addStyleModel(e.style||{},function(e){if(e.type===o.ValueType.Formula)return l(e.result);return e.type}(e));switch(r&&(e.styleId=r),e.comment&&t.comments.push({...e.comment,ref:e.address}),e.type){case o.ValueType.String:case o.ValueType.RichText:t.sharedStrings&&(e.ssId=t.sharedStrings.add(e.value));break;case o.ValueType.Date:t.date1904&&(e.date1904=!0);break;case o.ValueType.Hyperlink:t.sharedStrings&&void 0!==e.text&&null!==e.text&&(e.ssId=t.sharedStrings.add(e.text)),t.hyperlinks.push({address:e.address,target:e.hyperlink,tooltip:e.tooltip});break;case o.ValueType.Merge:t.merges.add(e);break;case o.ValueType.Formula:if(t.date1904&&(e.date1904=!0),"shared"===e.shareType&&(e.si=t.siFormulae++),e.formula)t.formulae[e.address]=e;else if(e.sharedFormula){let r=t.formulae[e.sharedFormula];if(!r)throw Error("Shared Formula master must exist above and or left of clone for cell "+e.address);void 0===r.si?(r.shareType="shared",r.si=t.siFormulae++,r.range=new s(r.address,e.address)):r.range&&r.range.expandToAddress(e.address),e.si=r.si}}}renderFormula(e,t){let r=null;switch(t.shareType){case"shared":r={t:"shared",ref:t.ref||t.range.range,si:t.si};break;case"array":r={t:"array",ref:t.ref};break;default:void 0!==t.si&&(r={t:"shared",si:t.si})}switch(l(t.result)){case o.ValueType.Null:e.leafNode("f",r,t.formula);break;case o.ValueType.String:e.addAttribute("t","str"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result);break;case o.ValueType.Number:e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result);break;case o.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result?1:0);break;case o.ValueType.Error:e.addAttribute("t","e"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result.error);break;case o.ValueType.Date:e.leafNode("f",r,t.formula),e.leafNode("v",null,i.dateToExcel(t.result,t.date1904));break;default:throw Error("I could not understand type of value")}}render(e,t){if(t.type!==o.ValueType.Null||t.styleId){switch(e.openNode("c"),e.addAttribute("r",t.address),t.styleId&&e.addAttribute("s",t.styleId),t.type){case o.ValueType.Null:break;case o.ValueType.Number:e.leafNode("v",null,t.value);break;case o.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("v",null,t.value?"1":"0");break;case o.ValueType.Error:e.addAttribute("t","e"),e.leafNode("v",null,t.value.error);break;case o.ValueType.String:case o.ValueType.RichText:void 0!==t.ssId?(e.addAttribute("t","s"),e.leafNode("v",null,t.ssId)):t.value&&t.value.richText?(e.addAttribute("t","inlineStr"),e.openNode("is"),t.value.richText.forEach(t=>{this.richTextXForm.render(e,t)}),e.closeNode("is")):(e.addAttribute("t","str"),e.leafNode("v",null,t.value));break;case o.ValueType.Date:e.leafNode("v",null,i.dateToExcel(t.value,t.date1904));break;case o.ValueType.Hyperlink:void 0!==t.ssId?(e.addAttribute("t","s"),e.leafNode("v",null,t.ssId)):(e.addAttribute("t","str"),e.leafNode("v",null,t.text));break;case o.ValueType.Formula:this.renderFormula(e,t);case o.ValueType.Merge:}e.closeNode()}}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"c":return this.model={address:e.attributes.r},this.t=e.attributes.t,e.attributes.s&&(this.model.styleId=parseInt(e.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=e.attributes.si,this.model.shareType=e.attributes.t,this.model.ref=e.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){if(this.parser)this.parser.parseText(e);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+e:e;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+e:e:this.model.value=this.model.value?this.model.value+e:e}}parseClose(e){switch(e){case"c":{let{model:e}=this;if(e.formula||e.shareType)e.type=o.ValueType.Formula,e.value&&("str"===this.t?e.result=i.xmlDecode(e.value):"b"===this.t?e.result=0!==parseInt(e.value,10):"e"===this.t?e.result={error:e.value}:e.result=parseFloat(e.value),e.value=void 0);else if(void 0!==e.value)switch(this.t){case"s":e.type=o.ValueType.String,e.value=parseInt(e.value,10);break;case"str":e.type=o.ValueType.String,e.value=i.xmlDecode(e.value);break;case"inlineStr":e.type=o.ValueType.String;break;case"b":e.type=o.ValueType.Boolean,e.value=0!==parseInt(e.value,10);break;case"e":e.type=o.ValueType.Error,e.value={error:e.value};break;default:e.type=o.ValueType.Number,e.value=parseFloat(e.value)}else e.styleId?e.type=o.ValueType.Null:e.type=o.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?this.parser.parseClose(e):this.currentNode=void 0,!0;case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(e),!0)}}reconcile(e,t){let r=e.styleId&&t.styles&&t.styles.getStyleModel(e.styleId);switch(r&&(e.style=r),void 0!==e.styleId&&(e.styleId=void 0),e.type){case o.ValueType.String:"number"==typeof e.value&&t.sharedStrings&&(e.value=t.sharedStrings.getString(e.value)),e.value.richText&&(e.type=o.ValueType.RichText);break;case o.ValueType.Number:r&&i.isDateFmt(r.numFmt)&&(e.type=o.ValueType.Date,e.value=i.excelToDate(e.value,t.date1904));break;case o.ValueType.Formula:void 0!==e.result&&r&&i.isDateFmt(r.numFmt)&&(e.result=i.excelToDate(e.result,t.date1904)),"shared"===e.shareType&&(e.ref?t.formulae[e.si]=e.address:(e.sharedFormula=t.formulae[e.si],delete e.shareType),delete e.si)}let n=t.hyperlinkMap[e.address];n&&(e.type===o.ValueType.Formula?(e.text=e.result,e.result=void 0):(e.text=e.value,e.value=void 0),e.type=o.ValueType.Hyperlink,e.hyperlink=n);let s=t.commentsMap&&t.commentsMap[e.address];s&&(e.comment=s)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,t,r){"use strict";let i=e("../../base-xform");t.exports=class extends i{get tag(){return"x14:cfIcon"}render(e,t){e.leafNode(this.tag,{iconSet:t.iconSet,iconId:t.iconId})}parseOpen(e){let{attributes:t}=e;this.model={iconSet:t.iconSet,iconId:i.toIntValue(t.iconId)}}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],75:[function(e,t,r){"use strict";let{v4:i}=e("uuid"),n=e("../../base-xform"),s=e("../../composite-xform"),o=e("./databar-ext-xform"),a=e("./icon-set-ext-xform"),l={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class h extends s{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new o,"x14:iconSet":this.iconSetXform=new a}}get tag(){return"x14:cfRule"}static isExt(e){return"dataBar"===e.type?o.isExt(e):!("iconSet"!==e.type||!e.custom&&!l[e.iconSet])}prepare(e){h.isExt(e)&&(e.x14Id=`{${i()}}`.toUpperCase())}render(e,t){if(h.isExt(t))switch(t.type){case"dataBar":this.renderDataBar(e,t);break;case"iconSet":this.renderIconSet(e,t)}}renderDataBar(e,t){e.openNode(this.tag,{type:"dataBar",id:t.x14Id}),this.databarXform.render(e,t),e.closeNode()}renderIconSet(e,t){e.openNode(this.tag,{type:"iconSet",priority:t.priority,id:t.x14Id||`{${i()}}`}),this.iconSetXform.render(e,t),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{type:t.type,x14Id:t.id,priority:n.toIntValue(t.priority)}}onParserClose(e,t){Object.assign(this.model,t.model)}}t.exports=h},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,t,r){"use strict";let i=e("../../composite-xform"),n=e("./f-ext-xform");t.exports=class extends i{constructor(){super(),this.map={"xm:f":this.fExtXform=new n}}get tag(){return"x14:cfvo"}render(e,t){e.openNode(this.tag,{type:t.type}),void 0!==t.value&&this.fExtXform.render(e,t.value),e.closeNode()}createNewModel(e){return{type:e.attributes.type}}onParserClose(e,t){if("xm:f"===e)this.model.value=t.model?parseFloat(t.model):0}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,t,r){"use strict";let i=e("../../composite-xform"),n=e("./sqref-ext-xform"),s=e("./cf-rule-ext-xform");t.exports=class extends i{constructor(){super(),this.map={"xm:sqref":this.sqRef=new n,"x14:cfRule":this.cfRule=new s}}get tag(){return"x14:conditionalFormatting"}prepare(e,t){e.rules.forEach(e=>{this.cfRule.prepare(e,t)})}render(e,t){t.rules.some(s.isExt)&&(e.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),t.rules.filter(s.isExt).forEach(t=>this.cfRule.render(e,t)),this.sqRef.render(e,t.ref),e.closeNode())}createNewModel(){return{rules:[]}}onParserClose(e,t){switch(e){case"xm:sqref":this.model.ref=t.model;break;case"x14:cfRule":this.model.rules.push(t.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,t,r){"use strict";let i=e("../../composite-xform"),n=e("./cf-rule-ext-xform"),s=e("./conditional-formatting-ext-xform");t.exports=class extends i{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new s}}get tag(){return"x14:conditionalFormattings"}hasContent(e){return void 0===e.hasExtContent&&(e.hasExtContent=e.some(e=>e.rules.some(n.isExt))),e.hasExtContent}prepare(e,t){e.forEach(e=>{this.cfXform.prepare(e,t)})}render(e,t){this.hasContent(t)&&(e.openNode(this.tag),t.forEach(t=>this.cfXform.render(e,t)),e.closeNode())}createNewModel(){return[]}onParserClose(e,t){this.model.push(t.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,t,r){"use strict";let i=e("../../base-xform"),n=e("../../composite-xform"),s=e("../../style/color-xform"),o=e("./cfvo-ext-xform");t.exports=class extends n{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new o,"x14:borderColor":this.borderColorXform=new s("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new s("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new s("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new s("x14:axisColor")}}static isExt(e){return!e.gradient}get tag(){return"x14:dataBar"}render(e,t){e.openNode(this.tag,{minLength:i.toIntAttribute(t.minLength,0,!0),maxLength:i.toIntAttribute(t.maxLength,100,!0),border:i.toBoolAttribute(t.border,!1),gradient:i.toBoolAttribute(t.gradient,!0),negativeBarColorSameAsPositive:i.toBoolAttribute(t.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolAttribute(t.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toAttribute(t.axisPosition,"auto"),direction:i.toAttribute(t.direction,"leftToRight")}),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),this.borderColorXform.render(e,t.borderColor),this.negativeBorderColorXform.render(e,t.negativeBorderColor),this.negativeFillColorXform.render(e,t.negativeFillColor),this.axisColorXform.render(e,t.axisColor),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{cfvo:[],minLength:i.toIntValue(t.minLength,0),maxLength:i.toIntValue(t.maxLength,100),border:i.toBoolValue(t.border,!1),gradient:i.toBoolValue(t.gradient,!0),negativeBarColorSameAsPositive:i.toBoolValue(t.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolValue(t.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toStringValue(t.axisPosition,"auto"),direction:i.toStringValue(t.direction,"leftToRight")}}onParserClose(e,t){let[,r]=e.split(":");if("cfvo"===r)this.model.cfvo.push(t.model);else this.model[r]=t.model}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,t,r){"use strict";let i=e("../../base-xform");t.exports=class extends i{get tag(){return"xm:f"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],81:[function(e,t,r){"use strict";let i=e("../../base-xform"),n=e("../../composite-xform"),s=e("./cfvo-ext-xform"),o=e("./cf-icon-ext-xform");t.exports=class extends n{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new s,"x14:cfIcon":this.cfIconXform=new o}}get tag(){return"x14:iconSet"}render(e,t){e.openNode(this.tag,{iconSet:i.toStringAttribute(t.iconSet),reverse:i.toBoolAttribute(t.reverse,!1),showValue:i.toBoolAttribute(t.showValue,!0),custom:i.toBoolAttribute(t.icons,!1)}),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),t.icons&&t.icons.forEach((t,r)=>{t.iconId=r,this.cfIconXform.render(e,t)}),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{cfvo:[],iconSet:i.toStringValue(t.iconSet,"3TrafficLights"),reverse:i.toBoolValue(t.reverse,!1),showValue:i.toBoolValue(t.showValue,!0)}}onParserClose(e,t){let[,r]=e.split(":");switch(r){case"cfvo":this.model.cfvo.push(t.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(t.model);break;default:this.model[r]=t.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,t,r){"use strict";let i=e("../../base-xform");t.exports=class extends i{get tag(){return"xm:sqref"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],83:[function(e,t,r){"use strict";let i=e("../../base-xform"),n=e("../../composite-xform"),s=e("../../../../doc/range"),o=e("./databar-xform"),a=e("./ext-lst-ref-xform"),l=e("./formula-xform"),h=e("./color-scale-xform"),u=e("./icon-set-xform"),c={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},d=e=>{let{type:t,operator:r}=e;switch(t){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:t};default:return{type:t,operator:r}}};class f extends n{constructor(){super(),this.map={dataBar:this.databarXform=new o,extLst:this.extLstRefXform=new a,formula:this.formulaXform=new l,colorScale:this.colorScaleXform=new h,iconSet:this.iconSetXform=new u}}get tag(){return"cfRule"}static isPrimitive(e){return"iconSet"!==e.type||!e.custom&&!c[e.iconSet]}render(e,t){switch(t.type){case"expression":this.renderExpression(e,t);break;case"cellIs":this.renderCellIs(e,t);break;case"top10":this.renderTop10(e,t);break;case"aboveAverage":this.renderAboveAverage(e,t);break;case"dataBar":this.renderDataBar(e,t);break;case"colorScale":this.renderColorScale(e,t);break;case"iconSet":this.renderIconSet(e,t);break;case"containsText":this.renderText(e,t);break;case"timePeriod":this.renderTimePeriod(e,t)}}renderExpression(e,t){e.openNode(this.tag,{type:"expression",dxfId:t.dxfId,priority:t.priority}),this.formulaXform.render(e,t.formulae[0]),e.closeNode()}renderCellIs(e,t){e.openNode(this.tag,{type:"cellIs",dxfId:t.dxfId,priority:t.priority,operator:t.operator}),t.formulae.forEach(t=>{this.formulaXform.render(e,t)}),e.closeNode()}renderTop10(e,t){e.leafNode(this.tag,{type:"top10",dxfId:t.dxfId,priority:t.priority,percent:i.toBoolAttribute(t.percent,!1),bottom:i.toBoolAttribute(t.bottom,!1),rank:i.toIntValue(t.rank,10,!0)})}renderAboveAverage(e,t){e.leafNode(this.tag,{type:"aboveAverage",dxfId:t.dxfId,priority:t.priority,aboveAverage:i.toBoolAttribute(t.aboveAverage,!0)})}renderDataBar(e,t){e.openNode(this.tag,{type:"dataBar",priority:t.priority}),this.databarXform.render(e,t),this.extLstRefXform.render(e,t),e.closeNode()}renderColorScale(e,t){e.openNode(this.tag,{type:"colorScale",priority:t.priority}),this.colorScaleXform.render(e,t),e.closeNode()}renderIconSet(e,t){f.isPrimitive(t)&&(e.openNode(this.tag,{type:"iconSet",priority:t.priority}),this.iconSetXform.render(e,t),e.closeNode())}renderText(e,t){e.openNode(this.tag,{type:t.operator,dxfId:t.dxfId,priority:t.priority,operator:i.toStringAttribute(t.operator,"containsText")});let r=(e=>{if(e.formulae&&e.formulae[0])return e.formulae[0];let{tl:t}=new s(e.ref);switch(e.operator){case"containsText":return`NOT(ISERROR(SEARCH("${e.text}",${t})))`;case"containsBlanks":return`LEN(TRIM(${t}))=0`;case"notContainsBlanks":return`LEN(TRIM(${t}))>0`;case"containsErrors":return`ISERROR(${t})`;case"notContainsErrors":return`NOT(ISERROR(${t}))`;default:return}})(t);r&&this.formulaXform.render(e,r),e.closeNode()}renderTimePeriod(e,t){e.openNode(this.tag,{type:"timePeriod",dxfId:t.dxfId,priority:t.priority,timePeriod:t.timePeriod});let r=(e=>{if(e.formulae&&e.formulae[0])return e.formulae[0];let{tl:t}=new s(e.ref);switch(e.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${t},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${t},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${t},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${t},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${t},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${t},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${t},1)=TODAY()-1`;case"today":return`FLOOR(${t},1)=TODAY()`;case"tomorrow":return`FLOOR(${t},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${t},1)<=6,FLOOR(${t},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${t})=MONTH(EDATE(TODAY(),0-1)),YEAR(${t})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${t})=MONTH(TODAY()),YEAR(${t})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${t})=MONTH(EDATE(TODAY(),0+1)),YEAR(${t})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(t);r&&this.formulaXform.render(e,r),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{...d(t),dxfId:i.toIntValue(t.dxfId),priority:i.toIntValue(t.priority),timePeriod:t.timePeriod,percent:i.toBoolValue(t.percent),bottom:i.toBoolValue(t.bottom),rank:i.toIntValue(t.rank),aboveAverage:i.toBoolValue(t.aboveAverage)}}onParserClose(e,t){switch(e){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,t.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(t.model)}}}t.exports=f},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,t,r){"use strict";let i=e("../../base-xform");t.exports=class extends i{get tag(){return"cfvo"}render(e,t){e.leafNode(this.tag,{type:t.type,val:t.value})}parseOpen(e){this.model={type:e.attributes.type,value:i.toFloatValue(e.attributes.val)}}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],85:[function(e,t,r){"use strict";let i=e("../../composite-xform"),n=e("../../style/color-xform"),s=e("./cfvo-xform");t.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new s,color:this.colorXform=new n}}get tag(){return"colorScale"}render(e,t){e.openNode(this.tag),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),t.color.forEach(t=>{this.colorXform.render(e,t)}),e.closeNode()}createNewModel(e){return{cfvo:[],color:[]}}onParserClose(e,t){this.model[e].push(t.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,t,r){"use strict";let i=e("../../composite-xform"),n=e("./cf-rule-xform");t.exports=class extends i{constructor(){super(),this.map={cfRule:new n}}get tag(){return"conditionalFormatting"}render(e,t){t.rules.some(n.isPrimitive)&&(e.openNode(this.tag,{sqref:t.ref}),t.rules.forEach(r=>{n.isPrimitive(r)&&(r.ref=t.ref,this.map.cfRule.render(e,r))}),e.closeNode())}createNewModel(e){let{attributes:t}=e;return{ref:t.sqref,rules:[]}}onParserClose(e,t){this.model.rules.push(t.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,t,r){"use strict";let i=e("../../base-xform"),n=e("./conditional-formatting-xform");t.exports=class extends i{constructor(){super(),this.cfXform=new n}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(e,t){let r=e.reduce((e,t)=>Math.max(e,...t.rules.map(e=>e.priority||0)),1);e.forEach(e=>{e.rules.forEach(e=>{e.priority||(e.priority=r++),e.style&&(e.dxfId=t.styles.addDxfStyle(e.style))})})}render(e,t){t.forEach(t=>{this.cfXform.render(e,t)})}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("conditionalFormatting"===e.name)return this.parser=this.cfXform,this.parser.parseOpen(e),!0;return!1}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(!!this.parser.parseClose(e)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(e,t){e.forEach(e=>{e.rules.forEach(e=>{void 0!==e.dxfId&&(e.style=t.styles.getDxfStyle(e.dxfId),delete e.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,t,r){"use strict";let i=e("../../composite-xform"),n=e("../../style/color-xform"),s=e("./cfvo-xform");t.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new s,color:this.colorXform=new n}}get tag(){return"dataBar"}render(e,t){e.openNode(this.tag),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),this.colorXform.render(e,t.color),e.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(e,t){switch(e){case"cfvo":this.model.cfvo.push(t.model);break;case"color":this.model.color=t.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,t,r){"use strict";let i=e("../../base-xform"),n=e("../../composite-xform");class s extends i{get tag(){return"x14:id"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}class o extends n{constructor(){super(),this.map={"x14:id":this.idXform=new s}}get tag(){return"ext"}render(e,t){e.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(e,t.x14Id),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){this.model.x14Id=t.model}}t.exports=class extends n{constructor(){super(),this.map={ext:new o}}get tag(){return"extLst"}render(e,t){e.openNode(this.tag),this.map.ext.render(e,t),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){Object.assign(this.model,t.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,t,r){"use strict";let i=e("../../base-xform");t.exports=class extends i{get tag(){return"formula"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}},{"../../base-xform":32}],91:[function(e,t,r){"use strict";let i=e("../../base-xform"),n=e("../../composite-xform"),s=e("./cfvo-xform");t.exports=class extends n{constructor(){super(),this.map={cfvo:this.cfvoXform=new s}}get tag(){return"iconSet"}render(e,t){e.openNode(this.tag,{iconSet:i.toStringAttribute(t.iconSet,"3TrafficLights"),reverse:i.toBoolAttribute(t.reverse,!1),showValue:i.toBoolAttribute(t.showValue,!0)}),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),e.closeNode()}createNewModel(e){let{attributes:t}=e;return{iconSet:i.toStringValue(t.iconSet,"3TrafficLights"),reverse:i.toBoolValue(t.reverse),showValue:i.toBoolValue(t.showValue),cfvo:[]}}onParserClose(e,t){this.model[e].push(t.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,t,r){"use strict";let i=e("../../../utils/utils"),n=e("../base-xform");t.exports=class extends n{get tag(){return"col"}prepare(e,t){let r=t.styles.addStyleModel(e.style||{});r&&(e.styleId=r)}render(e,t){e.openNode("col"),e.addAttribute("min",t.min),e.addAttribute("max",t.max),t.width&&e.addAttribute("width",t.width),t.styleId&&e.addAttribute("style",t.styleId),t.hidden&&e.addAttribute("hidden","1"),t.bestFit&&e.addAttribute("bestFit","1"),t.outlineLevel&&e.addAttribute("outlineLevel",t.outlineLevel),t.collapsed&&e.addAttribute("collapsed","1"),e.addAttribute("customWidth","1"),e.closeNode()}parseOpen(e){if("col"===e.name){let t=this.model={min:parseInt(e.attributes.min||"0",10),max:parseInt(e.attributes.max||"0",10),width:void 0===e.attributes.width?void 0:parseFloat(e.attributes.width||"0")};return e.attributes.style&&(t.styleId=parseInt(e.attributes.style,10)),i.parseBoolean(e.attributes.hidden)&&(t.hidden=!0),i.parseBoolean(e.attributes.bestFit)&&(t.bestFit=!0),e.attributes.outlineLevel&&(t.outlineLevel=parseInt(e.attributes.outlineLevel,10)),i.parseBoolean(e.attributes.collapsed)&&(t.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(e,t){e.styleId&&(e.style=t.styles.getStyleModel(e.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../../../utils/utils"),s=e("../../../utils/col-cache"),o=e("../base-xform"),a=e("../../../doc/range");function l(e,t,r,i){let n=t[r];void 0!==n?e[r]=n:void 0!==i&&(e[r]=i)}function h(e,t,r,i){let s=t[r];void 0!==s?e[r]=n.parseBoolean(s):void 0!==i&&(e[r]=i)}t.exports=class extends o{get tag(){return"dataValidations"}render(e,t){let r=function(e){let t=i.map(e,(e,t)=>({address:t,dataValidation:e,marked:!1})).sort((e,t)=>i.strcmp(e.address,t.address)),r=i.keyBy(t,"address"),n=(t,r,n)=>{for(let o=0;o<r;o++){let r=s.encodeAddress(t.row+o,n);if(!e[r]||!i.isEqual(e[t.address],e[r]))return!1}return!0};return t.map(t=>{if(!t.marked){let o=s.decodeEx(t.address);if(o.dimensions)return r[o.dimensions].marked=!0,{...t.dataValidation,sqref:t.address};let a=1,l=s.encodeAddress(o.row+a,o.col);for(;e[l]&&i.isEqual(t.dataValidation,e[l]);)a++,l=s.encodeAddress(o.row+a,o.col);let h=1;for(;n(o,a,o.col+h);)h++;for(let e=0;e<a;e++)for(let t=0;t<h;t++)r[l=s.encodeAddress(o.row+e,o.col+t)].marked=!0;if(a>1||h>1){let e=o.row+(a-1),r=o.col+(h-1);return{...t.dataValidation,sqref:`${t.address}:${s.encodeAddress(e,r)}`}}return{...t.dataValidation,sqref:t.address}}return null}).filter(Boolean)}(t);r.length&&(e.openNode("dataValidations",{count:r.length}),r.forEach(t=>{e.openNode("dataValidation"),"any"!==t.type&&(e.addAttribute("type",t.type),t.operator&&"list"!==t.type&&"between"!==t.operator&&e.addAttribute("operator",t.operator),t.allowBlank&&e.addAttribute("allowBlank","1")),t.showInputMessage&&e.addAttribute("showInputMessage","1"),t.promptTitle&&e.addAttribute("promptTitle",t.promptTitle),t.prompt&&e.addAttribute("prompt",t.prompt),t.showErrorMessage&&e.addAttribute("showErrorMessage","1"),t.errorStyle&&e.addAttribute("errorStyle",t.errorStyle),t.errorTitle&&e.addAttribute("errorTitle",t.errorTitle),t.error&&e.addAttribute("error",t.error),e.addAttribute("sqref",t.sqref),(t.formulae||[]).forEach((r,i)=>{e.openNode("formula"+(i+1)),"date"===t.type?e.writeText(n.dateToExcel(new Date(r))):e.writeText(r),e.closeNode()}),e.closeNode()}),e.closeNode())}parseOpen(e){switch(e.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=e.attributes.sqref;let t={type:e.attributes.type||"any",formulae:[]};switch(e.attributes.type&&h(t,e.attributes,"allowBlank"),h(t,e.attributes,"showInputMessage"),h(t,e.attributes,"showErrorMessage"),t.type){case"any":case"list":case"custom":break;default:l(t,e.attributes,"operator","between")}return l(t,e.attributes,"promptTitle"),l(t,e.attributes,"prompt"),l(t,e.attributes,"errorStyle"),l(t,e.attributes,"errorTitle"),l(t,e.attributes,"error"),this._dataValidation=t,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(e){this._formula&&this._formula.push(e)}parseClose(e){switch(e){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(e=>{e.includes(":")?new a(e).forEachAddress(e=>{this.model[e]=this._dataValidation}):this.model[e]=this._dataValidation}),!0;case"formula1":case"formula2":{let e=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":e=parseInt(e,10);break;case"decimal":e=parseFloat(e);break;case"date":e=n.excelToDate(parseFloat(e))}return this._dataValidation.formulae.push(e),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"dimension"}render(e,t){t&&e.leafNode("dimension",{ref:t})}parseOpen(e){return"dimension"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"drawing"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){if(e.name===this.tag)return this.model={rId:e.attributes["r:id"]},!0;return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,t,r){"use strict";let i=e("../composite-xform"),n=e("./cf-ext/conditional-formattings-ext-xform");class s extends i{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new n}}get tag(){return"ext"}hasContent(e){return this.conditionalFormattings.hasContent(e.conditionalFormattings)}prepare(e,t){this.conditionalFormattings.prepare(e.conditionalFormattings,t)}render(e,t){e.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(e,t.conditionalFormattings),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){this.model[e]=t.model}}t.exports=class extends i{constructor(){super(),this.map={ext:this.ext=new s}}get tag(){return"extLst"}prepare(e,t){this.ext.prepare(e,t)}hasContent(e){return this.ext.hasContent(e)}render(e,t){this.hasContent(t)&&(e.openNode("extLst"),this.ext.render(e,t),e.closeNode())}createNewModel(){return{}}onParserClose(e,t){Object.assign(this.model,t.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"headerFooter"}render(e,t){if(t){e.addRollback();let r=!1;e.openNode("headerFooter"),t.differentFirst&&(e.addAttribute("differentFirst","1"),r=!0),t.differentOddEven&&(e.addAttribute("differentOddEven","1"),r=!0),t.oddHeader&&"string"==typeof t.oddHeader&&(e.leafNode("oddHeader",null,t.oddHeader),r=!0),t.oddFooter&&"string"==typeof t.oddFooter&&(e.leafNode("oddFooter",null,t.oddFooter),r=!0),t.evenHeader&&"string"==typeof t.evenHeader&&(e.leafNode("evenHeader",null,t.evenHeader),r=!0),t.evenFooter&&"string"==typeof t.evenFooter&&(e.leafNode("evenFooter",null,t.evenFooter),r=!0),t.firstHeader&&"string"==typeof t.firstHeader&&(e.leafNode("firstHeader",null,t.firstHeader),r=!0),t.firstFooter&&"string"==typeof t.firstFooter&&(e.leafNode("firstFooter",null,t.firstFooter),r=!0),r?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){switch(e.name){case"headerFooter":return this.model={},e.attributes.differentFirst&&(this.model.differentFirst=1===parseInt(e.attributes.differentFirst,0)),e.attributes.differentOddEven&&(this.model.differentOddEven=1===parseInt(e.attributes.differentOddEven,0)),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(e){switch(this.currentNode){case"oddHeader":this.model.oddHeader=e;break;case"oddFooter":this.model.oddFooter=e;break;case"evenHeader":this.model.evenHeader=e;break;case"evenFooter":this.model.evenFooter=e;break;case"firstHeader":this.model.firstHeader=e;break;case"firstFooter":this.model.firstFooter=e}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"hyperlink"}render(e,t){this.isInternalLink(t)?e.leafNode("hyperlink",{ref:t.address,"r:id":t.rId,tooltip:t.tooltip,location:t.target}):e.leafNode("hyperlink",{ref:t.address,"r:id":t.rId,tooltip:t.tooltip})}parseOpen(e){return"hyperlink"===e.name&&(this.model={address:e.attributes.ref,rId:e.attributes["r:id"],tooltip:e.attributes.tooltip},e.attributes.location&&(this.model.target=e.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(e){return e.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(e.target)}}},{"../base-xform":32}],99:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"mergeCell"}render(e,t){e.leafNode("mergeCell",{ref:t})}parseOpen(e){return"mergeCell"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../../../doc/range"),s=e("../../../utils/col-cache"),o=e("../../../doc/enums");t.exports=class{constructor(){this.merges={}}add(e){if(this.merges[e.master])this.merges[e.master].expandToAddress(e.address);else{let t=`${e.master}:${e.address}`;this.merges[e.master]=new n(t)}}get mergeCells(){return i.map(this.merges,e=>e.range)}reconcile(e,t){i.each(e,e=>{let r=s.decode(e);for(let e=r.top;e<=r.bottom;e++){let i=t[e-1];for(let t=r.left;t<=r.right;t++){let n=i.cells[t-1];n?n.type===o.ValueType.Merge&&(n.master=r.tl):i.cells[t]={type:o.ValueType.Null,address:s.encodeAddress(e,t)}}}})}getMasterAddress(e){let t=this.hash[e];return t&&t.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e=>void 0!==e;t.exports=class extends i{get tag(){return"outlinePr"}render(e,t){return!(!t||!n(t.summaryBelow)&&!n(t.summaryRight))&&(e.leafNode(this.tag,{summaryBelow:n(t.summaryBelow)?Number(t.summaryBelow):void 0,summaryRight:n(t.summaryRight)?Number(t.summaryRight):void 0}),!0)}parseOpen(e){return e.name===this.tag&&(this.model={summaryBelow:n(e.attributes.summaryBelow)?!!Number(e.attributes.summaryBelow):void 0,summaryRight:n(e.attributes.summaryRight)?!!Number(e.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"brk"}render(e,t){e.leafNode("brk",t)}parseOpen(e){return"brk"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../base-xform");t.exports=class extends n{get tag(){return"pageMargins"}render(e,t){if(t){let r={left:t.left,right:t.right,top:t.top,bottom:t.bottom,header:t.header,footer:t.footer};i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){if(e.name===this.tag)return this.model={left:parseFloat(e.attributes.left||.7),right:parseFloat(e.attributes.right||.7),top:parseFloat(e.attributes.top||.75),bottom:parseFloat(e.attributes.bottom||.75),header:parseFloat(e.attributes.header||.3),footer:parseFloat(e.attributes.footer||.3)},!0;return!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"pageSetUpPr"}render(e,t){return!(!t||!t.fitToPage)&&(e.leafNode(this.tag,{fitToPage:t.fitToPage?"1":void 0}),!0)}parseOpen(e){return e.name===this.tag&&(this.model={fitToPage:"1"===e.attributes.fitToPage},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../base-xform");function s(e){return e?"1":void 0}t.exports=class extends n{get tag(){return"pageSetup"}render(e,t){if(t){let r={paperSize:t.paperSize,orientation:t.orientation,horizontalDpi:t.horizontalDpi,verticalDpi:t.verticalDpi,pageOrder:function(e){if("overThenDown"===e)return e}(t.pageOrder),blackAndWhite:s(t.blackAndWhite),draft:s(t.draft),cellComments:function(e){switch(e){case"atEnd":case"asDisplyed":return e;default:return}}(t.cellComments),errors:function(e){switch(e){case"dash":case"blank":case"NA":return e;default:return}}(t.errors),scale:t.scale,fitToWidth:t.fitToWidth,fitToHeight:t.fitToHeight,firstPageNumber:t.firstPageNumber,useFirstPageNumber:s(t.firstPageNumber),usePrinterDefaults:s(t.usePrinterDefaults),copies:t.copies};i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){var t;if(e.name===this.tag)return this.model={paperSize:void 0!==(t=e.attributes.paperSize)?parseInt(t,10):void 0,orientation:e.attributes.orientation||"portrait",horizontalDpi:parseInt(e.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(e.attributes.verticalDpi||"4294967295",10),pageOrder:e.attributes.pageOrder||"downThenOver",blackAndWhite:"1"===e.attributes.blackAndWhite,draft:"1"===e.attributes.draft,cellComments:e.attributes.cellComments||"None",errors:e.attributes.errors||"displayed",scale:parseInt(e.attributes.scale||"100",10),fitToWidth:parseInt(e.attributes.fitToWidth||"1",10),fitToHeight:parseInt(e.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(e.attributes.firstPageNumber||"1",10),useFirstPageNumber:"1"===e.attributes.useFirstPageNumber,usePrinterDefaults:"1"===e.attributes.usePrinterDefaults,copies:parseInt(e.attributes.copies||"1",10)},!0;return!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"picture"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){if(e.name===this.tag)return this.model={rId:e.attributes["r:id"]},!0;return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../base-xform");function s(e){return e?"1":void 0}t.exports=class extends n{get tag(){return"printOptions"}render(e,t){if(t){let r={headings:s(t.showRowColHeaders),gridLines:s(t.showGridLines),horizontalCentered:s(t.horizontalCentered),verticalCentered:s(t.verticalCentered)};i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){if(e.name===this.tag)return this.model={showRowColHeaders:"1"===e.attributes.headings,showGridLines:"1"===e.attributes.gridLines,horizontalCentered:"1"===e.attributes.horizontalCentered,verticalCentered:"1"===e.attributes.verticalCentered},!0;return!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,t,r){"use strict";let i=e("./page-breaks-xform"),n=e("../list-xform");t.exports=class extends n{constructor(){super({tag:"rowBreaks",count:!0,childXform:new i})}render(e,t){if(t&&t.length){e.openNode(this.tag,this.$),this.count&&(e.addAttribute(this.$count,t.length),e.addAttribute("manualBreakCount",t.length));let{childXform:r}=this;t.forEach(t=>{r.render(e,t)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("../../../utils/utils"),s=e("./cell-xform");t.exports=class extends i{constructor(e){super(),this.maxItems=e&&e.maxItems,this.map={c:new s}}get tag(){return"row"}prepare(e,t){let r=t.styles.addStyleModel(e.style);r&&(e.styleId=r);let i=this.map.c;e.cells.forEach(e=>{i.prepare(e,t)})}render(e,t,r){e.openNode("row"),e.addAttribute("r",t.number),t.height&&(e.addAttribute("ht",t.height),e.addAttribute("customHeight","1")),t.hidden&&e.addAttribute("hidden","1"),t.min>0&&t.max>0&&t.min<=t.max&&e.addAttribute("spans",`${t.min}:${t.max}`),t.styleId&&(e.addAttribute("s",t.styleId),e.addAttribute("customFormat","1")),e.addAttribute("x14ac:dyDescent","0.25"),t.outlineLevel&&e.addAttribute("outlineLevel",t.outlineLevel),t.collapsed&&e.addAttribute("collapsed","1");let i=this.map.c;t.cells.forEach(t=>{i.render(e,t,r)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("row"===e.name){this.numRowsSeen+=1;let t=e.attributes.spans?e.attributes.spans.split(":").map(e=>parseInt(e,10)):[void 0,void 0],r=this.model={number:parseInt(e.attributes.r,10),min:t[0],max:t[1],cells:[]};return e.attributes.s&&(r.styleId=parseInt(e.attributes.s,10)),n.parseBoolean(e.attributes.hidden)&&(r.hidden=!0),n.parseBoolean(e.attributes.bestFit)&&(r.bestFit=!0),e.attributes.ht&&(r.height=parseFloat(e.attributes.ht)),e.attributes.outlineLevel&&(r.outlineLevel=parseInt(e.attributes.outlineLevel,10)),n.parseBoolean(e.attributes.collapsed)&&(r.collapsed=!0),!0}return this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(e,t){e.style=e.styleId?t.styles.getStyleModel(e.styleId):{},void 0!==e.styleId&&(e.styleId=void 0);let r=this.map.c;e.cells.forEach(e=>{r.reconcile(e,t)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../base-xform");t.exports=class extends n{get tag(){return"sheetFormatPr"}render(e,t){if(t){let r={defaultRowHeight:t.defaultRowHeight,outlineLevelRow:t.outlineLevelRow,outlineLevelCol:t.outlineLevelCol,"x14ac:dyDescent":t.dyDescent};t.defaultColWidth&&(r.defaultColWidth=t.defaultColWidth),t.defaultRowHeight&&15===t.defaultRowHeight||(r.customHeight="1"),i.some(r,e=>void 0!==e)&&e.leafNode("sheetFormatPr",r)}}parseOpen(e){return"sheetFormatPr"===e.name&&(this.model={defaultRowHeight:parseFloat(e.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(e.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(e.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(e.attributes.outlineLevelCol||"0",10)},e.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(e.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("../style/color-xform"),s=e("./page-setup-properties-xform"),o=e("./outline-properties-xform");t.exports=class extends i{constructor(){super(),this.map={tabColor:new n("tabColor"),pageSetUpPr:new s,outlinePr:new o}}get tag(){return"sheetPr"}render(e,t){if(t){e.addRollback(),e.openNode("sheetPr");let r=!1;r=this.map.tabColor.render(e,t.tabColor)||r,r=this.map.pageSetUpPr.render(e,t.pageSetup)||r,(r=this.map.outlinePr.render(e,t.outlineProperties)||r)?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.reset(),!0):!!this.map[e.name]&&(this.parser=this.map[e.name],this.parser.parseOpen(e),!0)}parseText(e){return!!this.parser&&(this.parser.parseText(e),!0)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../base-xform");function s(e,t){return e?t:void 0}function o(e,t){return e===t||void 0}t.exports=class extends n{get tag(){return"sheetProtection"}render(e,t){if(t){let r={sheet:s(t.sheet,"1"),selectLockedCells:!1===t.selectLockedCells?"1":void 0,selectUnlockedCells:!1===t.selectUnlockedCells?"1":void 0,formatCells:s(t.formatCells,"0"),formatColumns:s(t.formatColumns,"0"),formatRows:s(t.formatRows,"0"),insertColumns:s(t.insertColumns,"0"),insertRows:s(t.insertRows,"0"),insertHyperlinks:s(t.insertHyperlinks,"0"),deleteColumns:s(t.deleteColumns,"0"),deleteRows:s(t.deleteRows,"0"),sort:s(t.sort,"0"),autoFilter:s(t.autoFilter,"0"),pivotTables:s(t.pivotTables,"0")};t.sheet&&(r.algorithmName=t.algorithmName,r.hashValue=t.hashValue,r.saltValue=t.saltValue,r.spinCount=t.spinCount,r.objects=s(!1===t.objects,"1"),r.scenarios=s(!1===t.scenarios,"1")),i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){if(e.name===this.tag)return this.model={sheet:o(e.attributes.sheet,"1"),objects:"1"!==e.attributes.objects&&void 0,scenarios:"1"!==e.attributes.scenarios&&void 0,selectLockedCells:"1"!==e.attributes.selectLockedCells&&void 0,selectUnlockedCells:"1"!==e.attributes.selectUnlockedCells&&void 0,formatCells:o(e.attributes.formatCells,"0"),formatColumns:o(e.attributes.formatColumns,"0"),formatRows:o(e.attributes.formatRows,"0"),insertColumns:o(e.attributes.insertColumns,"0"),insertRows:o(e.attributes.insertRows,"0"),insertHyperlinks:o(e.attributes.insertHyperlinks,"0"),deleteColumns:o(e.attributes.deleteColumns,"0"),deleteRows:o(e.attributes.deleteRows,"0"),sort:o(e.attributes.sort,"0"),autoFilter:o(e.attributes.autoFilter,"0"),pivotTables:o(e.attributes.pivotTables,"0")},e.attributes.algorithmName&&(this.model.algorithmName=e.attributes.algorithmName,this.model.hashValue=e.attributes.hashValue,this.model.saltValue=e.attributes.saltValue,this.model.spinCount=parseInt(e.attributes.spinCount,10)),!0;return!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,t,r){"use strict";let i=e("../../../utils/col-cache"),n=e("../base-xform"),s={frozen:"frozen",frozenSplit:"frozen",split:"split"};t.exports=class extends n{get tag(){return"sheetView"}prepare(e){switch(e.state){case"frozen":case"split":break;default:e.state="normal"}}render(e,t){let r,n,s,o;e.openNode("sheetView",{workbookViewId:t.workbookViewId||0});let a=function(t,r,i){i&&e.addAttribute(t,r)};switch(a("rightToLeft","1",!0===t.rightToLeft),a("tabSelected","1",t.tabSelected),a("showRuler","0",!1===t.showRuler),a("showRowColHeaders","0",!1===t.showRowColHeaders),a("showGridLines","0",!1===t.showGridLines),a("zoomScale",t.zoomScale,t.zoomScale),a("zoomScaleNormal",t.zoomScaleNormal,t.zoomScaleNormal),a("view",t.style,t.style),t.state){case"frozen":n=t.xSplit||0,s=t.ySplit||0,r=t.topLeftCell||i.getAddress(s+1,n+1).address,o=(t.xSplit&&t.ySplit?"bottomRight":t.xSplit&&"topRight")||"bottomLeft",e.leafNode("pane",{xSplit:t.xSplit||void 0,ySplit:t.ySplit||void 0,topLeftCell:r,activePane:o,state:"frozen"}),e.leafNode("selection",{pane:o,activeCell:t.activeCell,sqref:t.activeCell});break;case"split":"topLeft"===t.activePane&&(t.activePane=void 0),e.leafNode("pane",{xSplit:t.xSplit||void 0,ySplit:t.ySplit||void 0,topLeftCell:t.topLeftCell,activePane:t.activePane}),e.leafNode("selection",{pane:t.activePane,activeCell:t.activeCell,sqref:t.activeCell});break;case"normal":t.activeCell&&e.leafNode("selection",{activeCell:t.activeCell,sqref:t.activeCell})}e.closeNode()}parseOpen(e){switch(e.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(e.attributes.workbookViewId,10),rightToLeft:"1"===e.attributes.rightToLeft,tabSelected:"1"===e.attributes.tabSelected,showRuler:"0"!==e.attributes.showRuler,showRowColHeaders:"0"!==e.attributes.showRowColHeaders,showGridLines:"0"!==e.attributes.showGridLines,zoomScale:parseInt(e.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(e.attributes.zoomScaleNormal||"100",10),style:e.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(e.attributes.xSplit||"0",10),ySplit:parseInt(e.attributes.ySplit||"0",10),topLeftCell:e.attributes.topLeftCell,activePane:e.attributes.activePane||"topLeft",state:e.attributes.state},!0;case"selection":{let t=e.attributes.pane||"topLeft";return this.selections[t]={pane:t,activeCell:e.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(e){let t,r;if("sheetView"===e)return this.sheetView&&this.pane?(t=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:s[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},"split"===this.model.state&&(t.activePane=this.pane.activePane),(r=this.selections[this.pane.activePane])&&r.activeCell&&(t.activeCell=r.activeCell)):(t=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},(r=this.selections.topLeft)&&r.activeCell&&(t.activeCell=r.activeCell)),this.sheetView.style&&(t.style=this.sheetView.style),!1;return!0}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"tablePart"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){if(e.name===this.tag)return this.model={rId:e.attributes["r:id"]},!0;return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../../../utils/col-cache"),s=e("../../../utils/xml-stream"),o=e("../../rel-type"),a=e("./merges"),l=e("../base-xform"),h=e("../list-xform"),u=e("./row-xform"),c=e("./col-xform"),d=e("./dimension-xform"),f=e("./hyperlink-xform"),p=e("./merge-cell-xform"),g=e("./data-validations-xform"),m=e("./sheet-properties-xform"),v=e("./sheet-format-properties-xform"),b=e("./sheet-view-xform"),y=e("./sheet-protection-xform"),x=e("./page-margins-xform"),_=e("./page-setup-xform"),S=e("./print-options-xform"),w=e("./auto-filter-xform"),T=e("./picture-xform"),P=e("./drawing-xform"),E=e("./table-part-xform"),C=e("./row-breaks-xform"),A=e("./header-footer-xform"),I=e("./cf/conditional-formattings-xform"),M=e("./ext-lst-xform"),R=(e,t)=>{if(!t||!t.length)return e;if(!e||!e.length)return t;let r={},i={};return e.forEach(e=>{r[e.ref]=e,e.rules.forEach(e=>{let{x14Id:t}=e;t&&(i[t]=e)})}),t.forEach(t=>{t.rules.forEach(n=>{let s=i[n.x14Id];s?((e,t)=>{Object.keys(t).forEach(r=>{let i=e[r],n=t[r];void 0===i&&void 0!==n&&(e[r]=n)})})(s,n):r[t.ref]?r[t.ref].rules.push(n):e.push({ref:t.ref,rules:[n]})})}),e};class O extends l{constructor(e){super();let{maxRows:t,maxCols:r,ignoreNodes:i}=e||{};this.ignoreNodes=i||[],this.map={sheetPr:new m,dimension:new d,sheetViews:new h({tag:"sheetViews",count:!1,childXform:new b}),sheetFormatPr:new v,cols:new h({tag:"cols",count:!1,childXform:new c}),sheetData:new h({tag:"sheetData",count:!1,empty:!0,childXform:new u({maxItems:r}),maxItems:t}),autoFilter:new w,mergeCells:new h({tag:"mergeCells",count:!0,childXform:new p}),rowBreaks:new C,hyperlinks:new h({tag:"hyperlinks",count:!1,childXform:new f}),pageMargins:new x,dataValidations:new g,pageSetup:new _,headerFooter:new A,printOptions:new S,picture:new T,drawing:new P,sheetProtection:new y,tableParts:new h({tag:"tableParts",count:!0,childXform:new E}),conditionalFormatting:new I,extLst:new M}}prepare(e,t){let r;t.merges=new a,e.hyperlinks=t.hyperlinks=[],e.comments=t.comments=[],t.formulae={},t.siFormulae=0,this.map.cols.prepare(e.cols,t),this.map.sheetData.prepare(e.rows,t),this.map.conditionalFormatting.prepare(e.conditionalFormattings,t),e.mergeCells=t.merges.mergeCells;let i=e.rels=[];function s(e){return"rId"+(e.length+1)}if(e.hyperlinks.forEach(e=>{let t=s(i);e.rId=t,i.push({Id:t,Type:o.Hyperlink,Target:e.target,TargetMode:"External"})}),e.comments.length>0){let r={Id:s(i),Type:o.Comments,Target:`../comments${e.id}.xml`};i.push(r);let a={Id:s(i),Type:o.VmlDrawing,Target:`../drawings/vmlDrawing${e.id}.vml`};i.push(a),e.comments.forEach(e=>{e.refAddress=n.decodeAddress(e.ref)}),t.commentRefs.push({commentName:"comments"+e.id,vmlDrawing:"vmlDrawing"+e.id})}let l=[];e.media.forEach(n=>{if("background"===n.type){let a=s(i);r=t.media[n.imageId],i.push({Id:a,Type:o.Image,Target:`../media/${r.name}.${r.extension}`}),e.background={rId:a},e.image=t.media[n.imageId]}else if("image"===n.type){let{drawing:a}=e;r=t.media[n.imageId],a||(a=e.drawing={rId:s(i),name:"drawing"+ ++t.drawingsCount,anchors:[],rels:[]},t.drawings.push(a),i.push({Id:a.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${a.name}.xml`}));let h=this.preImageId===n.imageId?l[n.imageId]:l[a.rels.length];h||(h=s(a.rels),l[a.rels.length]=h,a.rels.push({Id:h,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${r.name}.${r.extension}`}));let u={picture:{rId:h},range:n.range};if(n.hyperlinks&&n.hyperlinks.hyperlink){let e=s(a.rels);l[a.rels.length]=e,u.picture.hyperlinks={tooltip:n.hyperlinks.tooltip,rId:e},a.rels.push({Id:e,Type:o.Hyperlink,Target:n.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=n.imageId,a.anchors.push(u)}}),e.tables.forEach(e=>{let r=s(i);e.rId=r,i.push({Id:r,Type:o.Table,Target:"../tables/"+e.target}),e.columns.forEach(e=>{let{style:r}=e;r&&(e.dxfId=t.styles.addDxfStyle(r))})}),this.map.extLst.prepare(e,t)}render(e,t){e.openXml(s.StdDocAttributes),e.openNode("worksheet",O.WORKSHEET_ATTRIBUTES);let r=t.properties?{defaultRowHeight:t.properties.defaultRowHeight,dyDescent:t.properties.dyDescent,outlineLevelCol:t.properties.outlineLevelCol,outlineLevelRow:t.properties.outlineLevelRow}:void 0;t.properties&&t.properties.defaultColWidth&&(r.defaultColWidth=t.properties.defaultColWidth);let i={outlineProperties:t.properties&&t.properties.outlineProperties,tabColor:t.properties&&t.properties.tabColor,pageSetup:t.pageSetup&&t.pageSetup.fitToPage?{fitToPage:t.pageSetup.fitToPage}:void 0},n=t.pageSetup&&t.pageSetup.margins,a={showRowColHeaders:t.pageSetup&&t.pageSetup.showRowColHeaders,showGridLines:t.pageSetup&&t.pageSetup.showGridLines,horizontalCentered:t.pageSetup&&t.pageSetup.horizontalCentered,verticalCentered:t.pageSetup&&t.pageSetup.verticalCentered},l=t.sheetProtection;this.map.sheetPr.render(e,i),this.map.dimension.render(e,t.dimensions),this.map.sheetViews.render(e,t.views),this.map.sheetFormatPr.render(e,r),this.map.cols.render(e,t.cols),this.map.sheetData.render(e,t.rows),this.map.sheetProtection.render(e,l),this.map.autoFilter.render(e,t.autoFilter),this.map.mergeCells.render(e,t.mergeCells),this.map.conditionalFormatting.render(e,t.conditionalFormattings),this.map.dataValidations.render(e,t.dataValidations),this.map.hyperlinks.render(e,t.hyperlinks),this.map.printOptions.render(e,a),this.map.pageMargins.render(e,n),this.map.pageSetup.render(e,t.pageSetup),this.map.headerFooter.render(e,t.headerFooter),this.map.rowBreaks.render(e,t.rowBreaks),this.map.drawing.render(e,t.drawing),this.map.picture.render(e,t.background),this.map.tableParts.render(e,t.tables),this.map.extLst.render(e,t),t.rels&&t.rels.forEach(t=>{t.Type===o.VmlDrawing&&e.leafNode("legacyDrawing",{"r:id":t.Id})}),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):"worksheet"===e.name?i.each(this.map,e=>{e.reset()}):this.map[e.name]&&!this.ignoreNodes.includes(e.name)&&(this.parser=this.map[e.name],this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("worksheet"===e){let e=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(e.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(e.outlineProperties=this.map.sheetPr.model.outlineProperties);let t=Object.assign({fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},this.map.pageSetup.model,this.map.printOptions.model),r=R(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:e,views:this.map.sheetViews.model,pageSetup:t,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:r},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}return!0}reconcile(e,t){let r=(e.relationships||[]).reduce((r,i)=>{if(r[i.Id]=i,i.Type===o.Comments&&(e.comments=t.comments[i.Target].comments),i.Type===o.VmlDrawing&&e.comments&&e.comments.length){let r=t.vmlDrawings[i.Target].comments;e.comments.forEach((e,t)=>{e.note=Object.assign({},e.note,r[t])})}return r},{});if(t.commentsMap=(e.comments||[]).reduce((e,t)=>(t.ref&&(e[t.ref]=t),e),{}),t.hyperlinkMap=(e.hyperlinks||[]).reduce((e,t)=>(t.rId&&(e[t.address]=r[t.rId].Target),e),{}),t.formulae={},e.rows=e.rows&&e.rows.filter(Boolean)||[],e.rows.forEach(e=>{e.cells=e.cells&&e.cells.filter(Boolean)||[]}),this.map.cols.reconcile(e.cols,t),this.map.sheetData.reconcile(e.rows,t),this.map.conditionalFormatting.reconcile(e.conditionalFormattings,t),e.media=[],e.drawing){let i=r[e.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(i){let r=i[1];t.drawings[r].anchors.forEach(t=>{if(t.medium){let r={type:"image",imageId:t.medium.index,range:t.range,hyperlinks:t.picture.hyperlinks};e.media.push(r)}})}}let i=e.background&&r[e.background.rId];if(i){let r=i.Target.split("/media/")[1],n=t.mediaIndex&&t.mediaIndex[r];void 0!==n&&e.media.push({type:"background",imageId:n})}e.tables=(e.tables||[]).map(e=>{let i=r[e.rId];return t.tables[i.Target]}),delete e.relationships,delete e.hyperlinks,delete e.comments}}O.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},t.exports=O},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr}render(e,t){t&&(e.openNode(this.tag),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this._format=e.format||function(e){try{return Number.isNaN(e.getTime())?"":e.toISOString()}catch(e){return""}},this._parse=e.parse||function(e){return new Date(e)}}render(e,t){t&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,this._format(t)):e.writeText(this._format(t)),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=this._parse(e.attributes[this.attr]):this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this.zero=e.zero}render(e,t){(t||this.zero)&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,t):e.writeText(t),e.closeNode())}parseOpen(e){return e.name===this.tag&&(this.attr?this.model=parseInt(e.attributes[this.attr],10):this.text=[],!0)}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs}render(e,t){void 0!==t&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,t):e.writeText(t),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=e.attributes[this.attr]:this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,t,r){"use strict";let i=e("./base-xform"),n=e("../../utils/xml-stream");t.exports=class extends i{constructor(e){super(),this._model=e}render(e){if(!this._xml){let e=new n;!function e(t,r){t.openNode(r.tag,r.$),r.c&&r.c.forEach(r=>{e(t,r)}),r.t&&t.writeText(r.t),t.closeNode()}(e,this._model),this._xml=e.xml}e.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(e){if(e===this._model.tag)return!1;return!0}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,t,r){"use strict";let i=e("./text-xform"),n=e("./rich-text-xform"),s=e("../base-xform");t.exports=class extends s{constructor(){super(),this.map={r:new n,t:new i}}get tag(){return"rPh"}render(e,t){if(e.openNode(this.tag,{sb:t.sb||0,eb:t.eb||0}),t&&t.hasOwnProperty("richText")&&t.richText){let{r:r}=this.map;t.richText.forEach(t=>{r.render(e,t)})}else t&&this.map.t.render(e,t.text);e.closeNode()}parseOpen(e){let{name:t}=e;return this.parser?(this.parser.parseOpen(e),!0):t===this.tag?(this.model={sb:parseInt(e.attributes.sb,10),eb:parseInt(e.attributes.eb,10)},!0):(this.parser=this.map[t],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let e=this.model.richText;e||(e=this.model.richText=[]),e.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}if(e===this.tag)return!1;return!0}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,t,r){"use strict";let i=e("./text-xform"),n=e("../style/font-xform"),s=e("../base-xform");class o extends s{constructor(e){super(),this.model=e}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new i)}get fontXform(){return this._fontXform||(this._fontXform=new n(o.FONT_OPTIONS))}render(e,t){t=t||this.model,e.openNode("r"),t.font&&this.fontXform.render(e,t.font),this.textXform.render(e,t.text),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(e),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){switch(e){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}}o.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},t.exports=o},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,t,r){"use strict";let i=e("./text-xform"),n=e("./rich-text-xform"),s=e("./phonetic-text-xform"),o=e("../base-xform");t.exports=class extends o{constructor(e){super(),this.model=e,this.map={r:new n,t:new i,rPh:new s}}get tag(){return"si"}render(e,t){e.openNode(this.tag),t&&t.hasOwnProperty("richText")&&t.richText?t.richText.length?t.richText.forEach(t=>{this.map.r.render(e,t)}):this.map.t.render(e,""):null!=t&&this.map.t.render(e,t),e.closeNode()}parseOpen(e){let{name:t}=e;return this.parser?(this.parser.parseOpen(e),!0):t===this.tag?(this.model={},!0):(this.parser=this.map[t],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let e=this.model.richText;e||(e=this.model.richText=[]),e.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}if(e===this.tag)return!1;return!0}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../base-xform"),s=e("./shared-string-xform");t.exports=class extends n{constructor(e){super(),this.model=e||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new s)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(e){return this.model.values[e]}add(e){return e.richText?this.addRichText(e):this.addText(e)}addText(e){let t=this.hash[e];return void 0===t&&(t=this.hash[e]=this.model.values.length,this.model.values.push(e)),this.model.count++,t}addRichText(e){let t=this.sharedStringXform.toXml(e),r=this.rich[t];return void 0===r&&(r=this.rich[t]=this.model.values.length,this.model.values.push(e)),this.model.count++,r}render(e,t){t=t||this._values,e.openXml(i.StdDocAttributes),e.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:t.count,uniqueCount:t.values.length});let r=this.sharedStringXform;t.values.forEach(t=>{r.render(e,t)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(e),!0;default:throw Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;if("sst"===e)return!1;throw Error("Unexpected xml node in parseClose: "+e)}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"t"}render(e,t){e.openNode("t"),/^\s|\n|\s$/.test(t)&&e.addAttribute("xml:space","preserve"),e.writeText(t),e.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(e,t)=>String.fromCharCode(parseInt(t,16)))}parseOpen(e){if("t"===e.name)return this._text=[],!0;return!1}parseText(e){this._text.push(e)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,t,r){"use strict";let i=e("../../../doc/enums"),n=e("../../../utils/utils"),s=e("../base-xform"),o={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((e,t)=>(e[t]=!0,e),{}),horizontal(e){return this.horizontalValues[e]?e:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((e,t)=>(e[t]=!0,e),{}),vertical(e){return"middle"===e?"center":this.verticalValues[e]?e:void 0},wrapText:e=>!!e||void 0,shrinkToFit:e=>!!e||void 0,textRotation(e){if("vertical"===e)return e;return(e=n.validInt(e))>=-90&&e<=90?e:void 0},indent:e=>Math.max(0,e=n.validInt(e)),readingOrder(e){switch(e){case"ltr":return i.ReadingOrder.LeftToRight;case"rtl":return i.ReadingOrder.RightToLeft;default:return}}},a={toXml(e){if(e=o.textRotation(e)){if("vertical"===e)return 255;let t=Math.round(e);if(t>=0&&t<=90)return t;if(t<0&&t>=-90)return 90-t}},toModel(e){let t=n.validInt(e);if(void 0!==t){if(255===t)return"vertical";if(t>=0&&t<=90)return t;if(t>90&&t<=180)return 90-t}}};t.exports=class extends s{get tag(){return"alignment"}render(e,t){e.addRollback(),e.openNode("alignment");let r=!1;function i(t,i){i&&(e.addAttribute(t,i),r=!0)}i("horizontal",o.horizontal(t.horizontal)),i("vertical",o.vertical(t.vertical)),i("wrapText",!!o.wrapText(t.wrapText)&&"1"),i("shrinkToFit",!!o.shrinkToFit(t.shrinkToFit)&&"1"),i("indent",o.indent(t.indent)),i("textRotation",a.toXml(t.textRotation)),i("readingOrder",o.readingOrder(t.readingOrder)),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){let t={},r=!1;function i(e,i,n){e&&(t[i]=n,r=!0)}i(e.attributes.horizontal,"horizontal",e.attributes.horizontal),i(e.attributes.vertical,"vertical","center"===e.attributes.vertical?"middle":e.attributes.vertical),i(e.attributes.wrapText,"wrapText",n.parseBoolean(e.attributes.wrapText)),i(e.attributes.shrinkToFit,"shrinkToFit",n.parseBoolean(e.attributes.shrinkToFit)),i(e.attributes.indent,"indent",parseInt(e.attributes.indent,10)),i(e.attributes.textRotation,"textRotation",a.toModel(e.attributes.textRotation)),i(e.attributes.readingOrder,"readingOrder","2"===e.attributes.readingOrder?"rtl":"ltr"),this.model=r?t:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("../../../utils/utils"),s=e("./color-xform");class o extends i{constructor(e){super(),this.name=e,this.map={color:new s}}get tag(){return this.name}render(e,t,r){let i=t&&t.color||r||this.defaultColor;e.openNode(this.name),t&&t.style&&(e.addAttribute("style",t.style),i&&this.map.color.render(e,i)),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.name:{let{style:t}=e.attributes;return this.model=t?{style:t}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(e===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(e){return o.validStyleValues[e]}}o.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((e,t)=>(e[t]=!0,e),{}),t.exports=class extends i{constructor(){super(),this.map={top:new o("top"),left:new o("left"),bottom:new o("bottom"),right:new o("right"),diagonal:new o("diagonal")}}render(e,t){let{color:r}=t;function i(i,n){i&&!i.color&&t.color&&(i={...i,color:t.color}),n.render(e,i,r)}e.openNode("border"),t.diagonal&&t.diagonal.style&&(t.diagonal.up&&e.addAttribute("diagonalUp","1"),t.diagonal.down&&e.addAttribute("diagonalDown","1")),i(t.left,this.map.left),i(t.right,this.map.right),i(t.top,this.map.top),i(t.bottom,this.map.bottom),i(t.diagonal,this.map.diagonal),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("border"===e.name)return this.reset(),this.diagonalUp=n.parseBoolean(e.attributes.diagonalUp),this.diagonalDown=n.parseBoolean(e.attributes.diagonalDown),!0;return this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("border"===e){let e=this.model={},t=function(t,r,i){r&&(i&&Object.assign(r,i),e[t]=r)};t("left",this.map.left.model),t("right",this.map.right.model),t("top",this.map.top.model),t("bottom",this.map.bottom.model),t("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{constructor(e){super(),this.name=e||"color"}get tag(){return this.name}render(e,t){return!!t&&(e.openNode(this.name),t.argb?e.addAttribute("rgb",t.argb):void 0!==t.theme?(e.addAttribute("theme",t.theme),void 0!==t.tint&&e.addAttribute("tint",t.tint)):void 0!==t.indexed?e.addAttribute("indexed",t.indexed):e.addAttribute("auto","1"),e.closeNode(),!0)}parseOpen(e){return e.name===this.name&&(e.attributes.rgb?this.model={argb:e.attributes.rgb}:e.attributes.theme?(this.model={theme:parseInt(e.attributes.theme,10)},e.attributes.tint&&(this.model.tint=parseFloat(e.attributes.tint))):e.attributes.indexed?this.model={indexed:parseInt(e.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./alignment-xform"),s=e("./border-xform"),o=e("./fill-xform"),a=e("./font-xform"),l=e("./numfmt-xform"),h=e("./protection-xform");t.exports=class extends i{constructor(){super(),this.map={alignment:new n,border:new s,fill:new o,font:new a,numFmt:new l,protection:new h}}get tag(){return"dxf"}render(e,t){if(e.openNode(this.tag),t.font&&this.map.font.render(e,t.font),t.numFmt&&t.numFmtId){let r={id:t.numFmtId,formatCode:t.numFmt};this.map.numFmt.render(e,r)}t.fill&&this.map.fill.render(e,t.fill),t.alignment&&this.map.alignment.render(e,t.alignment),t.border&&this.map.border.render(e,t.border),t.protection&&this.map.protection.render(e,t.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)return this.reset(),!0;return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./color-xform");class s extends i{constructor(){super(),this.map={color:new n}}get tag(){return"stop"}render(e,t){e.openNode("stop"),e.addAttribute("position",t.position),this.map.color.render(e,t.color),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"stop":return this.model={position:parseFloat(e.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(){}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class o extends i{constructor(){super(),this.map={fgColor:new n("fgColor"),bgColor:new n("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(e,t){e.openNode("patternFill"),e.addAttribute("patternType",t.pattern),t.fgColor&&this.map.fgColor.render(e,t.fgColor),t.bgColor&&this.map.bgColor.render(e,t.bgColor),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("patternFill"===e.name)return this.model={type:"pattern",pattern:e.attributes.patternType},!0;return this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.parser.model&&(this.model[e]=this.parser.model),this.parser=void 0),!0)}}class a extends i{constructor(){super(),this.map={stop:new s}}get name(){return"gradient"}get tag(){return"gradientFill"}render(e,t){switch(e.openNode("gradientFill"),t.gradient){case"angle":e.addAttribute("degree",t.degree);break;case"path":e.addAttribute("type","path"),t.center.left&&(e.addAttribute("left",t.center.left),void 0===t.center.right&&e.addAttribute("right",t.center.left)),t.center.right&&e.addAttribute("right",t.center.right),t.center.top&&(e.addAttribute("top",t.center.top),void 0===t.center.bottom&&e.addAttribute("bottom",t.center.top)),t.center.bottom&&e.addAttribute("bottom",t.center.bottom)}let r=this.map.stop;t.stops.forEach(t=>{r.render(e,t)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"gradientFill":{let t=this.model={stops:[]};return e.attributes.degree?(t.gradient="angle",t.degree=parseInt(e.attributes.degree,10)):"path"===e.attributes.type&&(t.gradient="path",t.center={left:e.attributes.left?parseFloat(e.attributes.left):0,top:e.attributes.top?parseFloat(e.attributes.top):0},e.attributes.right!==e.attributes.left&&(t.center.right=e.attributes.right?parseFloat(e.attributes.right):0),e.attributes.bottom!==e.attributes.top&&(t.center.bottom=e.attributes.bottom?parseFloat(e.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class l extends i{constructor(){super(),this.map={patternFill:new o,gradientFill:new a}}get tag(){return"fill"}render(e,t){switch(e.addRollback(),e.openNode("fill"),t.type){case"pattern":this.map.patternFill.render(e,t);break;case"gradient":this.map.gradientFill.render(e,t);break;default:return void e.rollback()}e.closeNode(),e.commit()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("fill"===e.name)return this.model={},!0;return this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(e){return l.validPatternValues[e]}}l.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((e,t)=>(e[t]=!0,e),{}),l.StopXform=s,l.PatternFillXform=o,l.GradientFillXform=a,t.exports=l},{"../base-xform":32,"./color-xform":128}],131:[function(e,t,r){"use strict";let i=e("./color-xform"),n=e("../simple/boolean-xform"),s=e("../simple/integer-xform"),o=e("../simple/string-xform"),a=e("./underline-xform"),l=e("../../../utils/under-dash"),h=e("../base-xform");class u extends h{constructor(e){super(),this.options=e||u.OPTIONS,this.map={b:{prop:"bold",xform:new n({tag:"b",attr:"val"})},i:{prop:"italic",xform:new n({tag:"i",attr:"val"})},u:{prop:"underline",xform:new a},charset:{prop:"charset",xform:new s({tag:"charset",attr:"val"})},color:{prop:"color",xform:new i},condense:{prop:"condense",xform:new n({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new n({tag:"extend",attr:"val"})},family:{prop:"family",xform:new s({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new n({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new o({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new o({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new n({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new n({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new s({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new o({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(e,t){let{map:r}=this;e.openNode(this.options.tagName),l.each(this.map,(i,n)=>{r[n].xform.render(e,t[i.prop])}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(this.map[e.name])return this.parser=this.map[e.name].xform,this.parser.parseOpen(e);if(e.name===this.options.tagName)return this.model={},!0;return!1}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser&&!this.parser.parseClose(e)){let t=this.map[e];return this.parser.model&&(this.model[t.prop]=this.parser.model),this.parser=void 0,!0}if(e===this.options.tagName)return!1;return!0}}u.OPTIONS={tagName:"font",fontNameTag:"name"},t.exports=u},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,t,r){"use strict";let i=e("../../../utils/under-dash"),n=e("../../defaultnumformats"),s=e("../base-xform"),o=function(){let e={};return i.each(n,(t,r)=>{t.f&&(e[t.f]=parseInt(r,10))}),e}();class a extends s{constructor(e,t){super(),this.id=e,this.formatCode=t}get tag(){return"numFmt"}render(e,t){e.leafNode("numFmt",{numFmtId:t.id,formatCode:t.formatCode})}parseOpen(e){if("numFmt"===e.name)return this.model={id:parseInt(e.attributes.numFmtId,10),formatCode:e.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;return!1}parseText(){}parseClose(){return!1}}a.getDefaultFmtId=function(e){return o[e]},a.getDefaultFmtCode=function(e){return n[e]&&n[e].f},t.exports=a},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,t,r){"use strict";let i=e("../base-xform"),n=(e,t)=>void 0===e?t:e;t.exports=class extends i{get tag(){return"protection"}render(e,t){e.addRollback(),e.openNode("protection");let r=!1;function i(t,i){void 0!==i&&(e.addAttribute(t,i),r=!0)}i("locked",n(t.locked,!0)?void 0:"0"),i("hidden",n(t.hidden,!1)?"1":void 0),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){let t={locked:"0"!==e.attributes.locked,hidden:"1"===e.attributes.hidden},r=!t.locked||t.hidden;this.model=r?t:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./alignment-xform"),s=e("./protection-xform");t.exports=class extends i{constructor(e){super(),this.xfId=!(!e||!e.xfId),this.map={alignment:new n,protection:new s}}get tag(){return"xf"}render(e,t){e.openNode("xf",{numFmtId:t.numFmtId||0,fontId:t.fontId||0,fillId:t.fillId||0,borderId:t.borderId||0}),this.xfId&&e.addAttribute("xfId",t.xfId||0),t.numFmtId&&e.addAttribute("applyNumberFormat","1"),t.fontId&&e.addAttribute("applyFont","1"),t.fillId&&e.addAttribute("applyFill","1"),t.borderId&&e.addAttribute("applyBorder","1"),t.alignment&&e.addAttribute("applyAlignment","1"),t.protection&&e.addAttribute("applyProtection","1"),t.alignment&&this.map.alignment.render(e,t.alignment),t.protection&&this.map.protection.render(e,t.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"xf":return this.model={numFmtId:parseInt(e.attributes.numFmtId,10),fontId:parseInt(e.attributes.fontId,10),fillId:parseInt(e.attributes.fillId,10),borderId:parseInt(e.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(e.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(e),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):"xf"!==e}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,t,r){"use strict";let i=e("../../../doc/enums"),n=e("../../../utils/xml-stream"),s=e("../base-xform"),o=e("../static-xform"),a=e("../list-xform"),l=e("./font-xform"),h=e("./fill-xform"),u=e("./border-xform"),c=e("./numfmt-xform"),d=e("./style-xform"),f=e("./dxf-xform");class p extends s{constructor(e){super(),this.map={numFmts:new a({tag:"numFmts",count:!0,childXform:new c}),fonts:new a({tag:"fonts",count:!0,childXform:new l,$:{"x14ac:knownFonts":1}}),fills:new a({tag:"fills",count:!0,childXform:new h}),borders:new a({tag:"borders",count:!0,childXform:new u}),cellStyleXfs:new a({tag:"cellStyleXfs",count:!0,childXform:new d}),cellXfs:new a({tag:"cellXfs",count:!0,childXform:new d({xfId:!0})}),dxfs:new a({tag:"dxfs",always:!0,count:!0,childXform:new f}),numFmt:new c,font:new l,fill:new h,border:new u,style:new d({xfId:!0}),cellStyles:p.STATIC_XFORMS.cellStyles,tableStyles:p.STATIC_XFORMS.tableStyles,extLst:p.STATIC_XFORMS.extLst},e&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(e,t){t=t||this.model,e.openXml(n.StdDocAttributes),e.openNode("styleSheet",p.STYLESHEET_ATTRIBUTES),this.index?(t.numFmts&&t.numFmts.length&&(e.openNode("numFmts",{count:t.numFmts.length}),t.numFmts.forEach(t=>{e.writeXml(t)}),e.closeNode()),t.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),e.openNode("fonts",{count:t.fonts.length,"x14ac:knownFonts":1}),t.fonts.forEach(t=>{e.writeXml(t)}),e.closeNode(),e.openNode("fills",{count:t.fills.length}),t.fills.forEach(t=>{e.writeXml(t)}),e.closeNode(),e.openNode("borders",{count:t.borders.length}),t.borders.forEach(t=>{e.writeXml(t)}),e.closeNode(),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),e.openNode("cellXfs",{count:t.styles.length}),t.styles.forEach(t=>{e.writeXml(t)}),e.closeNode()):(this.map.numFmts.render(e,t.numFmts),this.map.fonts.render(e,t.fonts),this.map.fills.render(e,t.fills),this.map.borders.render(e,t.borders),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(e,t.styles)),p.STATIC_XFORMS.cellStyles.render(e),this.map.dxfs.render(e,t.dxfs),p.STATIC_XFORMS.tableStyles.render(e),p.STATIC_XFORMS.extLst.render(e),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("styleSheet"===e.name)return this.initIndex(),!0;return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("styleSheet"===e){this.model={};let e=(e,t)=>{t.model&&t.model.length&&(this.model[e]=t.model)};if(e("numFmts",this.map.numFmts),e("fonts",this.map.fonts),e("fills",this.map.fills),e("borders",this.map.borders),e("styles",this.map.cellXfs),e("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){let e=this.index.numFmt;this.model.numFmts.forEach(t=>{e[t.id]=t.formatCode})}return!1}return!0}addStyleModel(e,t){if(!e)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(e))return this.weakMap.get(e);let r={};if(t=t||i.ValueType.Number,e.numFmt)r.numFmtId=this._addNumFmtStr(e.numFmt);else switch(t){case i.ValueType.Number:r.numFmtId=this._addNumFmtStr("General");break;case i.ValueType.Date:r.numFmtId=this._addNumFmtStr("mm-dd-yy")}e.font&&(r.fontId=this._addFont(e.font)),e.border&&(r.borderId=this._addBorder(e.border)),e.fill&&(r.fillId=this._addFill(e.fill)),e.alignment&&(r.alignment=e.alignment),e.protection&&(r.protection=e.protection);let n=this._addStyle(r);return this.weakMap&&this.weakMap.set(e,n),n}getStyleModel(e){let t=this.model.styles[e];if(!t)return null;let r=this.index.model[e];if(r)return r;if(r=this.index.model[e]={},t.numFmtId){let e=this.index.numFmt[t.numFmtId]||c.getDefaultFmtCode(t.numFmtId);e&&(r.numFmt=e)}function i(e,t,i){if(i||0===i){let n=t[i];n&&(r[e]=n)}}return i("font",this.model.fonts,t.fontId),i("border",this.model.borders,t.borderId),i("fill",this.model.fills,t.fillId),t.alignment&&(r.alignment=t.alignment),t.protection&&(r.protection=t.protection),r}addDxfStyle(e){return e.numFmt&&(e.numFmtId=this._addNumFmtStr(e.numFmt)),this.model.dxfs.push(e),this.model.dxfs.length-1}getDxfStyle(e){return this.model.dxfs[e]}_addStyle(e){let t=this.map.style.toXml(e),r=this.index.style[t];return void 0===r&&(r=this.index.style[t]=this.model.styles.length,this.model.styles.push(t)),r}_addNumFmtStr(e){let t=c.getDefaultFmtId(e);if(void 0!==t||void 0!==(t=this.index.numFmt[e]))return t;t=this.index.numFmt[e]=164+this.model.numFmts.length;let r=this.map.numFmt.toXml({id:t,formatCode:e});return this.model.numFmts.push(r),t}_addFont(e){let t=this.map.font.toXml(e),r=this.index.font[t];return void 0===r&&(r=this.index.font[t]=this.model.fonts.length,this.model.fonts.push(t)),r}_addBorder(e){let t=this.map.border.toXml(e),r=this.index.border[t];return void 0===r&&(r=this.index.border[t]=this.model.borders.length,this.model.borders.push(t)),r}_addFill(e){let t=this.map.fill.toXml(e),r=this.index.fill[t];return void 0===r&&(r=this.index.fill[t]=this.model.fills.length,this.model.fills.push(t)),r}}p.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},p.STATIC_XFORMS={cellStyles:new o({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new o({tag:"dxfs",$:{count:0}}),tableStyles:new o({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new o({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},p.Mock=class extends p{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(e){return e.autodrain(),Promise.resolve()}addStyleModel(e,t){if(t===i.ValueType.Date)return this.dateStyleId;return 0}get dateStyleId(){if(!this._dateStyleId){let e={numFmtId:c.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(e)}return this._dateStyleId}getStyleModel(){return{}}},t.exports=p},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,t,r){"use strict";let i=e("../base-xform");class n extends i{constructor(e){super(),this.model=e}get tag(){return"u"}render(e,t){if(!0===(t=t||this.model))e.leafNode("u");else{let r=n.Attributes[t];r&&e.leafNode("u",r)}}parseOpen(e){"u"===e.name&&(this.model=e.attributes.val||!0)}parseText(){}parseClose(){return!1}}n.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},t.exports=n},{"../base-xform":32}],137:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("./filter-column-xform");t.exports=class extends i{constructor(){super(),this.map={filterColumn:new n}}get tag(){return"autoFilter"}prepare(e){e.columns.forEach((e,t)=>{this.map.filterColumn.prepare(e,{index:t})})}render(e,t){return e.openNode(this.tag,{ref:t.autoFilterRef}),t.columns.forEach(t=>{this.map.filterColumn.render(e,t)}),e.closeNode(),!0}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)return this.model={autoFilterRef:e.attributes.ref,columns:[]},!0;if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;if(e===this.tag)return!1;throw Error("Unexpected xml node in parseClose: "+e)}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"customFilter"}render(e,t){e.leafNode(this.tag,{val:t.val,operator:t.operator})}parseOpen(e){return e.name===this.tag&&(this.model={val:e.attributes.val,operator:e.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,t,r){"use strict";let i=e("../base-xform"),n=e("../list-xform"),s=e("./custom-filter-xform"),o=e("./filter-xform");t.exports=class extends i{constructor(){super(),this.map={customFilters:new n({tag:"customFilters",count:!1,empty:!0,childXform:new s}),filters:new n({tag:"filters",count:!1,empty:!0,childXform:new o})}}get tag(){return"filterColumn"}prepare(e,t){e.colId=t.index.toString()}render(e,t){return t.customFilters?(e.openNode(this.tag,{colId:t.colId,hiddenButton:t.filterButton?"0":"1"}),this.map.customFilters.render(e,t.customFilters),e.closeNode()):e.leafNode(this.tag,{colId:t.colId,hiddenButton:t.filterButton?"0":"1"}),!0}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;let{attributes:t}=e;if(e.name===this.tag)return this.model={filterButton:"0"===t.hiddenButton},!0;if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw Error("Unexpected xml node in parseOpen: "+JSON.stringify(e))}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model.customFilters=this.map.customFilters.model,!1;return!0}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"filter"}render(e,t){e.leafNode(this.tag,{val:t.val})}parseOpen(e){return e.name===this.tag&&(this.model={val:e.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"tableColumn"}prepare(e,t){e.id=t.index+1}render(e,t){return e.leafNode(this.tag,{id:t.id.toString(),name:t.name,totalsRowLabel:t.totalsRowLabel,totalsRowFunction:t.totalsRowFunction,dxfId:t.dxfId}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:t}=e;return this.model={name:t.name,totalsRowLabel:t.totalsRowLabel,totalsRowFunction:t.totalsRowFunction,dxfId:t.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,t,r){"use strict";let i=e("../base-xform");t.exports=class extends i{get tag(){return"tableStyleInfo"}render(e,t){return e.leafNode(this.tag,{name:t.theme?t.theme:void 0,showFirstColumn:t.showFirstColumn?"1":"0",showLastColumn:t.showLastColumn?"1":"0",showRowStripes:t.showRowStripes?"1":"0",showColumnStripes:t.showColumnStripes?"1":"0"}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:t}=e;return this.model={theme:t.name?t.name:null,showFirstColumn:"1"===t.showFirstColumn,showLastColumn:"1"===t.showLastColumn,showRowStripes:"1"===t.showRowStripes,showColumnStripes:"1"===t.showColumnStripes},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,t,r){"use strict";let i=e("../../../utils/xml-stream"),n=e("../base-xform"),s=e("../list-xform"),o=e("./auto-filter-xform"),a=e("./table-column-xform"),l=e("./table-style-info-xform");class h extends n{constructor(){super(),this.map={autoFilter:new o,tableColumns:new s({tag:"tableColumns",count:!0,empty:!0,childXform:new a}),tableStyleInfo:new l}}prepare(e,t){this.map.autoFilter.prepare(e),this.map.tableColumns.prepare(e.columns,t)}get tag(){return"table"}render(e,t){e.openXml(i.StdDocAttributes),e.openNode(this.tag,{...h.TABLE_ATTRIBUTES,id:t.id,name:t.name,displayName:t.displayName||t.name,ref:t.tableRef,totalsRowCount:t.totalsRow?"1":void 0,totalsRowShown:t.totalsRow?void 0:"1",headerRowCount:t.headerRow?"1":"0"}),this.map.autoFilter.render(e,t),this.map.tableColumns.render(e,t.columns),this.map.tableStyleInfo.render(e,t.style),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;let{name:t,attributes:r}=e;if(t===this.tag)this.reset(),this.model={name:r.name,displayName:r.displayName||r.name,tableRef:r.ref,totalsRow:"1"===r.totalsRowCount,headerRow:"1"===r.headerRowCount};else this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e===this.tag)return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((e,t)=>{this.model.columns[t].filterButton=e.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;return!0}reconcile(e,t){e.columns.forEach(e=>{void 0!==e.dxfId&&(e.style=t.styles.getDxfStyle(e.dxfId))})}}h.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},t.exports=h},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,t,r){(function(r,i){(function(){"use strict";let n=e("fs"),s=e("jszip"),{PassThrough:o}=e("readable-stream"),a=e("../utils/zip-stream"),l=e("../utils/stream-buf"),h=e("../utils/utils"),u=e("../utils/xml-stream"),{bufferToString:c}=e("../utils/browser-buffer-decode"),d=e("./xform/style/styles-xform"),f=e("./xform/core/core-xform"),p=e("./xform/strings/shared-strings-xform"),g=e("./xform/core/relationships-xform"),m=e("./xform/core/content-types-xform"),v=e("./xform/core/app-xform"),b=e("./xform/book/workbook-xform"),y=e("./xform/sheet/worksheet-xform"),x=e("./xform/drawing/drawing-xform"),_=e("./xform/table/table-xform"),S=e("./xform/comment/comments-xform"),w=e("./xform/comment/vml-notes-xform"),T=e("./xml/theme1");class P{constructor(e){this.workbook=e}async readFile(e,t){if(!await h.fs.exists(e))throw Error("File not found: "+e);let r=n.createReadStream(e);try{let e=await this.read(r,t);return r.close(),e}catch(e){throw r.close(),e}}parseRels(e){return(new g).parseStream(e)}parseWorkbook(e){return(new b).parseStream(e)}parseSharedStrings(e){return(new p).parseStream(e)}reconcile(e,t){let r=new b,i=new y(t),n=new x,s=new _;r.reconcile(e);let o={media:e.media,mediaIndex:e.mediaIndex};Object.keys(e.drawings).forEach(t=>{let r=e.drawings[t],i=e.drawingRels[t];i&&(o.rels=i.reduce((e,t)=>(e[t.Id]=t,e),{}),(r.anchors||[]).forEach(e=>{let t=e.picture&&e.picture.hyperlinks;t&&o.rels[t.rId]&&(t.hyperlink=o.rels[t.rId].Target,delete t.rId)}),n.reconcile(r,o))});let a={styles:e.styles};Object.values(e.tables).forEach(e=>{s.reconcile(e,a)});let l={styles:e.styles,sharedStrings:e.sharedStrings,media:e.media,mediaIndex:e.mediaIndex,date1904:e.properties&&e.properties.date1904,drawings:e.drawings,comments:e.comments,tables:e.tables,vmlDrawings:e.vmlDrawings};e.worksheets.forEach(t=>{t.relationships=e.worksheetRels[t.sheetNo],i.reconcile(t,l)}),delete e.worksheetHash,delete e.worksheetRels,delete e.globalRels,delete e.sharedStrings,delete e.workbookRels,delete e.sheetDefs,delete e.styles,delete e.mediaIndex,delete e.drawings,delete e.drawingRels,delete e.vmlDrawings}async _processWorksheetEntry(e,t,r,i,n){let s=new y(i),o=await s.parseStream(e);o.sheetNo=r,t.worksheetHash[n]=o,t.worksheets.push(o)}async _processCommentEntry(e,t,r){let i=new S,n=await i.parseStream(e);t.comments[`../${r}.xml`]=n}async _processTableEntry(e,t,r){let i=new _,n=await i.parseStream(e);t.tables[`../tables/${r}.xml`]=n}async _processWorksheetRelsEntry(e,t,r){let i=new g,n=await i.parseStream(e);t.worksheetRels[r]=n}async _processMediaEntry(e,t,r){let i=r.lastIndexOf(".");if(i>=1){let n=r.substr(i+1),s=r.substr(0,i);await new Promise((i,o)=>{let a=new l;a.on("finish",()=>{t.mediaIndex[r]=t.media.length,t.mediaIndex[s]=t.media.length;let e={type:"image",name:s,extension:n,buffer:a.toBuffer()};t.media.push(e),i()}),e.on("error",e=>{o(e)}),e.pipe(a)})}}async _processDrawingEntry(e,t,r){let i=new x,n=await i.parseStream(e);t.drawings[r]=n}async _processDrawingRelsEntry(e,t,r){let i=new g,n=await i.parseStream(e);t.drawingRels[r]=n}async _processVmlDrawingEntry(e,t,r){let i=new w,n=await i.parseStream(e);t.vmlDrawings[`../drawings/${r}.vml`]=n}async _processThemeEntry(e,t,r){await new Promise((i,n)=>{let s=new l;e.on("error",n),s.on("error",n),s.on("finish",()=>{t.themes[r]=s.read().toString(),i()}),e.pipe(s)})}createInputStream(){throw Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(e,t){!e[Symbol.asyncIterator]&&e.pipe&&(e=e.pipe(new o));let r=[];for await(let t of e)r.push(t);return this.load(i.concat(r),t)}async load(e,t){let n;n=t&&t.base64?i.from(e.toString(),"base64"):e;let a={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}};for(let e of Object.values((await s.loadAsync(n)).files))if(!e.dir){let i,n=e.name;if("/"===n[0]&&(n=n.substr(1)),n.match(/xl\/media\//)||n.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))(i=new o).write(await e.async("nodebuffer"));else{let t;i=new o({writableObjectMode:!0,readableObjectMode:!0}),t=r.browser?c(await e.async("nodebuffer")):await e.async("string");for(let e=0;e<t.length;e+=16384)i.write(t.substring(e,e+16384))}switch(i.end(),n){case"_rels/.rels":a.globalRels=await this.parseRels(i);break;case"xl/workbook.xml":{let e=await this.parseWorkbook(i);a.sheets=e.sheets,a.definedNames=e.definedNames,a.views=e.views,a.properties=e.properties,a.calcProperties=e.calcProperties;break}case"xl/_rels/workbook.xml.rels":a.workbookRels=await this.parseRels(i);break;case"xl/sharedStrings.xml":a.sharedStrings=new p,await a.sharedStrings.parseStream(i);break;case"xl/styles.xml":a.styles=new d,await a.styles.parseStream(i);break;case"docProps/app.xml":{let e=new v,t=await e.parseStream(i);a.company=t.company,a.manager=t.manager;break}case"docProps/core.xml":{let e=new f;Object.assign(a,await e.parseStream(i));break}default:{let e=n.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(e){await this._processWorksheetEntry(i,a,e[1],t,n);break}if(e=n.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/)){await this._processWorksheetRelsEntry(i,a,e[1]);break}if(e=n.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/)){await this._processThemeEntry(i,a,e[1]);break}if(e=n.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/)){await this._processMediaEntry(i,a,e[1]);break}if(e=n.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/)){await this._processDrawingEntry(i,a,e[1]);break}if(e=n.match(/xl\/(comments\d+)[.]xml/)){await this._processCommentEntry(i,a,e[1]);break}if(e=n.match(/xl\/tables\/(table\d+)[.]xml/)){await this._processTableEntry(i,a,e[1]);break}if(e=n.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/)){await this._processDrawingRelsEntry(i,a,e[1]);break}if(e=n.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/))await this._processVmlDrawingEntry(i,a,e[1])}}}return this.reconcile(a,t),this.workbook.model=a,this.workbook}async addMedia(e,t){await Promise.all(t.media.map(async t=>{if("image"===t.type){let s=`xl/media/${t.name}.${t.extension}`;if(t.filename){var r,i;let o=await (r=t.filename,new Promise((e,t)=>{n.readFile(r,void 0,(r,i)=>{r?t(r):e(i)})}));return e.append(o,{name:s})}if(t.buffer)return e.append(t.buffer,{name:s});if(t.base64){let r=t.base64,i=r.substring(r.indexOf(",")+1);return e.append(i,{name:s,base64:!0})}}throw Error("Unsupported media")}))}addDrawings(e,t){let r=new x,i=new g;t.worksheets.forEach(t=>{let{drawing:n}=t;if(n){r.prepare(n,{});let t=r.toXml(n);e.append(t,{name:`xl/drawings/${n.name}.xml`}),t=i.toXml(n.rels),e.append(t,{name:`xl/drawings/_rels/${n.name}.xml.rels`})}})}addTables(e,t){let r=new _;t.worksheets.forEach(t=>{let{tables:i}=t;i.forEach(t=>{r.prepare(t,{});let i=r.toXml(t);e.append(i,{name:"xl/tables/"+t.target})})})}async addContentTypes(e,t){let r=(new m).toXml(t);e.append(r,{name:"[Content_Types].xml"})}async addApp(e,t){let r=(new v).toXml(t);e.append(r,{name:"docProps/app.xml"})}async addCore(e,t){let r=new f;e.append(r.toXml(t),{name:"docProps/core.xml"})}async addThemes(e,t){let r=t.themes||{theme1:T};Object.keys(r).forEach(t=>{let i=r[t],n=`xl/theme/${t}.xml`;e.append(i,{name:n})})}async addOfficeRels(e){let t=(new g).toXml([{Id:"rId1",Type:P.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:P.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:P.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);e.append(t,{name:"_rels/.rels"})}async addWorkbookRels(e,t){let r=1,i=[{Id:"rId"+r++,Type:P.RelType.Styles,Target:"styles.xml"},{Id:"rId"+r++,Type:P.RelType.Theme,Target:"theme/theme1.xml"}];t.sharedStrings.count&&i.push({Id:"rId"+r++,Type:P.RelType.SharedStrings,Target:"sharedStrings.xml"}),t.worksheets.forEach(e=>{e.rId="rId"+r++,i.push({Id:e.rId,Type:P.RelType.Worksheet,Target:`worksheets/sheet${e.id}.xml`})});let n=(new g).toXml(i);e.append(n,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(e,t){t.sharedStrings&&t.sharedStrings.count&&e.append(t.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(e,t){let{xml:r}=t.styles;r&&e.append(r,{name:"xl/styles.xml"})}async addWorkbook(e,t){let r=new b;e.append(r.toXml(t),{name:"xl/workbook.xml"})}async addWorksheets(e,t){let r=new y,i=new g,n=new S,s=new w;t.worksheets.forEach(t=>{let o=new u;r.render(o,t),e.append(o.xml,{name:`xl/worksheets/sheet${t.id}.xml`}),t.rels&&t.rels.length&&(o=new u,i.render(o,t.rels),e.append(o.xml,{name:`xl/worksheets/_rels/sheet${t.id}.xml.rels`})),t.comments.length>0&&(o=new u,n.render(o,t),e.append(o.xml,{name:`xl/comments${t.id}.xml`}),o=new u,s.render(o,t),e.append(o.xml,{name:`xl/drawings/vmlDrawing${t.id}.vml`}))})}_finalize(e){return new Promise((t,r)=>{e.on("finish",()=>{t(this)}),e.on("error",r),e.finalize()})}prepareModel(e,t){e.creator=e.creator||"ExcelJS",e.lastModifiedBy=e.lastModifiedBy||"ExcelJS",e.created=e.created||new Date,e.modified=e.modified||new Date,e.useSharedStrings=void 0===t.useSharedStrings||t.useSharedStrings,e.useStyles=void 0===t.useStyles||t.useStyles,e.sharedStrings=new p,e.styles=e.useStyles?new d(!0):new d.Mock;let r=new b,i=new y;r.prepare(e);let n={sharedStrings:e.sharedStrings,styles:e.styles,date1904:e.properties.date1904,drawingsCount:0,media:e.media};n.drawings=e.drawings=[],n.commentRefs=e.commentRefs=[];let s=0;e.tables=[],e.worksheets.forEach(t=>{t.tables.forEach(t=>{s++,t.target=`table${s}.xml`,t.id=s,e.tables.push(t)}),i.prepare(t,n)})}async write(e,t){t=t||{};let{model:r}=this.workbook,i=new a.ZipWriter(t.zip);return i.pipe(e),this.prepareModel(r,t),await this.addContentTypes(i,r),await this.addOfficeRels(i,r),await this.addWorkbookRels(i,r),await this.addWorksheets(i,r),await this.addSharedStrings(i,r),await this.addDrawings(i,r),await this.addTables(i,r),await Promise.all([this.addThemes(i,r),this.addStyles(i,r)]),await this.addMedia(i,r),await Promise.all([this.addApp(i,r),this.addCore(i,r)]),await this.addWorkbook(i,r),this._finalize(i)}writeFile(e,t){let r=n.createWriteStream(e);return new Promise((e,i)=>{r.on("finish",()=>{e()}),r.on("error",e=>{i(e)}),this.write(r,t).then(()=>{r.end()}).catch(e=>{i(e)})})}async writeBuffer(e){let t=new l;return await this.write(t,e),t.read()}}P.RelType=e("./rel-type"),t.exports=P}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,t,r){"use strict";t.exports='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>'},{}],146:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CsvFormatterStream=void 0;let i=e("stream"),n=e("./formatter");class s extends i.Transform{constructor(e){super({writableObjectMode:e.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=e,this.rowFormatter=new n.RowFormatter(e),this.hasWrittenBOM=!e.writeBOM}transform(e){return this.rowFormatter.rowTransform=e,this}_transform(e,r,i){let n=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(e,(e,r)=>e?(n=!0,i(e)):(r&&r.forEach(e=>{this.push(t.from(e,"utf8"))}),n=!0,i()))}catch(e){if(n)throw e;i(e)}}_flush(e){this.rowFormatter.finish((r,i)=>r?e(r):(i&&i.forEach(e=>{this.push(t.from(e,"utf8"))}),e()))}}r.CsvFormatterStream=s}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FormatterOptions=void 0,r.FormatterOptions=class{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.objectMode=!0,this.delimiter=",",this.rowDelimiter="\n",this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,t||{}),void 0===(null==t?void 0:t.quoteHeaders)&&(this.quoteHeaders=this.quoteColumns),!0===(null==t?void 0:t.quote)?this.quote='"':!1===(null==t?void 0:t.quote)&&(this.quote=""),"string"!=typeof(null==t?void 0:t.escape)&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&(null===(e=t.writeHeaders)||void 0===e||e),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(e,t,r){"use strict";var i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.FieldFormatter=void 0;let n=i(e("lodash.isboolean")),s=i(e("lodash.isnil")),o=i(e("lodash.escaperegexp"));r.FieldFormatter=class{constructor(e){this._headers=null,this.formatterOptions=e,null!==e.headers&&(this.headers=e.headers),this.REPLACE_REGEXP=RegExp(e.quote,"g");let t=`[${e.delimiter}${o.default(e.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(t)}set headers(e){this._headers=e}shouldQuote(e,t){let r=t?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return n.default(r)?r:Array.isArray(r)?r[e]:null!==this._headers&&r[this._headers[e]]}format(e,t,r){let i=(""+(s.default(e)?"":e)).replace(/\0/g,""),{formatterOptions:n}=this;return""!==n.quote&&-1!==i.indexOf(n.quote)?this.quoteField(i.replace(this.REPLACE_REGEXP,n.escapedQuote)):-1!==i.search(this.ESCAPE_REGEXP)||this.shouldQuote(t,r)?this.quoteField(i):i}quoteField(e){let{quote:t}=this.formatterOptions;return`${t}${e}${t}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,t,r){"use strict";var i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.RowFormatter=void 0;let n=i(e("lodash.isfunction")),s=i(e("lodash.isequal")),o=e("./FieldFormatter"),a=e("../types");class l{constructor(e){this.rowCount=0,this.formatterOptions=e,this.fieldFormatter=new o.FieldFormatter(e),this.headers=e.headers,this.shouldWriteHeaders=e.shouldWriteHeaders,this.hasWrittenHeaders=!1,null!==this.headers&&(this.fieldFormatter.headers=this.headers),e.transform&&(this.rowTransform=e.transform)}static isRowHashArray(e){return!!Array.isArray(e)&&Array.isArray(e[0])&&2===e[0].length}static isRowArray(e){return Array.isArray(e)&&!this.isRowHashArray(e)}static gatherHeaders(e){return l.isRowHashArray(e)?e.map(e=>e[0]):Array.isArray(e)?e:Object.keys(e)}static createTransform(e){return a.isSyncTransform(e)?(t,r)=>{let i=null;try{i=e(t)}catch(e){return r(e)}return r(null,i)}:(t,r)=>{e(t,r)}}set rowTransform(e){if(!n.default(e))throw TypeError("The transform should be a function");this._rowTransform=l.createTransform(e)}format(e,t){this.callTransformer(e,(r,i)=>{if(r)return t(r);if(!e)return t(null);let n=[];if(i){let{shouldFormatColumns:e,headers:t}=this.checkHeaders(i);if(this.shouldWriteHeaders&&t&&!this.hasWrittenHeaders&&(n.push(this.formatColumns(t,!0)),this.hasWrittenHeaders=!0),e){let e=this.gatherColumns(i);n.push(this.formatColumns(e,!1))}}return t(null,n)})}finish(e){let t=[];if(this.formatterOptions.alwaysWriteHeaders&&0===this.rowCount){if(!this.headers)return e(Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));t.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&t.push(this.formatterOptions.rowDelimiter),e(null,t)}checkHeaders(e){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};let t=l.gatherHeaders(e);return this.headers=t,this.fieldFormatter.headers=t,this.shouldWriteHeaders?{shouldFormatColumns:!s.default(t,e),headers:t}:{shouldFormatColumns:!0,headers:null}}gatherColumns(e){if(null===this.headers)throw Error("Headers is currently null");return Array.isArray(e)?l.isRowHashArray(e)?this.headers.map((t,r)=>{let i=e[r];return i?i[1]:""}):l.isRowArray(e)&&!this.shouldWriteHeaders?e:this.headers.map((t,r)=>e[r]):this.headers.map(t=>e[t])}callTransformer(e,t){return this._rowTransform?this._rowTransform(e,t):t(null,e)}formatColumns(e,t){let r=e.map((e,r)=>this.fieldFormatter.format(e,r,t)).join(this.formatterOptions.delimiter),{rowCount:i}=this;return this.rowCount+=1,i?[this.formatterOptions.rowDelimiter,r].join(""):r}}r.RowFormatter=l},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FieldFormatter=r.RowFormatter=void 0;var i=e("./RowFormatter");Object.defineProperty(r,"RowFormatter",{enumerable:!0,get:function(){return i.RowFormatter}});var n=e("./FieldFormatter");Object.defineProperty(r,"FieldFormatter",{enumerable:!0,get:function(){return n.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,t,r){(function(t){(function(){"use strict";var i=Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]},n=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};Object.defineProperty(r,"__esModule",{value:!0}),r.writeToPath=r.writeToString=r.writeToBuffer=r.writeToStream=r.write=r.format=r.FormatterOptions=r.CsvFormatterStream=void 0;let s=e("util"),o=e("stream"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t}(e("fs")),l=e("./FormatterOptions"),h=e("./CsvFormatterStream");!function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)}(e("./types"),r);var u=e("./CsvFormatterStream");Object.defineProperty(r,"CsvFormatterStream",{enumerable:!0,get:function(){return u.CsvFormatterStream}});var c=e("./FormatterOptions");Object.defineProperty(r,"FormatterOptions",{enumerable:!0,get:function(){return c.FormatterOptions}}),r.format=e=>new h.CsvFormatterStream(new l.FormatterOptions(e)),r.write=(e,t)=>{let i=r.format(t),n=s.promisify((e,t)=>{i.write(e,void 0,t)});return e.reduce((e,t)=>e.then(()=>n(t)),Promise.resolve()).then(()=>i.end()).catch(e=>{i.emit("error",e)}),i},r.writeToStream=(e,t,i)=>r.write(t,i).pipe(e),r.writeToBuffer=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],s=new o.Writable({write(e,t,r){n.push(e),r()}});return new Promise((o,a)=>{s.on("error",a).on("finish",()=>o(t.concat(n))),r.write(e,i).pipe(s)})},r.writeToString=(e,t)=>r.writeToBuffer(e,t).then(e=>e.toString()),r.writeToPath=(e,t,i)=>{let n=a.createWriteStream(e,{encoding:"utf8"});return r.write(t,i).pipe(n)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isSyncTransform=void 0,r.isSyncTransform=e=>1===e.length},{}],153:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CsvParserStream=void 0;let i=e("string_decoder"),n=e("stream"),s=e("./transforms"),o=e("./parser");class a extends n.Transform{constructor(e){super({objectMode:e.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=e,this.parser=new o.Parser(e),this.headerTransformer=new s.HeaderTransformer(e),this.decoder=new i.StringDecoder(e.encoding),this.rowTransformerValidator=new s.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(e){return this.rowTransformerValidator.rowTransform=e,this}validate(e){return this.rowTransformerValidator.rowValidator=e,this}emit(e){if("end"===e)return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return super.emit(e,...r)}_transform(e,t,r){if(this.hasHitRowLimit)return r();let i=a.wrapDoneCallback(r);try{let{lines:t}=this,r=t+this.decoder.write(e),n=this.parse(r,!0);return this.processRows(n,i)}catch(e){return i(e)}}_flush(e){let t=a.wrapDoneCallback(e);if(this.hasHitRowLimit)return t();try{let e=this.lines+this.decoder.end(),r=this.parse(e,!1);return this.processRows(r,t)}catch(e){return t(e)}}parse(e,t){if(!e)return[];let{line:r,rows:i}=this.parser.parse(e,t);return this.lines=r,i}processRows(e,r){let i=e.length,n=s=>{let o=e=>e?r(e):s%100!=0?n(s+1):void t(()=>n(s+1));if(this.checkAndEmitHeaders(),s>=i||this.hasHitRowLimit)return r();if(this.parsedLineCount+=1,this.shouldSkipLine)return o();let a=e[s];this.rowCount+=1,this.parsedRowCount+=1;let l=this.rowCount;return this.transformRow(a,(e,t)=>{if(e)return this.rowCount-=1,o(e);if(!t)return o(Error("expected transform result"));if(t.isValid){if(t.row)return this.pushRow(t.row,o)}else this.emit("data-invalid",t.row,l,t.reason);return o()})};n(0)}transformRow(e,t){try{this.headerTransformer.transform(e,(r,i)=>r?t(r):i?i.isValid?i.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(i.row,t):this.skipRow(t):(this.rowCount-=1,this.parsedRowCount-=1,t(null,{row:null,isValid:!0})):this.shouldEmitRows?t(null,{isValid:!1,row:e}):this.skipRow(t):t(Error("Expected result from header transform")))}catch(e){t(e)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(e){return this.rowCount-=1,e(null,{row:null,isValid:!0})}pushRow(e,t){try{this.parserOptions.objectMode?this.push(e):this.push(JSON.stringify(e)),t()}catch(e){t(e)}}static wrapDoneCallback(e){let t=!1;return function(r){if(r){if(t)throw r;return t=!0,void e(r)}for(var i=arguments.length,n=Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];e(...n)}}}r.CsvParserStream=a}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,t,r){"use strict";var i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ParserOptions=void 0;let n=i(e("lodash.escaperegexp")),s=i(e("lodash.isnil"));r.ParserOptions=class{constructor(e){var t;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,e||{}),this.delimiter.length>1)throw Error("delimiter option must be one character long");this.escapedDelimiter=n.default(this.delimiter),this.escapeChar=null!==(t=this.escape)&&void 0!==t?t:this.quote,this.supportsComments=!s.default(this.comment),this.NEXT_TOKEN_REGEXP=RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,t,r){"use strict";var i=Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]},n=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};Object.defineProperty(r,"__esModule",{value:!0}),r.parseString=r.parseFile=r.parseStream=r.parse=r.ParserOptions=r.CsvParserStream=void 0;let s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t}(e("fs")),o=e("stream"),a=e("./ParserOptions"),l=e("./CsvParserStream");!function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)}(e("./types"),r);var h=e("./CsvParserStream");Object.defineProperty(r,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var u=e("./ParserOptions");Object.defineProperty(r,"ParserOptions",{enumerable:!0,get:function(){return u.ParserOptions}}),r.parse=e=>new l.CsvParserStream(new a.ParserOptions(e)),r.parseStream=(e,t)=>e.pipe(new l.CsvParserStream(new a.ParserOptions(t))),r.parseFile=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.createReadStream(e).pipe(new l.CsvParserStream(new a.ParserOptions(t)))},r.parseString=(e,t)=>{let r=new o.Readable;return r.push(e),r.push(null),r.pipe(new l.CsvParserStream(new a.ParserOptions(t)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;let i=e("./Scanner"),n=e("./RowParser"),s=e("./Token");class o{constructor(e){this.parserOptions=e,this.rowParser=new n.RowParser(this.parserOptions)}static removeBOM(e){return e&&65279===e.charCodeAt(0)?e.slice(1):e}parse(e,t){let r=new i.Scanner({line:o.removeBOM(e),parserOptions:this.parserOptions,hasMoreData:t});return this.parserOptions.supportsComments?this.parseWithComments(r):this.parseWithoutComments(r)}parseWithoutComments(e){let t=[],r=!0;for(;r;)r=this.parseRow(e,t);return{line:e.line,rows:t}}parseWithComments(e){let{parserOptions:t}=this,r=[];for(let i=e.nextCharacterToken;null!==i;i=e.nextCharacterToken)if(s.Token.isTokenComment(i,t)){if(null===e.advancePastLine()||!e.hasMoreCharacters)return{line:e.lineFromCursor,rows:r};e.truncateToCursor()}else if(!this.parseRow(e,r))break;return{line:e.line,rows:r}}parseRow(e,t){if(!e.nextNonSpaceToken)return!1;let r=this.rowParser.parse(e);return null!==r&&(this.parserOptions.ignoreEmpty&&n.RowParser.isEmptyRow(r)||t.push(r),!0)}}r.Parser=o},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RowParser=void 0;let i=e("./column"),n=e("./Token");r.RowParser=class{constructor(e){this.parserOptions=e,this.columnParser=new i.ColumnParser(e)}static isEmptyRow(e){return""===e.join("").replace(/\s+/g,"")}parse(e){let{parserOptions:t}=this,{hasMoreData:r}=e,i=[],s=this.getStartToken(e,i);for(;s;){if(n.Token.isTokenRowDelimiter(s))return e.advancePastToken(s),!e.hasMoreCharacters&&n.Token.isTokenCarriageReturn(s,t)&&r?null:(e.truncateToCursor(),i);if(!this.shouldSkipColumnParse(e,s,i)){let t=this.columnParser.parse(e);if(null===t)return null;i.push(t)}s=e.nextNonSpaceToken}return r?null:(e.truncateToCursor(),i)}getStartToken(e,t){let r=e.nextNonSpaceToken;return null!==r&&n.Token.isTokenDelimiter(r,this.parserOptions)?(t.push(""),e.nextNonSpaceToken):r}shouldSkipColumnParse(e,t,r){let{parserOptions:i}=this;if(n.Token.isTokenDelimiter(t,i)){e.advancePastToken(t);let s=e.nextCharacterToken;if(!e.hasMoreCharacters||null!==s&&n.Token.isTokenRowDelimiter(s)||null!==s&&n.Token.isTokenDelimiter(s,i))return r.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Scanner=void 0;let i=e("./Token"),n=/((?:\r\n)|\n|\r)/;r.Scanner=class{constructor(e){this.cursor=0,this.line=e.line,this.lineLength=this.line.length,this.parserOptions=e.parserOptions,this.hasMoreData=e.hasMoreData,this.cursor=e.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){let{lineFromCursor:e}=this,t=this.parserOptions.NEXT_TOKEN_REGEXP;if(-1===e.search(t))return null;let r=t.exec(e);if(null==r)return null;let n=r[1],s=this.cursor+(r.index||0);return new i.Token({token:n,startCursor:s,endCursor:s+n.length-1})}get nextCharacterToken(){let{cursor:e,lineLength:t}=this;return t<=e?null:new i.Token({token:this.line[e],startCursor:e,endCursor:e})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){let e=n.exec(this.lineFromCursor);return e?(this.cursor+=(e.index||0)+e[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(e){return this.cursor=e,this}advanceToToken(e){return this.cursor=e.startCursor,this}advancePastToken(e){return this.cursor=e.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Token=void 0,r.Token=class{constructor(e){this.token=e.token,this.startCursor=e.startCursor,this.endCursor=e.endCursor}static isTokenRowDelimiter(e){let t=e.token;return"\r"===t||"\n"===t||"\r\n"===t}static isTokenCarriageReturn(e,t){return e.token===t.carriageReturn}static isTokenComment(e,t){return t.supportsComments&&!!e&&e.token===t.comment}static isTokenEscapeCharacter(e,t){return e.token===t.escapeChar}static isTokenQuote(e,t){return e.token===t.quote}static isTokenDelimiter(e,t){return e.token===t.delimiter}}},{}],160:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColumnFormatter=void 0,r.ColumnFormatter=class{constructor(e){e.trim?this.format=e=>e.trim():e.ltrim?this.format=e=>e.trimLeft():e.rtrim?this.format=e=>e.trimRight():this.format=e=>e}}},{}],161:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColumnParser=void 0;let i=e("./NonQuotedColumnParser"),n=e("./QuotedColumnParser"),s=e("../Token");r.ColumnParser=class{constructor(e){this.parserOptions=e,this.quotedColumnParser=new n.QuotedColumnParser(e),this.nonQuotedColumnParser=new i.NonQuotedColumnParser(e)}parse(e){let{nextNonSpaceToken:t}=e;return null!==t&&s.Token.isTokenQuote(t,this.parserOptions)?(e.advanceToToken(t),this.quotedColumnParser.parse(e)):this.nonQuotedColumnParser.parse(e)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.NonQuotedColumnParser=void 0;let i=e("./ColumnFormatter"),n=e("../Token");r.NonQuotedColumnParser=class{constructor(e){this.parserOptions=e,this.columnFormatter=new i.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let{parserOptions:t}=this,r=[],i=e.nextCharacterToken;for(;i&&!n.Token.isTokenDelimiter(i,t)&&!n.Token.isTokenRowDelimiter(i);i=e.nextCharacterToken)r.push(i.token),e.advancePastToken(i);return this.columnFormatter.format(r.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.QuotedColumnParser=void 0;let i=e("./ColumnFormatter"),n=e("../Token");r.QuotedColumnParser=class{constructor(e){this.parserOptions=e,this.columnFormatter=new i.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let t=e.cursor,{foundClosingQuote:r,col:i}=this.gatherDataBetweenQuotes(e);if(!r){if(e.advanceTo(t),!e.hasMoreData)throw Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${e.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(e),i}gatherDataBetweenQuotes(e){let{parserOptions:t}=this,r=!1,i=!1,s=[],o=e.nextCharacterToken;for(;!i&&null!==o;o=e.nextCharacterToken){let a=n.Token.isTokenQuote(o,t);if(!r&&a)r=!0;else if(r){if(n.Token.isTokenEscapeCharacter(o,t)){e.advancePastToken(o);let r=e.nextCharacterToken;null!==r&&(n.Token.isTokenQuote(r,t)||n.Token.isTokenEscapeCharacter(r,t))?(s.push(r.token),o=r):a?i=!0:s.push(o.token)}else a?i=!0:s.push(o.token)}e.advancePastToken(o)}return{col:this.columnFormatter.format(s.join("")),foundClosingQuote:i}}checkForMalformedColumn(e){let{parserOptions:t}=this,{nextNonSpaceToken:r}=e;if(r){let i=n.Token.isTokenDelimiter(r,t),s=n.Token.isTokenRowDelimiter(r);if(!i&&!s){let i=e.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw Error(`Parse Error: expected: '${t.escapedDelimiter}' OR new line got: '${r.token}'. at '${i}`)}e.advanceToToken(r)}else e.hasMoreData||e.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColumnFormatter=r.QuotedColumnParser=r.NonQuotedColumnParser=r.ColumnParser=void 0;var i=e("./ColumnParser");Object.defineProperty(r,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}});var n=e("./NonQuotedColumnParser");Object.defineProperty(r,"NonQuotedColumnParser",{enumerable:!0,get:function(){return n.NonQuotedColumnParser}});var s=e("./QuotedColumnParser");Object.defineProperty(r,"QuotedColumnParser",{enumerable:!0,get:function(){return s.QuotedColumnParser}});var o=e("./ColumnFormatter");Object.defineProperty(r,"ColumnFormatter",{enumerable:!0,get:function(){return o.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.QuotedColumnParser=r.NonQuotedColumnParser=r.ColumnParser=r.Token=r.Scanner=r.RowParser=r.Parser=void 0;var i=e("./Parser");Object.defineProperty(r,"Parser",{enumerable:!0,get:function(){return i.Parser}});var n=e("./RowParser");Object.defineProperty(r,"RowParser",{enumerable:!0,get:function(){return n.RowParser}});var s=e("./Scanner");Object.defineProperty(r,"Scanner",{enumerable:!0,get:function(){return s.Scanner}});var o=e("./Token");Object.defineProperty(r,"Token",{enumerable:!0,get:function(){return o.Token}});var a=e("./column");Object.defineProperty(r,"ColumnParser",{enumerable:!0,get:function(){return a.ColumnParser}}),Object.defineProperty(r,"NonQuotedColumnParser",{enumerable:!0,get:function(){return a.NonQuotedColumnParser}}),Object.defineProperty(r,"QuotedColumnParser",{enumerable:!0,get:function(){return a.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,t,r){"use strict";var i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.HeaderTransformer=void 0;let n=i(e("lodash.isundefined")),s=i(e("lodash.isfunction")),o=i(e("lodash.uniq")),a=i(e("lodash.groupby"));r.HeaderTransformer=class{constructor(e){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=e,!0===e.headers?this.shouldUseFirstRow=!0:Array.isArray(e.headers)?this.setHeaders(e.headers):s.default(e.headers)&&(this.headersTransform=e.headers)}transform(e,t){return this.shouldMapRow(e)?t(null,this.processRow(e)):t(null,{row:null,isValid:!0})}shouldMapRow(e){let{parserOptions:t}=this;if(!this.headersTransform&&t.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(e)){if(this.headersTransform)this.setHeaders(this.headersTransform(e));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(e)}return!1}return!0}processRow(e){if(!this.headers)return{row:e,isValid:!0};let{parserOptions:t}=this;if(!t.discardUnmappedColumns&&e.length>this.headersLength){if(!t.strictColumnHandling)throw Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${e.length}`);return{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}}return t.strictColumnHandling&&e.length<this.headersLength?{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}:{row:this.mapHeaders(e),isValid:!0}}mapHeaders(e){let t={},{headers:r,headersLength:i}=this;for(let s=0;s<i;s+=1){let i=r[s];if(!n.default(i)){let r=e[s];n.default(r)?t[i]="":t[i]=r}}return t}setHeaders(e){var t;let r=e.filter(e=>!!e);if(o.default(r).length!==r.length){let e=a.default(r);throw Error("Duplicate headers found "+JSON.stringify(Object.keys(e).filter(t=>e[t].length>1)))}this.headers=e,this.receivedHeaders=!0,this.headersLength=(null===(t=this.headers)||void 0===t?void 0:t.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,t,r){"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.RowTransformerValidator=void 0;let n=(i=e("lodash.isfunction"))&&i.__esModule?i:{default:i},s=e("../types");class o{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(e){return s.isSyncTransform(e)?(t,r)=>{let i=null;try{i=e(t)}catch(e){return r(e)}return r(null,i)}:e}static createValidator(e){return s.isSyncValidate(e)?(t,r)=>{r(null,{row:t,isValid:e(t)})}:(t,r)=>{e(t,(e,i,n)=>e?r(e):r(null,i?{row:t,isValid:i,reason:n}:{row:t,isValid:!1,reason:n}))}}set rowTransform(e){if(!n.default(e))throw TypeError("The transform should be a function");this._rowTransform=o.createTransform(e)}set rowValidator(e){if(!n.default(e))throw TypeError("The validate should be a function");this._rowValidator=o.createValidator(e)}transformAndValidate(e,t){return this.callTransformer(e,(e,r)=>e?t(e):r?this.callValidator(r,(e,i)=>e?t(e):i&&!i.isValid?t(null,{row:r,isValid:!1,reason:i.reason}):t(null,{row:r,isValid:!0})):t(null,{row:null,isValid:!0}))}callTransformer(e,t){return this._rowTransform?this._rowTransform(e,t):t(null,e)}callValidator(e,t){return this._rowValidator?this._rowValidator(e,t):t(null,{row:e,isValid:!0})}}r.RowTransformerValidator=o},{"../types":169,"lodash.isfunction":446}],168:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HeaderTransformer=r.RowTransformerValidator=void 0;var i=e("./RowTransformerValidator");Object.defineProperty(r,"RowTransformerValidator",{enumerable:!0,get:function(){return i.RowTransformerValidator}});var n=e("./HeaderTransformer");Object.defineProperty(r,"HeaderTransformer",{enumerable:!0,get:function(){return n.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isSyncValidate=r.isSyncTransform=void 0,r.isSyncTransform=e=>1===e.length,r.isSyncValidate=e=>1===e.length},{}],170:[function(e,t,r){"use strict";r.bignum=e("bn.js"),r.define=e("./asn1/api").define,r.base=e("./asn1/base"),r.constants=e("./asn1/constants"),r.decoders=e("./asn1/decoders"),r.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,t,r){"use strict";let i=e("./encoders"),n=e("./decoders"),s=e("inherits");function o(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}r.define=function(e,t){return new o(e,t)},o.prototype._createNamed=function(e){let t=this.name;function r(e){this._initNamed(e,t)}return s(r,e),r.prototype._initNamed=function(t,r){e.call(this,t,r)},new r(this)},o.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(n[e])),this.decoders[e]},o.prototype.decode=function(e,t,r){return this._getDecoder(t).decode(e,r)},o.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(i[e])),this.encoders[e]},o.prototype.encode=function(e,t,r){return this._getEncoder(t).encode(e,r)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,t,r){"use strict";let i=e("inherits"),n=e("../base/reporter").Reporter,s=e("safer-buffer").Buffer;function o(e,t){n.call(this,t),s.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function a(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return a.isEncoderBuffer(e)||(e=new a(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=s.byteLength(e);else{if(!s.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}i(o,n),r.DecoderBuffer=o,o.isDecoderBuffer=function(e){return e instanceof o||"object"==typeof e&&s.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"==typeof e.offset&&"number"==typeof e.length&&"function"==typeof e.save&&"function"==typeof e.restore&&"function"==typeof e.isEmpty&&"function"==typeof e.readUInt8&&"function"==typeof e.skip&&"function"==typeof e.raw},o.prototype.save=function(){return{offset:this.offset,reporter:n.prototype.save.call(this)}},o.prototype.restore=function(e){let t=new o(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,n.prototype.restore.call(this,e.reporter),t},o.prototype.isEmpty=function(){return this.offset===this.length},o.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},o.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");let r=new o(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},o.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},r.EncoderBuffer=a,a.isEncoderBuffer=function(e){return e instanceof a||"object"==typeof e&&"EncoderBuffer"===e.constructor.name&&"number"==typeof e.length&&"function"==typeof e.join},a.prototype.join=function(e,t){return e||(e=s.alloc(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach(function(r){r.join(e,t),t+=r.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):s.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,t,r){"use strict";r.Reporter=e("./reporter").Reporter,r.DecoderBuffer=e("./buffer").DecoderBuffer,r.EncoderBuffer=e("./buffer").EncoderBuffer,r.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,t,r){"use strict";let i=e("../base/reporter").Reporter,n=e("../base/buffer").EncoderBuffer,s=e("../base/buffer").DecoderBuffer,o=e("minimalistic-assert"),a=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],l=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(a);function h(e,t,r){let i={};this._baseState=i,i.name=r,i.enc=e,i.parent=t||null,i.children=null,i.tag=null,i.args=null,i.reverseArgs=null,i.choice=null,i.optional=!1,i.any=!1,i.obj=!1,i.use=null,i.useDecoder=null,i.key=null,i.default=null,i.explicit=null,i.implicit=null,i.contains=null,i.parent||(i.children=[],this._wrap())}t.exports=h;let u=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];h.prototype.clone=function(){let e=this._baseState,t={};u.forEach(function(r){t[r]=e[r]});let r=new this.constructor(t.parent);return r._baseState=t,r},h.prototype._wrap=function(){let e=this._baseState;l.forEach(function(t){this[t]=function(){let r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}},this)},h.prototype._init=function(e){let t=this._baseState;o(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),o.equal(t.children.length,1,"Root node can have only one child")},h.prototype._useArgs=function(e){let t=this._baseState,r=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==r.length&&(o(null===t.children),t.children=r,r.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(o(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;let t={};return Object.keys(e).forEach(function(r){r==(0|r)&&(r|=0),t[e[r]]=r}),t}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(e){h.prototype[e]=function(){throw Error(e+" not implemented for encoding: "+this._baseState.enc)}}),a.forEach(function(e){h.prototype[e]=function(){let t=this._baseState,r=Array.prototype.slice.call(arguments);return o(null===t.tag),t.tag=e,this._useArgs(r),this}}),h.prototype.use=function(e){o(e);let t=this._baseState;return o(null===t.use),t.use=e,this},h.prototype.optional=function(){return this._baseState.optional=!0,this},h.prototype.def=function(e){let t=this._baseState;return o(null===t.default),t.default=e,t.optional=!0,this},h.prototype.explicit=function(e){let t=this._baseState;return o(null===t.explicit&&null===t.implicit),t.explicit=e,this},h.prototype.implicit=function(e){let t=this._baseState;return o(null===t.explicit&&null===t.implicit),t.implicit=e,this},h.prototype.obj=function(){let e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},h.prototype.key=function(e){let t=this._baseState;return o(null===t.key),t.key=e,this},h.prototype.any=function(){return this._baseState.any=!0,this},h.prototype.choice=function(e){let t=this._baseState;return o(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},h.prototype.contains=function(e){let t=this._baseState;return o(null===t.use),t.contains=e,this},h.prototype._decode=function(e,t){let r=this._baseState;if(null===r.parent)return e.wrapResult(r.children[0]._decode(e,t));let i,n=r.default,o=!0,a=null;if(null!==r.key&&(a=e.enterKey(r.key)),r.optional){let i=null;if(null!==r.explicit?i=r.explicit:null!==r.implicit?i=r.implicit:null!==r.tag&&(i=r.tag),null!==i||r.any){if(o=this._peekTag(e,i,r.any),e.isError(o))return o}else{let i=e.save();try{null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),o=!0}catch(e){o=!1}e.restore(i)}}if(r.obj&&o&&(i=e.enterObject()),o){if(null!==r.explicit){let t=this._decodeTag(e,r.explicit);if(e.isError(t))return t;e=t}let i=e.offset;if(null===r.use&&null===r.choice){let t;r.any&&(t=e.save());let i=this._decodeTag(e,null!==r.implicit?r.implicit:r.tag,r.any);if(e.isError(i))return i;r.any?n=e.raw(t):e=i}if(t&&t.track&&null!==r.tag&&t.track(e.path(),i,e.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(e.path(),e.offset,e.length,"content"),r.any||(n=null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t)),e.isError(n))return n;if(r.any||null!==r.choice||null===r.children||r.children.forEach(function(r){r._decode(e,t)}),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){let i=new s(n);n=this._getUse(r.contains,e._reporterState.obj)._decode(i,t)}}return r.obj&&o&&(n=e.leaveObject(i)),null===r.key||null===n&&!0!==o?null!==a&&e.exitKey(a):e.leaveKey(a,r.key,n),n},h.prototype._decodeGeneric=function(e,t,r){let i=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,i.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&i.args?this._decodeObjid(t,i.args[0],i.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,i.args&&i.args[0],r):null!==i.use?this._getUse(i.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},h.prototype._getUse=function(e,t){let r=this._baseState;return r.useDecoder=this._use(e,t),o(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},h.prototype._decodeChoice=function(e,t){let r=this._baseState,i=null,n=!1;return Object.keys(r.choice).some(function(s){let o=e.save(),a=r.choice[s];try{let r=a._decode(e,t);if(e.isError(r))return!1;i={type:s,value:r},n=!0}catch(t){return e.restore(o),!1}return!0},this),n?i:e.error("Choice not matched")},h.prototype._createEncoderBuffer=function(e){return new n(e,this.reporter)},h.prototype._encode=function(e,t,r){let i=this._baseState;if(null!==i.default&&i.default===e)return;let n=this._encodeValue(e,t,r);return void 0===n||this._skipDefault(n,t,r)?void 0:n},h.prototype._encodeValue=function(e,t,r){let n=this._baseState;if(null===n.parent)return n.children[0]._encode(e,t||new i);let s=null;if(this.reporter=t,n.optional&&void 0===e){if(null===n.default)return;e=n.default}let o=null,a=!1;if(n.any)s=this._createEncoderBuffer(e);else if(n.choice)s=this._encodeChoice(e,t);else if(n.contains)o=this._getUse(n.contains,r)._encode(e,t),a=!0;else if(n.children)o=n.children.map(function(r){if("null_"===r._baseState.tag)return r._encode(null,t,e);if(null===r._baseState.key)return t.error("Child should have a key");let i=t.enterKey(r._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");let n=r._encode(e[r._baseState.key],t,e);return t.leaveKey(i),n},this).filter(function(e){return e}),o=this._createEncoderBuffer(o);else if("seqof"===n.tag||"setof"===n.tag){if(!n.args||1!==n.args.length)return t.error("Too many args for : "+n.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");let r=this.clone();r._baseState.implicit=null,o=this._createEncoderBuffer(e.map(function(r){let i=this._baseState;return this._getUse(i.args[0],e)._encode(r,t)},r))}else null!==n.use?s=this._getUse(n.use,r)._encode(e,t):(o=this._encodePrimitive(n.tag,e),a=!0);if(!n.any&&null===n.choice){let e=null!==n.implicit?n.implicit:n.tag,r=null===n.implicit?"universal":"context";null===e?null===n.use&&t.error("Tag could be omitted only for .use()"):null===n.use&&(s=this._encodeComposite(e,a,r,o))}return null!==n.explicit&&(s=this._encodeComposite(n.explicit,!1,"context",s)),s},h.prototype._encodeChoice=function(e,t){let r=this._baseState,i=r.choice[e.type];return i||o(!1,e.type+" not found in "+JSON.stringify(Object.keys(r.choice))),i._encode(e.value,t)},h.prototype._encodePrimitive=function(e,t){let r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw Error("Unsupported tag: "+e)},h.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},h.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,t,r){"use strict";let i=e("inherits");function n(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function s(e,t){this.path=e,this.rethrow(t)}r.Reporter=n,n.prototype.isError=function(e){return e instanceof s},n.prototype.save=function(){let e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},n.prototype.restore=function(e){let t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},n.prototype.enterKey=function(e){return this._reporterState.path.push(e)},n.prototype.exitKey=function(e){let t=this._reporterState;t.path=t.path.slice(0,e-1)},n.prototype.leaveKey=function(e,t,r){let i=this._reporterState;this.exitKey(e),null!==i.obj&&(i.obj[t]=r)},n.prototype.path=function(){return this._reporterState.path.join("/")},n.prototype.enterObject=function(){let e=this._reporterState,t=e.obj;return e.obj={},t},n.prototype.leaveObject=function(e){let t=this._reporterState,r=t.obj;return t.obj=e,r},n.prototype.error=function(e){let t;let r=this._reporterState,i=e instanceof s;if(t=i?e:new s(r.path.map(function(e){return"["+JSON.stringify(e)+"]"}).join(""),e.message||e,e.stack),!r.options.partial)throw t;return i||r.errors.push(t),t},n.prototype.wrapResult=function(e){let t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},i(s,Error),s.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,s),!this.stack)try{throw Error(this.message)}catch(e){this.stack=e.stack}return this}},{inherits:440}],176:[function(e,t,r){"use strict";function i(e){let t={};return Object.keys(e).forEach(function(r){(0|r)==r&&(r|=0),t[e[r]]=r}),t}r.tagClass={0:"universal",1:"application",2:"context",3:"private"},r.tagClassByName=i(r.tagClass),r.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},r.tagByName=i(r.tag)},{}],177:[function(e,t,r){"use strict";r._reverse=function(e){let t={};return Object.keys(e).forEach(function(r){(0|r)==r&&(r|=0),t[e[r]]=r}),t},r.der=e("./der")},{"./der":176}],178:[function(e,t,r){"use strict";let i=e("inherits"),n=e("bn.js"),s=e("../base/buffer").DecoderBuffer,o=e("../base/node"),a=e("../constants/der");function l(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new h,this.tree._init(e.body)}function h(e){o.call(this,"der",e)}function u(e,t){let r=e.readUInt8(t);if(e.isError(r))return r;let i=a.tagClass[r>>6],n=0==(32&r);if(31==(31&r)){let i=r;for(r=0;128==(128&i);){if(i=e.readUInt8(t),e.isError(i))return i;r<<=7,r|=127&i}}else r&=31;return{cls:i,primitive:n,tag:r,tagStr:a.tag[r]}}function c(e,t,r){let i=e.readUInt8(r);if(e.isError(i))return i;if(!t&&128===i)return null;if(0==(128&i))return i;let n=127&i;if(n>4)return e.error("length octect is too long");i=0;for(let t=0;t<n;t++){i<<=8;let t=e.readUInt8(r);if(e.isError(t))return t;i|=t}return i}t.exports=l,l.prototype.decode=function(e,t){return s.isDecoderBuffer(e)||(e=new s(e,t)),this.tree._decode(e,t)},i(h,o),h.prototype._peekTag=function(e,t,r){if(e.isEmpty())return!1;let i=e.save(),n=u(e,'Failed to peek tag: "'+t+'"');return e.isError(n)?n:(e.restore(i),n.tag===t||n.tagStr===t||n.tagStr+"of"===t||r)},h.prototype._decodeTag=function(e,t,r){let i=u(e,'Failed to decode tag of "'+t+'"');if(e.isError(i))return i;let n=c(e,i.primitive,'Failed to get length of "'+t+'"');if(e.isError(n))return n;if(!r&&i.tag!==t&&i.tagStr!==t&&i.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(i.primitive||null!==n)return e.skip(n,'Failed to match body of: "'+t+'"');let s=e.save(),o=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(o)?o:(n=e.offset-s.offset,e.restore(s),e.skip(n,'Failed to match body of: "'+t+'"'))},h.prototype._skipUntilEnd=function(e,t){for(;;){let r;let i=u(e,t);if(e.isError(i))return i;let n=c(e,i.primitive,t);if(e.isError(n))return n;if(r=i.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(r))return r;if("end"===i.tagStr)break}},h.prototype._decodeList=function(e,t,r,i){let n=[];for(;!e.isEmpty();){let t=this._peekTag(e,"end");if(e.isError(t))return t;let s=r.decode(e,"der",i);if(e.isError(s)&&t)break;n.push(s)}return n},h.prototype._decodeStr=function(e,t){if("bitstr"===t){let t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}if("bmpstr"===t){let t=e.raw();if(t.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");let r="";for(let e=0;e<t.length/2;e++)r+=String.fromCharCode(t.readUInt16BE(2*e));return r}if("numstr"===t){let t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t||"objDesc"===t)return e.raw();if("printstr"===t){let t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},h.prototype._decodeObjid=function(e,t,r){let i;let n=[],s=0,o=0;for(;!e.isEmpty();)o=e.readUInt8(),s<<=7,s|=127&o,0==(128&o)&&(n.push(s),s=0);128&o&&n.push(s);let a=n[0]/40|0,l=n[0]%40;if(i=r?n:[a,l].concat(n.slice(1)),t){let e=t[i.join(" ")];void 0===e&&(e=t[i.join(".")]),void 0!==e&&(i=e)}return i},h.prototype._decodeTime=function(e,t){let r,i,n,s,o,a;let l=e.raw().toString();if("gentime"===t)r=0|l.slice(0,4),i=0|l.slice(4,6),n=0|l.slice(6,8),s=0|l.slice(8,10),o=0|l.slice(10,12),a=0|l.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");r=0|l.slice(0,2),i=0|l.slice(2,4),n=0|l.slice(4,6),s=0|l.slice(6,8),o=0|l.slice(8,10),a=0|l.slice(10,12),r=r<70?2e3+r:1900+r}return Date.UTC(r,i-1,n,s,o,a,0)},h.prototype._decodeNull=function(){return null},h.prototype._decodeBool=function(e){let t=e.readUInt8();return e.isError(t)?t:0!==t},h.prototype._decodeInt=function(e,t){let r=new n(e.raw());return t&&(r=t[r.toString(10)]||r),r},h.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,t,r){"use strict";r.der=e("./der"),r.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,t,r){"use strict";let i=e("inherits"),n=e("safer-buffer").Buffer,s=e("./der");function o(e){s.call(this,e),this.enc="pem"}i(o,s),t.exports=o,o.prototype.decode=function(e,t){let r=e.toString().split(/[\r\n]+/g),i=t.label.toUpperCase(),o=/^-----(BEGIN|END) ([^-]+)-----$/,a=-1,l=-1;for(let e=0;e<r.length;e++){let t=r[e].match(o);if(null!==t&&t[2]===i){if(-1!==a){if("END"!==t[1])break;l=e;break}if("BEGIN"!==t[1])break;a=e}}if(-1===a||-1===l)throw Error("PEM section not found for: "+i);let h=r.slice(a+1,l).join("");h.replace(/[^a-z0-9+/=]+/gi,"");let u=n.from(h,"base64");return s.prototype.decode.call(this,u,t)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,t,r){"use strict";let i=e("inherits"),n=e("safer-buffer").Buffer,s=e("../base/node"),o=e("../constants/der");function a(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new l,this.tree._init(e.body)}function l(e){s.call(this,"der",e)}function h(e){return e<10?"0"+e:e}t.exports=a,a.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},i(l,s),l.prototype._encodeComposite=function(e,t,r,i){let s=function(e,t,r,i){let n;if("seqof"===e?e="seq":"setof"===e&&(e="set"),o.tagByName.hasOwnProperty(e))n=o.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return i.error("Unknown tag: "+e);n=e}return n>=31?i.error("Multi-octet tag encoding unsupported"):(t||(n|=32),n|o.tagClassByName[r||"universal"]<<6)}(e,t,r,this.reporter);if(i.length<128){let e=n.alloc(2);return e[0]=s,e[1]=i.length,this._createEncoderBuffer([e,i])}let a=1;for(let e=i.length;e>=256;e>>=8)a++;let l=n.alloc(2+a);l[0]=s,l[1]=128|a;for(let e=1+a,t=i.length;t>0;e--,t>>=8)l[e]=255&t;return this._createEncoderBuffer([l,i])},l.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){let t=n.alloc(2*e.length);for(let r=0;r<e.length;r++)t.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},l.prototype._encodeObjid=function(e,t,r){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!r){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let i=0;for(let t=0;t<e.length;t++){let r=e[t];for(i++;r>=128;r>>=7)i++}let s=n.alloc(i),o=s.length-1;for(let t=e.length-1;t>=0;t--){let r=e[t];for(s[o--]=127&r;(r>>=7)>0;)s[o--]=128|127&r}return this._createEncoderBuffer(s)},l.prototype._encodeTime=function(e,t){let r;let i=new Date(e);return"gentime"===t?r=[h(i.getUTCFullYear()),h(i.getUTCMonth()+1),h(i.getUTCDate()),h(i.getUTCHours()),h(i.getUTCMinutes()),h(i.getUTCSeconds()),"Z"].join(""):"utctime"===t?r=[h(i.getUTCFullYear()%100),h(i.getUTCMonth()+1),h(i.getUTCDate()),h(i.getUTCHours()),h(i.getUTCMinutes()),h(i.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(r,"octstr")},l.prototype._encodeNull=function(){return this._createEncoderBuffer("")},l.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!n.isBuffer(e)){let t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=n.from(t)}if(n.isBuffer(e)){let t=e.length;0===e.length&&t++;let r=n.alloc(t);return e.copy(r),0===e.length&&(r[0]=0),this._createEncoderBuffer(r)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let r=1;for(let t=e;t>=256;t>>=8)r++;let i=Array(r);for(let t=i.length-1;t>=0;t--)i[t]=255&e,e>>=8;return 128&i[0]&&i.unshift(0),this._createEncoderBuffer(n.from(i))},l.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},l.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},l.prototype._skipDefault=function(e,t,r){let i;let n=this._baseState;if(null===n.default)return!1;let s=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n.default,t,r).join()),s.length!==n.defaultBuffer.length)return!1;for(i=0;i<s.length;i++)if(s[i]!==n.defaultBuffer[i])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,t,r){"use strict";r.der=e("./der"),r.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,t,r){"use strict";let i=e("inherits"),n=e("./der");function s(e){n.call(this,e),this.enc="pem"}i(s,n),t.exports=s,s.prototype.encode=function(e,t){let r=n.prototype.encode.call(this,e).toString("base64"),i=["-----BEGIN "+t.label+"-----"];for(let e=0;e<r.length;e+=64)i.push(r.slice(e,e+64));return i.push("-----END "+t.label+"-----"),i.join("\n")}},{"./der":181,inherits:440}],184:[function(e,t,r){"use strict";!function(t,r){function i(e,t){if(!e)throw Error(t||"Assertion failed")}function n(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}"object"==typeof t?t.exports=s:(void 0).BN=s,s.BN=s,s.wordSize=26;try{h="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function o(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function a(e,t,r){var i=o(e,r);return r-1>=t&&(i|=o(e,r-1)<<4),i}function l(e,t,r,i){for(var n=0,s=Math.min(e.length,r),o=t;o<s;o++){var a=e.charCodeAt(o)-48;n*=i,n+=a>=49?a-49+10:a>=17?a-17+10:a}return n}s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return 0>e.cmp(t)?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),i(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<e.length&&(16===t?this._parseHex(e,n,r):(this._parseBase(e,t,n),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<0x4000000?(this.words=[0x3ffffff&e],this.length=1):e<0x10000000000000?(this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff],this.length=2):(i(e<0x20000000000000),this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(i("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,o,a=0;if("be"===r)for(n=e.length-1,s=0;n>=0;n-=3)o=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[s]|=o<<a&0x3ffffff,this.words[s+1]=o>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(n=0,s=0;n<e.length;n+=3)o=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[s]|=o<<a&0x3ffffff,this.words[s+1]=o>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);return this.strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s=0,o=0;if("be"===r)for(i=e.length-1;i>=t;i-=2)n=a(e,t,i)<<s,this.words[o]|=0x3ffffff&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;else for(i=(e.length-t)%2==0?t+1:t;i<e.length;i+=2)n=a(e,t,i)<<s,this.words[o]|=0x3ffffff&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;this.strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var i=0,n=1;n<=0x3ffffff;n*=t)i++;i--,n=n/t|0;for(var s=e.length-r,o=s%i,a=Math.min(s,s-o)+r,h=0,u=r;u<a;u+=i)h=l(e,u,u+i,t),this.imuln(n),this.words[0]+h<0x4000000?this.words[0]+=h:this._iaddn(h);if(0!==o){var c=1;for(h=l(e,u,e.length,t),u=0;u<o;u++)c*=t;this.imuln(c),this.words[0]+h<0x4000000?this.words[0]+=h:this._iaddn(h)}this.strip()},s.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h,u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,0x2000000,0x290d741,0x1000000,0x2e90edd,0x39aa400,0x267bf47,0x1000000,0x290d741,1e7,0x12959c3,0x222c000,0x3bd7765,7529536,0xadcea1,0x1000000,0x1704f61,0x206fc40,0x2cddcf9,64e6,4084101,5153632,6436343,7962624,9765625,0xb54ba0,0xdaf26b,0x1069c00,0x138f9ad,243e5,0x1b4d89f,0x2000000,0x25528a1,0x2b54a20,0x3216b93,0x39aa400];function f(e,t,r){r.negative=t.negative^e.negative;var i=e.length+t.length|0;r.length=i,i=i-1|0;var n=0|e.words[0],s=0|t.words[0],o=n*s,a=0x3ffffff&o,l=o/0x4000000|0;r.words[0]=a;for(var h=1;h<i;h++){for(var u=l>>>26,c=0x3ffffff&l,d=Math.min(h,t.length-1),f=Math.max(0,h-e.length+1);f<=d;f++){var p=h-f|0;u+=(o=(n=0|e.words[p])*(s=0|t.words[f])+c)/0x4000000|0,c=0x3ffffff&o}r.words[h]=0|c,l=0|u}return 0!==l?r.words[h]=0|l:r.length--,r.strip()}s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var n=0,s=0,o=0;o<this.length;o++){var a=this.words[o],l=(0xffffff&(a<<n|s)).toString(16);r=0!=(s=a>>>24-n&0xffffff)||o!==this.length-1?u[6-l.length]+l+r:l+r,(n+=2)>=26&&(n-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var h=c[e],f=d[e];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var g=p.modn(f).toString(e);r=(p=p.idivn(f)).isZero()?g+r:u[h-g.length]+g+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=0x4000000*this.words[1]:3===this.length&&1===this.words[2]?e+=0x10000000000000+0x4000000*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(e,t){return i(void 0!==h),this.toArrayLike(h,e,t)},s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,r){var n=this.byteLength(),s=r||Math.max(1,n);i(n<=s,"byte array longer than desired length"),i(s>0,"Requested array length <= 0"),this.strip();var o,a,l=new e(s),h=this.clone();if("le"===t){for(a=0;!h.isZero();a++)o=h.andln(255),h.iushrn(8),l[a]=o;for(;a<s;a++)l[a]=0}else{for(a=0;a<s-n;a++)l[a]=0;for(a=0;!h.isZero();a++)o=h.andln(255),h.iushrn(8),l[s-a-1]=o}return l},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},s.prototype.ior=function(e){return i(0==(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},s.prototype.iand=function(e){return i(0==(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var i=0;i<r.length;i++)this.words[i]=t.words[i]^r.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this.strip()},s.prototype.ixor=function(e){return i(0==(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){i("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var n=0;n<t;n++)this.words[n]=0x3ffffff&~this.words[n];return r>0&&(this.words[n]=~this.words[n]&0x3ffffff>>26-r),this.strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){i("number"==typeof e&&e>=0);var r=e/26|0,n=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<n:this.words[r]&~(1<<n),this.strip()},s.prototype.iadd=function(e){var t,r,i;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,i=e):(r=e,i=this);for(var n=0,s=0;s<i.length;s++)t=(0|r.words[s])+(0|i.words[s])+n,this.words[s]=0x3ffffff&t,n=t>>>26;for(;0!==n&&s<r.length;s++)t=(0|r.words[s])+n,this.words[s]=0x3ffffff&t,n=t>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,i,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,i=e):(r=e,i=this);for(var s=0,o=0;o<i.length;o++)s=(t=(0|r.words[o])-(0|i.words[o])+s)>>26,this.words[o]=0x3ffffff&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=0x3ffffff&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,r){var i,n,s,o=e.words,a=t.words,l=r.words,h=0,u=0|o[0],c=8191&u,d=u>>>13,f=0|o[1],p=8191&f,g=f>>>13,m=0|o[2],v=8191&m,b=m>>>13,y=0|o[3],x=8191&y,_=y>>>13,S=0|o[4],w=8191&S,T=S>>>13,P=0|o[5],E=8191&P,C=P>>>13,A=0|o[6],I=8191&A,M=A>>>13,R=0|o[7],O=8191&R,k=R>>>13,N=0|o[8],L=8191&N,D=N>>>13,B=0|o[9],F=8191&B,V=B>>>13,G=0|a[0],U=8191&G,z=G>>>13,j=0|a[1],H=8191&j,W=j>>>13,q=0|a[2],X=8191&q,$=q>>>13,Y=0|a[3],Z=8191&Y,K=Y>>>13,J=0|a[4],Q=8191&J,ee=J>>>13,et=0|a[5],er=8191&et,ei=et>>>13,en=0|a[6],es=8191&en,eo=en>>>13,ea=0|a[7],el=8191&ea,eh=ea>>>13,eu=0|a[8],ec=8191&eu,ed=eu>>>13,ef=0|a[9],ep=8191&ef,eg=ef>>>13;r.negative=e.negative^t.negative,r.length=19;var em=(h+(i=Math.imul(c,U))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(d,U)|0))<<13)|0;h=((s=Math.imul(d,z))+(n>>>13)|0)+(em>>>26)|0,em&=0x3ffffff,i=Math.imul(p,U),n=(n=Math.imul(p,z))+Math.imul(g,U)|0,s=Math.imul(g,z);var ev=(h+(i=i+Math.imul(c,H)|0)|0)+((8191&(n=(n=n+Math.imul(c,W)|0)+Math.imul(d,H)|0))<<13)|0;h=((s=s+Math.imul(d,W)|0)+(n>>>13)|0)+(ev>>>26)|0,ev&=0x3ffffff,i=Math.imul(v,U),n=(n=Math.imul(v,z))+Math.imul(b,U)|0,s=Math.imul(b,z),i=i+Math.imul(p,H)|0,n=(n=n+Math.imul(p,W)|0)+Math.imul(g,H)|0,s=s+Math.imul(g,W)|0;var eb=(h+(i=i+Math.imul(c,X)|0)|0)+((8191&(n=(n=n+Math.imul(c,$)|0)+Math.imul(d,X)|0))<<13)|0;h=((s=s+Math.imul(d,$)|0)+(n>>>13)|0)+(eb>>>26)|0,eb&=0x3ffffff,i=Math.imul(x,U),n=(n=Math.imul(x,z))+Math.imul(_,U)|0,s=Math.imul(_,z),i=i+Math.imul(v,H)|0,n=(n=n+Math.imul(v,W)|0)+Math.imul(b,H)|0,s=s+Math.imul(b,W)|0,i=i+Math.imul(p,X)|0,n=(n=n+Math.imul(p,$)|0)+Math.imul(g,X)|0,s=s+Math.imul(g,$)|0;var ey=(h+(i=i+Math.imul(c,Z)|0)|0)+((8191&(n=(n=n+Math.imul(c,K)|0)+Math.imul(d,Z)|0))<<13)|0;h=((s=s+Math.imul(d,K)|0)+(n>>>13)|0)+(ey>>>26)|0,ey&=0x3ffffff,i=Math.imul(w,U),n=(n=Math.imul(w,z))+Math.imul(T,U)|0,s=Math.imul(T,z),i=i+Math.imul(x,H)|0,n=(n=n+Math.imul(x,W)|0)+Math.imul(_,H)|0,s=s+Math.imul(_,W)|0,i=i+Math.imul(v,X)|0,n=(n=n+Math.imul(v,$)|0)+Math.imul(b,X)|0,s=s+Math.imul(b,$)|0,i=i+Math.imul(p,Z)|0,n=(n=n+Math.imul(p,K)|0)+Math.imul(g,Z)|0,s=s+Math.imul(g,K)|0;var ex=(h+(i=i+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(d,Q)|0))<<13)|0;h=((s=s+Math.imul(d,ee)|0)+(n>>>13)|0)+(ex>>>26)|0,ex&=0x3ffffff,i=Math.imul(E,U),n=(n=Math.imul(E,z))+Math.imul(C,U)|0,s=Math.imul(C,z),i=i+Math.imul(w,H)|0,n=(n=n+Math.imul(w,W)|0)+Math.imul(T,H)|0,s=s+Math.imul(T,W)|0,i=i+Math.imul(x,X)|0,n=(n=n+Math.imul(x,$)|0)+Math.imul(_,X)|0,s=s+Math.imul(_,$)|0,i=i+Math.imul(v,Z)|0,n=(n=n+Math.imul(v,K)|0)+Math.imul(b,Z)|0,s=s+Math.imul(b,K)|0,i=i+Math.imul(p,Q)|0,n=(n=n+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,s=s+Math.imul(g,ee)|0;var e_=(h+(i=i+Math.imul(c,er)|0)|0)+((8191&(n=(n=n+Math.imul(c,ei)|0)+Math.imul(d,er)|0))<<13)|0;h=((s=s+Math.imul(d,ei)|0)+(n>>>13)|0)+(e_>>>26)|0,e_&=0x3ffffff,i=Math.imul(I,U),n=(n=Math.imul(I,z))+Math.imul(M,U)|0,s=Math.imul(M,z),i=i+Math.imul(E,H)|0,n=(n=n+Math.imul(E,W)|0)+Math.imul(C,H)|0,s=s+Math.imul(C,W)|0,i=i+Math.imul(w,X)|0,n=(n=n+Math.imul(w,$)|0)+Math.imul(T,X)|0,s=s+Math.imul(T,$)|0,i=i+Math.imul(x,Z)|0,n=(n=n+Math.imul(x,K)|0)+Math.imul(_,Z)|0,s=s+Math.imul(_,K)|0,i=i+Math.imul(v,Q)|0,n=(n=n+Math.imul(v,ee)|0)+Math.imul(b,Q)|0,s=s+Math.imul(b,ee)|0,i=i+Math.imul(p,er)|0,n=(n=n+Math.imul(p,ei)|0)+Math.imul(g,er)|0,s=s+Math.imul(g,ei)|0;var eS=(h+(i=i+Math.imul(c,es)|0)|0)+((8191&(n=(n=n+Math.imul(c,eo)|0)+Math.imul(d,es)|0))<<13)|0;h=((s=s+Math.imul(d,eo)|0)+(n>>>13)|0)+(eS>>>26)|0,eS&=0x3ffffff,i=Math.imul(O,U),n=(n=Math.imul(O,z))+Math.imul(k,U)|0,s=Math.imul(k,z),i=i+Math.imul(I,H)|0,n=(n=n+Math.imul(I,W)|0)+Math.imul(M,H)|0,s=s+Math.imul(M,W)|0,i=i+Math.imul(E,X)|0,n=(n=n+Math.imul(E,$)|0)+Math.imul(C,X)|0,s=s+Math.imul(C,$)|0,i=i+Math.imul(w,Z)|0,n=(n=n+Math.imul(w,K)|0)+Math.imul(T,Z)|0,s=s+Math.imul(T,K)|0,i=i+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,ee)|0,i=i+Math.imul(v,er)|0,n=(n=n+Math.imul(v,ei)|0)+Math.imul(b,er)|0,s=s+Math.imul(b,ei)|0,i=i+Math.imul(p,es)|0,n=(n=n+Math.imul(p,eo)|0)+Math.imul(g,es)|0,s=s+Math.imul(g,eo)|0;var ew=(h+(i=i+Math.imul(c,el)|0)|0)+((8191&(n=(n=n+Math.imul(c,eh)|0)+Math.imul(d,el)|0))<<13)|0;h=((s=s+Math.imul(d,eh)|0)+(n>>>13)|0)+(ew>>>26)|0,ew&=0x3ffffff,i=Math.imul(L,U),n=(n=Math.imul(L,z))+Math.imul(D,U)|0,s=Math.imul(D,z),i=i+Math.imul(O,H)|0,n=(n=n+Math.imul(O,W)|0)+Math.imul(k,H)|0,s=s+Math.imul(k,W)|0,i=i+Math.imul(I,X)|0,n=(n=n+Math.imul(I,$)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,$)|0,i=i+Math.imul(E,Z)|0,n=(n=n+Math.imul(E,K)|0)+Math.imul(C,Z)|0,s=s+Math.imul(C,K)|0,i=i+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,ee)|0,i=i+Math.imul(x,er)|0,n=(n=n+Math.imul(x,ei)|0)+Math.imul(_,er)|0,s=s+Math.imul(_,ei)|0,i=i+Math.imul(v,es)|0,n=(n=n+Math.imul(v,eo)|0)+Math.imul(b,es)|0,s=s+Math.imul(b,eo)|0,i=i+Math.imul(p,el)|0,n=(n=n+Math.imul(p,eh)|0)+Math.imul(g,el)|0,s=s+Math.imul(g,eh)|0;var eT=(h+(i=i+Math.imul(c,ec)|0)|0)+((8191&(n=(n=n+Math.imul(c,ed)|0)+Math.imul(d,ec)|0))<<13)|0;h=((s=s+Math.imul(d,ed)|0)+(n>>>13)|0)+(eT>>>26)|0,eT&=0x3ffffff,i=Math.imul(F,U),n=(n=Math.imul(F,z))+Math.imul(V,U)|0,s=Math.imul(V,z),i=i+Math.imul(L,H)|0,n=(n=n+Math.imul(L,W)|0)+Math.imul(D,H)|0,s=s+Math.imul(D,W)|0,i=i+Math.imul(O,X)|0,n=(n=n+Math.imul(O,$)|0)+Math.imul(k,X)|0,s=s+Math.imul(k,$)|0,i=i+Math.imul(I,Z)|0,n=(n=n+Math.imul(I,K)|0)+Math.imul(M,Z)|0,s=s+Math.imul(M,K)|0,i=i+Math.imul(E,Q)|0,n=(n=n+Math.imul(E,ee)|0)+Math.imul(C,Q)|0,s=s+Math.imul(C,ee)|0,i=i+Math.imul(w,er)|0,n=(n=n+Math.imul(w,ei)|0)+Math.imul(T,er)|0,s=s+Math.imul(T,ei)|0,i=i+Math.imul(x,es)|0,n=(n=n+Math.imul(x,eo)|0)+Math.imul(_,es)|0,s=s+Math.imul(_,eo)|0,i=i+Math.imul(v,el)|0,n=(n=n+Math.imul(v,eh)|0)+Math.imul(b,el)|0,s=s+Math.imul(b,eh)|0,i=i+Math.imul(p,ec)|0,n=(n=n+Math.imul(p,ed)|0)+Math.imul(g,ec)|0,s=s+Math.imul(g,ed)|0;var eP=(h+(i=i+Math.imul(c,ep)|0)|0)+((8191&(n=(n=n+Math.imul(c,eg)|0)+Math.imul(d,ep)|0))<<13)|0;h=((s=s+Math.imul(d,eg)|0)+(n>>>13)|0)+(eP>>>26)|0,eP&=0x3ffffff,i=Math.imul(F,H),n=(n=Math.imul(F,W))+Math.imul(V,H)|0,s=Math.imul(V,W),i=i+Math.imul(L,X)|0,n=(n=n+Math.imul(L,$)|0)+Math.imul(D,X)|0,s=s+Math.imul(D,$)|0,i=i+Math.imul(O,Z)|0,n=(n=n+Math.imul(O,K)|0)+Math.imul(k,Z)|0,s=s+Math.imul(k,K)|0,i=i+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,ee)|0,i=i+Math.imul(E,er)|0,n=(n=n+Math.imul(E,ei)|0)+Math.imul(C,er)|0,s=s+Math.imul(C,ei)|0,i=i+Math.imul(w,es)|0,n=(n=n+Math.imul(w,eo)|0)+Math.imul(T,es)|0,s=s+Math.imul(T,eo)|0,i=i+Math.imul(x,el)|0,n=(n=n+Math.imul(x,eh)|0)+Math.imul(_,el)|0,s=s+Math.imul(_,eh)|0,i=i+Math.imul(v,ec)|0,n=(n=n+Math.imul(v,ed)|0)+Math.imul(b,ec)|0,s=s+Math.imul(b,ed)|0;var eE=(h+(i=i+Math.imul(p,ep)|0)|0)+((8191&(n=(n=n+Math.imul(p,eg)|0)+Math.imul(g,ep)|0))<<13)|0;h=((s=s+Math.imul(g,eg)|0)+(n>>>13)|0)+(eE>>>26)|0,eE&=0x3ffffff,i=Math.imul(F,X),n=(n=Math.imul(F,$))+Math.imul(V,X)|0,s=Math.imul(V,$),i=i+Math.imul(L,Z)|0,n=(n=n+Math.imul(L,K)|0)+Math.imul(D,Z)|0,s=s+Math.imul(D,K)|0,i=i+Math.imul(O,Q)|0,n=(n=n+Math.imul(O,ee)|0)+Math.imul(k,Q)|0,s=s+Math.imul(k,ee)|0,i=i+Math.imul(I,er)|0,n=(n=n+Math.imul(I,ei)|0)+Math.imul(M,er)|0,s=s+Math.imul(M,ei)|0,i=i+Math.imul(E,es)|0,n=(n=n+Math.imul(E,eo)|0)+Math.imul(C,es)|0,s=s+Math.imul(C,eo)|0,i=i+Math.imul(w,el)|0,n=(n=n+Math.imul(w,eh)|0)+Math.imul(T,el)|0,s=s+Math.imul(T,eh)|0,i=i+Math.imul(x,ec)|0,n=(n=n+Math.imul(x,ed)|0)+Math.imul(_,ec)|0,s=s+Math.imul(_,ed)|0;var eC=(h+(i=i+Math.imul(v,ep)|0)|0)+((8191&(n=(n=n+Math.imul(v,eg)|0)+Math.imul(b,ep)|0))<<13)|0;h=((s=s+Math.imul(b,eg)|0)+(n>>>13)|0)+(eC>>>26)|0,eC&=0x3ffffff,i=Math.imul(F,Z),n=(n=Math.imul(F,K))+Math.imul(V,Z)|0,s=Math.imul(V,K),i=i+Math.imul(L,Q)|0,n=(n=n+Math.imul(L,ee)|0)+Math.imul(D,Q)|0,s=s+Math.imul(D,ee)|0,i=i+Math.imul(O,er)|0,n=(n=n+Math.imul(O,ei)|0)+Math.imul(k,er)|0,s=s+Math.imul(k,ei)|0,i=i+Math.imul(I,es)|0,n=(n=n+Math.imul(I,eo)|0)+Math.imul(M,es)|0,s=s+Math.imul(M,eo)|0,i=i+Math.imul(E,el)|0,n=(n=n+Math.imul(E,eh)|0)+Math.imul(C,el)|0,s=s+Math.imul(C,eh)|0,i=i+Math.imul(w,ec)|0,n=(n=n+Math.imul(w,ed)|0)+Math.imul(T,ec)|0,s=s+Math.imul(T,ed)|0;var eA=(h+(i=i+Math.imul(x,ep)|0)|0)+((8191&(n=(n=n+Math.imul(x,eg)|0)+Math.imul(_,ep)|0))<<13)|0;h=((s=s+Math.imul(_,eg)|0)+(n>>>13)|0)+(eA>>>26)|0,eA&=0x3ffffff,i=Math.imul(F,Q),n=(n=Math.imul(F,ee))+Math.imul(V,Q)|0,s=Math.imul(V,ee),i=i+Math.imul(L,er)|0,n=(n=n+Math.imul(L,ei)|0)+Math.imul(D,er)|0,s=s+Math.imul(D,ei)|0,i=i+Math.imul(O,es)|0,n=(n=n+Math.imul(O,eo)|0)+Math.imul(k,es)|0,s=s+Math.imul(k,eo)|0,i=i+Math.imul(I,el)|0,n=(n=n+Math.imul(I,eh)|0)+Math.imul(M,el)|0,s=s+Math.imul(M,eh)|0,i=i+Math.imul(E,ec)|0,n=(n=n+Math.imul(E,ed)|0)+Math.imul(C,ec)|0,s=s+Math.imul(C,ed)|0;var eI=(h+(i=i+Math.imul(w,ep)|0)|0)+((8191&(n=(n=n+Math.imul(w,eg)|0)+Math.imul(T,ep)|0))<<13)|0;h=((s=s+Math.imul(T,eg)|0)+(n>>>13)|0)+(eI>>>26)|0,eI&=0x3ffffff,i=Math.imul(F,er),n=(n=Math.imul(F,ei))+Math.imul(V,er)|0,s=Math.imul(V,ei),i=i+Math.imul(L,es)|0,n=(n=n+Math.imul(L,eo)|0)+Math.imul(D,es)|0,s=s+Math.imul(D,eo)|0,i=i+Math.imul(O,el)|0,n=(n=n+Math.imul(O,eh)|0)+Math.imul(k,el)|0,s=s+Math.imul(k,eh)|0,i=i+Math.imul(I,ec)|0,n=(n=n+Math.imul(I,ed)|0)+Math.imul(M,ec)|0,s=s+Math.imul(M,ed)|0;var eM=(h+(i=i+Math.imul(E,ep)|0)|0)+((8191&(n=(n=n+Math.imul(E,eg)|0)+Math.imul(C,ep)|0))<<13)|0;h=((s=s+Math.imul(C,eg)|0)+(n>>>13)|0)+(eM>>>26)|0,eM&=0x3ffffff,i=Math.imul(F,es),n=(n=Math.imul(F,eo))+Math.imul(V,es)|0,s=Math.imul(V,eo),i=i+Math.imul(L,el)|0,n=(n=n+Math.imul(L,eh)|0)+Math.imul(D,el)|0,s=s+Math.imul(D,eh)|0,i=i+Math.imul(O,ec)|0,n=(n=n+Math.imul(O,ed)|0)+Math.imul(k,ec)|0,s=s+Math.imul(k,ed)|0;var eR=(h+(i=i+Math.imul(I,ep)|0)|0)+((8191&(n=(n=n+Math.imul(I,eg)|0)+Math.imul(M,ep)|0))<<13)|0;h=((s=s+Math.imul(M,eg)|0)+(n>>>13)|0)+(eR>>>26)|0,eR&=0x3ffffff,i=Math.imul(F,el),n=(n=Math.imul(F,eh))+Math.imul(V,el)|0,s=Math.imul(V,eh),i=i+Math.imul(L,ec)|0,n=(n=n+Math.imul(L,ed)|0)+Math.imul(D,ec)|0,s=s+Math.imul(D,ed)|0;var eO=(h+(i=i+Math.imul(O,ep)|0)|0)+((8191&(n=(n=n+Math.imul(O,eg)|0)+Math.imul(k,ep)|0))<<13)|0;h=((s=s+Math.imul(k,eg)|0)+(n>>>13)|0)+(eO>>>26)|0,eO&=0x3ffffff,i=Math.imul(F,ec),n=(n=Math.imul(F,ed))+Math.imul(V,ec)|0,s=Math.imul(V,ed);var ek=(h+(i=i+Math.imul(L,ep)|0)|0)+((8191&(n=(n=n+Math.imul(L,eg)|0)+Math.imul(D,ep)|0))<<13)|0;h=((s=s+Math.imul(D,eg)|0)+(n>>>13)|0)+(ek>>>26)|0,ek&=0x3ffffff;var eN=(h+(i=Math.imul(F,ep))|0)+((8191&(n=(n=Math.imul(F,eg))+Math.imul(V,ep)|0))<<13)|0;return h=((s=Math.imul(V,eg))+(n>>>13)|0)+(eN>>>26)|0,eN&=0x3ffffff,l[0]=em,l[1]=ev,l[2]=eb,l[3]=ey,l[4]=ex,l[5]=e_,l[6]=eS,l[7]=ew,l[8]=eT,l[9]=eP,l[10]=eE,l[11]=eC,l[12]=eA,l[13]=eI,l[14]=eM,l[15]=eR,l[16]=eO,l[17]=ek,l[18]=eN,0!==h&&(l[19]=h,r.length++),r};function g(e,t,r){return(new m).mulp(e,t,r)}function m(e,t){this.x=e,this.y=t}Math.imul||(p=f),s.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?p(this,e,t):r<63?f(this,e,t):r<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var i=0,n=0,s=0;s<r.length-1;s++){var o=n;n=0;for(var a=0x3ffffff&i,l=Math.min(s,t.length-1),h=Math.max(0,s-e.length+1);h<=l;h++){var u=s-h,c=(0|e.words[u])*(0|t.words[h]),d=0x3ffffff&c;a=0x3ffffff&(d=d+a|0),n+=(o=(o=o+(c/0x4000000|0)|0)+(d>>>26)|0)>>>26,o&=0x3ffffff}r.words[s]=a,i=o,o=n}return 0!==i?r.words[s]=i:r.length--,r.strip()}(this,e,t):g(this,e,t)},m.prototype.makeRBT=function(e){for(var t=Array(e),r=s.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,r,e);return t},m.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var i=0,n=0;n<t;n++)i|=(1&e)<<t-n-1,e>>=1;return i},m.prototype.permute=function(e,t,r,i,n,s){for(var o=0;o<s;o++)i[o]=t[e[o]],n[o]=r[e[o]]},m.prototype.transform=function(e,t,r,i,n,s){this.permute(s,e,t,r,i,n);for(var o=1;o<n;o<<=1)for(var a=o<<1,l=Math.cos(2*Math.PI/a),h=Math.sin(2*Math.PI/a),u=0;u<n;u+=a)for(var c=l,d=h,f=0;f<o;f++){var p=r[u+f],g=i[u+f],m=r[u+f+o],v=i[u+f+o],b=c*m-d*v;v=c*v+d*m,m=b,r[u+f]=p+m,i[u+f]=g+v,r[u+f+o]=p-m,i[u+f+o]=g-v,f!==a&&(b=l*c-h*d,d=l*d+h*c,c=b)}},m.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),i=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+i},m.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var i=0;i<r/2;i++){var n=e[i];e[i]=e[r-i-1],e[r-i-1]=n,n=t[i],t[i]=-t[r-i-1],t[r-i-1]=-n}},m.prototype.normalize13b=function(e,t){for(var r=0,i=0;i<t/2;i++){var n=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+r;e[i]=0x3ffffff&n,r=n<0x4000000?0:n/0x4000000|0}return e},m.prototype.convert13b=function(e,t,r,n){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<n;++o)r[o]=0;i(0===s),i(0==(-8192&s))},m.prototype.stub=function(e){for(var t=Array(e),r=0;r<e;r++)t[r]=0;return t},m.prototype.mulp=function(e,t,r){var i=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(i),s=this.stub(i),o=Array(i),a=Array(i),l=Array(i),h=Array(i),u=Array(i),c=Array(i),d=r.words;d.length=i,this.convert13b(e.words,e.length,o,i),this.convert13b(t.words,t.length,h,i),this.transform(o,s,a,l,i,n),this.transform(h,s,u,c,i,n);for(var f=0;f<i;f++){var p=a[f]*u[f]-l[f]*c[f];l[f]=a[f]*c[f]+l[f]*u[f],a[f]=p}return this.conjugate(a,l,i),this.transform(a,l,d,s,i,n),this.conjugate(d,s,i),this.normalize13b(d,i),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=Array(this.length+e.length),g(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){i("number"==typeof e),i(e<0x4000000);for(var t=0,r=0;r<this.length;r++){var n=(0|this.words[r])*e,s=(0x3ffffff&n)+(0x3ffffff&t);t>>=26,t+=(n/0x4000000|0)+(s>>>26),this.words[r]=0x3ffffff&s}return 0!==t&&(this.words[r]=t,this.length++),this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=Array(e.bitLength()),r=0;r<t.length;r++){var i=r/26|0,n=r%26;t[r]=(e.words[i]&1<<n)>>>n}return t}(e);if(0===t.length)return new s(1);for(var r=this,i=0;i<t.length&&0===t[i];i++,r=r.sqr());if(++i<t.length)for(var n=r.sqr();i<t.length;i++,n=n.sqr())0!==t[i]&&(r=r.mul(n));return r},s.prototype.iushln=function(e){i("number"==typeof e&&e>=0);var t,r=e%26,n=(e-r)/26,s=0x3ffffff>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,l=(0|this.words[t])-a<<r;this.words[t]=l|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},s.prototype.ishln=function(e){return i(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){i("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var n,s=e%26,o=Math.min((e-s)/26,this.length),a=0x3ffffff^0x3ffffff>>>s<<s;if(n-=o,n=Math.max(0,n),r){for(var l=0;l<o;l++)r.words[l]=this.words[l];r.length=o}if(0===o);else if(this.length>o)for(this.length-=o,l=0;l<this.length;l++)this.words[l]=this.words[l+o];else this.words[0]=0,this.length=1;var h=0;for(l=this.length-1;l>=0&&(0!==h||l>=n);l--){var u=0|this.words[l];this.words[l]=h<<26-s|u>>>s,h=u&a}return r&&0!==h&&(r.words[r.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(e,t,r){return i(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){i("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;return!(this.length<=r)&&!!(this.words[r]&1<<t)},s.prototype.imaskn=function(e){i("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;return(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)?this:(0!==t&&r++,this.length=Math.min(r,this.length),0!==t&&(this.words[this.length-1]&=0x3ffffff^0x3ffffff>>>t<<t),this.strip())},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return i("number"==typeof e),i(e<0x4000000),e<0?this.isubn(-e):0!==this.negative?(1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(e),this.negative=1),this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=0x4000000;t++)this.words[t]-=0x4000000,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(i("number"==typeof e),i(e<0x4000000),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=0x4000000,this.words[t+1]-=1;return this.strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var n,s,o=e.length+r;this._expand(o);var a=0;for(n=0;n<e.length;n++){s=(0|this.words[n+r])+a;var l=(0|e.words[n])*t;a=((s-=0x3ffffff&l)>>26)-(l/0x4000000|0),this.words[n+r]=0x3ffffff&s}for(;n<this.length-r;n++)a=(s=(0|this.words[n+r])+a)>>26,this.words[n+r]=0x3ffffff&s;if(0===a)return this.strip();for(i(-1===a),a=0,n=0;n<this.length;n++)a=(s=-(0|this.words[n])+a)>>26,this.words[n]=0x3ffffff&s;return this.negative=1,this.strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),i=this.clone(),n=e,o=0|n.words[n.length-1];0!=(r=26-this._countBits(o))&&(n=n.ushln(r),i.iushln(r),o=0|n.words[n.length-1]);var a,l=i.length-n.length;if("mod"!==t){(a=new s(null)).length=l+1,a.words=Array(a.length);for(var h=0;h<a.length;h++)a.words[h]=0}var u=i.clone()._ishlnsubmul(n,1,l);0===u.negative&&(i=u,a&&(a.words[l]=1));for(var c=l-1;c>=0;c--){var d=0x4000000*(0|i.words[n.length+c])+(0|i.words[n.length+c-1]);for(d=Math.min(d/o|0,0x3ffffff),i._ishlnsubmul(n,d,c);0!==i.negative;)d--,i.negative=0,i._ishlnsubmul(n,1,c),i.isZero()||(i.negative^=1);a&&(a.words[c]=d)}return a&&a.strip(),i.strip(),"div"!==t&&0!==r&&i.iushrn(r),{div:a||null,mod:i}},s.prototype.divmod=function(e,t,r){var n,o,a;return i(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(n=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:n,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(n=a.div.neg()),{div:n,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||0>this.cmp(e)?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modn(e.words[0]))}:this._wordDiv(e,t)},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),n=e.andln(1),s=r.cmp(i);return s<0||1===n&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modn=function(e){i(e<=0x3ffffff);for(var t=0x4000000%e,r=0,n=this.length-1;n>=0;n--)r=(t*r+(0|this.words[n]))%e;return r},s.prototype.idivn=function(e){i(e<=0x3ffffff);for(var t=0,r=this.length-1;r>=0;r--){var n=(0|this.words[r])+0x4000000*t;this.words[r]=n/e|0,t=n%e}return this.strip()},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){i(0===e.negative),i(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new s(1),o=new s(0),a=new s(0),l=new s(1),h=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++h;for(var u=r.clone(),c=t.clone();!t.isZero();){for(var d=0,f=1;0==(t.words[0]&f)&&d<26;++d,f<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(n.isOdd()||o.isOdd())&&(n.iadd(u),o.isub(c)),n.iushrn(1),o.iushrn(1);for(var p=0,g=1;0==(r.words[0]&g)&&p<26;++p,g<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||l.isOdd())&&(a.iadd(u),l.isub(c)),a.iushrn(1),l.iushrn(1);t.cmp(r)>=0?(t.isub(r),n.isub(a),o.isub(l)):(r.isub(t),a.isub(n),l.isub(o))}return{a:a,b:l,gcd:r.iushln(h)}},s.prototype._invmp=function(e){i(0===e.negative),i(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,o=new s(1),a=new s(0),l=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var h=0,u=1;0==(t.words[0]&u)&&h<26;++h,u<<=1);if(h>0)for(t.iushrn(h);h-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);for(var c=0,d=1;0==(r.words[0]&d)&&c<26;++c,d<<=1);if(c>0)for(r.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(l),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return 0>(n=0===t.cmpn(1)?o:a).cmpn(0)&&n.iadd(e),n},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var i=0;t.isEven()&&r.isEven();i++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=t.cmp(r);if(n<0){var s=t;t=r,r=s}else if(0===n||0===r.cmpn(1))break;t.isub(r)}return r.iushln(i)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){i("number"==typeof e);var t=e%26,r=(e-t)/26,n=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=n,this;for(var s=n,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=0x3ffffff,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return -1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),i(e<=0x3ffffff,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return -1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return -1;for(var t=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],n=0|e.words[r];if(i!==n){i<n?t=-1:i>n&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return -1===this.cmpn(e)},s.prototype.lt=function(e){return -1===this.cmp(e)},s.prototype.lten=function(e){return 0>=this.cmpn(e)},s.prototype.lte=function(e){return 0>=this.cmp(e)},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new w(e)},s.prototype.toRed=function(e){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return i(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return i(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function y(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function x(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function w(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else i(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){w.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var e=new s(null);return e.words=Array(Math.ceil(this.n/13)),e},b.prototype.ireduce=function(e){var t,r=e;do this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength();while(t>this.n);var i=t<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},b.prototype.split=function(e,t){e.iushrn(this.n,0,t)},b.prototype.imulK=function(e){return e.imul(this.k)},n(y,b),y.prototype.split=function(e,t){for(var r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(4194303&s)<<4|n>>>22,n=s}n>>>=22,e.words[i-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},y.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var i=0|e.words[r];t+=977*i,e.words[r]=0x3ffffff&t,t=64*i+(t/0x4000000|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(x,b),n(_,b),n(S,b),S.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var i=19*(0|e.words[r])+t,n=0x3ffffff&i;i>>>=26,e.words[r]=n,t=i}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){var t;if(v[e])return v[e];if("k256"===e)t=new y;else if("p224"===e)t=new x;else if("p192"===e)t=new _;else{if("p25519"!==e)throw Error("Unknown prime "+e);t=new S}return v[e]=t,t},w.prototype._verify1=function(e){i(0===e.negative,"red works only with positives"),i(e.red,"red works only with red numbers")},w.prototype._verify2=function(e,t){i(0==(e.negative|t.negative),"red works only with positives"),i(e.red&&e.red===t.red,"red works only with red numbers")},w.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},w.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},w.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},w.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},w.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r._forceRed(this)},w.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r},w.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},w.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},w.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},w.prototype.isqr=function(e){return this.imul(e,e.clone())},w.prototype.sqr=function(e){return this.mul(e,e)},w.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(i(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var n=this.m.subn(1),o=0;!n.isZero()&&0===n.andln(1);)o++,n.iushrn(1);i(!n.isZero());var a=new s(1).toRed(this),l=a.redNeg(),h=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,h).cmp(l);)u.redIAdd(l);for(var c=this.pow(u,n),d=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),p=o;0!==f.cmp(a);){for(var g=f,m=0;0!==g.cmp(a);m++)g=g.redSqr();i(m<p);var v=this.pow(c,new s(1).iushln(p-m-1));d=d.redMul(v),c=v.redSqr(),f=f.redMul(c),p=m}return d},w.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},w.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],e);var n=r[0],o=0,a=0,l=t.bitLength()%26;for(0===l&&(l=26),i=t.length-1;i>=0;i--){for(var h=t.words[i],u=l-1;u>=0;u--){var c=h>>u&1;n!==r[0]&&(n=this.sqr(n)),0!==c||0!==o?(o<<=1,o|=c,(4==++a||0===i&&0===u)&&(n=this.mul(n,r[o]),a=0,o=0)):a=0}l=26}return n},w.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},w.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new T(e)},n(T,w),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):0>n.cmpn(0)&&(s=n.iadd(this.m)),s._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),o=n;return n.cmp(this.m)>=0?o=n.isub(this.m):0>n.cmpn(0)&&(o=n.iadd(this.m)),o._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t)},{buffer:188}],185:[function(e,t,r){"use strict";r.byteLength=function(e){var t=h(e),r=t[0],i=t[1];return 3*(r+i)/4-i},r.toByteArray=function(e){var t,r,i,o,a=h(e),l=a[0],u=a[1],c=new s((t=0,3*(l+(r=u))/4-r)),d=0,f=u>0?l-4:l;for(o=0;o<f;o+=4)i=n[e.charCodeAt(o)]<<18|n[e.charCodeAt(o+1)]<<12|n[e.charCodeAt(o+2)]<<6|n[e.charCodeAt(o+3)],c[d++]=i>>16&255,c[d++]=i>>8&255,c[d++]=255&i;return 2===u&&(i=n[e.charCodeAt(o)]<<2|n[e.charCodeAt(o+1)]>>4,c[d++]=255&i),1===u&&(i=n[e.charCodeAt(o)]<<10|n[e.charCodeAt(o+1)]<<4|n[e.charCodeAt(o+2)]>>2,c[d++]=i>>8&255,c[d++]=255&i),c},r.fromByteArray=function(e){for(var t,r=e.length,n=r%3,s=[],o=0,a=r-n;o<a;o+=16383)s.push(function(e,t,r){for(var n,s=[],o=t;o<r;o+=3)s.push(i[(n=(e[o]<<16&0xff0000)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+i[n>>12&63]+i[n>>6&63]+i[63&n]);return s.join("")}(e,o,o+16383>a?a:o+16383));return 1===n?s.push(i[(t=e[r-1])>>2]+i[t<<4&63]+"=="):2===n&&s.push(i[(t=(e[r-2]<<8)+e[r-1])>>10]+i[t>>4&63]+i[t<<2&63]+"="),s.join("")};for(var i=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=o.length;a<l;++a)i[a]=o[a],n[o.charCodeAt(a)]=a;function h(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return -1===r&&(r=t),[r,r===t?0:4-r%4]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},{}],186:[function(e,t,r){"use strict";!function(t,r){function i(e,t){if(!e)throw Error(t||"Assertion failed")}function n(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}"object"==typeof t?t.exports=s:(void 0).BN=s,s.BN=s,s.wordSize=26;try{c="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function o(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void i(!1,"Invalid character in "+e)}function a(e,t,r){var i=o(e,r);return r-1>=t&&(i|=o(e,r-1)<<4),i}function l(e,t,r,n){for(var s=0,o=0,a=Math.min(e.length,r),l=t;l<a;l++){var h=e.charCodeAt(l)-48;s*=n,o=h>=49?h-49+10:h>=17?h-17+10:h,i(h>=0&&o<n,"Invalid character"),s+=o}return s}function h(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return 0>e.cmp(t)?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),i(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<e.length&&(16===t?this._parseHex(e,n,r):(this._parseBase(e,t,n),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<0x4000000?(this.words=[0x3ffffff&e],this.length=1):e<0x10000000000000?(this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff],this.length=2):(i(e<0x20000000000000),this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(i("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,o,a=0;if("be"===r)for(n=e.length-1,s=0;n>=0;n-=3)o=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[s]|=o<<a&0x3ffffff,this.words[s+1]=o>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(n=0,s=0;n<e.length;n+=3)o=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[s]|=o<<a&0x3ffffff,this.words[s+1]=o>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s=0,o=0;if("be"===r)for(i=e.length-1;i>=t;i-=2)n=a(e,t,i)<<s,this.words[o]|=0x3ffffff&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;else for(i=(e.length-t)%2==0?t+1:t;i<e.length;i+=2)n=a(e,t,i)<<s,this.words[o]|=0x3ffffff&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;this._strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var i=0,n=1;n<=0x3ffffff;n*=t)i++;i--,n=n/t|0;for(var s=e.length-r,o=s%i,a=Math.min(s,s-o)+r,h=0,u=r;u<a;u+=i)h=l(e,u,u+i,t),this.imuln(n),this.words[0]+h<0x4000000?this.words[0]+=h:this._iaddn(h);if(0!==o){var c=1;for(h=l(e,u,e.length,t),u=0;u<o;u++)c*=t;this.imuln(c),this.words[0]+h<0x4000000?this.words[0]+=h:this._iaddn(h)}this._strip()},s.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){h(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=u}catch(e){s.prototype.inspect=u}else s.prototype.inspect=u;function u(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var c,d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,0x2000000,0x290d741,0x1000000,0x2e90edd,0x39aa400,0x267bf47,0x1000000,0x290d741,1e7,0x12959c3,0x222c000,0x3bd7765,7529536,0xadcea1,0x1000000,0x1704f61,0x206fc40,0x2cddcf9,64e6,4084101,5153632,6436343,7962624,9765625,0xb54ba0,0xdaf26b,0x1069c00,0x138f9ad,243e5,0x1b4d89f,0x2000000,0x25528a1,0x2b54a20,0x3216b93,0x39aa400];function g(e,t,r){r.negative=t.negative^e.negative;var i=e.length+t.length|0;r.length=i,i=i-1|0;var n=0|e.words[0],s=0|t.words[0],o=n*s,a=0x3ffffff&o,l=o/0x4000000|0;r.words[0]=a;for(var h=1;h<i;h++){for(var u=l>>>26,c=0x3ffffff&l,d=Math.min(h,t.length-1),f=Math.max(0,h-e.length+1);f<=d;f++){var p=h-f|0;u+=(o=(n=0|e.words[p])*(s=0|t.words[f])+c)/0x4000000|0,c=0x3ffffff&o}r.words[h]=0|c,l=0|u}return 0!==l?r.words[h]=0|l:r.length--,r._strip()}s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var n=0,s=0,o=0;o<this.length;o++){var a=this.words[o],l=(0xffffff&(a<<n|s)).toString(16);s=a>>>24-n&0xffffff,(n+=2)>=26&&(n-=26,o--),r=0!==s||o!==this.length-1?d[6-l.length]+l+r:l+r}for(0!==s&&(r=s.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var h=f[e],u=p[e];r="";var c=this.clone();for(c.negative=0;!c.isZero();){var g=c.modrn(u).toString(e);r=(c=c.idivn(u)).isZero()?g+r:d[h-g.length]+g+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=0x4000000*this.words[1]:3===this.length&&1===this.words[2]?e+=0x10000000000000+0x4000000*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},c&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(c,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,r){this._strip();var n,s,o=this.byteLength(),a=r||Math.max(1,o);i(o<=a,"byte array longer than desired length"),i(a>0,"Requested array length <= 0");var l=(n=e,s=a,n.allocUnsafe?n.allocUnsafe(s):new n(s));return this["_toArrayLike"+("le"===t?"LE":"BE")](l,o),l},s.prototype._toArrayLikeLE=function(e,t){for(var r=0,i=0,n=0,s=0;n<this.length;n++){var o=this.words[n]<<s|i;e[r++]=255&o,r<e.length&&(e[r++]=o>>8&255),r<e.length&&(e[r++]=o>>16&255),6===s?(r<e.length&&(e[r++]=o>>24&255),i=0,s=0):(i=o>>>24,s+=2)}if(r<e.length)for(e[r++]=i;r<e.length;)e[r++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,i=0,n=0,s=0;n<this.length;n++){var o=this.words[n]<<s|i;e[r--]=255&o,r>=0&&(e[r--]=o>>8&255),r>=0&&(e[r--]=o>>16&255),6===s?(r>=0&&(e[r--]=o>>24&255),i=0,s=0):(i=o>>>24,s+=2)}if(r>=0)for(e[r--]=i;r>=0;)e[r--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return i(0==(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return i(0==(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var i=0;i<r.length;i++)this.words[i]=t.words[i]^r.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return i(0==(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){i("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var n=0;n<t;n++)this.words[n]=0x3ffffff&~this.words[n];return r>0&&(this.words[n]=~this.words[n]&0x3ffffff>>26-r),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){i("number"==typeof e&&e>=0);var r=e/26|0,n=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<n:this.words[r]&~(1<<n),this._strip()},s.prototype.iadd=function(e){var t,r,i;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,i=e):(r=e,i=this);for(var n=0,s=0;s<i.length;s++)t=(0|r.words[s])+(0|i.words[s])+n,this.words[s]=0x3ffffff&t,n=t>>>26;for(;0!==n&&s<r.length;s++)t=(0|r.words[s])+n,this.words[s]=0x3ffffff&t,n=t>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,i,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,i=e):(r=e,i=this);for(var s=0,o=0;o<i.length;o++)s=(t=(0|r.words[o])-(0|i.words[o])+s)>>26,this.words[o]=0x3ffffff&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=0x3ffffff&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var m=function(e,t,r){var i,n,s,o=e.words,a=t.words,l=r.words,h=0,u=0|o[0],c=8191&u,d=u>>>13,f=0|o[1],p=8191&f,g=f>>>13,m=0|o[2],v=8191&m,b=m>>>13,y=0|o[3],x=8191&y,_=y>>>13,S=0|o[4],w=8191&S,T=S>>>13,P=0|o[5],E=8191&P,C=P>>>13,A=0|o[6],I=8191&A,M=A>>>13,R=0|o[7],O=8191&R,k=R>>>13,N=0|o[8],L=8191&N,D=N>>>13,B=0|o[9],F=8191&B,V=B>>>13,G=0|a[0],U=8191&G,z=G>>>13,j=0|a[1],H=8191&j,W=j>>>13,q=0|a[2],X=8191&q,$=q>>>13,Y=0|a[3],Z=8191&Y,K=Y>>>13,J=0|a[4],Q=8191&J,ee=J>>>13,et=0|a[5],er=8191&et,ei=et>>>13,en=0|a[6],es=8191&en,eo=en>>>13,ea=0|a[7],el=8191&ea,eh=ea>>>13,eu=0|a[8],ec=8191&eu,ed=eu>>>13,ef=0|a[9],ep=8191&ef,eg=ef>>>13;r.negative=e.negative^t.negative,r.length=19;var em=(h+(i=Math.imul(c,U))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(d,U)|0))<<13)|0;h=((s=Math.imul(d,z))+(n>>>13)|0)+(em>>>26)|0,em&=0x3ffffff,i=Math.imul(p,U),n=(n=Math.imul(p,z))+Math.imul(g,U)|0,s=Math.imul(g,z);var ev=(h+(i=i+Math.imul(c,H)|0)|0)+((8191&(n=(n=n+Math.imul(c,W)|0)+Math.imul(d,H)|0))<<13)|0;h=((s=s+Math.imul(d,W)|0)+(n>>>13)|0)+(ev>>>26)|0,ev&=0x3ffffff,i=Math.imul(v,U),n=(n=Math.imul(v,z))+Math.imul(b,U)|0,s=Math.imul(b,z),i=i+Math.imul(p,H)|0,n=(n=n+Math.imul(p,W)|0)+Math.imul(g,H)|0,s=s+Math.imul(g,W)|0;var eb=(h+(i=i+Math.imul(c,X)|0)|0)+((8191&(n=(n=n+Math.imul(c,$)|0)+Math.imul(d,X)|0))<<13)|0;h=((s=s+Math.imul(d,$)|0)+(n>>>13)|0)+(eb>>>26)|0,eb&=0x3ffffff,i=Math.imul(x,U),n=(n=Math.imul(x,z))+Math.imul(_,U)|0,s=Math.imul(_,z),i=i+Math.imul(v,H)|0,n=(n=n+Math.imul(v,W)|0)+Math.imul(b,H)|0,s=s+Math.imul(b,W)|0,i=i+Math.imul(p,X)|0,n=(n=n+Math.imul(p,$)|0)+Math.imul(g,X)|0,s=s+Math.imul(g,$)|0;var ey=(h+(i=i+Math.imul(c,Z)|0)|0)+((8191&(n=(n=n+Math.imul(c,K)|0)+Math.imul(d,Z)|0))<<13)|0;h=((s=s+Math.imul(d,K)|0)+(n>>>13)|0)+(ey>>>26)|0,ey&=0x3ffffff,i=Math.imul(w,U),n=(n=Math.imul(w,z))+Math.imul(T,U)|0,s=Math.imul(T,z),i=i+Math.imul(x,H)|0,n=(n=n+Math.imul(x,W)|0)+Math.imul(_,H)|0,s=s+Math.imul(_,W)|0,i=i+Math.imul(v,X)|0,n=(n=n+Math.imul(v,$)|0)+Math.imul(b,X)|0,s=s+Math.imul(b,$)|0,i=i+Math.imul(p,Z)|0,n=(n=n+Math.imul(p,K)|0)+Math.imul(g,Z)|0,s=s+Math.imul(g,K)|0;var ex=(h+(i=i+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(d,Q)|0))<<13)|0;h=((s=s+Math.imul(d,ee)|0)+(n>>>13)|0)+(ex>>>26)|0,ex&=0x3ffffff,i=Math.imul(E,U),n=(n=Math.imul(E,z))+Math.imul(C,U)|0,s=Math.imul(C,z),i=i+Math.imul(w,H)|0,n=(n=n+Math.imul(w,W)|0)+Math.imul(T,H)|0,s=s+Math.imul(T,W)|0,i=i+Math.imul(x,X)|0,n=(n=n+Math.imul(x,$)|0)+Math.imul(_,X)|0,s=s+Math.imul(_,$)|0,i=i+Math.imul(v,Z)|0,n=(n=n+Math.imul(v,K)|0)+Math.imul(b,Z)|0,s=s+Math.imul(b,K)|0,i=i+Math.imul(p,Q)|0,n=(n=n+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,s=s+Math.imul(g,ee)|0;var e_=(h+(i=i+Math.imul(c,er)|0)|0)+((8191&(n=(n=n+Math.imul(c,ei)|0)+Math.imul(d,er)|0))<<13)|0;h=((s=s+Math.imul(d,ei)|0)+(n>>>13)|0)+(e_>>>26)|0,e_&=0x3ffffff,i=Math.imul(I,U),n=(n=Math.imul(I,z))+Math.imul(M,U)|0,s=Math.imul(M,z),i=i+Math.imul(E,H)|0,n=(n=n+Math.imul(E,W)|0)+Math.imul(C,H)|0,s=s+Math.imul(C,W)|0,i=i+Math.imul(w,X)|0,n=(n=n+Math.imul(w,$)|0)+Math.imul(T,X)|0,s=s+Math.imul(T,$)|0,i=i+Math.imul(x,Z)|0,n=(n=n+Math.imul(x,K)|0)+Math.imul(_,Z)|0,s=s+Math.imul(_,K)|0,i=i+Math.imul(v,Q)|0,n=(n=n+Math.imul(v,ee)|0)+Math.imul(b,Q)|0,s=s+Math.imul(b,ee)|0,i=i+Math.imul(p,er)|0,n=(n=n+Math.imul(p,ei)|0)+Math.imul(g,er)|0,s=s+Math.imul(g,ei)|0;var eS=(h+(i=i+Math.imul(c,es)|0)|0)+((8191&(n=(n=n+Math.imul(c,eo)|0)+Math.imul(d,es)|0))<<13)|0;h=((s=s+Math.imul(d,eo)|0)+(n>>>13)|0)+(eS>>>26)|0,eS&=0x3ffffff,i=Math.imul(O,U),n=(n=Math.imul(O,z))+Math.imul(k,U)|0,s=Math.imul(k,z),i=i+Math.imul(I,H)|0,n=(n=n+Math.imul(I,W)|0)+Math.imul(M,H)|0,s=s+Math.imul(M,W)|0,i=i+Math.imul(E,X)|0,n=(n=n+Math.imul(E,$)|0)+Math.imul(C,X)|0,s=s+Math.imul(C,$)|0,i=i+Math.imul(w,Z)|0,n=(n=n+Math.imul(w,K)|0)+Math.imul(T,Z)|0,s=s+Math.imul(T,K)|0,i=i+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,ee)|0,i=i+Math.imul(v,er)|0,n=(n=n+Math.imul(v,ei)|0)+Math.imul(b,er)|0,s=s+Math.imul(b,ei)|0,i=i+Math.imul(p,es)|0,n=(n=n+Math.imul(p,eo)|0)+Math.imul(g,es)|0,s=s+Math.imul(g,eo)|0;var ew=(h+(i=i+Math.imul(c,el)|0)|0)+((8191&(n=(n=n+Math.imul(c,eh)|0)+Math.imul(d,el)|0))<<13)|0;h=((s=s+Math.imul(d,eh)|0)+(n>>>13)|0)+(ew>>>26)|0,ew&=0x3ffffff,i=Math.imul(L,U),n=(n=Math.imul(L,z))+Math.imul(D,U)|0,s=Math.imul(D,z),i=i+Math.imul(O,H)|0,n=(n=n+Math.imul(O,W)|0)+Math.imul(k,H)|0,s=s+Math.imul(k,W)|0,i=i+Math.imul(I,X)|0,n=(n=n+Math.imul(I,$)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,$)|0,i=i+Math.imul(E,Z)|0,n=(n=n+Math.imul(E,K)|0)+Math.imul(C,Z)|0,s=s+Math.imul(C,K)|0,i=i+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,ee)|0,i=i+Math.imul(x,er)|0,n=(n=n+Math.imul(x,ei)|0)+Math.imul(_,er)|0,s=s+Math.imul(_,ei)|0,i=i+Math.imul(v,es)|0,n=(n=n+Math.imul(v,eo)|0)+Math.imul(b,es)|0,s=s+Math.imul(b,eo)|0,i=i+Math.imul(p,el)|0,n=(n=n+Math.imul(p,eh)|0)+Math.imul(g,el)|0,s=s+Math.imul(g,eh)|0;var eT=(h+(i=i+Math.imul(c,ec)|0)|0)+((8191&(n=(n=n+Math.imul(c,ed)|0)+Math.imul(d,ec)|0))<<13)|0;h=((s=s+Math.imul(d,ed)|0)+(n>>>13)|0)+(eT>>>26)|0,eT&=0x3ffffff,i=Math.imul(F,U),n=(n=Math.imul(F,z))+Math.imul(V,U)|0,s=Math.imul(V,z),i=i+Math.imul(L,H)|0,n=(n=n+Math.imul(L,W)|0)+Math.imul(D,H)|0,s=s+Math.imul(D,W)|0,i=i+Math.imul(O,X)|0,n=(n=n+Math.imul(O,$)|0)+Math.imul(k,X)|0,s=s+Math.imul(k,$)|0,i=i+Math.imul(I,Z)|0,n=(n=n+Math.imul(I,K)|0)+Math.imul(M,Z)|0,s=s+Math.imul(M,K)|0,i=i+Math.imul(E,Q)|0,n=(n=n+Math.imul(E,ee)|0)+Math.imul(C,Q)|0,s=s+Math.imul(C,ee)|0,i=i+Math.imul(w,er)|0,n=(n=n+Math.imul(w,ei)|0)+Math.imul(T,er)|0,s=s+Math.imul(T,ei)|0,i=i+Math.imul(x,es)|0,n=(n=n+Math.imul(x,eo)|0)+Math.imul(_,es)|0,s=s+Math.imul(_,eo)|0,i=i+Math.imul(v,el)|0,n=(n=n+Math.imul(v,eh)|0)+Math.imul(b,el)|0,s=s+Math.imul(b,eh)|0,i=i+Math.imul(p,ec)|0,n=(n=n+Math.imul(p,ed)|0)+Math.imul(g,ec)|0,s=s+Math.imul(g,ed)|0;var eP=(h+(i=i+Math.imul(c,ep)|0)|0)+((8191&(n=(n=n+Math.imul(c,eg)|0)+Math.imul(d,ep)|0))<<13)|0;h=((s=s+Math.imul(d,eg)|0)+(n>>>13)|0)+(eP>>>26)|0,eP&=0x3ffffff,i=Math.imul(F,H),n=(n=Math.imul(F,W))+Math.imul(V,H)|0,s=Math.imul(V,W),i=i+Math.imul(L,X)|0,n=(n=n+Math.imul(L,$)|0)+Math.imul(D,X)|0,s=s+Math.imul(D,$)|0,i=i+Math.imul(O,Z)|0,n=(n=n+Math.imul(O,K)|0)+Math.imul(k,Z)|0,s=s+Math.imul(k,K)|0,i=i+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,ee)|0,i=i+Math.imul(E,er)|0,n=(n=n+Math.imul(E,ei)|0)+Math.imul(C,er)|0,s=s+Math.imul(C,ei)|0,i=i+Math.imul(w,es)|0,n=(n=n+Math.imul(w,eo)|0)+Math.imul(T,es)|0,s=s+Math.imul(T,eo)|0,i=i+Math.imul(x,el)|0,n=(n=n+Math.imul(x,eh)|0)+Math.imul(_,el)|0,s=s+Math.imul(_,eh)|0,i=i+Math.imul(v,ec)|0,n=(n=n+Math.imul(v,ed)|0)+Math.imul(b,ec)|0,s=s+Math.imul(b,ed)|0;var eE=(h+(i=i+Math.imul(p,ep)|0)|0)+((8191&(n=(n=n+Math.imul(p,eg)|0)+Math.imul(g,ep)|0))<<13)|0;h=((s=s+Math.imul(g,eg)|0)+(n>>>13)|0)+(eE>>>26)|0,eE&=0x3ffffff,i=Math.imul(F,X),n=(n=Math.imul(F,$))+Math.imul(V,X)|0,s=Math.imul(V,$),i=i+Math.imul(L,Z)|0,n=(n=n+Math.imul(L,K)|0)+Math.imul(D,Z)|0,s=s+Math.imul(D,K)|0,i=i+Math.imul(O,Q)|0,n=(n=n+Math.imul(O,ee)|0)+Math.imul(k,Q)|0,s=s+Math.imul(k,ee)|0,i=i+Math.imul(I,er)|0,n=(n=n+Math.imul(I,ei)|0)+Math.imul(M,er)|0,s=s+Math.imul(M,ei)|0,i=i+Math.imul(E,es)|0,n=(n=n+Math.imul(E,eo)|0)+Math.imul(C,es)|0,s=s+Math.imul(C,eo)|0,i=i+Math.imul(w,el)|0,n=(n=n+Math.imul(w,eh)|0)+Math.imul(T,el)|0,s=s+Math.imul(T,eh)|0,i=i+Math.imul(x,ec)|0,n=(n=n+Math.imul(x,ed)|0)+Math.imul(_,ec)|0,s=s+Math.imul(_,ed)|0;var eC=(h+(i=i+Math.imul(v,ep)|0)|0)+((8191&(n=(n=n+Math.imul(v,eg)|0)+Math.imul(b,ep)|0))<<13)|0;h=((s=s+Math.imul(b,eg)|0)+(n>>>13)|0)+(eC>>>26)|0,eC&=0x3ffffff,i=Math.imul(F,Z),n=(n=Math.imul(F,K))+Math.imul(V,Z)|0,s=Math.imul(V,K),i=i+Math.imul(L,Q)|0,n=(n=n+Math.imul(L,ee)|0)+Math.imul(D,Q)|0,s=s+Math.imul(D,ee)|0,i=i+Math.imul(O,er)|0,n=(n=n+Math.imul(O,ei)|0)+Math.imul(k,er)|0,s=s+Math.imul(k,ei)|0,i=i+Math.imul(I,es)|0,n=(n=n+Math.imul(I,eo)|0)+Math.imul(M,es)|0,s=s+Math.imul(M,eo)|0,i=i+Math.imul(E,el)|0,n=(n=n+Math.imul(E,eh)|0)+Math.imul(C,el)|0,s=s+Math.imul(C,eh)|0,i=i+Math.imul(w,ec)|0,n=(n=n+Math.imul(w,ed)|0)+Math.imul(T,ec)|0,s=s+Math.imul(T,ed)|0;var eA=(h+(i=i+Math.imul(x,ep)|0)|0)+((8191&(n=(n=n+Math.imul(x,eg)|0)+Math.imul(_,ep)|0))<<13)|0;h=((s=s+Math.imul(_,eg)|0)+(n>>>13)|0)+(eA>>>26)|0,eA&=0x3ffffff,i=Math.imul(F,Q),n=(n=Math.imul(F,ee))+Math.imul(V,Q)|0,s=Math.imul(V,ee),i=i+Math.imul(L,er)|0,n=(n=n+Math.imul(L,ei)|0)+Math.imul(D,er)|0,s=s+Math.imul(D,ei)|0,i=i+Math.imul(O,es)|0,n=(n=n+Math.imul(O,eo)|0)+Math.imul(k,es)|0,s=s+Math.imul(k,eo)|0,i=i+Math.imul(I,el)|0,n=(n=n+Math.imul(I,eh)|0)+Math.imul(M,el)|0,s=s+Math.imul(M,eh)|0,i=i+Math.imul(E,ec)|0,n=(n=n+Math.imul(E,ed)|0)+Math.imul(C,ec)|0,s=s+Math.imul(C,ed)|0;var eI=(h+(i=i+Math.imul(w,ep)|0)|0)+((8191&(n=(n=n+Math.imul(w,eg)|0)+Math.imul(T,ep)|0))<<13)|0;h=((s=s+Math.imul(T,eg)|0)+(n>>>13)|0)+(eI>>>26)|0,eI&=0x3ffffff,i=Math.imul(F,er),n=(n=Math.imul(F,ei))+Math.imul(V,er)|0,s=Math.imul(V,ei),i=i+Math.imul(L,es)|0,n=(n=n+Math.imul(L,eo)|0)+Math.imul(D,es)|0,s=s+Math.imul(D,eo)|0,i=i+Math.imul(O,el)|0,n=(n=n+Math.imul(O,eh)|0)+Math.imul(k,el)|0,s=s+Math.imul(k,eh)|0,i=i+Math.imul(I,ec)|0,n=(n=n+Math.imul(I,ed)|0)+Math.imul(M,ec)|0,s=s+Math.imul(M,ed)|0;var eM=(h+(i=i+Math.imul(E,ep)|0)|0)+((8191&(n=(n=n+Math.imul(E,eg)|0)+Math.imul(C,ep)|0))<<13)|0;h=((s=s+Math.imul(C,eg)|0)+(n>>>13)|0)+(eM>>>26)|0,eM&=0x3ffffff,i=Math.imul(F,es),n=(n=Math.imul(F,eo))+Math.imul(V,es)|0,s=Math.imul(V,eo),i=i+Math.imul(L,el)|0,n=(n=n+Math.imul(L,eh)|0)+Math.imul(D,el)|0,s=s+Math.imul(D,eh)|0,i=i+Math.imul(O,ec)|0,n=(n=n+Math.imul(O,ed)|0)+Math.imul(k,ec)|0,s=s+Math.imul(k,ed)|0;var eR=(h+(i=i+Math.imul(I,ep)|0)|0)+((8191&(n=(n=n+Math.imul(I,eg)|0)+Math.imul(M,ep)|0))<<13)|0;h=((s=s+Math.imul(M,eg)|0)+(n>>>13)|0)+(eR>>>26)|0,eR&=0x3ffffff,i=Math.imul(F,el),n=(n=Math.imul(F,eh))+Math.imul(V,el)|0,s=Math.imul(V,eh),i=i+Math.imul(L,ec)|0,n=(n=n+Math.imul(L,ed)|0)+Math.imul(D,ec)|0,s=s+Math.imul(D,ed)|0;var eO=(h+(i=i+Math.imul(O,ep)|0)|0)+((8191&(n=(n=n+Math.imul(O,eg)|0)+Math.imul(k,ep)|0))<<13)|0;h=((s=s+Math.imul(k,eg)|0)+(n>>>13)|0)+(eO>>>26)|0,eO&=0x3ffffff,i=Math.imul(F,ec),n=(n=Math.imul(F,ed))+Math.imul(V,ec)|0,s=Math.imul(V,ed);var ek=(h+(i=i+Math.imul(L,ep)|0)|0)+((8191&(n=(n=n+Math.imul(L,eg)|0)+Math.imul(D,ep)|0))<<13)|0;h=((s=s+Math.imul(D,eg)|0)+(n>>>13)|0)+(ek>>>26)|0,ek&=0x3ffffff;var eN=(h+(i=Math.imul(F,ep))|0)+((8191&(n=(n=Math.imul(F,eg))+Math.imul(V,ep)|0))<<13)|0;return h=((s=Math.imul(V,eg))+(n>>>13)|0)+(eN>>>26)|0,eN&=0x3ffffff,l[0]=em,l[1]=ev,l[2]=eb,l[3]=ey,l[4]=ex,l[5]=e_,l[6]=eS,l[7]=ew,l[8]=eT,l[9]=eP,l[10]=eE,l[11]=eC,l[12]=eA,l[13]=eI,l[14]=eM,l[15]=eR,l[16]=eO,l[17]=ek,l[18]=eN,0!==h&&(l[19]=h,r.length++),r};function v(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var i=0,n=0,s=0;s<r.length-1;s++){var o=n;n=0;for(var a=0x3ffffff&i,l=Math.min(s,t.length-1),h=Math.max(0,s-e.length+1);h<=l;h++){var u=s-h,c=(0|e.words[u])*(0|t.words[h]),d=0x3ffffff&c;a=0x3ffffff&(d=d+a|0),n+=(o=(o=o+(c/0x4000000|0)|0)+(d>>>26)|0)>>>26,o&=0x3ffffff}r.words[s]=a,i=o,o=n}return 0!==i?r.words[s]=i:r.length--,r._strip()}function b(e,t,r){return v(e,t,r)}function y(e,t){this.x=e,this.y=t}Math.imul||(m=g),s.prototype.mulTo=function(e,t){var r,i=this.length+e.length;return 10===this.length&&10===e.length?m(this,e,t):i<63?g(this,e,t):i<1024?v(this,e,t):(r=this,v(r,e,t))},y.prototype.makeRBT=function(e){for(var t=Array(e),r=s.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,r,e);return t},y.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var i=0,n=0;n<t;n++)i|=(1&e)<<t-n-1,e>>=1;return i},y.prototype.permute=function(e,t,r,i,n,s){for(var o=0;o<s;o++)i[o]=t[e[o]],n[o]=r[e[o]]},y.prototype.transform=function(e,t,r,i,n,s){this.permute(s,e,t,r,i,n);for(var o=1;o<n;o<<=1)for(var a=o<<1,l=Math.cos(2*Math.PI/a),h=Math.sin(2*Math.PI/a),u=0;u<n;u+=a)for(var c=l,d=h,f=0;f<o;f++){var p=r[u+f],g=i[u+f],m=r[u+f+o],v=i[u+f+o],b=c*m-d*v;v=c*v+d*m,m=b,r[u+f]=p+m,i[u+f]=g+v,r[u+f+o]=p-m,i[u+f+o]=g-v,f!==a&&(b=l*c-h*d,d=l*d+h*c,c=b)}},y.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),i=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+i},y.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var i=0;i<r/2;i++){var n=e[i];e[i]=e[r-i-1],e[r-i-1]=n,n=t[i],t[i]=-t[r-i-1],t[r-i-1]=-n}},y.prototype.normalize13b=function(e,t){for(var r=0,i=0;i<t/2;i++){var n=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+r;e[i]=0x3ffffff&n,r=n<0x4000000?0:n/0x4000000|0}return e},y.prototype.convert13b=function(e,t,r,n){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<n;++o)r[o]=0;i(0===s),i(0==(-8192&s))},y.prototype.stub=function(e){for(var t=Array(e),r=0;r<e;r++)t[r]=0;return t},y.prototype.mulp=function(e,t,r){var i=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(i),s=this.stub(i),o=Array(i),a=Array(i),l=Array(i),h=Array(i),u=Array(i),c=Array(i),d=r.words;d.length=i,this.convert13b(e.words,e.length,o,i),this.convert13b(t.words,t.length,h,i),this.transform(o,s,a,l,i,n),this.transform(h,s,u,c,i,n);for(var f=0;f<i;f++){var p=a[f]*u[f]-l[f]*c[f];l[f]=a[f]*c[f]+l[f]*u[f],a[f]=p}return this.conjugate(a,l,i),this.transform(a,l,d,s,i,n),this.conjugate(d,s,i),this.normalize13b(d,i),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t,r=new s(null);return r.words=Array(this.length+e.length),t=this,v(t,e,r)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),i("number"==typeof e),i(e<0x4000000);for(var r=0,n=0;n<this.length;n++){var s=(0|this.words[n])*e,o=(0x3ffffff&s)+(0x3ffffff&r);r>>=26,r+=(s/0x4000000|0)+(o>>>26),this.words[n]=0x3ffffff&o}return 0!==r&&(this.words[n]=r,this.length++),t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=Array(e.bitLength()),r=0;r<t.length;r++){var i=r/26|0,n=r%26;t[r]=e.words[i]>>>n&1}return t}(e);if(0===t.length)return new s(1);for(var r=this,i=0;i<t.length&&0===t[i];i++,r=r.sqr());if(++i<t.length)for(var n=r.sqr();i<t.length;i++,n=n.sqr())0!==t[i]&&(r=r.mul(n));return r},s.prototype.iushln=function(e){i("number"==typeof e&&e>=0);var t,r=e%26,n=(e-r)/26,s=0x3ffffff>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,l=(0|this.words[t])-a<<r;this.words[t]=l|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this._strip()},s.prototype.ishln=function(e){return i(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){i("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var n,s=e%26,o=Math.min((e-s)/26,this.length),a=0x3ffffff^0x3ffffff>>>s<<s;if(n-=o,n=Math.max(0,n),r){for(var l=0;l<o;l++)r.words[l]=this.words[l];r.length=o}if(0===o);else if(this.length>o)for(this.length-=o,l=0;l<this.length;l++)this.words[l]=this.words[l+o];else this.words[0]=0,this.length=1;var h=0;for(l=this.length-1;l>=0&&(0!==h||l>=n);l--){var u=0|this.words[l];this.words[l]=h<<26-s|u>>>s,h=u&a}return r&&0!==h&&(r.words[r.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,r){return i(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){i("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;return!(this.length<=r)&&!!(this.words[r]&1<<t)},s.prototype.imaskn=function(e){i("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;return(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)?this:(0!==t&&r++,this.length=Math.min(r,this.length),0!==t&&(this.words[this.length-1]&=0x3ffffff^0x3ffffff>>>t<<t),this._strip())},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return i("number"==typeof e),i(e<0x4000000),e<0?this.isubn(-e):0!==this.negative?(1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(e),this.negative=1),this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=0x4000000;t++)this.words[t]-=0x4000000,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(i("number"==typeof e),i(e<0x4000000),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=0x4000000,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var n,s,o=e.length+r;this._expand(o);var a=0;for(n=0;n<e.length;n++){s=(0|this.words[n+r])+a;var l=(0|e.words[n])*t;a=((s-=0x3ffffff&l)>>26)-(l/0x4000000|0),this.words[n+r]=0x3ffffff&s}for(;n<this.length-r;n++)a=(s=(0|this.words[n+r])+a)>>26,this.words[n+r]=0x3ffffff&s;if(0===a)return this._strip();for(i(-1===a),a=0,n=0;n<this.length;n++)a=(s=-(0|this.words[n])+a)>>26,this.words[n]=0x3ffffff&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),i=this.clone(),n=e,o=0|n.words[n.length-1];0!=(r=26-this._countBits(o))&&(n=n.ushln(r),i.iushln(r),o=0|n.words[n.length-1]);var a,l=i.length-n.length;if("mod"!==t){(a=new s(null)).length=l+1,a.words=Array(a.length);for(var h=0;h<a.length;h++)a.words[h]=0}var u=i.clone()._ishlnsubmul(n,1,l);0===u.negative&&(i=u,a&&(a.words[l]=1));for(var c=l-1;c>=0;c--){var d=0x4000000*(0|i.words[n.length+c])+(0|i.words[n.length+c-1]);for(d=Math.min(d/o|0,0x3ffffff),i._ishlnsubmul(n,d,c);0!==i.negative;)d--,i.negative=0,i._ishlnsubmul(n,1,c),i.isZero()||(i.negative^=1);a&&(a.words[c]=d)}return a&&a._strip(),i._strip(),"div"!==t&&0!==r&&i.iushrn(r),{div:a||null,mod:i}},s.prototype.divmod=function(e,t,r){var n,o,a;return i(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(n=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:n,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(n=a.div.neg()),{div:n,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||0>this.cmp(e)?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t)},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),n=e.andln(1),s=r.cmp(i);return s<0||1===n&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),i(e<=0x3ffffff);for(var r=0x4000000%e,n=0,s=this.length-1;s>=0;s--)n=(r*n+(0|this.words[s]))%e;return t?-n:n},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),i(e<=0x3ffffff);for(var r=0,n=this.length-1;n>=0;n--){var s=(0|this.words[n])+0x4000000*r;this.words[n]=s/e|0,r=s%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){i(0===e.negative),i(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new s(1),o=new s(0),a=new s(0),l=new s(1),h=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++h;for(var u=r.clone(),c=t.clone();!t.isZero();){for(var d=0,f=1;0==(t.words[0]&f)&&d<26;++d,f<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(n.isOdd()||o.isOdd())&&(n.iadd(u),o.isub(c)),n.iushrn(1),o.iushrn(1);for(var p=0,g=1;0==(r.words[0]&g)&&p<26;++p,g<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||l.isOdd())&&(a.iadd(u),l.isub(c)),a.iushrn(1),l.iushrn(1);t.cmp(r)>=0?(t.isub(r),n.isub(a),o.isub(l)):(r.isub(t),a.isub(n),l.isub(o))}return{a:a,b:l,gcd:r.iushln(h)}},s.prototype._invmp=function(e){i(0===e.negative),i(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,o=new s(1),a=new s(0),l=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var h=0,u=1;0==(t.words[0]&u)&&h<26;++h,u<<=1);if(h>0)for(t.iushrn(h);h-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);for(var c=0,d=1;0==(r.words[0]&d)&&c<26;++c,d<<=1);if(c>0)for(r.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(l),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return 0>(n=0===t.cmpn(1)?o:a).cmpn(0)&&n.iadd(e),n},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var i=0;t.isEven()&&r.isEven();i++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=t.cmp(r);if(n<0){var s=t;t=r,r=s}else if(0===n||0===r.cmpn(1))break;t.isub(r)}return r.iushln(i)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){i("number"==typeof e);var t=e%26,r=(e-t)/26,n=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=n,this;for(var s=n,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=0x3ffffff,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return -1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),i(e<=0x3ffffff,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return -1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return -1;for(var t=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],n=0|e.words[r];if(i!==n){i<n?t=-1:i>n&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return -1===this.cmpn(e)},s.prototype.lt=function(e){return -1===this.cmp(e)},s.prototype.lten=function(e){return 0>=this.cmpn(e)},s.prototype.lte=function(e){return 0>=this.cmp(e)},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new E(e)},s.prototype.toRed=function(e){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return i(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return i(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var x={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function S(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else i(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function C(e){E.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new s(null);return e.words=Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,r=e;do this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength();while(t>this.n);var i=t<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(S,_),S.prototype.split=function(e,t){for(var r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(4194303&s)<<4|n>>>22,n=s}n>>>=22,e.words[i-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},S.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var i=0|e.words[r];t+=977*i,e.words[r]=0x3ffffff&t,t=64*i+(t/0x4000000|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(w,_),n(T,_),n(P,_),P.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var i=19*(0|e.words[r])+t,n=0x3ffffff&i;i>>>=26,e.words[r]=n,t=i}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){var t;if(x[e])return x[e];if("k256"===e)t=new S;else if("p224"===e)t=new w;else if("p192"===e)t=new T;else{if("p25519"!==e)throw Error("Unknown prime "+e);t=new P}return x[e]=t,t},E.prototype._verify1=function(e){i(0===e.negative,"red works only with positives"),i(e.red,"red works only with red numbers")},E.prototype._verify2=function(e,t){i(0==(e.negative|t.negative),"red works only with positives"),i(e.red&&e.red===t.red,"red works only with red numbers")},E.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(h(e,e.umod(this.m)._forceRed(this)),e)},E.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},E.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},E.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},E.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r._forceRed(this)},E.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r},E.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},E.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},E.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},E.prototype.isqr=function(e){return this.imul(e,e.clone())},E.prototype.sqr=function(e){return this.mul(e,e)},E.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(i(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var n=this.m.subn(1),o=0;!n.isZero()&&0===n.andln(1);)o++,n.iushrn(1);i(!n.isZero());var a=new s(1).toRed(this),l=a.redNeg(),h=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,h).cmp(l);)u.redIAdd(l);for(var c=this.pow(u,n),d=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),p=o;0!==f.cmp(a);){for(var g=f,m=0;0!==g.cmp(a);m++)g=g.redSqr();i(m<p);var v=this.pow(c,new s(1).iushln(p-m-1));d=d.redMul(v),c=v.redSqr(),f=f.redMul(c),p=m}return d},E.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},E.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],e);var n=r[0],o=0,a=0,l=t.bitLength()%26;for(0===l&&(l=26),i=t.length-1;i>=0;i--){for(var h=t.words[i],u=l-1;u>=0;u--){var c=h>>u&1;n!==r[0]&&(n=this.sqr(n)),0!==c||0!==o?(o<<=1,o|=c,(4==++a||0===i&&0===u)&&(n=this.mul(n,r[o]),a=0,o=0)):a=0}l=26}return n},E.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},E.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new C(e)},n(C,E),C.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},C.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},C.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):0>n.cmpn(0)&&(s=n.iadd(this.m)),s._forceRed(this)},C.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),o=n;return n.cmp(this.m)>=0?o=n.isub(this.m):0>n.cmpn(0)&&(o=n.iadd(this.m)),o._forceRed(this)},C.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t)},{buffer:188}],187:[function(e,t,r){"use strict";var i;function n(e){this.rand=e}if(t.exports=function(e){return i||(i=new n(null)),i.generate(e)},t.exports.Rand=n,n.prototype.generate=function(e){return this._rand(e)},n.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?n.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?n.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(n.prototype._rand=function(){throw Error("Not implemented yet")});else try{var s=e("crypto");if("function"!=typeof s.randomBytes)throw Error("Not supported");n.prototype._rand=function(e){return s.randomBytes(e)}}catch(e){}},{crypto:188}],188:[function(e,t,r){},{}],189:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer;function n(e){i.isBuffer(e)||(e=i.from(e));for(var t=e.length/4|0,r=Array(t),n=0;n<t;n++)r[n]=e.readUInt32BE(4*n);return r}function s(e){for(;0<e.length;e++)e[0]=0}function o(e,t,r,i,n){for(var s,o,a,l,h=r[0],u=r[1],c=r[2],d=r[3],f=e[0]^t[0],p=e[1]^t[1],g=e[2]^t[2],m=e[3]^t[3],v=4,b=1;b<n;b++)s=h[f>>>24]^u[p>>>16&255]^c[g>>>8&255]^d[255&m]^t[v++],o=h[p>>>24]^u[g>>>16&255]^c[m>>>8&255]^d[255&f]^t[v++],a=h[g>>>24]^u[m>>>16&255]^c[f>>>8&255]^d[255&p]^t[v++],l=h[m>>>24]^u[f>>>16&255]^c[p>>>8&255]^d[255&g]^t[v++],f=s,p=o,g=a,m=l;return s=(i[f>>>24]<<24|i[p>>>16&255]<<16|i[g>>>8&255]<<8|i[255&m])^t[v++],o=(i[p>>>24]<<24|i[g>>>16&255]<<16|i[m>>>8&255]<<8|i[255&f])^t[v++],a=(i[g>>>24]<<24|i[m>>>16&255]<<16|i[f>>>8&255]<<8|i[255&p])^t[v++],[s>>>=0,o>>>=0,a>>>=0,l=((i[m>>>24]<<24|i[f>>>16&255]<<16|i[p>>>8&255]<<8|i[255&g])^t[v++])>>>0]}var a=[0,1,2,4,8,16,32,64,128,27,54],l=function(){for(var e=Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var r=[],i=[],n=[[],[],[],[]],s=[[],[],[],[]],o=0,a=0,l=0;l<256;++l){var h=a^a<<1^a<<2^a<<3^a<<4;h=h>>>8^255&h^99,r[o]=h,i[h]=o;var u=e[o],c=e[u],d=e[c],f=257*e[h]^0x1010100*h;n[0][o]=f<<24|f>>>8,n[1][o]=f<<16|f>>>16,n[2][o]=f<<8|f>>>24,n[3][o]=f,f=0x1010101*d^65537*c^257*u^0x1010100*o,s[0][h]=f<<24|f>>>8,s[1][h]=f<<16|f>>>16,s[2][h]=f<<8|f>>>24,s[3][h]=f,0===o?o=a=1:(o=u^e[e[e[d^u]]],a^=e[e[a]])}return{SBOX:r,INV_SBOX:i,SUB_MIX:n,INV_SUB_MIX:s}}();function h(e){this._key=n(e),this._reset()}h.blockSize=16,h.keySize=32,h.prototype.blockSize=h.blockSize,h.prototype.keySize=h.keySize,h.prototype._reset=function(){for(var e=this._key,t=e.length,r=t+6,i=4*(r+1),n=[],s=0;s<t;s++)n[s]=e[s];for(s=t;s<i;s++){var o=n[s-1];s%t==0?(o=o<<8|o>>>24,o=(l.SBOX[o>>>24]<<24|l.SBOX[o>>>16&255]<<16|l.SBOX[o>>>8&255]<<8|l.SBOX[255&o])^a[s/t|0]<<24):t>6&&s%t==4&&(o=l.SBOX[o>>>24]<<24|l.SBOX[o>>>16&255]<<16|l.SBOX[o>>>8&255]<<8|l.SBOX[255&o]),n[s]=n[s-t]^o}for(var h=[],u=0;u<i;u++){var c=i-u,d=n[c-(u%4?0:4)];h[u]=u<4||c<=4?d:l.INV_SUB_MIX[0][l.SBOX[d>>>24]]^l.INV_SUB_MIX[1][l.SBOX[d>>>16&255]]^l.INV_SUB_MIX[2][l.SBOX[d>>>8&255]]^l.INV_SUB_MIX[3][l.SBOX[255&d]]}this._nRounds=r,this._keySchedule=n,this._invKeySchedule=h},h.prototype.encryptBlockRaw=function(e){return o(e=n(e),this._keySchedule,l.SUB_MIX,l.SBOX,this._nRounds)},h.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),r=i.allocUnsafe(16);return r.writeUInt32BE(t[0],0),r.writeUInt32BE(t[1],4),r.writeUInt32BE(t[2],8),r.writeUInt32BE(t[3],12),r},h.prototype.decryptBlock=function(e){var t=(e=n(e))[1];e[1]=e[3],e[3]=t;var r=o(e,this._invKeySchedule,l.INV_SUB_MIX,l.INV_SBOX,this._nRounds),s=i.allocUnsafe(16);return s.writeUInt32BE(r[0],0),s.writeUInt32BE(r[3],4),s.writeUInt32BE(r[2],8),s.writeUInt32BE(r[1],12),s},h.prototype.scrub=function(){s(this._keySchedule),s(this._invKeySchedule),s(this._key)},t.exports.AES=h},{"safe-buffer":494}],190:[function(e,t,r){"use strict";var i=e("./aes"),n=e("safe-buffer").Buffer,s=e("cipher-base"),o=e("inherits"),a=e("./ghash"),l=e("buffer-xor"),h=e("./incr32");function u(e,t,r,o){s.call(this);var l=n.alloc(4,0);this._cipher=new i.AES(t);var u=this._cipher.encryptBlock(l);this._ghash=new a(u),r=function(e,t,r){if(12===t.length)return e._finID=n.concat([t,n.from([0,0,0,1])]),n.concat([t,n.from([0,0,0,2])]);var i=new a(r),s=t.length,o=s%16;i.update(t),o&&(o=16-o,i.update(n.alloc(o,0))),i.update(n.alloc(8,0));var l=n.alloc(8);l.writeUIntBE(8*s,0,8),i.update(l),e._finID=i.state;var u=n.from(e._finID);return h(u),u}(this,r,u),this._prev=n.from(r),this._cache=n.allocUnsafe(0),this._secCache=n.allocUnsafe(0),this._decrypt=o,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}o(u,s),u.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=n.alloc(t,0),this._ghash.update(t))}this._called=!0;var r=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(r),this._len+=e.length,r},u.prototype._final=function(){if(this._decrypt&&!this._authTag)throw Error("Unsupported state or unable to authenticate data");var e=l(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(e,t){var r=0;e.length!==t.length&&r++;for(var i=Math.min(e.length,t.length),n=0;n<i;++n)r+=e[n]^t[n];return r}(e,this._authTag))throw Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},u.prototype.getAuthTag=function(){if(this._decrypt||!n.isBuffer(this._authTag))throw Error("Attempting to get auth tag in unsupported state");return this._authTag},u.prototype.setAuthTag=function(e){if(!this._decrypt)throw Error("Attempting to set auth tag in unsupported state");this._authTag=e},u.prototype.setAAD=function(e){if(this._called)throw Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},t.exports=u},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,t,r){"use strict";var i=e("./encrypter"),n=e("./decrypter"),s=e("./modes/list.json");r.createCipher=r.Cipher=i.createCipher,r.createCipheriv=r.Cipheriv=i.createCipheriv,r.createDecipher=r.Decipher=n.createDecipher,r.createDecipheriv=r.Decipheriv=n.createDecipheriv,r.listCiphers=r.getCiphers=function(){return Object.keys(s)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,t,r){"use strict";var i=e("./authCipher"),n=e("safe-buffer").Buffer,s=e("./modes"),o=e("./streamCipher"),a=e("cipher-base"),l=e("./aes"),h=e("evp_bytestokey");function u(e,t,r){a.call(this),this._cache=new c,this._last=void 0,this._cipher=new l.AES(t),this._prev=n.from(r),this._mode=e,this._autopadding=!0}function c(){this.cache=n.allocUnsafe(0)}function d(e,t,r){var a=s[e.toLowerCase()];if(!a)throw TypeError("invalid suite type");if("string"==typeof r&&(r=n.from(r)),"GCM"!==a.mode&&r.length!==a.iv)throw TypeError("invalid iv length "+r.length);if("string"==typeof t&&(t=n.from(t)),t.length!==a.key/8)throw TypeError("invalid key length "+t.length);return"stream"===a.type?new o(a.module,t,r,!0):"auth"===a.type?new i(a.module,t,r,!0):new u(a.module,t,r)}e("inherits")(u,a),u.prototype._update=function(e){var t,r;this._cache.add(e);for(var i=[];t=this._cache.get(this._autopadding);)r=this._mode.decrypt(this,t),i.push(r);return n.concat(i)},u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function(e){var t=e[15];if(t<1||t>16)throw Error("unable to decrypt data");for(var r=-1;++r<t;)if(e[r+(16-t)]!==t)throw Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},c.prototype.add=function(e){this.cache=n.concat([this.cache,e])},c.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},c.prototype.flush=function(){if(this.cache.length)return this.cache},r.createDecipher=function(e,t){var r=s[e.toLowerCase()];if(!r)throw TypeError("invalid suite type");var i=h(t,!1,r.key,r.iv);return d(e,i.key,i.iv)},r.createDecipheriv=d},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,t,r){"use strict";var i=e("./modes"),n=e("./authCipher"),s=e("safe-buffer").Buffer,o=e("./streamCipher"),a=e("cipher-base"),l=e("./aes"),h=e("evp_bytestokey");function u(e,t,r){a.call(this),this._cache=new d,this._cipher=new l.AES(t),this._prev=s.from(r),this._mode=e,this._autopadding=!0}e("inherits")(u,a),u.prototype._update=function(e){var t,r;this._cache.add(e);for(var i=[];t=this._cache.get();)r=this._mode.encrypt(this,t),i.push(r);return s.concat(i)};var c=s.alloc(16,16);function d(){this.cache=s.allocUnsafe(0)}function f(e,t,r){var a=i[e.toLowerCase()];if(!a)throw TypeError("invalid suite type");if("string"==typeof t&&(t=s.from(t)),t.length!==a.key/8)throw TypeError("invalid key length "+t.length);if("string"==typeof r&&(r=s.from(r)),"GCM"!==a.mode&&r.length!==a.iv)throw TypeError("invalid iv length "+r.length);return"stream"===a.type?new o(a.module,t,r):"auth"===a.type?new n(a.module,t,r):new u(a.module,t,r)}u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(c))throw this._cipher.scrub(),Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},d.prototype.add=function(e){this.cache=s.concat([this.cache,e])},d.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},d.prototype.flush=function(){for(var e=16-this.cache.length,t=s.allocUnsafe(e),r=-1;++r<e;)t.writeUInt8(e,r);return s.concat([this.cache,t])},r.createCipheriv=f,r.createCipher=function(e,t){var r=i[e.toLowerCase()];if(!r)throw TypeError("invalid suite type");var n=h(t,!1,r.key,r.iv);return f(e,n.key,n.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=i.alloc(16,0);function s(e){var t=i.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function o(e){this.h=e,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}o.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},o.prototype._multiply=function(){for(var e,t,r,i=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],n=[0,0,0,0],o=-1;++o<128;){for(0!=(this.state[~~(o/8)]&1<<7-o%8)&&(n[0]^=i[0],n[1]^=i[1],n[2]^=i[2],n[3]^=i[3]),r=0!=(1&i[3]),t=3;t>0;t--)i[t]=i[t]>>>1|(1&i[t-1])<<31;i[0]=i[0]>>>1,r&&(i[0]=-0x1f000000^i[0])}this.state=s(n)},o.prototype.update=function(e){var t;for(this.cache=i.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},o.prototype.final=function(e,t){return this.cache.length&&this.ghash(i.concat([this.cache,n],16)),this.ghash(s([0,e,0,t])),this.state},t.exports=o},{"safe-buffer":494}],195:[function(e,t,r){"use strict";t.exports=function(e){for(var t,r=e.length;r--;){if(255!==(t=e.readUInt8(r))){t++,e.writeUInt8(t,r);break}e.writeUInt8(0,r)}}},{}],196:[function(e,t,r){"use strict";var i=e("buffer-xor");r.encrypt=function(e,t){var r=i(t,e._prev);return e._prev=e._cipher.encryptBlock(r),e._prev},r.decrypt=function(e,t){var r=e._prev;return e._prev=t,i(e._cipher.decryptBlock(t),r)}},{"buffer-xor":219}],197:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("buffer-xor");function s(e,t,r){var s=t.length,o=n(t,e._cache);return e._cache=e._cache.slice(s),e._prev=i.concat([e._prev,r?t:o]),o}r.encrypt=function(e,t,r){for(var n,o=i.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=i.allocUnsafe(0)),!(e._cache.length<=t.length)){o=i.concat([o,s(e,t,r)]);break}n=e._cache.length,o=i.concat([o,s(e,t.slice(0,n),r)]),t=t.slice(n)}return o}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer;r.encrypt=function(e,t,r){for(var n=t.length,s=i.allocUnsafe(n),o=-1;++o<n;)s[o]=function(e,t,r){for(var n,s,o=-1,a=0;++o<8;)n=t&1<<7-o?128:0,a+=(128&(s=e._cipher.encryptBlock(e._prev)[0]^n))>>o%8,e._prev=function(e,t){var r=e.length,n=-1,s=i.allocUnsafe(e.length);for(e=i.concat([e,i.from([t])]);++n<r;)s[n]=e[n]<<1|e[n+1]>>7;return s}(e._prev,r?n:s);return a}(e,t[o],r);return s}},{"safe-buffer":494}],199:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer;r.encrypt=function(e,t,r){for(var n=t.length,s=i.allocUnsafe(n),o=-1;++o<n;)s[o]=function(e,t,r){var n=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=i.concat([e._prev.slice(1),i.from([r?t:n])]),n}(e,t[o],r);return s}},{"safe-buffer":494}],200:[function(e,t,r){"use strict";var i=e("buffer-xor"),n=e("safe-buffer").Buffer,s=e("../incr32");r.encrypt=function(e,t){var r=Math.ceil(t.length/16),o=e._cache.length;e._cache=n.concat([e._cache,n.allocUnsafe(16*r)]);for(var a=0;a<r;a++){var l=function(e){var t=e._cipher.encryptBlockRaw(e._prev);return s(e._prev),t}(e),h=o+16*a;e._cache.writeUInt32BE(l[0],h+0),e._cache.writeUInt32BE(l[1],h+4),e._cache.writeUInt32BE(l[2],h+8),e._cache.writeUInt32BE(l[3],h+12)}var u=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,u)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,t,r){"use strict";r.encrypt=function(e,t){return e._cipher.encryptBlock(t)},r.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},{}],202:[function(e,t,r){"use strict";var i={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},n=e("./list.json");for(var s in n)n[s].module=i[n[s].mode];t.exports=n},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,t,r){t.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,t,r){(function(t){(function(){"use strict";var i=e("buffer-xor");r.encrypt=function(e,r){for(;e._cache.length<r.length;){var n;e._cache=t.concat([e._cache,((n=e)._prev=n._cipher.encryptBlock(n._prev),n._prev)])}var s=e._cache.slice(0,r.length);return e._cache=e._cache.slice(r.length),i(r,s)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,t,r){"use strict";var i=e("./aes"),n=e("safe-buffer").Buffer,s=e("cipher-base");function o(e,t,r,o){s.call(this),this._cipher=new i.AES(t),this._prev=n.from(r),this._cache=n.allocUnsafe(0),this._secCache=n.allocUnsafe(0),this._decrypt=o,this._mode=e}e("inherits")(o,s),o.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},o.prototype._final=function(){this._cipher.scrub()},t.exports=o},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,t,r){"use strict";var i=e("browserify-des"),n=e("browserify-aes/browser"),s=e("browserify-aes/modes"),o=e("browserify-des/modes"),a=e("evp_bytestokey");function l(e,t,r){if(s[e=e.toLowerCase()])return n.createCipheriv(e,t,r);if(o[e])return new i({key:t,iv:r,mode:e});throw TypeError("invalid suite type")}function h(e,t,r){if(s[e=e.toLowerCase()])return n.createDecipheriv(e,t,r);if(o[e])return new i({key:t,iv:r,mode:e,decrypt:!0});throw TypeError("invalid suite type")}r.createCipher=r.Cipher=function(e,t){if(s[e=e.toLowerCase()])r=s[e].key,i=s[e].iv;else{if(!o[e])throw TypeError("invalid suite type");r=8*o[e].key,i=o[e].iv}var r,i,n=a(t,!1,r,i);return l(e,n.key,n.iv)},r.createCipheriv=r.Cipheriv=l,r.createDecipher=r.Decipher=function(e,t){if(s[e=e.toLowerCase()])r=s[e].key,i=s[e].iv;else{if(!o[e])throw TypeError("invalid suite type");r=8*o[e].key,i=o[e].iv}var r,i,n=a(t,!1,r,i);return h(e,n.key,n.iv)},r.createDecipheriv=r.Decipheriv=h,r.listCiphers=r.getCiphers=function(){return Object.keys(o).concat(n.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,t,r){"use strict";var i=e("cipher-base"),n=e("des.js"),s=e("inherits"),o=e("safe-buffer").Buffer,a={"des-ede3-cbc":n.CBC.instantiate(n.EDE),"des-ede3":n.EDE,"des-ede-cbc":n.CBC.instantiate(n.EDE),"des-ede":n.EDE,"des-cbc":n.CBC.instantiate(n.DES),"des-ecb":n.DES};function l(e){i.call(this);var t,r=e.mode.toLowerCase(),n=a[r];t=e.decrypt?"decrypt":"encrypt";var s=e.key;o.isBuffer(s)||(s=o.from(s)),"des-ede"!==r&&"des-ede-cbc"!==r||(s=o.concat([s,s.slice(0,8)]));var l=e.iv;o.isBuffer(l)||(l=o.from(l)),this._des=n.create({key:s,iv:l,type:t})}a.des=a["des-cbc"],a.des3=a["des-ede3-cbc"],t.exports=l,s(l,i),l.prototype._update=function(e){return o.from(this._des.update(e))},l.prototype._final=function(){return o.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,t,r){"use strict";r["des-ecb"]={key:8,iv:0},r["des-cbc"]=r.des={key:8,iv:8},r["des-ede3-cbc"]=r.des3={key:24,iv:8},r["des-ede3"]={key:24,iv:0},r["des-ede-cbc"]={key:16,iv:8},r["des-ede"]={key:16,iv:0}},{}],209:[function(e,t,r){(function(r){(function(){"use strict";var i=e("bn.js"),n=e("randombytes");function s(e){var t,r=e.modulus.byteLength();do t=new i(n(r));while(t.cmp(e.modulus)>=0||!t.umod(e.prime1)||!t.umod(e.prime2));return t}function o(e,t){var n,o,a={blinder:(o=s(n=t)).toRed(i.mont(n.modulus)).redPow(new i(n.publicExponent)).fromRed(),unblinder:o.invm(n.modulus)},l=t.modulus.byteLength(),h=new i(e).mul(a.blinder).umod(t.modulus),u=h.toRed(i.mont(t.prime1)),c=h.toRed(i.mont(t.prime2)),d=t.coefficient,f=t.prime1,p=t.prime2,g=u.redPow(t.exponent1).fromRed(),m=c.redPow(t.exponent2).fromRed(),v=g.isub(m).imul(d).umod(f).imul(p);return m.iadd(v).imul(a.unblinder).umod(t.modulus).toArrayLike(r,"be",l)}o.getr=s,t.exports=o}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,t,r){"use strict";t.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,t,r){t.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,t,r){t.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("create-hash"),s=e("readable-stream"),o=e("inherits"),a=e("./sign"),l=e("./verify"),h=e("./algorithms.json");function u(e){s.Writable.call(this);var t=h[e];if(!t)throw Error("Unknown message digest");this._hashType=t.hash,this._hash=n(t.hash),this._tag=t.id,this._signType=t.sign}function c(e){s.Writable.call(this);var t=h[e];if(!t)throw Error("Unknown message digest");this._hash=n(t.hash),this._tag=t.id,this._signType=t.sign}function d(e){return new u(e)}function f(e){return new c(e)}Object.keys(h).forEach(function(e){h[e].id=i.from(h[e].id,"hex"),h[e.toLowerCase()]=h[e]}),o(u,s.Writable),u.prototype._write=function(e,t,r){this._hash.update(e),r()},u.prototype.update=function(e,t){return"string"==typeof e&&(e=i.from(e,t)),this._hash.update(e),this},u.prototype.sign=function(e,t){this.end();var r=a(this._hash.digest(),e,this._hashType,this._signType,this._tag);return t?r.toString(t):r},o(c,s.Writable),c.prototype._write=function(e,t,r){this._hash.update(e),r()},c.prototype.update=function(e,t){return"string"==typeof e&&(e=i.from(e,t)),this._hash.update(e),this},c.prototype.verify=function(e,t,r){return"string"==typeof t&&(t=i.from(t,r)),this.end(),l(t,this._hash.digest(),e,this._signType,this._tag)},t.exports={Sign:d,Verify:f,createSign:d,createVerify:f}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("create-hmac"),s=e("browserify-rsa"),o=e("elliptic").ec,a=e("bn.js"),l=e("parse-asn1"),h=e("./curves.json");function u(e,t,r,s){if((e=i.from(e.toArray())).length<t.byteLength()){var o=i.alloc(t.byteLength()-e.length);e=i.concat([o,e])}var a=r.length,l=function(e,t){e=(e=c(e,t)).mod(t);var r=i.from(e.toArray());if(r.length<t.byteLength()){var n=i.alloc(t.byteLength()-r.length);r=i.concat([n,r])}return r}(r,t),h=i.alloc(a);h.fill(1);var u=i.alloc(a);return u=n(s,u).update(h).update(i.from([0])).update(e).update(l).digest(),h=n(s,u).update(h).digest(),{k:u=n(s,u).update(h).update(i.from([1])).update(e).update(l).digest(),v:h=n(s,u).update(h).digest()}}function c(e,t){var r=new a(e),i=(e.length<<3)-t.bitLength();return i>0&&r.ishrn(i),r}function d(e,t,r){var s,o;do{for(s=i.alloc(0);8*s.length<e.bitLength();)t.v=n(r,t.k).update(t.v).digest(),s=i.concat([s,t.v]);o=c(s,e),t.k=n(r,t.k).update(t.v).update(i.from([0])).digest(),t.v=n(r,t.k).update(t.v).digest()}while(-1!==o.cmp(e));return o}t.exports=function(e,t,r,n,f){var p=l(t);if(p.curve){if("ecdsa"!==n&&"ecdsa/rsa"!==n)throw Error("wrong private key type");return function(e,t){var r=h[t.curve.join(".")];if(!r)throw Error("unknown curve "+t.curve.join("."));var n=new o(r).keyFromPrivate(t.privateKey).sign(e);return i.from(n.toDER())}(e,p)}if("dsa"===p.type){if("dsa"!==n)throw Error("wrong private key type");return function(e,t,r){for(var n,s,o,l,h,f,p,g,m=t.params.priv_key,v=t.params.p,b=t.params.q,y=t.params.g,x=new a(0),_=c(e,b).mod(b),S=!1,w=u(m,b,e,r);!1===S;){;g=d(b,w,r),n=y,s=g,o=v,l=b,x=n.toRed(a.mont(o)).redPow(s).fromRed().mod(l),0===(S=g.invm(b).imul(_.add(m.mul(x))).mod(b)).cmpn(0)&&(S=!1,x=new a(0))}return h=x,f=S,h=h.toArray(),f=f.toArray(),128&h[0]&&(h=[0].concat(h)),128&f[0]&&(f=[0].concat(f)),p=(p=[48,h.length+f.length+4,2,h.length]).concat(h,[2,f.length],f),i.from(p)}(e,p,r)}if("rsa"!==n&&"ecdsa/rsa"!==n)throw Error("wrong private key type");e=i.concat([f,e]);for(var g=p.modulus.byteLength(),m=[0,1];e.length+m.length+1<g;)m.push(255);m.push(0);for(var v=-1;++v<e.length;)m.push(e[v]);return s(m,p)},t.exports.getKey=u,t.exports.makeKey=d},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("bn.js"),s=e("elliptic").ec,o=e("parse-asn1"),a=e("./curves.json");function l(e,t){if(0>=e.cmpn(0)||e.cmp(t)>=t)throw Error("invalid sig")}t.exports=function(e,t,r,h,u){var c,d,f,p,g,m,v,b,y,x,_,S,w=o(r);if("ec"===w.type){if("ecdsa"!==h&&"ecdsa/rsa"!==h)throw Error("wrong public key type");return function(e,t,r){var i=a[r.data.algorithm.curve.join(".")];if(!i)throw Error("unknown curve "+r.data.algorithm.curve.join("."));var n=new s(i),o=r.data.subjectPrivateKey.data;return n.verify(t,e,o)}(e,t,w)}if("dsa"===w.type){;if("dsa"!==h)throw Error("wrong public key type");return c=e,d=t,p=(f=w).data.p,g=f.data.q,m=f.data.g,v=f.data.pub_key,y=(b=o.signature.decode(c,"der")).s,x=b.r,l(y,g),l(x,g),_=n.mont(p),S=y.invm(g),0===m.toRed(_).redPow(new n(d).mul(S).mod(g)).fromRed().mul(v.toRed(_).redPow(x.mul(S).mod(g)).fromRed()).mod(p).mod(g).cmp(x)}if("rsa"!==h&&"ecdsa/rsa"!==h)throw Error("wrong public key type");t=i.concat([u,t]);for(var T=w.modulus.byteLength(),P=[1],E=0;t.length+P.length+2<T;)P.push(255),E++;P.push(0);for(var C=-1;++C<t.length;)P.push(t[C]);P=i.from(P);var A=n.mont(w.modulus);e=(e=new n(e).toRed(A)).redPow(new n(w.publicExponent));var I=E<8?1:0;for(T=Math.min((e=i.from(e.fromRed().toArray())).length,P.length),e.length!==P.length&&(I=1),C=-1;++C<T;)I|=e[C]^P[C];return 0===I}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,t,r){},{}],217:[function(e,t,r){"use strict";var i=e("buffer"),n=i.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=i:(s(i,r),r.Buffer=o),s(n,o),o.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:220}],218:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===n||!n(e)))throw Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=h,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=c,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function h(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}r.StringDecoder=s,s.prototype.write=function(e){var t,r;if(0===e.length)return"";if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var n=o(t[i]);return n>=0?(n>0&&(e.lastNeed=n-1),n):--i<r||-2===n?0:(n=o(t[i]))>=0?(n>0&&(e.lastNeed=n-2),n):--i<r||-2===n?0:(n=o(t[i]))>=0?(n>0&&(2===n?n=0:e.lastNeed=n-3),n):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":217}],219:[function(e,t,r){(function(e){(function(){"use strict";t.exports=function(t,r){for(var i=Math.min(t.length,r.length),n=new e(i),s=0;s<i;++s)n[s]=t[s]^r[s];return n}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,t,r){(function(t){(function(){"use strict";var t=e("base64-js"),i=e("ieee754");function n(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return l(e)}return o(e,t,r)}function o(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!s.isEncoding(t))throw TypeError("Unknown encoding: "+t);var r=0|c(e,t),i=n(r),o=i.write(e,t);return o!==r&&(i=i.slice(0,o)),i}(e,t);if(ArrayBuffer.isView(e))return h(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(C(e,ArrayBuffer)||e&&C(e.buffer,ArrayBuffer))return function(e,t,r){var i;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return(i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=s.prototype,i}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return s.from(i,t,r);var o=function(e){if(s.isBuffer(e)){var t=0|u(e.length),r=n(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?n(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return a(e),n(e<0?0:0|u(e))}function h(e){for(var t=e.length<0?0:0|u(e.length),r=n(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function u(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function c(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||C(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return T(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return P(e).length;default:if(n)return i?-1:T(e).length;t=(""+t).toLowerCase(),n=!0}}function d(e,r,i){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0)||(i>>>=0)<=(r>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=t;s<r;++s)n+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[s]);return n}(this,r,i);case"utf8":case"utf-8":return v(this,r,i);case"ascii":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}(this,r,i);case"latin1":case"binary":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}(this,r,i);case"base64":return function(e,r,i){return 0===r&&i===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,i))}(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var i=e.slice(t,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}(this,r,i);default:if(n)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function f(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function p(e,t,r,i,n){if(0===e.length)return -1;if("string"==typeof r?(i=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),function(e){return e!=e}(r=+r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return -1;r=e.length-1}else if(r<0){if(!n)return -1;r=0}if("string"==typeof t&&(t=s.from(t,i)),s.isBuffer(t))return 0===t.length?-1:g(e,t,r,i,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,i,n);throw TypeError("val must be string, number or Buffer")}function g(e,t,r,i,n){var s,o=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,r/=2}function h(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(n){var u=-1;for(s=r;s<a;s++)if(h(e,s)===h(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*o}else -1!==u&&(s-=s-u),u=-1}else for(r+l>a&&(r=a-l),s=r;s>=0;s--){for(var c=!0,d=0;d<l;d++)if(h(e,s+d)!==h(t,d)){c=!1;break}if(c)return s}return -1}r.Buffer=s,r.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},r.INSPECT_MAX_BYTES=50;function m(e,t,r,i){return E(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function v(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var s,o,a,l,h=e[n],u=null,c=h>239?4:h>223?3:h>191?2:1;if(n+c<=r)switch(c){case 1:h<128&&(u=h);break;case 2:128==(192&(s=e[n+1]))&&(l=(31&h)<<6|63&s)>127&&(u=l);break;case 3:s=e[n+1],o=e[n+2],128==(192&s)&&128==(192&o)&&(l=(15&h)<<12|(63&s)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:s=e[n+1],o=e[n+2],a=e[n+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(l=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,c=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=c}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",i=0;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}r.kMaxLength=0x7fffffff,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,r){return o(e,t,r)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,r){var i,s,o;return i=e,s=t,o=r,a(i),i<=0?n(i):void 0!==s?"string"==typeof o?n(i).fill(s,o):n(i).fill(s):n(i)},s.allocUnsafe=function(e){return l(e)},s.allocUnsafeSlow=function(e){return l(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(C(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),C(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,n=0,o=Math.min(r,i);n<o;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var r,i=s.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var o=e[r];if(C(o,Uint8Array)&&(o=s.from(o)),!s.isBuffer(o))throw TypeError('"list" argument must be an Array of Buffers');o.copy(i,n),n+=o.length}return i},s.byteLength=c,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s.prototype.compare=function(e,t,r,i,n){if(C(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return -1;if(t>=r)return 1;if(this===e)return 0;for(var o=(n>>>=0)-(i>>>=0),a=(r>>>=0)-(t>>>=0),l=Math.min(o,a),h=this.slice(i,n),u=e.slice(t,r),c=0;c<l;++c)if(h[c]!==u[c]){o=h[c],a=u[c];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},s.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n,s,o,a,l,h,u,c,d,f,p,g,v,b=this.length-t;if((void 0===r||r>b)&&(r=b),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var y=!1;;)switch(i){case"hex":return function(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=t.length;i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(t.substr(2*o,2),16);if(function(e){return e!=e}(a))break;e[r+o]=a}return o}(this,e,t,r);case"utf8":case"utf-8":;return n=this,s=e,o=t,a=r,E(T(s,n.length-o),n,o,a);case"ascii":return m(this,e,t,r);case"latin1":case"binary":;return l=this,m(l,e,t,r);case"base64":;return h=this,u=e,c=t,d=r,E(P(u),h,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":;return f=this,p=e,g=t,v=r,E(function(e,t){for(var r,i,n=[],s=0;s<e.length&&!((t-=2)<0);++s)i=(r=e.charCodeAt(s))>>8,n.push(r%256),n.push(i);return n}(p,f.length-g),f,g,v);default:if(y)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),y=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function b(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function y(e,t,r,i,n,o){if(!s.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<o)throw RangeError('"value" argument is out of bounds');if(r+i>e.length)throw RangeError("Index out of range")}function x(e,t,r,i,n,s){if(r+i>e.length||r<0)throw RangeError("Index out of range")}function _(e,t,r,n,s){return t=+t,r>>>=0,s||x(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function S(e,t,r,n,s){return t=+t,r>>>=0,s||x(e,0,r,8),i.write(e,t,r,n,52,8),r+8}s.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i=this.subarray(e,t);return i.__proto__=s.prototype,i},s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i},s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},s.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=t,n=1,s=this[e+--i];i>0&&(n*=256);)s+=this[e+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},s.prototype.readInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),i.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),i.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),i.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),i.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||y(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,s=0;for(this[t]=255&e;++s<r&&(n*=256);)this[t+s]=e/n&255;return t+r},s.prototype.writeUIntBE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||y(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+r},s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);y(this,e,t,r,n-1,-n)}var s=0,o=1,a=0;for(this[t]=255&e;++s<r&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+r},s.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);y(this,e,t,r,n-1,-n)}var s=r-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||y(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,r){return _(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return _(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return S(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return S(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,i){if(!s.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n=i-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,i);else if(this===e&&r<t&&t<i)for(var o=n-1;o>=0;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,i),t);return n},s.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!s.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){var n,o=e.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(e=o)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{var a=s.isBuffer(e)?e:s.from(e,i),l=a.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=a[n%l]}return this};var w=/[^+/0-9A-Za-z-_]/g;function T(e,t){var r;t=t||1/0;for(var i=e.length,n=null,s=[],o=0;o<i;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!n){if(r>56319||o+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function P(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(w,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function E(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function C(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function A(e){return e!=e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("stream").Transform,s=e("string_decoder").StringDecoder;function o(e){n.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(o,n),o.prototype.update=function(e,t,r){"string"==typeof e&&(e=i.from(e,t));var n=this._update(e);return this.hashMode?this:(r&&(n=this._toString(n,r)),n)},o.prototype.setAutoPadding=function(){},o.prototype.getAuthTag=function(){throw Error("trying to get auth tag in unsupported state")},o.prototype.setAuthTag=function(){throw Error("trying to set auth tag in unsupported state")},o.prototype.setAAD=function(){throw Error("trying to set aad in unsupported state")},o.prototype._transform=function(e,t,r){var i;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){i=e}finally{r(i)}},o.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},o.prototype._finalOrDigest=function(e){var t=this.__final()||i.alloc(0);return e&&(t=this._toString(t,e,!0)),t},o.prototype._toString=function(e,t,r){if(this._decoder||(this._decoder=new s(t),this._encoding=t),this._encoding!==t)throw Error("can't switch encodings");var i=this._decoder.write(e);return r&&(i+=this._decoder.end()),i},t.exports=o},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,t,r){"use strict";var i=e("../internals/is-callable"),n=e("../internals/try-to-string"),s=TypeError;t.exports=function(e){if(i(e))return e;throw new s(n(e)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,t,r){"use strict";var i=e("../internals/is-constructor"),n=e("../internals/try-to-string"),s=TypeError;t.exports=function(e){if(i(e))return e;throw new s(n(e)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,t,r){"use strict";var i=e("../internals/is-callable"),n=String,s=TypeError;t.exports=function(e){if("object"==typeof e||i(e))return e;throw new s("Can't set "+n(e)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,t,r){"use strict";var i=e("../internals/well-known-symbol"),n=e("../internals/object-create"),s=e("../internals/object-define-property").f,o=i("unscopables"),a=Array.prototype;void 0===a[o]&&s(a,o,{configurable:!0,value:n(null)}),t.exports=function(e){a[o][e]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,t,r){"use strict";var i=e("../internals/object-is-prototype-of"),n=TypeError;t.exports=function(e,t){if(i(t,e))return e;throw new n("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,t,r){"use strict";var i=e("../internals/is-object"),n=String,s=TypeError;t.exports=function(e){if(i(e))return e;throw new s(n(e)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,t,r){"use strict";var i=e("../internals/to-indexed-object"),n=e("../internals/to-absolute-index"),s=e("../internals/length-of-array-like"),o=function(e){return function(t,r,o){var a,l=i(t),h=s(l),u=n(o,h);if(e&&r!=r){for(;h>u;)if((a=l[u++])!=a)return!0}else for(;h>u;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,t,r){"use strict";var i=e("../internals/function-bind-context"),n=e("../internals/function-uncurry-this"),s=e("../internals/indexed-object"),o=e("../internals/to-object"),a=e("../internals/length-of-array-like"),l=e("../internals/array-species-create"),h=n([].push),u=function(e){var t=1===e,r=2===e,n=3===e,u=4===e,c=6===e,d=7===e,f=5===e||c;return function(p,g,m,v){for(var b,y,x=o(p),_=s(x),S=i(g,m),w=a(_),T=0,P=v||l,E=t?P(p,w):r||d?P(p,0):void 0;w>T;T++)if((f||T in _)&&(y=S(b=_[T],T,x),e)){if(t)E[T]=y;else if(y)switch(e){case 3:return!0;case 5:return b;case 6:return T;case 2:h(E,b)}else switch(e){case 4:return!1;case 7:h(E,b)}}return c?-1:n||u?u:E}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,t,r){"use strict";var i=e("../internals/to-absolute-index"),n=e("../internals/length-of-array-like"),s=e("../internals/create-property"),o=Array,a=Math.max;t.exports=function(e,t,r){for(var l=n(e),h=i(t,l),u=i(void 0===r?l:r,l),c=o(a(u-h,0)),d=0;h<u;h++,d++)s(c,d,e[h]);return c.length=d,c}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this");t.exports=i([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,t,r){"use strict";var i=e("../internals/is-array"),n=e("../internals/is-constructor"),s=e("../internals/is-object"),o=e("../internals/well-known-symbol")("species"),a=Array;t.exports=function(e){var t;return i(e)&&(n(t=e.constructor)&&(t===a||i(t.prototype))||s(t)&&null===(t=t[o]))&&(t=void 0),void 0===t?a:t}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,t,r){"use strict";var i=e("../internals/array-species-constructor");t.exports=function(e,t){return new(i(e))(0===t?0:t)}},{"../internals/array-species-constructor":232}],234:[function(e,t,r){"use strict";var i=e("../internals/well-known-symbol")("iterator"),n=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){n=!0}};o[i]=function(){return this},Array.from(o,function(){throw 2})}catch(e){}t.exports=function(e,t){try{if(!t&&!n)return!1}catch(e){return!1}var r=!1;try{var s={};s[i]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch(e){}return r}},{"../internals/well-known-symbol":357}],235:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=i({}.toString),s=i("".slice);t.exports=function(e){return s(n(e),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,t,r){"use strict";var i=e("../internals/to-string-tag-support"),n=e("../internals/is-callable"),s=e("../internals/classof-raw"),o=e("../internals/well-known-symbol")("toStringTag"),a=Object,l="Arguments"===s(function(){return arguments}());t.exports=i?s:function(e){var t,r,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=a(e),o))?r:l?s(t):"Object"===(i=s(t))&&n(t.callee)?"Arguments":i}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,t,r){"use strict";var i=e("../internals/has-own-property"),n=e("../internals/own-keys"),s=e("../internals/object-get-own-property-descriptor"),o=e("../internals/object-define-property");t.exports=function(e,t,r){for(var a=n(t),l=o.f,h=s.f,u=0;u<a.length;u++){var c=a[u];i(e,c)||r&&i(r,c)||l(e,c,h(t,c))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,t,r){"use strict";var i=e("../internals/well-known-symbol")("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[i]=!1,"/./"[e](t)}catch(e){}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,t,r){"use strict";var i=e("../internals/fails");t.exports=!i(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},{"../internals/fails":260}],240:[function(e,t,r){"use strict";t.exports=function(e,t){return{value:e,done:t}}},{}],241:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=i?function(e,t,r){return n.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,t,r){"use strict";t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],243:[function(e,t,r){"use strict";var i=e("../internals/to-property-key"),n=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=function(e,t,r){var o=i(t);o in e?n.f(e,o,s(0,r)):e[o]=r}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,t,r){"use strict";var i=e("../internals/make-built-in"),n=e("../internals/object-define-property");t.exports=function(e,t,r){return r.get&&i(r.get,t,{getter:!0}),r.set&&i(r.set,t,{setter:!0}),n.f(e,t,r)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,t,r){"use strict";var i=e("../internals/is-callable"),n=e("../internals/object-define-property"),s=e("../internals/make-built-in"),o=e("../internals/define-global-property");t.exports=function(e,t,r,a){a||(a={});var l=a.enumerable,h=void 0!==a.name?a.name:t;if(i(r)&&s(r,h,a),a.global)l?e[t]=r:o(t,r);else{try{a.unsafe?e[t]&&(l=!0):delete e[t]}catch(e){}l?e[t]=r:n.f(e,t,{value:r,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,t,r){"use strict";var i=e("../internals/global"),n=Object.defineProperty;t.exports=function(e,t){try{n(i,e,{value:t,configurable:!0,writable:!0})}catch(r){i[e]=t}return t}},{"../internals/global":274}],247:[function(e,t,r){"use strict";var i=e("../internals/fails");t.exports=!i(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},{"../internals/fails":260}],248:[function(e,t,r){"use strict";var i="object"==typeof document&&document.all;t.exports={all:i,IS_HTMLDDA:void 0===i&&void 0!==i}},{}],249:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/is-object"),s=i.document,o=n(s)&&n(s.createElement);t.exports=function(e){return o?s.createElement(e):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,t,r){"use strict";var i=e("../internals/engine-is-deno"),n=e("../internals/engine-is-node");t.exports=!i&&!n&&"object"==typeof window&&"object"==typeof document},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,t,r){"use strict";t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},{}],252:[function(e,t,r){"use strict";var i=e("../internals/engine-user-agent");t.exports=/ipad|iphone|ipod/i.test(i)&&"undefined"!=typeof Pebble},{"../internals/engine-user-agent":256}],253:[function(e,t,r){"use strict";var i=e("../internals/engine-user-agent");t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},{"../internals/engine-user-agent":256}],254:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/classof-raw");t.exports="process"===n(i.process)},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,t,r){"use strict";var i=e("../internals/engine-user-agent");t.exports=/web0s(?!.*chrome)/i.test(i)},{"../internals/engine-user-agent":256}],256:[function(e,t,r){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},{}],257:[function(e,t,r){"use strict";var i,n,s=e("../internals/global"),o=e("../internals/engine-user-agent"),a=s.process,l=s.Deno,h=a&&a.versions||l&&l.version,u=h&&h.v8;u&&(n=(i=u.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!n&&o&&(!(i=o.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=o.match(/Chrome\/(\d+)/))&&(n=+i[1]),t.exports=n},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,t,r){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/create-non-enumerable-property"),o=e("../internals/define-built-in"),a=e("../internals/define-global-property"),l=e("../internals/copy-constructor-properties"),h=e("../internals/is-forced");t.exports=function(e,t){var r,u,c,d,f,p=e.target,g=e.global,m=e.stat;if(r=g?i:m?i[p]||a(p,{}):(i[p]||{}).prototype)for(u in t){if(d=t[u],c=e.dontCallGetSet?(f=n(r,u))&&f.value:r[u],!h(g?u:p+(m?".":"#")+u,e.forced)&&void 0!==c){if(typeof d==typeof c)continue;l(d,c)}(e.sham||c&&c.sham)&&s(d,"sham",!0),o(r,u,d,e)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,t,r){"use strict";t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],261:[function(e,t,r){"use strict";var i=e("../internals/function-bind-native"),n=Function.prototype,s=n.apply,o=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?o.bind(s):function(){return o.apply(s,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this-clause"),n=e("../internals/a-callable"),s=e("../internals/function-bind-native"),o=i(i.bind);t.exports=function(e,t){return n(e),void 0===t?e:s?o(e,t):function(){return e.apply(t,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,t,r){"use strict";var i=e("../internals/fails");t.exports=!i(function(){var e=(function(){}).bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(e,t,r){"use strict";var i=e("../internals/function-bind-native"),n=Function.prototype.call;t.exports=i?n.bind(n):function(){return n.apply(n,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/has-own-property"),s=Function.prototype,o=i&&Object.getOwnPropertyDescriptor,a=n(s,"name"),l=a&&(!i||i&&o(s,"name").configurable);t.exports={EXISTS:a,PROPER:a&&"something"===(function(){}).name,CONFIGURABLE:l}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/a-callable");t.exports=function(e,t,r){try{return i(n(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(e){}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,t,r){"use strict";var i=e("../internals/classof-raw"),n=e("../internals/function-uncurry-this");t.exports=function(e){if("Function"===i(e))return n(e)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,t,r){"use strict";var i=e("../internals/function-bind-native"),n=Function.prototype,s=n.call,o=i&&n.bind.bind(s,s);t.exports=i?o:function(e){return function(){return s.apply(e,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/is-callable");t.exports=function(e,t){var r;return arguments.length<2?n(r=i[e])?r:void 0:i[e]&&i[e][t]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,t,r){"use strict";var i=e("../internals/classof"),n=e("../internals/get-method"),s=e("../internals/is-null-or-undefined"),o=e("../internals/iterators"),a=e("../internals/well-known-symbol")("iterator");t.exports=function(e){if(!s(e))return n(e,a)||n(e,"@@iterator")||o[i(e)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,t,r){"use strict";var i=e("../internals/function-call"),n=e("../internals/a-callable"),s=e("../internals/an-object"),o=e("../internals/try-to-string"),a=e("../internals/get-iterator-method"),l=TypeError;t.exports=function(e,t){var r=arguments.length<2?a(e):t;if(n(r))return s(i(r,e));throw new l(o(e)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/is-array"),s=e("../internals/is-callable"),o=e("../internals/classof-raw"),a=e("../internals/to-string"),l=i([].push);t.exports=function(e){if(s(e))return e;if(n(e)){for(var t=e.length,r=[],i=0;i<t;i++){var h=e[i];"string"==typeof h?l(r,h):"number"!=typeof h&&"Number"!==o(h)&&"String"!==o(h)||l(r,a(h))}var u=r.length,c=!0;return function(e,t){if(c)return c=!1,t;if(n(this))return t;for(var i=0;i<u;i++)if(r[i]===e)return t}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,t,r){"use strict";var i=e("../internals/a-callable"),n=e("../internals/is-null-or-undefined");t.exports=function(e,t){var r=e[t];return n(r)?void 0:i(r)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,t,i){(function(e){(function(){"use strict";var r=function(e){return e&&e.Math===Math&&e};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],275:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/to-object"),s=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(e,t){return s(n(e),t)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,t,r){"use strict";t.exports={}},{}],277:[function(e,t,r){"use strict";t.exports=function(e,t){try{1==arguments.length?console.error(e):console.error(e,t)}catch(e){}}},{}],278:[function(e,t,r){"use strict";var i=e("../internals/get-built-in");t.exports=i("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/fails"),s=e("../internals/document-create-element");t.exports=!i&&!n(function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/fails"),s=e("../internals/classof-raw"),o=Object,a=i("".split);t.exports=n(function(){return!o("z").propertyIsEnumerable(0)})?function(e){return"String"===s(e)?a(e,""):o(e)}:o},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/is-callable"),s=e("../internals/shared-store"),o=i(Function.toString);n(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),t.exports=s.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,t,r){"use strict";var i,n,s,o=e("../internals/weak-map-basic-detection"),a=e("../internals/global"),l=e("../internals/is-object"),h=e("../internals/create-non-enumerable-property"),u=e("../internals/has-own-property"),c=e("../internals/shared-store"),d=e("../internals/shared-key"),f=e("../internals/hidden-keys"),p=a.TypeError,g=a.WeakMap;if(o||c.state){var m=c.state||(c.state=new g);m.get=m.get,m.has=m.has,m.set=m.set,i=function(e,t){if(m.has(e))throw new p("Object already initialized");return t.facade=e,m.set(e,t),t},n=function(e){return m.get(e)||{}},s=function(e){return m.has(e)}}else{var v=d("state");f[v]=!0,i=function(e,t){if(u(e,v))throw new p("Object already initialized");return t.facade=e,h(e,v,t),t},n=function(e){return u(e,v)?e[v]:{}},s=function(e){return u(e,v)}}t.exports={set:i,get:n,has:s,enforce:function(e){return s(e)?n(e):i(e,{})},getterFor:function(e){return function(t){var r;if(!l(t)||(r=n(t)).type!==e)throw new p("Incompatible receiver, "+e+" required");return r}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,t,r){"use strict";var i=e("../internals/well-known-symbol"),n=e("../internals/iterators"),s=i("iterator"),o=Array.prototype;t.exports=function(e){return void 0!==e&&(n.Array===e||o[s]===e)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,t,r){"use strict";var i=e("../internals/classof-raw");t.exports=Array.isArray||function(e){return"Array"===i(e)}},{"../internals/classof-raw":235}],285:[function(e,t,r){"use strict";var i=e("../internals/document-all"),n=i.all;t.exports=i.IS_HTMLDDA?function(e){return"function"==typeof e||e===n}:function(e){return"function"==typeof e}},{"../internals/document-all":248}],286:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/fails"),s=e("../internals/is-callable"),o=e("../internals/classof"),a=e("../internals/get-built-in"),l=e("../internals/inspect-source"),h=function(){},u=[],c=a("Reflect","construct"),d=/^\s*(?:class|function)\b/,f=i(d.exec),p=!d.test(h),g=function(e){if(!s(e))return!1;try{return c(h,u,e),!0}catch(e){return!1}},m=function(e){if(!s(e))return!1;switch(o(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!f(d,l(e))}catch(e){return!0}};m.sham=!0,t.exports=!c||n(function(){var e;return g(g.call)||!g(Object)||!g(function(){e=!0})||e})?m:g},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,t,r){"use strict";var i=e("../internals/fails"),n=e("../internals/is-callable"),s=/#|\.prototype\./,o=function(e,t){var r=l[a(e)];return r===u||r!==h&&(n(t)?i(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},l=o.data={},h=o.NATIVE="N",u=o.POLYFILL="P";t.exports=o},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,t,r){"use strict";t.exports=function(e){return null==e}},{}],289:[function(e,t,r){"use strict";var i=e("../internals/is-callable"),n=e("../internals/document-all"),s=n.all;t.exports=n.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:i(e)||e===s}:function(e){return"object"==typeof e?null!==e:i(e)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,t,r){"use strict";t.exports=!1},{}],291:[function(e,t,r){"use strict";var i=e("../internals/is-object"),n=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("match");t.exports=function(e){var t;return i(e)&&(void 0!==(t=e[s])?!!t:"RegExp"===n(e))}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,t,r){"use strict";var i=e("../internals/get-built-in"),n=e("../internals/is-callable"),s=e("../internals/object-is-prototype-of"),o=e("../internals/use-symbol-as-uid"),a=Object;t.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return n(t)&&s(t.prototype,a(e))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,t,r){"use strict";var i=e("../internals/function-bind-context"),n=e("../internals/function-call"),s=e("../internals/an-object"),o=e("../internals/try-to-string"),a=e("../internals/is-array-iterator-method"),l=e("../internals/length-of-array-like"),h=e("../internals/object-is-prototype-of"),u=e("../internals/get-iterator"),c=e("../internals/get-iterator-method"),d=e("../internals/iterator-close"),f=TypeError,p=function(e,t){this.stopped=e,this.result=t},g=p.prototype;t.exports=function(e,t,r){var m,v,b,y,x,_,S,w=r&&r.that,T=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_RECORD),E=!(!r||!r.IS_ITERATOR),C=!(!r||!r.INTERRUPTED),A=i(t,w),I=function(e){return m&&d(m,"normal",e),new p(!0,e)},M=function(e){return T?(s(e),C?A(e[0],e[1],I):A(e[0],e[1])):C?A(e,I):A(e)};if(P)m=e.iterator;else if(E)m=e;else{if(!(v=c(e)))throw new f(o(e)+" is not iterable");if(a(v)){for(b=0,y=l(e);y>b;b++)if((x=M(e[b]))&&h(g,x))return x;return new p(!1)}m=u(e,v)}for(_=P?e.next:m.next;!(S=n(_,m)).done;){try{x=M(S.value)}catch(e){d(m,"throw",e)}if("object"==typeof x&&x&&h(g,x))return x}return new p(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,t,r){"use strict";var i=e("../internals/function-call"),n=e("../internals/an-object"),s=e("../internals/get-method");t.exports=function(e,t,r){var o,a;n(e);try{if(!(o=s(e,"return"))){if("throw"===t)throw r;return r}o=i(o,e)}catch(e){a=!0,o=e}if("throw"===t)throw r;if(a)throw o;return n(o),r}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,t,r){"use strict";var i=e("../internals/iterators-core").IteratorPrototype,n=e("../internals/object-create"),s=e("../internals/create-property-descriptor"),o=e("../internals/set-to-string-tag"),a=e("../internals/iterators"),l=function(){return this};t.exports=function(e,t,r,h){var u=t+" Iterator";return e.prototype=n(i,{next:s(+!h,r)}),o(e,u,!1,!0),a[u]=l,e}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/function-call"),s=e("../internals/is-pure"),o=e("../internals/function-name"),a=e("../internals/is-callable"),l=e("../internals/iterator-create-constructor"),h=e("../internals/object-get-prototype-of"),u=e("../internals/object-set-prototype-of"),c=e("../internals/set-to-string-tag"),d=e("../internals/create-non-enumerable-property"),f=e("../internals/define-built-in"),p=e("../internals/well-known-symbol"),g=e("../internals/iterators"),m=e("../internals/iterators-core"),v=o.PROPER,b=o.CONFIGURABLE,y=m.IteratorPrototype,x=m.BUGGY_SAFARI_ITERATORS,_=p("iterator"),S=function(){return this};t.exports=function(e,t,r,o,p,m,w){l(r,t,o);var T,P,E,C=function(e){if(e===p&&O)return O;if(!x&&e&&e in M)return M[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},A=t+" Iterator",I=!1,M=e.prototype,R=M[_]||M["@@iterator"]||p&&M[p],O=!x&&R||C(p),k="Array"===t&&M.entries||R;if(k&&(T=h(k.call(new e)))!==Object.prototype&&T.next&&(s||h(T)===y||(u?u(T,y):a(T[_])||f(T,_,S)),c(T,A,!0,!0),s&&(g[A]=S)),v&&"values"===p&&R&&"values"!==R.name&&(!s&&b?d(M,"name","values"):(I=!0,O=function(){return n(R,this)})),p){if(P={values:C("values"),keys:m?O:C("keys"),entries:C("entries")},w)for(E in P)!x&&!I&&E in M||f(M,E,P[E]);else i({target:t,proto:!0,forced:x||I},P)}return s&&!w||M[_]===O||f(M,_,O,{name:p}),g[t]=O,P}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,t,r){"use strict";var i,n,s,o=e("../internals/fails"),a=e("../internals/is-callable"),l=e("../internals/is-object"),h=e("../internals/object-create"),u=e("../internals/object-get-prototype-of"),c=e("../internals/define-built-in"),d=e("../internals/well-known-symbol"),f=e("../internals/is-pure"),p=d("iterator"),g=!1;[].keys&&("next"in(s=[].keys())?(n=u(u(s)))!==Object.prototype&&(i=n):g=!0),!l(i)||o(function(){var e={};return i[p].call(e)!==e})?i={}:f&&(i=h(i)),a(i[p])||c(i,p,function(){return this}),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:g}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,t,r){arguments[4][276][0].apply(r,arguments)},{dup:276}],299:[function(e,t,r){"use strict";var i=e("../internals/to-length");t.exports=function(e){return i(e.length)}},{"../internals/to-length":343}],300:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/fails"),s=e("../internals/is-callable"),o=e("../internals/has-own-property"),a=e("../internals/descriptors"),l=e("../internals/function-name").CONFIGURABLE,h=e("../internals/inspect-source"),u=e("../internals/internal-state"),c=u.enforce,d=u.get,f=String,p=Object.defineProperty,g=i("".slice),m=i("".replace),v=i([].join),b=a&&!n(function(){return 8!==p(function(){},"length",{value:8}).length}),y=String(String).split("String"),x=t.exports=function(e,t,r){"Symbol("===g(f(t),0,7)&&(t="["+m(f(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!o(e,"name")||l&&e.name!==t)&&(a?p(e,"name",{value:t,configurable:!0}):e.name=t),b&&r&&o(r,"arity")&&e.length!==r.arity&&p(e,"length",{value:r.arity});try{r&&o(r,"constructor")&&r.constructor?a&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var i=c(e);return o(i,"source")||(i.source=v(y,"string"==typeof t?t:"")),e};Function.prototype.toString=x(function(){return s(this)&&d(this).source||h(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,t,r){"use strict";var i=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(e){var t=+e;return(t>0?n:i)(t)}},{}],302:[function(e,t,r){"use strict";var i,n,s,o,a,l=e("../internals/global"),h=e("../internals/function-bind-context"),u=e("../internals/object-get-own-property-descriptor").f,c=e("../internals/task").set,d=e("../internals/queue"),f=e("../internals/engine-is-ios"),p=e("../internals/engine-is-ios-pebble"),g=e("../internals/engine-is-webos-webkit"),m=e("../internals/engine-is-node"),v=l.MutationObserver||l.WebKitMutationObserver,b=l.document,y=l.process,x=l.Promise,_=u(l,"queueMicrotask"),S=_&&_.value;if(!S){var w=new d,T=function(){var e,t;for(m&&(e=y.domain)&&e.exit();t=w.get();)try{t()}catch(e){throw w.head&&i(),e}e&&e.enter()};f||m||g||!v||!b?!p&&x&&x.resolve?((o=x.resolve(void 0)).constructor=x,a=h(o.then,o),i=function(){a(T)}):m?i=function(){y.nextTick(T)}:(c=h(c,l),i=function(){c(T)}):(n=!0,s=b.createTextNode(""),new v(T).observe(s,{characterData:!0}),i=function(){s.data=n=!n}),S=function(e){w.head||i(),w.add(e)}}t.exports=S},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,t,r){"use strict";var i=e("../internals/a-callable"),n=TypeError,s=function(e){var t,r;this.promise=new e(function(e,i){if(void 0!==t||void 0!==r)throw new n("Bad Promise constructor");t=e,r=i}),this.resolve=i(t),this.reject=i(r)};t.exports.f=function(e){return new s(e)}},{"../internals/a-callable":222}],304:[function(e,t,r){"use strict";var i=e("../internals/is-regexp"),n=TypeError;t.exports=function(e){if(i(e))throw new n("The method doesn't accept regular expressions");return e}},{"../internals/is-regexp":291}],305:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/function-uncurry-this"),s=e("../internals/function-call"),o=e("../internals/fails"),a=e("../internals/object-keys"),l=e("../internals/object-get-own-property-symbols"),h=e("../internals/object-property-is-enumerable"),u=e("../internals/to-object"),c=e("../internals/indexed-object"),d=Object.assign,f=Object.defineProperty,p=n([].concat);t.exports=!d||o(function(){if(i&&1!==d({b:1},d(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol("assign detection");return e[r]=7,"abcdefghijklmnopqrst".split("").forEach(function(e){t[e]=e}),7!==d({},e)[r]||"abcdefghijklmnopqrst"!==a(d({},t)).join("")})?function(e,t){for(var r=u(e),n=arguments.length,o=1,d=l.f,f=h.f;n>o;)for(var g,m=c(arguments[o++]),v=d?p(a(m),d(m)):a(m),b=v.length,y=0;b>y;)g=v[y++],i&&!s(f,m,g)||(r[g]=m[g]);return r}:d},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,t,r){"use strict";var i,n=e("../internals/an-object"),s=e("../internals/object-define-properties"),o=e("../internals/enum-bug-keys"),a=e("../internals/hidden-keys"),l=e("../internals/html"),h=e("../internals/document-create-element"),u=e("../internals/shared-key")("IE_PROTO"),c=function(){},d=function(e){return"<script>"+e+"<\/script>"},f=function(e){e.write(d("")),e.close();var t=e.parentWindow.Object;return e=null,t},p=function(){try{i=new ActiveXObject("htmlfile")}catch(e){}p="undefined"!=typeof document?document.domain&&i?f(i):((t=h("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):f(i);for(var e,t,r=o.length;r--;)delete p.prototype[o[r]];return p()};a[u]=!0,t.exports=Object.create||function(e,t){var r;return null!==e?(c.prototype=n(e),r=new c,c.prototype=null,r[u]=e):r=p(),void 0===t?r:s.f(r,t)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/v8-prototype-define-bug"),s=e("../internals/object-define-property"),o=e("../internals/an-object"),a=e("../internals/to-indexed-object"),l=e("../internals/object-keys");r.f=i&&!n?Object.defineProperties:function(e,t){o(e);for(var r,i=a(t),n=l(t),h=n.length,u=0;h>u;)s.f(e,r=n[u++],i[r]);return e}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/ie8-dom-define"),s=e("../internals/v8-prototype-define-bug"),o=e("../internals/an-object"),a=e("../internals/to-property-key"),l=TypeError,h=Object.defineProperty,u=Object.getOwnPropertyDescriptor;r.f=i?s?function(e,t,r){if(o(e),t=a(t),o(r),"function"==typeof e&&"prototype"===t&&"value"in r&&"writable"in r&&!r.writable){var i=u(e,t);i&&i.writable&&(e[t]=r.value,r={configurable:"configurable"in r?r.configurable:i.configurable,enumerable:"enumerable"in r?r.enumerable:i.enumerable,writable:!1})}return h(e,t,r)}:h:function(e,t,r){if(o(e),t=a(t),o(r),n)try{return h(e,t,r)}catch(e){}if("get"in r||"set"in r)throw new l("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/function-call"),s=e("../internals/object-property-is-enumerable"),o=e("../internals/create-property-descriptor"),a=e("../internals/to-indexed-object"),l=e("../internals/to-property-key"),h=e("../internals/has-own-property"),u=e("../internals/ie8-dom-define"),c=Object.getOwnPropertyDescriptor;r.f=i?c:function(e,t){if(e=a(e),t=l(t),u)try{return c(e,t)}catch(e){}if(h(e,t))return o(!n(s.f,e,t),e[t])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,t,r){"use strict";var i=e("../internals/classof-raw"),n=e("../internals/to-indexed-object"),s=e("../internals/object-get-own-property-names").f,o=e("../internals/array-slice-simple"),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){return a&&"Window"===i(e)?function(e){try{return s(e)}catch(e){return o(a)}}(e):s(n(e))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,t,r){"use strict";var i=e("../internals/object-keys-internal"),n=e("../internals/enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return i(e,n)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,t,r){"use strict";r.f=Object.getOwnPropertySymbols},{}],313:[function(e,t,r){"use strict";var i=e("../internals/has-own-property"),n=e("../internals/is-callable"),s=e("../internals/to-object"),o=e("../internals/shared-key"),a=e("../internals/correct-prototype-getter"),l=o("IE_PROTO"),h=Object,u=h.prototype;t.exports=a?h.getPrototypeOf:function(e){var t=s(e);if(i(t,l))return t[l];var r=t.constructor;return n(r)&&t instanceof r?r.prototype:t instanceof h?u:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this");t.exports=i({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=e("../internals/has-own-property"),s=e("../internals/to-indexed-object"),o=e("../internals/array-includes").indexOf,a=e("../internals/hidden-keys"),l=i([].push);t.exports=function(e,t){var r,i=s(e),h=0,u=[];for(r in i)!n(a,r)&&n(i,r)&&l(u,r);for(;t.length>h;)n(i,r=t[h++])&&(~o(u,r)||l(u,r));return u}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,t,r){"use strict";var i=e("../internals/object-keys-internal"),n=e("../internals/enum-bug-keys");t.exports=Object.keys||function(e){return i(e,n)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,t,r){"use strict";var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!i.call({1:2},1);r.f=s?function(e){var t=n(this,e);return!!t&&t.enumerable}:i},{}],318:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this-accessor"),n=e("../internals/an-object"),s=e("../internals/a-possible-prototype");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=i(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(e){}return function(r,i){return n(r),s(i),t?e(r,i):r.__proto__=i,r}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/fails"),s=e("../internals/function-uncurry-this"),o=e("../internals/object-get-prototype-of"),a=e("../internals/object-keys"),l=e("../internals/to-indexed-object"),h=s(e("../internals/object-property-is-enumerable").f),u=s([].push),c=i&&n(function(){var e=Object.create(null);return e[2]=2,!h(e,2)}),d=function(e){return function(t){for(var r,n=l(t),s=a(n),d=c&&null===o(n),f=s.length,p=0,g=[];f>p;)r=s[p++],(!i||(d?r in n:h(n,r)))&&u(g,e?[r,n[r]]:n[r]);return g}};t.exports={entries:d(!0),values:d(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,t,r){"use strict";var i=e("../internals/function-call"),n=e("../internals/is-callable"),s=e("../internals/is-object"),o=TypeError;t.exports=function(e,t){var r,a;if("string"===t&&n(r=e.toString)&&!s(a=i(r,e))||n(r=e.valueOf)&&!s(a=i(r,e))||"string"!==t&&n(r=e.toString)&&!s(a=i(r,e)))return a;throw new o("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,t,r){"use strict";var i=e("../internals/get-built-in"),n=e("../internals/function-uncurry-this"),s=e("../internals/object-get-own-property-names"),o=e("../internals/object-get-own-property-symbols"),a=e("../internals/an-object"),l=n([].concat);t.exports=i("Reflect","ownKeys")||function(e){var t=s.f(a(e)),r=o.f;return r?l(t,r(e)):t}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,t,r){"use strict";var i=e("../internals/global");t.exports=i},{"../internals/global":274}],323:[function(e,t,r){"use strict";t.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},{}],324:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/promise-native-constructor"),s=e("../internals/is-callable"),o=e("../internals/is-forced"),a=e("../internals/inspect-source"),l=e("../internals/well-known-symbol"),h=e("../internals/engine-is-browser"),u=e("../internals/engine-is-deno"),c=e("../internals/is-pure"),d=e("../internals/engine-v8-version"),f=n&&n.prototype,p=l("species"),g=!1,m=s(i.PromiseRejectionEvent),v=o("Promise",function(){var e=a(n),t=e!==String(n);if(!t&&66===d||c&&(!f.catch||!f.finally))return!0;if(!d||d<51||!/native code/.test(e)){var r=new n(function(e){e(1)}),i=function(e){e(function(){},function(){})};if((r.constructor={})[p]=i,!(g=r.then(function(){})instanceof i))return!0}return!t&&(h||u)&&!m});t.exports={CONSTRUCTOR:v,REJECTION_EVENT:m,SUBCLASSING:g}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,t,r){"use strict";var i=e("../internals/global");t.exports=i.Promise},{"../internals/global":274}],326:[function(e,t,r){"use strict";var i=e("../internals/an-object"),n=e("../internals/is-object"),s=e("../internals/new-promise-capability");t.exports=function(e,t){if(i(e),n(t)&&t.constructor===e)return t;var r=s.f(e);return(0,r.resolve)(t),r.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,t,r){"use strict";var i=e("../internals/promise-native-constructor"),n=e("../internals/check-correctness-of-iteration"),s=e("../internals/promise-constructor-detection").CONSTRUCTOR;t.exports=s||!n(function(e){i.all(e).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,t,r){"use strict";var i=function(){this.head=null,this.tail=null};i.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}},t.exports=i},{}],329:[function(e,t,r){"use strict";var i=e("../internals/is-null-or-undefined"),n=TypeError;t.exports=function(e){if(i(e))throw new n("Can't call method on "+e);return e}},{"../internals/is-null-or-undefined":288}],330:[function(e,t,r){"use strict";var i=e("../internals/get-built-in"),n=e("../internals/define-built-in-accessor"),s=e("../internals/well-known-symbol"),o=e("../internals/descriptors"),a=s("species");t.exports=function(e){var t=i(e);o&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,t,r){"use strict";var i=e("../internals/object-define-property").f,n=e("../internals/has-own-property"),s=e("../internals/well-known-symbol")("toStringTag");t.exports=function(e,t,r){e&&!r&&(e=e.prototype),e&&!n(e,s)&&i(e,s,{configurable:!0,value:t})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,t,r){"use strict";var i=e("../internals/shared"),n=e("../internals/uid"),s=i("keys");t.exports=function(e){return s[e]||(s[e]=n(e))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/define-global-property"),s=i["__core-js_shared__"]||n("__core-js_shared__",{});t.exports=s},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,t,r){"use strict";var i=e("../internals/is-pure"),n=e("../internals/shared-store");(t.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.33.0",mode:i?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,t,r){"use strict";var i=e("../internals/an-object"),n=e("../internals/a-constructor"),s=e("../internals/is-null-or-undefined"),o=e("../internals/well-known-symbol")("species");t.exports=function(e,t){var r,a=i(e).constructor;return void 0===a||s(r=i(a)[o])?t:n(r)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,t,r){"use strict";var i=e("../internals/engine-v8-version"),n=e("../internals/fails"),s=e("../internals/global").String;t.exports=!!Object.getOwnPropertySymbols&&!n(function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,t,r){"use strict";var i=e("../internals/function-call"),n=e("../internals/get-built-in"),s=e("../internals/well-known-symbol"),o=e("../internals/define-built-in");t.exports=function(){var e=n("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,a=s("toPrimitive");t&&!t[a]&&o(t,a,function(e){return i(r,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,t,r){"use strict";var i=e("../internals/symbol-constructor-detection");t.exports=i&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,t,r){"use strict";var i,n,s,o,a=e("../internals/global"),l=e("../internals/function-apply"),h=e("../internals/function-bind-context"),u=e("../internals/is-callable"),c=e("../internals/has-own-property"),d=e("../internals/fails"),f=e("../internals/html"),p=e("../internals/array-slice"),g=e("../internals/document-create-element"),m=e("../internals/validate-arguments-length"),v=e("../internals/engine-is-ios"),b=e("../internals/engine-is-node"),y=a.setImmediate,x=a.clearImmediate,_=a.process,S=a.Dispatch,w=a.Function,T=a.MessageChannel,P=a.String,E=0,C={};d(function(){i=a.location});var A=function(e){if(c(C,e)){var t=C[e];delete C[e],t()}},I=function(e){return function(){A(e)}},M=function(e){A(e.data)},R=function(e){a.postMessage(P(e),i.protocol+"//"+i.host)};y&&x||(y=function(e){m(arguments.length,1);var t=u(e)?e:w(e),r=p(arguments,1);return C[++E]=function(){l(t,void 0,r)},n(E),E},x=function(e){delete C[e]},b?n=function(e){_.nextTick(I(e))}:S&&S.now?n=function(e){S.now(I(e))}:T&&!v?(o=(s=new T).port2,s.port1.onmessage=M,n=h(o.postMessage,o)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&i&&"file:"!==i.protocol&&!d(R)?(n=R,a.addEventListener("message",M,!1)):n="onreadystatechange"in g("script")?function(e){f.appendChild(g("script")).onreadystatechange=function(){f.removeChild(this),A(e)}}:function(e){setTimeout(I(e),0)}),t.exports={set:y,clear:x}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,t,r){"use strict";var i=e("../internals/to-integer-or-infinity"),n=Math.max,s=Math.min;t.exports=function(e,t){var r=i(e);return r<0?n(r+t,0):s(r,t)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,t,r){"use strict";var i=e("../internals/indexed-object"),n=e("../internals/require-object-coercible");t.exports=function(e){return i(n(e))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,t,r){"use strict";var i=e("../internals/math-trunc");t.exports=function(e){var t=+e;return t!=t||0===t?0:i(t)}},{"../internals/math-trunc":301}],343:[function(e,t,r){"use strict";var i=e("../internals/to-integer-or-infinity"),n=Math.min;t.exports=function(e){return e>0?n(i(e),0x1fffffffffffff):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,t,r){"use strict";var i=e("../internals/require-object-coercible"),n=Object;t.exports=function(e){return n(i(e))}},{"../internals/require-object-coercible":329}],345:[function(e,t,r){"use strict";var i=e("../internals/function-call"),n=e("../internals/is-object"),s=e("../internals/is-symbol"),o=e("../internals/get-method"),a=e("../internals/ordinary-to-primitive"),l=e("../internals/well-known-symbol"),h=TypeError,u=l("toPrimitive");t.exports=function(e,t){if(!n(e)||s(e))return e;var r,l=o(e,u);if(l){if(void 0===t&&(t="default"),!n(r=i(l,e,t))||s(r))return r;throw new h("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,t,r){"use strict";var i=e("../internals/to-primitive"),n=e("../internals/is-symbol");t.exports=function(e){var t=i(e,"string");return n(t)?t:t+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,t,r){"use strict";var i={};i[e("../internals/well-known-symbol")("toStringTag")]="z",t.exports="[object z]"===String(i)},{"../internals/well-known-symbol":357}],348:[function(e,t,r){"use strict";var i=e("../internals/classof"),n=String;t.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return n(e)}},{"../internals/classof":236}],349:[function(e,t,r){"use strict";var i=String;t.exports=function(e){try{return i(e)}catch(e){return"Object"}}},{}],350:[function(e,t,r){"use strict";var i=e("../internals/function-uncurry-this"),n=0,s=Math.random(),o=i(1..toString);t.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++n+s,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,t,r){"use strict";var i=e("../internals/symbol-constructor-detection");t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},{"../internals/symbol-constructor-detection":336}],352:[function(e,t,r){"use strict";var i=e("../internals/descriptors"),n=e("../internals/fails");t.exports=i&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,t,r){"use strict";var i=TypeError;t.exports=function(e,t){if(e<t)throw new i("Not enough arguments");return e}},{}],354:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/is-callable"),s=i.WeakMap;t.exports=n(s)&&/native code/.test(String(s))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,t,r){"use strict";var i=e("../internals/path"),n=e("../internals/has-own-property"),s=e("../internals/well-known-symbol-wrapped"),o=e("../internals/object-define-property").f;t.exports=function(e){var t=i.Symbol||(i.Symbol={});n(t,e)||o(t,e,{value:s.f(e)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,t,r){"use strict";var i=e("../internals/well-known-symbol");r.f=i},{"../internals/well-known-symbol":357}],357:[function(e,t,r){"use strict";var i=e("../internals/global"),n=e("../internals/shared"),s=e("../internals/has-own-property"),o=e("../internals/uid"),a=e("../internals/symbol-constructor-detection"),l=e("../internals/use-symbol-as-uid"),h=i.Symbol,u=n("wks"),c=l?h.for||h:h&&h.withoutSetter||o;t.exports=function(e){return s(u,e)||(u[e]=a&&s(h,e)?h[e]:c("Symbol."+e)),u[e]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/array-iteration").findIndex,s=e("../internals/add-to-unscopables"),o=!0;"findIndex"in[]&&[,].findIndex(function(){o=!1}),i({target:"Array",proto:!0,forced:o},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),s("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/array-iteration").find,s=e("../internals/add-to-unscopables"),o=!0;"find"in[]&&[,].find(function(){o=!1}),i({target:"Array",proto:!0,forced:o},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),s("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/array-includes").includes,s=e("../internals/fails"),o=e("../internals/add-to-unscopables");i({target:"Array",proto:!0,forced:s(function(){return![,].includes()})},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,t,r){"use strict";var i=e("../internals/to-indexed-object"),n=e("../internals/add-to-unscopables"),s=e("../internals/iterators"),o=e("../internals/internal-state"),a=e("../internals/object-define-property").f,l=e("../internals/iterator-define"),h=e("../internals/create-iter-result-object"),u=e("../internals/is-pure"),c=e("../internals/descriptors"),d=o.set,f=o.getterFor("Array Iterator");t.exports=l(Array,"Array",function(e,t){d(this,{type:"Array Iterator",target:i(e),index:0,kind:t})},function(){var e=f(this),t=e.target,r=e.kind,i=e.index++;if(!t||i>=t.length)return e.target=void 0,h(void 0,!0);switch(r){case"keys":return h(i,!1);case"values":return h(t[i],!1)}return h([i,t[i]],!1)},"values");var p=s.Arguments=s.Array;if(n("keys"),n("values"),n("entries"),!u&&c&&"values"!==p.name)try{a(p,"name",{value:"values"})}catch(e){}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/get-built-in"),s=e("../internals/function-apply"),o=e("../internals/function-call"),a=e("../internals/function-uncurry-this"),l=e("../internals/fails"),h=e("../internals/is-callable"),u=e("../internals/is-symbol"),c=e("../internals/array-slice"),d=e("../internals/get-json-replacer-function"),f=e("../internals/symbol-constructor-detection"),p=String,g=n("JSON","stringify"),m=a(/./.exec),v=a("".charAt),b=a("".charCodeAt),y=a("".replace),x=a(1..toString),_=/[\uD800-\uDFFF]/g,S=/^[\uD800-\uDBFF]$/,w=/^[\uDC00-\uDFFF]$/,T=!f||l(function(){var e=n("Symbol")("stringify detection");return"[null]"!==g([e])||"{}"!==g({a:e})||"{}"!==g(Object(e))}),P=l(function(){return'"\udf06\ud834"'!==g("\udf06\ud834")||'"\udead"'!==g("\udead")}),E=function(e,t){var r=c(arguments),i=d(t);if(h(i)||void 0!==e&&!u(e))return r[1]=function(e,t){if(h(i)&&(t=o(i,this,p(e),t)),!u(t))return t},s(g,null,r)},C=function(e,t,r){var i=v(r,t-1),n=v(r,t+1);return m(S,e)&&!m(w,n)||m(w,e)&&!m(S,i)?"\\u"+x(b(e,0),16):e};g&&i({target:"JSON",stat:!0,arity:3,forced:T||P},{stringify:function(e,t,r){var i=c(arguments),n=s(T?E:g,null,i);return P&&"string"==typeof n?y(n,_,C):n}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,t,r){"use strict";e("../internals/export")({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},{"../internals/export":259}],364:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/object-assign");i({target:"Object",stat:!0,arity:2,forced:Object.assign!==n},{assign:n})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/symbol-constructor-detection"),s=e("../internals/fails"),o=e("../internals/object-get-own-property-symbols"),a=e("../internals/to-object");i({target:"Object",stat:!0,forced:!n||s(function(){o.f(1)})},{getOwnPropertySymbols:function(e){var t=o.f;return t?t(a(e)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/to-object"),s=e("../internals/object-keys");i({target:"Object",stat:!0,forced:e("../internals/fails")(function(){s(1)})},{keys:function(e){return s(n(e))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/object-to-array").values;i({target:"Object",stat:!0},{values:function(e){return n(e)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/function-call"),s=e("../internals/a-callable"),o=e("../internals/new-promise-capability"),a=e("../internals/perform"),l=e("../internals/iterate");i({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(e){var t=this,r=o.f(t),i=r.resolve,h=r.reject,u=a(function(){var r=s(t.resolve),o=[],a=0,u=1;l(e,function(e){var s=a++,l=!1;u++,n(r,t,e).then(function(e){l||(l=!0,o[s]=e,--u||i(o))},h)}),--u||i(o)});return u.error&&h(u.value),r.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/is-pure"),s=e("../internals/promise-constructor-detection").CONSTRUCTOR,o=e("../internals/promise-native-constructor"),a=e("../internals/get-built-in"),l=e("../internals/is-callable"),h=e("../internals/define-built-in"),u=o&&o.prototype;if(i({target:"Promise",proto:!0,forced:s,real:!0},{catch:function(e){return this.then(void 0,e)}}),!n&&l(o)){var c=a("Promise").prototype.catch;u.catch!==c&&h(u,"catch",c,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,t,r){"use strict";var i,n,s,o=e("../internals/export"),a=e("../internals/is-pure"),l=e("../internals/engine-is-node"),h=e("../internals/global"),u=e("../internals/function-call"),c=e("../internals/define-built-in"),d=e("../internals/object-set-prototype-of"),f=e("../internals/set-to-string-tag"),p=e("../internals/set-species"),g=e("../internals/a-callable"),m=e("../internals/is-callable"),v=e("../internals/is-object"),b=e("../internals/an-instance"),y=e("../internals/species-constructor"),x=e("../internals/task").set,_=e("../internals/microtask"),S=e("../internals/host-report-errors"),w=e("../internals/perform"),T=e("../internals/queue"),P=e("../internals/internal-state"),E=e("../internals/promise-native-constructor"),C=e("../internals/promise-constructor-detection"),A=e("../internals/new-promise-capability"),I=C.CONSTRUCTOR,M=C.REJECTION_EVENT,R=C.SUBCLASSING,O=P.getterFor("Promise"),k=P.set,N=E&&E.prototype,L=E,D=N,B=h.TypeError,F=h.document,V=h.process,G=A.f,U=G,z=!!(F&&F.createEvent&&h.dispatchEvent),j=function(e){var t;return!(!v(e)||!m(t=e.then))&&t},H=function(e,t){var r,i,n,s=t.value,o=1===t.state,a=o?e.ok:e.fail,l=e.resolve,h=e.reject,c=e.domain;try{a?(o||(2===t.rejection&&Y(t),t.rejection=1),!0===a?r=s:(c&&c.enter(),r=a(s),c&&(c.exit(),n=!0)),r===e.promise?h(new B("Promise-chain cycle")):(i=j(r))?u(i,r,l,h):l(r)):h(s)}catch(e){c&&!n&&c.exit(),h(e)}},W=function(e,t){e.notified||(e.notified=!0,_(function(){for(var r,i=e.reactions;r=i.get();)H(r,e);e.notified=!1,t&&!e.rejection&&X(e)}))},q=function(e,t,r){var i,n;z?((i=F.createEvent("Event")).promise=t,i.reason=r,i.initEvent(e,!1,!0),h.dispatchEvent(i)):i={promise:t,reason:r},!M&&(n=h["on"+e])?n(i):"unhandledrejection"===e&&S("Unhandled promise rejection",r)},X=function(e){u(x,h,function(){var t,r=e.facade,i=e.value;if($(e)&&(t=w(function(){l?V.emit("unhandledRejection",i,r):q("unhandledrejection",r,i)}),e.rejection=l||$(e)?2:1,t.error))throw t.value})},$=function(e){return 1!==e.rejection&&!e.parent},Y=function(e){u(x,h,function(){var t=e.facade;l?V.emit("rejectionHandled",t):q("rejectionhandled",t,e.value)})},Z=function(e,t,r){return function(i){e(t,i,r)}},K=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,W(e,!0))},J=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new B("Promise can't be resolved itself");var i=j(t);i?_(function(){var r={done:!1};try{u(i,t,Z(J,r,e),Z(K,r,e))}catch(t){K(r,t,e)}}):(e.value=t,e.state=1,W(e,!1))}catch(t){K({done:!1},t,e)}}};if(I&&(D=(L=function(e){b(this,D),g(e),u(i,this);var t=O(this);try{e(Z(J,t),Z(K,t))}catch(e){K(t,e)}}).prototype,(i=function(e){k(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new T,rejection:!1,state:0,value:void 0})}).prototype=c(D,"then",function(e,t){var r=O(this),i=G(y(this,L));return r.parent=!0,i.ok=!m(e)||e,i.fail=m(t)&&t,i.domain=l?V.domain:void 0,0===r.state?r.reactions.add(i):_(function(){H(i,r)}),i.promise}),n=function(){var e=new i,t=O(e);this.promise=e,this.resolve=Z(J,t),this.reject=Z(K,t)},A.f=G=function(e){return e===L||void 0===e?new n(e):U(e)},!a&&m(E)&&N!==Object.prototype)){s=N.then,R||c(N,"then",function(e,t){var r=this;return new L(function(e,t){u(s,r,e,t)}).then(e,t)},{unsafe:!0});try{delete N.constructor}catch(e){}d&&d(N,D)}o({global:!0,constructor:!0,wrap:!0,forced:I},{Promise:L}),f(L,"Promise",!1,!0),p("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/is-pure"),s=e("../internals/promise-native-constructor"),o=e("../internals/fails"),a=e("../internals/get-built-in"),l=e("../internals/is-callable"),h=e("../internals/species-constructor"),u=e("../internals/promise-resolve"),c=e("../internals/define-built-in"),d=s&&s.prototype;if(i({target:"Promise",proto:!0,real:!0,forced:!!s&&o(function(){d.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=h(this,a("Promise")),r=l(e);return this.then(r?function(r){return u(t,e()).then(function(){return r})}:e,r?function(r){return u(t,e()).then(function(){throw r})}:e)}}),!n&&l(s)){var f=a("Promise").prototype.finally;d.finally!==f&&c(d,"finally",f,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,t,r){"use strict";e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/function-call"),s=e("../internals/a-callable"),o=e("../internals/new-promise-capability"),a=e("../internals/perform"),l=e("../internals/iterate");i({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(e){var t=this,r=o.f(t),i=r.reject,h=a(function(){var o=s(t.resolve);l(e,function(e){n(o,t,e).then(r.resolve,i)})});return h.error&&i(h.value),r.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/function-call"),s=e("../internals/new-promise-capability");i({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(e){var t=s.f(this);return n(t.reject,void 0,e),t.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/get-built-in"),s=e("../internals/is-pure"),o=e("../internals/promise-native-constructor"),a=e("../internals/promise-constructor-detection").CONSTRUCTOR,l=e("../internals/promise-resolve"),h=n("Promise"),u=s&&!a;i({target:"Promise",stat:!0,forced:s||a},{resolve:function(e){return l(u&&this===h?o:this,e)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/function-uncurry-this"),s=e("../internals/to-absolute-index"),o=RangeError,a=String.fromCharCode,l=String.fromCodePoint,h=n([].join);i({target:"String",stat:!0,arity:1,forced:!!l&&1!==l.length},{fromCodePoint:function(e){for(var t,r=[],i=arguments.length,n=0;i>n;){if(t=+arguments[n++],s(t,1114111)!==t)throw new o(t+" is not a valid code point");r[n]=t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320)}return h(r,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/function-uncurry-this"),s=e("../internals/not-a-regexp"),o=e("../internals/require-object-coercible"),a=e("../internals/to-string"),l=e("../internals/correct-is-regexp-logic"),h=n("".indexOf);i({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~h(a(o(this)),a(s(e)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,t,r){"use strict";e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/global"),s=e("../internals/function-call"),o=e("../internals/function-uncurry-this"),a=e("../internals/is-pure"),l=e("../internals/descriptors"),h=e("../internals/symbol-constructor-detection"),u=e("../internals/fails"),c=e("../internals/has-own-property"),d=e("../internals/object-is-prototype-of"),f=e("../internals/an-object"),p=e("../internals/to-indexed-object"),g=e("../internals/to-property-key"),m=e("../internals/to-string"),v=e("../internals/create-property-descriptor"),b=e("../internals/object-create"),y=e("../internals/object-keys"),x=e("../internals/object-get-own-property-names"),_=e("../internals/object-get-own-property-names-external"),S=e("../internals/object-get-own-property-symbols"),w=e("../internals/object-get-own-property-descriptor"),T=e("../internals/object-define-property"),P=e("../internals/object-define-properties"),E=e("../internals/object-property-is-enumerable"),C=e("../internals/define-built-in"),A=e("../internals/define-built-in-accessor"),I=e("../internals/shared"),M=e("../internals/shared-key"),R=e("../internals/hidden-keys"),O=e("../internals/uid"),k=e("../internals/well-known-symbol"),N=e("../internals/well-known-symbol-wrapped"),L=e("../internals/well-known-symbol-define"),D=e("../internals/symbol-define-to-primitive"),B=e("../internals/set-to-string-tag"),F=e("../internals/internal-state"),V=e("../internals/array-iteration").forEach,G=M("hidden"),U=F.set,z=F.getterFor("Symbol"),j=Object.prototype,H=n.Symbol,W=H&&H.prototype,q=n.RangeError,X=n.TypeError,$=n.QObject,Y=w.f,Z=T.f,K=_.f,J=E.f,Q=o([].push),ee=I("symbols"),et=I("op-symbols"),er=I("wks"),ei=!$||!$.prototype||!$.prototype.findChild,en=function(e,t,r){var i=Y(j,t);i&&delete j[t],Z(e,t,r),i&&e!==j&&Z(j,t,i)},es=l&&u(function(){return 7!==b(Z({},"a",{get:function(){return Z(this,"a",{value:7}).a}})).a})?en:Z,eo=function(e,t){var r=ee[e]=b(W);return U(r,{type:"Symbol",tag:e,description:t}),l||(r.description=t),r},ea=function(e,t,r){e===j&&ea(et,t,r),f(e);var i=g(t);return f(r),c(ee,i)?(r.enumerable?(c(e,G)&&e[G][i]&&(e[G][i]=!1),r=b(r,{enumerable:v(0,!1)})):(c(e,G)||Z(e,G,v(1,{})),e[G][i]=!0),es(e,i,r)):Z(e,i,r)},el=function(e,t){f(e);var r=p(t);return V(y(r).concat(ed(r)),function(t){l&&!s(eh,r,t)||ea(e,t,r[t])}),e},eh=function(e){var t=g(e),r=s(J,this,t);return!(this===j&&c(ee,t)&&!c(et,t))&&(!(r||!c(this,t)||!c(ee,t)||c(this,G)&&this[G][t])||r)},eu=function(e,t){var r=p(e),i=g(t);if(r!==j||!c(ee,i)||c(et,i)){var n=Y(r,i);return!n||!c(ee,i)||c(r,G)&&r[G][i]||(n.enumerable=!0),n}},ec=function(e){var t=K(p(e)),r=[];return V(t,function(e){c(ee,e)||c(R,e)||Q(r,e)}),r},ed=function(e){var t=e===j,r=K(t?et:p(e)),i=[];return V(r,function(e){c(ee,e)&&(!t||c(j,e))&&Q(i,ee[e])}),i};h||(C(W=(H=function(){if(d(W,this))throw new X("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?m(arguments[0]):void 0,t=O(e),r=function(e){this===j&&s(r,et,e),c(this,G)&&c(this[G],t)&&(this[G][t]=!1);var i=v(1,e);try{es(this,t,i)}catch(e){if(!(e instanceof q))throw e;en(this,t,i)}};return l&&ei&&es(j,t,{configurable:!0,set:r}),eo(t,e)}).prototype,"toString",function(){return z(this).tag}),C(H,"withoutSetter",function(e){return eo(O(e),e)}),E.f=eh,T.f=ea,P.f=el,w.f=eu,x.f=_.f=ec,S.f=ed,N.f=function(e){return eo(k(e),e)},l&&(A(W,"description",{configurable:!0,get:function(){return z(this).description}}),a||C(j,"propertyIsEnumerable",eh,{unsafe:!0}))),i({global:!0,constructor:!0,wrap:!0,forced:!h,sham:!h},{Symbol:H}),V(y(er),function(e){L(e)}),i({target:"Symbol",stat:!0,forced:!h},{useSetter:function(){ei=!0},useSimple:function(){ei=!1}}),i({target:"Object",stat:!0,forced:!h,sham:!l},{create:function(e,t){return void 0===t?b(e):el(b(e),t)},defineProperty:ea,defineProperties:el,getOwnPropertyDescriptor:eu}),i({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:ec}),D(),B(H,"Symbol"),R[G]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/get-built-in"),s=e("../internals/has-own-property"),o=e("../internals/to-string"),a=e("../internals/shared"),l=e("../internals/symbol-registry-detection"),h=a("string-to-symbol-registry"),u=a("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!l},{for:function(e){var t=o(e);if(s(h,t))return h[t];var r=n("Symbol")(t);return h[t]=r,u[r]=t,r}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,t,r){"use strict";e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,t,r){"use strict";var i=e("../internals/export"),n=e("../internals/has-own-property"),s=e("../internals/is-symbol"),o=e("../internals/try-to-string"),a=e("../internals/shared"),l=e("../internals/symbol-registry-detection"),h=a("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!l},{keyFor:function(e){if(!s(e))throw TypeError(o(e)+" is not a symbol");if(n(h,e))return h[e]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,t,r){"use strict";function i(e){return Object.prototype.toString.call(e)}r.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===i(e)},r.isBoolean=function(e){return"boolean"==typeof e},r.isNull=function(e){return null===e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=function(e){return"number"==typeof e},r.isString=function(e){return"string"==typeof e},r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=function(e){return void 0===e},r.isRegExp=function(e){return"[object RegExp]"===i(e)},r.isObject=function(e){return"object"==typeof e&&null!==e},r.isDate=function(e){return"[object Date]"===i(e)},r.isError=function(e){return"[object Error]"===i(e)||e instanceof Error},r.isFunction=function(e){return"function"==typeof e},r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},r.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,t,r){(function(r){(function(){"use strict";var i=e("elliptic"),n=e("bn.js");t.exports=function(e){return new o(e)};var s={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function o(e){this.curveType=s[e],this.curveType||(this.curveType={name:e}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function a(e,t,i){Array.isArray(e)||(e=e.toArray());var n=new r(e);if(i&&n.length<i){var s=new r(i-n.length);s.fill(0),n=r.concat([s,n])}return t?n.toString(t):n}s.p224=s.secp224r1,s.p256=s.secp256r1=s.prime256v1,s.p192=s.secp192r1=s.prime192v1,s.p384=s.secp384r1,s.p521=s.secp521r1,o.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},o.prototype.computeSecret=function(e,t,i){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),a(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),i,this.curveType.byteLength)},o.prototype.getPublicKey=function(e,t){var r=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(r[r.length-1]%2?r[0]=7:r[0]=6),a(r,e)},o.prototype.getPrivateKey=function(e){return a(this.keys.getPrivate(),e)},o.prototype.setPublicKey=function(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this.keys._importPublic(e),this},o.prototype.setPrivateKey=function(e,t){t=t||"utf8",r.isBuffer(e)||(e=new r(e,t));var i=new n(e);return i=i.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(i),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],386:[function(e,t,r){"use strict";var i=e("inherits"),n=e("md5.js"),s=e("ripemd160"),o=e("sha.js"),a=e("cipher-base");function l(e){a.call(this,"digest"),this._hash=e}i(l,a),l.prototype._update=function(e){this._hash.update(e)},l.prototype._final=function(){return this._hash.digest()},t.exports=function(e){return"md5"===(e=e.toLowerCase())?new n:"rmd160"===e||"ripemd160"===e?new s:new l(o(e))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,t,r){"use strict";var i=e("md5.js");t.exports=function(e){return(new i).update(e).digest()}},{"md5.js":450}],388:[function(e,t,r){"use strict";var i=e("inherits"),n=e("./legacy"),s=e("cipher-base"),o=e("safe-buffer").Buffer,a=e("create-hash/md5"),l=e("ripemd160"),h=e("sha.js"),u=o.alloc(128);function c(e,t){s.call(this,"digest"),"string"==typeof t&&(t=o.from(t));var r="sha512"===e||"sha384"===e?128:64;(this._alg=e,this._key=t,t.length>r)?t=("rmd160"===e?new l:h(e)).update(t).digest():t.length<r&&(t=o.concat([t,u],r));for(var i=this._ipad=o.allocUnsafe(r),n=this._opad=o.allocUnsafe(r),a=0;a<r;a++)i[a]=54^t[a],n[a]=92^t[a];this._hash="rmd160"===e?new l:h(e),this._hash.update(i)}i(c,s),c.prototype._update=function(e){this._hash.update(e)},c.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new l:h(this._alg)).update(this._opad).update(e).digest()},t.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new c("rmd160",t):"md5"===e?new n(a,t):new c(e,t)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,t,r){"use strict";var i=e("inherits"),n=e("safe-buffer").Buffer,s=e("cipher-base"),o=n.alloc(128);function a(e,t){s.call(this,"digest"),"string"==typeof t&&(t=n.from(t)),this._alg=e,this._key=t,t.length>64?t=e(t):t.length<64&&(t=n.concat([t,o],64));for(var r=this._ipad=n.allocUnsafe(64),i=this._opad=n.allocUnsafe(64),a=0;a<64;a++)r[a]=54^t[a],i[a]=92^t[a];this._hash=[r]}i(a,s),a.prototype._update=function(e){this._hash.push(e)},a.prototype._final=function(){var e=this._alg(n.concat(this._hash));return this._alg(n.concat([this._opad,e]))},t.exports=a},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,t,r){"use strict";r.randomBytes=r.rng=r.pseudoRandomBytes=r.prng=e("randombytes"),r.createHash=r.Hash=e("create-hash"),r.createHmac=r.Hmac=e("create-hmac");var i=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(Object.keys(e("browserify-sign/algos")));r.getHashes=function(){return i};var n=e("pbkdf2");r.pbkdf2=n.pbkdf2,r.pbkdf2Sync=n.pbkdf2Sync;var s=e("browserify-cipher");r.Cipher=s.Cipher,r.createCipher=s.createCipher,r.Cipheriv=s.Cipheriv,r.createCipheriv=s.createCipheriv,r.Decipher=s.Decipher,r.createDecipher=s.createDecipher,r.Decipheriv=s.Decipheriv,r.createDecipheriv=s.createDecipheriv,r.getCiphers=s.getCiphers,r.listCiphers=s.listCiphers;var o=e("diffie-hellman");r.DiffieHellmanGroup=o.DiffieHellmanGroup,r.createDiffieHellmanGroup=o.createDiffieHellmanGroup,r.getDiffieHellman=o.getDiffieHellman,r.createDiffieHellman=o.createDiffieHellman,r.DiffieHellman=o.DiffieHellman;var a=e("browserify-sign");r.createSign=a.createSign,r.Sign=a.Sign,r.createVerify=a.createVerify,r.Verify=a.Verify,r.createECDH=e("create-ecdh");var l=e("public-encrypt");r.publicEncrypt=l.publicEncrypt,r.privateEncrypt=l.privateEncrypt,r.publicDecrypt=l.publicDecrypt,r.privateDecrypt=l.privateDecrypt;var h=e("randomfill");r.randomFill=h.randomFill,r.randomFillSync=h.randomFillSync,r.createCredentials=function(){throw Error("sorry, createCredentials is not implemented yet\nwe accept pull requests\nhttps://github.com/crypto-browserify/crypto-browserify")},r.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,t,r){"use strict";var i,n;i=void 0,n=function(){var e="millisecond",t="second",r="minute",i="hour",n="week",s="month",o="quarter",a="year",l="date",h="Invalid Date",u=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,r){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(r)+e},f="en",p={};p[f]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||"th")+"]"}};var g="$isDayjsObject",m=function(e){return e instanceof x||!(!e||!e[g])},v=function e(t,r,i){var n;if(!t)return f;if("string"==typeof t){var s=t.toLowerCase();p[s]&&(n=s),r&&(p[s]=r,n=s);var o=t.split("-");if(!n&&o.length>1)return e(o[0])}else{var a=t.name;p[a]=t,n=a}return!i&&n&&(f=n),n||!i&&f},b=function(e,t){if(m(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new x(r)},y={s:d,z:function(e){var t=-e.utcOffset(),r=Math.abs(t);return(t<=0?"+":"-")+d(Math.floor(r/60),2,"0")+":"+d(r%60,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var i=12*(r.year()-t.year())+(r.month()-t.month()),n=t.clone().add(i,s),o=r-n<0,a=t.clone().add(i+(o?-1:1),s);return+(-(i+(r-n)/(o?n-a:a-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(h){return({M:s,y:a,w:n,d:"day",D:l,h:i,m:r,s:t,ms:e,Q:o})[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};y.l=v,y.i=m,y.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var x=function(){function d(e){this.$L=v(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[g]=!0}var f=d.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(y.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(u);if(i){var n=i[2]-1||0,s=(i[7]||"0").substring(0,3);return r?new Date(Date.UTC(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(t)}(e),this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return y},f.isValid=function(){return this.$d.toString()!==h},f.isSame=function(e,t){var r=b(e);return this.startOf(t)<=r&&r<=this.endOf(t)},f.isAfter=function(e,t){return b(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<b(e)},f.$g=function(e,t,r){return y.u(e)?this[t]:this.set(r,e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,o){var h=this,u=!!y.u(o)||o,c=y.p(e),d=function(e,t){var r=y.w(h.$u?Date.UTC(h.$y,t,e):new Date(h.$y,t,e),h);return u?r:r.endOf("day")},f=function(e,t){return y.w(h.toDate()[e].apply(h.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(t)),h)},p=this.$W,g=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(c){case a:return u?d(1,0):d(31,11);case s:return u?d(1,g):d(0,g+1);case n:var b=this.$locale().weekStart||0,x=(p<b?p+7:p)-b;return d(u?m-x:m+(6-x),g);case"day":case l:return f(v+"Hours",0);case i:return f(v+"Minutes",1);case r:return f(v+"Seconds",2);case t:return f(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(n,o){var h,u=y.p(n),c="set"+(this.$u?"UTC":""),d=((h={}).day=c+"Date",h[l]=c+"Date",h[s]=c+"Month",h[a]=c+"FullYear",h[i]=c+"Hours",h[r]=c+"Minutes",h[t]=c+"Seconds",h[e]=c+"Milliseconds",h)[u],f="day"===u?this.$D+(o-this.$W):o;if(u===s||u===a){var p=this.clone().set(l,1);p.$d[d](f),p.init(),this.$d=p.set(l,Math.min(this.$D,p.daysInMonth())).$d}else d&&this.$d[d](f);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[y.p(e)]()},f.add=function(e,o){var l,h=this;e=Number(e);var u=y.p(o),c=function(t){var r=b(h);return y.w(r.date(r.date()+Math.round(t*e)),h)};if(u===s)return this.set(s,this.$M+e);if(u===a)return this.set(a,this.$y+e);if("day"===u)return c(1);if(u===n)return c(7);var d=((l={})[r]=6e4,l[i]=36e5,l[t]=1e3,l)[u]||1,f=this.$d.getTime()+e*d;return y.w(f,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||h;var i=e||"YYYY-MM-DDTHH:mm:ssZ",n=y.z(this),s=this.$H,o=this.$m,a=this.$M,l=r.weekdays,u=r.months,d=r.meridiem,f=function(e,r,n,s){return e&&(e[r]||e(t,i))||n[r].slice(0,s)},p=function(e){return y.s(s%12||12,e,"0")},g=d||function(e,t,r){var i=e<12?"AM":"PM";return r?i.toLowerCase():i};return i.replace(c,function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return y.s(t.$y,4,"0");case"M":return a+1;case"MM":return y.s(a+1,2,"0");case"MMM":return f(r.monthsShort,a,u,3);case"MMMM":return f(u,a);case"D":return t.$D;case"DD":return y.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return f(r.weekdaysMin,t.$W,l,2);case"ddd":return f(r.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(s);case"HH":return y.s(s,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return g(s,o,!0);case"A":return g(s,o,!1);case"m":return String(o);case"mm":return y.s(o,2,"0");case"s":return String(t.$s);case"ss":return y.s(t.$s,2,"0");case"SSS":return y.s(t.$ms,3,"0");case"Z":return n}return null}(e)||n.replace(":","")})},f.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},f.diff=function(e,l,h){var u,c=this,d=y.p(l),f=b(e),p=(f.utcOffset()-this.utcOffset())*6e4,g=this-f,m=function(){return y.m(c,f)};switch(d){case a:u=m()/12;break;case s:u=m();break;case o:u=m()/3;break;case n:u=(g-p)/6048e5;break;case"day":u=(g-p)/864e5;break;case i:u=g/36e5;break;case r:u=g/6e4;break;case t:u=g/1e3;break;default:u=g}return h?u:y.a(u)},f.daysInMonth=function(){return this.endOf(s).$D},f.$locale=function(){return p[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),i=v(e,t,!0);return i&&(r.$L=i),r},f.clone=function(){return y.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},d}(),_=x.prototype;return b.prototype=_,[["$ms",e],["$s",t],["$m",r],["$H",i],["$W","day"],["$M",s],["$y",a],["$D",l]].forEach(function(e){_[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),b.extend=function(e,t){return e.$i||(e(t,x,b),e.$i=!0),b},b.locale=v,b.isDayjs=m,b.unix=function(e){return b(1e3*e)},b.en=p[f],b.Ls=p,b.p={},b},"object"==typeof r&&void 0!==t?t.exports=n():(i="undefined"!=typeof globalThis?globalThis:i||self).dayjs=n()},{}],392:[function(e,t,r){"use strict";var i,n;i=void 0,n=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,i=/\d\d?/,n=/\d*[^-_:/,()\s\d]+/,s={},o=function(e){return(e=+e)+(e>68?1900:2e3)},a=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e||"Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],h=function(e){var t=s[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var r,i=s.meridiem;if(i){for(var n=1;n<=24;n+=1)if(e.indexOf(i(n,0,t))>-1){r=n>12;break}}else r=e===(t?"pm":"PM");return r},c={A:[n,function(e){this.afternoon=u(e,!1)}],a:[n,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[i,a("seconds")],ss:[i,a("seconds")],m:[i,a("minutes")],mm:[i,a("minutes")],H:[i,a("hours")],h:[i,a("hours")],HH:[i,a("hours")],hh:[i,a("hours")],D:[i,a("day")],DD:[r,a("day")],Do:[n,function(e){var t=s.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var i=1;i<=31;i+=1)t(i).replace(/\[|\]/g,"")===e&&(this.day=i)}],M:[i,a("month")],MM:[r,a("month")],MMM:[n,function(e){var t=h("months"),r=(h("monthsShort")||t.map(function(e){return e.slice(0,3)})).indexOf(e)+1;if(r<1)throw Error();this.month=r%12||r}],MMMM:[n,function(e){var t=h("months").indexOf(e)+1;if(t<1)throw Error();this.month=t%12||t}],Y:[/[+-]?\d+/,a("year")],YY:[r,function(e){this.year=o(e)}],YYYY:[/\d{4}/,a("year")],Z:l,ZZ:l};return function(r,i,n){n.p.customParseFormat=!0,r&&r.parseTwoDigitYear&&(o=r.parseTwoDigitYear);var a=i.prototype,l=a.parse;a.parse=function(r){var i=r.date,o=r.utc,a=r.args;this.$u=o;var h=a[1];if("string"==typeof h){var u=!0===a[2],d=!0===a[3],f=a[2];d&&(f=a[2]),s=this.$locale(),!u&&f&&(s=n.Ls[f]),this.$d=function(r,i,n){try{if(["x","X"].indexOf(i)>-1)return new Date(("X"===i?1e3:1)*r);var o=(function(r){var i,n;i=r,n=s&&s.formats;for(var o=(r=i.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(t,r,i){var s=i&&i.toUpperCase();return r||n[i]||e[i]||n[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(e,t,r){return t||r.slice(1)})})).match(t),a=o.length,l=0;l<a;l+=1){var h=o[l],u=c[h],d=u&&u[0],f=u&&u[1];o[l]=f?{regex:d,parser:f}:h.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,i=0;r<a;r+=1){var n=o[r];if("string"==typeof n)i+=n.length;else{var s=n.regex,l=n.parser,h=e.slice(i),u=s.exec(h)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}})(i)(r),a=o.year,l=o.month,h=o.day,u=o.hours,d=o.minutes,f=o.seconds,p=o.milliseconds,g=o.zone,m=new Date,v=h||(a||l?1:m.getDate()),b=a||m.getFullYear(),y=0;a&&!l||(y=l>0?l-1:m.getMonth());var x=u||0,_=d||0,S=f||0,w=p||0;return g?new Date(Date.UTC(b,y,v,x,_,S,w+60*g.offset*1e3)):n?new Date(Date.UTC(b,y,v,x,_,S,w)):new Date(b,y,v,x,_,S,w)}catch(e){return new Date("")}}(i,h,o),this.init(),f&&!0!==f&&(this.$L=this.locale(f).$L),(u||d)&&i!=this.format(h)&&(this.$d=new Date("")),s={}}else if(h instanceof Array)for(var p=h.length,g=1;g<=p;g+=1){a[1]=h[g-1];var m=n.apply(this,a);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}g===p&&(this.$d=new Date(""))}else l.call(this,r)}}},"object"==typeof r&&void 0!==t?t.exports=n():(i="undefined"!=typeof globalThis?globalThis:i||self).dayjs_plugin_customParseFormat=n()},{}],393:[function(e,t,r){"use strict";var i,n;i=void 0,n=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(i,n,s){var o=n.prototype;s.utc=function(e){var t={date:e,utc:!0,args:arguments};return new n(t)},o.utc=function(t){var r=s(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},o.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var a=o.parse;o.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var l=o.init;o.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var h=o.utcOffset;o.utcOffset=function(i,n){var s=this.$utils().u;if(s(i))return this.$u?0:s(this.$offset)?h.call(this):this.$offset;if("string"==typeof i&&null===(i=function(e){void 0===e&&(e="");var i=e.match(t);if(!i)return null;var n=(""+i[0]).match(r)||["-",0,0],s=n[0],o=60*+n[1]+ +n[2];return 0===o?0:"+"===s?o:-o}(i)))return this;var o=16>=Math.abs(i)?60*i:i,a=this;if(n)return a.$offset=o,a.$u=0===i,a;if(0!==i){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(o+l,e)).$offset=o,a.$x.$localOffset=l}else a=this.utc();return a};var u=o.format;o.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},o.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var c=o.toDate;o.toDate=function(e){return"s"===e&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():c.call(this)};var d=o.diff;o.diff=function(e,t,r){if(e&&this.$u===e.$u)return d.call(this,e,t,r);var i=this.local(),n=s(e).local();return d.call(i,n,t,r)}}},"object"==typeof r&&void 0!==t?t.exports=n():(i="undefined"!=typeof globalThis?globalThis:i||self).dayjs_plugin_utc=n()},{}],394:[function(e,t,r){"use strict";r.utils=e("./des/utils"),r.Cipher=e("./des/cipher"),r.DES=e("./des/des"),r.CBC=e("./des/cbc"),r.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,t,r){"use strict";var i=e("minimalistic-assert"),n=e("inherits"),s={};function o(e){i.equal(e.length,8,"Invalid IV length"),this.iv=Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}r.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}n(t,e);for(var r=Object.keys(s),i=0;i<r.length;i++){var o=r[i];t.prototype[o]=s[o]}return t.create=function(e){return new t(e)},t},s._cbcInit=function(){var e=new o(this.options.iv);this._cbcState=e},s._update=function(e,t,r,i){var n=this._cbcState,s=this.constructor.super_.prototype,o=n.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)o[a]^=e[t+a];for(s._update.call(this,o,0,r,i),a=0;a<this.blockSize;a++)o[a]=r[i+a]}else{for(s._update.call(this,e,t,r,i),a=0;a<this.blockSize;a++)r[i+a]^=o[a];for(a=0;a<this.blockSize;a++)o[a]=e[t+a]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,t,r){"use strict";var i=e("minimalistic-assert");function n(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=Array(this.blockSize),this.bufferOff=0,this.padding=!1!==e.padding}t.exports=n,n.prototype._init=function(){},n.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},n.prototype._buffer=function(e,t){for(var r=Math.min(this.buffer.length-this.bufferOff,e.length-t),i=0;i<r;i++)this.buffer[this.bufferOff+i]=e[t+i];return this.bufferOff+=r,r},n.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},n.prototype._updateEncrypt=function(e){var t=0,r=0,i=Array(((this.bufferOff+e.length)/this.blockSize|0)*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(r+=this._flushBuffer(i,r)));for(var n=e.length-(e.length-t)%this.blockSize;t<n;t+=this.blockSize)this._update(e,t,i,r),r+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i},n.prototype._updateDecrypt=function(e){for(var t=0,r=0,i=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,n=Array(i*this.blockSize);i>0;i--)t+=this._buffer(e,t),r+=this._flushBuffer(n,r);return t+=this._buffer(e,t),n},n.prototype.final=function(e){var t,r;return e&&(t=this.update(e)),r="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(r):r},n.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},n.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=Array(this.blockSize);return this._update(this.buffer,0,e,0),e},n.prototype._unpad=function(e){return e},n.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},{"minimalistic-assert":453}],397:[function(e,t,r){"use strict";var i=e("minimalistic-assert"),n=e("inherits"),s=e("./utils"),o=e("./cipher");function a(){this.tmp=[,,],this.keys=null}function l(e){o.call(this,e);var t=new a;this._desState=t,this.deriveKeys(t,e.key)}n(l,o),t.exports=l,l.create=function(e){return new l(e)};var h=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];l.prototype.deriveKeys=function(e,t){e.keys=Array(32),i.equal(t.length,this.blockSize,"Invalid key length");var r=s.readUInt32BE(t,0),n=s.readUInt32BE(t,4);s.pc1(r,n,e.tmp,0),r=e.tmp[0],n=e.tmp[1];for(var o=0;o<e.keys.length;o+=2){var a=h[o>>>1];r=s.r28shl(r,a),n=s.r28shl(n,a),s.pc2(r,n,e.keys,o)}},l.prototype._update=function(e,t,r,i){var n=this._desState,o=s.readUInt32BE(e,t),a=s.readUInt32BE(e,t+4);s.ip(o,a,n.tmp,0),o=n.tmp[0],a=n.tmp[1],"encrypt"===this.type?this._encrypt(n,o,a,n.tmp,0):this._decrypt(n,o,a,n.tmp,0),o=n.tmp[0],a=n.tmp[1],s.writeUInt32BE(r,o,i),s.writeUInt32BE(r,a,i+4)},l.prototype._pad=function(e,t){if(!1===this.padding)return!1;for(var r=e.length-t,i=t;i<e.length;i++)e[i]=r;return!0},l.prototype._unpad=function(e){if(!1===this.padding)return e;for(var t=e[e.length-1],r=e.length-t;r<e.length;r++)i.equal(e[r],t);return e.slice(0,e.length-t)},l.prototype._encrypt=function(e,t,r,i,n){for(var o=t,a=r,l=0;l<e.keys.length;l+=2){var h=e.keys[l],u=e.keys[l+1];s.expand(a,e.tmp,0),h^=e.tmp[0],u^=e.tmp[1];var c=s.substitute(h,u),d=a;a=(o^s.permute(c))>>>0,o=d}s.rip(a,o,i,n)},l.prototype._decrypt=function(e,t,r,i,n){for(var o=r,a=t,l=e.keys.length-2;l>=0;l-=2){var h=e.keys[l],u=e.keys[l+1];s.expand(o,e.tmp,0),h^=e.tmp[0],u^=e.tmp[1];var c=s.substitute(h,u),d=o;o=(a^s.permute(c))>>>0,a=d}s.rip(o,a,i,n)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,t,r){"use strict";var i=e("minimalistic-assert"),n=e("inherits"),s=e("./cipher"),o=e("./des");function a(e,t){i.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),n=t.slice(8,16),s=t.slice(16,24);this.ciphers="encrypt"===e?[o.create({type:"encrypt",key:r}),o.create({type:"decrypt",key:n}),o.create({type:"encrypt",key:s})]:[o.create({type:"decrypt",key:s}),o.create({type:"encrypt",key:n}),o.create({type:"decrypt",key:r})]}function l(e){s.call(this,e);var t=new a(this.type,this.options.key);this._edeState=t}n(l,s),t.exports=l,l.create=function(e){return new l(e)},l.prototype._update=function(e,t,r,i){var n=this._edeState;n.ciphers[0]._update(e,t,r,i),n.ciphers[1]._update(r,i,r,i),n.ciphers[2]._update(r,i,r,i)},l.prototype._pad=o.prototype._pad,l.prototype._unpad=o.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,t,r){"use strict";r.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},r.writeUInt32BE=function(e,t,r){e[0+r]=t>>>24,e[1+r]=t>>>16&255,e[2+r]=t>>>8&255,e[3+r]=255&t},r.ip=function(e,t,r,i){for(var n=0,s=0,o=6;o>=0;o-=2){for(var a=0;a<=24;a+=8)n<<=1,n|=t>>>a+o&1;for(a=0;a<=24;a+=8)n<<=1,n|=e>>>a+o&1}for(o=6;o>=0;o-=2){for(a=1;a<=25;a+=8)s<<=1,s|=t>>>a+o&1;for(a=1;a<=25;a+=8)s<<=1,s|=e>>>a+o&1}r[i+0]=n>>>0,r[i+1]=s>>>0},r.rip=function(e,t,r,i){for(var n=0,s=0,o=0;o<4;o++)for(var a=24;a>=0;a-=8)n<<=1,n|=t>>>a+o&1,n<<=1,n|=e>>>a+o&1;for(o=4;o<8;o++)for(a=24;a>=0;a-=8)s<<=1,s|=t>>>a+o&1,s<<=1,s|=e>>>a+o&1;r[i+0]=n>>>0,r[i+1]=s>>>0},r.pc1=function(e,t,r,i){for(var n=0,s=0,o=7;o>=5;o--){for(var a=0;a<=24;a+=8)n<<=1,n|=t>>a+o&1;for(a=0;a<=24;a+=8)n<<=1,n|=e>>a+o&1}for(a=0;a<=24;a+=8)n<<=1,n|=t>>a+o&1;for(o=1;o<=3;o++){for(a=0;a<=24;a+=8)s<<=1,s|=t>>a+o&1;for(a=0;a<=24;a+=8)s<<=1,s|=e>>a+o&1}for(a=0;a<=24;a+=8)s<<=1,s|=e>>a+o&1;r[i+0]=n>>>0,r[i+1]=s>>>0},r.r28shl=function(e,t){return e<<t&0xfffffff|e>>>28-t};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];r.pc2=function(e,t,r,n){for(var s=0,o=0,a=i.length>>>1,l=0;l<a;l++)s<<=1,s|=e>>>i[l]&1;for(l=a;l<i.length;l++)o<<=1,o|=t>>>i[l]&1;r[n+0]=s>>>0,r[n+1]=o>>>0},r.expand=function(e,t,r){var i=0,n=0;i=(1&e)<<5|e>>>27;for(var s=23;s>=15;s-=4)i<<=6,i|=e>>>s&63;for(s=11;s>=3;s-=4)n|=e>>>s&63,n<<=6;n|=(31&e)<<1|e>>>31,t[r+0]=i>>>0,t[r+1]=n>>>0};var n=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];r.substitute=function(e,t){for(var r=0,i=0;i<4;i++)r<<=4,r|=n[64*i+(e>>>18-6*i&63)];for(i=0;i<4;i++)r<<=4,r|=n[256+64*i+(t>>>18-6*i&63)];return r>>>0};var s=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];r.permute=function(e){for(var t=0,r=0;r<s.length;r++)t<<=1,t|=e>>>s[r]&1;return t>>>0},r.padSplit=function(e,t,r){for(var i=e.toString(2);i.length<t;)i="0"+i;for(var n=[],s=0;s<t;s+=r)n.push(i.slice(s,s+r));return n.join(" ")}},{}],400:[function(e,t,r){(function(t){(function(){"use strict";var i=e("./lib/generatePrime"),n=e("./lib/primes.json"),s=e("./lib/dh"),o={binary:!0,hex:!0,base64:!0};r.DiffieHellmanGroup=r.createDiffieHellmanGroup=r.getDiffieHellman=function(e){return new s(new t(n[e].prime,"hex"),new t(n[e].gen,"hex"))},r.createDiffieHellman=r.DiffieHellman=function e(r,n,a,l){return t.isBuffer(n)||void 0===o[n]?e(r,"binary",n,a):(n=n||"binary",l=l||"binary",a=a||new t([2]),t.isBuffer(a)||(a=new t(a,l)),"number"==typeof r?new s(i(r,a),a,!0):(t.isBuffer(r)||(r=new t(r,n)),new s(r,a,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,t,r){(function(r){(function(){"use strict";var i=e("bn.js"),n=new(e("miller-rabin")),s=new i(24),o=new i(11),a=new i(10),l=new i(3),h=new i(7),u=e("./generatePrime"),c=e("randombytes");function d(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this._pub=new i(e),this}function f(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this._priv=new i(e),this}t.exports=g;var p={};function g(e,t,r){this.setGenerator(t),this.__prime=new i(e),this._prime=i.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,r?(this.setPublicKey=d,this.setPrivateKey=f):this._primeCode=8}function m(e,t){var i=new r(e.toArray());return t?i.toString(t):i}Object.defineProperty(g.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var r=t.toString("hex"),i=[r,e.toString(16)].join("_");if(i in p)return p[i];var c,d=0;if(e.isEven()||!u.simpleSieve||!u.fermatTest(e)||!n.test(e))return d+=1+("02"===r||"05"===r?8:4),p[i]=d,d;switch(n.test(e.shrn(1))||(d+=2),r){case"02":e.mod(s).cmp(o)&&(d+=8);break;case"05":(c=e.mod(a)).cmp(l)&&c.cmp(h)&&(d+=8);break;default:d+=4}return p[i]=d,d}(this.__prime,this.__gen)),this._primeCode}}),g.prototype.generateKeys=function(){return this._priv||(this._priv=new i(c(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},g.prototype.computeSecret=function(e){var t=new r((e=(e=new i(e)).toRed(this._prime)).redPow(this._priv).fromRed().toArray()),n=this.getPrime();if(t.length<n.length){var s=new r(n.length-t.length);s.fill(0),t=r.concat([s,t])}return t},g.prototype.getPublicKey=function(e){return m(this._pub,e)},g.prototype.getPrivateKey=function(e){return m(this._priv,e)},g.prototype.getPrime=function(e){return m(this.__prime,e)},g.prototype.getGenerator=function(e){return m(this._gen,e)},g.prototype.setGenerator=function(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this.__gen=e,this._gen=new i(e),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,t,r){"use strict";var i=e("randombytes");t.exports=v,v.simpleSieve=g,v.fermatTest=m;var n=e("bn.js"),s=new n(24),o=new(e("miller-rabin")),a=new n(1),l=new n(2),h=new n(5),u=(new n(16),new n(8),new n(10)),c=new n(3),d=(new n(7),new n(11)),f=new n(4),p=(new n(12),null);function g(e){for(var t=function(){if(null!==p)return p;var e=[];e[0]=2;for(var t=1,r=3;r<1048576;r+=2){for(var i=Math.ceil(Math.sqrt(r)),n=0;n<t&&e[n]<=i&&r%e[n]!=0;n++);t!==n&&e[n]<=i||(e[t++]=r)}return p=e,e}(),r=0;r<t.length;r++)if(0===e.modn(t[r]))return 0===e.cmpn(t[r]);return!0}function m(e){var t=n.mont(e);return 0===l.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function v(e,t){var r,p;if(e<16)return new n(2===t||5===t?[140,123]:[140,39]);for(t=new n(t);;){for(r=new n(i(Math.ceil(e/8)));r.bitLength()>e;)r.ishrn(1);if(r.isEven()&&r.iadd(a),r.testn(1)||r.iadd(l),t.cmp(l)){if(!t.cmp(h))for(;r.mod(u).cmp(c);)r.iadd(f)}else for(;r.mod(s).cmp(d);)r.iadd(f);if(g(p=r.shrn(1))&&g(r)&&m(p)&&m(r)&&o.test(p)&&o.test(r))return r}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,t,r){t.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],405:[function(e,t,r){"use strict";r.version=e("../package.json").version,r.utils=e("./elliptic/utils"),r.rand=e("brorand"),r.curve=e("./elliptic/curve"),r.curves=e("./elliptic/curves"),r.ec=e("./elliptic/ec"),r.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("../utils"),s=n.getNAF,o=n.getJSF,a=n.assert;function l(e,t){this.type=e,this.p=new i(t.p,16),this.red=t.prime?i.red(t.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=t.n&&new i(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=[,,,,],this._wnafT2=[,,,,],this._wnafT3=[,,,,],this._wnafT4=[,,,,],this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function h(e,t){this.curve=e,this.type=t,this.precomputed=null}t.exports=l,l.prototype.point=function(){throw Error("Not implemented")},l.prototype.validate=function(){throw Error("Not implemented")},l.prototype._fixedNafMul=function(e,t){a(e.precomputed);var r=e._getDoubles(),i=s(t,1,this._bitLength),n=(1<<r.step+1)-(r.step%2==0?2:1);n/=3;var o,l,h=[];for(o=0;o<i.length;o+=r.step){l=0;for(var u=o+r.step-1;u>=o;u--)l=(l<<1)+i[u];h.push(l)}for(var c=this.jpoint(null,null,null),d=this.jpoint(null,null,null),f=n;f>0;f--){for(o=0;o<h.length;o++)(l=h[o])===f?d=d.mixedAdd(r.points[o]):l===-f&&(d=d.mixedAdd(r.points[o].neg()));c=c.add(d)}return c.toP()},l.prototype._wnafMul=function(e,t){var r=4,i=e._getNAFPoints(r);r=i.wnd;for(var n=i.points,o=s(t,r,this._bitLength),l=this.jpoint(null,null,null),h=o.length-1;h>=0;h--){for(var u=0;h>=0&&0===o[h];h--)u++;if(h>=0&&u++,l=l.dblp(u),h<0)break;var c=o[h];a(0!==c),l="affine"===e.type?c>0?l.mixedAdd(n[c-1>>1]):l.mixedAdd(n[-c-1>>1].neg()):c>0?l.add(n[c-1>>1]):l.add(n[-c-1>>1].neg())}return"affine"===e.type?l.toP():l},l.prototype._wnafMulAdd=function(e,t,r,i,n){var a,l,h,u=this._wnafT1,c=this._wnafT2,d=this._wnafT3,f=0;for(a=0;a<i;a++){var p=(h=t[a])._getNAFPoints(e);u[a]=p.wnd,c[a]=p.points}for(a=i-1;a>=1;a-=2){var g=a-1,m=a;if(1===u[g]&&1===u[m]){var v=[t[g],null,null,t[m]];0===t[g].y.cmp(t[m].y)?(v[1]=t[g].add(t[m]),v[2]=t[g].toJ().mixedAdd(t[m].neg())):0===t[g].y.cmp(t[m].y.redNeg())?(v[1]=t[g].toJ().mixedAdd(t[m]),v[2]=t[g].add(t[m].neg())):(v[1]=t[g].toJ().mixedAdd(t[m]),v[2]=t[g].toJ().mixedAdd(t[m].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],y=o(r[g],r[m]);for(f=Math.max(y[0].length,f),d[g]=Array(f),d[m]=Array(f),l=0;l<f;l++){var x=0|y[0][l],_=0|y[1][l];d[g][l]=b[3*(x+1)+(_+1)],d[m][l]=0,c[g]=v}}else d[g]=s(r[g],u[g],this._bitLength),d[m]=s(r[m],u[m],this._bitLength),f=Math.max(d[g].length,f),f=Math.max(d[m].length,f)}var S=this.jpoint(null,null,null),w=this._wnafT4;for(a=f;a>=0;a--){for(var T=0;a>=0;){var P=!0;for(l=0;l<i;l++)w[l]=0|d[l][a],0!==w[l]&&(P=!1);if(!P)break;T++,a--}if(a>=0&&T++,S=S.dblp(T),a<0)break;for(l=0;l<i;l++){var E=w[l];0!==E&&(E>0?h=c[l][E-1>>1]:E<0&&(h=c[l][-E-1>>1].neg()),S="affine"===h.type?S.mixedAdd(h):S.add(h))}}for(a=0;a<i;a++)c[a]=null;return n?S:S.toP()},l.BasePoint=h,h.prototype.eq=function(){throw Error("Not implemented")},h.prototype.validate=function(){return this.curve.validate(this)},l.prototype.decodePoint=function(e,t){e=n.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw Error("Unknown point format")},h.prototype.encodeCompressed=function(e){return this.encode(e,!0)},h.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},h.prototype.encode=function(e,t){return n.encode(this._encode(t),e)},h.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},h.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},h.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,n=0;n<t;n+=e){for(var s=0;s<e;s++)i=i.dbl();r.push(i)}return{step:e,points:r}},h.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,i=1===r?null:this.dbl(),n=1;n<r;n++)t[n]=t[n-1].add(i);return{wnd:e,points:t}},h.prototype._getBeta=function(){return null},h.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}},{"../utils":419,"bn.js":420}],407:[function(e,t,r){"use strict";var i=e("../utils"),n=e("bn.js"),s=e("inherits"),o=e("./base"),a=i.assert;function l(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,o.call(this,"edwards",e),this.a=new n(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new n(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new n(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function h(e,t,r,i,s){o.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new n(t,16),this.y=new n(r,16),this.z=i?new n(i,16):this.curve.one,this.t=s&&new n(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(l,o),t.exports=l,l.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},l.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},l.prototype.jpoint=function(e,t,r,i){return this.point(e,t,r,i)},l.prototype.pointFromX=function(e,t){(e=new n(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),i=this.c2.redSub(this.a.redMul(r)),s=this.one.redSub(this.c2.redMul(this.d).redMul(r)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw Error("invalid point");var l=a.fromRed().isOdd();return(t&&!l||!t&&l)&&(a=a.redNeg()),this.point(e,a)},l.prototype.pointFromY=function(e,t){(e=new n(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),i=r.redSub(this.c2),s=r.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(0===o.cmp(this.zero)){if(t)throw Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},l.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),i=t.redMul(this.a).redAdd(r),n=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===i.cmp(n)},s(h,o.BasePoint),l.prototype.pointFromJSON=function(e){return h.fromJSON(this,e)},l.prototype.point=function(e,t,r,i){return new h(this,e,t,r,i)},h.fromJSON=function(e,t){return new h(e,t[0],t[1],t[2])},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},h.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var i=this.curve._mulA(e),n=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),s=i.redAdd(t),o=s.redSub(r),a=i.redSub(t),l=n.redMul(o),h=s.redMul(a),u=n.redMul(a),c=o.redMul(s);return this.curve.point(l,h,c,u)},h.prototype._projDbl=function(){var e,t,r,i,n,s,o=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),l=this.y.redSqr();if(this.curve.twisted){var h=(i=this.curve._mulA(a)).redAdd(l);this.zOne?(e=o.redSub(a).redSub(l).redMul(h.redSub(this.curve.two)),t=h.redMul(i.redSub(l)),r=h.redSqr().redSub(h).redSub(h)):(n=this.z.redSqr(),s=h.redSub(n).redISub(n),e=o.redSub(a).redISub(l).redMul(s),t=h.redMul(i.redSub(l)),r=h.redMul(s))}else i=a.redAdd(l),n=this.curve._mulC(this.z).redSqr(),s=i.redSub(n).redSub(n),e=this.curve._mulC(o.redISub(i)).redMul(s),t=this.curve._mulC(i).redMul(a.redISub(l)),r=i.redMul(s);return this.curve.point(e,t,r)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},h.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),n=this.z.redMul(e.z.redAdd(e.z)),s=r.redSub(t),o=n.redSub(i),a=n.redAdd(i),l=r.redAdd(t),h=s.redMul(o),u=a.redMul(l),c=s.redMul(l),d=o.redMul(a);return this.curve.point(h,u,d,c)},h.prototype._projAdd=function(e){var t,r,i=this.z.redMul(e.z),n=i.redSqr(),s=this.x.redMul(e.x),o=this.y.redMul(e.y),a=this.curve.d.redMul(s).redMul(o),l=n.redSub(a),h=n.redAdd(a),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(s).redISub(o),c=i.redMul(l).redMul(u);return this.curve.twisted?(t=i.redMul(h).redMul(o.redSub(this.curve._mulA(s))),r=l.redMul(h)):(t=i.redMul(h).redMul(o.redSub(s)),r=this.curve._mulC(l).redMul(h)),this.curve.point(c,t,r)},h.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},h.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},h.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},h.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},h.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},h.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()},h.prototype.getY=function(){return this.normalize(),this.y.fromRed()},h.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},h.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),i=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}},h.prototype.toP=h.prototype.normalize,h.prototype.mixedAdd=h.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,t,r){"use strict";r.base=e("./base"),r.short=e("./short"),r.mont=e("./mont"),r.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("inherits"),s=e("./base"),o=e("../utils");function a(e){s.call(this,"mont",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function l(e,t,r){s.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(t,16),this.z=new i(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}n(a,s),t.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),i=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===i.redSqrt().redSqr().cmp(i)},n(l,s.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(o.toArray(e,t),1)},a.prototype.point=function(e,t){return new l(this,e,t)},a.prototype.pointFromJSON=function(e){return l.fromJSON(this,e)},l.prototype.precompute=function(){},l.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},l.fromJSON=function(e,t){return new l(e,t[0],t[1]||e.one)},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},l.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),i=e.redMul(t),n=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(i,n)},l.prototype.add=function(){throw Error("Not supported on Montgomery curve")},l.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),i=this.x.redSub(this.z),n=e.x.redAdd(e.z),s=e.x.redSub(e.z).redMul(r),o=n.redMul(i),a=t.z.redMul(s.redAdd(o).redSqr()),l=t.x.redMul(s.redISub(o).redSqr());return this.curve.point(a,l)},l.prototype.mul=function(e){for(var t=e.clone(),r=this,i=this.curve.point(null,null),n=[];0!==t.cmpn(0);t.iushrn(1))n.push(t.andln(1));for(var s=n.length-1;s>=0;s--)0===n[s]?(r=r.diffAdd(i,this),i=i.dbl()):(i=r.diffAdd(i,this),r=r.dbl());return i},l.prototype.mulAdd=function(){throw Error("Not supported on Montgomery curve")},l.prototype.jumlAdd=function(){throw Error("Not supported on Montgomery curve")},l.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},l.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,t,r){"use strict";var i=e("../utils"),n=e("bn.js"),s=e("inherits"),o=e("./base"),a=i.assert;function l(e){o.call(this,"short",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=[,,,,],this._endoWnafT2=[,,,,]}function h(e,t,r,i){o.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new n(t,16),this.y=new n(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function u(e,t,r,i){o.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===i?(this.x=this.curve.one,this.y=this.curve.one,this.z=new n(0)):(this.x=new n(t,16),this.y=new n(r,16),this.z=new n(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(l,o),t.exports=l,l.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,r;if(e.beta)t=new n(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=(t=0>i[0].cmp(i[1])?i[0]:i[1]).toRed(this.red)}if(e.lambda)r=new n(e.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))?r=s[0]:(r=s[1],a(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:r,basis:e.basis?e.basis.map(function(e){return{a:new n(e.a,16),b:new n(e.b,16)}}):this._getEndoBasis(r)}}},l.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:n.mont(e),r=new n(2).toRed(t).redInvm(),i=r.redNeg(),s=new n(3).toRed(t).redNeg().redSqrt().redMul(r);return[i.redAdd(s).fromRed(),i.redSub(s).fromRed()]},l.prototype._getEndoBasis=function(e){for(var t,r,i,s,o,a,l,h,u,c=this.n.ushrn(Math.floor(this.n.bitLength()/2)),d=e,f=this.n.clone(),p=new n(1),g=new n(0),m=new n(0),v=new n(1),b=0;0!==d.cmpn(0);){var y=f.div(d);h=f.sub(y.mul(d)),u=m.sub(y.mul(p));var x=v.sub(y.mul(g));if(!i&&0>h.cmp(c))t=l.neg(),r=p,i=h.neg(),s=u;else if(i&&2==++b)break;l=h,f=d,d=h,m=p,p=u,v=g,g=x}o=h.neg(),a=u;var _=i.sqr().add(s.sqr());return o.sqr().add(a.sqr()).cmp(_)>=0&&(o=t,a=r),i.negative&&(i=i.neg(),s=s.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:i,b:s},{a:o,b:a}]},l.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],i=t[1],n=i.b.mul(e).divRound(this.n),s=r.b.neg().mul(e).divRound(this.n),o=n.mul(r.a),a=s.mul(i.a),l=n.mul(r.b),h=s.mul(i.b);return{k1:e.sub(o).sub(a),k2:l.add(h).neg()}},l.prototype.pointFromX=function(e,t){(e=new n(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=r.redSqrt();if(0!==i.redSqr().redSub(r).cmp(this.zero))throw Error("invalid point");var s=i.fromRed().isOdd();return(t&&!s||!t&&s)&&(i=i.redNeg()),this.point(e,i)},l.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,i=this.a.redMul(t),n=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return 0===r.redSqr().redISub(n).cmpn(0)},l.prototype._endoWnafMulAdd=function(e,t,r){for(var i=this._endoWnafT1,n=this._endoWnafT2,s=0;s<e.length;s++){var o=this._endoSplit(t[s]),a=e[s],l=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),l=l.neg(!0)),i[2*s]=a,i[2*s+1]=l,n[2*s]=o.k1,n[2*s+1]=o.k2}for(var h=this._wnafMulAdd(1,i,n,2*s,r),u=0;u<2*s;u++)i[u]=null,n[u]=null;return h},s(h,o.BasePoint),l.prototype.point=function(e,t,r){return new h(this,e,t,r)},l.prototype.pointFromJSON=function(e,t){return h.fromJSON(this,e,t)},h.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,i=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},h.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},h.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],r);if(!t[2])return i;function n(t){return e.point(t[0],t[1],r)}var s=t[2];return i.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[i].concat(s.doubles.points.map(n))},naf:s.naf&&{wnd:s.naf.wnd,points:[i].concat(s.naf.points.map(n))}},i},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.inf},h.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e)||0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)},h.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),i=e.redInvm(),n=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(i),s=n.redSqr().redISub(this.x.redAdd(this.x)),o=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)},h.prototype.getX=function(){return this.x.fromRed()},h.prototype.getY=function(){return this.y.fromRed()},h.prototype.mul=function(e){return e=new n(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},h.prototype.mulAdd=function(e,t,r){var i=[this,t],n=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n):this.curve._wnafMulAdd(1,i,n,2)},h.prototype.jmulAdd=function(e,t,r){var i=[this,t],n=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n,!0):this.curve._wnafMulAdd(1,i,n,2,!0)},h.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},h.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,i=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return t},h.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(u,o.BasePoint),l.prototype.jpoint=function(e,t,r){return new u(this,e,t,r)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(r,i)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(t),n=e.x.redMul(r),s=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(r.redMul(this.z)),a=i.redSub(n),l=s.redSub(o);if(0===a.cmpn(0))return 0!==l.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h=a.redSqr(),u=h.redMul(a),c=i.redMul(h),d=l.redSqr().redIAdd(u).redISub(c).redISub(c),f=l.redMul(c.redISub(d)).redISub(s.redMul(u)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(d,f,p)},u.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,i=e.x.redMul(t),n=this.y,s=e.y.redMul(t).redMul(this.z),o=r.redSub(i),a=n.redSub(s);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=o.redSqr(),h=l.redMul(o),u=r.redMul(l),c=a.redSqr().redIAdd(h).redISub(u).redISub(u),d=a.redMul(u.redISub(c)).redISub(n.redMul(h)),f=this.z.redMul(o);return this.curve.jpoint(c,d,f)},u.prototype.dblp=function(e){if(0===e||this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){var t,r=this;for(t=0;t<e;t++)r=r.dbl();return r}var i=this.curve.a,n=this.curve.tinv,s=this.x,o=this.y,a=this.z,l=a.redSqr().redSqr(),h=o.redAdd(o);for(t=0;t<e;t++){var u=s.redSqr(),c=h.redSqr(),d=c.redSqr(),f=u.redAdd(u).redIAdd(u).redIAdd(i.redMul(l)),p=s.redMul(c),g=f.redSqr().redISub(p.redAdd(p)),m=p.redISub(g),v=f.redMul(m);v=v.redIAdd(v).redISub(d);var b=h.redMul(a);t+1<e&&(l=l.redMul(d)),s=g,a=b,h=v}return this.curve.jpoint(s,h.redMul(n),a)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),o=this.x.redAdd(n).redSqr().redISub(i).redISub(s);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i),l=a.redSqr().redISub(o).redISub(o),h=s.redIAdd(s);h=(h=h.redIAdd(h)).redIAdd(h),e=l,t=a.redMul(o.redISub(l)).redISub(h),r=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),c=this.y.redSqr(),d=c.redSqr(),f=this.x.redAdd(c).redSqr().redISub(u).redISub(d);f=f.redIAdd(f);var p=u.redAdd(u).redIAdd(u),g=p.redSqr(),m=d.redIAdd(d);m=(m=m.redIAdd(m)).redIAdd(m),e=g.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(m),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},u.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),o=this.x.redAdd(n).redSqr().redISub(i).redISub(s);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),l=a.redSqr().redISub(o).redISub(o);e=l;var h=s.redIAdd(s);h=(h=h.redIAdd(h)).redIAdd(h),t=a.redMul(o.redISub(l)).redISub(h),r=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),c=this.y.redSqr(),d=this.x.redMul(c),f=this.x.redSub(u).redMul(this.x.redAdd(u));f=f.redAdd(f).redIAdd(f);var p=d.redIAdd(d),g=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(g),r=this.y.redAdd(this.z).redSqr().redISub(c).redISub(u);var m=c.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),t=f.redMul(p.redISub(e)).redISub(m)}return this.curve.jpoint(e,t,r)},u.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,i=this.z,n=i.redSqr().redSqr(),s=t.redSqr(),o=r.redSqr(),a=s.redAdd(s).redIAdd(s).redIAdd(e.redMul(n)),l=t.redAdd(t),h=(l=l.redIAdd(l)).redMul(o),u=a.redSqr().redISub(h.redAdd(h)),c=h.redISub(u),d=o.redSqr();d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=a.redMul(c).redISub(d),p=r.redAdd(r).redMul(i);return this.curve.jpoint(u,f,p)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),i=t.redSqr(),n=e.redAdd(e).redIAdd(e),s=n.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(i),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(s)).redSqr(),l=i.redIAdd(i);l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var h=n.redIAdd(o).redSqr().redISub(s).redISub(a).redISub(l),u=t.redMul(h);u=(u=u.redIAdd(u)).redIAdd(u);var c=this.x.redMul(a).redISub(u);c=(c=c.redIAdd(c)).redIAdd(c);var d=this.y.redMul(h.redMul(l.redISub(h)).redISub(o.redMul(a)));d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=this.z.redAdd(o).redSqr().redISub(r).redISub(a);return this.curve.jpoint(c,d,f)},u.prototype.mul=function(e,t){return e=new n(e,t),this.curve._wnafMul(this,e)},u.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var i=t.redMul(this.z),n=r.redMul(e.z);return 0===this.y.redMul(n).redISub(e.y.redMul(i)).cmpn(0)},u.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var i=e.clone(),n=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),0===this.x.cmp(r))return!0}},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,t,r){"use strict";var i,n=e("hash.js"),s=e("./curve"),o=e("./utils").assert;function a(e){"short"===e.type?this.curve=new s.short(e):"edwards"===e.type?this.curve=new s.edwards(e):this.curve=new s.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function l(e,t){Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get:function(){var i=new a(t);return Object.defineProperty(r,e,{configurable:!0,enumerable:!0,value:i}),i}})}r.PresetCurve=a,l("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),l("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),l("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),l("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),l("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),l("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["9"]}),l("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=e("./precomputed/secp256k1")}catch(e){i=void 0}l("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("hmac-drbg"),s=e("../utils"),o=e("../curves"),a=e("brorand"),l=s.assert,h=e("./key"),u=e("./signature");function c(e){if(!(this instanceof c))return new c(e);"string"==typeof e&&(l(Object.prototype.hasOwnProperty.call(o,e),"Unknown curve "+e),e=o[e]),e instanceof o.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}t.exports=c,c.prototype.keyPair=function(e){return new h(this,e)},c.prototype.keyFromPrivate=function(e,t){return h.fromPrivate(this,e,t)},c.prototype.keyFromPublic=function(e,t){return h.fromPublic(this,e,t)},c.prototype.genKeyPair=function(e){e||(e={});for(var t=new n({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),s=this.n.sub(new i(2));;){var o=new i(t.generate(r));if(!(o.cmp(s)>0))return o.iaddn(1),this.keyFromPrivate(o)}},c.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},c.prototype.sign=function(e,t,r,s){"object"==typeof r&&(s=r,r=null),s||(s={}),t=this.keyFromPrivate(t,r),e=this._truncateToN(new i(e,16));for(var o=this.n.byteLength(),a=t.getPrivate().toArray("be",o),l=e.toArray("be",o),h=new n({hash:this.hash,entropy:a,nonce:l,pers:s.pers,persEnc:s.persEnc||"utf8"}),c=this.n.sub(new i(1)),d=0;;d++){var f=s.k?s.k(d):new i(h.generate(this.n.byteLength()));if(!(0>=(f=this._truncateToN(f,!0)).cmpn(1)||f.cmp(c)>=0)){var p=this.g.mul(f);if(!p.isInfinity()){var g=p.getX(),m=g.umod(this.n);if(0!==m.cmpn(0)){var v=f.invm(this.n).mul(m.mul(t.getPrivate()).iadd(e));if(0!==(v=v.umod(this.n)).cmpn(0)){var b=(p.getY().isOdd()?1:0)|(0!==g.cmp(m)?2:0);return s.canonical&&v.cmp(this.nh)>0&&(v=this.n.sub(v),b^=1),new u({r:m,s:v,recoveryParam:b})}}}}}},c.prototype.verify=function(e,t,r,n){e=this._truncateToN(new i(e,16)),r=this.keyFromPublic(r,n);var s=(t=new u(t,"hex")).r,o=t.s;if(0>s.cmpn(1)||s.cmp(this.n)>=0||0>o.cmpn(1)||o.cmp(this.n)>=0)return!1;var a,l=o.invm(this.n),h=l.mul(e).umod(this.n),c=l.mul(s).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(h,r.getPublic(),c)).isInfinity()&&a.eqXToP(s):!(a=this.g.mulAdd(h,r.getPublic(),c)).isInfinity()&&0===a.getX().umod(this.n).cmp(s)},c.prototype.recoverPubKey=function(e,t,r,n){l((3&r)===r,"The recovery param is more than two bits"),t=new u(t,n);var s=this.n,o=new i(e),a=t.r,h=t.s,c=1&r,d=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw Error("Unable to find sencond key candinate");a=d?this.curve.pointFromX(a.add(this.curve.n),c):this.curve.pointFromX(a,c);var f=t.r.invm(s),p=s.sub(o).mul(f).umod(s),g=h.mul(f).umod(s);return this.g.mulAdd(p,a,g)},c.prototype.getKeyRecoveryParam=function(e,t,r,i){if(null!==(t=new u(t,i)).recoveryParam)return t.recoveryParam;for(var n,s=0;s<4;s++){try{n=this.recoverPubKey(e,t,s)}catch(e){continue}if(n.eq(r))return s}throw Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("../utils").assert;function s(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}t.exports=s,s.fromPublic=function(e,t,r){return t instanceof s?t:new s(e,{pub:t,pubEnc:r})},s.fromPrivate=function(e,t,r){return t instanceof s?t:new s(e,{priv:t,privEnc:r})},s.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},s.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(e,t){this.priv=new i(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?n(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||n(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},s.prototype.derive=function(e){return e.validate()||n(e.validate(),"public point not validated"),e.mul(this.priv).getX()},s.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},s.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("../utils"),s=n.assert;function o(e,t){if(e instanceof o)return e;this._importDER(e,t)||(s(e.r&&e.s,"Signature without r or s"),this.r=new i(e.r,16),this.s=new i(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function l(e,t){var r=e[t.place++];if(!(128&r))return r;var i=15&r;if(0===i||i>4)return!1;for(var n=0,s=0,o=t.place;s<i;s++,o++)n<<=8,n|=e[o],n>>>=0;return!(n<=127)&&(t.place=o,n)}function h(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function u(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}t.exports=o,o.prototype._importDER=function(e,t){e=n.toArray(e,t);var r=new a;if(48!==e[r.place++])return!1;var s=l(e,r);if(!1===s||s+r.place!==e.length||2!==e[r.place++])return!1;var o=l(e,r);if(!1===o)return!1;var h=e.slice(r.place,o+r.place);if(r.place+=o,2!==e[r.place++])return!1;var u=l(e,r);if(!1===u||e.length!==u+r.place)return!1;var c=e.slice(r.place,u+r.place);if(0===h[0]){if(!(128&h[1]))return!1;h=h.slice(1)}if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}return this.r=new i(h),this.s=new i(c),this.recoveryParam=null,!0},o.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=h(t),r=h(r);!(r[0]||128&r[1]);)r=r.slice(1);var i=[2];u(i,t.length),(i=i.concat(t)).push(2),u(i,r.length);var s=i.concat(r),o=[48];return u(o,s.length),o=o.concat(s),n.encode(o,e)}},{"../utils":419,"bn.js":420}],415:[function(e,t,r){"use strict";var i=e("hash.js"),n=e("../curves"),s=e("../utils"),o=s.assert,a=s.parseBytes,l=e("./key"),h=e("./signature");function u(e){if(o("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof u))return new u(e);e=n[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=i.sha512}t.exports=u,u.prototype.sign=function(e,t){e=a(e);var r=this.keyFromSecret(t),i=this.hashInt(r.messagePrefix(),e),n=this.g.mul(i),s=this.encodePoint(n),o=this.hashInt(s,r.pubBytes(),e).mul(r.priv()),l=i.add(o).umod(this.curve.n);return this.makeSignature({R:n,S:l,Rencoded:s})},u.prototype.verify=function(e,t,r){e=a(e),t=this.makeSignature(t);var i=this.keyFromPublic(r),n=this.hashInt(t.Rencoded(),i.pubBytes(),e),s=this.g.mul(t.S());return t.R().add(i.pub().mul(n)).eq(s)},u.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(e){return l.fromPublic(this,e)},u.prototype.keyFromSecret=function(e){return l.fromSecret(this,e)},u.prototype.makeSignature=function(e){return e instanceof h?e:new h(this,e)},u.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},u.prototype.decodePoint=function(e){var t=(e=s.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),i=0!=(128&e[t]),n=s.intFromLE(r);return this.curve.pointFromY(n,i)},u.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(e){return s.intFromLE(e)},u.prototype.isPoint=function(e){return e instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,t,r){"use strict";var i=e("../utils"),n=i.assert,s=i.parseBytes,o=i.cachedProperty;function a(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},o(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),o(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),o(a,"privBytes",function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,i=t.slice(0,e.encodingLength);return i[0]&=248,i[r]&=127,i[r]|=64,i}),o(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),o(a,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),o(a,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),a.prototype.sign=function(e){return n(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return n(this._secret,"KeyPair is public only"),i.encode(this.secret(),e)},a.prototype.getPublic=function(e){return i.encode(this.pubBytes(),e)},t.exports=a},{"../utils":419}],417:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("../utils"),s=n.assert,o=n.cachedProperty,a=n.parseBytes;function l(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof i&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}o(l,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),o(l,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),o(l,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),o(l,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),l.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},l.prototype.toHex=function(){return n.encode(this.toBytes(),"hex").toUpperCase()},t.exports=l},{"../utils":419,"bn.js":420}],418:[function(e,t,r){"use strict";t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("minimalistic-assert"),s=e("minimalistic-crypto-utils");r.assert=n,r.toArray=s.toArray,r.zero2=s.zero2,r.toHex=s.toHex,r.encode=s.encode,r.getNAF=function(e,t,r){var i=Array(Math.max(e.bitLength(),r)+1);i.fill(0);for(var n=1<<t+1,s=e.clone(),o=0;o<i.length;o++){var a,l=s.andln(n-1);s.isOdd()?(a=l>(n>>1)-1?(n>>1)-l:l,s.isubn(a)):a=0,i[o]=a,s.iushrn(1)}return i},r.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var i,n=0,s=0;e.cmpn(-n)>0||t.cmpn(-s)>0;){var o,a,l=e.andln(3)+n&3,h=t.andln(3)+s&3;3===l&&(l=-1),3===h&&(h=-1),o=0==(1&l)?0:3!=(i=e.andln(7)+n&7)&&5!==i||2!==h?l:-l,r[0].push(o),a=0==(1&h)?0:3!=(i=t.andln(7)+s&7)&&5!==i||2!==l?h:-h,r[1].push(a),2*n===o+1&&(n=1-n),2*s===a+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return r},r.cachedProperty=function(e,t,r){var i="_"+t;e.prototype[t]=function(){return void 0!==this[i]?this[i]:this[i]=r.call(this)}},r.parseBytes=function(e){return"string"==typeof e?r.toArray(e,"hex"):e},r.intFromLE=function(e){return new i(e,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],421:[function(e,t,r){t.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,t,r){"use strict";var i=Object.create||function(e){var t=function(){};return t.prototype=e,new t},n=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},s=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function o(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=i(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0;var a,l=10;try{var h={};Object.defineProperty&&Object.defineProperty(h,"x",{value:0}),a=0===h.x}catch(e){a=!1}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var s,o,a;if("function"!=typeof r)throw TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]):(o=e._events=i(null),e._eventsCount=0),a){if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),!a.warned&&(s=u(e))&&s>0&&a.length>s){a.warned=!0;var l=Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",l.name,l.message)}}else a=o[t]=r,++e._eventsCount;return e}function d(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function f(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=s.call(d,i);return n.listener=r,i.wrapFn=n,n}function p(e,t,r){var i=e._events;if(!i)return[];var n=i[t];return n?"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):m(n,n.length):[]}function g(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function m(e,t){for(var r=Array(t),i=0;i<t;++i)r[i]=e[i];return r}a?Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||e!=e)throw TypeError('"defaultMaxListeners" must be a positive number');l=e}}):o.defaultMaxListeners=l,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){var t,r,i,n,s,o,a="error"===e;if(o=this._events)a=a&&null==o.error;else if(!a)return!1;if(a){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var l=Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(r=o[e]))return!1;var h="function"==typeof r;switch(i=arguments.length){case 1:(function(e,t,r){if(t)e.call(r);else for(var i=e.length,n=m(e,i),s=0;s<i;++s)n[s].call(r)})(r,h,this);break;case 2:(function(e,t,r,i){if(t)e.call(r,i);else for(var n=e.length,s=m(e,n),o=0;o<n;++o)s[o].call(r,i)})(r,h,this,arguments[1]);break;case 3:(function(e,t,r,i,n){if(t)e.call(r,i,n);else for(var s=e.length,o=m(e,s),a=0;a<s;++a)o[a].call(r,i,n)})(r,h,this,arguments[1],arguments[2]);break;case 4:(function(e,t,r,i,n,s){if(t)e.call(r,i,n,s);else for(var o=e.length,a=m(e,o),l=0;l<o;++l)a[l].call(r,i,n,s)})(r,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(n=Array(i-1),s=1;s<i;s++)n[s-1]=arguments[s];(function(e,t,r,i){if(t)e.apply(r,i);else for(var n=e.length,s=m(e,n),o=0;o<n;++o)s[o].apply(r,i)})(r,h,this,n)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw TypeError('"listener" argument must be a function');return this.on(e,f(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw TypeError('"listener" argument must be a function');return this.prependListener(e,f(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,s,o,a;if("function"!=typeof t)throw TypeError('"listener" argument must be a function');if(!(n=this._events)||!(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=i(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,s=o;break}if(s<0)return this;0===s?r.shift():function(e,t){for(var r=t,i=r+1,n=e.length;i<n;r+=1,i+=1)e[r]=e[i];e.pop()}(r,s),1===r.length&&(n[e]=r[0]),n.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.removeAllListeners=function(e){var t,r,s;if(!(r=this._events))return this;if(!r.removeListener)return 0==arguments.length?(this._events=i(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=i(null):delete r[e]),this;if(0==arguments.length){var o,a=n(r);for(s=0;s<a.length;++s)"removeListener"!==(o=a[s])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=i(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},o.prototype.listenerCount=g,o.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("md5.js");t.exports=function(e,t,r,s){if(i.isBuffer(e)||(e=i.from(e,"binary")),t&&(i.isBuffer(t)||(t=i.from(t,"binary")),8!==t.length))throw RangeError("salt should be Buffer with 8 byte length");for(var o=r/8,a=i.alloc(o),l=i.alloc(s||0),h=i.alloc(0);o>0||s>0;){var u=new n;u.update(h),u.update(e),t&&u.update(t),h=u.digest();var c=0;if(o>0){var d=a.length-o;c=Math.min(o,h.length),h.copy(a,d,0,c),o-=c}if(c<h.length&&s>0){var f=l.length-s,p=Math.min(s,h.length-c);h.copy(l,f,c,c+p),s-=p}}return h.fill(0),{key:a,iv:l}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CsvParserStream=r.ParserOptions=r.parseFile=r.parseStream=r.parseString=r.parse=r.FormatterOptions=r.CsvFormatterStream=r.writeToPath=r.writeToString=r.writeToBuffer=r.writeToStream=r.write=r.format=void 0;var i=e("@fast-csv/format");Object.defineProperty(r,"format",{enumerable:!0,get:function(){return i.format}}),Object.defineProperty(r,"write",{enumerable:!0,get:function(){return i.write}}),Object.defineProperty(r,"writeToStream",{enumerable:!0,get:function(){return i.writeToStream}}),Object.defineProperty(r,"writeToBuffer",{enumerable:!0,get:function(){return i.writeToBuffer}}),Object.defineProperty(r,"writeToString",{enumerable:!0,get:function(){return i.writeToString}}),Object.defineProperty(r,"writeToPath",{enumerable:!0,get:function(){return i.writeToPath}}),Object.defineProperty(r,"CsvFormatterStream",{enumerable:!0,get:function(){return i.CsvFormatterStream}}),Object.defineProperty(r,"FormatterOptions",{enumerable:!0,get:function(){return i.FormatterOptions}});var n=e("@fast-csv/parse");Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return n.parse}}),Object.defineProperty(r,"parseString",{enumerable:!0,get:function(){return n.parseString}}),Object.defineProperty(r,"parseStream",{enumerable:!0,get:function(){return n.parseStream}}),Object.defineProperty(r,"parseFile",{enumerable:!0,get:function(){return n.parseFile}}),Object.defineProperty(r,"ParserOptions",{enumerable:!0,get:function(){return n.ParserOptions}}),Object.defineProperty(r,"CsvParserStream",{enumerable:!0,get:function(){return n.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("readable-stream").Transform;function s(e){n.call(this),this._block=i.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(s,n),s.prototype._transform=function(e,t,r){var i=null;try{this.update(e,t)}catch(e){i=e}r(i)},s.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},s.prototype.update=function(e,t){if(function(e,t){if(!i.isBuffer(e)&&"string"!=typeof e)throw TypeError(t+" must be a string or a buffer")}(e,"Data"),this._finalized)throw Error("Digest already called");i.isBuffer(e)||(e=i.from(e,t));for(var r=this._block,n=0;this._blockOffset+e.length-n>=this._blockSize;){for(var s=this._blockOffset;s<this._blockSize;)r[s++]=e[n++];this._update(),this._blockOffset=0}for(;n<e.length;)r[this._blockOffset++]=e[n++];for(var o=0,a=8*e.length;a>0;++o)this._length[o]+=a,(a=this._length[o]/0x100000000|0)>0&&(this._length[o]-=0x100000000*a);return this},s.prototype._update=function(){throw Error("_update is not implemented")},s.prototype.digest=function(e){if(this._finalized)throw Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var r=0;r<4;++r)this._length[r]=0;return t},s.prototype._digest=function(){throw Error("_digest is not implemented")},t.exports=s},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,t,r){"use strict";r.utils=e("./hash/utils"),r.common=e("./hash/common"),r.sha=e("./hash/sha"),r.ripemd=e("./hash/ripemd"),r.hmac=e("./hash/hmac"),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,t,r){"use strict";var i=e("./utils"),n=e("minimalistic-assert");function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}r.BlockHash=s,s.prototype.update=function(e,t){if(e=i.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=i.join32(e,0,e.length-r,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),n(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,i=Array(r+this.padLength);i[0]=128;for(var n=1;n<r;n++)i[n]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)i[n++]=0;i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=e>>>24&255,i[n++]=e>>>16&255,i[n++]=e>>>8&255,i[n++]=255&e}else for(i[n++]=255&e,i[n++]=e>>>8&255,i[n++]=e>>>16&255,i[n++]=e>>>24&255,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,s=8;s<this.padLength;s++)i[n++]=0;return i}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,t,r){"use strict";var i=e("./utils"),n=e("minimalistic-assert");function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(t,r))}t.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),n(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,t,r){"use strict";var i=e("./utils"),n=e("./common"),s=i.rotl32,o=i.sum32,a=i.sum32_3,l=i.sum32_4,h=n.BlockHash;function u(){if(!(this instanceof u))return new u;h.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.endian="little"}function c(e,t,r,i){return e<=15?t^r^i:e<=31?t&r|~t&i:e<=47?(t|~r)^i:e<=63?t&i|r&~i:t^(r|~i)}i.inherits(u,h),r.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(e,t){for(var r=this.h[0],i=this.h[1],n=this.h[2],h=this.h[3],u=this.h[4],m=r,v=i,b=n,y=h,x=u,_=0;_<80;_++){var S,w,T=o(s(l(r,c(_,i,n,h),e[d[_]+t],(S=_)<=15?0:S<=31?0x5a827999:S<=47?0x6ed9eba1:S<=63?0x8f1bbcdc:0xa953fd4e),p[_]),u);r=u,u=h,h=s(n,10),n=i,i=T,T=o(s(l(m,c(79-_,v,b,y),e[f[_]+t],(w=_)<=15?0x50a28be6:w<=31?0x5c4dd124:w<=47?0x6d703ef3:w<=63?0x7a6d76e9:0),g[_]),x),m=x,x=y,y=s(b,10),b=v,v=T}T=a(this.h[1],n,y),this.h[1]=a(this.h[2],h,x),this.h[2]=a(this.h[3],u,m),this.h[3]=a(this.h[4],r,v),this.h[4]=a(this.h[0],i,b),this.h[0]=T},u.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],f=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],p=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,t,r){"use strict";r.sha1=e("./sha/1"),r.sha224=e("./sha/224"),r.sha256=e("./sha/256"),r.sha384=e("./sha/384"),r.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,t,r){"use strict";var i=e("../utils"),n=e("../common"),s=e("./common"),o=i.rotl32,a=i.sum32,l=i.sum32_5,h=s.ft_1,u=n.BlockHash,c=[0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xca62c1d6];function d(){if(!(this instanceof d))return new d;u.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.W=Array(80)}i.inherits(d,u),t.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=o(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var n=this.h[0],s=this.h[1],u=this.h[2],d=this.h[3],f=this.h[4];for(i=0;i<r.length;i++){var p=~~(i/20),g=l(o(n,5),h(p,s,u,d),f,r[i],c[p]);f=d,d=u,u=o(s,30),s=n,n=g}this.h[0]=a(this.h[0],n),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],u),this.h[3]=a(this.h[3],d),this.h[4]=a(this.h[4],f)},d.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,t,r){"use strict";var i=e("../utils"),n=e("./256");function s(){if(!(this instanceof s))return new s;n.call(this),this.h=[0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]}i.inherits(s,n),t.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,t,r){"use strict";var i=e("../utils"),n=e("../common"),s=e("./common"),o=e("minimalistic-assert"),a=i.sum32,l=i.sum32_4,h=i.sum32_5,u=s.ch32,c=s.maj32,d=s.s0_256,f=s.s1_256,p=s.g0_256,g=s.g1_256,m=n.BlockHash,v=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2];function b(){if(!(this instanceof b))return new b;m.call(this),this.h=[0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19],this.k=v,this.W=Array(64)}i.inherits(b,m),t.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=l(g(r[i-2]),r[i-7],p(r[i-15]),r[i-16]);var n=this.h[0],s=this.h[1],m=this.h[2],v=this.h[3],b=this.h[4],y=this.h[5],x=this.h[6],_=this.h[7];for(o(this.k.length===r.length),i=0;i<r.length;i++){var S=h(_,f(b),u(b,y,x),this.k[i],r[i]),w=a(d(n),c(n,s,m));_=x,x=y,y=b,b=a(v,S),v=m,m=s,s=n,n=a(S,w)}this.h[0]=a(this.h[0],n),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],m),this.h[3]=a(this.h[3],v),this.h[4]=a(this.h[4],b),this.h[5]=a(this.h[5],y),this.h[6]=a(this.h[6],x),this.h[7]=a(this.h[7],_)},b.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,t,r){"use strict";var i=e("../utils"),n=e("./512");function s(){if(!(this instanceof s))return new s;n.call(this),this.h=[0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]}i.inherits(s,n),t.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,t,r){"use strict";var i=e("../utils"),n=e("../common"),s=e("minimalistic-assert"),o=i.rotr64_hi,a=i.rotr64_lo,l=i.shr64_hi,h=i.shr64_lo,u=i.sum64,c=i.sum64_hi,d=i.sum64_lo,f=i.sum64_4_hi,p=i.sum64_4_lo,g=i.sum64_5_hi,m=i.sum64_5_lo,v=n.BlockHash,b=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function y(){if(!(this instanceof y))return new y;v.call(this),this.h=[0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179],this.k=b,this.W=Array(160)}i.inherits(y,v),t.exports=y,y.blockSize=1024,y.outSize=512,y.hmacStrength=192,y.padLength=128,y.prototype._prepareBlock=function(e,t){for(var r=this.W,i=0;i<32;i++)r[i]=e[t+i];for(;i<r.length;i+=2){var n=function(e,t){var r=o(e,t,19)^o(t,e,29)^l(e,t,6);return r<0&&(r+=0x100000000),r}(r[i-4],r[i-3]),s=function(e,t){var r=a(e,t,19)^a(t,e,29)^h(e,t,6);return r<0&&(r+=0x100000000),r}(r[i-4],r[i-3]),u=r[i-14],c=r[i-13],d=function(e,t){var r=o(e,t,1)^o(e,t,8)^l(e,t,7);return r<0&&(r+=0x100000000),r}(r[i-30],r[i-29]),g=function(e,t){var r=a(e,t,1)^a(e,t,8)^h(e,t,7);return r<0&&(r+=0x100000000),r}(r[i-30],r[i-29]),m=r[i-32],v=r[i-31];r[i]=f(n,s,u,c,d,g,m,v),r[i+1]=p(n,s,u,c,d,g,m,v)}},y.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,i=this.h[0],n=this.h[1],l=this.h[2],h=this.h[3],f=this.h[4],p=this.h[5],v=this.h[6],b=this.h[7],y=this.h[8],x=this.h[9],_=this.h[10],S=this.h[11],w=this.h[12],T=this.h[13],P=this.h[14],E=this.h[15];s(this.k.length===r.length);for(var C=0;C<r.length;C+=2){var A=P,I=E,M=function(e,t){var r=o(e,t,14)^o(e,t,18)^o(t,e,9);return r<0&&(r+=0x100000000),r}(y,x),R=function(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=0x100000000),r}(y,x),O=function(e,t,r,i,n){var s=e&r^~e&n;return s<0&&(s+=0x100000000),s}(y,0,_,0,w),k=function(e,t,r,i,n,s){var o=t&i^~t&s;return o<0&&(o+=0x100000000),o}(0,x,0,S,0,T),N=this.k[C],L=this.k[C+1],D=r[C],B=r[C+1],F=g(A,I,M,R,O,k,N,L,D,B),V=m(A,I,M,R,O,k,N,L,D,B);A=function(e,t){var r=o(e,t,28)^o(t,e,2)^o(t,e,7);return r<0&&(r+=0x100000000),r}(i,n),I=function(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=0x100000000),r}(i,n),M=function(e,t,r,i,n){var s=e&r^e&n^r&n;return s<0&&(s+=0x100000000),s}(i,0,l,0,f);var G=c(A,I,M,R=function(e,t,r,i,n,s){var o=t&i^t&s^i&s;return o<0&&(o+=0x100000000),o}(0,n,0,h,0,p)),U=d(A,I,M,R);P=w,E=T,w=_,T=S,_=y,S=x,y=c(v,b,F,V),x=d(b,b,F,V),v=f,b=p,f=l,p=h,l=i,h=n,i=c(F,V,G,U),n=d(F,V,G,U)}u(this.h,0,i,n),u(this.h,2,l,h),u(this.h,4,f,p),u(this.h,6,v,b),u(this.h,8,y,x),u(this.h,10,_,S),u(this.h,12,w,T),u(this.h,14,P,E)},y.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,t,r){"use strict";var i=e("../utils").rotr32;function n(e,t,r){return e&t^~e&r}function s(e,t,r){return e&t^e&r^t&r}function o(e,t,r){return e^t^r}r.ft_1=function(e,t,r,i){var n;return 0===e?(n=t)&r^~n&i:1===e||3===e?t^r^i:2===e?s(t,r,i):void 0},r.ch32=n,r.maj32=s,r.p32=o,r.s0_256=function(e){return i(e,2)^i(e,13)^i(e,22)},r.s1_256=function(e){return i(e,6)^i(e,11)^i(e,25)},r.g0_256=function(e){return i(e,7)^i(e,18)^e>>>3},r.g1_256=function(e){return i(e,17)^i(e,19)^e>>>10}},{"../utils":437}],437:[function(e,t,r){"use strict";var i=e("minimalistic-assert"),n=e("inherits");function s(e){return(e>>>24|e>>>8&65280|e<<8&0xff0000|(255&e)<<24)>>>0}function o(e){return 1===e.length?"0"+e:e}function a(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}r.inherits=n,r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e){if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16))}else for(var i=0,n=0;n<e.length;n++){var s,o,a=e.charCodeAt(n);a<128?r[i++]=a:(a<2048?r[i++]=a>>6|192:((s=e,o=n,55296!=(64512&s.charCodeAt(o))||o<0||o+1>=s.length||56320!=(64512&s.charCodeAt(o+1)))?r[i++]=a>>12|224:(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++n)),r[i++]=a>>18|240,r[i++]=a>>12&63|128),r[i++]=a>>6&63|128),r[i++]=63&a|128)}}else for(n=0;n<e.length;n++)r[n]=0|e[n];return r},r.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=o(e[r].toString(16));return t},r.htonl=s,r.toHex32=function(e,t){for(var r="",i=0;i<e.length;i++){var n=e[i];"little"===t&&(n=s(n)),r+=a(n.toString(16))}return r},r.zero2=o,r.zero8=a,r.join32=function(e,t,r,n){var s,o=r-t;i(o%4==0);for(var a=Array(o/4),l=0,h=t;l<a.length;l++,h+=4)s="big"===n?e[h]<<24|e[h+1]<<16|e[h+2]<<8|e[h+3]:e[h+3]<<24|e[h+2]<<16|e[h+1]<<8|e[h],a[l]=s>>>0;return a},r.split32=function(e,t){for(var r=Array(4*e.length),i=0,n=0;i<e.length;i++,n+=4){var s=e[i];"big"===t?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=255&s):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=255&s)}return r},r.rotr32=function(e,t){return e>>>t|e<<32-t},r.rotl32=function(e,t){return e<<t|e>>>32-t},r.sum32=function(e,t){return e+t>>>0},r.sum32_3=function(e,t,r){return e+t+r>>>0},r.sum32_4=function(e,t,r,i){return e+t+r+i>>>0},r.sum32_5=function(e,t,r,i,n){return e+t+r+i+n>>>0},r.sum64=function(e,t,r,i){var n=e[t],s=i+e[t+1]>>>0;e[t]=(s<i?1:0)+r+n>>>0,e[t+1]=s},r.sum64_hi=function(e,t,r,i){return(t+i>>>0<t?1:0)+e+r>>>0},r.sum64_lo=function(e,t,r,i){return t+i>>>0},r.sum64_4_hi=function(e,t,r,i,n,s,o,a){var l,h=t;return e+r+n+o+(l=0+(((h=h+i>>>0)<t?1:0)+((h=h+s>>>0)<s?1:0)+((h=h+a>>>0)<a?1:0)))>>>0},r.sum64_4_lo=function(e,t,r,i,n,s,o,a){return t+i+s+a>>>0},r.sum64_5_hi=function(e,t,r,i,n,s,o,a,l,h){var u,c=t;return e+r+n+o+l+(u=0+(((c=c+i>>>0)<t?1:0)+((c=c+s>>>0)<s?1:0)+((c=c+a>>>0)<a?1:0)+((c=c+h>>>0)<h?1:0)))>>>0},r.sum64_5_lo=function(e,t,r,i,n,s,o,a,l,h){return t+i+s+a+h>>>0},r.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},r.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},r.shr64_hi=function(e,t,r){return e>>>r},r.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,t,r){"use strict";var i=e("hash.js"),n=e("minimalistic-crypto-utils"),s=e("minimalistic-assert");function o(e){if(!(this instanceof o))return new o(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=n.toArray(e.entropy,e.entropyEnc||"hex"),r=n.toArray(e.nonce,e.nonceEnc||"hex"),i=n.toArray(e.pers,e.persEnc||"hex");s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,i)}t.exports=o,o.prototype._init=function(e,t,r){var i=e.concat(t).concat(r);this.K=Array(this.outLen/8),this.V=Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(i),this._reseed=1,this.reseedInterval=0x1000000000000},o.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},o.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(e,t,r,i){"string"!=typeof t&&(i=r,r=t,t=null),e=n.toArray(e,t),r=n.toArray(r,i),s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},o.prototype.generate=function(e,t,r,i){if(this._reseed>this.reseedInterval)throw Error("Reseed is required");"string"!=typeof t&&(i=r,r=t,t=null),r&&(r=n.toArray(r,i||"hex"),this._update(r));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(r),this._reseed++,n.encode(o,t)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,t,r){"use strict";r.read=function(e,t,r,i,n){var s,o,a=8*n-i-1,l=(1<<a)-1,h=l>>1,u=-7,c=r?n-1:0,d=r?-1:1,f=e[t+c];for(c+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+c],c+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+e[t+c],c+=d,u-=8);if(0===s)s=1-h;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),s-=h}return(f?-1:1)*o*Math.pow(2,s-i)},r.write=function(e,t,r,i,n,s){var o,a,l,h=8*s-n-1,u=(1<<h)-1,c=u>>1,d=23===n?5960464477539062e-23:0,f=i?0:s-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+c>=1?d/l:d*Math.pow(2,1-c))*l>=2&&(o++,l/=2),o+c>=u?(a=0,o=u):o+c>=1?(a=(t*l-1)*Math.pow(2,n),o+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,n),o=0));n>=8;e[r+f]=255&a,f+=p,a/=256,n-=8);for(o=o<<n|a,h+=n;h>0;e[r+f]=255&o,f+=p,o/=256,h-=8);e[r+f-p]|=128*g}},{}],440:[function(e,t,r){"use strict";"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},{}],441:[function(e,t,i){(function(r,n,s,o,a,l,h,u){(function(){"use strict";!function(e){"object"==typeof i&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).JSZip=e()}(function(){return(function t(r,i,n){function s(a,l){if(!i[a]){if(!r[a]){var h="function"==typeof e&&e;if(!l&&h)return h(a,!0);if(o)return o(a,!0);var u=Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[a]={exports:{}};r[a][0].call(c.exports,function(e){return s(r[a][1][e]||e)},c,c.exports,t,r,i,n)}return i[a].exports}for(var o="function"==typeof e&&e,a=0;a<n.length;a++)s(n[a]);return s})({1:[function(e,t,r){var i=e("./utils"),n=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,n,o,a,l,h,u=[],c=0,d=e.length,f=d,p="string"!==i.getTypeOf(e);c<e.length;)f=d-c,n=p?(t=e[c++],r=c<d?e[c++]:0,c<d?e[c++]:0):(t=e.charCodeAt(c++),r=c<d?e.charCodeAt(c++):0,c<d?e.charCodeAt(c++):0),o=t>>2,a=(3&t)<<4|r>>4,l=1<f?(15&r)<<2|n>>6:64,h=2<f?63&n:64,u.push(s.charAt(o)+s.charAt(a)+s.charAt(l)+s.charAt(h));return u.join("")},r.decode=function(e){var t,r,i,o,a,l,h=0,u=0,c="data:";if(e.substr(0,c.length)===c)throw Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&f--,e.charAt(e.length-2)===s.charAt(64)&&f--,f%1!=0)throw Error("Invalid base64 input, bad content length.");for(d=n.uint8array?new Uint8Array(0|f):Array(0|f);h<e.length;)t=s.indexOf(e.charAt(h++))<<2|(o=s.indexOf(e.charAt(h++)))>>4,r=(15&o)<<4|(a=s.indexOf(e.charAt(h++)))>>2,i=(3&a)<<6|(l=s.indexOf(e.charAt(h++))),d[u++]=t,64!==a&&(d[u++]=r),64!==l&&(d[u++]=i);return d}},{"./support":30,"./utils":32}],2:[function(e,t,r){var i=e("./external"),n=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function a(e,t,r,i,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=i,this.compressedContent=n}a.prototype={getContentWorker:function(){var e=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new o("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){var i=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){var i=e("./utils"),n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?0xedb88320^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,r,i){var s=0+r;e^=-1;for(var o=0;o<s;o++)e=e>>>8^n[255&(e^t[o])];return -1^e}(0|t,e,e.length):function(e,t,r,i){var s=0+r;e^=-1;for(var o=0;o<s;o++)e=e>>>8^n[255&(e^t.charCodeAt(o))];return -1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){var i;i="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:i}},{lie:37}],7:[function(e,t,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=e("pako"),s=e("./utils"),o=e("./stream/GenericWorker"),a=i?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",s.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(a,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){function i(e,t){var r,i="";for(r=0;r<t;r++)i+=String.fromCharCode(255&e),e>>>=8;return i}function n(e,t,r,n,o,u){var c,d,f,p,g,m=e.file,v=e.compression,b=u!==a.utf8encode,y=s.transformTo("string",u(m.name)),x=s.transformTo("string",a.utf8encode(m.name)),_=m.comment,S=s.transformTo("string",u(_)),w=s.transformTo("string",a.utf8encode(_)),T=x.length!==m.name.length,P=w.length!==_.length,E="",C="",A="",I=m.dir,M=m.date,R={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(R.crc32=e.crc32,R.compressedSize=e.compressedSize,R.uncompressedSize=e.uncompressedSize);var O=0;t&&(O|=8),!b&&(T||P)&&(O|=2048);var k=0,N=0;I&&(k|=16),"UNIX"===o?(N=798,k|=(c=m.unixPermissions,d=I,f=c,c||(f=d?16893:33204),(65535&f)<<16)):(N=20,k|=63&(m.dosPermissions||0)),p=(M.getUTCHours()<<6|M.getUTCMinutes())<<5|M.getUTCSeconds()/2,g=(M.getUTCFullYear()-1980<<4|M.getUTCMonth()+1)<<5|M.getUTCDate(),T&&(C=i(1,1)+i(l(y),4)+x,E+="up"+i(C.length,2)+C),P&&(A=i(1,1)+i(l(S),4)+w,E+="uc"+i(A.length,2)+A);var L="";return L+="\n\0",L+=i(O,2),L+=v.magic,L+=i(p,2),L+=i(g,2),L+=i(R.crc32,4),L+=i(R.compressedSize,4),L+=i(R.uncompressedSize,4),L+=i(y.length,2),L+=i(E.length,2),{fileRecord:h.LOCAL_FILE_HEADER+L+y+E,dirRecord:h.CENTRAL_FILE_HEADER+i(N,2)+L+i(S.length,2)+"\0\0\0\0"+i(k,4)+i(n,4)+y+E+S}}var s=e("../utils"),o=e("../stream/GenericWorker"),a=e("../utf8"),l=e("../crc32"),h=e("../signature");function u(e,t,r,i){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(u,o),u.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-i-1))/r:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t,r=this.streamFiles&&!e.file.dir,s=n(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(s.dirRecord),r){;this.push({data:(t=e,h.DATA_DESCRIPTOR+i(t.crc32,4)+i(t.compressedSize,4)+i(t.uncompressedSize,4)),meta:{percent:100}})}else for(this.push({data:s.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e,t,r,n,o,a,l=this.bytesWritten,u=0;u<this.dirRecords.length;u++)this.push({data:this.dirRecords[u],meta:{percent:100}});var c=this.bytesWritten-l,d=(e=this.dirRecords.length,t=c,r=l,n=this.zipComment,o=this.encodeFileName,a=s.transformTo("string",o(n)),h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(e,2)+i(e,2)+i(t,4)+i(r,4)+i(a.length,2)+a);this.push({data:d,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},u.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){var i=e("../compressions"),n=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var s=new n(t.streamFiles,r,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,r){o++;var n=function(e,t){var r=e||t,n=i[r];if(!n)throw Error(r+" is not a valid compression method !");return n}(r.options.compression,t.compression),a=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,h=r.date;r._compressWorker(n,a).withStreamInfo("file",{name:e,dir:l,date:h,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(s)}),s.entriesCount=o}catch(e){s.error(e)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){var i=e("./utils"),n=e("./external"),s=e("./utf8"),o=e("./zipEntries"),a=e("./stream/Crc32Probe"),l=e("./nodejsUtils");t.exports=function(e,t){var r=this;return t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e)?n.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var r=new o(t);return r.load(e),r}).then(function(e){var r=[n.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var s=0;s<i.length;s++)r.push(function(e){return new n.Promise(function(t,r){var i=e.decompressed.getContentWorker().pipe(new a);i.on("error",function(e){r(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?r(Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}(i[s]));return n.Promise.all(r)}).then(function(e){for(var n=e.shift(),s=n.files,o=0;o<s.length;o++){var a=s[o],l=a.fileNameStr,h=i.resolve(a.fileNameStr);r.file(h,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders}),a.dir||(r.file(h).unsafeOriginalName=l)}return n.zipComment.length&&(r.comment=n.zipComment),r})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){var i=e("../utils"),n=e("../stream/GenericWorker");function s(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(s,n),s.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){var i=e("readable-stream").Readable;function n(e,t,r){i.call(this,t),this._helper=e;var n=this;e.on("data",function(e,t){n.push(e)||n._helper.pause(),r&&r(t)}).on("error",function(e){n.emit("error",e)}).on("end",function(){n.push(null)})}e("../utils").inherits(n,i),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){t.exports={isNode:void 0!==s,newBufferFrom:function(e,t){if(s.from&&s.from!==Uint8Array.from)return s.from(e,t);if("number"==typeof e)throw Error('The "data" argument must not be a number');return new s(e,t)},allocBuffer:function(e){if(s.alloc)return s.alloc(e);var t=new s(e);return t.fill(0),t},isBuffer:function(e){return s.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){function i(e,t,r){var i,n,a=s.getTypeOf(t),c=s.extend(r||{},l);c.date=c.date||new Date,null!==c.compression&&(c.compression=c.compression.toUpperCase()),"string"==typeof c.unixPermissions&&(c.unixPermissions=parseInt(c.unixPermissions,8)),c.unixPermissions&&16384&c.unixPermissions&&(c.dir=!0),c.dosPermissions&&16&c.dosPermissions&&(c.dir=!0),c.dir&&(e=g(e)),c.createFolders&&(n=p(e))&&m.call(this,n,!0);var v="string"===a&&!1===c.binary&&!1===c.base64;r&&void 0!==r.binary||(c.binary=!v),(t instanceof h&&0===t.uncompressedSize||c.dir||!t||0===t.length)&&(c.base64=!1,c.binary=!0,t="",c.compression="STORE",a="string"),i=t instanceof h||t instanceof o?t:d.isNode&&d.isStream(t)?new f(e,t):s.prepareContent(e,t,c.binary,c.optimizedBinaryString,c.base64);var b=new u(e,i,c);this.files[e]=b}var n=e("./utf8"),s=e("./utils"),o=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),l=e("./defaults"),h=e("./compressedObject"),u=e("./zipObject"),c=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},m=function(e,t){return t=void 0!==t?t:l.createFolders,e=g(e),this.files[e]||i.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}t.exports={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,i;for(t in this.files)i=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,i)},filter:function(e){var t=[];return this.forEach(function(r,i){e(r,i)&&t.push(i)}),t},file:function(e,t,r){if(1!=arguments.length)return e=this.root+e,i.call(this,e,t,r),this;if(v(e)){var n=e;return this.filter(function(e,t){return!t.dir&&n.test(e)})}var s=this.files[this.root+e];return s&&!s.dir?s:null},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,r){return r.dir&&e.test(t)});var t=this.root+e,r=m.call(this,t),i=this.clone();return i.root=r.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e}),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=s.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw Error("No output type specified.");s.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var i=r.comment||this.comment||"";t=c.generateWorker(this,r,i)}catch(e){(t=new o("error")).error(e)}return new a(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){var i=e("./DataReader");function n(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(n,i),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),n=e.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===i&&this.data[s+3]===n)return s-this.zero;return -1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),n=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&r===s[1]&&i===s[2]&&n===s[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){var i=e("../utils");function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=n},{"../utils":32}],19:[function(e,t,r){var i=e("./Uint8ArrayReader");function n(e){i.call(this,e)}e("../utils").inherits(n,i),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){var i=e("./DataReader");function n(e){i.call(this,e)}e("../utils").inherits(n,i),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){var i=e("./ArrayReader");function n(e){i.call(this,e)}e("../utils").inherits(n,i),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){var i=e("../utils"),n=e("../support"),s=e("./ArrayReader"),o=e("./StringReader"),a=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||n.uint8array?"nodebuffer"===t?new a(e):n.uint8array?new l(i.transformTo("uint8array",e)):new s(i.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){r.LOCAL_FILE_HEADER="PK\x03\x04",r.CENTRAL_FILE_HEADER="PK\x01\x02",r.CENTRAL_DIRECTORY_END="PK\x05\x06",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,r){var i=e("./GenericWorker"),n=e("../utils");function s(e){i.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(s,i),s.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){var i=e("./GenericWorker"),n=e("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,i),s.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){var i=e("../utils"),n=e("./GenericWorker");function s(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(s,n),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},t.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){var i=e("../utils"),n=e("./GenericWorker");function s(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}i.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],29:[function(e,t,r){var i=e("../utils"),n=e("./ConvertWorker"),o=e("./GenericWorker"),a=e("../base64"),l=e("../support"),h=e("../external"),u=null;if(l.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function c(e,t,r){var s=t;switch(t){case"blob":case"arraybuffer":s="uint8array";break;case"base64":s="string"}try{this._internalType=s,this._outputType=t,this._mimeType=r,i.checkSupport(s),this._worker=e.pipe(new n(s)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}c.prototype={accumulate:function(e){var t,r;return t=this,r=e,new h.Promise(function(e,n){var o=[],l=t._internalType,h=t._outputType,u=t._mimeType;t.on("data",function(e,t){o.push(e),r&&r(t)}).on("error",function(e){o=[],n(e)}).on("end",function(){try{var t=function(e,t,r){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),r);case"base64":return a.encode(t);default:return i.transformTo(e,t)}}(h,function(e,t){var r,i=0,n=null,o=0;for(r=0;r<t.length;r++)o+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(n=new Uint8Array(o),r=0;r<t.length;r++)n.set(t[r],i),i+=t[r].length;return n;case"nodebuffer":return s.concat(t);default:throw Error("concat : unsupported type '"+e+"'")}}(l,o),u);e(t)}catch(e){n(e)}o=[]}).resume()})},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){i.delay(t,arguments,r)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==s,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var i=new ArrayBuffer(0);try{r.blob=0===new Blob([i],{type:"application/zip"}).size}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),r.blob=0===n.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){for(var i=e("./utils"),n=e("./support"),s=e("./nodejsUtils"),o=e("./stream/GenericWorker"),a=Array(256),l=0;l<256;l++)a[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function h(){o.call(this,"utf-8 decode"),this.leftOver=null}function u(){o.call(this,"utf-8 encode")}a[254]=a[254]=1,r.utf8encode=function(e){return n.nodebuffer?s.newBufferFrom(e,"utf-8"):function(e){var t,r,i,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=n.uint8array?new Uint8Array(l):Array(l),s=o=0;o<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),r<128?t[o++]=r:(r<2048?t[o++]=192|r>>>6:(r<65536?t[o++]=224|r>>>12:(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63),t[o++]=128|r>>>6&63),t[o++]=128|63&r);return t}(e)},r.utf8decode=function(e){return n.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,n,s,o=e.length,l=Array(2*o);for(t=r=0;t<o;)if((n=e[t++])<128)l[r++]=n;else if(4<(s=a[n]))l[r++]=65533,t+=s-1;else{for(n&=2===s?31:3===s?15:7;1<s&&t<o;)n=n<<6|63&e[t++],s--;1<s?l[r++]=65533:n<65536?l[r++]=n:(n-=65536,l[r++]=55296|n>>10&1023,l[r++]=56320|1023&n)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),i.applyFromCharCode(l)}(e=i.transformTo(n.uint8array?"uint8array":"array",e))},i.inherits(h,o),h.prototype.processChunk=function(e){var t=i.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var s=t;(t=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),t.set(s,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}(t),l=t;o!==t.length&&(n.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=h,i.inherits(u,o),u.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){var i=e("./support"),n=e("./base64"),s=e("./nodejsUtils"),o=e("./external");function a(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(t)}catch(e){throw Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(e,t,r){var i=[],n=0,s=e.length;if(s<=r)return String.fromCharCode.apply(null,e);for(;n<s;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+r,s)))):i.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+r,s)))),n+=r;return i.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var t=65536,i=r.getTypeOf(e),n=!0;if("uint8array"===i?n=h.applyCanBeUsed.uint8array:"nodebuffer"===i&&(n=h.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return h.stringifyByChunk(e,i,t)}catch(e){t=Math.floor(t/2)}return h.stringifyByChar(e)}function d(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.applyFromCharCode=c;var f={};f.string={string:a,array:function(e){return l(e,Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,s.allocBuffer(e.length))}},f.array={string:c,array:a,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},f.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),Array(e.byteLength))},arraybuffer:a,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:c,array:function(e){return d(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:a,nodebuffer:function(e){return s.newBufferFrom(e)}},f.nodebuffer={string:c,array:function(e){return d(e,Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:a},r.transformTo=function(e,t){return(t=t||"",e)?(r.checkSupport(e),f[r.getTypeOf(t)][e](t)):t},r.resolve=function(e){for(var t=e.split("/"),r=[],i=0;i<t.length;i++){var n=t[i];"."===n||""===n&&0!==i&&i!==t.length-1||(".."===n?r.pop():r.push(n))}return r.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&s.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!i[e.toLowerCase()])throw Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,i="";for(r=0;r<(e||"").length;r++)i+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return i},r.delay=function(e,t,r){u(function(){e.apply(r||null,t||[])})},r.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,s,a,h){return o.Promise.resolve(t).then(function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,r){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){r(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(t){var u,c=r.getTypeOf(t);return c?("arraybuffer"===c?t=r.transformTo("uint8array",t):"string"===c&&(h?t=n.decode(t):s&&!0!==a&&(t=l(u=t,i.uint8array?new Uint8Array(u.length):Array(u.length)))),t):o.Promise.reject(Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){var i=e("./reader/readerFor"),n=e("./utils"),s=e("./signature"),o=e("./zipEntry"),a=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(r),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?"uint8array":"array",r=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var i=t-r;if(0<i)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){var i=e("./reader/readerFor"),n=e("./utils"),s=e("./compressedObject"),o=e("./crc32"),a=e("./utf8"),l=e("./compressions"),h=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,i,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<n;)t=e.readInt(2),r=e.readInt(2),i=e.readData(r),this.extraFields[t]={id:t,length:r,value:i};e.setIndex(n)},handleUTF8:function(){var e=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var s=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){function i(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var n=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),o=e("./utf8"),a=e("./compressedObject"),l=e("./stream/GenericWorker");i.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw Error("No output type specified.");var i="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var s=!this._dataBinary;s&&!i&&(t=t.pipe(new o.Utf8EncodeWorker)),!s&&i&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new n(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof l?this._data:new s(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<h.length;c++)i.prototype[h[c]]=u;t.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){var r,i,n=e.MutationObserver||e.WebKitMutationObserver;if(n){var s=0,o=new n(u),a=e.document.createTextNode("");o.observe(a,{characterData:!0}),r=function(){a.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,r=function(){l.port2.postMessage(0)}}var h=[];function u(){var e,t;i=!0;for(var r=h.length;r;){for(t=h,h=[],e=-1;++e<r;)t[e]();r=h.length}i=!1}t.exports=function(e){1!==h.push(e)||i||r()}}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){var i=e("immediate");function n(){}var s={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function h(e){if("function"!=typeof e)throw TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==n&&f(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function c(e,t,r){i(function(){var i;try{i=t(r)}catch(t){return s.reject(e,t)}i===e?s.reject(e,TypeError("Cannot resolve promise with itself")):s.resolve(e,i)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var r=!1;function i(t){r||(r=!0,s.reject(e,t))}function n(t){r||(r=!0,s.resolve(e,t))}var o=p(function(){t(n,i)});"error"===o.status&&i(o.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=h).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})},h.prototype.catch=function(e){return this.then(null,e)},h.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var r=new this.constructor(n);return this.state!==l?c(r,this.state===a?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){c(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){s.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){c(this.promise,this.onRejected,e)},s.resolve=function(e,t){var r=p(d,t);if("error"===r.status)return s.reject(e,r.value);var i=r.value;if(i)f(e,i);else{e.state=a,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callFulfilled(t)}return e},s.reject=function(e,t){e.state=o,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callRejected(t);return e},h.resolve=function(e){return e instanceof this?e:s.resolve(new this(n),e)},h.reject=function(e){var t=new this(n);return s.reject(t,e)},h.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var o=Array(r),a=0,l=-1,h=new this(n);++l<r;)(function(e,n){t.resolve(e).then(function(e){o[n]=e,++a!==r||i||(i=!0,s.resolve(h,o))},function(e){i||(i=!0,s.reject(h,e))})})(e[l],l);return h},h.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var t=e.length,r=!1;if(!t)return this.resolve([]);for(var i,o=-1,a=new this(n);++o<t;)i=e[o],this.resolve(i).then(function(e){r||(r=!0,s.resolve(a,e))},function(e){r||(r=!0,s.reject(a,e))});return a}},{immediate:36}],38:[function(e,t,r){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){var i=e("./zlib/deflate"),n=e("./utils/common"),s=e("./utils/strings"),o=e("./zlib/messages"),a=e("./zlib/zstream"),l=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t,r=this.options;r.raw&&0<r.windowBits?r.windowBits=-r.windowBits:r.gzip&&0<r.windowBits&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var u=i.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(0!==u)throw Error(o[u]);if(r.header&&i.deflateSetHeader(this.strm,r.header),r.dictionary){if(t="string"==typeof r.dictionary?s.string2buf(r.dictionary):"[object ArrayBuffer]"===l.call(r.dictionary)?new Uint8Array(r.dictionary):r.dictionary,0!==(u=i.deflateSetDictionary(this.strm,t)))throw Error(o[u]);this._dict_set=!0}}function u(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}h.prototype.push=function(e,t){var r,o,a=this.strm,h=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new n.Buf8(h),a.next_out=0,a.avail_out=h),1!==(r=i.deflate(a,o))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(s.buf2binstring(n.shrinkBuf(a.output,a.next_out))):this.onData(n.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==r);return 4===o?(r=i.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==o||(this.onEnd(0),a.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=h,r.deflate=u,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){var i=e("./zlib/inflate"),n=e("./utils/common"),s=e("./utils/strings"),o=e("./zlib/constants"),a=e("./zlib/messages"),l=e("./zlib/zstream"),h=e("./zlib/gzheader"),u=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=i.inflateInit2(this.strm,t.windowBits);if(r!==o.Z_OK)throw Error(a[r]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}function d(e,t){var r=new c(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}c.prototype.push=function(e,t){var r,a,l,h,c,d,f=this.strm,p=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?f.input=s.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new n.Buf8(p),f.next_out=0,f.avail_out=p),(r=i.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&g&&(d="string"==typeof g?s.string2buf(g):"[object ArrayBuffer]"===u.call(g)?new Uint8Array(g):g,r=i.inflateSetDictionary(this.strm,d)),r===o.Z_BUF_ERROR&&!0===m&&(r=o.Z_OK,m=!1),r!==o.Z_STREAM_END&&r!==o.Z_OK)return this.onEnd(r),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&r!==o.Z_STREAM_END&&(0!==f.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(f.output,f.next_out),h=f.next_out-l,c=s.buf2string(f.output,l),f.next_out=h,f.avail_out=p-h,h&&n.arraySet(f.output,f.output,l,h,0),this.onData(c)):this.onData(n.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((0<f.avail_in||0===f.avail_out)&&r!==o.Z_STREAM_END);return r===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(r=i.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),f.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=c,r.inflate=d,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},r.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),n);else for(var s=0;s<i;s++)e[n+s]=t[r+s]},flattenChunks:function(e){var t,r,i,n,s,o;for(t=i=0,r=e.length;t<r;t++)i+=e[t].length;for(o=new Uint8Array(i),t=n=0,r=e.length;t<r;t++)s=e[t],o.set(s,n),n+=s.length;return o}},s={arraySet:function(e,t,r,i,n){for(var s=0;s<i;s++)e[n+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(i)},{}],42:[function(e,t,r){var i=e("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r}o[254]=o[254]=1,r.string2buf=function(e){var t,r,n,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new i.Buf8(l),s=o=0;o<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?t[o++]=r:(r<2048?t[o++]=192|r>>>6:(r<65536?t[o++]=224|r>>>12:(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63),t[o++]=128|r>>>6&63),t[o++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,i,n,s,a=t||e.length,h=Array(2*a);for(r=i=0;r<a;)if((n=e[r++])<128)h[i++]=n;else if(4<(s=o[n]))h[i++]=65533,r+=s-1;else{for(n&=2===s?31:3===s?15:7;1<s&&r<a;)n=n<<6|63&e[r++],s--;1<s?h[i++]=65533:n<65536?h[i++]=n:(n-=65536,h[i++]=55296|n>>10&1023,h[i++]=56320|1023&n)}return l(h,i)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){t.exports=function(e,t,r,i){for(var n=65535&e|0,s=e>>>16&65535|0,o=0;0!==r;){for(r-=o=2e3<r?2e3:r;s=s+(n=n+t[i++]|0)|0,--o;);n%=65521,s%=65521}return n|s<<16|0}},{}],44:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){var i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?0xedb88320^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,n){var s=n+r;e^=-1;for(var o=n;o<s;o++)e=e>>>8^i[255&(e^t[o])];return -1^e}},{}],46:[function(e,t,r){var i,n=e("../utils/common"),s=e("./trees"),o=e("./adler32"),a=e("./crc32"),l=e("./messages");function h(e,t){return e.msg=l[t],t}function u(e){return(e<<1)-(4<e?9:0)}function c(e){for(var t=e.length;0<=--t;)e[t]=0}function d(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function f(e,t){s._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,d(e.strm)}function p(e,t){e.pending_buf[e.pending++]=t}function g(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function m(e,t){var r,i,n=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,h=e.window,u=e.w_mask,c=e.prev,d=e.strstart+258,f=h[s+o-1],p=h[s+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(h[(r=t)+o]===p&&h[r+o-1]===f&&h[r]===h[s]&&h[++r]===h[s+1]){s+=2,r++;do;while(h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&s<d);if(i=258-(d-s),s=d-258,o<i){if(e.match_start=t,a<=(o=i))break;f=h[s+o-1],p=h[s+o]}}while((t=c[t&u])>l&&0!=--n);return o<=e.lookahead?o:e.lookahead}function v(e){var t,r,i,s,l,h,u,c,d,f,p=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-262)){for(n.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=r=e.hash_size;i=e.head[--t],e.head[t]=p<=i?i-p:0,--r;);for(t=r=p;i=e.prev[--t],e.prev[t]=p<=i?i-p:0,--r;);s+=p}if(0===e.strm.avail_in)break;if(h=e.strm,u=e.window,c=e.strstart+e.lookahead,f=void 0,(d=s)<(f=h.avail_in)&&(f=d),r=0===f?0:(h.avail_in-=f,n.arraySet(u,h.input,h.next_in,f,c),1===h.state.wrap?h.adler=o(h.adler,u,f,c):2===h.state.wrap&&(h.adler=a(h.adler,u,f,c)),h.next_in+=f,h.total_in+=f,f),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function b(e,t){for(var r,i;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=m(e,r)),e.match_length>=3){if(i=s._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}else i=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}function y(e,t){for(var r,i,n;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=m(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(n=e.strstart+e.lookahead-3,i=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(f(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=s._tr_tally(e,0,e.window[e.strstart-1]))&&f(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}function x(e,t,r,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=n}function _(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),c(this.dyn_ltree),c(this.dyn_dtree),c(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),c(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),c(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,s._tr_init(t),0):h(e,-2)}function w(e){var t,r=S(e);return 0===r&&((t=e.state).window_size=2*t.w_size,c(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function T(e,t,r,i,s,o){if(!e)return -2;var a=1;if(-1===t&&(t=6),i<0?(a=0,i=-i):15<i&&(a=2,i-=16),s<1||9<s||8!==r||i<8||15<i||t<0||9<t||o<0||4<o)return h(e,-2);8===i&&(i=9);var l=new _;return(e.state=l).strm=e,l.wrap=a,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=r,w(e)}i=[new x(0,0,0,0,function(e,t){var r=65535;for(65535>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,f(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-262&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(f(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(f(e,!1),e.strm.avail_out),1)}),new x(4,4,8,4,b),new x(4,5,16,8,b),new x(4,6,32,32,b),new x(4,4,16,16,y),new x(8,16,32,32,y),new x(8,16,128,128,y),new x(8,32,128,256,y),new x(32,128,258,1024,y),new x(32,258,258,4096,y)],r.deflateInit=function(e,t){return T(e,t,8,15,8,0)},r.deflateInit2=T,r.deflateReset=w,r.deflateResetKeep=S,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},r.deflate=function(e,t){var r,n,o,l;if(!e||!e.state||5<t||t<0)return e?h(e,-2):-2;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return h(e,0===e.avail_out?-5:-2);if(n.strm=e,r=n.last_flush,n.last_flush=t,42===n.status){if(2===n.wrap)e.adler=0,p(n,31),p(n,139),p(n,8),n.gzhead?(p(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),p(n,255&n.gzhead.time),p(n,n.gzhead.time>>8&255),p(n,n.gzhead.time>>16&255),p(n,n.gzhead.time>>24&255),p(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),p(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(p(n,255&n.gzhead.extra.length),p(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=a(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(p(n,0),p(n,0),p(n,0),p(n,0),p(n,0),p(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),p(n,3),n.status=113);else{var m=8+(n.w_bits-8<<4)<<8;m|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(m|=32),m+=31-m%31,n.status=113,g(n,m),0!==n.strstart&&(g(n,e.adler>>>16),g(n,65535&e.adler)),e.adler=1}}if(69===n.status){if(n.gzhead.extra){for(o=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),d(e),o=n.pending,n.pending!==n.pending_buf_size));)p(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73}if(73===n.status){if(n.gzhead.name){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),d(e),o=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,p(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91}if(91===n.status){if(n.gzhead.comment){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),d(e),o=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,p(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),0===l&&(n.status=103)}else n.status=103}if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&d(e),n.pending+2<=n.pending_buf_size&&(p(n,255&e.adler),p(n,e.adler>>8&255),e.adler=0,n.status=113)):n.status=113),0!==n.pending){if(d(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&u(t)<=u(r)&&4!==t)return h(e,-5);if(666===n.status&&0!==e.avail_in)return h(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var b=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(v(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var r,i,n,o,a=e.window;;){if(e.lookahead<=258){if(v(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(i=a[n=e.strstart-1])===a[++n]&&i===a[++n]&&i===a[++n]){o=e.strstart+258;do;while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<o);e.match_length=258-(o-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=s._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}(n,t):i[n.level].func(n,t);if(3!==b&&4!==b||(n.status=666),1===b||3===b)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===b&&(1===t?s._tr_align(n):5!==t&&(s._tr_stored_block(n,0,0,!1),3===t&&(c(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),d(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(p(n,255&e.adler),p(n,e.adler>>8&255),p(n,e.adler>>16&255),p(n,e.adler>>24&255),p(n,255&e.total_in),p(n,e.total_in>>8&255),p(n,e.total_in>>16&255),p(n,e.total_in>>24&255)):(g(n,e.adler>>>16),g(n,65535&e.adler)),d(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?0:1)},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?h(e,-2):(e.state=null,113===t?h(e,-3):0):-2},r.deflateSetDictionary=function(e,t){var r,i,s,a,l,h,u,d,f=t.length;if(!e||!e.state||2===(a=(r=e.state).wrap)||1===a&&42!==r.status||r.lookahead)return -2;for(1===a&&(e.adler=o(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===a&&(c(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new n.Buf8(r.w_size),n.arraySet(d,t,f-r.w_size,r.w_size,0),t=d,f=r.w_size),l=e.avail_in,h=e.next_in,u=e.input,e.avail_in=f,e.next_in=0,e.input=t,v(r);r.lookahead>=3;){for(i=r.strstart,s=r.lookahead-2;r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+3-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++,--s;);r.strstart=i,r.lookahead=2,v(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=h,e.input=u,e.avail_in=l,r.wrap=a,0},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){t.exports=function(e,t){var r,i,n,s,o,a,l,h,u,c,d,f,p,g,m,v,b,y,x,_,S,w,T,P,E;r=e.state,i=e.next_in,P=e.input,n=i+(e.avail_in-5),s=e.next_out,E=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=r.dmax,h=r.wsize,u=r.whave,c=r.wnext,d=r.window,f=r.hold,p=r.bits,g=r.lencode,m=r.distcode,v=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do for(p<15&&(f+=P[i++]<<p,p+=8,f+=P[i++]<<p,p+=8),y=g[f&v];;){if(f>>>=x=y>>>24,p-=x,0==(x=y>>>16&255))E[s++]=65535&y;else{if(!(16&x)){if(0==(64&x)){y=g[(65535&y)+(f&(1<<x)-1)];continue}if(32&x){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}for(_=65535&y,(x&=15)&&(p<x&&(f+=P[i++]<<p,p+=8),_+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=P[i++]<<p,p+=8,f+=P[i++]<<p,p+=8),y=m[f&b];;){if(f>>>=x=y>>>24,p-=x,!(16&(x=y>>>16&255))){if(0==(64&x)){y=m[(65535&y)+(f&(1<<x)-1)];continue}e.msg="invalid distance code",r.mode=30;break e}if(S=65535&y,p<(x&=15)&&(f+=P[i++]<<p,(p+=8)<x&&(f+=P[i++]<<p,p+=8)),l<(S+=f&(1<<x)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=x,p-=x,(x=s-o)<S){if(u<(x=S-x)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=d,(w=0)===c){if(w+=h-x,x<_){for(_-=x;E[s++]=d[w++],--x;);w=s-S,T=E}}else if(c<x){if(w+=h+c-x,(x-=c)<_){for(_-=x;E[s++]=d[w++],--x;);if(w=0,c<_){for(_-=x=c;E[s++]=d[w++],--x;);w=s-S,T=E}}}else if(w+=c-x,x<_){for(_-=x;E[s++]=d[w++],--x;);w=s-S,T=E}for(;2<_;)E[s++]=T[w++],E[s++]=T[w++],E[s++]=T[w++],_-=3;_&&(E[s++]=T[w++],1<_&&(E[s++]=T[w++]))}else{for(w=s-S;E[s++]=E[w++],E[s++]=E[w++],E[s++]=E[w++],2<(_-=3););_&&(E[s++]=E[w++],1<_&&(E[s++]=E[w++]))}break}}break}while(i<n&&s<a);i-=_=p>>3,f&=(1<<(p-=_<<3))-1,e.next_in=i,e.next_out=s,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=s<a?a-s+257:257-(s-a),r.hold=f,r.bits=p}},{}],49:[function(e,t,r){var i=e("../utils/common"),n=e("./adler32"),s=e("./crc32"),o=e("./inffast"),a=e("./inftrees");function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):-2}function c(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):-2}function d(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,c(e))):-2}function f(e,t){var r,i;return e?(i=new h,(e.state=i).window=null,0!==(r=d(e,t))&&(e.state=null),r):-2}var p,g,m=!0;function v(e,t,r,n){var s,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),n>=o.wsize?(i.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n<(s=o.wsize-o.wnext)&&(s=n),i.arraySet(o.window,t,r-n,s,o.wnext),(n-=s)?(i.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}r.inflateReset=c,r.inflateReset2=d,r.inflateResetKeep=u,r.inflateInit=function(e){return f(e,15)},r.inflateInit2=f,r.inflate=function(e,t){var r,h,u,c,d,f,b,y,x,_,S,w,T,P,E,C,A,I,M,R,O,k,N,L,D=0,B=new i.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return -2;12===(r=e.state).mode&&(r.mode=13),d=e.next_out,u=e.output,b=e.avail_out,c=e.next_in,h=e.input,f=e.avail_in,y=r.hold,x=r.bits,_=f,S=b,k=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;x<16;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(2&r.wrap&&35615===y){B[r.check=0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0),x=y=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&y)){e.msg="unknown compression method",r.mode=30;break}if(x-=4,O=8+(15&(y>>>=4)),0===r.wbits)r.wbits=O;else if(O>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<O,e.adler=r.check=1,r.mode=512&y?10:12,x=y=0;break;case 2:for(;x<16;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(r.flags=y,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=y>>8&1),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0)),x=y=0,r.mode=3;case 3:for(;x<32;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}r.head&&(r.head.time=y),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,B[2]=y>>>16&255,B[3]=y>>>24&255,r.check=s(r.check,B,4,0)),x=y=0,r.mode=4;case 4:for(;x<16;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}r.head&&(r.head.xflags=255&y,r.head.os=y>>8),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0)),x=y=0,r.mode=5;case 5:if(1024&r.flags){for(;x<16;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}r.length=y,r.head&&(r.head.extra_len=y),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0)),x=y=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(f<(w=r.length)&&(w=f),w&&(r.head&&(O=r.head.extra_len-r.length,r.head.extra||(r.head.extra=Array(r.head.extra_len)),i.arraySet(r.head.extra,h,c,w,O)),512&r.flags&&(r.check=s(r.check,h,w,c)),f-=w,c+=w,r.length-=w),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===f)break e;for(w=0;O=h[c+w++],r.head&&O&&r.length<65536&&(r.head.name+=String.fromCharCode(O)),O&&w<f;);if(512&r.flags&&(r.check=s(r.check,h,w,c)),f-=w,c+=w,O)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===f)break e;for(w=0;O=h[c+w++],r.head&&O&&r.length<65536&&(r.head.comment+=String.fromCharCode(O)),O&&w<f;);if(512&r.flags&&(r.check=s(r.check,h,w,c)),f-=w,c+=w,O)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;x<16;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(y!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}x=y=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;x<32;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}e.adler=r.check=l(y),x=y=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=d,e.avail_out=b,e.next_in=c,e.avail_in=f,r.hold=y,r.bits=x,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){y>>>=7&x,x-=7&x,r.mode=27;break}for(;x<3;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}switch(r.last=1&y,x-=1,3&(y>>>=1)){case 0:r.mode=14;break;case 1:if(function(e){if(m){var t;for(p=new i.Buf32(512),g=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,p,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,g,0,e.work,{bits:5}),m=!1}e.lencode=p,e.lenbits=9,e.distcode=g,e.distbits=5}(r),r.mode=20,6!==t)break;y>>>=2,x-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}y>>>=2,x-=2;break;case 14:for(y>>>=7&x,x-=7&x;x<32;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&y,x=y=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(w=r.length){if(f<w&&(w=f),b<w&&(w=b),0===w)break e;i.arraySet(u,h,c,w,d),f-=w,c+=w,b-=w,d+=w,r.length-=w;break}r.mode=12;break;case 17:for(;x<14;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(r.nlen=257+(31&y),y>>>=5,x-=5,r.ndist=1+(31&y),y>>>=5,x-=5,r.ncode=4+(15&y),y>>>=4,x-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;x<3;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}r.lens[F[r.have++]]=7&y,y>>>=3,x-=3}for(;r.have<19;)r.lens[F[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,N={bits:r.lenbits},k=a(0,r.lens,0,19,r.lencode,0,r.work,N),r.lenbits=N.bits,k){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;C=(D=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,A=65535&D,!((E=D>>>24)<=x);){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(A<16)y>>>=E,x-=E,r.lens[r.have++]=A;else{if(16===A){for(L=E+2;x<L;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(y>>>=E,x-=E,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}O=r.lens[r.have-1],w=3+(3&y),y>>>=2,x-=2}else if(17===A){for(L=E+3;x<L;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}x-=E,O=0,w=3+(7&(y>>>=E)),y>>>=3,x-=3}else{for(L=E+7;x<L;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}x-=E,O=0,w=11+(127&(y>>>=E)),y>>>=7,x-=7}if(r.have+w>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;w--;)r.lens[r.have++]=O}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,N={bits:r.lenbits},k=a(1,r.lens,0,r.nlen,r.lencode,0,r.work,N),r.lenbits=N.bits,k){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,N={bits:r.distbits},k=a(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,N),r.distbits=N.bits,k){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=f&&258<=b){e.next_out=d,e.avail_out=b,e.next_in=c,e.avail_in=f,r.hold=y,r.bits=x,o(e,S),d=e.next_out,u=e.output,b=e.avail_out,c=e.next_in,h=e.input,f=e.avail_in,y=r.hold,x=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;C=(D=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,A=65535&D,!((E=D>>>24)<=x);){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(C&&0==(240&C)){for(I=E,M=C,R=A;C=(D=r.lencode[R+((y&(1<<I+M)-1)>>I)])>>>16&255,A=65535&D,!(I+(E=D>>>24)<=x);){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}y>>>=I,x-=I,r.back+=I}if(y>>>=E,x-=E,r.back+=E,r.length=A,0===C){r.mode=26;break}if(32&C){r.back=-1,r.mode=12;break}if(64&C){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&C,r.mode=22;case 22:if(r.extra){for(L=r.extra;x<L;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}r.length+=y&(1<<r.extra)-1,y>>>=r.extra,x-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;C=(D=r.distcode[y&(1<<r.distbits)-1])>>>16&255,A=65535&D,!((E=D>>>24)<=x);){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(0==(240&C)){for(I=E,M=C,R=A;C=(D=r.distcode[R+((y&(1<<I+M)-1)>>I)])>>>16&255,A=65535&D,!(I+(E=D>>>24)<=x);){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}y>>>=I,x-=I,r.back+=I}if(y>>>=E,x-=E,r.back+=E,64&C){e.msg="invalid distance code",r.mode=30;break}r.offset=A,r.extra=15&C,r.mode=24;case 24:if(r.extra){for(L=r.extra;x<L;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}r.offset+=y&(1<<r.extra)-1,y>>>=r.extra,x-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===b)break e;if(w=S-b,r.offset>w){if((w=r.offset-w)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}T=w>r.wnext?(w-=r.wnext,r.wsize-w):r.wnext-w,w>r.length&&(w=r.length),P=r.window}else P=u,T=d-r.offset,w=r.length;for(b<w&&(w=b),b-=w,r.length-=w;u[d++]=P[T++],--w;);0===r.length&&(r.mode=21);break;case 26:if(0===b)break e;u[d++]=r.length,b--,r.mode=21;break;case 27:if(r.wrap){for(;x<32;){if(0===f)break e;f--,y|=h[c++]<<x,x+=8}if(S-=b,e.total_out+=S,r.total+=S,S&&(e.adler=r.check=r.flags?s(r.check,u,S,d-S):n(r.check,u,S,d-S)),S=b,(r.flags?y:l(y))!==r.check){e.msg="incorrect data check",r.mode=30;break}x=y=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;x<32;){if(0===f)break e;f--,y+=h[c++]<<x,x+=8}if(y!==(0xffffffff&r.total)){e.msg="incorrect length check",r.mode=30;break}x=y=0}r.mode=29;case 29:k=1;break e;case 30:k=-3;break e;case 31:return -4;default:return -2}return e.next_out=d,e.avail_out=b,e.next_in=c,e.avail_in=f,r.hold=y,r.bits=x,(r.wsize||S!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&v(e,e.output,e.next_out,S-e.avail_out)?(r.mode=31,-4):(_-=e.avail_in,S-=e.avail_out,e.total_in+=_,e.total_out+=S,r.total+=S,r.wrap&&S&&(e.adler=r.check=r.flags?s(r.check,u,S,e.next_out-S):n(r.check,u,S,e.next_out-S)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==_&&0===S||4===t)&&0===k&&(k=-5),k)},r.inflateEnd=function(e){if(!e||!e.state)return -2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:((r.head=t).done=!1,0):-2},r.inflateSetDictionary=function(e,t){var r,i=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&n(1,t,i,0)!==r.check?-3:v(e,t,i,i)?(r.mode=31,-4):(r.havedict=1,0):-2},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){var i=e("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,h,u,c,d){var f,p,g,m,v,b,y,x,_,S=d.bits,w=0,T=0,P=0,E=0,C=0,A=0,I=0,M=0,R=0,O=0,k=null,N=0,L=new i.Buf16(16),D=new i.Buf16(16),B=null,F=0;for(w=0;w<=15;w++)L[w]=0;for(T=0;T<l;T++)L[t[r+T]]++;for(C=S,E=15;1<=E&&0===L[E];E--);if(E<C&&(C=E),0===E)return h[u++]=0x1400000,h[u++]=0x1400000,d.bits=1,0;for(P=1;P<E&&0===L[P];P++);for(C<P&&(C=P),w=M=1;w<=15;w++)if(M<<=1,(M-=L[w])<0)return -1;if(0<M&&(0===e||1!==E))return -1;for(D[1]=0,w=1;w<15;w++)D[w+1]=D[w]+L[w];for(T=0;T<l;T++)0!==t[r+T]&&(c[D[t[r+T]]++]=T);if(b=0===e?(k=B=c,19):1===e?(k=n,N-=257,B=s,F-=257,256):(k=o,B=a,-1),w=P,v=u,I=T=O=0,g=-1,m=(R=1<<(A=C))-1,1===e&&852<R||2===e&&592<R)return 1;for(;;){for(y=w-I,_=c[T]<b?(x=0,c[T]):c[T]>b?(x=B[F+c[T]],k[N+c[T]]):(x=96,0),f=1<<w-I,P=p=1<<A;h[v+(O>>I)+(p-=f)]=y<<24|x<<16|_|0,0!==p;);for(f=1<<w-1;O&f;)f>>=1;if(0!==f?(O&=f-1,O+=f):O=0,T++,0==--L[w]){if(w===E)break;w=t[r+c[T]]}if(C<w&&(O&m)!==g){for(0===I&&(I=C),v+=P,M=1<<(A=w-I);A+I<E&&!((M-=L[A+I])<=0);)A++,M<<=1;if(R+=1<<A,1===e&&852<R||2===e&&592<R)return 1;h[g=O&m]=C<<24|A<<16|v-u|0}}return 0!==O&&(h[v+O]=w-I<<24|4194304),d.bits=C,0}},{"../utils/common":41}],51:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){var i=e("../utils/common");function n(e){for(var t=e.length;0<=--t;)e[t]=0}var s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],h=Array(576);n(h);var u=Array(60);n(u);var c=Array(512);n(c);var d=Array(256);n(d);var f=Array(29);n(f);var p,g,m,v=Array(30);function b(e,t,r,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function y(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x(e){return e<256?c[e]:c[256+(e>>>7)]}function _(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,_(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function w(e,t,r){S(e,r[2*t],r[2*t+1])}function T(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function P(e,t,r){var i,n,s=Array(16),o=0;for(i=1;i<=15;i++)s[i]=o=o+r[i-1]<<1;for(n=0;n<=t;n++){var a=e[2*n+1];0!==a&&(e[2*n]=T(s[a]++,a))}}function E(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){8<e.bi_valid?_(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function A(e,t,r,i){var n=2*t,s=2*r;return e[n]<e[s]||e[n]===e[s]&&i[t]<=i[r]}function I(e,t,r){for(var i=e.heap[r],n=r<<1;n<=e.heap_len&&(n<e.heap_len&&A(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!A(t,i,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=i}function M(e,t,r){var i,n,a,l,h=0;if(0!==e.last_lit)for(;i=e.pending_buf[e.d_buf+2*h]<<8|e.pending_buf[e.d_buf+2*h+1],n=e.pending_buf[e.l_buf+h],h++,0===i?w(e,n,t):(w(e,(a=d[n])+256+1,t),0!==(l=s[a])&&S(e,n-=f[a],l),w(e,a=x(--i),r),0!==(l=o[a])&&S(e,i-=v[a],l)),h<e.last_lit;);w(e,256,t)}function R(e,t){var r,i,n,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==s[2*r]?(e.heap[++e.heap_len]=h=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(n=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[n]=0,e.opt_len--,a&&(e.static_len-=o[2*n+1]);for(t.max_code=h,r=e.heap_len>>1;1<=r;r--)I(e,s,r);for(n=l;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],I(e,s,1),i=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=i,s[2*n]=s[2*r]+s[2*i],e.depth[n]=(e.depth[r]>=e.depth[i]?e.depth[r]:e.depth[i])+1,s[2*r+1]=s[2*i+1]=n,e.heap[1]=n++,I(e,s,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,i,n,s,o,a,l=t.dyn_tree,h=t.max_code,u=t.stat_desc.static_tree,c=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(s=0;s<=15;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)p<(s=l[2*l[2*(i=e.heap[r])+1]+1]+1)&&(s=p,g++),l[2*i+1]=s,h<i||(e.bl_count[s]++,o=0,f<=i&&(o=d[i-f]),a=l[2*i],e.opt_len+=a*(s+o),c&&(e.static_len+=a*(u[2*i+1]+o)));if(0!==g){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,g-=2}while(0<g);for(s=p;0!==s;s--)for(i=e.bl_count[s];0!==i;)h<(n=e.heap[--r])||(l[2*n+1]!==s&&(e.opt_len+=(s-l[2*n+1])*l[2*n],l[2*n+1]=s),i--)}}(e,t),P(s,h,e.bl_count)}function O(e,t,r){var i,n,s=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),t[2*(r+1)+1]=65535,i=0;i<=r;i++)n=o,o=t[2*(i+1)+1],++a<l&&n===o||(a<h?e.bl_tree[2*n]+=a:0!==n?(n!==s&&e.bl_tree[2*n]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=n,h=(a=0)===o?(l=138,3):n===o?(l=6,3):(l=7,4))}function k(e,t,r){var i,n,s=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),i=0;i<=r;i++)if(n=o,o=t[2*(i+1)+1],!(++a<l&&n===o)){if(a<h)for(;w(e,n,e.bl_tree),0!=--a;);else 0!==n?(n!==s&&(w(e,n,e.bl_tree),a--),w(e,16,e.bl_tree),S(e,a-3,2)):a<=10?(w(e,17,e.bl_tree),S(e,a-3,3)):(w(e,18,e.bl_tree),S(e,a-11,7));s=n,h=(a=0)===o?(l=138,3):n===o?(l=6,3):(l=7,4)}}n(v);var N=!1;function L(e,t,r,n){var s,o,a,l;S(e,0+(n?1:0),3),s=e,o=t,a=r,C(s),_(s,a),_(s,~a),i.arraySet(s.pending_buf,s.window,o,a,s.pending),s.pending+=a}r._tr_init=function(e){N||(function(){var e,t,r,i,n,l=Array(16);for(i=r=0;i<28;i++)for(f[i]=r,e=0;e<1<<s[i];e++)d[r++]=i;for(d[r-1]=i,i=n=0;i<16;i++)for(v[i]=n,e=0;e<1<<o[i];e++)c[n++]=i;for(n>>=7;i<30;i++)for(v[i]=n<<7,e=0;e<1<<o[i]-7;e++)c[256+n++]=i;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)h[2*e+1]=8,e++,l[8]++;for(;e<=255;)h[2*e+1]=9,e++,l[9]++;for(;e<=279;)h[2*e+1]=7,e++,l[7]++;for(;e<=287;)h[2*e+1]=8,e++,l[8]++;for(P(h,287,l),e=0;e<30;e++)u[2*e+1]=5,u[2*e]=T(e,5);p=new b(h,s,257,286,15),g=new b(u,o,0,30,15),m=new b([],a,0,19,7)}(),N=!0),e.l_desc=new y(e.dyn_ltree,p),e.d_desc=new y(e.dyn_dtree,g),e.bl_desc=new y(e.bl_tree,m),e.bi_buf=0,e.bi_valid=0,E(e)},r._tr_stored_block=L,r._tr_flush_block=function(e,t,r,i){var n,s,o=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=0xf3ffc07f;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),R(e,e.l_desc),R(e,e.d_desc),o=function(e){var t;for(O(e,e.dyn_ltree,e.l_desc.max_code),O(e,e.dyn_dtree,e.d_desc.max_code),R(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==t?L(e,t,r,i):4===e.strategy||s===n?(S(e,2+(i?1:0),3),M(e,h,u)):(S(e,4+(i?1:0),3),function(e,t,r,i){var n;for(S(e,t-257,5),S(e,r-1,5),S(e,i-4,4),n=0;n<i;n++)S(e,e.bl_tree[2*l[n]+1],3);k(e,e.dyn_ltree,t-1),k(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),M(e,e.dyn_ltree,e.dyn_dtree)),E(e),i&&C(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(d[r]+256+1)]++,e.dyn_dtree[2*x(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){var t;S(e,2,3),w(e,256,h),16===(t=e).bi_valid?(_(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(e){!function(e,t){if(!e.setImmediate){var i,n,s,o,a=1,l={},h=!1,u=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,i="[object process]"===({}).toString.call(e.process)?function(e){r.nextTick(function(){f(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){f(e.data)},function(e){s.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(n=u.documentElement,function(e){var t=u.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(f,0,e)}:(o="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",p,!1):e.attachEvent("onmessage",p),function(t){e.postMessage(o+t,"*")}),c.setImmediate=function(e){"function"!=typeof e&&(e=Function(""+e));for(var t=Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return l[a]=n,i(a),a++},c.clearImmediate=d}function d(e){delete l[e]}function f(e){if(h)setTimeout(f,0,e);else{var t=l[e];if(t){h=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{d(e),h=!1}}}}function p(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&f(+t.data.slice(o.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,t,i){(function(e){(function(){"use strict";var r=/[\\^$.*+?()[\]{}|]/g,i=RegExp(r.source),n="object"==typeof e&&e&&e.Object===Object&&e,s="object"==typeof self&&self&&self.Object===Object&&self,o=n||s||Function("return this")(),a=Object.prototype.toString,l=o.Symbol,h=l?l.prototype:void 0,u=h?h.toString:void 0;t.exports=function(e){var t;return(e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if("symbol"==typeof(t=e)||(r=t)&&"object"==typeof r&&"[object Symbol]"==a.call(t))return u?u.call(e):"";var t,r,i=e+"";return"0"==i&&1/e==-Infinity?"-0":i}(t))&&i.test(e)?e.replace(r,"\\$&"):e}}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],443:[function(e,t,i){(function(e){(function(){"use strict";var r,n="[object Arguments]",s="[object Map]",o="[object Object]",a="[object Set]",l=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,u=/^\./,c=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,f=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,g={};g["[object Float32Array]"]=g["[object Float64Array]"]=g["[object Int8Array]"]=g["[object Int16Array]"]=g["[object Int32Array]"]=g["[object Uint8Array]"]=g["[object Uint8ClampedArray]"]=g["[object Uint16Array]"]=g["[object Uint32Array]"]=!0,g[n]=g["[object Array]"]=g["[object ArrayBuffer]"]=g["[object Boolean]"]=g["[object DataView]"]=g["[object Date]"]=g["[object Error]"]=g["[object Function]"]=g[s]=g["[object Number]"]=g[o]=g["[object RegExp]"]=g[a]=g["[object String]"]=g["[object WeakMap]"]=!1;var m="object"==typeof e&&e&&e.Object===Object&&e,v="object"==typeof self&&self&&self.Object===Object&&self,b=m||v||Function("return this")(),y="object"==typeof i&&i&&!i.nodeType&&i,x=y&&"object"==typeof t&&t&&!t.nodeType&&t,_=x&&x.exports===y&&m.process,S=function(){try{return _&&_.binding("util")}catch(e){}}(),w=S&&S.isTypedArray;function T(e,t,r,i){for(var n=-1,s=e?e.length:0;++n<s;){var o=e[n];t(i,o,r(o),e)}return i}function P(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function E(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function C(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var A,I,M,R=Array.prototype,O=Function.prototype,k=Object.prototype,N=b["__core-js_shared__"],L=(A=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",D=O.toString,B=k.hasOwnProperty,F=k.toString,V=RegExp("^"+D.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),G=b.Symbol,U=b.Uint8Array,z=k.propertyIsEnumerable,j=R.splice,H=(I=Object.keys,M=Object,function(e){return I(M(e))}),W=ew(b,"DataView"),q=ew(b,"Map"),X=ew(b,"Promise"),$=ew(b,"Set"),Y=ew(b,"WeakMap"),Z=ew(Object,"create"),K=eR(W),J=eR(q),Q=eR(X),ee=eR($),et=eR(Y),er=G?G.prototype:void 0,ei=er?er.valueOf:void 0,en=er?er.toString:void 0;function es(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eo(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ea(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function el(e){var t=-1,r=e?e.length:0;for(this.__data__=new ea;++t<r;)this.add(e[t])}function eh(e){this.__data__=new eo(e)}function eu(e,t){for(var r=e.length;r--;)if(eD(e[r][0],t))return r;return -1}function ec(e,t,r,i){return eg(e,function(e,n,s){t(i,e,r(e),s)}),i}es.prototype.clear=function(){this.__data__=Z?Z(null):{}},es.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},es.prototype.get=function(e){var t=this.__data__;if(Z){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return B.call(t,e)?t[e]:void 0},es.prototype.has=function(e){var t=this.__data__;return Z?void 0!==t[e]:B.call(t,e)},es.prototype.set=function(e,t){return this.__data__[e]=Z&&void 0===t?"__lodash_hash_undefined__":t,this},eo.prototype.clear=function(){this.__data__=[]},eo.prototype.delete=function(e){var t=this.__data__,r=eu(t,e);return!(r<0)&&(r==t.length-1?t.pop():j.call(t,r,1),!0)},eo.prototype.get=function(e){var t=this.__data__,r=eu(t,e);return r<0?void 0:t[r][1]},eo.prototype.has=function(e){return eu(this.__data__,e)>-1},eo.prototype.set=function(e,t){var r=this.__data__,i=eu(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},ea.prototype.clear=function(){this.__data__={hash:new es,map:new(q||eo),string:new es}},ea.prototype.delete=function(e){return eS(this,e).delete(e)},ea.prototype.get=function(e){return eS(this,e).get(e)},ea.prototype.has=function(e){return eS(this,e).has(e)},ea.prototype.set=function(e,t){return eS(this,e).set(e,t),this},el.prototype.add=el.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},el.prototype.has=function(e){return this.__data__.has(e)},eh.prototype.clear=function(){this.__data__=new eo},eh.prototype.delete=function(e){return this.__data__.delete(e)},eh.prototype.get=function(e){return this.__data__.get(e)},eh.prototype.has=function(e){return this.__data__.has(e)},eh.prototype.set=function(e,t){var r=this.__data__;if(r instanceof eo){var i=r.__data__;if(!q||i.length<199)return i.push([e,t]),this;r=this.__data__=new ea(i)}return r.set(e,t),this};var ed,ef,ep,eg=(ef=function(e,t){return e&&em(e,t,eq)},function(e,t){if(null==e)return e;if(!eV(e))return ef(e,t);for(var r=e.length,i=ep?r:-1,n=Object(e);(ep?i--:++i<r)&&!1!==t(n[i],i,n););return e}),em=function(e,t,r){for(var i=-1,n=Object(e),s=r(e),o=s.length;o--;){var a=s[++i];if(!1===t(n[a],a,n))break}return e};function ev(e,t){for(var r=0,i=(t=eE(t,e)?[t]:function(e){return eF(e)?e:eI(e)}(t)).length;null!=e&&r<i;)e=e[eM(t[r++])];return r&&r==i?e:void 0}function eb(e,t){return null!=e&&t in Object(e)}function ey(e,t,r,i,l){return e===t||(null!=e&&null!=t&&(ez(e)||ej(t))?function(e,t,r,i,l,h){var u=eF(e),c=eF(t),d="[object Array]",f="[object Array]";u||(d=(d=eT(e))==n?o:d),c||(f=(f=eT(t))==n?o:f);var p=d==o&&!P(e),g=f==o&&!P(t),m=d==f;if(m&&!p)return h||(h=new eh),u||eW(e)?e_(e,t,r,i,l,h):function(e,t,r,i,n,o,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new U(e),new U(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eD(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case s:var h=E;case a:var u=2&o;if(h||(h=C),e.size!=t.size&&!u)break;var c=l.get(e);if(c)return c==t;o|=1,l.set(e,t);var d=e_(h(e),h(t),i,n,o,l);return l.delete(e),d;case"[object Symbol]":if(ei)return ei.call(e)==ei.call(t)}return!1}(e,t,d,r,i,l,h);if(!(2&l)){var v=p&&B.call(e,"__wrapped__"),b=g&&B.call(t,"__wrapped__");if(v||b){var y=v?e.value():e,x=b?t.value():t;return h||(h=new eh),r(y,x,i,l,h)}}return!!m&&(h||(h=new eh),function(e,t,r,i,n,s){var o=2&n,a=eq(e),l=a.length;if(l!=eq(t).length&&!o)return!1;for(var h=l;h--;){var u=a[h];if(!(o?u in t:B.call(t,u)))return!1}var c=s.get(e);if(c&&s.get(t))return c==t;var d=!0;s.set(e,t),s.set(t,e);for(var f=o;++h<l;){var p=e[u=a[h]],g=t[u];if(i)var m=o?i(g,p,u,t,e,s):i(p,g,u,e,t,s);if(!(void 0===m?p===g||r(p,g,i,n,s):m)){d=!1;break}f||(f="constructor"==u)}if(d&&!f){var v=e.constructor,b=t.constructor;v==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,i,l,h))}(e,t,ey,r,i,l):e!=e&&t!=t)}function ex(e){return eF(e)?e:eI(e)}function e_(e,t,r,i,n,s){var o=2&n,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var h=s.get(e);if(h&&s.get(t))return h==t;var u=-1,c=!0,d=1&n?new el:void 0;for(s.set(e,t),s.set(t,e);++u<a;){var f=e[u],p=t[u];if(i)var g=o?i(p,f,u,t,e,s):i(f,p,u,e,t,s);if(void 0!==g){if(g)continue;c=!1;break}if(d){if(!function(e,t){for(var r=-1,i=e?e.length:0;++r<i;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!d.has(t)&&(f===e||r(f,e,i,n,s)))return d.add(t)})){c=!1;break}}else if(f!==p&&!r(f,p,i,n,s)){c=!1;break}}return s.delete(e),s.delete(t),c}function eS(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function ew(e,t){var r,i,n,s,o=(r=e,i=t,null==r?void 0:r[i]);return!(!ez(n=o)||(s=n,L&&L in s))&&(eG(n)||P(n)?V:f).test(eR(n))?o:void 0}var eT=function(e){return F.call(e)};function eP(e,t){return!!(t=null==t?0x1fffffffffffff:t)&&("number"==typeof e||p.test(e))&&e>-1&&e%1==0&&e<t}function eE(e,t){if(eF(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!eH(e))||h.test(e)||!l.test(e)||null!=t&&e in Object(t)}function eC(e){return e==e&&!ez(e)}function eA(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}(W&&"[object DataView]"!=eT(new W(new ArrayBuffer(1)))||q&&eT(new q)!=s||X&&"[object Promise]"!=eT(X.resolve())||$&&eT(new $)!=a||Y&&"[object WeakMap]"!=eT(new Y))&&(eT=function(e){var t=F.call(e),r=t==o?e.constructor:void 0,i=r?eR(r):void 0;if(i)switch(i){case K:return"[object DataView]";case J:return s;case Q:return"[object Promise]";case ee:return a;case et:return"[object WeakMap]"}return t});var eI=eL(function(e){e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(eH(e))return en?en.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}(t);var t,r=[];return u.test(e)&&r.push(""),e.replace(c,function(e,t,i,n){r.push(i?n.replace(d,"$1"):t||e)}),r});function eM(e){if("string"==typeof e||eH(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function eR(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var eO,ek,eN=(eO=function(e,t,r){B.call(e,r)?e[r].push(t):e[r]=[t]},function(e,t){var r,i,n,s,o,a,l,h=eF(e)?T:ec,u=ek?ek():{};return h(e,eO,"function"==typeof(r=t)?r:null==r?eX:"object"==typeof r?eF(r)?(n=r[0],s=r[1],eE(n)&&function(e){return e==e&&!ez(e)}(s)?eA(eM(n),s):function(e){var t,r,i,o,a,l,h=(t=e,r=n,void 0===(o=null==t?void 0:ev(t,r))?void 0:o);return void 0===h&&h===s?(a=e,l=n,null!=a&&function(e,t,r){t=eE(t,e)?[t]:function(e){return eF(e)?e:eI(e)}(t);for(var i,n=-1,s=t.length;++n<s;){var o=eM(t[n]);if(!(i=null!=e&&r(e,o)))break;e=e[o]}return i?i:!!(s=e?e.length:0)&&eU(s)&&eP(o,s)&&(eF(e)||eB(e))}(a,l,eb)):ey(s,h,void 0,3)}):1==(a=function(e){for(var t=eq(e),r=t.length;r--;){var i=t[r],n=e[i];t[r]=[i,n,function(e){return e==e&&!ez(e)}(n)]}return t}(o=r)).length&&a[0][2]?eA(a[0][0],a[0][1]):function(e){return e===o||function(e,t,r,i){var n=r.length,s=n,o=true;if(null==e)return!s;for(e=Object(e);n--;){var a=r[n];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++n<s;){var l=(a=r[n])[0],h=e[l],u=a[1];if(o&&a[2]){if(void 0===h&&!(l in e))return!1}else{var c=new eh;if(i)var d=i(h,u,l,e,t,c);if(!(void 0===d?ey(u,h,i,3,c):d))return!1}}return!0}(e,o,a)}:eE(r)?(i=eM(r),function(e){return null==e?void 0:e[i]}):(l=r,function(e){return ev(e,l)}),u)});function eL(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw TypeError("Expected a function");var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var o=e.apply(this,i);return r.cache=s.set(n,o),o};return r.cache=new(eL.Cache||ea),r}function eD(e,t){return e===t||e!=e&&t!=t}function eB(e){var t;return ej(t=e)&&eV(t)&&B.call(e,"callee")&&(!z.call(e,"callee")||F.call(e)==n)}eL.Cache=ea;var eF=Array.isArray;function eV(e){return null!=e&&eU(e.length)&&!eG(e)}function eG(e){var t=ez(e)?F.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function eU(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function ez(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ej(e){return!!e&&"object"==typeof e}function eH(e){return"symbol"==typeof e||ej(e)&&"[object Symbol]"==F.call(e)}var eW=w?(r=w,function(e){return r(e)}):function(e){return ej(e)&&eU(e.length)&&!!g[F.call(e)]};function eq(e){return eV(e)?function(e,t){var r=eF(e)||eB(e)?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],i=r.length,n=!!i;for(var s in e)!B.call(e,s)||n&&("length"==s||eP(s,i))||r.push(s);return r}(e):function(e){if(r="function"==typeof(t=e&&e.constructor)&&t.prototype||k,e!==r)return H(e);var t,r,i=[];for(var n in Object(e))B.call(e,n)&&"constructor"!=n&&i.push(n);return i}(e)}function eX(e){return e}t.exports=eN}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],444:[function(e,t,r){"use strict";var i=Object.prototype.toString;t.exports=function(e){var t;return!0===e||!1===e||!!(t=e)&&"object"==typeof t&&"[object Boolean]"==i.call(e)}},{}],445:[function(e,t,i){(function(e){(function(){"use strict";var r,n="[object Arguments]",s="[object Map]",o="[object Object]",a="[object Set]",l=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[n]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u[s]=u["[object Number]"]=u[o]=u["[object RegExp]"]=u[a]=u["[object String]"]=u["[object WeakMap]"]=!1;var c="object"==typeof e&&e&&e.Object===Object&&e,d="object"==typeof self&&self&&self.Object===Object&&self,f=c||d||Function("return this")(),p="object"==typeof i&&i&&!i.nodeType&&i,g=p&&"object"==typeof t&&t&&!t.nodeType&&t,m=g&&g.exports===p,v=m&&c.process,b=function(){try{return v&&v.binding&&v.binding("util")}catch(e){}}(),y=b&&b.isTypedArray;function x(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function _(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var S,w,T,P=Array.prototype,E=Function.prototype,C=Object.prototype,A=f["__core-js_shared__"],I=E.toString,M=C.hasOwnProperty,R=(S=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",O=C.toString,k=RegExp("^"+I.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=m?f.Buffer:void 0,L=f.Symbol,D=f.Uint8Array,B=C.propertyIsEnumerable,F=P.splice,V=L?L.toStringTag:void 0,G=Object.getOwnPropertySymbols,U=N?N.isBuffer:void 0,z=(w=Object.keys,T=Object,function(e){return w(T(e))}),j=ef(f,"DataView"),H=ef(f,"Map"),W=ef(f,"Promise"),q=ef(f,"Set"),X=ef(f,"WeakMap"),$=ef(Object,"create"),Y=em(j),Z=em(H),K=em(W),J=em(q),Q=em(X),ee=L?L.prototype:void 0,et=ee?ee.valueOf:void 0;function er(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ei(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function en(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function es(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new en;++t<r;)this.add(e[t])}function eo(e){var t=this.__data__=new ei(e);this.size=t.size}function ea(e,t){for(var r=e.length;r--;)if(ev(e[r][0],t))return r;return -1}function el(e){var t;return null==e?void 0===e?"[object Undefined]":"[object Null]":V&&V in Object(e)?function(e){var t=M.call(e,V),r=e[V];try{e[V]=void 0;var i=!0}catch(e){}var n=O.call(e);return i&&(t?e[V]=r:delete e[V]),n}(e):(t=e,O.call(t))}function eh(e){return eT(e)&&el(e)==n}function eu(e,t,r,i,n,s){var o=1&r,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var h=s.get(e);if(h&&s.get(t))return h==t;var u=-1,c=!0,d=2&r?new es:void 0;for(s.set(e,t),s.set(t,e);++u<a;){var f=e[u],p=t[u];if(i)var g=o?i(p,f,u,t,e,s):i(f,p,u,e,t,s);if(void 0!==g){if(g)continue;c=!1;break}if(d){if(!function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!d.has(t)&&(f===e||n(f,e,r,i,s)))return d.push(t)})){c=!1;break}}else if(f!==p&&!n(f,p,r,i,s)){c=!1;break}}return s.delete(e),s.delete(t),c}function ec(e){var t,r,i,n;return t=e,r=eE,i=ep,n=r(t),ey(t)?n:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(n,i(t))}function ed(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function ef(e,t){var r,i,n,s,o=(r=e,i=t,null==r?void 0:r[i]);return!(!ew(n=o)||(s=n,R&&R in s))&&(e_(n)?k:l).test(em(n))?o:void 0}er.prototype.clear=function(){this.__data__=$?$(null):{},this.size=0},er.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},er.prototype.get=function(e){var t=this.__data__;if($){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return M.call(t,e)?t[e]:void 0},er.prototype.has=function(e){var t=this.__data__;return $?void 0!==t[e]:M.call(t,e)},er.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=$&&void 0===t?"__lodash_hash_undefined__":t,this},ei.prototype.clear=function(){this.__data__=[],this.size=0},ei.prototype.delete=function(e){var t=this.__data__,r=ea(t,e);return!(r<0)&&(r==t.length-1?t.pop():F.call(t,r,1),--this.size,!0)},ei.prototype.get=function(e){var t=this.__data__,r=ea(t,e);return r<0?void 0:t[r][1]},ei.prototype.has=function(e){return ea(this.__data__,e)>-1},ei.prototype.set=function(e,t){var r=this.__data__,i=ea(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},en.prototype.clear=function(){this.size=0,this.__data__={hash:new er,map:new(H||ei),string:new er}},en.prototype.delete=function(e){var t=ed(this,e).delete(e);return this.size-=t?1:0,t},en.prototype.get=function(e){return ed(this,e).get(e)},en.prototype.has=function(e){return ed(this,e).has(e)},en.prototype.set=function(e,t){var r=ed(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},es.prototype.add=es.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},es.prototype.has=function(e){return this.__data__.has(e)},eo.prototype.clear=function(){this.__data__=new ei,this.size=0},eo.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},eo.prototype.get=function(e){return this.__data__.get(e)},eo.prototype.has=function(e){return this.__data__.has(e)},eo.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ei){var i=r.__data__;if(!H||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new en(i)}return r.set(e,t),this.size=r.size,this};var ep=G?function(e){return null==e?[]:function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,s=[];++r<i;){var o=e[r];t(o,r,e)&&(s[n++]=o)}return s}(G(e=Object(e)),function(t){return B.call(e,t)})}:function(){return[]},eg=el;function em(e){if(null!=e){try{return I.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ev(e,t){return e===t||e!=e&&t!=t}(j&&"[object DataView]"!=eg(new j(new ArrayBuffer(1)))||H&&eg(new H)!=s||W&&"[object Promise]"!=eg(W.resolve())||q&&eg(new q)!=a||X&&"[object WeakMap]"!=eg(new X))&&(eg=function(e){var t=el(e),r=t==o?e.constructor:void 0,i=r?em(r):"";if(i)switch(i){case Y:return"[object DataView]";case Z:return s;case K:return"[object Promise]";case J:return a;case Q:return"[object WeakMap]"}return t});var eb=eh(function(){return arguments}())?eh:function(e){return eT(e)&&M.call(e,"callee")&&!B.call(e,"callee")},ey=Array.isArray,ex=U||function(){return!1};function e_(e){if(!ew(e))return!1;var t=el(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eS(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function ew(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eT(e){return null!=e&&"object"==typeof e}var eP=y?(r=y,function(e){return r(e)}):function(e){return eT(e)&&eS(e.length)&&!!u[el(e)]};function eE(e){return null!=e&&eS(e.length)&&!e_(e)?function(e,t){var r=ey(e),i=!r&&eb(e),n=!r&&!i&&ex(e),s=!r&&!i&&!n&&eP(e),o=r||i||n||s,a=o?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],l=a.length;for(var u in e)!M.call(e,u)||o&&("length"==u||n&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||function(e,t){return!!(t=null==t?0x1fffffffffffff:t)&&("number"==typeof e||h.test(e))&&e>-1&&e%1==0&&e<t}(u,l))||a.push(u);return a}(e):function(e){if(r="function"==typeof(t=e&&e.constructor)&&t.prototype||C,e!==r)return z(e);var t,r,i=[];for(var n in Object(e))M.call(e,n)&&"constructor"!=n&&i.push(n);return i}(e)}t.exports=function(e,t){return function e(t,r,i,l,h){return t===r||(null!=t&&null!=r&&(eT(t)||eT(r))?function(e,t,r,i,l,h){var u=ey(e),c=ey(t),d=u?"[object Array]":eg(e),f=c?"[object Array]":eg(t),p=(d=d==n?o:d)==o,g=(f=f==n?o:f)==o,m=d==f;if(m&&ex(e)){if(!ex(t))return!1;u=!0,p=!1}if(m&&!p)return h||(h=new eo),u||eP(e)?eu(e,t,r,i,l,h):function(e,t,r,i,n,o,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new D(e),new D(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ev(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case s:var h=x;case a:var u=1&i;if(h||(h=_),e.size!=t.size&&!u)break;var c=l.get(e);if(c)return c==t;i|=2,l.set(e,t);var d=eu(h(e),h(t),i,n,o,l);return l.delete(e),d;case"[object Symbol]":if(et)return et.call(e)==et.call(t)}return!1}(e,t,d,r,i,l,h);if(!(1&r)){var v=p&&M.call(e,"__wrapped__"),b=g&&M.call(t,"__wrapped__");if(v||b){var y=v?e.value():e,S=b?t.value():t;return h||(h=new eo),l(y,S,r,i,h)}}return!!m&&(h||(h=new eo),function(e,t,r,i,n,s){var o=1&r,a=ec(e),l=a.length;if(l!=ec(t).length&&!o)return!1;for(var h=l;h--;){var u=a[h];if(!(o?u in t:M.call(t,u)))return!1}var c=s.get(e);if(c&&s.get(t))return c==t;var d=!0;s.set(e,t),s.set(t,e);for(var f=o;++h<l;){var p=e[u=a[h]],g=t[u];if(i)var m=o?i(g,p,u,t,e,s):i(p,g,u,e,t,s);if(!(void 0===m?p===g||n(p,g,r,i,s):m)){d=!1;break}f||(f="constructor"==u)}if(d&&!f){var v=e.constructor,b=t.constructor;v==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,i,l,h))}(t,r,i,l,e,h):t!=t&&r!=r)}(e,t)}}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],446:[function(e,t,i){(function(e){(function(){"use strict";var r="object"==typeof e&&e&&e.Object===Object&&e,i="object"==typeof self&&self&&self.Object===Object&&self,n=r||i||Function("return this")(),s=Object.prototype,o=s.hasOwnProperty,a=s.toString,l=n.Symbol,h=l?l.toStringTag:void 0;t.exports=function(e){if(r=typeof(t=e),null==t||"object"!=r&&"function"!=r)return!1;var t,r,i,n,s=null==(i=e)?void 0===i?"[object Undefined]":"[object Null]":h&&h in Object(i)?function(e){var t=o.call(e,h),r=e[h];try{e[h]=void 0;var i=!0}catch(e){}var n=a.call(e);return i&&(t?e[h]=r:delete e[h]),n}(i):(n=i,a.call(n));return"[object Function]"==s||"[object GeneratorFunction]"==s||"[object AsyncFunction]"==s||"[object Proxy]"==s}}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],447:[function(e,t,r){"use strict";t.exports=function(e){return null==e}},{}],448:[function(e,t,r){"use strict";t.exports=function(e){return void 0===e}},{}],449:[function(e,t,i){(function(e){(function(){"use strict";var r=/^\[object .+?Constructor\]$/,i="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,s=i||n||Function("return this")();function o(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,i){for(var n=e.length,s=r+-1;i?s--:++s<n;)if(t(e[s],s,e))return s;return -1}(e,l,0);for(var i=r-1,n=e.length;++i<n;)if(e[i]===t)return i;return -1}(e,t,0)>-1}function a(e,t,r){for(var i=-1,n=e?e.length:0;++i<n;)if(r(t,e[i]))return!0;return!1}function l(e){return e!=e}function h(e,t){return e.has(t)}function u(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var c,d=Array.prototype,f=Function.prototype,p=Object.prototype,g=s["__core-js_shared__"],m=(c=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",v=f.toString,b=p.hasOwnProperty,y=p.toString,x=RegExp("^"+v.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_=d.splice,S=O(s,"Map"),w=O(s,"Set"),T=O(Object,"create");function P(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function E(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function C(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function A(e){var t=-1,r=e?e.length:0;for(this.__data__=new C;++t<r;)this.add(e[t])}function I(e,t){for(var r,i=e.length;i--;)if((r=e[i][0])===t||r!=r&&t!=t)return i;return -1}P.prototype.clear=function(){this.__data__=T?T(null):{}},P.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},P.prototype.get=function(e){var t=this.__data__;if(T){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return b.call(t,e)?t[e]:void 0},P.prototype.has=function(e){var t=this.__data__;return T?void 0!==t[e]:b.call(t,e)},P.prototype.set=function(e,t){return this.__data__[e]=T&&void 0===t?"__lodash_hash_undefined__":t,this},E.prototype.clear=function(){this.__data__=[]},E.prototype.delete=function(e){var t=this.__data__,r=I(t,e);return!(r<0)&&(r==t.length-1?t.pop():_.call(t,r,1),!0)},E.prototype.get=function(e){var t=this.__data__,r=I(t,e);return r<0?void 0:t[r][1]},E.prototype.has=function(e){return I(this.__data__,e)>-1},E.prototype.set=function(e,t){var r=this.__data__,i=I(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},C.prototype.clear=function(){this.__data__={hash:new P,map:new(S||E),string:new P}},C.prototype.delete=function(e){return R(this,e).delete(e)},C.prototype.get=function(e){return R(this,e).get(e)},C.prototype.has=function(e){return R(this,e).has(e)},C.prototype.set=function(e,t){return R(this,e).set(e,t),this},A.prototype.add=A.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},A.prototype.has=function(e){return this.__data__.has(e)};var M=w&&1/u(new w([,-0]))[1]==1/0?function(e){return new w(e)}:function(){};function R(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function O(e,t){var i,n,s=(i=e,n=t,null==i?void 0:i[n]);return!function(e){var t,i;return!(!k(e)||m&&m in e)&&("[object Function]"==(i=k(t=e)?y.call(t):"")||"[object GeneratorFunction]"==i||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?x:r).test(function(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}(s)?void 0:s}function k(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=function(e){return e&&e.length?function(e,t,r){var i=-1,n=o,s=e.length,a=!0,l=[],c=l;if(s>=200){var d=M(e);if(d)return u(d);a=!1,n=h,c=new A}else c=t?[]:l;e:for(;++i<s;){var f=e[i],p=t?t(f):f;if(f=r||0!==f?f:0,a&&p==p){for(var g=c.length;g--;)if(c[g]===p)continue e;t&&c.push(p),l.push(f)}else n(c,p,r)||(c!==l&&c.push(p),l.push(f))}return l}(e):[]}}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],450:[function(e,t,r){"use strict";var i=e("inherits"),n=e("hash-base"),s=e("safe-buffer").Buffer,o=Array(16);function a(){n.call(this,64),this._a=0x67452301,this._b=0xefcdab89,this._c=0x98badcfe,this._d=0x10325476}function l(e,t){return e<<t|e>>>32-t}function h(e,t,r,i,n,s,o){return l(e+(t&r|~t&i)+n+s|0,o)+t|0}function u(e,t,r,i,n,s,o){return l(e+(t&i|r&~i)+n+s|0,o)+t|0}function c(e,t,r,i,n,s,o){return l(e+(t^r^i)+n+s|0,o)+t|0}function d(e,t,r,i,n,s,o){return l(e+(r^(t|~i))+n+s|0,o)+t|0}i(a,n),a.prototype._update=function(){for(var e=0;e<16;++e)o[e]=this._block.readInt32LE(4*e);var t=this._a,r=this._b,i=this._c,n=this._d;t=h(t,r,i,n,o[0],0xd76aa478,7),n=h(n,t,r,i,o[1],0xe8c7b756,12),i=h(i,n,t,r,o[2],0x242070db,17),r=h(r,i,n,t,o[3],0xc1bdceee,22),t=h(t,r,i,n,o[4],0xf57c0faf,7),n=h(n,t,r,i,o[5],0x4787c62a,12),i=h(i,n,t,r,o[6],0xa8304613,17),r=h(r,i,n,t,o[7],0xfd469501,22),t=h(t,r,i,n,o[8],0x698098d8,7),n=h(n,t,r,i,o[9],0x8b44f7af,12),i=h(i,n,t,r,o[10],0xffff5bb1,17),r=h(r,i,n,t,o[11],0x895cd7be,22),t=h(t,r,i,n,o[12],0x6b901122,7),n=h(n,t,r,i,o[13],0xfd987193,12),i=h(i,n,t,r,o[14],0xa679438e,17),t=u(t,r=h(r,i,n,t,o[15],0x49b40821,22),i,n,o[1],0xf61e2562,5),n=u(n,t,r,i,o[6],0xc040b340,9),i=u(i,n,t,r,o[11],0x265e5a51,14),r=u(r,i,n,t,o[0],0xe9b6c7aa,20),t=u(t,r,i,n,o[5],0xd62f105d,5),n=u(n,t,r,i,o[10],0x2441453,9),i=u(i,n,t,r,o[15],0xd8a1e681,14),r=u(r,i,n,t,o[4],0xe7d3fbc8,20),t=u(t,r,i,n,o[9],0x21e1cde6,5),n=u(n,t,r,i,o[14],0xc33707d6,9),i=u(i,n,t,r,o[3],0xf4d50d87,14),r=u(r,i,n,t,o[8],0x455a14ed,20),t=u(t,r,i,n,o[13],0xa9e3e905,5),n=u(n,t,r,i,o[2],0xfcefa3f8,9),i=u(i,n,t,r,o[7],0x676f02d9,14),t=c(t,r=u(r,i,n,t,o[12],0x8d2a4c8a,20),i,n,o[5],0xfffa3942,4),n=c(n,t,r,i,o[8],0x8771f681,11),i=c(i,n,t,r,o[11],0x6d9d6122,16),r=c(r,i,n,t,o[14],0xfde5380c,23),t=c(t,r,i,n,o[1],0xa4beea44,4),n=c(n,t,r,i,o[4],0x4bdecfa9,11),i=c(i,n,t,r,o[7],0xf6bb4b60,16),r=c(r,i,n,t,o[10],0xbebfbc70,23),t=c(t,r,i,n,o[13],0x289b7ec6,4),n=c(n,t,r,i,o[0],0xeaa127fa,11),i=c(i,n,t,r,o[3],0xd4ef3085,16),r=c(r,i,n,t,o[6],0x4881d05,23),t=c(t,r,i,n,o[9],0xd9d4d039,4),n=c(n,t,r,i,o[12],0xe6db99e5,11),i=c(i,n,t,r,o[15],0x1fa27cf8,16),t=d(t,r=c(r,i,n,t,o[2],0xc4ac5665,23),i,n,o[0],0xf4292244,6),n=d(n,t,r,i,o[7],0x432aff97,10),i=d(i,n,t,r,o[14],0xab9423a7,15),r=d(r,i,n,t,o[5],0xfc93a039,21),t=d(t,r,i,n,o[12],0x655b59c3,6),n=d(n,t,r,i,o[3],0x8f0ccc92,10),i=d(i,n,t,r,o[10],0xffeff47d,15),r=d(r,i,n,t,o[1],0x85845dd1,21),t=d(t,r,i,n,o[8],0x6fa87e4f,6),n=d(n,t,r,i,o[15],0xfe2ce6e0,10),i=d(i,n,t,r,o[6],0xa3014314,15),r=d(r,i,n,t,o[13],0x4e0811a1,21),t=d(t,r,i,n,o[4],0xf7537e82,6),n=d(n,t,r,i,o[11],0xbd3af235,10),i=d(i,n,t,r,o[2],0x2ad7d2bb,15),r=d(r,i,n,t,o[9],0xeb86d391,21),this._a=this._a+t|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+n|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=s.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},t.exports=a},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("brorand");function s(e){this.rand=e||new n.Rand}t.exports=s,s.create=function(e){return new s(e)},s.prototype._randbelow=function(e){var t=Math.ceil(e.bitLength()/8);do var r=new i(this.rand.generate(t));while(r.cmp(e)>=0);return r},s.prototype._randrange=function(e,t){var r=t.sub(e);return e.add(this._randbelow(r))},s.prototype.test=function(e,t,r){var n=e.bitLength(),s=i.mont(e),o=new i(1).toRed(s);t||(t=Math.max(1,n/48|0));for(var a=e.subn(1),l=0;!a.testn(l);l++);for(var h=e.shrn(l),u=a.toRed(s);t>0;t--){var c=this._randrange(new i(2),a);r&&r(c);var d=c.toRed(s).redPow(h);if(0!==d.cmp(o)&&0!==d.cmp(u)){for(var f=1;f<l;f++){if(0===(d=d.redSqr()).cmp(o))return!1;if(0===d.cmp(u))break}if(f===l)return!1}}return!0},s.prototype.getDivisor=function(e,t){var r=e.bitLength(),n=i.mont(e),s=new i(1).toRed(n);t||(t=Math.max(1,r/48|0));for(var o=e.subn(1),a=0;!o.testn(a);a++);for(var l=e.shrn(a),h=o.toRed(n);t>0;t--){var u=this._randrange(new i(2),o),c=e.gcd(u);if(0!==c.cmpn(1))return c;var d=u.toRed(n).redPow(l);if(0!==d.cmp(s)&&0!==d.cmp(h)){for(var f=1;f<a;f++){if(0===(d=d.redSqr()).cmp(s))return d.fromRed().subn(1).gcd(e);if(0===d.cmp(h))break}if(f===a)return(d=d.redSqr()).fromRed().subn(1).gcd(e)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],453:[function(e,t,r){"use strict";function i(e,t){if(!e)throw Error(t||"Assertion failed")}t.exports=i,i.equal=function(e,t,r){if(e!=t)throw Error(r||"Assertion failed: "+e+" != "+t)}},{}],454:[function(e,t,r){"use strict";function i(e){return 1===e.length?"0"+e:e}function n(e){for(var t="",r=0;r<e.length;r++)t+=i(e[r].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var i=0;i<e.length;i++)r[i]=0|e[i];return r}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16));else for(i=0;i<e.length;i++){var n=e.charCodeAt(i),s=n>>8,o=255&n;s?r.push(s,o):r.push(o)}return r},r.zero2=i,r.toHex=n,r.encode=function(e,t){return"hex"===t?n(e):e}},{}],455:[function(e,t,r){t.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,t,r){"use strict";var i=e("asn1.js");r.certificate=e("./certificate");var n=i.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});r.RSAPrivateKey=n;var s=i.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});r.RSAPublicKey=s;var o=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())});r.PublicKey=o;var a=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),l=i.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(a),this.key("subjectPrivateKey").octstr())});r.PrivateKey=l;var h=i.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});r.EncryptedPrivateKey=h;var u=i.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});r.DSAPrivateKey=u,r.DSAparam=i.define("DSAparam",function(){this.int()});var c=i.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(d),this.key("publicKey").optional().explicit(1).bitstr())});r.ECPrivateKey=c;var d=i.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});r.signature=i.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(e,t,r){"use strict";var i=e("asn1.js"),n=i.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),s=i.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),o=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),a=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())}),l=i.define("RelativeDistinguishedName",function(){this.setof(s)}),h=i.define("RDNSequence",function(){this.seqof(l)}),u=i.define("Name",function(){this.choice({rdnSequence:this.use(h)})}),c=i.define("Validity",function(){this.seq().obj(this.key("notBefore").use(n),this.key("notAfter").use(n))}),d=i.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),f=i.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(o),this.key("issuer").use(u),this.key("validity").use(c),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(a),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(d).optional())}),p=i.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(o),this.key("signatureValue").bitstr())});t.exports=p},{"asn1.js":170}],458:[function(e,t,r){"use strict";var i=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,n=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,o=e("evp_bytestokey"),a=e("browserify-aes"),l=e("safe-buffer").Buffer;t.exports=function(e,t){var r,h=e.toString(),u=h.match(i);if(u){var c="aes"+u[1],d=l.from(u[2],"hex"),f=l.from(u[3].replace(/[\r\n]/g,""),"base64"),p=o(t,d.slice(0,8),parseInt(u[1],10)).key,g=[],m=a.createDecipheriv(c,p,d);g.push(m.update(f)),g.push(m.final()),r=l.concat(g)}else{var v=h.match(s);r=l.from(v[2].replace(/[\r\n]/g,""),"base64")}return{tag:h.match(n)[1],data:r}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,t,r){"use strict";var i=e("./asn1"),n=e("./aesid.json"),s=e("./fixProc"),o=e("browserify-aes"),a=e("pbkdf2"),l=e("safe-buffer").Buffer;function h(e){"object"!=typeof e||l.isBuffer(e)||(b=e.passphrase,e=e.key),"string"==typeof e&&(e=l.from(e));var t,r,h,u,c,d,f,p,g,m,v,b,y,x,_=s(e,b),S=_.tag,w=_.data;switch(S){case"CERTIFICATE":x=i.certificate.decode(w,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(x||(x=i.PublicKey.decode(w,"der")),y=x.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(x.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return x.subjectPrivateKey=x.subjectPublicKey,{type:"ec",data:x};case"1.2.840.10040.4.1":return x.algorithm.params.pub_key=i.DSAparam.decode(x.subjectPublicKey.data,"der"),{type:"dsa",data:x.algorithm.params};default:throw Error("unknown key id "+y)}case"ENCRYPTED PRIVATE KEY":;t=w=i.EncryptedPrivateKey.decode(w,"der"),r=b,h=t.algorithm.decrypt.kde.kdeparams.salt,u=parseInt(t.algorithm.decrypt.kde.kdeparams.iters.toString(),10),c=n[t.algorithm.decrypt.cipher.algo.join(".")],d=t.algorithm.decrypt.cipher.iv,f=t.subjectPrivateKey,p=parseInt(c.split("-")[1],10)/8,g=a.pbkdf2Sync(r,h,u,p,"sha1"),m=o.createDecipheriv(c,g,d),(v=[]).push(m.update(f)),v.push(m.final()),w=l.concat(v);case"PRIVATE KEY":switch(y=(x=i.PrivateKey.decode(w,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(x.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:x.algorithm.curve,privateKey:i.ECPrivateKey.decode(x.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return x.algorithm.params.priv_key=i.DSAparam.decode(x.subjectPrivateKey,"der"),{type:"dsa",params:x.algorithm.params};default:throw Error("unknown key id "+y)}case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(w,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(w,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(w,"der")};case"EC PRIVATE KEY":return{curve:(w=i.ECPrivateKey.decode(w,"der")).parameters.value,privateKey:w.privateKey};default:throw Error("unknown key type "+S)}}t.exports=h,h.signature=i.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,t,r){"use strict";r.pbkdf2=e("./lib/async"),r.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,t,i){(function(r){(function(){"use strict";var i,n,s=e("safe-buffer").Buffer,o=e("./precondition"),a=e("./default-encoding"),l=e("./sync"),h=e("./to-buffer"),u=r.crypto&&r.crypto.subtle,c={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function f(){return n||(n=r.process&&r.process.nextTick?r.process.nextTick:r.queueMicrotask?r.queueMicrotask:r.setImmediate?r.setImmediate:r.setTimeout)}function p(e,t,r,i,n){return u.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then(function(e){return u.deriveBits({name:"PBKDF2",salt:t,iterations:r,hash:{name:n}},e,i<<3)}).then(function(e){return s.from(e)})}t.exports=function(e,t,n,g,m,v){"function"==typeof m&&(v=m,m=void 0);var b=c[(m=m||"sha1").toLowerCase()];if(b&&"function"==typeof r.Promise){if(o(n,g),e=h(e,a,"Password"),t=h(t,a,"Salt"),"function"!=typeof v)throw Error("No callback provided to pbkdf2");!function(e,t){e.then(function(e){f()(function(){t(null,e)})},function(e){f()(function(){t(e)})})}((function(e){if(r.process&&!r.process.browser||!u||!u.importKey||!u.deriveBits)return Promise.resolve(!1);if(void 0!==d[e])return d[e];var t=p(i=i||s.alloc(8),i,10,128,e).then(function(){return!0}).catch(function(){return!1});return d[e]=t,t})(b).then(function(r){return r?p(e,t,n,g,b):l(e,t,n,g,m)}),v)}else f()(function(){var r;try{r=l(e,t,n,g,m)}catch(e){return v(e)}v(null,r)})}}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,t,i){(function(e,r){(function(){"use strict";var i;i=r.process&&r.process.browser?"utf-8":r.process&&r.process.version?parseInt(e.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",t.exports=i}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:467}],463:[function(e,t,r){"use strict";var i=0x3fffffff;t.exports=function(e,t){if("number"!=typeof e)throw TypeError("Iterations not a number");if(e<0)throw TypeError("Bad iterations");if("number"!=typeof t)throw TypeError("Key length not a number");if(t<0||t>i||t!=t)throw TypeError("Bad key length")}},{}],464:[function(e,t,r){"use strict";var i=e("create-hash/md5"),n=e("ripemd160"),s=e("sha.js"),o=e("safe-buffer").Buffer,a=e("./precondition"),l=e("./default-encoding"),h=e("./to-buffer"),u=o.alloc(128),c={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function d(e,t,r){var a,l="rmd160"===(a=e)||"ripemd160"===a?function(e){return(new n).update(e).digest()}:"md5"===a?i:function(e){return s(a).update(e).digest()},h="sha512"===e||"sha384"===e?128:64;t.length>h?t=l(t):t.length<h&&(t=o.concat([t,u],h));for(var d=o.allocUnsafe(h+c[e]),f=o.allocUnsafe(h+c[e]),p=0;p<h;p++)d[p]=54^t[p],f[p]=92^t[p];var g=o.allocUnsafe(h+r+4);d.copy(g,0,0,h),this.ipad1=g,this.ipad2=d,this.opad=f,this.alg=e,this.blocksize=h,this.hash=l,this.size=c[e]}d.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},t.exports=function(e,t,r,i,n){a(r,i);var s=new d(n=n||"sha1",e=h(e,l,"Password"),(t=h(t,l,"Salt")).length),u=o.allocUnsafe(i),f=o.allocUnsafe(t.length+4);t.copy(f,0,0,t.length);for(var p=0,g=c[n],m=Math.ceil(i/g),v=1;v<=m;v++){f.writeUInt32BE(v,t.length);for(var b=s.run(f,s.ipad1),y=b,x=1;x<r;x++){y=s.run(y,s.ipad2);for(var _=0;_<g;_++)b[_]^=y[_]}b.copy(u,p),p+=g}return u}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer;t.exports=function(e,t,r){if(i.isBuffer(e))return e;if("string"==typeof e)return i.from(e,t);if(ArrayBuffer.isView(e))return i.from(e.buffer);throw TypeError(r+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,t,r){(function(e){(function(){"use strict";void 0!==e&&e.version&&0!==e.version.indexOf("v0.")&&(0!==e.version.indexOf("v1.")||0===e.version.indexOf("v1.8."))?t.exports=e:t.exports={nextTick:function(t,r,i,n){if("function"!=typeof t)throw TypeError('"callback" argument must be a function');var s,o,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,r)});case 3:return e.nextTick(function(){t.call(null,r,i)});case 4:return e.nextTick(function(){t.call(null,r,i,n)});default:for(s=Array(a-1),o=0;o<s.length;)s[o++]=arguments[o];return e.nextTick(function(){t.apply(null,s)})}}}}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,t,r){"use strict";var i,n,s=t.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function l(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(e){i=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var h,u=[],c=!1,d=-1;function f(){c&&h&&(c=!1,h.length?u=h.concat(u):d=-1,u.length&&p())}function p(){if(!c){var e=l(f);c=!0;for(var t=u.length;t;){for(h=u,u=[];++d<t;)h&&h[d].run();d=-1,t=u.length}h=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new g(e,t)),1!==u.length||c||l(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],468:[function(e,t,r){"use strict";r.publicEncrypt=e("./publicEncrypt"),r.privateDecrypt=e("./privateDecrypt"),r.privateEncrypt=function(e,t){return r.publicEncrypt(e,t,!0)},r.publicDecrypt=function(e,t){return r.privateDecrypt(e,t,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,t,r){"use strict";var i=e("create-hash"),n=e("safe-buffer").Buffer;t.exports=function(e,t){for(var r,s=n.alloc(0),o=0;s.length<t;)r=function(e){var t=n.allocUnsafe(4);return t.writeUInt32BE(e,0),t}(o++),s=n.concat([s,i("sha1").update(e).update(r).digest()]);return s.slice(0,t)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,t,r){arguments[4][184][0].apply(r,arguments)},{buffer:188,dup:184}],471:[function(e,t,r){"use strict";var i=e("parse-asn1"),n=e("./mgf"),s=e("./xor"),o=e("bn.js"),a=e("browserify-rsa"),l=e("create-hash"),h=e("./withPublic"),u=e("safe-buffer").Buffer;t.exports=function(e,t,r){c=e.padding?e.padding:r?1:4;var c,d,f=i(e),p=f.modulus.byteLength();if(t.length>p||new o(t).cmp(f.modulus)>=0)throw Error("decryption error");d=r?h(new o(t),f):a(t,f);var g=u.alloc(p-d.length);if(d=u.concat([g,d],p),4===c)return function(e,t){var r=e.modulus.byteLength(),i=l("sha1").update(u.alloc(0)).digest(),o=i.length;if(0!==t[0])throw Error("decryption error");var a=t.slice(1,o+1),h=t.slice(o+1),c=s(a,n(h,o)),d=s(h,n(c,r-o-1));if(function(e,t){e=u.from(e),t=u.from(t);var r=0,i=e.length;e.length!==t.length&&(r++,i=Math.min(e.length,t.length));for(var n=-1;++n<i;)r+=e[n]^t[n];return r}(i,d.slice(0,o)))throw Error("decryption error");for(var f=o;0===d[f];)f++;if(1!==d[f++])throw Error("decryption error");return d.slice(f)}(f,d);if(1===c)return function(e,t,r){for(var i=t.slice(0,2),n=2,s=0;0!==t[n++];)if(n>=t.length){s++;break}var o=t.slice(2,n-1);if(("0002"!==i.toString("hex")&&!r||"0001"!==i.toString("hex")&&r)&&s++,o.length<8&&s++,s)throw Error("decryption error");return t.slice(n)}(0,d,r);if(3===c)return d;throw Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,t,r){"use strict";var i=e("parse-asn1"),n=e("randombytes"),s=e("create-hash"),o=e("./mgf"),a=e("./xor"),l=e("bn.js"),h=e("./withPublic"),u=e("browserify-rsa"),c=e("safe-buffer").Buffer;t.exports=function(e,t,r){d=e.padding?e.padding:r?1:4;var d,f,p=i(e);if(4===d)f=function(e,t){var r=e.modulus.byteLength(),i=t.length,h=s("sha1").update(c.alloc(0)).digest(),u=h.length,d=2*u;if(i>r-d-2)throw Error("message too long");var f=c.alloc(r-i-d-2),p=r-u-1,g=n(u),m=a(c.concat([h,f,c.alloc(1,1),t],p),o(g,p)),v=a(g,o(m,u));return new l(c.concat([c.alloc(1),v,m],r))}(p,t);else if(1===d)f=function(e,t,r){var i,s=t.length,o=e.modulus.byteLength();if(s>o-11)throw Error("message too long");return i=r?c.alloc(o-s-3,255):function(e){for(var t,r=c.allocUnsafe(e),i=0,s=n(2*e),o=0;i<e;)o===s.length&&(s=n(2*e),o=0),(t=s[o++])&&(r[i++]=t);return r}(o-s-3),new l(c.concat([c.from([0,r?1:2]),i,c.alloc(1),t],o))}(p,t,r);else{if(3!==d)throw Error("unknown padding");if((f=new l(t)).cmp(p.modulus)>=0)throw Error("data too long for modulus")}return r?u(f,p):h(f,p)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,t,r){"use strict";var i=e("bn.js"),n=e("safe-buffer").Buffer;t.exports=function(e,t){return n.from(e.toRed(i.mont(t.modulus)).redPow(new i(t.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,t,r){"use strict";t.exports=function(e,t){for(var r=e.length,i=-1;++i<r;)e[i]^=t[i];return e}},{}],475:[function(e,t,i){(function(r,i){(function(){"use strict";var n=e("safe-buffer").Buffer,s=i.crypto||i.msCrypto;s&&s.getRandomValues?t.exports=function(e,t){if(e>0xffffffff)throw RangeError("requested too many random bytes");var i=n.allocUnsafe(e);if(e>0){if(e>65536)for(var o=0;o<e;o+=65536)s.getRandomValues(i.slice(o,o+65536));else s.getRandomValues(i)}return"function"==typeof t?r.nextTick(function(){t(null,i)}):i}:t.exports=function(){throw Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,t,i){(function(t,r){(function(){"use strict";function n(){throw Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var s=e("safe-buffer"),o=e("randombytes"),a=s.Buffer,l=s.kMaxLength,h=r.crypto||r.msCrypto,u=0xffffffff;function c(e,t){if("number"!=typeof e||e!=e)throw TypeError("offset must be a number");if(e>u||e<0)throw TypeError("offset must be a uint32");if(e>l||e>t)throw RangeError("offset out of range")}function d(e,t,r){if("number"!=typeof e||e!=e)throw TypeError("size must be a number");if(e>u||e<0)throw TypeError("size must be a uint32");if(e+t>r||e>l)throw RangeError("buffer too small")}function f(e,r,i,n){if(t.browser){var s=new Uint8Array(e.buffer,r,i);return h.getRandomValues(s),n?void t.nextTick(function(){n(null,e)}):e}if(!n)return o(i).copy(e,r),e;o(i,function(t,i){if(t)return n(t);i.copy(e,r),n(null,e)})}h&&h.getRandomValues||!t.browser?(i.randomFill=function(e,t,i,n){if(!(a.isBuffer(e)||e instanceof r.Uint8Array))throw TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof t)n=t,t=0,i=e.length;else if("function"==typeof i)n=i,i=e.length-t;else if("function"!=typeof n)throw TypeError('"cb" argument must be a function');return c(t,e.length),d(i,t,e.length),f(e,t,i,n)},i.randomFillSync=function(e,t,i){if(void 0===t&&(t=0),!(a.isBuffer(e)||e instanceof r.Uint8Array))throw TypeError('"buf" argument must be a Buffer or Uint8Array');return c(t,e.length),void 0===i&&(i=e.length-t),d(i,t,e.length),f(e,t,i)}):(i.randomFill=n,i.randomFillSync=n)}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,t,r){"use strict";var i={};function n(e,t,r){r||(r=Error);var n=function(e){function r(r,i,n){var s,o,a;return e.call(this,(s=r,o=i,a=n,"string"==typeof t?t:t(s,o,a)))||this}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e,r}(r);n.prototype.name=r.name,n.prototype.code=e,i[e]=n}function s(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map(function(e){return String(e)}),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),n("ERR_INVALID_ARG_TYPE",function(e,t,r){if("string"==typeof t&&(n="not ",t.substr(!o||o<0?0:+o,n.length)===n)?(i="must not be",t=t.replace(/^not /,"")):i="must be",l=e,h=" argument",(void 0===u||u>l.length)&&(u=l.length),l.substring(u-h.length,u)===h)a="The ".concat(e," ").concat(i," ").concat(s(t,"type"));else{var i,n,o,a,l,h,u,c,d,f,p=(c=e,d=".","number"!=typeof f&&(f=0),f+1>c.length||-1===c.indexOf(d,f))?"argument":"property";a='The "'.concat(e,'" ').concat(p," ").concat(i," ").concat(s(t,"type"))}return a+". Received type ".concat(typeof r)},TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=i},{}],478:[function(e,t,r){(function(r){(function(){"use strict";var i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=h;var n=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(h,n);for(var o=i(s.prototype),a=0;a<o.length;a++){var l=o[a];h.prototype[l]||(h.prototype[l]=s.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);n.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||r.nextTick(c,this)}function c(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,t,r){"use strict";t.exports=n;var i=e("./_stream_transform");function n(e){if(!(this instanceof n))return new n(e);i.call(this,e)}e("inherits")(n,i),n.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":481,inherits:440}],480:[function(e,t,i){(function(r,i){(function(){"use strict";t.exports=P,P.ReadableState=T,e("events").EventEmitter;var n=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),o=e("buffer").Buffer,a=(void 0!==i?i:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},l,h,u=e("util");h=u&&u.debuglog?u.debuglog("stream"):function(){};var c,d,f,p=e("./internal/streams/buffer_list"),g=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,v=e("../errors").codes,b=v.ERR_INVALID_ARG_TYPE,y=v.ERR_STREAM_PUSH_AFTER_EOF,x=v.ERR_METHOD_NOT_IMPLEMENTED,_=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(P,s);var S=g.errorOrDestroy,w=["error","close","destroy","pause","resume"];function T(t,r,i){l=l||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=r instanceof l),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(c||(c=e("string_decoder/").StringDecoder),this.decoder=new c(t.encoding),this.encoding=t.encoding)}function P(t){if(l=l||e("./_stream_duplex"),!(this instanceof P))return new P(t);var r=this instanceof l;this._readableState=new T(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function E(e,t,r,i,n){h("readableAddChunk",t);var s,l,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(h("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?I(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}}(e,u);else if(n||(l=function(e,t){var r;return o.isBuffer(t)||t instanceof a||"string"==typeof t||void 0===t||e.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],t)),r}(u,t)),l)S(e,l);else if(u.objectMode||t&&t.length>0){;if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===o.prototype||(s=t,t=o.from(s)),i)u.endEmitted?S(e,new _):C(e,u,t,!0);else if(u.ended)S(e,new y);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!r?(t=u.decoder.write(t),u.objectMode||0!==t.length?C(e,u,t,!1):R(e,u)):C(e,u,t,!1)}}else i||(u.reading=!1,R(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function C(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&I(e)),R(e,t)}function A(e,t){var r;return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=((r=e)>=0x40000000?r=0x40000000:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function I(e){var t=e._readableState;h("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(M,e))}function M(e){var t=e._readableState;h("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function R(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(h("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function k(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function N(e){h("readable nexttick read 0"),e.read(0)}function L(e,t){h("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){var r;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r)}function F(e){var t=e._readableState;h("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(V,t,e))}function V(e,t){if(h("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function G(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1}Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),P.prototype.destroy=g.destroy,P.prototype._undestroy=g.undestroy,P.prototype._destroy=function(e,t){t(e)},P.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=o.from(e,t),t=""),r=!0),E(this,e,t,!1,r)},P.prototype.unshift=function(e){return E(this,e,null,!0,!1)},P.prototype.isPaused=function(){return!1===this._readableState.flowing},P.prototype.setEncoding=function(t){c||(c=e("string_decoder/").StringDecoder);var r=new c(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,n="";null!==i;)n+=r.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this},P.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):I(this),null;if(0===(e=A(e,t))&&t.ended)return 0===t.length&&F(this),null;var i,n=t.needReadable;return h("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",n=!0),t.ended||t.reading?h("reading or ended",n=!1):n&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=A(r,t))),null===(i=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==i&&this.emit("data",i),i},P.prototype._read=function(e){S(this,new x("_read()"))},P.prototype.pipe=function(e,t){var i,s=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,h("pipe count=%d opts=%j",o.pipesCount,t);var a=t&&!1===t.end||e===r.stdout||e===r.stderr?m:l;function l(){h("onend"),e.end()}o.endEmitted?r.nextTick(a):s.once("end",a),e.on("unpipe",function t(r,i){h("onunpipe"),r===s&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,h("cleanup"),e.removeListener("close",p),e.removeListener("finish",g),e.removeListener("drain",u),e.removeListener("error",f),e.removeListener("unpipe",t),s.removeListener("end",l),s.removeListener("end",m),s.removeListener("data",d),c=!0,o.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&u())});var u=(i=s,function(){var e=i._readableState;h("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&n(i,"data")&&(e.flowing=!0,D(i))});e.on("drain",u);var c=!1;function d(t){h("ondata");var r=e.write(t);h("dest.write",r),!1===r&&((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==G(o.pipes,e))&&!c&&(h("false write response, pause",o.awaitDrain),o.awaitDrain++),s.pause())}function f(t){h("onerror",t),m(),e.removeListener("error",f),0===n(e,"error")&&S(e,t)}function p(){e.removeListener("finish",g),m()}function g(){h("onfinish"),e.removeListener("close",p),m()}function m(){h("unpipe"),s.unpipe(e)}return s.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",f),e.once("close",p),e.once("finish",g),e.emit("pipe",s),o.flowing||(h("pipe resume"),s.resume()),e},P.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=G(t.pipes,e);return -1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},P.prototype.on=function(e,t){var i=s.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,h("on readable",n.length,n.reading),n.length?I(this):n.reading||r.nextTick(N,this))),i},P.prototype.addListener=P.prototype.on,P.prototype.removeListener=function(e,t){var i=s.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(k,this),i},P.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(k,this),t},P.prototype.resume=function(){var e,t,i=this._readableState;return i.flowing||(h("resume"),i.flowing=!i.readableListening,e=this,(t=i).resumeScheduled||(t.resumeScheduled=!0,r.nextTick(L,e,t))),i.paused=!1,this},P.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},P.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",function(){if(h("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(n){h("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n||(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))}),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var s=0;s<w.length;s++)e.on(w[s],this.emit.bind(this,w[s]));return this._read=function(t){h("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(P.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(P.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(P.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),P._fromList=B,Object.defineProperty(P.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(P.from=function(t,r){return void 0===f&&(f=e("./internal/streams/from")),f(P,t,r)})}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,t,r){"use strict";t.exports=u;var i=e("../errors").codes,n=i.ERR_METHOD_NOT_IMPLEMENTED,s=i.ERR_MULTIPLE_CALLBACK,o=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=i.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");function h(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(null===i)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:h.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",c)}function c(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(t,r){d(e,t,r)})}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new n("_transform()"))},u.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,t,i){(function(r,i){(function(){"use strict";function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(void 0),i=i.next}t.corkedRequestsFree.next=e}(t,e)}}t.exports=P,P.WritableState=T;var s={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),a=e("buffer").Buffer,l=(void 0!==i?i:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},h,u,c=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,f=e("../errors").codes,p=f.ERR_INVALID_ARG_TYPE,g=f.ERR_METHOD_NOT_IMPLEMENTED,m=f.ERR_MULTIPLE_CALLBACK,v=f.ERR_STREAM_CANNOT_PIPE,b=f.ERR_STREAM_DESTROYED,y=f.ERR_STREAM_NULL_VALUES,x=f.ERR_STREAM_WRITE_AFTER_END,_=f.ERR_UNKNOWN_ENCODING,S=c.errorOrDestroy;function w(){}function T(t,i,s){h=h||e("./_stream_duplex"),t=t||{},"boolean"!=typeof s&&(s=i instanceof h),this.objectMode=!!t.objectMode,s&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i,n,s,o,a,l,h=e._writableState,u=h.sync,c=h.writecb;if("function"!=typeof c)throw new m;if((i=h).writing=!1,i.writecb=null,i.length-=i.writelen,i.writelen=0,t){;n=e,s=h,o=u,a=t,l=c,--s.pendingcb,o?(r.nextTick(l,a),r.nextTick(R,n,s),n._writableState.errorEmitted=!0,S(n,a)):(l(a),n._writableState.errorEmitted=!0,S(n,a),R(n,s))}else{var d=I(h)||e.destroyed;d||h.corked||h.bufferProcessing||!h.bufferedRequest||A(e,h),u?r.nextTick(C,e,h,d,c):C(e,h,d,c)}}(i,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function P(t){var r=this instanceof(h=h||e("./_stream_duplex"));if(!r&&!u.call(P,this))return new P(t);this._writableState=new T(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function E(e,t,r,i,n,s,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):r?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function C(e,t,r,i){var n,s;r||(n=e,0===(s=t).length&&s.needDrain&&(s.needDrain=!1,n.emit("drain"))),t.pendingcb--,i(),R(e,t)}function A(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=Array(t.bufferedRequestCount),s=t.corkedRequestsFree;s.entry=r;for(var o=0,a=!0;r;)i[o]=r,r.isBuf||(a=!1),r=r.next,o+=1;i.allBuffers=a,E(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,h=r.encoding,u=r.callback;if(E(e,t,!1,t.objectMode?1:l.length,l,h,u),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function M(e,t){e._final(function(r){t.pendingcb--,r&&S(e,r),t.prefinished=!0,e.emit("prefinish"),R(e,t)})}function R(e,t){var i,n,s=I(t);if(s&&(i=e,(n=t).prefinished||n.finalCalled||("function"!=typeof i._final||n.destroyed?(n.prefinished=!0,i.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,r.nextTick(M,i,n))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var o=e._readableState;(!o||o.autoDestroy&&o.endEmitted)&&e.destroy()}return s}e("inherits")(P,o),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:s.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(P,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===P&&e&&e._writableState instanceof T}})):u=function(e){return e instanceof this},P.prototype.pipe=function(){S(this,new v)},P.prototype.write=function(e,t,i){var n,s,o,h,u,c,d,f,g,m,v=this._writableState,b=!1,_=!v.objectMode&&(m=e,a.isBuffer(m)||m instanceof l);return _&&!a.isBuffer(e)&&(n=e,e=a.from(n)),"function"==typeof t&&(i=t,t=null),_?t="buffer":t||(t=v.defaultEncoding),"function"!=typeof i&&(i=w),v.ending?(s=this,o=i,S(s,h=new x),r.nextTick(o,h)):!_&&(u=this,c=v,d=e,f=i,null===d?g=new y:"string"==typeof d||c.objectMode||(g=new p("chunk",["string","Buffer"],d)),g&&(S(u,g),r.nextTick(f,g),1))||(v.pendingcb++,b=function(e,t,r,i,n,s){if(!r){var o,l,h,u=(o=t,l=i,h=n,o.objectMode||!1===o.decodeStrings||"string"!=typeof l||(l=a.from(l,h)),l);i!==u&&(r=!0,n="buffer",i=u)}var c=t.objectMode?1:i.length;t.length+=c;var d=t.length<t.highWaterMark;if(d||(t.needDrain=!0),t.writing||t.corked){var f=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},f?f.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else E(e,t,!1,c,i,n,s);return d}(this,v,_,e,t,i)),b},P.prototype.cork=function(){this._writableState.corked++},P.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},P.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(P.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(P.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),P.prototype._write=function(e,t,r){r(new g("_write()"))},P.prototype._writev=null,P.prototype.end=function(e,t,i){var n,s,o,a=this._writableState;return"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),a.corked&&(a.corked=1,this.uncork()),a.ending||(n=this,s=a,o=i,s.ending=!0,R(n,s),o&&(s.finished?r.nextTick(o):n.once("finish",o)),s.ended=!0,n.writable=!1),this},Object.defineProperty(P.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),P.prototype.destroy=c.destroy,P.prototype._undestroy=c.undestroy,P.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,t,r){(function(r){(function(){"use strict";function i(e,t,r){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:String(i))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n,s=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),h=Symbol("ended"),u=Symbol("lastPromise"),c=Symbol("handlePromise"),d=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[d].read();null!==r&&(e[u]=null,e[o]=null,e[a]=null,t(f(r,!1)))}}function g(e){r.nextTick(p,e)}var m=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e,t,i=this,n=this[l];if(null!==n)return Promise.reject(n);if(this[h])return Promise.resolve(f(void 0,!0));if(this[d].destroyed)return new Promise(function(e,t){r.nextTick(function(){i[l]?t(i[l]):e(f(void 0,!0))})});var s,o=this[u];if(o){;s=new Promise((e=o,t=this,function(r,i){e.then(function(){t[h]?r(f(void 0,!0)):t[c](r,i)},i)}))}else{var a=this[d].read();if(null!==a)return Promise.resolve(f(a,!1));s=new Promise(this[c])}return this[u]=s,s}},Symbol.asyncIterator,function(){return this}),i(n,"return",function(){var e=this;return new Promise(function(t,r){e[d].destroy(null,function(e){e?r(e):t(f(void 0,!0))})})}),n),m);t.exports=function(e){var t,r=Object.create(v,(i(t={},d,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,h,{value:e._readableState.endEmitted,writable:!0}),i(t,c,{value:function(e,t){var i=r[d].read();i?(r[u]=null,r[o]=null,r[a]=null,e(f(i,!1))):(r[o]=e,r[a]=t)},writable:!0}),t));return r[u]=null,s(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[a];return null!==t&&(r[u]=null,r[o]=null,r[a]=null,t(e)),void(r[l]=e)}var i=r[o];null!==i&&(r[u]=null,r[o]=null,r[a]=null,i(f(void 0,!0))),r[h]=!0}),e.on("readable",g.bind(null,r)),r}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,t,r){"use strict";function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){(function(e,t,r){(t=o(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}function o(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=e("buffer").Buffer,l=e("util").inspect,h=l&&l.custom||"inspect";t.exports=function(){var e,t;function r(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),this.head=null,this.tail=null,this.length=0}return e=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,r,i=a.allocUnsafe(e>>>0),n=this.head,s=0;n;)t=n.data,r=s,a.prototype.copy.call(t,i,r),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,i=t.data;for(e-=i.length;t=t.next;){var n=t.data,s=e>n.length?n.length:e;if(s===n.length?i+=n:i+=n.slice(0,e),0==(e-=s)){s===n.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(s));break}++r}return this.length-=r,i}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),r=this.head,i=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var n=r.data,s=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,s),0==(e-=s)){s===n.length?(++i,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(s));break}++i}return this.length-=i,t}},{key:h,value:function(e,t){return l(this,n(n({},t),{},{depth:0,customInspect:!1}))}}],s(r.prototype,e),t&&s(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}()},{buffer:220,util:188}],485:[function(e,t,r){(function(e){(function(){"use strict";function r(e,t){n(e,t),i(e)}function i(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function n(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(n,this,t)):e.nextTick(n,this,t)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(i,o):(o._writableState.errorEmitted=!0,e.nextTick(r,o,t)):e.nextTick(r,o,t):s?(e.nextTick(i,o),s(t)):e.nextTick(i,o)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,i=e._writableState;r&&r.autoDestroy||i&&i.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,t,r){"use strict";var i=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function n(){}t.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),o=s||n,a=!1,s=function(){if(!a){a=!0;for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.apply(this,t)}};var o,a,l,h=r.readable||!1!==r.readable&&t.readable,u=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||f()},d=t._writableState&&t._writableState.finished,f=function(){u=!1,d=!0,h||s.call(t)},p=t._readableState&&t._readableState.endEmitted,g=function(){h=!1,p=!0,u||s.call(t)},m=function(e){s.call(t,e)},v=function(){var e;return h&&!p?(t._readableState&&t._readableState.ended||(e=new i),s.call(t,e)):u&&!d?(t._writableState&&t._writableState.ended||(e=new i),s.call(t,e)):void 0},b=function(){t.req.on("finish",f)};return(l=t).setHeader&&"function"==typeof l.abort?(t.on("complete",f),t.on("abort",v),t.req?b():t.on("request",b)):u&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",g),t.on("finish",f),!1!==r.error&&t.on("error",m),t.on("close",v),function(){t.removeListener("complete",f),t.removeListener("abort",v),t.removeListener("request",b),t.req&&t.req.removeListener("finish",f),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",f),t.removeListener("end",g),t.removeListener("error",m),t.removeListener("close",v)}}},{"../../../errors":477}],487:[function(e,t,r){"use strict";t.exports=function(){throw Error("Readable.from is not available in the browser")}},{}],488:[function(e,t,r){"use strict";var i,n=e("../../../errors").codes,s=n.ERR_MISSING_ARGS,o=n.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function l(e){e()}function h(e,t){return e.pipe(t)}t.exports=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var u,c,d=(u=r).length?"function"!=typeof u[u.length-1]?a:u.pop():a;if(Array.isArray(r[0])&&(r=r[0]),r.length<2)throw new s("streams");var f=r.map(function(t,n){var s,a,h,u,p,g,m,v,b=n<r.length-1;return s=t,a=b,h=n>0,p=u=function(e){c||(c=e),e&&f.forEach(l),b||(f.forEach(l),d(c))},g=!1,u=function(){g||(g=!0,p.apply(void 0,arguments))},m=!1,s.on("close",function(){m=!0}),void 0===i&&(i=e("./end-of-stream")),i(s,{readable:a,writable:h},function(e){if(e)return u(e);m=!0,u()}),v=!1,function(e){if(!m&&!v){var t;return v=!0,(t=s).setHeader&&"function"==typeof t.abort?s.abort():"function"==typeof s.destroy?s.destroy():void u(e||new o("pipe"))}}});return r.reduce(h)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,t,r){"use strict";var i=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,n){var s,o,a,l=(s=t,o=n,a=r,null!=s.highWaterMark?s.highWaterMark:o?s[a]:null);if(null!=l){if(!isFinite(l)||Math.floor(l)!==l||l<0)throw new i(n?r:"highWaterMark",l);return Math.floor(l)}return e.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,t,r){"use strict";t.exports=e("events").EventEmitter},{events:422}],491:[function(e,t,r){"use strict";(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,t,r){"use strict";var i=function(e){var t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var s=Object.create((t&&t.prototype instanceof d?t:d).prototype);return i(s,"_invoke",{value:function(e,t,r){var i="suspendedStart";return function(n,s){if("executing"===i)throw Error("Generator is already running");if("completed"===i){if("throw"===n)throw s;return P()}for(r.method=n,r.arg=s;;){var o=r.delegate;if(o){var a=function e(t,r){var i=r.method,n=t.iterator[i];if(void 0===n)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+i+"' method")),c;var s=u(n,t.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,c;var o=s.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,c):o:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,c)}(o,r);if(a){if(a===c)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var l=u(e,t,r);if("normal"===l.type){if(i=r.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i="completed",r.method="throw",r.arg=l.arg)}}}(e,r,new w(n||[]))}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var c={};function d(){}function f(){}function p(){}var g={};l(g,s,function(){return this});var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==t&&r.call(v,s)&&(g=v);var b=p.prototype=d.prototype=Object.create(g);function y(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function x(e,t){var n;i(this,"_invoke",{value:function(i,s){function o(){return new t(function(n,o){!function i(n,s,o,a){var l=u(e[n],e,s);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==typeof c&&r.call(c,"__await")?t.resolve(c.__await).then(function(e){i("next",e,o,a)},function(e){i("throw",e,o,a)}):t.resolve(c).then(function(e){h.value=e,o(h)},function(e){return i("throw",e,o,a)})}a(l.arg)}(i,s,n,o)})}return n=n?n.then(o,o):o()}})}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return f.prototype=p,i(b,"constructor",{value:p,configurable:!0}),i(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,a,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(x.prototype),l(x.prototype,o,function(){return this}),e.AsyncIterator=x,e.async=function(t,r,i,n,s){void 0===s&&(s=Promise);var o=new x(h(t,r,i,n),s);return e.isGeneratorFunction(r)?o:o.next().then(function(e){return e.done?e.value:o.next()})},y(b),l(b,a,"Generator"),l(b,s,function(){return this}),l(b,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=T,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return o.type="throw",o.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,c):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;S(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},e}("object"==typeof t?t.exports:{});try{regeneratorRuntime=i}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},{}],493:[function(e,t,r){"use strict";var i=e("buffer").Buffer,n=e("inherits"),s=e("hash-base"),o=Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],c=[0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e],d=[0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0];function f(){s.call(this,64),this._a=0x67452301,this._b=0xefcdab89,this._c=0x98badcfe,this._d=0x10325476,this._e=0xc3d2e1f0}function p(e,t){return e<<t|e>>>32-t}function g(e,t,r,i,n,s,o,a){return p(e+(t^r^i)+s+o|0,a)+n|0}function m(e,t,r,i,n,s,o,a){return p(e+(t&r|~t&i)+s+o|0,a)+n|0}function v(e,t,r,i,n,s,o,a){return p(e+((t|~r)^i)+s+o|0,a)+n|0}function b(e,t,r,i,n,s,o,a){return p(e+(t&i|r&~i)+s+o|0,a)+n|0}function y(e,t,r,i,n,s,o,a){return p(e+(t^(r|~i))+s+o|0,a)+n|0}n(f,s),f.prototype._update=function(){for(var e,t,r,i,n,s,c,d,f,g,m,v,b,y,x,_,S,w,T,P,E,C,A,I,M,R,O,k,N,L,D,B,F,V,G,U,z,j,H,W,q,X,$,Y,Z,K,J,Q,ee,et,er,ei,en=0;en<16;++en)o[en]=this._block.readInt32LE(4*en);for(var es=0|this._a,eo=0|this._b,ea=0|this._c,el=0|this._d,eh=0|this._e,eu=0|this._a,ec=0|this._b,ed=0|this._c,ef=0|this._d,ep=0|this._e,eg=0;eg<80;eg+=1){;eg<16?(e=es,t=eo,r=ea,i=el,n=eh,er=p(e+(t^r^i)+o[a[eg]]+0|0,h[eg])+n|0,s=eu,c=ec,d=ed,f=ef,g=ep,ei=p(s+(c^(d|~f))+o[l[eg]]+0x50a28be6|0,u[eg])+g|0):eg<32?(m=es,v=eo,b=ea,y=el,x=eh,er=p(m+(v&b|~v&y)+o[a[eg]]+0x5a827999|0,h[eg])+x|0,_=eu,S=ec,w=ed,T=ef,P=ep,ei=p(_+(S&T|w&~T)+o[l[eg]]+0x5c4dd124|0,u[eg])+P|0):eg<48?(E=es,C=eo,A=ea,I=el,M=eh,er=p(E+((C|~A)^I)+o[a[eg]]+0x6ed9eba1|0,h[eg])+M|0,R=eu,O=ec,k=ed,N=ef,L=ep,ei=p(R+((O|~k)^N)+o[l[eg]]+0x6d703ef3|0,u[eg])+L|0):eg<64?(D=es,B=eo,F=ea,V=el,G=eh,er=p(D+(B&V|F&~V)+o[a[eg]]+0x8f1bbcdc|0,h[eg])+G|0,U=eu,z=ec,j=ed,H=ef,W=ep,ei=p(U+(z&j|~z&H)+o[l[eg]]+0x7a6d76e9|0,u[eg])+W|0):(q=es,X=eo,$=ea,Y=el,Z=eh,er=p(q+(X^($|~Y))+o[a[eg]]+0xa953fd4e|0,h[eg])+Z|0,K=eu,J=ec,Q=ed,ee=ef,et=ep,ei=p(K+(J^Q^ee)+o[l[eg]]+0|0,u[eg])+et|0),es=eh,eh=el,el=p(ea,10),ea=eo,eo=er,eu=ep,ep=ef,ef=p(ed,10),ed=ec,ec=ei}var em=this._b+ea+ef|0;this._b=this._c+el+ep|0,this._c=this._d+eh+eu|0,this._d=this._e+es+ec|0,this._e=this._a+eo+ed|0,this._a=em},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=i.alloc?i.alloc(20):new i(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},t.exports=f},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,t,r){"use strict";var i=e("buffer"),n=i.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=i:(s(i,r),r.Buffer=o),o.prototype=Object.create(n.prototype),s(n,o),o.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:220}],495:[function(e,t,r){(function(r){(function(){"use strict";var i,n=e("buffer"),s=n.Buffer,o={};for(i in n)n.hasOwnProperty(i)&&"SlowBuffer"!==i&&"Buffer"!==i&&(o[i]=n[i]);var a=o.Buffer={};for(i in s)s.hasOwnProperty(i)&&"allocUnsafe"!==i&&"allocUnsafeSlow"!==i&&(a[i]=s[i]);if(o.Buffer.prototype=s.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,r){if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return s(e,t,r)}),a.alloc||(a.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*0x40000000)throw RangeError('The value "'+e+'" is invalid for option "size"');var i=s(e);return t&&0!==t.length?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i}),!o.kStringMaxLength)try{o.kStringMaxLength=r.binding("buffer").kStringMaxLength}catch(e){}o.constants||(o.constants={MAX_LENGTH:o.kMaxLength},o.kStringMaxLength&&(o.constants.MAX_STRING_LENGTH=o.kStringMaxLength)),t.exports=o}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});let i=e("xmlchars/xml/1.0/ed5"),n=e("xmlchars/xml/1.1/ed2"),s=e("xmlchars/xmlns/1.0/ed3");var o=i.isS,a=i.isChar,l=i.isNameStartChar,h=i.isNameChar,u=i.S_LIST,c=i.NAME_RE,d=n.isChar,f=s.isNCNameStartChar,p=s.isNCNameChar,g=s.NC_NAME_RE;let m="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",b={__proto__:null,xml:m,xmlns:v},y={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},x=e=>34===e||39===e,_=[34,39],S=[..._,91,62],w=[..._,60,93],T=[61,63,...u],P=[...u,62,38,60];function E(e,t,r){switch(t){case"xml":r!==m&&e.fail(`xml prefix must be bound to ${m}.`);break;case"xmlns":r!==v&&e.fail(`xmlns prefix must be bound to ${v}.`)}switch(r){case v:e.fail(""===t?`the default namespace may not be set to ${r}.`:`may not assign a prefix (even "xmlns") to the URI ${v}.`);break;case m:switch(t){case"xml":break;case"":e.fail(`the default namespace may not be set to ${r}.`);break;default:e.fail("may not assign the xml namespace to another prefix.")}}}let C=e=>g.test(e),A=e=>c.test(e);r.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];let I={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};r.SaxesParser=class{constructor(e){this.opt=null!=e?e:{},this.fragmentOpt=!!this.opt.fragment;let t=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=!1!==this.opt.position,this.fileName=this.opt.fileName,t){this.nameStartCheck=f,this.nameCheck=p,this.isName=C,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},b);let e=this.opt.additionalNamespaces;null!=e&&(!function(e,t){for(let r of Object.keys(t))E(e,r,t[r])}(this,e),Object.assign(this.ns,e))}else this.nameStartCheck=l,this.nameCheck=h,this.isName=A,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var e;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];let{fragmentOpt:t}=this;this.state=t?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=t,this.xmlDeclPossible=!t,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:r}=this.opt;if(void 0===r){if(!0===this.opt.forceXMLVersion)throw Error("forceXMLVersion set but defaultXMLVersion is not set");r="1.0"}this.setXMLVersion(r),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(y),null===(e=this.readyHandler)||void 0===e||e.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(e,t){this[I[e]]=t}off(e){this[I[e]]=void 0}makeError(e){var t;let r=null!==(t=this.fileName)&&void 0!==t?t:"";return this.trackPosition&&(r.length>0&&(r+=":"),r+=`${this.line}:${this.column}`),r.length>0&&(r+=": "),Error(r+e)}fail(e){let t=this.makeError(e),r=this.errorHandler;if(void 0===r)throw t;return r(t),this}write(e){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let t=!1;null===e?(t=!0,e=""):"object"==typeof e&&(e=e.toString()),void 0!==this.carriedFromPrevious&&(e=`${this.carriedFromPrevious}${e}`,this.carriedFromPrevious=void 0);let r=e.length,i=e.charCodeAt(r-1);!t&&(13===i||i>=55296&&i<=56319)&&(this.carriedFromPrevious=e[r-1],r--,e=e.slice(0,r));let{stateTable:n}=this;for(this.chunk=e,this.i=0;this.i<r;)n[this.state].call(this);return this.chunkPosition+=r,t?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return -1;let r=e.charCodeAt(t);if(this.column++,r<55296){if(r>=32||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return 10===e.charCodeAt(t+1)&&(this.i=t+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let i=65536+1024*(r-55296)+(e.charCodeAt(t+1)-56320);return this.i=t+2,i>1114111&&this.fail("disallowed character."),i}getCode11(){let{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return -1;let r=e.charCodeAt(t);if(this.column++,r<55296){if(r>31&&r<127||r>159&&8232!==r||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{let r=e.charCodeAt(t+1);10!==r&&133!==r||(this.i=t+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let i=65536+1024*(r-55296)+(e.charCodeAt(t+1)-56320);return this.i=t+2,i>1114111&&this.fail("disallowed character."),i}getCodeNorm(){let e=this.getCode();return -2===e?10:e}unget(){this.i=this.prevI,this.column--}captureTo(e){let{i:t}=this,{chunk:r}=this;for(;;){let i=this.getCode(),n=-2===i,s=n?10:i;if(-1===s||e.includes(s))return this.text+=r.slice(t,this.prevI),s;n&&(this.text+=r.slice(t,this.prevI)+"\n",t=this.i)}}captureToChar(e){let{i:t}=this,{chunk:r}=this;for(;;){let i=this.getCode();switch(i){case -2:this.text+=r.slice(t,this.prevI)+"\n",t=this.i,i=10;break;case -1:return this.text+=r.slice(t),!1}if(i===e)return this.text+=r.slice(t,this.prevI),!0}}captureNameChars(){let{chunk:e,i:t}=this;for(;;){let r=this.getCode();if(-1===r)return this.name+=e.slice(t),-1;if(!h(r))return this.name+=e.slice(t,this.prevI),-2===r?10:r}}skipSpaces(){for(;;){let e=this.getCodeNorm();if(-1===e||!o(e))return e}}setXMLVersion(e){this.currentXMLVersion=e,"1.0"===e?(this.isChar=a,this.getCode=this.getCode10):(this.isChar=d,this.getCode=this.getCode11)}sBegin(){65279===this.chunk.charCodeAt(0)&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){let e=this.i,t=this.skipSpaces();switch(this.prevI!==e&&(this.xmlDeclPossible=!1),t){case 60:if(this.state=15,0!==this.text.length)throw Error("no-empty text at start");break;case -1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var e;let t=this.captureTo(S);switch(t){case 62:null===(e=this.doctypeHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case -1:break;default:this.text+=String.fromCodePoint(t),91===t?this.state=4:x(t)&&(this.state=3,this.q=t)}}sDoctypeQuote(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.q=null,this.state=2)}sDTD(){let e=this.captureTo(w);-1!==e&&(this.text+=String.fromCodePoint(e),93===e?this.state=2:60===e?this.state=6:x(e)&&(this.state=5,this.q=e))}sDTDQuoted(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.state=4,this.q=null)}sDTDOpenWaka(){let e=this.getCodeNorm();switch(this.text+=String.fromCodePoint(e),e){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){let e=String.fromCodePoint(this.getCodeNorm()),t=this.openWakaBang+=e;this.text+=e,"-"!==t&&(this.state="--"===t?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),this.state=45===e?10:8}sDTDCommentEnded(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),62===e?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),62===e&&(this.state=4)}sText(){0!==this.tags.length?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:e}=this,{chunk:t}=this;e:for(;;)switch(this.getCode()){case -2:this.entity+=t.slice(e,this.prevI)+"\n",e=this.i;break;case 59:{let r;let{entityReturnState:i}=this,n=this.entity+t.slice(e,this.prevI);this.state=i,""===n?(this.fail("empty entity name."),r="&;"):(r=this.parseEntity(n),this.entity=""),13===i&&void 0===this.textHandler||(this.text+=r);break e}case -1:this.entity+=t.slice(e);break e}}sOpenWaka(){let e=this.getCode();if(l(e))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(e){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var e;let t=this.getCodeNorm();45===t?(this.state=19,null===(e=this.commentHandler)||void 0===e||e.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(t),this.state=17)}sCommentEnded(){let e=this.getCodeNorm();62!==e?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(e),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){let e=this.getCodeNorm();93===e?this.state=22:(this.text+="]"+String.fromCodePoint(e),this.state=20)}sCDataEnding2(){var e;let t=this.getCodeNorm();switch(t){case 62:null===(e=this.cdataHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(t),this.state=20}}sPIFirstChar(){let e=this.getCodeNorm();this.nameStartCheck(e)?(this.piTarget+=String.fromCodePoint(e),this.state=24):63===e||o(e)?(this.fail("processing instruction without a target."),this.state=63===e?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e),this.state=24)}sPIRest(){let{chunk:e,i:t}=this;for(;;){let r=this.getCodeNorm();if(-1===r)return void(this.piTarget+=e.slice(t));if(!this.nameCheck(r)){this.piTarget+=e.slice(t,this.prevI);let i=63===r;i||o(r)?"xml"===this.piTarget?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=i?33:27):this.state=i?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(r));break}}}sPIBody(){if(0===this.text.length){let e=this.getCodeNorm();63===e?this.state=26:o(e)||(this.text=String.fromCodePoint(e))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var e;let t=this.getCodeNorm();if(62===t){let{piTarget:t}=this;"xml"===t.toLowerCase()&&this.fail("the XML declaration must appear at the start of the document."),null===(e=this.piHandler)||void 0===e||e.call(this,{target:t,body:this.text}),this.piTarget=this.text="",this.state=13}else 63===t?this.text+="?":(this.text+="?"+String.fromCodePoint(t),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let e=this.skipSpaces();63!==e?-1!==e&&(this.state=28,this.name=String.fromCodePoint(e)):this.state=33}sXMLDeclName(){let e=this.captureTo(T);if(63===e)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(o(e)||61===e){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=61===e?30:29}}sXMLDeclEq(){let e=this.getCodeNorm();if(63===e)return this.state=33,void this.fail("XML declaration is incomplete.");o(e)||(61!==e&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){let e=this.getCodeNorm();if(63===e)return this.state=33,void this.fail("XML declaration is incomplete.");o(e)||(x(e)?this.q=e:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){let e=this.captureTo([this.q,63]);if(63===e)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(-1===e)return;let t=this.text;switch(this.text="",this.name){case"version":this.xmlDeclExpects=["encoding","standalone"];this.xmlDecl.version=t,/^1\.[0-9]+$/.test(t)?this.opt.forceXMLVersion||this.setXMLVersion(t):this.fail("version number must match /^1\\.[0-9]+$/.");break;case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(t)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=t;break;case"standalone":"yes"!==t&&"no"!==t&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=t}this.name="",this.state=32}sXMLDeclSeparator(){let e=this.getCodeNorm();63!==e?(o(e)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var e;62===this.getCodeNorm()?("xml"!==this.piTarget?this.fail("processing instructions are not allowed before root."):"version"!==this.name&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),null===(e=this.xmldeclHandler)||void 0===e||e.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var e;let t=this.captureNameChars();if(-1===t)return;let r=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=r.ns=Object.create(null)),null===(e=this.openTagStartHandler)||void 0===e||e.call(this,r),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),t){case 62:this.openTag();break;case 47:this.state=35;break;default:o(t)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){62===this.getCode()?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){let e=this.skipSpaces();-1!==e&&(l(e)?(this.unget(),this.state=37):62===e?this.openTag():47===e?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){let e=this.captureNameChars();61===e?this.state=39:o(e)?this.state=38:62===e?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):-1!==e&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let e=this.skipSpaces();switch(e){case -1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",62===e?this.openTag():l(e)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){let e=this.getCodeNorm();x(e)?(this.q=e,this.state=40):o(e)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){let{q:e,chunk:t}=this,{i:r}=this;for(;;)switch(this.getCode()){case e:return this.pushAttrib(this.name,this.text+t.slice(r,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=t.slice(r,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case -2:case 9:this.text+=t.slice(r,this.prevI)+" ",r=this.i;break;case 60:return this.text+=t.slice(r,this.prevI),void this.fail("disallowed character.");case -1:return void(this.text+=t.slice(r))}}sAttribValueClosed(){let e=this.getCodeNorm();o(e)?this.state=36:62===e?this.openTag():47===e?this.state=35:l(e)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let e=this.captureTo(P);switch(e){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case -1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",62===e?this.openTag():this.state=36}}sCloseTag(){let e=this.captureNameChars();62===e?this.closeTag():o(e)?this.state=44:-1!==e&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case -1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:e,forbiddenState:t}=this,{chunk:r,textHandler:i}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,void 0!==i){let{text:t}=this,n=r.slice(e,this.prevI);0!==t.length?(i(t+n),this.text=""):0!==n.length&&i(n)}t=0;break e;case 38:this.state=14,this.entityReturnState=13,void 0!==i&&(this.text+=r.slice(e,this.prevI)),t=0;break e;case 93:switch(t){case 0:t=1;break;case 1:t=2;break;case 2:break;default:throw Error("impossible state")}break;case 62:2===t&&this.fail('the string "]]>" is disallowed in char data.'),t=0;break;case -2:void 0!==i&&(this.text+=r.slice(e,this.prevI)+"\n"),e=this.i,t=0;break;case -1:void 0!==i&&(this.text+=r.slice(e));break e;default:t=0}this.forbiddenState=t}handleTextOutsideRoot(){let{i:e}=this,{chunk:t,textHandler:r}=this,i=!1;e:for(;;){let n=this.getCode();switch(n){case 60:if(this.state=15,void 0!==r){let{text:i}=this,n=t.slice(e,this.prevI);0!==i.length?(r(i+n),this.text=""):0!==n.length&&r(n)}break e;case 38:this.state=14,this.entityReturnState=13,void 0!==r&&(this.text+=t.slice(e,this.prevI)),i=!0;break e;case -2:void 0!==r&&(this.text+=t.slice(e,this.prevI)+"\n"),e=this.i;break;case -1:void 0!==r&&(this.text+=t.slice(e));break e;default:o(n)||(i=!0)}}i&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(e,t){var r;let{prefix:i,local:n}=this.qname(e),s={name:e,prefix:i,local:n,value:t};if(this.attribList.push(s),null===(r=this.attributeHandler)||void 0===r||r.call(this,s),"xmlns"===i){let e=t.trim();"1.0"===this.currentXMLVersion&&""===e&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[n]=e,E(this,n,e)}else if("xmlns"===e){let e=t.trim();this.topNS[""]=e,E(this,"",e)}}pushAttribPlain(e,t){var r;let i={name:e,value:t};this.attribList.push(i),null===(r=this.attributeHandler)||void 0===r||r.call(this,i)}end(){var e,t;this.sawRoot||this.fail("document must contain a root element.");let{tags:r}=this;for(;r.length>0;){let e=r.pop();this.fail("unclosed tag: "+e.name)}0!==this.state&&13!==this.state&&this.fail("unexpected end.");let{text:i}=this;return 0!==i.length&&(null===(e=this.textHandler)||void 0===e||e.call(this,i),this.text=""),this._closed=!0,null===(t=this.endHandler)||void 0===t||t.call(this),this._init(),this}resolve(e){var t,r;let i=this.topNS[e];if(void 0!==i)return i;let{tags:n}=this;for(let t=n.length-1;t>=0;t--)if(void 0!==(i=n[t].ns[e]))return i;return void 0!==(i=this.ns[e])?i:null===(r=(t=this.opt).resolvePrefix)||void 0===r?void 0:r.call(t,e)}qname(e){let t=e.indexOf(":");if(-1===t)return{prefix:"",local:e};let r=e.slice(t+1),i=e.slice(0,t);return(""===i||""===r||r.includes(":"))&&this.fail(`malformed name: ${e}.`),{prefix:i,local:r}}processAttribsNS(){var e;let{attribList:t}=this,r=this.tag;{let{prefix:t,local:i}=this.qname(r.name);r.prefix=t,r.local=i;let n=r.uri=null!==(e=this.resolve(t))&&void 0!==e?e:"";""!==t&&("xmlns"===t&&this.fail('tags may not have "xmlns" as prefix.'),""===n&&(this.fail(`unbound namespace prefix: ${JSON.stringify(t)}.`),r.uri=t))}if(0===t.length)return;let{attributes:i}=r,n=new Set;for(let e of t){let t,r;let{name:s,prefix:o,local:a}=e;""===o?(t="xmlns"===s?v:"",r=s):(void 0===(t=this.resolve(o))&&(this.fail(`unbound namespace prefix: ${JSON.stringify(o)}.`),t=o),r=`{${t}}${a}`),n.has(r)&&this.fail(`duplicate attribute: ${r}.`),n.add(r),e.uri=t,i[s]=e}this.attribList=[]}processAttribsPlain(){let{attribList:e}=this,t=this.tag.attributes;for(let{name:r,value:i}of e)void 0!==t[r]&&this.fail(`duplicate attribute: ${r}.`),t[r]=i;this.attribList=[]}openTag(){var e;this.processAttribs();let{tags:t}=this,r=this.tag;r.isSelfClosing=!1,null===(e=this.openTagHandler)||void 0===e||e.call(this,r),t.push(r),this.state=13,this.name=""}openSelfClosingTag(){var e,t,r;this.processAttribs();let{tags:i}=this,n=this.tag;n.isSelfClosing=!0,null===(e=this.openTagHandler)||void 0===e||e.call(this,n),null===(t=this.closeTagHandler)||void 0===t||t.call(this,n),null===(this.tag=null!==(r=i[i.length-1])&&void 0!==r?r:null)&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){let{tags:e,name:t}=this;if(this.state=13,this.name="",""===t)return this.fail("weird empty close tag."),void(this.text+="</>");let r=this.closeTagHandler,i=e.length;for(;i-- >0;){let i=this.tag=e.pop();if(this.topNS=i.ns,null==r||r(i),i.name===t)break;this.fail("unexpected close tag.")}0===i?this.closedRoot=!0:i<0&&(this.fail(`unmatched closing tag: ${t}.`),this.text+=`</${t}>`)}parseEntity(e){if("#"!==e[0]){let t=this.ENTITIES[e];return void 0!==t?t:(this.fail(this.isName(e)?"undefined entity.":"disallowed character in entity name."),`&${e};`)}let t=NaN;return"x"===e[1]&&/^#x[0-9a-f]+$/i.test(e)?t=parseInt(e.slice(2),16):/^#[0-9]+$/.test(e)&&(t=parseInt(e.slice(1),10)),this.isChar(t)?String.fromCodePoint(t):(this.fail("malformed character entity."),`&${e};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer;function n(e,t){this._block=i.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}n.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=i.from(e,t));for(var r=this._block,n=this._blockSize,s=e.length,o=this._len,a=0;a<s;){for(var l=o%n,h=Math.min(s-a,n-l),u=0;u<h;u++)r[l+u]=e[a+u];a+=h,(o+=h)%n==0&&this._update(r)}return this._len+=s,this},n.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=8*this._len;if(r<=0xffffffff)this._block.writeUInt32BE(r,this._blockSize-4);else{var i=(0xffffffff&r)>>>0;this._block.writeUInt32BE((r-i)/0x100000000,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var n=this._hash();return e?n.toString(e):n},n.prototype._update=function(){throw Error("_update must be implemented by subclass")},t.exports=n},{"safe-buffer":494}],498:[function(e,t,r){"use strict";var i=t.exports=function(e){var t=i[e=e.toLowerCase()];if(!t)throw Error(e+" is not supported (we accept pull requests)");return new t};i.sha=e("./sha"),i.sha1=e("./sha1"),i.sha224=e("./sha224"),i.sha256=e("./sha256"),i.sha384=e("./sha384"),i.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,t,r){"use strict";var i=e("inherits"),n=e("./hash"),s=e("safe-buffer").Buffer,o=[0x5a827999,0x6ed9eba1,-0x70e44324,-0x359d3e2a],a=Array(80);function l(){this.init(),this._w=a,n.call(this,64,56)}i(l,n),l.prototype.init=function(){return this._a=0x67452301,this._b=0xefcdab89,this._c=0x98badcfe,this._d=0x10325476,this._e=0xc3d2e1f0,this},l.prototype._update=function(e){for(var t,r=this._w,i=0|this._a,n=0|this._b,s=0|this._c,a=0|this._d,l=0|this._e,h=0;h<16;++h)r[h]=e.readInt32BE(4*h);for(;h<80;++h)r[h]=r[h-3]^r[h-8]^r[h-14]^r[h-16];for(var u=0;u<80;++u){var c,d,f,p,g,m=~~(u/20),v=0|((t=i)<<5|t>>>27)+(c=m,d=n,f=s,p=a,0===c?d&f|~d&p:2===c?d&f|d&p|f&p:d^f^p)+l+r[u]+o[m];l=a,a=s,s=(g=n)<<30|g>>>2,n=i,i=v}this._a=i+this._a|0,this._b=n+this._b|0,this._c=s+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,t,r){"use strict";var i=e("inherits"),n=e("./hash"),s=e("safe-buffer").Buffer,o=[0x5a827999,0x6ed9eba1,-0x70e44324,-0x359d3e2a],a=Array(80);function l(){this.init(),this._w=a,n.call(this,64,56)}i(l,n),l.prototype.init=function(){return this._a=0x67452301,this._b=0xefcdab89,this._c=0x98badcfe,this._d=0x10325476,this._e=0xc3d2e1f0,this},l.prototype._update=function(e){for(var t,r=this._w,i=0|this._a,n=0|this._b,s=0|this._c,a=0|this._d,l=0|this._e,h=0;h<16;++h)r[h]=e.readInt32BE(4*h);for(;h<80;++h)r[h]=(t=r[h-3]^r[h-8]^r[h-14]^r[h-16])<<1|t>>>31;for(var u=0;u<80;++u){var c,d,f,p,g,m,v=~~(u/20),b=((c=i)<<5|c>>>27)+(d=v,f=n,p=s,g=a,0===d?f&p|~f&g:2===d?f&p|f&g|p&g:f^p^g)+l+r[u]+o[v]|0;l=a,a=s,s=(m=n)<<30|m>>>2,n=i,i=b}this._a=i+this._a|0,this._b=n+this._b|0,this._c=s+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,t,r){"use strict";var i=e("inherits"),n=e("./sha256"),s=e("./hash"),o=e("safe-buffer").Buffer,a=Array(64);function l(){this.init(),this._w=a,s.call(this,64,56)}i(l,n),l.prototype.init=function(){return this._a=0xc1059ed8,this._b=0x367cd507,this._c=0x3070dd17,this._d=0xf70e5939,this._e=0xffc00b31,this._f=0x68581511,this._g=0x64f98fa7,this._h=0xbefa4fa4,this},l.prototype._hash=function(){var e=o.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},t.exports=l},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,t,r){"use strict";var i=e("inherits"),n=e("./hash"),s=e("safe-buffer").Buffer,o=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],a=Array(64);function l(){this.init(),this._w=a,n.call(this,64,56)}i(l,n),l.prototype.init=function(){return this._a=0x6a09e667,this._b=0xbb67ae85,this._c=0x3c6ef372,this._d=0xa54ff53a,this._e=0x510e527f,this._f=0x9b05688c,this._g=0x1f83d9ab,this._h=0x5be0cd19,this},l.prototype._update=function(e){for(var t,r=this._w,i=0|this._a,n=0|this._b,s=0|this._c,a=0|this._d,l=0|this._e,h=0|this._f,u=0|this._g,c=0|this._h,d=0;d<16;++d)r[d]=e.readInt32BE(4*d);for(;d<64;++d){;r[d]=0|(((t=r[d-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+r[d-7]+(((p=r[d-15])>>>7|p<<25)^(p>>>18|p<<14)^p>>>3)+r[d-16]}for(var f=0;f<64;++f){var p,g,m,v,b,y,x,_,S=c+(((g=l)>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(m=l,v=h,(b=u)^m&(v^b))+o[f]+r[f]|0,w=(((y=i)>>>2|y<<30)^(y>>>13|y<<19)^(y>>>22|y<<10))+((x=i)&(_=n)|s&(x|_))|0;c=u,u=h,h=l,l=a+S|0,a=s,s=n,n=i,i=S+w|0}this._a=i+this._a|0,this._b=n+this._b|0,this._c=s+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0,this._f=h+this._f|0,this._g=u+this._g|0,this._h=c+this._h|0},l.prototype._hash=function(){var e=s.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,t,r){"use strict";var i=e("inherits"),n=e("./sha512"),s=e("./hash"),o=e("safe-buffer").Buffer,a=Array(160);function l(){this.init(),this._w=a,s.call(this,128,112)}i(l,n),l.prototype.init=function(){return this._ah=0xcbbb9d5d,this._bh=0x629a292a,this._ch=0x9159015a,this._dh=0x152fecd8,this._eh=0x67332667,this._fh=0x8eb44a87,this._gh=0xdb0c2e0d,this._hh=0x47b5481d,this._al=0xc1059ed8,this._bl=0x367cd507,this._cl=0x3070dd17,this._dl=0xf70e5939,this._el=0xffc00b31,this._fl=0x68581511,this._gl=0x64f98fa7,this._hl=0xbefa4fa4,this},l.prototype._hash=function(){var e=o.allocUnsafe(48);function t(t,r,i){e.writeInt32BE(t,i),e.writeInt32BE(r,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},t.exports=l},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,t,r){"use strict";var i=e("inherits"),n=e("./hash"),s=e("safe-buffer").Buffer,o=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817],a=Array(160);function l(){this.init(),this._w=a,n.call(this,128,112)}function h(e,t,r){return r^e&(t^r)}function u(e,t,r){return e&t|r&(e|t)}function c(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function d(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return e>>>0<t>>>0?1:0}i(l,n),l.prototype.init=function(){return this._ah=0x6a09e667,this._bh=0xbb67ae85,this._ch=0x3c6ef372,this._dh=0xa54ff53a,this._eh=0x510e527f,this._fh=0x9b05688c,this._gh=0x1f83d9ab,this._hh=0x5be0cd19,this._al=0xf3bcc908,this._bl=0x84caa73b,this._cl=0xfe94f82b,this._dl=0x5f1d36f1,this._el=0xade682d1,this._fl=0x2b3e6c1f,this._gl=0xfb41bd6b,this._hl=0x137e2179,this},l.prototype._update=function(e){for(var t=this._w,r=0|this._ah,i=0|this._bh,n=0|this._ch,s=0|this._dh,a=0|this._eh,l=0|this._fh,h=0|this._gh,u=0|this._hh,p=0|this._al,g=0|this._bl,m=0|this._cl,v=0|this._dl,b=0|this._el,y=0|this._fl,x=0|this._gl,_=0|this._hl,S=0;S<32;S+=2)t[S]=e.readInt32BE(4*S),t[S+1]=e.readInt32BE(4*S+4);for(;S<160;S+=2){var w,T,P,E,C,A,I,M,R=t[S-30],O=t[S-30+1],k=((w=R)>>>1|(T=O)<<31)^(w>>>8|T<<24)^w>>>7,N=((P=O)>>>1|(E=R)<<31)^(P>>>8|E<<24)^(P>>>7|E<<25),L=(C=R=t[S-4],(C>>>19|(A=O=t[S-4+1])<<13)^(A>>>29|C<<3)^C>>>6),D=((I=O)>>>19|(M=R)<<13)^(M>>>29|I<<3)^(I>>>6|M<<26),B=t[S-14],F=t[S-14+1],V=t[S-32],G=t[S-32+1],U=N+F|0,z=k+B+f(U,N)|0;z=(z=z+L+f(U=U+D|0,D)|0)+V+f(U=U+G|0,G)|0,t[S]=z,t[S+1]=U}for(var j=0;j<160;j+=2){z=t[j],U=t[j+1];var H,W,q,X,$,Y,Z,K,J,Q,ee=(H=r)&(W=i)|n&(H|W),et=(q=p)&(X=g)|m&(q|X),er=c(r,p),ei=c(p,r),en=d(a,b),es=d(b,a),eo=o[j],ea=o[j+1],el=($=a,Y=l,(Z=h)^$&(Y^Z)),eh=(K=b,J=y,(Q=x)^K&(J^Q)),eu=_+es|0,ec=u+en+f(eu,_)|0;ec=(ec=(ec=ec+el+f(eu=eu+eh|0,eh)|0)+eo+f(eu=eu+ea|0,ea)|0)+z+f(eu=eu+U|0,U)|0;var ed=ei+et|0,ef=er+ee+f(ed,ei)|0;u=h,_=x,h=l,x=y,l=a,y=b,a=s+ec+f(b=v+eu|0,v)|0,s=n,v=m,n=i,m=g,i=r,g=p,r=ec+ef+f(p=eu+ed|0,eu)|0}this._al=this._al+p|0,this._bl=this._bl+g|0,this._cl=this._cl+m|0,this._dl=this._dl+v|0,this._el=this._el+b|0,this._fl=this._fl+y|0,this._gl=this._gl+x|0,this._hl=this._hl+_|0,this._ah=this._ah+r+f(this._al,p)|0,this._bh=this._bh+i+f(this._bl,g)|0,this._ch=this._ch+n+f(this._cl,m)|0,this._dh=this._dh+s+f(this._dl,v)|0,this._eh=this._eh+a+f(this._el,b)|0,this._fh=this._fh+l+f(this._fl,y)|0,this._gh=this._gh+h+f(this._gl,x)|0,this._hh=this._hh+u+f(this._hl,_)|0},l.prototype._hash=function(){var e=s.allocUnsafe(64);function t(t,r,i){e.writeInt32BE(t,i),e.writeInt32BE(r,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},t.exports=l},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,t,r){"use strict";t.exports=n;var i=e("events").EventEmitter;function n(){i.call(this)}e("inherits")(n,i),n.Readable=e("readable-stream/readable.js"),n.Writable=e("readable-stream/writable.js"),n.Duplex=e("readable-stream/duplex.js"),n.Transform=e("readable-stream/transform.js"),n.PassThrough=e("readable-stream/passthrough.js"),n.Stream=n,n.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",s),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",l));var o=!1;function a(){o||(o=!0,e.end())}function l(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function h(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",n),e.removeListener("drain",s),r.removeListener("end",a),r.removeListener("close",l),r.removeListener("error",h),e.removeListener("error",h),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return r.on("error",h),e.on("error",h),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,t,r){"use strict";var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],507:[function(e,t,r){"use strict";t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,t,r){"use strict";var i=e("process-nextick-args"),n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=c;var s=Object.create(e("core-util-is"));s.inherits=e("inherits");var o=e("./_stream_readable"),a=e("./_stream_writable");s.inherits(c,o);for(var l=n(a.prototype),h=0;h<l.length;h++){var u=l[h];c.prototype[u]||(c.prototype[u]=a.prototype[u])}function c(e){if(!(this instanceof c))return new c(e);o.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||i.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,t,r){"use strict";t.exports=s;var i=e("./_stream_transform"),n=Object.create(e("core-util-is"));function s(e){if(!(this instanceof s))return new s(e);i.call(this,e)}n.inherits=e("inherits"),n.inherits(s,i),s.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,t,i){(function(r,i){(function(){"use strict";var n=e("process-nextick-args");t.exports=y;var s,o=e("isarray");y.ReadableState=b,e("events").EventEmitter;var a=function(e,t){return e.listeners(t).length},l=e("./internal/streams/stream"),h=e("safe-buffer").Buffer,u=(void 0!==i?i:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},c=Object.create(e("core-util-is"));c.inherits=e("inherits");var d=e("util"),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,g=e("./internal/streams/BufferList"),m=e("./internal/streams/destroy");c.inherits(y,l);var v=["error","close","destroy","pause","resume"];function b(t,r){t=t||{};var i=r instanceof(s=s||e("./_stream_duplex"));this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,o=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=e("string_decoder/").StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function y(t){if(s=s||e("./_stream_duplex"),!(this instanceof y))return new y(t);this._readableState=new b(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function x(e,t,r,i,n){var s,o,a,l=e._readableState;return null===t?(l.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,w(e)}}(e,l)):(n||(a=function(e,t){var r;return h.isBuffer(t)||t instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=TypeError("Invalid non-string/buffer chunk")),r}(l,t)),a?e.emit("error",a):l.objectMode||t&&t.length>0?("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===h.prototype||(s=t,t=h.from(s)),i?l.endEmitted?e.emit("error",Error("stream.unshift() after end event")):_(e,l,t,!0):l.ended?e.emit("error",Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!r?(t=l.decoder.write(t),l.objectMode||0!==t.length?_(e,l,t,!1):P(e,l)):_(e,l,t,!1))):i||(l.reading=!1)),!(o=l).ended&&(o.needReadable||o.length<o.highWaterMark||0===o.length)}function _(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&w(e)),P(e,t)}function S(e,t){var r;return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=((r=e)>=8388608?r=8388608:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(T,e):T(e))}function T(e){f("emit readable"),e.emit("readable"),I(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(E,e,t))}function E(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function C(e){f("readable nexttick read 0"),e.read(0)}function A(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),I(e),t.flowing&&!t.reading&&e.read(0)}function I(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function M(e,t){var r,i,n,s,o;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):(i=e,n=t.buffer,s=t.decoder,i<n.head.data.length?(o=n.head.data.slice(0,i),n.head.data=n.head.data.slice(i)):o=i===n.head.data.length?n.shift():s?function(e,t){var r=t.head,i=1,n=r.data;for(e-=n.length;r=r.next;){var s=r.data,o=e>s.length?s.length:e;if(o===s.length?n+=s:n+=s.slice(0,e),0==(e-=o)){o===s.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(o));break}++i}return t.length-=i,n}(i,n):function(e,t){var r=h.allocUnsafe(e),i=t.head,n=1;for(i.data.copy(r),e-=i.data.length;i=i.next;){var s=i.data,o=e>s.length?s.length:e;if(s.copy(r,r.length-e,0,o),0==(e-=o)){o===s.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=s.slice(o));break}++n}return t.length-=n,r}(i,n),r=o),r)}function R(e){var t=e._readableState;if(t.length>0)throw Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(O,t,e))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function k(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(e,t){this.push(null),t(e)},y.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=h.from(e,t),t=""),r=!0),x(this,e,t,!1,r)},y.prototype.unshift=function(e){return x(this,e,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(t){return p||(p=e("string_decoder/").StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this},y.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):w(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&R(this),null;var i,n=t.needReadable;return f("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",n=!0),t.ended||t.reading?f("reading or ended",n=!1):n&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(r,t))),null===(i=e>0?M(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&R(this)),null!==i&&this.emit("data",i),i},y.prototype._read=function(e){this.emit("error",Error("_read() is not implemented"))},y.prototype.pipe=function(e,t){var i,s=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=e;break;case 1:l.pipes=[l.pipes,e];break;default:l.pipes.push(e)}l.pipesCount+=1,f("pipe count=%d opts=%j",l.pipesCount,t);var h=t&&!1===t.end||e===r.stdout||e===r.stderr?y:u;function u(){f("onend"),e.end()}l.endEmitted?n.nextTick(h):s.once("end",h),e.on("unpipe",function t(r,i){f("onunpipe"),r===s&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,f("cleanup"),e.removeListener("close",v),e.removeListener("finish",b),e.removeListener("drain",c),e.removeListener("error",m),e.removeListener("unpipe",t),s.removeListener("end",u),s.removeListener("end",y),s.removeListener("data",g),d=!0,l.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&c())});var c=(i=s,function(){var e=i._readableState;f("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(i,"data")&&(e.flowing=!0,I(i))});e.on("drain",c);var d=!1,p=!1;function g(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===l.pipesCount&&l.pipes===e||l.pipesCount>1&&-1!==k(l.pipes,e))&&!d&&(f("false write response, pause",l.awaitDrain),l.awaitDrain++,p=!0),s.pause())}function m(t){f("onerror",t),y(),e.removeListener("error",m),0===a(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",b),y()}function b(){f("onfinish"),e.removeListener("close",v),y()}function y(){f("unpipe"),s.unpipe(e)}return s.on("data",g),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",m),e.once("close",v),e.once("finish",b),e.emit("pipe",s),l.flowing||(f("pipe resume"),s.resume()),e},y.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=k(t.pipes,e);return -1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},y.prototype.on=function(e,t){var r=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):n.nextTick(C,this))}return r},y.prototype.addListener=y.prototype.on,y.prototype.resume=function(){var e,t,r=this._readableState;return r.flowing||(f("resume"),r.flowing=!0,e=this,(t=r).resumeScheduled||(t.resumeScheduled=!0,n.nextTick(A,e,t))),this},y.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",function(){if(f("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(n){f("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n||(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))}),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var s=0;s<v.length;s++)e.on(v[s],this.emit.bind(this,v[s]));return this._read=function(t){f("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),y._fromList=M}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,t,r){"use strict";t.exports=o;var i=e("./_stream_duplex"),n=Object.create(e("core-util-is"));function s(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);i.call(this,e),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){l(e,t,r)}):l(this,null,null)}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw Error("Calling transform done when still transforming");return e.push(null)}n.inherits=e("inherits"),n.inherits(o,i),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,r){throw Error("_transform() is not implemented")},o.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var r=this;i.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,t,i){(function(r,i,n){(function(){"use strict";var s=e("process-nextick-args");function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(void 0),i=i.next}t.corkedRequestsFree.next=e}(t,e)}}t.exports=b;var a,l=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?n:s.nextTick;b.WritableState=v;var h=Object.create(e("core-util-is"));h.inherits=e("inherits");var u={deprecate:e("util-deprecate")},c=e("./internal/streams/stream"),d=e("safe-buffer").Buffer,f=(void 0!==i?i:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},p,g=e("./internal/streams/destroy");function m(){}function v(t,r){a=a||e("./_stream_duplex"),t=t||{};var i=r instanceof a;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,h=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(h||0===h)?h:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r,i,n,o,a,h,u=e._writableState,c=u.sync,d=u.writecb;if((r=u).writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t){;i=e,n=u,o=c,a=t,h=d,--n.pendingcb,o?(s.nextTick(h,a),s.nextTick(T,i,n),i._writableState.errorEmitted=!0,i.emit("error",a)):(h(a),i._writableState.errorEmitted=!0,i.emit("error",a),T(i,n))}else{var f=S(u);f||u.corked||u.bufferProcessing||!u.bufferedRequest||_(e,u),c?l(x,e,u,f,d):x(e,u,f,d)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function b(t){if(a=a||e("./_stream_duplex"),!(p.call(b,this)||this instanceof a))return new b(t);this._writableState=new v(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),c.call(this)}function y(e,t,r,i,n,s,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function x(e,t,r,i){var n,s;r||(n=e,0===(s=t).length&&s.needDrain&&(s.needDrain=!1,n.emit("drain"))),t.pendingcb--,i(),T(e,t)}function _(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=Array(t.bufferedRequestCount),n=t.corkedRequestsFree;n.entry=r;for(var s=0,a=!0;r;)i[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;i.allBuffers=a,y(e,t,!0,t.length,i,"",n.finish),t.pendingcb++,t.lastBufferedRequest=null,n.next?(t.corkedRequestsFree=n.next,n.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,h=r.encoding,u=r.callback;if(y(e,t,!1,t.objectMode?1:l.length,l,h,u),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function S(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),T(e,t)})}function T(e,t){var r,i,n=S(t);return n&&(r=e,(i=t).prefinished||i.finalCalled||("function"==typeof r._final?(i.pendingcb++,i.finalCalled=!0,s.nextTick(w,r,i)):(i.prefinished=!0,r.emit("prefinish"))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}h.inherits(b,c),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:u.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===b&&e&&e._writableState instanceof v}})):p=function(e){return e instanceof this},b.prototype.pipe=function(){this.emit("error",Error("Cannot pipe, not readable"))},b.prototype.write=function(e,t,r){var i,n,o,a,l,h,u,c,p,g,v,b=this._writableState,x=!1,_=!b.objectMode&&(v=e,d.isBuffer(v)||v instanceof f);return _&&!d.isBuffer(e)&&(i=e,e=d.from(i)),"function"==typeof t&&(r=t,t=null),_?t="buffer":t||(t=b.defaultEncoding),"function"!=typeof r&&(r=m),b.ended?(n=this,o=r,a=Error("write after end"),n.emit("error",a),s.nextTick(o,a)):(_||(l=this,h=b,u=e,c=r,p=!0,g=!1,null===u?g=TypeError("May not write null values to stream"):"string"==typeof u||void 0===u||h.objectMode||(g=TypeError("Invalid non-string/buffer chunk")),g&&(l.emit("error",g),s.nextTick(c,g),p=!1),p))&&(b.pendingcb++,x=function(e,t,r,i,n,s){if(!r){var o,a,l,h=(o=t,a=i,l=n,o.objectMode||!1===o.decodeStrings||"string"!=typeof a||(a=d.from(a,l)),a);i!==h&&(r=!0,n="buffer",i=h)}var u=t.objectMode?1:i.length;t.length+=u;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var f=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},f?f.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,u,i,n,s);return c}(this,b,_,e,t,r)),x},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||_(this,e))},b.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(e,t,r){r(Error("_write() is not implemented"))},b.prototype._writev=null,b.prototype.end=function(e,t,r){var i,n,o,a=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),a.corked&&(a.corked=1,this.uncork()),a.ending||(i=this,n=a,o=r,n.ending=!0,T(i,n),o&&(n.finished?s.nextTick(o):i.once("finish",o)),n.ended=!0,i.writable=!1)},Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,t,r){"use strict";var i=e("safe-buffer").Buffer,n=e("util");t.exports=function(){function e(){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);for(var t,r,n=i.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,r=o,t.copy(n,r),o+=s.data.length,s=s.next;return n},e}(),n&&n.inspect&&n.inspect.custom&&(t.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":520,util:188}],514:[function(e,t,r){"use strict";var i=e("process-nextick-args");function n(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,s=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return s||o?t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(n,this,e)):i.nextTick(n,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?r._writableState?r._writableState.errorEmitted||(r._writableState.errorEmitted=!0,i.nextTick(n,r,e)):i.nextTick(n,r,e):t&&t(e)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,t,r){arguments[4][490][0].apply(r,arguments)},{dup:490,events:422}],516:[function(e,t,r){"use strict";t.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,t,r){"use strict";(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,t,r){"use strict";t.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,t,r){"use strict";t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,t,r){arguments[4][217][0].apply(r,arguments)},{buffer:220,dup:217}],521:[function(e,t,r){arguments[4][218][0].apply(r,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,t,r){arguments[4][218][0].apply(r,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,t,r){(function(t,i){(function(){"use strict";var n=e("process/browser.js").nextTick,s=Function.prototype.apply,o=Array.prototype.slice,a={},l=0;function h(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new h(s.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new h(s.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},h.prototype.unref=h.prototype.ref=function(){},h.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r.setImmediate="function"==typeof t?t:function(e){var t=l++,i=!(arguments.length<2)&&o.call(arguments,1);return a[t]=!0,n(function(){a[t]&&(i?e.apply(null,i):e.call(null),r.clearImmediate(t))}),t},r.clearImmediate="function"==typeof i?i:function(e){delete a[e]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,t,i){(function(e){(function(){"use strict";function r(t){try{if(!e.localStorage)return!1}catch(e){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var i=!1;return function(){if(!i){if(r("throwDeprecation"))throw Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],525:[function(e,t,r){"use strict";"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],526:[function(e,t,r){"use strict";t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],527:[function(e,t,i){(function(t,r){(function(){"use strict";var n=/%[sdj%]/g;i.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(a(arguments[r]));return t.join(" ")}r=1;for(var i=arguments,s=i.length,o=String(e).replace(n,function(e){if("%%"===e)return"%";if(r>=s)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(e){return"[Circular]"}default:return e}}),l=i[r];r<s;l=i[++r])g(l)||!x(l)?o+=" "+l:o+=" "+a(l);return o},i.deprecate=function(e,n){if(b(r.process))return function(){return i.deprecate(e,n).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return function(){if(!s){if(t.throwDeprecation)throw Error(n);t.traceDeprecation?console.trace(n):console.error(n),s=!0}return e.apply(this,arguments)}};var s,o={};function a(e,t){var r={seen:[],stylize:h};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(t)?r.showHidden=t:t&&i._extend(r,t),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),u(r,e,r.depth)}function l(e,t){var r=a.styles[t];return r?"\x1b["+a.colors[r][0]+"m"+e+"\x1b["+a.colors[r][1]+"m":e}function h(e,t){return e}function u(e,t,r){if(e.customInspect&&t&&w(t.inspect)&&t.inspect!==i.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n,s,o,a=t.inspect(r,e);return v(a)||(a=u(e,a,r)),a}var l=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return m(t)?e.stylize(""+t,"number"):p(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,t);if(l)return l;var h=Object.keys(t),x=(P={},h.forEach(function(e,t){P[e]=!0}),P);if(e.showHidden&&(h=Object.getOwnPropertyNames(t)),S(t)&&(h.indexOf("message")>=0||h.indexOf("description")>=0))return c(t);if(0===h.length){if(w(t)){var T=t.name?": "+t.name:"";return e.stylize("[Function"+T+"]","special")}if(y(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(_(t))return e.stylize(Date.prototype.toString.call(t),"date");if(S(t))return c(t)}var P,E,A="",I=!1,M=["{","}"];return f(t)&&(I=!0,M=["[","]"]),w(t)&&(A=" [Function"+(t.name?": "+t.name:"")+"]"),y(t)&&(A=" "+RegExp.prototype.toString.call(t)),_(t)&&(A=" "+Date.prototype.toUTCString.call(t)),S(t)&&(A=" "+c(t)),0!==h.length||I&&0!=t.length?r<0?y(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),E=I?function(e,t,r,i,n){for(var s=[],o=0,a=t.length;o<a;++o)C(t,String(o))?s.push(d(e,t,r,i,String(o),!0)):s.push("");return n.forEach(function(n){n.match(/^\d+$/)||s.push(d(e,t,r,i,n,!0))}),s}(e,t,r,x,h):h.map(function(i){return d(e,t,r,x,i,I)}),e.seen.pop(),n=E,s=A,o=M,n.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?o[0]+(""===s?"":s+"\n ")+" "+n.join(",\n  ")+" "+o[1]:o[0]+s+" "+n.join(", ")+" "+o[1]):M[0]+A+M[1]}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,i,n,s){var o,a,l;if((l=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]}).get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),C(i,n)||(o="["+n+"]"),a||(0>e.seen.indexOf(l.value)?(a=g(r)?u(e,l.value,null):u(e,l.value,r-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),b(o)){if(s&&n.match(/^\d+$/))return a;(o=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+a}function f(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function g(e){return null===e}function m(e){return"number"==typeof e}function v(e){return"string"==typeof e}function b(e){return void 0===e}function y(e){return x(e)&&"[object RegExp]"===T(e)}function x(e){return"object"==typeof e&&null!==e}function _(e){return x(e)&&"[object Date]"===T(e)}function S(e){return x(e)&&("[object Error]"===T(e)||e instanceof Error)}function w(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}i.debuglog=function(e){if(b(s)&&(s=t.env.NODE_DEBUG||""),!o[e=e.toUpperCase()]){if(RegExp("\\b"+e+"\\b","i").test(s)){var r=t.pid;o[e]=function(){var t=i.format.apply(i,arguments);console.error("%s %d: %s",e,r,t)}}else o[e]=function(){}}return o[e]},i.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=f,i.isBoolean=p,i.isNull=g,i.isNullOrUndefined=function(e){return null==e},i.isNumber=m,i.isString=v,i.isSymbol=function(e){return"symbol"==typeof e},i.isUndefined=b,i.isRegExp=y,i.isObject=x,i.isDate=_,i.isError=S,i.isFunction=w,i.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},i.isBuffer=e("./support/isBuffer");var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}i.log=function(){var e,t;console.log("%s - %s",(t=[P((e=new Date).getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":"),[e.getDate(),E[e.getMonth()],t].join(" ")),i.format.apply(i,arguments))},i.inherits=e("inherits"),i._extend=function(e,t){if(!t||!x(t))return e;for(var r=Object.keys(t),i=r.length;i--;)e[r[i]]=t[r[i]];return e}}).call(this)}).call(this,e("_process"),void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return c.default}});var i=d(e("./v1.js")),n=d(e("./v3.js")),s=d(e("./v4.js")),o=d(e("./v5.js")),a=d(e("./nil.js")),l=d(e("./version.js")),h=d(e("./validate.js")),u=d(e("./stringify.js")),c=d(e("./parse.js"));function d(e){return e&&e.__esModule?e:{default:e}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,t,r){"use strict";function i(e){return 14+(e+64>>>9<<4)+1}function n(e,t){let r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function s(e,t,r,i,s,o){var a;return n((a=n(n(t,e),n(i,o)))<<s|a>>>32-s,r)}function o(e,t,r,i,n,o,a){return s(t&r|~t&i,e,t,n,o,a)}function a(e,t,r,i,n,o,a){return s(t&i|r&~i,e,t,n,o,a)}function l(e,t,r,i,n,o,a){return s(t^r^i,e,t,n,o,a)}function h(e,t,r,i,n,o,a){return s(r^(t|~i),e,t,n,o,a)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=function(e){if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){let t=[],r=32*e.length;for(let i=0;i<r;i+=8){let r=e[i>>5]>>>i%32&255,n=parseInt("0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r),16);t.push(n)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[i(t)-1]=t;let r=0x67452301,s=-0x10325477,u=-0x67452302,c=0x10325476;for(let t=0;t<e.length;t+=16){let i=r,d=s,f=u,p=c;r=o(r,s,u,c,e[t],7,-0x28955b88),c=o(c,r,s,u,e[t+1],12,-0x173848aa),u=o(u,c,r,s,e[t+2],17,0x242070db),s=o(s,u,c,r,e[t+3],22,-0x3e423112),r=o(r,s,u,c,e[t+4],7,-0xa83f051),c=o(c,r,s,u,e[t+5],12,0x4787c62a),u=o(u,c,r,s,e[t+6],17,-0x57cfb9ed),s=o(s,u,c,r,e[t+7],22,-0x2b96aff),r=o(r,s,u,c,e[t+8],7,0x698098d8),c=o(c,r,s,u,e[t+9],12,-0x74bb0851),u=o(u,c,r,s,e[t+10],17,-42063),s=o(s,u,c,r,e[t+11],22,-0x76a32842),r=o(r,s,u,c,e[t+12],7,0x6b901122),c=o(c,r,s,u,e[t+13],12,-0x2678e6d),u=o(u,c,r,s,e[t+14],17,-0x5986bc72),s=o(s,u,c,r,e[t+15],22,0x49b40821),r=a(r,s,u,c,e[t+1],5,-0x9e1da9e),c=a(c,r,s,u,e[t+6],9,-0x3fbf4cc0),u=a(u,c,r,s,e[t+11],14,0x265e5a51),s=a(s,u,c,r,e[t],20,-0x16493856),r=a(r,s,u,c,e[t+5],5,-0x29d0efa3),c=a(c,r,s,u,e[t+10],9,0x2441453),u=a(u,c,r,s,e[t+15],14,-0x275e197f),s=a(s,u,c,r,e[t+4],20,-0x182c0438),r=a(r,s,u,c,e[t+9],5,0x21e1cde6),c=a(c,r,s,u,e[t+14],9,-0x3cc8f82a),u=a(u,c,r,s,e[t+3],14,-0xb2af279),s=a(s,u,c,r,e[t+8],20,0x455a14ed),r=a(r,s,u,c,e[t+13],5,-0x561c16fb),c=a(c,r,s,u,e[t+2],9,-0x3105c08),u=a(u,c,r,s,e[t+7],14,0x676f02d9),s=a(s,u,c,r,e[t+12],20,-0x72d5b376),r=l(r,s,u,c,e[t+5],4,-378558),c=l(c,r,s,u,e[t+8],11,-0x788e097f),u=l(u,c,r,s,e[t+11],16,0x6d9d6122),s=l(s,u,c,r,e[t+14],23,-0x21ac7f4),r=l(r,s,u,c,e[t+1],4,-0x5b4115bc),c=l(c,r,s,u,e[t+4],11,0x4bdecfa9),u=l(u,c,r,s,e[t+7],16,-0x944b4a0),s=l(s,u,c,r,e[t+10],23,-0x41404390),r=l(r,s,u,c,e[t+13],4,0x289b7ec6),c=l(c,r,s,u,e[t],11,-0x155ed806),u=l(u,c,r,s,e[t+3],16,-0x2b10cf7b),s=l(s,u,c,r,e[t+6],23,0x4881d05),r=l(r,s,u,c,e[t+9],4,-0x262b2fc7),c=l(c,r,s,u,e[t+12],11,-0x1924661b),u=l(u,c,r,s,e[t+15],16,0x1fa27cf8),s=l(s,u,c,r,e[t+2],23,-0x3b53a99b),r=h(r,s,u,c,e[t],6,-0xbd6ddbc),c=h(c,r,s,u,e[t+7],10,0x432aff97),u=h(u,c,r,s,e[t+14],15,-0x546bdc59),s=h(s,u,c,r,e[t+5],21,-0x36c5fc7),r=h(r,s,u,c,e[t+12],6,0x655b59c3),c=h(c,r,s,u,e[t+3],10,-0x70f3336e),u=h(u,c,r,s,e[t+10],15,-1051523),s=h(s,u,c,r,e[t+1],21,-0x7a7ba22f),r=h(r,s,u,c,e[t+8],6,0x6fa87e4f),c=h(c,r,s,u,e[t+15],10,-0x1d31920),u=h(u,c,r,s,e[t+6],15,-0x5cfebcec),s=h(s,u,c,r,e[t+13],21,0x4e0811a1),r=h(r,s,u,c,e[t+4],6,-0x8ac817e),c=h(c,r,s,u,e[t+11],10,-0x42c50dcb),u=h(u,c,r,s,e[t+2],15,0x2ad7d2bb),s=h(s,u,c,r,e[t+9],21,-0x14792c6f),r=n(r,i),s=n(s,d),u=n(u,f),c=n(c,p)}return[r,s,u,c]}(function(e){if(0===e.length)return[];let t=8*e.length,r=new Uint32Array(i(t));for(let i=0;i<t;i+=8)r[i>>5]|=(255&e[i/8])<<i%32;return r}(e),8*e.length))}},{}],530:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,n=(i=e("./validate.js"))&&i.__esModule?i:{default:i};r.default=function(e){let t;if(!(0,n.default)(e))throw TypeError("Invalid UUID");let r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/0x10000000000&255,r[11]=t/0x100000000&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}},{"./validate.js":541}],532:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,t,r){"use strict";let i;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(n)};let n=new Uint8Array(16)},{}],534:[function(e,t,r){"use strict";function i(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=function(e){let t=[0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xca62c1d6],r=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0];if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=Math.ceil((e.length/4+2)/16),s=Array(n);for(let t=0;t<n;++t){let r=new Uint32Array(16);for(let i=0;i<16;++i)r[i]=e[64*t+4*i]<<24|e[64*t+4*i+1]<<16|e[64*t+4*i+2]<<8|e[64*t+4*i+3];s[t]=r}s[n-1][14]=8*(e.length-1)/0x100000000,s[n-1][14]=Math.floor(s[n-1][14]),s[n-1][15]=8*(e.length-1)&0xffffffff;for(let e=0;e<n;++e){let n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=s[e][t];for(let e=16;e<80;++e)n[e]=i(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let o=r[0],a=r[1],l=r[2],h=r[3],u=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),s=i(o,5)+function(e,t,r,i){switch(e){case 0:return t&r^~t&i;case 1:case 3:return t^r^i;case 2:return t&r^t&i^r&i}}(r,a,l,h)+u+t[r]+n[e]>>>0;u=h,h=l,l=i(a,30)>>>0,a=o,o=s}r[0]=r[0]+o>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+h>>>0,r[4]=r[4]+u>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},{}],535:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,n=(i=e("./validate.js"))&&i.__esModule?i:{default:i};let s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).substr(1));r.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!(0,n.default)(r))throw TypeError("Stringified UUID is invalid");return r}},{"./validate.js":541}],536:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=s(e("./rng.js")),n=s(e("./stringify.js"));function s(e){return e&&e.__esModule?e:{default:e}}let o,a,l=0,h=0;r.default=function(e,t,r){let s=t&&r||0,u=t||Array(16),c=(e=e||{}).node||o,d=void 0!==e.clockseq?e.clockseq:a;if(null==c||null==d){let t=e.random||(e.rng||i.default)();null==c&&(c=o=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==d&&(d=a=16383&(t[6]<<8|t[7]))}let f=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:h+1,g=f-l+(p-h)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||f>l)&&void 0===e.nsecs&&(p=0),p>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");l=f,h=p,a=d;let m=(1e4*(0xfffffff&(f+=122192928e5))+p)%0x100000000;u[s++]=m>>>24&255,u[s++]=m>>>16&255,u[s++]=m>>>8&255,u[s++]=255&m;let v=f/0x100000000*1e4&0xfffffff;u[s++]=v>>>8&255,u[s++]=255&v,u[s++]=v>>>24&15|16,u[s++]=v>>>16&255,u[s++]=d>>>8|128,u[s++]=255&d;for(let e=0;e<6;++e)u[s+e]=c[e];return t||(0,n.default)(u)}},{"./rng.js":533,"./stringify.js":535}],537:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=s(e("./v35.js")),n=s(e("./md5.js"));function s(e){return e&&e.__esModule?e:{default:e}}var o=(0,i.default)("v3",48,n.default);r.default=o},{"./md5.js":529,"./v35.js":538}],538:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){function s(e,s,o,a){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof s&&(s=(0,n.default)(s)),16!==s.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+e.length);if(l.set(s),l.set(e,s.length),(l=r(l))[6]=15&l[6]|t,l[8]=63&l[8]|128,o){a=a||0;for(let e=0;e<16;++e)o[a+e]=l[e];return o}return(0,i.default)(l)}try{s.name=e}catch(e){}return s.DNS=o,s.URL=a,s},r.URL=r.DNS=void 0;var i=s(e("./stringify.js")),n=s(e("./parse.js"));function s(e){return e&&e.__esModule?e:{default:e}}let o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=o;let a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=a},{"./parse.js":531,"./stringify.js":535}],539:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=s(e("./rng.js")),n=s(e("./stringify.js"));function s(e){return e&&e.__esModule?e:{default:e}}r.default=function(e,t,r){let s=(e=e||{}).random||(e.rng||i.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return(0,n.default)(s)}},{"./rng.js":533,"./stringify.js":535}],540:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=s(e("./v35.js")),n=s(e("./sha1.js"));function s(e){return e&&e.__esModule?e:{default:e}}var o=(0,i.default)("v5",80,n.default);r.default=o},{"./sha1.js":534,"./v35.js":538}],541:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,n=(i=e("./regex.js"))&&i.__esModule?i:{default:i};r.default=function(e){return"string"==typeof e&&n.default.test(e)}},{"./regex.js":532}],542:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,n=(i=e("./validate.js"))&&i.__esModule?i:{default:i};r.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},{"./validate.js":541}],543:[function(e,t,r){"use strict";function i(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(r,"__esModule",{value:!0}),r.CHAR="	\n\r --\ud800\udc00-\udbff\udfff",r.S=" 	\r\n",r.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8--------\ud800\udc00-\udb7f\udfff",r.NAME_CHAR="-"+r.NAME_START_CHAR+".0-9\xb7--",r.CHAR_RE=RegExp("^["+r.CHAR+"]$","u"),r.S_RE=RegExp("^["+r.S+"]+$","u"),r.NAME_START_CHAR_RE=RegExp("^["+r.NAME_START_CHAR+"]$","u"),r.NAME_CHAR_RE=RegExp("^["+r.NAME_CHAR+"]$","u"),r.NAME_RE=RegExp("^["+r.NAME_START_CHAR+"]["+r.NAME_CHAR+"]*$","u"),r.NMTOKEN_RE=RegExp("^["+r.NAME_CHAR+"]+$","u"),r.S_LIST=[32,10,13,9],r.isChar=function(e){return e>=32&&e<=55295||10===e||13===e||9===e||e>=57344&&e<=65533||e>=65536&&e<=1114111},r.isS=function(e){return 32===e||10===e||13===e||9===e},r.isNameStartChar=i,r.isNameChar=function(e){return i(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},{}],544:[function(e,t,r){"use strict";function i(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(r,"__esModule",{value:!0}),r.CHAR="\x01--\ud800\udc00-\udbff\udfff",r.RESTRICTED_CHAR="\x01-\b\v\f\x0e-\x1f\x7f-\x84\x86-\x9f",r.S=" 	\r\n",r.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8--------\ud800\udc00-\udb7f\udfff",r.NAME_CHAR="-"+r.NAME_START_CHAR+".0-9\xb7--",r.CHAR_RE=RegExp("^["+r.CHAR+"]$","u"),r.RESTRICTED_CHAR_RE=RegExp("^["+r.RESTRICTED_CHAR+"]$","u"),r.S_RE=RegExp("^["+r.S+"]+$","u"),r.NAME_START_CHAR_RE=RegExp("^["+r.NAME_START_CHAR+"]$","u"),r.NAME_CHAR_RE=RegExp("^["+r.NAME_CHAR+"]$","u"),r.NAME_RE=RegExp("^["+r.NAME_START_CHAR+"]["+r.NAME_CHAR+"]*$","u"),r.NMTOKEN_RE=RegExp("^["+r.NAME_CHAR+"]+$","u"),r.S_LIST=[32,10,13,9],r.isChar=function(e){return e>=1&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},r.isRestrictedChar=function(e){return e>=1&&e<=8||11===e||12===e||e>=14&&e<=31||e>=127&&e<=132||e>=134&&e<=159},r.isCharAndNotRestricted=function(e){return 9===e||10===e||13===e||e>31&&e<127||133===e||e>159&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},r.isS=function(e){return 32===e||10===e||13===e||9===e},r.isNameStartChar=i,r.isNameChar=function(e){return i(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},{}],545:[function(e,t,r){"use strict";function i(e){return e>=65&&e<=90||95===e||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(r,"__esModule",{value:!0}),r.NC_NAME_START_CHAR="A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8---------\ud800\udc00-\udb7f\udfff",r.NC_NAME_CHAR="-"+r.NC_NAME_START_CHAR+".0-9\xb7--",r.NC_NAME_START_CHAR_RE=RegExp("^["+r.NC_NAME_START_CHAR+"]$","u"),r.NC_NAME_CHAR_RE=RegExp("^["+r.NC_NAME_CHAR+"]$","u"),r.NC_NAME_RE=RegExp("^["+r.NC_NAME_START_CHAR+"]["+r.NC_NAME_CHAR+"]*$","u"),r.isNCNameStartChar=i,r.isNCNameChar=function(e){return i(e)||45===e||46===e||e>=48&&e<=57||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},{}]},{},[15])(15)},e.exports=i()},450:function(e,t,r){"use strict";function i(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}r.d(t,{p8:()=>iz});var s,o,a,l,h,u,c,d,f,p,g,m,v,b,y,x,_,S,w,T,P,E,C,A,I,M,R,O,k,N,L={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},D={duration:.5,overwrite:!1,delay:0},B=1e-8,F=2*Math.PI,V=F/4,G=0,U=Math.sqrt,z=Math.cos,j=Math.sin,H=function(e){return"string"==typeof e},W=function(e){return"function"==typeof e},q=function(e){return"number"==typeof e},X=function(e){return void 0===e},$=function(e){return"object"==typeof e},Y=function(e){return!1!==e},Z=function(){return"undefined"!=typeof window},K=function(e){return W(e)||H(e)},J="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Q=Array.isArray,ee=/(?:-?\.?\d|\.)+/gi,et=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,er=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ei=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,en=/[+-]=-?[.\d]+/,es=/[^,'"\[\]\s]+/gi,eo=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ea={},el={},eh=function(e){return(el=eF(e,ea))&&rO},eu=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},ec=function(e,t){return!t&&console.warn(e)},ed=function(e,t){return e&&(ea[e]=t)&&el&&(el[e]=t)||ea},ef=function(){return 0},ep={suppressEvents:!0,isStart:!0,kill:!1},eg={suppressEvents:!0,kill:!1},em={suppressEvents:!0},ev={},eb=[],ey={},ex={},e_={},eS=30,ew=[],eT="",eP=function(e){var t,r,i=e[0];if($(i)||W(i)||(e=[e]),!(t=(i._gsap||{}).harness)){for(r=ew.length;r--&&!ew[r].targetTest(i););t=ew[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new tq(e[r],t)))||e.splice(r,1);return e},eE=function(e){return e._gsap||eP(tl(e))[0]._gsap},eC=function(e,t,r){return(r=e[t])&&W(r)?e[t]():X(r)&&e.getAttribute&&e.getAttribute(t)||r},eA=function(e,t){return(e=e.split(",")).forEach(t)||e},eI=function(e){return Math.round(1e5*e)/1e5||0},eM=function(e){return Math.round(1e7*e)/1e7||0},eR=function(e,t){var r=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),"+"===r?e+i:"-"===r?e-i:"*"===r?e*i:e/i},eO=function(e,t){for(var r=t.length,i=0;0>e.indexOf(t[i])&&++i<r;);return i<r},ek=function(){var e,t,r=eb.length,i=eb.slice(0);for(e=0,ey={},eb.length=0;e<r;e++)(t=i[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},eN=function(e,t,r,i){eb.length&&!P&&ek(),e.render(t,r,i||P&&t<0&&(e._initted||e._startAt)),eb.length&&!P&&ek()},eL=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(es).length<2?t:H(e)?e.trim():e},eD=function(e){return e},eB=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},eF=function(e,t){for(var r in t)e[r]=t[r];return e},eV=function e(t,r){for(var i in r)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(t[i]=$(r[i])?e(t[i]||(t[i]={}),r[i]):r[i]);return t},eG=function(e,t){var r,i={};for(r in e)r in t||(i[r]=e[r]);return i},eU=function(e){var t,r=e.parent||C,i=e.keyframes?(t=Q(e.keyframes),function(e,r){for(var i in r)i in e||"duration"===i&&t||"ease"===i||(e[i]=r[i])}):eB;if(Y(e.inherit))for(;r;)i(e,r.vars.defaults),r=r.parent||r._dp;return e},ez=function(e,t){for(var r=e.length,i=r===t.length;i&&r--&&e[r]===t[r];);return r<0},ej=function(e,t,r,i,n){void 0===r&&(r="_first"),void 0===i&&(i="_last");var s,o=e[i];if(n)for(s=t[n];o&&o[n]>s;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[i]=t,t._prev=o,t.parent=t._dp=e,t},eH=function(e,t,r,i){void 0===r&&(r="_first"),void 0===i&&(i="_last");var n=t._prev,s=t._next;n?n._next=s:e[r]===t&&(e[r]=s),s?s._prev=n:e[i]===t&&(e[i]=n),t._next=t._prev=t.parent=null},eW=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},eq=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0)){for(var r=e;r;)r._dirty=1,r=r.parent}return e},eX=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},e$=function(e,t,r,i){return e._startAt&&(P?e._startAt.revert(eg):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},eY=function(e){return e._repeat?eZ(e._tTime,e=e.duration()+e._rDelay)*e:0},eZ=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},eK=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},eJ=function(e){return e._end=eM(e._start+(e._tDur/Math.abs(e._ts||e._rts||B)||0))},eQ=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=eM(r._time-(e._ts>0?t/e._ts:-(((e._dirty?e.totalDuration():e._tDur)-t)/e._ts))),eJ(e),r._dirty||eq(r,e)),e},e1=function(e,t){var r;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(r=eK(e.rawTime(),t),(!t._dur||tn(0,t.totalDuration(),r)-t._tTime>B)&&t.render(r,!0)),eq(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-B}},e0=function(e,t,r,i){return t.parent&&eW(t),t._start=eM((q(r)?r:r||e!==C?tt(e,r,t):e._time)+t._delay),t._end=eM(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),ej(e,t,"_first","_last",e._sort?"_start":0),e6(t)||(e._recent=t),i||e1(e,t),e._ts<0&&eQ(e,e._tTime),e},e2=function(e,t){return(ea.ScrollTrigger||eu("scrollTrigger",t))&&ea.ScrollTrigger.create(t,e)},e3=function(e,t,r,i,n){return(t9(e,t,n),e._initted)?!r&&e._pt&&!P&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&O!==tR.frame?(eb.push(e),e._lazy=[n,i],1):void 0:1},e5=function e(t){var r=t.parent;return r&&r._ts&&r._initted&&!r._lock&&(0>r.rawTime()||e(r))},e6=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},e4=function(e,t,r,i){var n,s,o,a=e.ratio,l=t<0||!t&&(!e._start&&e5(e)&&!(!e._initted&&e6(e))||(e._ts<0||e._dp._ts<0)&&!e6(e))?0:1,h=e._rDelay,u=0;if(h&&e._repeat&&(s=eZ(u=tn(0,e._tDur,t),h),e._yoyo&&1&s&&(l=1-l),s!==eZ(e._tTime,h)&&(a=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==a||P||i||e._zTime===B||!t&&e._zTime){if(!e._initted&&e3(e,t,i,r,u))return;for(o=e._zTime,e._zTime=t||(r?B:0),r||(r=t&&!o),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=u,n=e._pt;n;)n.r(l,n.d),n=n._next;t<0&&e$(e,t,r,!0),e._onUpdate&&!r&&ty(e,"onUpdate"),u&&e._repeat&&!r&&e.parent&&ty(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&eW(e,1),!r&&!P&&(ty(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else!e._zTime&&(e._zTime=t)},e9=function(e,t,r){var i;if(r>t)for(i=e._first;i&&i._start<=r;){if("isPause"===i.data&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=r;){if("isPause"===i.data&&i._start<t)return i;i=i._prev}},e8=function(e,t,r,i){var n=e._repeat,s=eM(t)||0,o=e._tTime/e._tDur;return o&&!i&&(e._time*=s/e._dur),e._dur=s,e._tDur=n?n<0?1e10:eM(s*(n+1)+e._rDelay*n):s,o>0&&!i&&eQ(e,e._tTime=e._tDur*o),e.parent&&eJ(e),r||eq(e.parent,e),e},e7=function(e){return e instanceof t$?eq(e):e8(e,e._dur)},te={_start:0,endTime:ef,totalDuration:ef},tt=function e(t,r,i){var n,s,o,a=t.labels,l=t._recent||te,h=t.duration()>=1e8?l.endTime(!1):t._dur;if(H(r)&&(isNaN(r)||r in a))return(s=r.charAt(0),o="%"===r.substr(-1),n=r.indexOf("="),"<"===s||">"===s)?(n>=0&&(r=r.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(r.substr(1))||0)*(o?(n<0?l:i).totalDuration()/100:1)):n<0?(r in a||(a[r]=h),a[r]):(s=parseFloat(r.charAt(n-1)+r.substr(n+1)),o&&i&&(s=s/100*(Q(i)?i[0]:i).totalDuration()),n>1?e(t,r.substr(0,n-1),i)+s:h+s);return null==r?h:+r},tr=function(e,t,r){var i,n,s=q(t[1]),o=(s?2:1)+(e<2?0:1),a=t[o];if(s&&(a.duration=t[1]),a.parent=r,e){for(i=a,n=r;n&&!("immediateRender"in i);)i=n.vars.defaults||{},n=Y(n.vars.inherit)&&n.parent;a.immediateRender=Y(i.immediateRender),e<2?a.runBackwards=1:a.startAt=t[o-1]}return new rn(t[0],a,t[o+1])},ti=function(e,t){return e||0===e?t(e):t},tn=function(e,t,r){return r<e?e:r>t?t:r},ts=function(e,t){return H(e)&&(t=eo.exec(e))?t[1]:""},to=[].slice,ta=function(e,t){return e&&$(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&$(e[0]))&&!e.nodeType&&e!==A},tl=function(e,t,r){var i,n,s;return E&&!t&&E.selector?E.selector(e):H(e)&&!r&&(I||!tO())?to.call((t||M).querySelectorAll(e),0):Q(e)?(i=e,n=r,void 0===s&&(s=[]),i.forEach(function(e){var t;return H(e)&&!n||ta(e,1)?(t=s).push.apply(t,tl(e)):s.push(e)})||s):ta(e)?to.call(e,0):e?[e]:[]},th=function(e){return e=tl(e)[0]||ec("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return tl(t,r.querySelectorAll?r:r===e?ec("Invalid scope")||M.createElement("div"):e)}},tu=function(e){return e.sort(function(){return .5-Math.random()})},tc=function(e){if(W(e))return e;var t=$(e)?e:{each:e},r=tU(t.ease),i=t.from||0,n=parseFloat(t.base)||0,s={},o=i>0&&i<1,a=isNaN(i)||o,l=t.axis,h=i,u=i;return H(i)?h=u=({center:.5,edges:.5,end:1})[i]||0:!o&&a&&(h=i[0],u=i[1]),function(e,o,c){var d,f,p,g,m,v,b,y,x,_=(c||t).length,S=s[_];if(!S){if(!(x="auto"===t.grid?0:(t.grid||[1,1e8])[1])){for(b=-1e8;b<(b=c[x++].getBoundingClientRect().left)&&x<_;);x<_&&x--}for(v=0,S=s[_]=[],d=a?Math.min(x,_)*h-.5:i%x,f=1e8===x?0:a?_*u/x-.5:i/x|0,b=0,y=1e8;v<_;v++)p=v%x-d,g=f-(v/x|0),S[v]=m=l?Math.abs("y"===l?g:p):U(p*p+g*g),m>b&&(b=m),m<y&&(y=m);"random"===i&&tu(S),S.max=b-y,S.min=y,S.v=_=(parseFloat(t.amount)||parseFloat(t.each)*(x>_?_-1:l?"y"===l?_/x:x:Math.max(x,_/x))||0)*("edges"===i?-1:1),S.b=_<0?n-_:n,S.u=ts(t.amount||t.each)||0,r=r&&_<0?tV(r):r}return _=(S[e]-S.min)/S.max||0,eM(S.b+(r?r(_):_)*S.v)+S.u}},td=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var i=eM(Math.round(parseFloat(r)/e)*e*t);return(i-i%1)/t+(q(r)?0:ts(r))}},tf=function(e,t){var r,i,n=Q(e);return!n&&$(e)&&(r=n=e.radius||1e8,e.values?(i=!q((e=tl(e.values))[0]))&&(r*=r):e=td(e.increment)),ti(t,n?W(e)?function(t){return Math.abs((i=e(t))-t)<=r?i:t}:function(t){for(var n,s,o=parseFloat(i?t.x:t),a=parseFloat(i?t.y:0),l=1e8,h=0,u=e.length;u--;)i?(n=e[u].x-o,n=n*n+(s=e[u].y-a)*s):n=Math.abs(e[u]-o),n<l&&(l=n,h=u);return h=!r||l<=r?e[h]:t,i||h===t||q(t)?h:h+ts(t)}:td(e))},tp=function(e,t,r,i){return ti(Q(e)?!t:!0===r?(r=0,!1):!i,function(){return Q(e)?e[~~(Math.random()*e.length)]:(i=(r=r||1e-5)<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+.99*r))/r)*r*i)/i})},tg=function(e,t,r){return ti(r,function(r){return e[~~t(r)]})},tm=function(e){for(var t,r,i,n,s=0,o="";~(t=e.indexOf("random(",s));)i=e.indexOf(")",t),n="["===e.charAt(t+7),r=e.substr(t+7,i-t-7).match(n?es:ee),o+=e.substr(s,t-s)+tp(n?r:+r[0],n?0:+r[1],+r[2]||1e-5),s=i+1;return o+e.substr(s,e.length-s)},tv=function(e,t,r,i,n){var s=t-e,o=i-r;return ti(n,function(t){return r+((t-e)/s*o||0)})},tb=function(e,t,r){var i,n,s,o=e.labels,a=1e8;for(i in o)(n=o[i]-t)<0==!!r&&n&&a>(n=Math.abs(n))&&(s=i,a=n);return s},ty=function(e,t,r){var i,n,s,o=e.vars,a=o[t],l=E,h=e._ctx;if(!!a)return i=o[t+"Params"],n=o.callbackScope||e,r&&eb.length&&ek(),h&&(E=h),s=i?a.apply(n,i):a.call(n),E=l,s},tx=function(e){return eW(e),e.scrollTrigger&&e.scrollTrigger.kill(!!P),1>e.progress()&&ty(e,"onInterrupt"),e},t_=[],tS=function(e){if(e){if(e=!e.name&&e.default||e,Z()||e.headless){var t=e.name,r=W(e),i=t&&!r&&e.init?function(){this._props=[]}:e,n={init:ef,render:rf,add:t5,kill:rg,modifier:rp,rawVars:0},s={targetTest:0,get:0,getSetter:rh,aliases:{},register:0};if(tO(),e!==i){if(ex[t])return;eB(i,eB(eG(e,n),s)),eF(i.prototype,eF(n,eG(e,s))),ex[i.prop=t]=i,e.targetTest&&(ew.push(i),ev[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}ed(t,i),e.register&&e.register(rO,i,rb)}else t_.push(e)}},tw={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},tT=function(e,t,r){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(r-t)*e*6:e<.5?r:3*e<2?t+(r-t)*(2/3-e)*6:t)*255+.5|0},tP=function(e,t,r){var i,n,s,o,a,l,h,u,c,d,f=e?q(e)?[e>>16,e>>8&255,255&e]:0:tw.black;if(!f){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),tw[e])f=tw[e];else if("#"===e.charAt(0)){if(e.length<6&&(i=e.charAt(1),n=e.charAt(2),e="#"+i+i+n+n+(s=e.charAt(3))+s+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(f=parseInt(e.substr(1,6),16))>>16,f>>8&255,255&f,parseInt(e.substr(7),16)/255];f=[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]}else if("hsl"===e.substr(0,3)){if(f=d=e.match(ee),t){if(~e.indexOf("="))return f=e.match(et),r&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,a=+f[1]/100,n=(l=+f[2]/100)<=.5?l*(a+1):l+a-l*a,i=2*l-n,f.length>3&&(f[3]*=1),f[0]=tT(o+1/3,i,n),f[1]=tT(o,i,n),f[2]=tT(o-1/3,i,n)}else f=e.match(ee)||tw.transparent;f=f.map(Number)}return t&&!d&&(i=f[0]/255,n=f[1]/255,h=Math.max(i,n,s=f[2]/255),l=(h+(u=Math.min(i,n,s)))/2,h===u?o=a=0:(c=h-u,a=l>.5?c/(2-h-u):c/(h+u),o=(h===i?(n-s)/c+(n<s?6:0):h===n?(s-i)/c+2:(i-n)/c+4)*60),f[0]=~~(o+.5),f[1]=~~(100*a+.5),f[2]=~~(100*l+.5)),r&&f.length<4&&(f[3]=1),f},tE=function(e){var t=[],r=[],i=-1;return e.split(tA).forEach(function(e){var n=e.match(er)||[];t.push.apply(t,n),r.push(i+=n.length+1)}),t.c=r,t},tC=function(e,t,r){var i,n,s,o,a="",l=(e+a).match(tA),h=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map(function(e){return(e=tP(e,t,1))&&h+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"}),r&&(s=tE(e),(i=r.c).join(a)!==s.c.join(a)))for(o=(n=e.replace(tA,"1").split(er)).length-1;u<o;u++)a+=n[u]+(~i.indexOf(u)?l.shift()||h+"0,0,0,0)":(s.length?s:l.length?l:r).shift());if(!n)for(o=(n=e.split(tA)).length-1;u<o;u++)a+=n[u]+l[u];return a+n[o]},tA=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in tw)t+="|"+e+"\\b";return RegExp(t+")","gi")}(),tI=/hsl[a]?\(/,tM=function(e){var t,r=e.join(" ");if(tA.lastIndex=0,tA.test(r))return t=tI.test(r),e[1]=tC(e[1],t),e[0]=tC(e[0],t,tE(e[1])),!0},tR=(g=Date.now,m=500,v=33,y=b=g(),x=1e3/240,_=1e3/240,S=[],w=function e(t){var r,i,n,s,o=g()-y,a=!0===t;if((o>m||o<0)&&(b+=o-v),y+=o,((r=(n=y-b)-_)>0||a)&&(s=++d.frame,f=n-1e3*d.time,d.time=n/=1e3,_+=r+(r>=x?4:x-r),i=1),a||(h=u(e)),i)for(p=0;p<S.length;p++)S[p](n,f,s,t)},d={time:0,frame:0,tick:function(){w(!0)},deltaRatio:function(e){return f/(1e3/(e||60))},wake:function(){R&&(!I&&Z()&&(M=(A=I=window).document||{},ea.gsap=rO,(A.gsapVersions||(A.gsapVersions=[])).push(rO.version),eh(el||A.GreenSockGlobals||!A.gsap&&A||{}),t_.forEach(tS)),c="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,h&&d.sleep(),u=c||function(e){return setTimeout(e,_-1e3*d.time+1|0)},N=1,w(2))},sleep:function(){(c?cancelAnimationFrame:clearTimeout)(h),N=0,u=ef},lagSmoothing:function(e,t){v=Math.min(t||33,m=e||1/0)},fps:function(e){x=1e3/(e||240),_=1e3*d.time+x},add:function(e,t,r){var i=t?function(t,r,n,s){e(t,r,n,s),d.remove(i)}:e;return d.remove(e),S[r?"unshift":"push"](i),tO(),i},remove:function(e,t){~(t=S.indexOf(e))&&S.splice(t,1)&&p>=t&&p--},_listeners:S}),tO=function(){return!N&&tR.wake()},tk={},tN=/^[\d.\-M][\d.\-,\s]/,tL=/["']/g,tD=function(e){for(var t,r,i,n={},s=e.substr(1,e.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)r=s[a],t=a!==l-1?r.lastIndexOf(","):r.length,i=r.substr(0,t),n[o]=isNaN(i)?i.replace(tL,"").trim():+i,o=r.substr(t+1).trim();return n},tB=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<r?e.indexOf(")",r+1):r)},tF=function(e){var t=(e+"").split("("),r=tk[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[tD(t[1])]:tB(e).split(",").map(eL)):tk._CE&&tN.test(e)?tk._CE("",e):r},tV=function(e){return function(t){return 1-e(1-t)}},tG=function e(t,r){for(var i,n=t._first;n;)n instanceof t$?e(n,r):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==r&&(n.timeline?e(n.timeline,r):(i=n._ease,n._ease=n._yEase,n._yEase=i,n._yoyo=r)),n=n._next},tU=function(e,t){return e&&(W(e)?e:tk[e]||tF(e))||t},tz=function(e,t,r,i){void 0===r&&(r=function(e){return 1-t(1-e)}),void 0===i&&(i=function(e){return e<.5?t(2*e)/2:1-t((1-e)*2)/2});var n,s={easeIn:t,easeOut:r,easeInOut:i};return eA(e,function(e){for(var t in tk[e]=ea[e]=s,tk[n=e.toLowerCase()]=r,s)tk[n+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=tk[e+"."+t]=s[t]}),s},tj=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e((t-.5)*2)/2}},tH=function e(t,r,i){var n=r>=1?r:1,s=(i||(t?.3:.45))/(r<1?r:1),o=s/F*(Math.asin(1/n)||0),a=function(e){return 1===e?1:n*Math.pow(2,-10*e)*j((e-o)*s)+1},l="out"===t?a:"in"===t?function(e){return 1-a(1-e)}:tj(a);return s=F/s,l.config=function(r,i){return e(t,r,i)},l},tW=function e(t,r){void 0===r&&(r=1.70158);var i=function(e){return e?--e*e*((r+1)*e+r)+1:0},n="out"===t?i:"in"===t?function(e){return 1-i(1-e)}:tj(i);return n.config=function(r){return e(t,r)},n};eA("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var r=t<5?t+1:t;tz(e+",Power"+(r-1),t?function(e){return Math.pow(e,r)}:function(e){return e},function(e){return 1-Math.pow(1-e,r)},function(e){return e<.5?Math.pow(2*e,r)/2:1-Math.pow((1-e)*2,r)/2})}),tk.Linear.easeNone=tk.none=tk.Linear.easeIn,tz("Elastic",tH("in"),tH("out"),tH()),tY=7.5625,tZ=2.75,tJ=2*(tK=1/2.75),tQ=2.5*tK,tz("Bounce",function(e){return 1-t1(1-e)},t1=function(e){return e<tK?7.5625*e*e:e<tJ?tY*Math.pow(e-1.5/tZ,2)+.75:e<tQ?tY*(e-=2.25/tZ)*e+.9375:tY*Math.pow(e-2.625/tZ,2)+.984375}),tz("Expo",function(e){return e?Math.pow(2,10*(e-1)):0}),tz("Circ",function(e){return-(U(1-e*e)-1)}),tz("Sine",function(e){return 1===e?1:-z(e*V)+1}),tz("Back",tW("in"),tW("out"),tW()),tk.SteppedEase=tk.steps=ea.SteppedEase={config:function(e,t){void 0===e&&(e=1);var r=1/e,i=e+(t?0:1),n=t?1:0,s=1-B;return function(e){return((i*tn(0,s,e)|0)+n)*r}}},D.ease=tk["quad.out"],eA("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return eT+=e+","+e+"Params,"});var tq=function(e,t){this.id=G++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:eC,this.set=t?t.getSetter:rh},tX=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,e8(this,+e.duration,1,1),this.data=e.data,E&&(this._ctx=E,E.data.push(this)),N||tR.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,e8(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(tO(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(eQ(this,e),!r._dp||r.parent||e1(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:-((r.totalDuration()-r._tTime)/r._ts))&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&e0(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===B||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),eN(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+eY(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(1&this.iteration())?1-e:e)+eY(this),t):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(e,t){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*r,t):this._repeat?eZ(this._tTime,r)+1:1},t.timeScale=function(e,t){if(!arguments.length)return this._rts===-B?0:this._rts;if(this._rts===e)return this;var r=this.parent&&this._ts?eK(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||e===-B?0:this._rts,this.totalTime(tn(-Math.abs(this._delay),this._tDur,r),!1!==t),eJ(this),eX(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(tO(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==B&&(this._tTime-=B)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&e0(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(Y(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&1>this.totalProgress())?this._tTime%(this._dur+this._rDelay):this._ts?eK(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=em);var t=P;return P=e,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),P=t,this},t.globalTime=function(e){for(var t=this,r=arguments.length?e:t.rawTime();t;)r=t._start+r/(Math.abs(t._ts)||1),t=t._dp;return!this.parent&&this._sat?this._sat.globalTime(e):r},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,e7(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,e7(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(tt(this,e),Y(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,Y(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-B:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-B,this},t.isActive=function(){var e,t=this.parent||this._dp,r=this._start;return!!(!t||this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=r&&e<this.endTime(!0)-B)},t.eventCallback=function(e,t,r){var i=this.vars;return arguments.length>1?(t?(i[e]=t,r&&(i[e+"Params"]=r),"onUpdate"===e&&(this._onUpdate=t)):delete i[e],this):i[e]},t.then=function(e){var t=this;return new Promise(function(r){var i=W(e)?e:eD,n=function(){var e=t.then;t.then=null,W(i)&&(i=i(t))&&(i.then||i===t)&&(t.then=e),r(i),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?n():t._prom=n})},t.kill=function(){tx(this)},e}();eB(tX.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-B,_prom:0,_ps:!1,_rts:1});var t$=function(e){function t(t,r){var n;return void 0===t&&(t={}),(n=e.call(this,t)||this).labels={},n.smoothChildTiming=!!t.smoothChildTiming,n.autoRemoveChildren=!!t.autoRemoveChildren,n._sort=Y(t.sortChildren),C&&e0(t.parent||C,i(n),r),t.reversed&&n.reverse(),t.paused&&n.paused(!0),t.scrollTrigger&&e2(i(n),t.scrollTrigger),n}n(t,e);var r=t.prototype;return r.to=function(e,t,r){return tr(0,arguments,this),this},r.from=function(e,t,r){return tr(1,arguments,this),this},r.fromTo=function(e,t,r,i){return tr(2,arguments,this),this},r.set=function(e,t,r){return t.duration=0,t.parent=this,eU(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new rn(e,t,tt(this,r),1),this},r.call=function(e,t,r){return e0(this,rn.delayedCall(0,e,t),r)},r.staggerTo=function(e,t,r,i,n,s,o){return r.duration=t,r.stagger=r.stagger||i,r.onComplete=s,r.onCompleteParams=o,r.parent=this,new rn(e,r,tt(this,n)),this},r.staggerFrom=function(e,t,r,i,n,s,o){return r.runBackwards=1,eU(r).immediateRender=Y(r.immediateRender),this.staggerTo(e,t,r,i,n,s,o)},r.staggerFromTo=function(e,t,r,i,n,s,o,a){return i.startAt=r,eU(i).immediateRender=Y(i.immediateRender),this.staggerTo(e,t,i,n,s,o,a)},r.render=function(e,t,r){var i,n,s,o,a,l,h,u,c,d,f,p,g=this._time,m=this._dirty?this.totalDuration():this._tDur,v=this._dur,b=e<=0?0:eM(e),y=this._zTime<0!=e<0&&(this._initted||!v);if(this!==C&&b>m&&e>=0&&(b=m),b!==this._tTime||r||y){if(g!==this._time&&v&&(b+=this._time-g,e+=this._time-g),i=b,c=this._start,l=!(u=this._ts),y&&(v||(g=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(f=this._yoyo,a=v+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*a+e,t,r);if(i=eM(b%a),b===m?(o=this._repeat,i=v):((o=~~(b/a))&&o===b/a&&(i=v,o--),i>v&&(i=v)),d=eZ(this._tTime,a),!g&&this._tTime&&d!==o&&this._tTime-d*a-this._dur<=0&&(d=o),f&&1&o&&(i=v-i,p=1),o!==d&&!this._lock){var x=f&&1&d,_=x===(f&&1&o);if(o<d&&(x=!x),g=x?0:b%v?v:b,this._lock=1,this.render(g||(p?0:eM(o*a)),t,!v)._lock=0,this._tTime=b,!t&&this.parent&&ty(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),g&&g!==this._time||!this._ts!==l||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,m=this._tDur,_&&(this._lock=2,g=x?v:-1e-4,this.render(g,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;tG(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(h=e9(this,eM(g),eM(i)))&&(b-=i-(i=h._start)),this._tTime=b,this._time=i,this._act=!u,!this._initted&&(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,g=0),!g&&i&&!t&&!o&&(ty(this,"onStart"),this._tTime!==b))return this;if(i>=g&&e>=0)for(n=this._first;n;){if(s=n._next,(n._act||i>=n._start)&&n._ts&&h!==n){if(n.parent!==this)return this.render(e,t,r);if(n.render(n._ts>0?(i-n._start)*n._ts:(n._dirty?n.totalDuration():n._tDur)+(i-n._start)*n._ts,t,r),i!==this._time||!this._ts&&!l){h=0,s&&(b+=this._zTime=-B);break}}n=s}else{n=this._last;for(var S=e<0?e:i;n;){if(s=n._prev,(n._act||S<=n._end)&&n._ts&&h!==n){if(n.parent!==this)return this.render(e,t,r);if(n.render(n._ts>0?(S-n._start)*n._ts:(n._dirty?n.totalDuration():n._tDur)+(S-n._start)*n._ts,t,r||P&&(n._initted||n._startAt)),i!==this._time||!this._ts&&!l){h=0,s&&(b+=this._zTime=S?-B:B);break}}n=s}}if(h&&!t&&(this.pause(),h.render(i>=g?0:-B)._zTime=i>=g?1:-1,this._ts))return this._start=c,eJ(this),this.render(e,t,r);this._onUpdate&&!t&&ty(this,"onUpdate",!0),(b===m&&this._tTime>=this.totalDuration()||!b&&g)&&(c===this._start||Math.abs(u)!==Math.abs(this._ts))&&!this._lock&&((e||!v)&&(b===m&&this._ts>0||!b&&this._ts<0)&&eW(this,1),!t&&!(e<0&&!g)&&(b||g||!m)&&(ty(this,b===m&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(b<m&&this.timeScale()>0)&&this._prom()))}return this},r.add=function(e,t){var r=this;if(q(t)||(t=tt(this,t,e)),!(e instanceof tX)){if(Q(e))return e.forEach(function(e){return r.add(e,t)}),this;if(H(e))return this.addLabel(e,t);if(!W(e))return this;e=rn.delayedCall(0,e)}return this!==e?e0(this,e,t):this},r.getChildren=function(e,t,r,i){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===r&&(r=!0),void 0===i&&(i=-1e8);for(var n=[],s=this._first;s;)s._start>=i&&(s instanceof rn?t&&n.push(s):(r&&n.push(s),e&&n.push.apply(n,s.getChildren(!0,t,r)))),s=s._next;return n},r.getById=function(e){for(var t=this.getChildren(1,1,1),r=t.length;r--;)if(t[r].vars.id===e)return t[r]},r.remove=function(e){return H(e)?this.removeLabel(e):W(e)?this.killTweensOf(e):(eH(this,e),e===this._recent&&(this._recent=this._last),eq(this))},r.totalTime=function(t,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=eM(tR.time-(this._ts>0?t/this._ts:-((this.totalDuration()-t)/this._ts)))),e.prototype.totalTime.call(this,t,r),this._forcing=0,this):this._tTime},r.addLabel=function(e,t){return this.labels[e]=tt(this,t),this},r.removeLabel=function(e){return delete this.labels[e],this},r.addPause=function(e,t,r){var i=rn.delayedCall(0,t||ef,r);return i.data="isPause",this._hasPause=1,e0(this,i,tt(this,e))},r.removePause=function(e){var t=this._first;for(e=tt(this,e);t;)t._start===e&&"isPause"===t.data&&eW(t),t=t._next},r.killTweensOf=function(e,t,r){for(var i=this.getTweensOf(e,r),n=i.length;n--;)t0!==i[n]&&i[n].kill(e,t);return this},r.getTweensOf=function(e,t){for(var r,i=[],n=tl(e),s=this._first,o=q(t);s;)s instanceof rn?eO(s._targets,n)&&(o?(!t0||s._initted&&s._ts)&&s.globalTime(0)<=t&&s.globalTime(s.totalDuration())>t:!t||s.isActive())&&i.push(s):(r=s.getTweensOf(n,t)).length&&i.push.apply(i,r),s=s._next;return i},r.tweenTo=function(e,t){t=t||{};var r,i=this,n=tt(i,e),s=t,o=s.startAt,a=s.onStart,l=s.onStartParams,h=s.immediateRender,u=rn.to(i,eB({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:n,overwrite:"auto",duration:t.duration||Math.abs((n-(o&&"time"in o?o.time:i._time))/i.timeScale())||B,onStart:function(){if(i.pause(),!r){var e=t.duration||Math.abs((n-(o&&"time"in o?o.time:i._time))/i.timeScale());u._dur!==e&&e8(u,e,0,1).render(u._time,!0,!0),r=1}a&&a.apply(u,l||[])}},t));return h?u.render(0):u},r.tweenFromTo=function(e,t,r){return this.tweenTo(t,eB({startAt:{time:tt(this,e)}},r))},r.recent=function(){return this._recent},r.nextLabel=function(e){return void 0===e&&(e=this._time),tb(this,tt(this,e))},r.previousLabel=function(e){return void 0===e&&(e=this._time),tb(this,tt(this,e),1)},r.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+B)},r.shiftChildren=function(e,t,r){void 0===r&&(r=0);for(var i,n=this._first,s=this.labels;n;)n._start>=r&&(n._start+=e,n._end+=e),n=n._next;if(t)for(i in s)s[i]>=r&&(s[i]+=e);return eq(this)},r.invalidate=function(t){var r=this._first;for(this._lock=0;r;)r.invalidate(t),r=r._next;return e.prototype.invalidate.call(this,t)},r.clear=function(e){void 0===e&&(e=!0);for(var t,r=this._first;r;)t=r._next,this.remove(r),r=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),eq(this)},r.totalDuration=function(e){var t,r,i,n=0,s=this._last,o=1e8;if(arguments.length)return this.timeScale((this._repeat<0?this.duration():this.totalDuration())/(this.reversed()?-e:e));if(this._dirty){for(i=this.parent;s;)t=s._prev,s._dirty&&s.totalDuration(),(r=s._start)>o&&this._sort&&s._ts&&!this._lock?(this._lock=1,e0(this,s,r-s._delay,1)._lock=0):o=r,r<0&&s._ts&&(n-=r,(!i&&!this._dp||i&&i.smoothChildTiming)&&(this._start+=r/this._ts,this._time-=r,this._tTime-=r),this.shiftChildren(-r,!1,-Infinity),o=0),s._end>n&&s._ts&&(n=s._end),s=t;e8(this,this===C&&this._time>n?this._time:n,1,1),this._dirty=0}return this._tDur},t.updateRoot=function(e){if(C._ts&&(eN(C,eK(e,C)),O=tR.frame),tR.frame>=eS){eS+=L.autoSleep||120;var t=C._first;if((!t||!t._ts)&&L.autoSleep&&tR._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||tR.sleep()}}},t}(tX);eB(t$.prototype,{_lock:0,_hasPause:0,_forcing:0});var tY,tZ,tK,tJ,tQ,t1,t0,t2,t3=function(e,t,r,i,n,s,o){var a,l,h,u,c,d,f,p,g=new rb(this._pt,e,t,0,1,rd,null,n),m=0,v=0;for(g.b=r,g.e=i,r+="",i+="",(f=~i.indexOf("random("))&&(i=tm(i)),s&&(s(p=[r,i],e,t),r=p[0],i=p[1]),l=r.match(ei)||[];a=ei.exec(i);)u=a[0],c=i.substring(m,a.index),h?h=(h+1)%5:"rgba("===c.substr(-5)&&(h=1),u!==l[v++]&&(d=parseFloat(l[v-1])||0,g._pt={_next:g._pt,p:c||1===v?c:",",s:d,c:"="===u.charAt(1)?eR(d,u)-d:parseFloat(u)-d,m:h&&h<4?Math.round:0},m=ei.lastIndex);return g.c=m<i.length?i.substring(m,i.length):"",g.fp=o,(en.test(i)||f)&&(g.e=0),this._pt=g,g},t5=function(e,t,r,i,n,s,o,a,l,h){W(i)&&(i=i(n||0,e,s));var u,c=e[t],d="get"!==r?r:W(c)?l?e[t.indexOf("set")||!W(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():c,f=W(c)?l?ra:ro:rs;if(H(i)&&(~i.indexOf("random(")&&(i=tm(i)),"="===i.charAt(1)&&((u=eR(d,i)+(ts(d)||0))||0===u)&&(i=u)),!h||d!==i||t2)return isNaN(d*i)||""===i?(c||t in e||eu(t,i),t3.call(this,e,t,d,i,f,a||L.stringFilter,l)):(u=new rb(this._pt,e,t,+d||0,i-(d||0),"boolean"==typeof c?rc:ru,0,f),l&&(u.fp=l),o&&u.modifier(o,this,e),this._pt=u)},t6=function(e,t,r,i,n){if(W(e)&&(e=rt(e,n,t,r,i)),!$(e)||e.style&&e.nodeType||Q(e)||J(e))return H(e)?rt(e,n,t,r,i):e;var s,o={};for(s in e)o[s]=rt(e[s],n,t,r,i);return o},t4=function(e,t,r,i,n,s){var o,a,l,h;if(ex[e]&&!1!==(o=new ex[e]).init(n,o.rawVars?t[e]:t6(t[e],i,n,s,r),r,i,s)&&(r._pt=a=new rb(r._pt,n,e,0,1,o.render,o,0,o.priority),r!==k))for(l=r._ptLookup[r._targets.indexOf(n)],h=o._props.length;h--;)l[o._props[h]]=a;return o},t9=function e(t,r,i){var n,s,o,a,l,h,u,c,d,f,p,g,m,v=t.vars,b=v.ease,y=v.startAt,x=v.immediateRender,_=v.lazy,S=v.onUpdate,w=v.runBackwards,E=v.yoyoEase,A=v.keyframes,I=v.autoRevert,M=t._dur,R=t._startAt,O=t._targets,k=t.parent,N=k&&"nested"===k.data?k.vars.targets:O,L="auto"===t._overwrite&&!T,F=t.timeline;if(!F||A&&b||(b="none"),t._ease=tU(b,D.ease),t._yEase=E?tV(tU(!0===E?b:E,D.ease)):0,E&&t._yoyo&&!t._repeat&&(E=t._yEase,t._yEase=t._ease,t._ease=E),t._from=!F&&!!v.runBackwards,!F||A&&!v.stagger){if(g=(c=O[0]?eE(O[0]).harness:0)&&v[c.prop],n=eG(v,ev),R&&(R._zTime<0&&R.progress(1),r<0&&w&&x&&!I?R.render(-1,!0):R.revert(w&&M?eg:ep),R._lazy=0),y){if(eW(t._startAt=rn.set(O,eB({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:!R&&Y(_),startAt:null,delay:0,onUpdate:S&&function(){return ty(t,"onUpdate")},stagger:0},y))),t._startAt._dp=0,t._startAt._sat=t,r<0&&(P||!x&&!I)&&t._startAt.revert(eg),x&&M&&r<=0&&i<=0){r&&(t._zTime=r);return}}else if(w&&M&&!R){if(r&&(x=!1),o=eB({overwrite:!1,data:"isFromStart",lazy:x&&!R&&Y(_),immediateRender:x,stagger:0,parent:k},n),g&&(o[c.prop]=g),eW(t._startAt=rn.set(O,o)),t._startAt._dp=0,t._startAt._sat=t,r<0&&(P?t._startAt.revert(eg):t._startAt.render(-1,!0)),t._zTime=r,x){if(!r)return}else e(t._startAt,B,B)}for(s=0,t._pt=t._ptCache=0,_=M&&Y(_)||_&&!M;s<O.length;s++){if(u=(l=O[s])._gsap||eP(O)[s]._gsap,t._ptLookup[s]=f={},ey[u.id]&&eb.length&&ek(),p=N===O?s:N.indexOf(l),c&&!1!==(d=new c).init(l,g||n,t,p,N)&&(t._pt=a=new rb(t._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach(function(e){f[e]=a}),d.priority&&(h=1)),!c||g)for(o in n)ex[o]&&(d=t4(o,n,t,p,l,N))?d.priority&&(h=1):f[o]=a=t5.call(t,l,o,"get",n[o],p,N,0,v.stringFilter);t._op&&t._op[s]&&t.kill(l,t._op[s]),L&&t._pt&&(t0=t,C.killTweensOf(l,f,t.globalTime(r)),m=!t.parent,t0=0),t._pt&&_&&(ey[u.id]=1)}h&&rv(t),t._onInit&&t._onInit(t)}t._onUpdate=S,t._initted=(!t._op||t._pt)&&!m,A&&r<=0&&F.render(1e8,!0,!0)},t8=function(e,t,r,i,n,s,o,a){var l,h,u,c,d=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!d)for(d=e._ptCache[t]=[],u=e._ptLookup,c=e._targets.length;c--;){if((l=u[c][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return t2=1,e.vars[t]="+=0",t9(e,o),t2=0,a?ec(t+" not eligible for reset"):1;d.push(l)}for(c=d.length;c--;)(l=(h=d[c])._pt||h).s=(i||0===i)&&!n?i:l.s+(i||0)+s*l.c,l.c=r-l.s,h.e&&(h.e=eI(r)+ts(h.e)),h.b&&(h.b=l.s+ts(h.b))},t7=function(e,t){var r,i,n,s,o=e[0]?eE(e[0]).harness:0,a=o&&o.aliases;if(!a)return t;for(i in r=eF({},t),a)if(i in r)for(n=(s=a[i].split(",")).length;n--;)r[s[n]]=r[i];return r},re=function(e,t,r,i){var n,s,o=t.ease||i||"power1.inOut";if(Q(t))s=r[e]||(r[e]=[]),t.forEach(function(e,r){return s.push({t:r/(t.length-1)*100,v:e,e:o})});else for(n in t)s=r[n]||(r[n]=[]),"ease"===n||s.push({t:parseFloat(e),v:t[n],e:o})},rt=function(e,t,r,i,n){return W(e)?e.call(t,r,i,n):H(e)&&~e.indexOf("random(")?tm(e):e},rr=eT+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",ri={};eA(rr+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return ri[e]=1});var rn=function(e){function t(t,r,n,s){"number"==typeof r&&(n.duration=r,r=n,n=null);var o,a,l,h,u,c,d,f,p,g=(o=e.call(this,s?r:eU(r))||this).vars,m=g.duration,v=g.delay,b=g.immediateRender,y=g.stagger,x=g.overwrite,_=g.keyframes,S=g.defaults,w=g.scrollTrigger,P=g.yoyoEase,E=r.parent||C,A=(Q(t)||J(t)?q(t[0]):"length"in r)?[t]:tl(t);if(o._targets=A.length?eP(A):ec("GSAP target "+t+" not found. https://gsap.com",!L.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=x,_||y||K(m)||K(v)){if(r=o.vars,(a=o.timeline=new t$({data:"nested",defaults:S||{},targets:E&&"nested"===E.data?E.vars.targets:A})).kill(),a.parent=a._dp=i(o),a._start=0,y||K(m)||K(v)){if(u=A.length,f=y&&tc(y),$(y))for(c in y)~rr.indexOf(c)&&(p||(p={}),p[c]=y[c]);for(l=0;l<u;l++)(h=eG(r,ri)).stagger=0,P&&(h.yoyoEase=P),p&&eF(h,p),d=A[l],h.duration=+rt(m,i(o),l,d,A),h.delay=(+rt(v,i(o),l,d,A)||0)-o._delay,!y&&1===u&&h.delay&&(o._delay=v=h.delay,o._start+=v,h.delay=0),a.to(d,h,f?f(l,d,A):0),a._ease=tk.none;a.duration()?m=v=0:o.timeline=0}else if(_){eU(eB(a.vars.defaults,{ease:"none"})),a._ease=tU(_.ease||r.ease||"none");var I,M,R,O=0;if(Q(_))_.forEach(function(e){return a.to(A,e,">")}),a.duration();else{for(c in h={},_)"ease"===c||"easeEach"===c||re(c,_[c],h,_.easeEach);for(c in h)for(l=0,I=h[c].sort(function(e,t){return e.t-t.t}),O=0;l<I.length;l++)(R={ease:(M=I[l]).e,duration:(M.t-(l?I[l-1].t:0))/100*m})[c]=M.v,a.to(A,R,O),O+=R.duration;a.duration()<m&&a.to({},{duration:m-a.duration()})}}m||o.duration(m=a.duration())}else o.timeline=0;return!0===x&&!T&&(t0=i(o),C.killTweensOf(A),t0=0),e0(E,i(o),n),r.reversed&&o.reverse(),r.paused&&o.paused(!0),(b||!m&&!_&&o._start===eM(E._time)&&Y(b)&&function e(t){return!t||t._ts&&e(t.parent)}(i(o))&&"nested"!==E.data)&&(o._tTime=-B,o.render(Math.max(0,-v)||0)),w&&e2(i(o),w),o}n(t,e);var r=t.prototype;return r.render=function(e,t,r){var i,n,s,o,a,l,h,u,c,d=this._time,f=this._tDur,p=this._dur,g=e<0,m=e>f-B&&!g?f:e<B?0:e;if(p){if(m!==this._tTime||!e||r||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==g){if(i=m,u=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&g)return this.totalTime(100*o+e,t,r);if(i=eM(m%o),m===f?(s=this._repeat,i=p):((s=~~(m/o))&&s===eM(m/o)&&(i=p,s--),i>p&&(i=p)),(l=this._yoyo&&1&s)&&(c=this._yEase,i=p-i),a=eZ(this._tTime,o),i===d&&!r&&this._initted&&s===a)return this._tTime=m,this;s!==a&&(u&&this._yEase&&tG(u,l),this.vars.repeatRefresh&&!l&&!this._lock&&this._time!==o&&this._initted&&(this._lock=r=1,this.render(eM(o*s),!0).invalidate()._lock=0))}if(!this._initted){if(e3(this,g?e:i,r,t,m))return this._tTime=0,this;if(d!==this._time&&!(r&&this.vars.repeatRefresh&&s!==a))return this;if(p!==this._dur)return this.render(e,t,r)}if(this._tTime=m,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=h=(c||this._ease)(i/p),this._from&&(this.ratio=h=1-h),i&&!d&&!t&&!s&&(ty(this,"onStart"),this._tTime!==m))return this;for(n=this._pt;n;)n.r(h,n.d),n=n._next;u&&u.render(e<0?e:u._dur*u._ease(i/this._dur),t,r)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(g&&e$(this,e,t,r),ty(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!t&&this.parent&&ty(this,"onRepeat"),(m===this._tDur||!m)&&this._tTime===m&&(g&&!this._onUpdate&&e$(this,e,!0,!0),(e||!p)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&eW(this,1),!t&&!(g&&!d)&&(m||d||l)&&(ty(this,m===f?"onComplete":"onReverseComplete",!0),this._prom&&!(m<f&&this.timeScale()>0)&&this._prom()))}}else e4(this,e,t,r);return this},r.targets=function(){return this._targets},r.invalidate=function(t){return t&&this.vars.runBackwards||(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(t),e.prototype.invalidate.call(this,t)},r.resetTo=function(e,t,r,i,n){N||tR.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return(this._initted||t9(this,s),t8(this,e,t,r,i,this._ease(s/this._dur),s,n))?this.resetTo(e,t,r,i,1):(eQ(this,0),this.parent||ej(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(e,t){if(void 0===t&&(t="all"),!e&&(!t||"all"===t))return this._lazy=this._pt=0,this.parent?tx(this):this;if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,t0&&!0!==t0.vars.overwrite)._first||tx(this),this.parent&&r!==this.timeline.totalDuration()&&e8(this,this._dur*this.timeline._tDur/r,0,1),this}var i,n,s,o,a,l,h,u=this._targets,c=e?tl(e):u,d=this._ptLookup,f=this._pt;if((!t||"all"===t)&&ez(u,c))return"all"===t&&(this._pt=0),tx(this);for(i=this._op=this._op||[],"all"!==t&&(H(t)&&(a={},eA(t,function(e){return a[e]=1}),t=a),t=t7(u,t)),h=u.length;h--;)if(~c.indexOf(u[h]))for(a in n=d[h],"all"===t?(i[h]=t,o=n,s={}):(s=i[h]=i[h]||{},o=t),o)(l=n&&n[a])&&((!("kill"in l.d)||!0===l.d.kill(a))&&eH(this,l,"_pt"),delete n[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&f&&tx(this),this},t.to=function(e,r){return new t(e,r,arguments[2])},t.from=function(e,t){return tr(1,arguments)},t.delayedCall=function(e,r,i,n){return new t(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:r,onReverseComplete:r,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:n})},t.fromTo=function(e,t,r){return tr(2,arguments)},t.set=function(e,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new t(e,r)},t.killTweensOf=function(e,t,r){return C.killTweensOf(e,t,r)},t}(tX);eB(rn.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),eA("staggerTo,staggerFrom,staggerFromTo",function(e){rn[e]=function(){var t=new t$,r=to.call(arguments,0);return r.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,r)}});var rs=function(e,t,r){return e[t]=r},ro=function(e,t,r){return e[t](r)},ra=function(e,t,r,i){return e[t](i.fp,r)},rl=function(e,t,r){return e.setAttribute(t,r)},rh=function(e,t){return W(e[t])?ro:X(e[t])&&e.setAttribute?rl:rs},ru=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},rc=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},rd=function(e,t){var r=t._pt,i="";if(!e&&t.b)i=t.b;else if(1===e&&t.e)i=t.e;else{for(;r;)i=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+i,r=r._next;i+=t.c}t.set(t.t,t.p,i,t)},rf=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},rp=function(e,t,r,i){for(var n,s=this._pt;s;)n=s._next,s.p===i&&s.modifier(e,t,r),s=n},rg=function(e){for(var t,r,i=this._pt;i;)r=i._next,(i.p!==e||i.op)&&i.op!==e?!i.dep&&(t=1):eH(this,i,"_pt"),i=r;return!t},rm=function(e,t,r,i){i.mSet(e,t,i.m.call(i.tween,r,i.mt),i)},rv=function(e){for(var t,r,i,n,s=e._pt;s;){for(t=s._next,r=i;r&&r.pr>s.pr;)r=r._next;(s._prev=r?r._prev:n)?s._prev._next=s:i=s,(s._next=r)?r._prev=s:n=s,s=t}e._pt=i},rb=function(){function e(e,t,r,i,n,s,o,a,l){this.t=t,this.s=i,this.c=n,this.p=r,this.r=s||ru,this.d=o||this,this.set=a||rs,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,r){this.mSet=this.mSet||this.set,this.set=rm,this.m=e,this.mt=r,this.tween=t},e}();eA(eT+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return ev[e]=1}),ea.TweenMax=ea.TweenLite=rn,ea.TimelineLite=ea.TimelineMax=t$,C=new t$({sortChildren:!1,defaults:D,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),L.stringFilter=tM;var ry=[],rx={},r_=[],rS=0,rw=0,rT=function(e){return(rx[e]||r_).map(function(e){return e()})},rP=function(){var e=Date.now(),t=[];e-rS>2&&(rT("matchMediaInit"),ry.forEach(function(e){var r,i,n,s,o=e.queries,a=e.conditions;for(i in o)(r=A.matchMedia(o[i]).matches)&&(n=1),r!==a[i]&&(a[i]=r,s=1);s&&(e.revert(),n&&t.push(e))}),rT("matchMediaRevert"),t.forEach(function(e){return e.onMatch(e,function(t){return e.add(null,t)})}),rS=e,rT("matchMedia"))},rE=function(){function e(e,t){this.selector=t&&th(t),this.data=[],this._r=[],this.isReverted=!1,this.id=rw++,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,r){W(e)&&(r=t,t=e,e=W);var i=this,n=function(){var e,n=E,s=i.selector;return n&&n!==i&&n.data.push(i),r&&(i.selector=th(r)),E=i,e=t.apply(i,arguments),W(e)&&i._r.push(e),E=n,i.selector=s,i.isReverted=!1,e};return i.last=n,e===W?n(i,function(e){return i.add(null,e)}):e?i[e]=n:n},t.ignore=function(e){var t=E;E=null,e(this),E=t},t.getTweens=function(){var t=[];return this.data.forEach(function(r){return r instanceof e?t.push.apply(t,r.getTweens()):r instanceof rn&&!(r.parent&&"nested"===r.parent.data)&&t.push(r)}),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var r=this;if(e?!function(){for(var t,i=r.getTweens(),n=r.data.length;n--;)"isFlip"===(t=r.data[n]).data&&(t.revert(),t.getChildren(!0,!0,!1).forEach(function(e){return i.splice(i.indexOf(e),1)}));for(i.map(function(e){return{g:e._dur||e._delay||e._sat&&!e._sat.vars.immediateRender?e.globalTime(0):-1/0,t:e}}).sort(function(e,t){return t.g-e.g||-1/0}).forEach(function(t){return t.t.revert(e)}),n=r.data.length;n--;)(t=r.data[n])instanceof t$?"nested"!==t.data&&(t.scrollTrigger&&t.scrollTrigger.revert(),t.kill()):t instanceof rn||!t.revert||t.revert(e);r._r.forEach(function(t){return t(e,r)}),r.isReverted=!0}():this.data.forEach(function(e){return e.kill&&e.kill()}),this.clear(),t){for(var i=ry.length;i--;)ry[i].id===this.id&&ry.splice(i,1)}},t.revert=function(e){this.kill(e||{})},e}(),rC=function(){function e(e){this.contexts=[],this.scope=e,E&&E.data.push(this)}var t=e.prototype;return t.add=function(e,t,r){$(e)||(e={matches:e});var i,n,s,o=new rE(0,r||this.scope),a=o.conditions={};for(n in E&&!o.selector&&(o.selector=E.selector),this.contexts.push(o),t=o.add("onMatch",t),o.queries=e,e)"all"===n?s=1:(i=A.matchMedia(e[n]))&&(0>ry.indexOf(o)&&ry.push(o),(a[n]=i.matches)&&(s=1),i.addListener?i.addListener(rP):i.addEventListener("change",rP));return s&&t(o,function(e){return o.add(null,e)}),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach(function(t){return t.kill(e,!0)})},e}(),rA={registerPlugin:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(e){return tS(e)})},timeline:function(e){return new t$(e)},getTweensOf:function(e,t){return C.getTweensOf(e,t)},getProperty:function(e,t,r,i){H(e)&&(e=tl(e)[0]);var n=eE(e||{}).get,s=r?eD:eL;return"native"===r&&(r=""),e?t?s((ex[t]&&ex[t].get||n)(e,t,r,i)):function(t,r,i){return s((ex[t]&&ex[t].get||n)(e,t,r,i))}:e},quickSetter:function(e,t,r){if((e=tl(e)).length>1){var i=e.map(function(e){return rO.quickSetter(e,t,r)}),n=i.length;return function(e){for(var t=n;t--;)i[t](e)}}e=e[0]||{};var s=ex[t],o=eE(e),a=o.harness&&(o.harness.aliases||{})[t]||t,l=s?function(t){var i=new s;k._pt=0,i.init(e,r?t+r:t,k,0,[e]),i.render(1,i),k._pt&&rf(1,k)}:o.set(e,a);return s?l:function(t){return l(e,a,r?t+r:t,o,1)}},quickTo:function(e,t,r){var i,n=rO.to(e,eF(((i={})[t]="+=0.1",i.paused=!0,i),r||{})),s=function(e,r,i){return n.resetTo(t,e,r,i)};return s.tween=n,s},isTweening:function(e){return C.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=tU(e.ease,D.ease)),eV(D,e||{})},config:function(e){return eV(L,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,i=e.plugins,n=e.defaults,s=e.extendTimeline;(i||"").split(",").forEach(function(e){return e&&!ex[e]&&!ea[e]&&ec(t+" effect requires "+e+" plugin.")}),e_[t]=function(e,t,i){return r(tl(e),eB(t||{},n),i)},s&&(t$.prototype[t]=function(e,r,i){return this.add(e_[t](e,$(r)?r:(i=r)&&{},this),i)})},registerEase:function(e,t){tk[e]=tU(t)},parseEase:function(e,t){return arguments.length?tU(e,t):tk},getById:function(e){return C.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,i,n=new t$(e);for(n.smoothChildTiming=Y(e.smoothChildTiming),C.remove(n),n._dp=0,n._time=n._tTime=C._time,r=C._first;r;)i=r._next,(t||!(!r._dur&&r instanceof rn&&r.vars.onComplete===r._targets[0]))&&e0(n,r,r._start-r._delay),r=i;return e0(C,n,0),n},context:function(e,t){return e?new rE(e,t):E},matchMedia:function(e){return new rC(e)},matchMediaRefresh:function(){return ry.forEach(function(e){var t,r,i=e.conditions;for(r in i)i[r]&&(i[r]=!1,t=1);t&&e.revert()})||rP()},addEventListener:function(e,t){var r=rx[e]||(rx[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=rx[e],i=r&&r.indexOf(t);i>=0&&r.splice(i,1)},utils:{wrap:function e(t,r,i){var n=r-t;return Q(t)?tg(t,e(0,t.length),r):ti(i,function(e){return(n+(e-t)%n)%n+t})},wrapYoyo:function e(t,r,i){var n=r-t,s=2*n;return Q(t)?tg(t,e(0,t.length-1),r):ti(i,function(e){return e=(s+(e-t)%s)%s||0,t+(e>n?s-e:e)})},distribute:tc,random:tp,snap:tf,normalize:function(e,t,r){return tv(e,t,0,1,r)},getUnit:ts,clamp:function(e,t,r){return ti(r,function(r){return tn(e,t,r)})},splitColor:tP,toArray:tl,selector:th,mapRange:tv,pipe:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce(function(e,t){return t(e)},e)}},unitize:function(e,t){return function(r){return e(parseFloat(r))+(t||ts(r))}},interpolate:function e(t,r,i,n){var s=isNaN(t+r)?0:function(e){return(1-e)*t+e*r};if(!s){var o,a,l,h,u,c=H(t),d={};if(!0===i&&(n=1)&&(i=null),c)t={p:t},r={p:r};else if(Q(t)&&!Q(r)){for(a=1,l=[],u=(h=t.length)-2;a<h;a++)l.push(e(t[a-1],t[a]));h--,s=function(e){var t=Math.min(u,~~(e*=h));return l[t](e-t)},i=r}else!n&&(t=eF(Q(t)?[]:{},t));if(!l){for(o in r)t5.call(d,t,o,"get",r[o]);s=function(e){return rf(e,d)||(c?t.p:t)}}}return ti(i,s)},shuffle:tu},install:eh,effects:e_,ticker:tR,updateRoot:t$.updateRoot,plugins:ex,globalTimeline:C,core:{PropTween:rb,globals:ed,Tween:rn,Timeline:t$,Animation:tX,getCache:eE,_removeLinkedListItem:eH,reverting:function(){return P},context:function(e){return e&&E&&(E.data.push(e),e._ctx=E),E},suppressOverwrites:function(e){return T=e}}};eA("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return rA[e]=rn[e]}),tR.add(t$.updateRoot),k=rA.to({},{duration:0});var rI=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},rM=function(e,t){var r,i,n,s=e._targets;for(r in t)for(i=s.length;i--;)(n=e._ptLookup[i][r])&&(n=n.d)&&(n._pt&&(n=rI(n,r)),n&&n.modifier&&n.modifier(t[r],e,s[i],r))},rR=function(e,t){return{name:e,rawVars:1,init:function(e,r,i){i._onInit=function(e){var i,n;if(H(r)&&(i={},eA(r,function(e){return i[e]=1}),r=i),t){for(n in i={},r)i[n]=t(r[n]);r=i}rM(e,r)}}}},rO=rA.registerPlugin({name:"attr",init:function(e,t,r,i,n){var s,o,a;for(s in this.tween=r,t)a=e.getAttribute(s)||"",(o=this.add(e,"setAttribute",(a||0)+"",t[s],i,n,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(e,t){for(var r=t._pt;r;)P?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},rR("roundProps",td),rR("modifiers"),rR("snap",tf))||rA;rn.version=t$.version=rO.version="3.12.5",R=1,Z()&&tO(),tk.Power0,tk.Power1,tk.Power2,tk.Power3,tk.Power4,tk.Linear,tk.Quad,tk.Cubic,tk.Quart,tk.Quint,tk.Strong,tk.Elastic,tk.Back,tk.SteppedEase,tk.Bounce,tk.Sine,tk.Expo,tk.Circ;var rk,rN,rL,rD,rB,rF,rV,rG,rU={},rz=180/Math.PI,rj=Math.PI/180,rH=Math.atan2,rW=/([A-Z])/g,rq=/(left|right|width|margin|padding|x)/i,rX=/[\s,\(]\S/,r$={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},rY=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},rZ=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},rK=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},rJ=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},rQ=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},r1=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},r0=function(e,t,r){return e.style[t]=r},r2=function(e,t,r){return e.style.setProperty(t,r)},r3=function(e,t,r){return e._gsap[t]=r},r5=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},r6=function(e,t,r,i,n){var s=e._gsap;s.scaleX=s.scaleY=r,s.renderTransform(n,s)},r4=function(e,t,r,i,n){var s=e._gsap;s[t]=r,s.renderTransform(n,s)},r9="transform",r8=r9+"Origin",r7=function e(t,r){var i=this,n=this.target,s=n.style,o=n._gsap;if(t in rU&&s){if(this.tfm=this.tfm||{},"transform"===t)return r$.transform.split(",").forEach(function(t){return e.call(i,t,r)});~(t=r$[t]||t).indexOf(",")?t.split(",").forEach(function(e){return i.tfm[e]=iy(n,e)}):this.tfm[t]=o.x?o[t]:iy(n,t),t===r8&&(this.tfm.zOrigin=o.zOrigin);if(this.props.indexOf(r9)>=0)return;o.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(r8,r,"")),t=r9}(s||r)&&this.props.push(t,r,s[t])},ie=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},it=function(){var e,t,r=this.props,i=this.target,n=i.style,s=i._gsap;for(e=0;e<r.length;e+=3)r[e+1]?i[r[e]]=r[e+2]:r[e+2]?n[r[e]]=r[e+2]:n.removeProperty("--"===r[e].substr(0,2)?r[e]:r[e].replace(rW,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)s[t]=this.tfm[t];s.svg&&(s.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),(!(e=rV())||!e.isStart)&&!n[r9]&&(ie(n),s.zOrigin&&n[r8]&&(n[r8]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},ir=function(e,t){var r={target:e,props:[],revert:it,save:r7};return e._gsap||rO.core.getCache(e),t&&t.split(",").forEach(function(e){return r.save(e)}),r},ii=function(e,t){var r=rk.createElementNS?rk.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):rk.createElement(e);return r&&r.style?r:rk.createElement(e)},is=function e(t,r,i){var n=getComputedStyle(t);return n[r]||n.getPropertyValue(r.replace(rW,"-$1").toLowerCase())||n.getPropertyValue(r)||!i&&e(t,ia(r)||r,1)||""},io="O,Moz,ms,Ms,Webkit".split(","),ia=function(e,t,r){var i=(t||rD).style,n=5;if(e in i&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);n--&&!(io[n]+e in i););return n<0?null:(3===n?"ms":n>=0?io[n]:"")+e},il=function(){"undefined"!=typeof window&&window.document&&(rN=(rk=window.document).documentElement,rD=ii("div")||{style:{}},ii("div"),r8=(r9=ia(r9))+"Origin",rD.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",rG=!!ia("perspective"),rV=rO.core.reverting,rL=1)},ih=function e(t){var r,i=ii("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,s=this.nextSibling,o=this.style.cssText;if(rN.appendChild(i),i.appendChild(this),this.style.display="block",t)try{r=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(r=this._gsapBBox());return n&&(s?n.insertBefore(this,s):n.appendChild(this)),rN.removeChild(i),this.style.cssText=o,r},iu=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},ic=function(e){var t;try{t=e.getBBox()}catch(r){t=ih.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===ih||(t=ih.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+iu(e,["x","cx","x1"])||0,y:+iu(e,["y","cy","y1"])||0,width:0,height:0}},id=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&ic(e))},ip=function(e,t){if(t){var r,i=e.style;t in rU&&t!==r8&&(t=r9),i.removeProperty?(("ms"===(r=t.substr(0,2))||"webkit"===t.substr(0,6))&&(t="-"+t),i.removeProperty("--"===r?t:t.replace(rW,"-$1").toLowerCase())):i.removeAttribute(t)}},ig=function(e,t,r,i,n,s){var o=new rb(e._pt,t,r,0,1,s?r1:rQ);return e._pt=o,o.b=i,o.e=n,e._props.push(r),o},im={deg:1,rad:1,turn:1},iv={grid:1,flex:1},ib=function e(t,r,i,n){var s,o,a,l,h=parseFloat(i)||0,u=(i+"").trim().substr((h+"").length)||"px",c=rD.style,d=rq.test(r),f="svg"===t.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),g="px"===n,m="%"===n;if(n===u||!h||im[n]||im[u])return h;if("px"===u||g||(h=e(t,r,i,"px")),l=t.getCTM&&id(t),(m||"%"===u)&&(rU[r]||~r.indexOf("adius")))return s=l?t.getBBox()[d?"width":"height"]:t[p],eI(m?h/s*100:h/100*s);if(c[d?"width":"height"]=100+(g?u:n),o=~r.indexOf("adius")||"em"===n&&t.appendChild&&!f?t:t.parentNode,l&&(o=(t.ownerSVGElement||{}).parentNode),(!o||o===rk||!o.appendChild)&&(o=rk.body),(a=o._gsap)&&m&&a.width&&d&&a.time===tR.time&&!a.uncache)return eI(h/a.width*100);if(m&&("height"===r||"width"===r)){var v=t.style[r];t.style[r]=100+n,s=t[p],v?t.style[r]=v:ip(t,r)}else(m||"%"===u)&&!iv[is(o,"display")]&&(c.position=is(t,"position")),o===t&&(c.position="static"),o.appendChild(rD),s=rD[p],o.removeChild(rD),c.position="absolute";d&&m&&((a=eE(o)).time=tR.time,a.width=o[p]);return eI(g?s*h/100:s&&h?100/s*h:0)},iy=function(e,t,r,i){var n;return rL||il(),t in r$&&"transform"!==t&&~(t=r$[t]).indexOf(",")&&(t=t.split(",")[0]),rU[t]&&"transform"!==t?(n=iR(e,i),n="transformOrigin"!==t?n[t]:n.svg?n.origin:iO(is(e,r8))+" "+n.zOrigin+"px"):(!(n=e.style[t])||"auto"===n||i||~(n+"").indexOf("calc("))&&(n=iT[t]&&iT[t](e,t,r)||is(e,t)||eC(e,t)||("opacity"===t?1:0)),r&&!~(n+"").trim().indexOf(" ")?ib(e,t,n,r)+r:n},ix=function(e,t,r,i){if(!r||"none"===r){var n=ia(t,e,1),s=n&&is(e,n,1);s&&s!==r?(t=n,r=s):"borderColor"===t&&(r=is(e,"borderTopColor"))}var o,a,l,h,u,c,d,f,p,g,m,v=new rb(this._pt,e.style,t,0,1,rd),b=0,y=0;if(v.b=r,v.e=i,r+="","auto"==(i+="")&&(c=e.style[t],e.style[t]=i,i=is(e,t)||i,c?e.style[t]=c:ip(e,t)),tM(o=[r,i]),r=o[0],i=o[1],l=r.match(er)||[],(i.match(er)||[]).length){for(;a=er.exec(i);)d=a[0],p=i.substring(b,a.index),u?u=(u+1)%5:("rgba("===p.substr(-5)||"hsla("===p.substr(-5))&&(u=1),d!==(c=l[y++]||"")&&(h=parseFloat(c)||0,m=c.substr((h+"").length),"="===d.charAt(1)&&(d=eR(h,d)+m),f=parseFloat(d),g=d.substr((f+"").length),b=er.lastIndex-g.length,!g&&(g=g||L.units[t]||m,b===i.length&&(i+=g,v.e+=g)),m!==g&&(h=ib(e,t,c,g)||0),v._pt={_next:v._pt,p:p||1===y?p:",",s:h,c:f-h,m:u&&u<4||"zIndex"===t?Math.round:0});v.c=b<i.length?i.substring(b,i.length):""}else v.r="display"===t&&"none"===i?r1:rQ;return en.test(i)&&(v.e=0),this._pt=v,v},i_={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},iS=function(e){var t=e.split(" "),r=t[0],i=t[1]||"50%";return("top"===r||"bottom"===r||"left"===i||"right"===i)&&(e=r,r=i,i=e),t[0]=i_[r]||r,t[1]=i_[i]||i,t.join(" ")},iw=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r,i,n,s=t.t,o=s.style,a=t.u,l=s._gsap;if("all"===a||!0===a)o.cssText="",i=1;else for(n=(a=a.split(",")).length;--n>-1;)rU[r=a[n]]&&(i=1,r="transformOrigin"===r?r8:r9),ip(s,r);i&&(ip(s,r9),l&&(l.svg&&s.removeAttribute("transform"),iR(s,1),l.uncache=1,ie(o)))}},iT={clearProps:function(e,t,r,i,n){if("isFromStart"!==n.data){var s=e._pt=new rb(e._pt,t,r,0,0,iw);return s.u=i,s.pr=-10,s.tween=n,e._props.push(r),1}}},iP=[1,0,0,1,0,0],iE={},iC=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},iA=function(e){var t=is(e,r9);return iC(t)?iP:t.substr(7).match(et).map(eI)},iI=function(e,t){var r,i,n,s,o=e._gsap||eE(e),a=e.style,l=iA(e);return o.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(n=e.transform.baseVal.consolidate().matrix).a,n.b,n.c,n.d,n.e,n.f]).join(",")?iP:l:(l===iP&&!e.offsetParent&&e!==rN&&!o.svg&&(n=a.display,a.display="block",(!(r=e.parentNode)||!e.offsetParent)&&(s=1,i=e.nextElementSibling,rN.appendChild(e)),l=iA(e),n?a.display=n:ip(e,"display"),s&&(i?r.insertBefore(e,i):r?r.appendChild(e):rN.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},iM=function(e,t,r,i,n,s){var o,a,l,h,u=e._gsap,c=n||iI(e,!0),d=u.xOrigin||0,f=u.yOrigin||0,p=u.xOffset||0,g=u.yOffset||0,m=c[0],v=c[1],b=c[2],y=c[3],x=c[4],_=c[5],S=t.split(" "),w=parseFloat(S[0])||0,T=parseFloat(S[1])||0;r?c!==iP&&(a=m*y-v*b)&&(l=y/a*w+-b/a*T+(b*_-y*x)/a,h=-v/a*w+m/a*T-(m*_-v*x)/a,w=l,T=h):(w=(o=ic(e)).x+(~S[0].indexOf("%")?w/100*o.width:w),T=o.y+(~(S[1]||S[0]).indexOf("%")?T/100*o.height:T)),i||!1!==i&&u.smooth?(x=w-d,_=T-f,u.xOffset=p+(x*m+_*b)-x,u.yOffset=g+(x*v+_*y)-_):u.xOffset=u.yOffset=0,u.xOrigin=w,u.yOrigin=T,u.smooth=!!i,u.origin=t,u.originIsAbsolute=!!r,e.style[r8]="0px 0px",s&&(ig(s,u,"xOrigin",d,w),ig(s,u,"yOrigin",f,T),ig(s,u,"xOffset",p,u.xOffset),ig(s,u,"yOffset",g,u.yOffset)),e.setAttribute("data-svg-origin",w+" "+T)},iR=function(e,t){var r=e._gsap||new tq(e);if("x"in r&&!t&&!r.uncache)return r;var i,n,s,o,a,l,h,u,c,d,f,p,g,m,v,b,y,x,_,S,w,T,P,E,C,A,I,M,R,O,k,N,D=e.style,B=r.scaleX<0,F=getComputedStyle(e),V=is(e,r8)||"0";return i=n=s=l=h=u=c=d=f=0,o=a=1,r.svg=!!(e.getCTM&&id(e)),F.translate&&(("none"!==F.translate||"none"!==F.scale||"none"!==F.rotate)&&(D[r9]=("none"!==F.translate?"translate3d("+(F.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==F.rotate?"rotate("+F.rotate+") ":"")+("none"!==F.scale?"scale("+F.scale.split(" ").join(",")+") ":"")+("none"!==F[r9]?F[r9]:"")),D.scale=D.rotate=D.translate="none"),m=iI(e,r.svg),r.svg&&(r.uncache?(C=e.getBBox(),V=r.xOrigin-C.x+"px "+(r.yOrigin-C.y)+"px",E=""):E=!t&&e.getAttribute("data-svg-origin"),iM(e,E||V,!!E||r.originIsAbsolute,!1!==r.smooth,m)),p=r.xOrigin||0,g=r.yOrigin||0,m!==iP&&(x=m[0],_=m[1],S=m[2],w=m[3],i=T=m[4],n=P=m[5],6===m.length?(o=Math.sqrt(x*x+_*_),a=Math.sqrt(w*w+S*S),l=x||_?rH(_,x)*rz:0,(c=S||w?rH(S,w)*rz+l:0)&&(a*=Math.abs(Math.cos(c*rj))),r.svg&&(i-=p-(p*x+g*S),n-=g-(p*_+g*w))):(N=m[6],O=m[7],I=m[8],M=m[9],R=m[10],k=m[11],i=m[12],n=m[13],s=m[14],h=(v=rH(N,R))*rz,v&&(E=T*(b=Math.cos(-v))+I*(y=Math.sin(-v)),C=P*b+M*y,A=N*b+R*y,I=-(T*y)+I*b,M=-(P*y)+M*b,R=-(N*y)+R*b,k=-(O*y)+k*b,T=E,P=C,N=A),u=(v=rH(-S,R))*rz,v&&(E=x*(b=Math.cos(-v))-I*(y=Math.sin(-v)),C=_*b-M*y,A=S*b-R*y,k=w*y+k*b,x=E,_=C,S=A),l=(v=rH(_,x))*rz,v&&(E=x*(b=Math.cos(v))+_*(y=Math.sin(v)),C=T*b+P*y,_=_*b-x*y,P=P*b-T*y,x=E,T=C),h&&Math.abs(h)+Math.abs(l)>359.9&&(h=l=0,u=180-u),o=eI(Math.sqrt(x*x+_*_+S*S)),a=eI(Math.sqrt(P*P+N*N)),c=Math.abs(v=rH(T,P))>2e-4?v*rz:0,f=k?1/(k<0?-k:k):0),r.svg&&(E=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!iC(is(e,r9)),E&&e.setAttribute("transform",E))),Math.abs(c)>90&&270>Math.abs(c)&&(B?(o*=-1,c+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,c+=c<=0?180:-180)),t=t||r.uncache,r.x=i-((r.xPercent=i&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-i)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+"px",r.y=n-((r.yPercent=n&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-n)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+"px",r.z=s+"px",r.scaleX=eI(o),r.scaleY=eI(a),r.rotation=eI(l)+"deg",r.rotationX=eI(h)+"deg",r.rotationY=eI(u)+"deg",r.skewX=c+"deg",r.skewY=d+"deg",r.transformPerspective=f+"px",(r.zOrigin=parseFloat(V.split(" ")[2])||!t&&r.zOrigin||0)&&(D[r8]=iO(V)),r.xOffset=r.yOffset=0,r.force3D=L.force3D,r.renderTransform=r.svg?iB:rG?iD:iN,r.uncache=0,r},iO=function(e){return(e=e.split(" "))[0]+" "+e[1]},ik=function(e,t,r){var i=ts(t);return eI(parseFloat(t)+parseFloat(ib(e,"x",r+"px",i)))+i},iN=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,iD(e,t)},iL="0deg",iD=function(e,t){var r=t||this,i=r.xPercent,n=r.yPercent,s=r.x,o=r.y,a=r.z,l=r.rotation,h=r.rotationY,u=r.rotationX,c=r.skewX,d=r.skewY,f=r.scaleX,p=r.scaleY,g=r.transformPerspective,m=r.force3D,v=r.target,b=r.zOrigin,y="",x="auto"===m&&e&&1!==e||!0===m;if(b&&(u!==iL||h!==iL)){var _,S=parseFloat(h)*rj,w=Math.sin(S),T=Math.cos(S);s=ik(v,s,-(w*(_=Math.cos(S=parseFloat(u)*rj))*b)),o=ik(v,o,-(-Math.sin(S)*b)),a=ik(v,a,-(T*_*b)+b)}"0px"!==g&&(y+="perspective("+g+") "),(i||n)&&(y+="translate("+i+"%, "+n+"%) "),(x||"0px"!==s||"0px"!==o||"0px"!==a)&&(y+="0px"!==a||x?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+") "),l!==iL&&(y+="rotate("+l+") "),h!==iL&&(y+="rotateY("+h+") "),u!==iL&&(y+="rotateX("+u+") "),(c!==iL||d!==iL)&&(y+="skew("+c+", "+d+") "),(1!==f||1!==p)&&(y+="scale("+f+", "+p+") "),v.style[r9]=y||"translate(0, 0)"},iB=function(e,t){var r,i,n,s,o,a=t||this,l=a.xPercent,h=a.yPercent,u=a.x,c=a.y,d=a.rotation,f=a.skewX,p=a.skewY,g=a.scaleX,m=a.scaleY,v=a.target,b=a.xOrigin,y=a.yOrigin,x=a.xOffset,_=a.yOffset,S=a.forceCSS,w=parseFloat(u),T=parseFloat(c);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=rj,f*=rj,r=Math.cos(d)*g,i=Math.sin(d)*g,n=-(Math.sin(d-f)*m),s=Math.cos(d-f)*m,f&&(p*=rj,n*=o=Math.sqrt(1+(o=Math.tan(f-p))*o),s*=o,p&&(r*=o=Math.sqrt(1+(o=Math.tan(p))*o),i*=o)),r=eI(r),i=eI(i),n=eI(n),s=eI(s)):(r=g,s=m,i=n=0),(w&&!~(u+"").indexOf("px")||T&&!~(c+"").indexOf("px"))&&(w=ib(v,"x",u,"px"),T=ib(v,"y",c,"px")),(b||y||x||_)&&(w=eI(w+b-(b*r+y*n)+x),T=eI(T+y-(b*i+y*s)+_)),(l||h)&&(w=eI(w+l/100*(o=v.getBBox()).width),T=eI(T+h/100*o.height)),o="matrix("+r+","+i+","+n+","+s+","+w+","+T+")",v.setAttribute("transform",o),S&&(v.style[r9]=o)},iF=function(e,t,r,i,n){var s,o,a=H(n),l=parseFloat(n)*(a&&~n.indexOf("rad")?rz:1)-i,h=i+l+"deg";return a&&("short"===(s=n.split("_")[1])&&(l%=360)!=l%180&&(l+=l<0?360:-360),"cw"===s&&l<0?l=(l+36e9)%360-360*~~(l/360):"ccw"===s&&l>0&&(l=(l-36e9)%360-360*~~(l/360))),e._pt=o=new rb(e._pt,t,r,i,l,rZ),o.e=h,o.u="deg",e._props.push(r),o},iV=function(e,t){for(var r in t)e[r]=t[r];return e},iG=function(e,t,r){var i,n,s,o,a,l,h,u,c=iV({},r._gsap),d=r.style;for(n in c.svg?(s=r.getAttribute("transform"),r.setAttribute("transform",""),d[r9]=t,i=iR(r,1),ip(r,r9),r.setAttribute("transform",s)):(s=getComputedStyle(r)[r9],d[r9]=t,i=iR(r,1),d[r9]=s),rU)s=c[n],s!==(o=i[n])&&0>"perspective,force3D,transformOrigin,svgOrigin".indexOf(n)&&(h=ts(s),a=h!==(u=ts(o))?ib(r,n,s,u):parseFloat(s),l=parseFloat(o),e._pt=new rb(e._pt,i,n,a,l-a,rY),e._pt.u=u||0,e._props.push(n));iV(i,c)};eA("padding,margin,Width,Radius",function(e,t){var r="Right",i="Bottom",n="Left",s=(t<3?["Top",r,i,n]:["Top"+n,"Top"+r,i+r,i+n]).map(function(r){return t<2?e+r:"border"+r+e});iT[t>1?"border"+e:e]=function(e,t,r,i,n){var o,a;if(arguments.length<4)return 5===(a=(o=s.map(function(t){return iy(e,t,r)})).join(" ")).split(o[0]).length?o[0]:a;o=(i+"").split(" "),a={},s.forEach(function(e,t){return a[e]=o[t]=o[t]||o[(t-1)/2|0]}),e.init(t,a,n)}});var iU={name:"css",register:il,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,i,n){var s,o,a,l,h,u,c,d,f,p,g,m,v,b,y,x,_=this._props,S=e.style,w=r.vars.startAt;for(c in rL||il(),this.styles=this.styles||ir(e),x=this.styles.props,this.tween=r,t){if("autoRound"===c)continue;if(o=t[c],!(ex[c]&&t4(c,t,r,i,e,n))){if(h=typeof o,u=iT[c],"function"===h&&(h=typeof(o=o.call(r,i,e,n))),"string"===h&&~o.indexOf("random(")&&(o=tm(o)),u)u(this,e,c,o,r)&&(y=1);else if("--"===c.substr(0,2))s=(getComputedStyle(e).getPropertyValue(c)+"").trim(),o+="",tA.lastIndex=0,!tA.test(s)&&(d=ts(s),f=ts(o)),f?d!==f&&(s=ib(e,c,s,f)+f):d&&(o+=d),this.add(S,"setProperty",s,o,i,n,0,0,c),_.push(c),x.push(c,0,S[c]);else if("undefined"!==h){if(w&&c in w?(H(s="function"==typeof w[c]?w[c].call(r,i,e,n):w[c])&&~s.indexOf("random(")&&(s=tm(s)),ts(s+"")||"auto"===s||(s+=L.units[c]||ts(iy(e,c))||""),"="===(s+"").charAt(1)&&(s=iy(e,c))):s=iy(e,c),l=parseFloat(s),(p="string"===h&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),c in r$&&("autoAlpha"===c&&(1===l&&"hidden"===iy(e,"visibility")&&a&&(l=0),x.push("visibility",0,S.visibility),ig(this,S,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==c&&"transform"!==c&&~(c=r$[c]).indexOf(",")&&(c=c.split(",")[0])),g=c in rU){if(this.styles.save(c),!m&&((v=e._gsap).renderTransform&&!t.parseTransform||iR(e,t.parseTransform),b=!1!==t.smoothOrigin&&v.smooth,(m=this._pt=new rb(this._pt,S,r9,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===c)this._pt=new rb(this._pt,v,"scaleY",v.scaleY,(p?eR(v.scaleY,p+a):a)-v.scaleY||0,rY),this._pt.u=0,_.push("scaleY",c),c+="X";else if("transformOrigin"===c){x.push(r8,0,S[r8]),o=iS(o),v.svg?iM(e,o,0,b,0,this):((f=parseFloat(o.split(" ")[2])||0)!==v.zOrigin&&ig(this,v,"zOrigin",v.zOrigin,f),ig(this,S,c,iO(s),iO(o)));continue}else if("svgOrigin"===c){iM(e,o,1,b,0,this);continue}else if(c in iE){iF(this,v,c,l,p?eR(l,p+o):o);continue}else if("smoothOrigin"===c){ig(this,v,"smooth",v.smooth,o);continue}else if("force3D"===c){v[c]=o;continue}else if("transform"===c){iG(this,o,e);continue}}else!(c in S)&&(c=ia(c)||c);if(g||(a||0===a)&&(l||0===l)&&!rX.test(o)&&c in S)d=(s+"").substr((l+"").length),a||(a=0),f=ts(o)||(c in L.units?L.units[c]:d),d!==f&&(l=ib(e,c,s,f)),this._pt=new rb(this._pt,g?v:S,c,l,(p?eR(l,p+a):a)-l,g||"px"!==f&&"zIndex"!==c||!1===t.autoRound?rY:rJ),this._pt.u=f||0,d!==f&&"%"!==f&&(this._pt.b=s,this._pt.r=rK);else if(c in S)ix.call(this,e,c,s,p?p+o:o);else if(c in e)this.add(e,c,s||e[c],p?p+o:o,i,n);else if("parseTransform"!==c){eu(c,o);continue}g||(c in S?x.push(c,0,S[c]):x.push(c,1,s||e[c])),_.push(c)}}}y&&rv(this)},render:function(e,t){if(t.tween._time||!rV()){for(var r=t._pt;r;)r.r(e,r.d),r=r._next}else t.styles.revert()},get:iy,aliases:r$,getSetter:function(e,t,r){var i=r$[t];return i&&0>i.indexOf(",")&&(t=i),t in rU&&t!==r8&&(e._gsap.x||iy(e,"x"))?r&&rF===r?"scale"===t?r5:r3:(rF=r||{},"scale"===t?r6:r4):e.style&&!X(e.style[t])?r0:~t.indexOf("-")?r2:rh(e,t)},core:{_removeProperty:ip,_getMatrix:iI}};rO.utils.checkPrefix=ia,rO.core.getStyleSaver=ir,a="0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",l=eA((s="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(o="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(e){rU[e]=1}),eA(o,function(e){L.units[e]="deg",iE[e]=1}),r$[l[13]]=s+","+o,eA(a,function(e){var t=e.split(":");r$[t[1]]=l[t[0]]}),eA("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){L.units[e]="px"}),rO.registerPlugin(iU);var iz=rO.registerPlugin(iU)||rO;iz.core.Tween},766:function(e,t,r){var i,n,s,o,a,l,h,u,c,d,f,p,g,m,v;(n=function(){this.init()}).prototype={init:function(){var e=this||s;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),!t.ctx&&f(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,s.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio){for(var i=t._howls[r]._getSoundIds(),n=0;n<i.length;n++){var o=t._howls[r]._soundById(i[n]);o&&o._node&&(o._node.volume=o._volume*e)}}return t}return t._volume},mute:function(e){var t=this||s;!t.ctx&&f(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,s.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio){for(var i=t._howls[r]._getSoundIds(),n=0;n<i.length;n++){var o=t._howls[r]._soundById(i[n]);o&&o._node&&(o._node.muted=!!e||o._muted)}}return t},stop:function(){for(var e=this||s,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,f()),e},codecs:function(e){return(this||s)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||s;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio){if("undefined"!=typeof Audio)try{var t=new Audio;void 0===t.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0}try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch(e){}return!e.noAudio&&e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var r=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i=e._navigator?e._navigator.userAgent:"",n=i.match(/OPR\/(\d+)/g),o=n&&33>parseInt(n[0].split("/")[1],10),a=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome"),l=i.match(/Version\/(.*?) /),h=a&&l&&15>parseInt(l[1],10);return e._codecs={mp3:!!(!o&&(r||t.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!r,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!h&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!h&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||s;if(!e._audioUnlocked&&!!e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&44100!==e.ctx.sampleRate&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(r){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch(t){e.noAudio=!0;break}for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio){for(var s=e._howls[n]._getSoundIds(),o=0;o<s.length;o++){var a=e._howls[n]._soundById(s[o]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||s;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=new Audio().play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var t=this||s;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(!!e.autoSuspend&&!!e.ctx&&void 0!==e.ctx.suspend&&!!s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio){for(var r=0;r<e._howls[t]._sounds.length;r++)if(!e._howls[t]._sounds[r]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}},3e4),e}},_autoResume:function(){var e=this;if(!!e.ctx&&void 0!==e.ctx.resume&&!!s.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}},s=new n,(o=function(e){if(!e.src||0===e.src.length){console.error("An array of source files must be passed with any new Howl.");return}this.init(e)}).prototype={init:function(e){var t=this;return!s.ctx&&f(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!!e.xhr&&!!e.xhr.withCredentials&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=s.usingWebAudio&&!t._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e,t,r=null;if(s.noAudio){this._emit("loaderror",null,"No audio support.");return}"string"==typeof this._src&&(this._src=[this._src]);for(var i=0;i<this._src.length;i++){if(this._format&&this._format[i])e=this._format[i];else{if("string"!=typeof(t=this._src[i])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}!(e=/^data:audio\/([^;,]+);/i.exec(t))&&(e=/\.([^.]+)$/.exec(t.split("?",1)[0])),e&&(e=e[1].toLowerCase())}if(!e&&console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),e&&s.codecs(e)){r=this._src[i];break}}if(!r){this._emit("loaderror",null,"No codec support for selected audio sources.");return}return this._src=r,this._state="loading","https:"===window.location.protocol&&"http:"===r.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new a(this),this._webAudio&&h(this),this},play:function(e,t){var r=this,i=null;if("number"==typeof e)i=e,e=null;else if("string"==typeof e&&"loaded"===r._state&&!r._sprite[e])return null;else if(void 0===e&&(e="__default",!r._playLock)){for(var n=0,o=0;o<r._sounds.length;o++)r._sounds[o]._paused&&!r._sounds[o]._ended&&(n++,i=r._sounds[o]._id);1===n?e=null:i=null}var a=i?r._soundById(i):r._inactiveSound();if(!a)return null;if(i&&!e&&(e=a._sprite||"__default"),"loaded"!==r._state){a._sprite=e,a._ended=!1;var l=a._id;return r._queue.push({event:"play",action:function(){r.play(l)}}),l}if(i&&!a._paused)return!t&&r._loadQueue("play"),a._id;r._webAudio&&s._autoResume();var h=Math.max(0,a._seek>0?a._seek:r._sprite[e][0]/1e3),u=Math.max(0,(r._sprite[e][0]+r._sprite[e][1])/1e3-h),c=1e3*u/Math.abs(a._rate),d=r._sprite[e][0]/1e3,f=(r._sprite[e][0]+r._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var p=function(){a._paused=!1,a._seek=h,a._start=d,a._stop=f,a._loop=!!(a._loop||r._sprite[e][2])};if(h>=f){r._ended(a);return}var g=a._node;if(r._webAudio){var m=function(){r._playLock=!1,p(),r._refreshBuffer(a);var e=a._muted||r._muted?0:a._volume;g.gain.setValueAtTime(e,s.ctx.currentTime),a._playStart=s.ctx.currentTime,void 0===g.bufferSource.start?a._loop?g.bufferSource.noteGrainOn(0,h,86400):g.bufferSource.noteGrainOn(0,h,u):a._loop?g.bufferSource.start(0,h,86400):g.bufferSource.start(0,h,u),c!==1/0&&(r._endTimers[a._id]=setTimeout(r._ended.bind(r,a),c)),!t&&setTimeout(function(){r._emit("play",a._id),r._loadQueue()},0)};"running"===s.state&&"interrupted"!==s.ctx.state?m():(r._playLock=!0,r.once("resume",m),r._clearTimer(a._id))}else{var v=function(){g.currentTime=h,g.muted=a._muted||r._muted||s._muted||g.muted,g.volume=a._volume*s.volume(),g.playbackRate=a._rate;try{var i=g.play();if(i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)?(r._playLock=!0,p(),i.then(function(){r._playLock=!1,g._unlocked=!0,t?r._loadQueue():r._emit("play",a._id)}).catch(function(){r._playLock=!1,r._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0})):!t&&(r._playLock=!1,p(),r._emit("play",a._id)),g.playbackRate=a._rate,g.paused){r._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}"__default"!==e||a._loop?r._endTimers[a._id]=setTimeout(r._ended.bind(r,a),c):(r._endTimers[a._id]=function(){r._ended(a),g.removeEventListener("ended",r._endTimers[a._id],!1)},g.addEventListener("ended",r._endTimers[a._id],!1))}catch(e){r._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=r._src,g.load());var b=window&&window.ejecta||!g.readyState&&s._navigator.isCocoonJS;if(g.readyState>=3||b)v();else{r._playLock=!0,r._state="loading";var y=function(){r._state="loaded",v(),g.removeEventListener(s._canPlayEvent,y,!1)};g.addEventListener(s._canPlayEvent,y,!1),r._clearTimer(a._id)}}return a._id},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var r=t._getSoundIds(e),i=0;i<r.length;i++){t._clearTimer(r[i]);var n=t._soundById(r[i]);if(n&&!n._paused&&(n._seek=t.seek(r[i]),n._rateSeek=0,n._paused=!0,t._stopFade(r[i]),n._node)){if(t._webAudio){if(!n._node.bufferSource)continue;void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),t._cleanBuffer(n._node)}else(!isNaN(n._node.duration)||n._node.duration===1/0)&&n._node.pause()}!arguments[1]&&t._emit("pause",n?n._id:null)}return t},stop:function(e,t){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"stop",action:function(){r.stop(e)}}),r;for(var i=r._getSoundIds(e),n=0;n<i.length;n++){r._clearTimer(i[n]);var s=r._soundById(i[n]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,r._stopFade(i[n]),s._node&&(r._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),r._cleanBuffer(s._node)):(!isNaN(s._node.duration)||s._node.duration===1/0)&&(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&r._clearSound(s._node))),!t&&r._emit("stop",s._id))}return r},mute:function(e,t){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"mute",action:function(){r.mute(e,t)}}),r;if(void 0===t){if("boolean"!=typeof e)return r._muted;r._muted=e}for(var i=r._getSoundIds(t),n=0;n<i.length;n++){var o=r._soundById(i[n]);o&&(o._muted=e,o._interval&&r._stopFade(o._id),r._webAudio&&o._node?o._node.gain.setValueAtTime(e?0:o._volume,s.ctx.currentTime):o._node&&(o._node.muted=!!s._muted||e),r._emit("mute",o._id))}return r},volume:function(){var e,t,r,i=this,n=arguments;if(0===n.length)return i._volume;1===n.length||2===n.length&&void 0===n[1]?i._getSoundIds().indexOf(n[0])>=0?t=parseInt(n[0],10):e=parseFloat(n[0]):n.length>=2&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if(void 0===e||!(e>=0)||!(e<=1))return(r=t?i._soundById(t):i._sounds[0])?r._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,n)}}),i;void 0===t&&(i._volume=e),t=i._getSoundIds(t);for(var o=0;o<t.length;o++)(r=i._soundById(t[o]))&&(r._volume=e,!n[2]&&i._stopFade(t[o]),i._webAudio&&r._node&&!r._muted?r._node.gain.setValueAtTime(e,s.ctx.currentTime):r._node&&!r._muted&&(r._node.volume=e*s.volume()),i._emit("volume",r._id));return i},fade:function(e,t,r,i){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"fade",action:function(){n.fade(e,t,r,i)}}),n;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),r=parseFloat(r),n.volume(e,i);for(var o=n._getSoundIds(i),a=0;a<o.length;a++){var l=n._soundById(o[a]);if(l){if(!i&&n._stopFade(o[a]),n._webAudio&&!l._muted){var h=s.ctx.currentTime,u=h+r/1e3;l._volume=e,l._node.gain.setValueAtTime(e,h),l._node.gain.linearRampToValueAtTime(t,u)}n._startFadeInterval(l,e,t,r,o[a],void 0===i)}}return n},_startFadeInterval:function(e,t,r,i,n,s){var o=this,a=t,l=r-t,h=Math.abs(l/.01),u=Math.max(4,h>0?i/h:i),c=Date.now();e._fadeTo=r,e._interval=setInterval(function(){var n=(Date.now()-c)/i;c=Date.now(),a+=l*n,a=Math.round(100*a)/100,a=l<0?Math.max(r,a):Math.min(r,a),o._webAudio?e._volume=a:o.volume(a,e._id,!0),s&&(o._volume=a),(r<t&&a<=r||r>t&&a>=r)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,o.volume(r,e._id),o._emit("fade",e._id))},u)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,r,i=arguments;if(0===i.length)return this._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(r=this._soundById(parseInt(i[0],10)))&&r._loop;e=i[0],this._loop=e}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var n=this._getSoundIds(t),s=0;s<n.length;s++)(r=this._soundById(n[s]))&&(r._loop=e,this._webAudio&&r._node&&r._node.bufferSource&&(r._node.bufferSource.loop=e,e&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop,this.playing(n[s])&&(this.pause(n[s],!0),this.play(n[s],!0)))));return this},rate:function(){var e,t,r,i=this,n=arguments;if(0===n.length?t=i._sounds[0]._id:1===n.length?i._getSoundIds().indexOf(n[0])>=0?t=parseInt(n[0],10):e=parseFloat(n[0]):2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10)),"number"!=typeof e)return(r=i._soundById(t))?r._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,n)}}),i;void 0===t&&(i._rate=e),t=i._getSoundIds(t);for(var o=0;o<t.length;o++)if(r=i._soundById(t[o])){i.playing(t[o])&&(r._rateSeek=i.seek(t[o]),r._playStart=i._webAudio?s.ctx.currentTime:r._playStart),r._rate=e,i._webAudio&&r._node&&r._node.bufferSource?r._node.bufferSource.playbackRate.setValueAtTime(e,s.ctx.currentTime):r._node&&(r._node.playbackRate=e);var a=i.seek(t[o]),l=1e3*((i._sprite[r._sprite][0]+i._sprite[r._sprite][1])/1e3-a)/Math.abs(r._rate);(i._endTimers[t[o]]||!r._paused)&&(i._clearTimer(t[o]),i._endTimers[t[o]]=setTimeout(i._ended.bind(i,r),l)),i._emit("rate",r._id)}return i},seek:function(){var e,t,r=this,i=arguments;if(0===i.length?r._sounds.length&&(t=r._sounds[0]._id):1===i.length?r._getSoundIds().indexOf(i[0])>=0?t=parseInt(i[0],10):r._sounds.length&&(t=r._sounds[0]._id,e=parseFloat(i[0])):2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10)),void 0===t)return 0;if("number"==typeof e&&("loaded"!==r._state||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,i)}}),r;var n=r._soundById(t);if(n){if("number"==typeof e&&e>=0){var o=r.playing(t);o&&r.pause(t,!0),n._seek=e,n._ended=!1,r._clearTimer(t),!r._webAudio&&n._node&&!isNaN(n._node.duration)&&(n._node.currentTime=e);var a=function(){o&&r.play(t,!0),r._emit("seek",t)};if(o&&!r._webAudio){var l=function(){r._playLock?setTimeout(l,0):a()};setTimeout(l,0)}else a()}else{if(!r._webAudio)return n._node.currentTime;var h=r.playing(t)?s.ctx.currentTime-n._playStart:0,u=n._rateSeek?n._rateSeek-n._seek:0;return n._seek+(u+h*Math.abs(n._rate))}}return r},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var r=0;r<this._sounds.length;r++)if(!this._sounds[r]._paused)return!0;return!1},duration:function(e){var t=this._duration,r=this._soundById(e);return r&&(t=this._sprite[r._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,r=0;r<t.length;r++)!t[r]._paused&&e.stop(t[r]._id),!e._webAudio&&(e._clearSound(t[r]._node),t[r]._node.removeEventListener("error",t[r]._errorFn,!1),t[r]._node.removeEventListener(s._canPlayEvent,t[r]._loadFn,!1),t[r]._node.removeEventListener("ended",t[r]._endFn,!1),s._releaseHtml5Audio(t[r]._node)),delete t[r]._node,e._clearTimer(t[r]._id);var i=s._howls.indexOf(e);i>=0&&s._howls.splice(i,1);var n=!0;for(r=0;r<s._howls.length;r++)if(s._howls[r]._src===e._src||e._src.indexOf(s._howls[r]._src)>=0){n=!1;break}return l&&n&&delete l[e._src],s.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,r,i){var n=this["_on"+e];return"function"==typeof t&&n.push(i?{id:r,fn:t,once:i}:{id:r,fn:t}),this},off:function(e,t,r){var i=this["_on"+e],n=0;if("number"==typeof t&&(r=t,t=null),t||r)for(n=0;n<i.length;n++){var s=r===i[n].id;if(t===i[n].fn&&s||!t&&s){i.splice(n,1);break}}else if(e)this["_on"+e]=[];else{var o=Object.keys(this);for(n=0;n<o.length;n++)0===o[n].indexOf("_on")&&Array.isArray(this[o[n]])&&(this[o[n]]=[])}return this},once:function(e,t,r){return this.on(e,t,r,1),this},_emit:function(e,t,r){for(var i=this["_on"+e],n=i.length-1;n>=0;n--)(!i[n].id||i[n].id===t||"load"===e)&&(setTimeout((function(e){e.call(this,t,r)}).bind(this,i[n].fn),0),i[n].once&&this.off(e,i[n].fn,i[n].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),!e&&t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var r=!!(e._loop||this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&r&&this.stop(e._id,!0).play(e._id),this._webAudio&&r){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var i=(e._stop-e._start)*1e3/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),i)}return this._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),s._autoSuspend()),!this._webAudio&&!r&&this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new a(this)},_drain:function(){var e=this._pool,t=0,r=0;if(!(this._sounds.length<e)){for(r=0;r<this._sounds.length;r++)this._sounds[r]._ended&&t++;for(r=this._sounds.length-1;r>=0;r--){if(t<=e)return;this._sounds[r]._ended&&(this._webAudio&&this._sounds[r]._node&&this._sounds[r]._node.disconnect(0),this._sounds.splice(r,1),t--)}}},_getSoundIds:function(e){if(void 0!==e)return[e];for(var t=[],r=0;r<this._sounds.length;r++)t.push(this._sounds[r]._id);return t},_refreshBuffer:function(e){return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=l[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,s.ctx.currentTime),this},_cleanBuffer:function(e){var t=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return this;if(s._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=s._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){!/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)&&(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}},(a=function(e){this._parent=e,this.init()}).prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++s._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=s._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),this._node.gain.setValueAtTime(t,s.ctx.currentTime),this._node.paused=!0,this._node.connect(s.masterGain)):!s.noAudio&&(this._node=s._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(s._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=e._src,this._node.preload=!0===e._preload?"auto":e._preload,this._node.volume=t*s.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++s._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(s._canPlayEvent,this._loadFn,!1)},_endListener:function(){var e=this._parent;e._duration===1/0&&(e._duration=Math.ceil(10*this._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}},l={},h=function(e){var t=e._src;if(l[t]){e._duration=l[t].duration,d(e);return}if(/^data:[^;]+;base64,/.test(t)){for(var r=atob(t.split(",")[1]),i=new Uint8Array(r.length),n=0;n<r.length;++n)i[n]=r.charCodeAt(n);c(i.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(t){s.setRequestHeader(t,e._xhr.headers[t])}),s.onload=function(){var t=(s.status+"")[0];if("0"!==t&&"2"!==t&&"3"!==t){e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".");return}c(s.response,e)},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[t],e.load())},u(s)}},u=function(e){try{e.send()}catch(t){e.onerror()}},c=function(e,t){var r=function(){t._emit("loaderror",null,"Decoding audio data failed.")},i=function(e){e&&t._sounds.length>0?(l[t._src]=e,d(t,e)):r()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(e).then(i).catch(r):s.ctx.decodeAudioData(e,i,r)},d=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},f=function(){if(!!s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(e){s.usingWebAudio=!1}!s.ctx&&(s.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),t=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),r=t?parseInt(t[1],10):null;if(e&&r&&r<9){var i=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!i&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}},"function"==typeof define&&define.amd&&define([],function(){return{Howler:s,Howl:o}}),t.Howl=o,void 0!==r.g?(r.g.HowlerGlobal=n,r.g.Howler=s,r.g.Howl=o,r.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=n,window.Howler=s,window.Howl=o,window.Sound=a),HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,r){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,r="number"!=typeof r?this._pos[2]:r,"number"!=typeof e)?this._pos:(this._pos=[e,t,r],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this):this},HowlerGlobal.prototype.orientation=function(e,t,r,i,n,s){if(!this.ctx||!this.ctx.listener)return this;var o=this._orientation;return(t="number"!=typeof t?o[1]:t,r="number"!=typeof r?o[2]:r,i="number"!=typeof i?o[3]:i,n="number"!=typeof n?o[4]:n,s="number"!=typeof s?o[5]:s,"number"!=typeof e)?o:(this._orientation=[e,t,r,i,n,s],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(n,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,r,i,n,s),this)},Howl.prototype.init=(p=Howl.prototype.init,function(e){return this._orientation=e.orientation||[1,0,0],this._stereo=e.stereo||null,this._pos=e.pos||null,this._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},this._onstereo=e.onstereo?[{fn:e.onstereo}]:[],this._onpos=e.onpos?[{fn:e.onpos}]:[],this._onorientation=e.onorientation?[{fn:e.onorientation}]:[],p.call(this,e)}),Howl.prototype.stereo=function(e,t){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(e,t)}}),r;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof e)return r._stereo;r._stereo=e,r._pos=[e,0,0]}for(var n=r._getSoundIds(t),s=0;s<n.length;s++){var o=r._soundById(n[s]);if(o){if("number"!=typeof e)return o._stereo;o._stereo=e,o._pos=[e,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",(!o._panner||!o._panner.pan)&&v(o,i),"spatial"===i?void 0!==o._panner.positionX?(o._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(e,0,0):o._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",o._id)}}return r},Howl.prototype.pos=function(e,t,r,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"pos",action:function(){n.pos(e,t,r,i)}}),n;if(t="number"!=typeof t?0:t,r="number"!=typeof r?-.5:r,void 0===i){if("number"!=typeof e)return n._pos;n._pos=[e,t,r]}for(var s=n._getSoundIds(i),o=0;o<s.length;o++){var a=n._soundById(s[o]);if(a){if("number"!=typeof e)return a._pos;a._pos=[e,t,r],a._node&&((!a._panner||a._panner.pan)&&v(a,"spatial"),void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):a._panner.setPosition(e,t,r)),n._emit("pos",a._id)}}return n},Howl.prototype.orientation=function(e,t,r,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"orientation",action:function(){n.orientation(e,t,r,i)}}),n;if(t="number"!=typeof t?n._orientation[1]:t,r="number"!=typeof r?n._orientation[2]:r,void 0===i){if("number"!=typeof e)return n._orientation;n._orientation=[e,t,r]}for(var s=n._getSoundIds(i),o=0;o<s.length;o++){var a=n._soundById(s[o]);if(a){if("number"!=typeof e)return a._orientation;a._orientation=[e,t,r],a._node&&(!a._panner&&(!a._pos&&(a._pos=n._pos||[0,0,-.5]),v(a,"spatial")),void 0!==a._panner.orientationX?(a._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),a._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):a._panner.setOrientation(e,t,r)),n._emit("orientation",a._id)}}return n},Howl.prototype.pannerAttr=function(){var e,t,r,i=arguments;if(!this._webAudio)return this;if(0===i.length)return this._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return(r=this._soundById(parseInt(i[0],10)))?r._pannerAttr:this._pannerAttr;e=i[0],void 0===t&&(!e.pannerAttr&&(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:this._panningModel})}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var n=this._getSoundIds(t),s=0;s<n.length;s++)if(r=this._soundById(n[s])){var o=r._pannerAttr;o={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:o.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:o.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:o.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:o.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:o.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:o.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:o.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:o.panningModel};var a=r._panner;!a&&(!r._pos&&(r._pos=this._pos||[0,0,-.5]),v(r,"spatial"),a=r._panner),a.coneInnerAngle=o.coneInnerAngle,a.coneOuterAngle=o.coneOuterAngle,a.coneOuterGain=o.coneOuterGain,a.distanceModel=o.distanceModel,a.maxDistance=o.maxDistance,a.refDistance=o.refDistance,a.rolloffFactor=o.rolloffFactor,a.panningModel=o.panningModel}return this},Sound.prototype.init=(g=Sound.prototype.init,function(){var e=this._parent;this._orientation=e._orientation,this._stereo=e._stereo,this._pos=e._pos,this._pannerAttr=e._pannerAttr,g.call(this),this._stereo?e.stereo(this._stereo):this._pos&&e.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}),Sound.prototype.reset=(m=Sound.prototype.reset,function(){var e=this._parent;return this._orientation=e._orientation,this._stereo=e._stereo,this._pos=e._pos,this._pannerAttr=e._pannerAttr,this._stereo?e.stereo(this._stereo):this._pos?e.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,e._refreshBuffer(this)),m.call(this)}),v=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),!e._paused&&e._parent.pause(e._id,!0).play(e._id,!0)}},512:function(e){!function(t){"use strict";let r="(0?\\d+|0x[a-f0-9]+)",i={fourOctet:RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:RegExp(`^${r}\\.${r}$`,"i"),longValue:RegExp(`^${r}$`,"i")},n=RegExp("^0[0-7]+$","i"),s=RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",l={zoneIndex:RegExp(o,"i"),native:RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${o})?)$`,"i"),transitional:RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${o})?$`,"i")};function h(e,t){let r,i;if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let n=0,s=-1,o=(e.match(l.zoneIndex)||[])[0];for(o&&(o=o.substring(1),e=e.replace(/%.+$/,""));(s=e.indexOf(":",s+1))>=0;)n++;if("::"===e.substr(0,2)&&n--,"::"===e.substr(-2,2)&&n--,n>t)return null;for(i=t-n,r=":";i--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){let t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:o}}function u(e,t,r,i){let n;if(e.length!==t.length)throw Error("ipaddr: cannot match CIDR for objects with different lengths");let s=0;for(;i>0;){if((n=r-i)<0&&(n=0),e[s]>>n!=t[s]>>n)return!1;i-=r,s+=1}return!0}function c(e){if(s.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(n.test(e))return parseInt(e,8);throw Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}let d={};d.IPv4=function(){function e(e){let t,r;if(4!==e.length)throw Error("ipaddr: ipv4 octet count should be 4");for(t=0;t<e.length;t++)if(!(0<=(r=e[t])&&r<=255))throw Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,18,0,0]),15],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]],as112:[[new e([192,175,48,0]),24],[new e([192,31,196,0]),24]],amt:[[new e([192,52,193,0]),24]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv4"!==e.kind())throw Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e,t,r,i=0,n=!1,s={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};for(e=3;e>=0;e-=1){if(!((t=this.octets[e])in s))return null;if(r=s[t],n&&0!==r)return null;8!==r&&(n=!0),i+=r}return 32-i},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),d.IPv4.broadcastAddressFromCIDR=function(e){try{let t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],s=0;for(;s<4;)n.push(parseInt(r[s],10)|255^parseInt(i[s],10)),s++;return new this(n)}catch(e){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.isIPv4=function(e){return null!==this.parser(e)},d.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},d.IPv4.isValidCIDR=function(e){try{return this.parseCIDR(e),!0}catch(e){return!1}},d.IPv4.isValidFourPartDecimal=function(e){return!!(d.IPv4.isValid(e)&&e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))||!1},d.IPv4.networkAddressFromCIDR=function(e){let t,r,i,n,s;try{for(i=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<4;)n.push(parseInt(i[r],10)&parseInt(s[r],10)),r++;return new this(n)}catch(e){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.parse=function(e){let t=this.parser(e);if(null===t)throw Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},d.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){let e=parseInt(t[2]);if(e>=0&&e<=32){let r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw Error("ipaddr: string is not formatted like an IPv4 CIDR range")},d.IPv4.parser=function(e){let t,r,n;if(t=e.match(i.fourOctet))return function(){let e=t.slice(1,6),i=[];for(let t=0;t<e.length;t++)r=e[t],i.push(c(r));return i}();if(t=e.match(i.longValue)){if((n=c(t[1]))>0xffffffff||n<0)throw Error("ipaddr: address outside defined range");return(function(){let e;let t=[];for(e=0;e<=24;e+=8)t.push(n>>e&255);return t})().reverse()}if(t=e.match(i.twoOctet))return function(){let e=t.slice(1,4),r=[];if((n=c(e[1]))>0xffffff||n<0)throw Error("ipaddr: address outside defined range");return r.push(c(e[0])),r.push(n>>16&255),r.push(n>>8&255),r.push(255&n),r}();else if(t=e.match(i.threeOctet))return function(){let e=t.slice(1,5),r=[];if((n=c(e[2]))>65535||n<0)throw Error("ipaddr: address outside defined range");return r.push(c(e[0])),r.push(c(e[1])),r.push(n>>8&255),r.push(255&n),r}();else return null},d.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw Error("ipaddr: invalid IPv4 prefix length");let t=[0,0,0,0],r=0,i=Math.floor(e/8);for(;r<i;)t[r]=255,r++;return i<4&&(t[i]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.IPv6=function(){function e(e,t){let r,i;if(16===e.length)for(r=0,this.parts=[];r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else if(8===e.length)this.parts=e;else throw Error("ipaddr: ipv6 part count should be 8 or 16");for(r=0;r<this.parts.length;r++)if(!(0<=(i=this.parts[r])&&i<=65535))throw Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],discard:[new e([256,0,0,0,0,0,0,0]),64],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],benchmarking:[new e([8193,2,0,0,0,0,0,0]),48],amt:[new e([8193,3,0,0,0,0,0,0]),32],as112v6:[[new e([8193,4,274,0,0,0,0,0]),48],[new e([9760,79,32768,0,0,0,0,0]),48]],deprecated:[new e([8193,16,0,0,0,0,0,0]),28],orchid2:[new e([8193,32,0,0,0,0,0,0]),28],droneRemoteIdProtocolEntityTags:[new e([8193,48,0,0,0,0,0,0]),28],reserved:[[new e([8193,0,0,0,0,0,0,0]),23],[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv6"!==e.kind())throw Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e,t,r=0,i=!1,n={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};for(let s=7;s>=0;s-=1){if(!((e=this.parts[s])in n))return null;if(t=n[e],i&&0!==t)return null;16!==t&&(i=!0),r+=t}return 128-r},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;let t=[],r=this.parts;for(let i=0;i<r.length;i++)e=r[i],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){let e=(function(){let e=[];for(let t=0;t<this.parts.length;t++)e.push(function(e,t){for(;e.length<4;)e=`0${e}`;return e}(this.parts[t].toString(16),4));return e}).call(this).join(":"),t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let e=this.parts.slice(-2),t=e[0],r=e[1];return new d.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){let e=(function(){let e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}).call(this).join(":"),t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){let e;let t=/((^|:)(0(:|$)){2,})/g,r=this.toNormalizedString(),i=0,n=-1;for(;e=t.exec(r);)e[0].length>n&&(i=e.index,n=e[0].length);return n<0?r:`${r.substring(0,i)}::${r.substring(i+n)}`},e.prototype.toString=function(){return this.toRFC5952String()},e}(),d.IPv6.broadcastAddressFromCIDR=function(e){try{let t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],s=0;for(;s<16;)n.push(parseInt(r[s],10)|255^parseInt(i[s],10)),s++;return new this(n)}catch(e){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},d.IPv6.isIPv6=function(e){return null!==this.parser(e)},d.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{let t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},d.IPv6.isValidCIDR=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{return this.parseCIDR(e),!0}catch(e){return!1}},d.IPv6.networkAddressFromCIDR=function(e){let t,r,i,n,s;try{for(i=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<16;)n.push(parseInt(i[r],10)&parseInt(s[r],10)),r++;return new this(n)}catch(e){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},d.IPv6.parse=function(e){let t=this.parser(e);if(null===t.parts)throw Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},d.IPv6.parseCIDR=function(e){let t,r,i;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]))>=0&&t<=128)return Object.defineProperty(i=[this.parse(r[1]),t],"toString",{value:function(){return this.join("/")}}),i;throw Error("ipaddr: string is not formatted like an IPv6 CIDR range")},d.IPv6.parser=function(e){let t,r,i,n,s,o;if(i=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${i[1]}`);if(l.native.test(e))return h(e,8);if((i=e.match(l.transitional))&&(o=i[6]||"",t=i[1],!i[1].endsWith("::")&&(t=t.slice(0,-1)),(t=h(t+o,6)).parts)){for(r=0,s=[parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseInt(i[5])];r<s.length;r++)if(!(0<=(n=s[r])&&n<=255))return null;return t.parts.push(s[0]<<8|s[1]),t.parts.push(s[2]<<8|s[3]),{parts:t.parts,zoneId:t.zoneId}}return null},d.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw Error("ipaddr: invalid IPv6 prefix length");let t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0,i=Math.floor(e/8);for(;r<i;)t[r]=255,r++;return i<16&&(t[i]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.fromByteArray=function(e){let t=e.length;if(4===t)return new d.IPv4(e);if(16===t)return new d.IPv6(e);throw Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},d.isValid=function(e){return d.IPv6.isValid(e)||d.IPv4.isValid(e)},d.isValidCIDR=function(e){return d.IPv6.isValidCIDR(e)||d.IPv4.isValidCIDR(e)},d.parse=function(e){if(d.IPv6.isValid(e))return d.IPv6.parse(e);if(d.IPv4.isValid(e))return d.IPv4.parse(e);throw Error("ipaddr: the address has neither IPv6 nor IPv4 format")},d.parseCIDR=function(e){try{return d.IPv6.parseCIDR(e)}catch(t){try{return d.IPv4.parseCIDR(e)}catch(e){throw Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},d.process=function(e){let t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},d.subnetMatch=function(e,t,r){let i,n,s,o;for(n in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,n)){for((s=t[n])[0]&&!(s[0]instanceof Array)&&(s=[s]),i=0;i<s.length;i++)if(o=s[i],e.kind()===o[0].kind()&&e.match.apply(e,o))return n}return r},e.exports?e.exports=d:t.ipaddr=d}(this)},329:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(...e){this._head=this._tail=null,this._length=0,e.length>0&&e.forEach(e=>{this.append(e)})}*iterator(){let e=this._head;for(;e;)yield e.value,e=e.next}[Symbol.iterator](){return this.iterator()}get head(){return this._head?this._head.value:null}get tail(){return this._tail?this._tail.value:null}get length(){return this._length}insert(e,t,r=!1){if(r&&this.isDuplicate(e))return!1;let n=new i(e),s=this._head;if(!s)return!1;for(;;){if(s.value===t)return n.next=s.next,n.prev=s,s.next=n,n.next?n.next.prev=n:this._tail=n,this._length++,!0;if(!s.next)return!1;s=s.next}}append(e,t=!1){if(t&&this.isDuplicate(e))return!1;let r=new i(e);return this._tail?(this._tail.next=r,r.prev=this._tail,this._tail=r):this._head=this._tail=r,this._length++,!0}prepend(e,t=!1){if(t&&this.isDuplicate(e))return!1;let r=new i(e);return this._head?(r.next=this._head,this._head.prev=r,this._head=r):this._head=this._tail=r,this._length++,!0}remove(e){let t=this._head;if(!!t){if(t.value===e)return this._head=t.next,this._head.prev=null,t.next=t.prev=null,this._length--,t.value;for(;;){if(t.value===e)return t.next?(t.prev.next=t.next,t.next.prev=t.prev):(t.prev.next=null,this._tail=t.prev),t.next=t.prev=null,this._length--,t.value;if(!t.next)return;t=t.next}}}removeHead(){let e=this._head;if(!!e)return this._head.next?(this._head.next.prev=null,this._head=this._head.next,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}removeTail(){let e=this._tail;if(!!e)return this._tail.prev?(this._tail.prev.next=null,this._tail=this._tail.prev,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}first(e){let t=this.iterator(),r=[],i=Math.min(e,this.length);for(let e=0;e<i;e++){let e=t.next();r.push(e.value)}return r}toArray(){return[...this]}isDuplicate(e){return new Set(this.toArray()).has(e)}}t.LinkedList=r;class i{constructor(e){this.value=e,this.next=null,this.prev=null}}t.LinkedListItem=i},17:function(e,t,r){"use strict";let i=r(329);class n extends i.LinkedList{constructor(...e){super(...e)}get front(){return this.head}enqueue(e){this.append(e)}dequeue(){return this.removeHead()}}t.Queue=n},752:function(e,t,r){"use strict";let i=r(329);class n extends i.LinkedList{constructor(...e){super(...e)}get top(){return this.head}get size(){return this.length}push(e){this.prepend(e)}pop(){return this.removeHead()}}t.Stack=n},709:function(e,t){"use strict";var r;t.StringBuilder=t.String=void 0;class i{static regexNumber=/{(\d+(:\w*)?)}/g;static regexObject=/{(\w+(:\w*)?)}/g;static empty="";static Empty="";static IsNullOrWhiteSpace(e){return i.isNullOrWhiteSpace(e)}static Join(e,...t){return i.join(e,...t)}static Format(e,...t){return i.format(e,...t)}static isNullOrWhiteSpace(e){try{return null==e||"undefined"==e||e.toString().replace(/\s/g,"").length<1}catch(e){return console.log(e),!1}}static join(e,...t){try{var r=t[0];if(Array.isArray(r)||r instanceof Array){let t=i.empty;for(let i=0;i<r.length;i++){var n=r[i];i<r.length-1?t+=n+e:t+=n}return t}if("object"==typeof r){let t=i.empty;return Object.keys(r).forEach(i=>{t+=r[i]+e}),t=t.slice(0,t.length-e.length)}return i.joinString(e,...t)}catch(e){return console.log(e),i.empty}}static format(e,...t){try{return e.match(i.regexNumber)?i.formatString(i.regexNumber,e,t):e.match(i.regexObject)?i.formatString(i.regexObject,e,t,!0):e}catch(e){return console.log(e),i.empty}}static formatString(e,t,r,n=!1){return t.replace(e,function(e,t){let s;var o=e.split(":");return 1<o.length&&(t=o[0].replace("{",""),e=o[1].replace("}","")),null==(s=(n?r[0]:r)[t])||null==s||e.match(/{\d+}/)||void 0!==(s=i.parsePattern(e,s))&&null!=s?s:i.empty})}static parsePattern(e,t){switch(e){case"L":return t=t.toLocaleLowerCase();case"U":return t=t.toLocaleUpperCase();case"d":if("string"==typeof t)return i.getDisplayDateFromString(t);if(t instanceof Date)return i.format("{0:00}.{1:00}.{2:0000}",t.getDate(),t.getMonth(),t.getFullYear());break;case"s":if("string"==typeof t)return i.getSortableDateFromString(t);if(t instanceof Date)return i.format("{0:0000}-{1:00}-{2:00}",t.getFullYear(),t.getMonth(),t.getDate());break;case"n":{var r=(t="string"!=typeof t?t.toString():t).replace(/,/g,".");if(isNaN(parseFloat(r))||r.length<=3)break;let e=r=r.split(/\D+/g);var r=(e=1<r.length?[i.joinString("",...r.splice(0,r.length-1)),r[r.length-1]]:e)[0],n=r.length%3,s=0<n?r.substring(0,n):i.empty,r=r.substring(n).match(/.{3}/g);return t=s+"."+i.join(".",r)+(1<e.length?","+e[1]:"")}case"x":return this.decimalToHexString(t);case"X":return this.decimalToHexString(t,!0)}return"number"!=typeof t&&isNaN(t)||isNaN(+e)||i.isNullOrWhiteSpace(t)?t:i.formatNumber(t,e)}static decimalToHexString(e,t=!1){return e=parseFloat(e).toString(16),t?e.toLocaleUpperCase():e}static getDisplayDateFromString(e){var t=e.split("-");if(t.length<=1)return e;let r=t[t.length-1];return e=t[t.length-2],t=t[t.length-3],(r=(r=r.split("T")[0]).split(" ")[0])+`.${e}.`+t}static getSortableDateFromString(e){var t=e.replace(",","").split(".");if(t.length<=1)return e;e=t[t.length-1].split(" ");let r=i.empty,n=(1<e.length&&(r=e[e.length-1]),t[t.length-1].split(" ")[0]+`-${t[t.length-2]}-`+t[t.length-3]);return!i.isNullOrWhiteSpace(r)&&1<r.length?n+="T"+r:n+="T00:00:00",n}static formatNumber(e,t){var t=t.length,e=e.toString();return t<=e.length?e:(t-=e.length,Array(++t).join("0")+e)}static joinString(e,...t){let r=i.empty;for(let n=0;n<t.length;n++)if(!("string"==typeof t[n]&&i.isNullOrWhiteSpace(t[n])||"number"!=typeof t[n]&&"string"!=typeof t[n])){r+=""+t[n];for(let s=n+1;s<t.length;s++)if(!i.isNullOrWhiteSpace(t[s])){r+=e,n=s-1;break}}return r}}t.String=i;t.StringBuilder=class e{Values;constructor(e=""){this.Values=[],i.isNullOrWhiteSpace(e)||(this.Values=Array(e))}toString(){return this.Values.join(i.empty)}ToString(){return this.toString()}append(e){this.Values.push(e)}Append(e){this.append(e)}appendLine(e){this.Values.push("\r\n"+e)}AppendLine(e){this.appendLine(e)}appendFormat(e,...t){this.Values.push(i.format(e,...t))}AppendFormat(e,...t){this.appendFormat(e,...t)}appendLineFormat(e,...t){this.Values.push("\r\n"+i.format(e,...t))}AppendLineFormat(e,...t){return this.appendLineFormat(e,...t)}clear(){this.Values=[]}Clear(){this.clear()}}},765:function(e,t,r){"use strict";var i,n;function s(){let e=0,t=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(e|=(127&i)<<r,(128&i)==0)return this.assertBounds(),[e,t]}let r=this.buf[this.pos++];if(e|=(15&r)<<28,t=(112&r)>>4,(128&r)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(t|=(127&i)<<r,(128&i)==0)return this.assertBounds(),[e,t]}throw Error("invalid varint")}function o(e,t,r){for(let i=0;i<28;i+=7){let n=e>>>i,s=!(n>>>7==0&&0==t),o=(s?128|n:n)&255;if(r.push(o),!s)return}let i=e>>>28&15|(7&t)<<4,n=t>>3!=0;if(r.push((n?128|i:i)&255),!!n){for(let e=3;e<31;e+=7){let i=t>>>e,n=i>>>7!=0,s=(n?128|i:i)&255;if(r.push(s),!n)return}r.push(t>>>31&1)}}r.d(t,{oP:()=>x,Lt:()=>y});function a(e){let t="-"===e[0];t&&(e=e.slice(1));let r=0,i=0;function n(t,n){let s=Number(e.slice(t,n));i*=1e6,(r=1e6*r+s)>=0x100000000&&(i+=r/0x100000000|0,r%=0x100000000)}return n(-24,-18),n(-18,-12),n(-12,-6),n(-6),t?u(r,i):h(r,i)}function l(e,t){if({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t),t<=2097151)return String(0x100000000*t+e);let r=0xffffff&e,i=(e>>>24|t<<8)&0xffffff,n=t>>16&65535,s=r+6777216*i+6710656*n,o=i+8147497*n,a=2*n;return s>=1e7&&(o+=Math.floor(s/1e7),s%=1e7),o>=1e7&&(a+=Math.floor(o/1e7),o%=1e7),a.toString()+c(o)+c(s)}function h(e,t){return{lo:0|e,hi:0|t}}function u(e,t){return t=~t,e?e=~e+1:t+=1,h(e,t)}let c=e=>{let t=String(e);return"0000000".slice(t.length)+t};function d(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let r=0;r<9;r++)t.push(127&e|128),e>>=7;t.push(1)}}function f(){let e=this.buf[this.pos++],t=127&e;if((128&e)==0)return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<7,(128&e)==0)return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<14,(128&e)==0)return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<21,(128&e)==0)return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(let t=5;(128&e)!=0&&t<10;t++)e=this.buf[this.pos++];if((128&e)!=0)throw Error("invalid varint");return this.assertBounds(),t>>>0}let p=function(){let e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){let t=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),i=BigInt("0"),n=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){let i="bigint"==typeof e?e:BigInt(e);if(i>r||i<t)throw Error(`invalid int64: ${e}`);return i},uParse(e){let t="bigint"==typeof e?e:BigInt(e);if(t>n||t<i)throw Error(`invalid uint64: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigInt64(0,!0)),uDec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigUint64(0,!0))}}return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),g(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),m(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),g(e),a(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),m(e),a(e)),dec:(e,t)=>(function(e,t){let r=h(e,t),i=0x80000000&r.hi;i&&(r=u(r.lo,r.hi));let n=l(r.lo,r.hi);return i?"-"+n:n})(e,t),uDec:(e,t)=>l(e,t)}}();function g(e){if(!/^-?[0-9]+$/.test(e))throw Error("invalid int64: "+e)}function m(e){if(!/^[0-9]+$/.test(e))throw Error("invalid uint64: "+e)}let v=Symbol.for("@bufbuild/protobuf/text-encoding");function b(){if(void 0==globalThis[v]){let e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[v]={encodeUtf8:t=>e.encode(t),decodeUtf8:e=>t.decode(e),checkUtf8(e){try{return encodeURIComponent(e),!0}catch(e){return!1}}}}return globalThis[v]}(n=i||(i={}))[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32";class y{constructor(e=b().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),r=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],r),r+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(S(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return _(e),d(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.encodeUtf8(e);return this.uint32(t.byteLength),this.raw(t)}float(e){(function(e){if("string"==typeof e){let t=e;if(isNaN(e=Number(e))&&"NaN"!==t)throw Error("invalid float32: "+t)}else if("number"!=typeof e)throw Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw Error("invalid float32: "+e)})(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){S(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){_(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return _(e),d(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=p.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=p.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=p.enc(e);return o(t.lo,t.hi,this.buf),this}sint64(e){let t=p.enc(e),r=t.hi>>31;return o(t.lo<<1^r,(t.hi<<1|t.lo>>>31)^r,this.buf),this}uint64(e){let t=p.uEnc(e);return o(t.lo,t.hi,this.buf),this}}class x{constructor(e,t=b().decodeUtf8){this.decodeUtf8=t,this.varint64=s,this.uint32=f,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),t=e>>>3,r=7&e;if(t<=0||r<0||r>5)throw Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case i.Varint:for(;128&this.buf[this.pos++];);break;case i.Bit64:this.pos+=4;case i.Bit32:this.pos+=4;break;case i.LengthDelimited:let n=this.uint32();this.pos+=n;break;case i.StartGroup:for(;;){let[e,r]=this.tag();if(r===i.EndGroup){if(void 0!==t&&e!==t)throw Error("invalid end group tag");break}this.skip(r,e)}break;default:throw Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return p.dec(...this.varint64())}uint64(){return p.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(1&e);return e=(e>>>1|(1&t)<<31)^r,t=t>>>1^r,p.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return p.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return p.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.decodeUtf8(this.bytes())}}function _(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>0x7fffffff||e<-0x80000000)throw Error("invalid int32: "+e)}function S(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>0xffffffff||e<0)throw Error("invalid uint32: "+e)}},353:function(e,t,r){"use strict";let i;r.d(t,{Q2:()=>L,Uq:()=>V,kJ:()=>eJ,VQ:()=>eX,J5:()=>or,G$:()=>e1,NB:()=>eZ,sJ:()=>ti,fk:()=>N,Lz:()=>nP,E9:()=>g,Ae:()=>M,kS:()=>eY,Nj:()=>n8});class n{bind(e){this.entity&&this.entity.setAttr(e,this)}constructor(e,t){this.entity=e,this.bind(t)}}class s{}s.GeomObjectIndex=0,s.DrawingObjectIndex=1,s.AlgorithmDataIndex=2,s.ViewerIndex=3;class o extends n{constructor(e){super(e,s.GeomObjectIndex)}static getGeom(e){return null==e?null:e.getAttr(s.GeomObjectIndex)}get parent(){let e=this.entity.parent;return e?o.getGeom(e):null}rebind(e){this.entity=e,this.bind(s.GeomObjectIndex)}*getAncestors(){let e=this.parent;for(;null!=e;)yield e,e=e.parent}}class a{static solve(e,t,r,i,n,s){let o=e*n-i*t;if(!(Math.abs(o)<a.eps))return{x:(r*n-s*t)/o,y:(e*s-i*r)/o}}}a.eps=1e-8;class l{}l.distanceEpsilonPrecision=6,l.mult=1e6,l.defaultLeafBoxesOffset=.5,l.lineSegmentThreshold=.05,l.intersectionEpsilon=1e-4,l.distanceEpsilon=Math.pow(10,-l.distanceEpsilonPrecision),l.squareOfDistanceEpsilon=Math.pow(10,-(2*l.distanceEpsilonPrecision)),l.tolerance=1e-8;function h(e,t){let r=e-t;return r<0?-1:0===r?0:1}function u(e,t){let r=h(e.y,t.y);return r||h(e.x,t.x)}function c(e,t){let r=e-t;return-l.distanceEpsilon<=r&&r<=l.distanceEpsilon}function d(e,t){return f(e,t)>0}function f(e,t){let r=e-t;return r<=-l.distanceEpsilon?-1:r>=l.distanceEpsilon?1:0}function p(e,t){return e.sub(t).length}(er=eo||(eo={}))[er.Clockwise=0]="Clockwise",er[er.Counterclockwise=1]="Counterclockwise",er[er.Collinear=2]="Collinear";class g{static RoundPoint(e){return new g(g.RoundDouble(e.x),g.RoundDouble(e.y))}static RoundDouble(e){return Math.round(e*l.mult)/l.mult}toJSON(){return{x:this.x,y:this.y}}static fromJSON(e){return new g(e.x,e.y)}static ProjectionToLine(e,t,r){let i=t.sub(e),n=i.length;if(n<l.distanceEpsilon)return e;i=i.div(n);let s=r.sub(e).dot(i);return e.add(i.mul(s))}static RayIntersectsRayInteriors(e,t,r,i){let n=g.lineLineIntersection(e,e.add(t),r,r.add(i));if(n&&n.sub(e).dot(t.div(t.l1))>l.distanceEpsilon&&n.sub(r).dot(i.div(i.l1))>l.distanceEpsilon)return n}static IntervalIntersectsRay(e,t,r,i){let n=g.lineLineIntersection(e,t,r,r.add(i));if(!n)return;let s=e.sub(n),o=n.sub(t);if(!(0>=s.dot(o)||0>n.sub(r).dot(i))){if(s.dot(s)>l.squareOfDistanceEpsilon&&o.dot(o)>=l.squareOfDistanceEpsilon)return n}}static PointToTheLeftOfLineOrOnLine(e,t,r){return g.signedDoubledTriangleArea(e,t,r)>=0}static PointToTheLeftOfLine(e,t,r){return g.signedDoubledTriangleArea(e,t,r)>0}static PointIsInsideCone(e,t,r,i){return g.PointToTheRightOfLineOrOnLine(e,t,r)&&g.PointToTheLeftOfLineOrOnLine(e,t,i)}static PointToTheRightOfLineOrOnLine(e,t,r){return 0>=g.signedDoubledTriangleArea(t,r,e)}static PointToTheRightOfLine(e,t,r){return 0>g.signedDoubledTriangleArea(t,r,e)}static closeIntersections(e,t){return g.close(e,t,l.intersectionEpsilon)}get l1(){return Math.abs(this.x_)+Math.abs(this.y_)}dot(e){return this.x*e.x+this.y*e.y}get x(){return this.x_}get y(){return this.y_}compareTo(e){let t=h(this.x,e.x);return 0!==t?t:h(this.y,e.y)}toString(){return"("+this.x+","+this.y+")"}static close(e,t,r){return e.sub(t).length<=r}static closeSquare(e,t,r){let i=t.sub(e);return i.dot(i)<=r}static closeDistEps(e,t,r=l.distanceEpsilon){return e.sub(t).length<=r}normalize(){let e=this.length;return new g(this.x/e,this.y/e)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}get lengthSquared(){return this.x*this.x+this.y*this.y}constructor(e,t){this.x_=e,this.y_=t}static middle(e,t){return e.add(t).div(2)}scale(e,t){return new g(this.x*e,this.y*t)}add(e){return new g(this.x+e.x,this.y+e.y)}sub(e){return new g(this.x-e.x,this.y-e.y)}mul(e){return new g(this.x*e,this.y*e)}div(e){return new g(this.x/e,this.y/e)}equal(e){return e.x===this.x&&e.y===this.y}neg(){return new g(-this.x,-this.y)}static lineLineIntersection(e,t,r,i){let n=t.sub(e),s=r.sub(i),o=r.sub(e),l=a.solve(n.x,s.x,o.x,n.y,s.y,o.y);return void 0!==l?e.add(n.mul(l.x)):void 0}static segSegIntersection(e,t,r,i){let n=t.sub(e),s=r.sub(i),o=r.sub(e),h=l.tolerance,u=a.solve(n.x,s.x,o.x,n.y,s.y,o.y);return void 0!==u&&u.x>-h&&u.x<1+h&&u.y>-h&&u.y<1+h?e.add(n.mul(u.x)):void 0}static parallelWithinEpsilon(e,t,r){let i=e.length,n=t.length;return!!(i<r)||!!(n<r)||(e=e.div(i),t=t.div(n),Math.abs(-e.x*t.y+e.y*t.x)<r)}static crossProduct(e,t){return e.x*t.y-e.y*t.x}static dot(e,t){return e.x*t.x+e.y*t.y}static add(e,t){return e.add(t)}rotate90Ccw(){return new g(-this.y,this.x)}rotate90Cw(){return new g(this.y,-this.x)}clone(){return new g(this.x,this.y)}rotate(e){let t=Math.cos(e),r=Math.sin(e);return new g(t*this.x-r*this.y,r*this.x+t*this.y)}static mkPoint(e,t,r,i){return t.mul(e).add(i.mul(r))}static convSum(e,t,r){return t.add(r.sub(t).mul(e))}static anglePCP(e,t,r){return g.angle(e.sub(t),r.sub(t))}static angle(e,t){let r=e.x,i=e.y,n=t.x,s=t.y,o=r*s-i*n,a=r*n+i*s;if(Math.abs(a)<l.tolerance)return Math.abs(o)<l.tolerance?0:o<-l.tolerance?3*Math.PI/2:Math.PI/2;if(Math.abs(o)<l.tolerance)return a<-l.tolerance?Math.PI:0;let h=Math.atan2(o,a);return o>=-l.tolerance?h:2*Math.PI+h}static signedDoubledTriangleArea(e,t,r){return(t.x-e.x)*(r.y-e.y)-(r.x-e.x)*(t.y-e.y)}static getTriangleOrientation(e,t,r){let i=g.signedDoubledTriangleArea(e,t,r);return i>l.distanceEpsilon?eo.Counterclockwise:i<-l.distanceEpsilon?eo.Clockwise:eo.Collinear}static getTriangleOrientationWithIntersectionEpsilon(e,t,r){let i=g.signedDoubledTriangleArea(e,t,r);return i>l.intersectionEpsilon?eo.Counterclockwise:i<-l.intersectionEpsilon?eo.Clockwise:eo.Collinear}static ClosestPointAtLineSegment(e,t,r){let i=r.sub(t),n=e.sub(t),s=i.dot(n),o=i.dot(i);return s<=0+l.tolerance?t:o<=s+l.tolerance?r:t.add(i.mul(s/o))}static pointToTheLeftOfLineOrOnLine(e,t,r){return g.signedDoubledTriangleArea(e,t,r)>=0}static pointToTheLeftOfLine(e,t,r){return g.signedDoubledTriangleArea(e,t,r)>0}static pointToTheRightOfLineOrOnLine(e,t,r){return 0>=g.signedDoubledTriangleArea(t,r,e)}static pointToTheRightOfLine(e,t,r){return 0>g.signedDoubledTriangleArea(t,r,e)}static canProject(e,t,r){let i=r.sub(t);return!(0>e.sub(t).dot(i)||e.sub(r).dot(i)>0)&&!0}static distToLineSegment(e,t,r){let i,n;let s=r.sub(t),o=e.sub(t);if((i=s.dot(o))<=l.tolerance)return{par:0,dist:o.length};if((n=s.dot(s))<=i+l.tolerance)return{par:1,dist:e.sub(r).length};let a=i/n;return{par:a,dist:t.add(s.mul(a)).length}}}class m{constructor(){this._next=null,this.prev=null}get point(){return this._point}set point(e){this._point=e}get next(){return this._next}set next(e){this._next=e}get nextOnPolyline(){return this.polyline.next(this)}get prevOnPolyline(){return this.polyline.prev(this)}getNext(){return this.next}setNext(e){this.next=e,null!=this.polyline&&this.polyline.setInitIsRequired()}getPrev(){return this.prev}setPrev(e){this.prev=e,null!=this.polyline&&this.polyline.setInitIsRequired()}static mkFromPoint(e){let t=new m;return t.point=e,t}}(ei=ea||(ea={}))[ei.Corner=0]="Corner",ei[ei.VertexA=1]="VertexA",ei[ei.otherCorner=2]="otherCorner",ei[ei.VertexB=3]="VertexB";class v{contains(e){let t=e.sub(this.corner),r=l.distanceEpsilon,i=t.dot(this.bRot);if(i>this.abRot+r||i<-r)return!1;let n=t.dot(this.aRot);return n<=this.baRot+r&&n>=-r}get area(){return Math.abs(this.a.x*this.b.y-this.a.y*this.b.x)}vertex(e){switch(e){case ea.Corner:return this.corner;case ea.VertexA:return this.aPlusCorner;case ea.otherCorner:return this.otherCorner;case ea.VertexB:return this.bPlusCorner;default:return}}static parallelogramOfTwo(e,t){let r=new v,i=e.corner,n={minx:i.x,maxx:i.x,miny:i.y,maxy:i.y};return v.pumpMinMax(n,e.aPlusCorner),v.pumpMinMax(n,e.otherCorner),v.pumpMinMax(n,e.bPlusCorner),v.pumpMinMax(n,t.corner),v.pumpMinMax(n,t.aPlusCorner),v.pumpMinMax(n,t.otherCorner),v.pumpMinMax(n,t.bPlusCorner),r.corner=new g(n.minx,n.miny),r.a=new g(0,n.maxy-n.miny),r.b=new g(n.maxx-n.minx,0),r.aPlusCorner=r.a.add(r.corner),r.otherCorner=r.b.add(r.aPlusCorner),r.bPlusCorner=r.b.add(r.corner),r.aRot=new g(-r.a.y,r.a.x),r.aRot.length>.5&&(r.aRot=r.aRot.normalize()),r.bRot=new g(-r.b.y,r.b.x),r.bRot.length>.5&&(r.bRot=r.bRot.normalize()),r.abRot=r.a.dot(r.bRot),r.baRot=r.b.dot(r.aRot),r.abRot<0&&(r.abRot=-r.abRot,r.bRot=r.bRot.neg()),r.baRot<0&&(r.baRot=-r.baRot,r.aRot=r.aRot.neg()),r.isSeg=r.a.sub(r.b).length<l.distanceEpsilon,r}static pumpMinMax(e,t){t.x<e.minx?e.minx=t.x:t.x>e.maxx&&(e.maxx=t.x),t.y<e.miny?e.miny=t.y:t.y>e.maxy&&(e.maxy=t.y)}static intersect(e,t){return!1!=!(v.separByA(e,t)||v.separByA(t,e)||v.separByB(e,t)||v.separByB(t,e))&&(!(e.isSeg&&t.isSeg&&g.parallelWithinEpsilon(e.otherCorner.sub(e.corner),t.otherCorner.sub(t.corner),1e-5))||v.ParallelSegsIntersect(t,e))}static ParallelSegsIntersect(e,t){let r=e.corner,i=e.otherCorner,n=t.corner,s=t.otherCorner,o=i.sub(r),a=o.dot(o),h=n.sub(r).dot(o),u=s.sub(r).dot(o);if(h>u){let e=h;h=u,u=e}return!(u<0-l.distanceEpsilon||h>a+l.distanceEpsilon)}static separByB(e,t){let r=l.distanceEpsilon,i=t.vertex(0).sub(e.corner).dot(e.bRot),n=[ea.VertexA,ea.otherCorner,ea.VertexB];if(i>e.abRot+r){for(let i of n)if(t.vertex(i).sub(e.corner).dot(e.bRot)<=e.abRot+r)return!1;return!0}if(i<-r){for(let i of n)if(t.vertex(i).sub(e.corner).dot(e.bRot)>=-r)return!1;return!0}return!1}static separByA(e,t){let r=l.distanceEpsilon,i=t.corner.sub(e.corner),n=g.dot(i,e.aRot);if(n>e.baRot+r)return i=t.aPlusCorner.sub(e.corner),!(g.dot(i,e.aRot)<=e.baRot+r)&&(i=t.bPlusCorner.sub(e.corner),!(g.dot(i,e.aRot)<=e.baRot+r)&&(i=t.otherCorner.sub(e.corner),!(g.dot(i,e.aRot)<=e.baRot+r)&&!0));if(n<-r)return i=t.aPlusCorner.sub(e.corner),!(g.dot(i,e.aRot)>=-r)&&(i=t.bPlusCorner.sub(e.corner),!(g.dot(i,e.aRot)>=-r)&&(i=t.otherCorner.sub(e.corner),!(g.dot(i,e.aRot)>=-r)&&!0));return!1}static parallelogramByCornerSideSide(e,t,r){let i=new v;return i.corner=e,i.a=t,i.b=r,i.aRot=new g(-t.y,t.x),i.aRot.length>.5&&(i.aRot=i.aRot.normalize()),i.bRot=new g(-r.y,r.x),i.bRot.length>.5&&(i.bRot=i.bRot.normalize()),i.abRot=i.bRot.dot(t),i.baRot=r.dot(i.aRot),i.abRot<0&&(i.abRot=-i.abRot,i.bRot=i.bRot.neg()),i.baRot<0&&(i.baRot=-i.baRot,i.aRot=i.aRot.neg()),i.isSeg=t.sub(r).length<l.distanceEpsilon,i.aPlusCorner=t.add(e),i.otherCorner=r.add(i.aPlusCorner),i.bPlusCorner=r.add(e),i}static getParallelogramOfAGroup(e){let t=0,r=0,i=0,n=0,s=!0;for(let o of e)for(let e of function*(e){yield e.corner,yield e.aPlusCorner,yield e.otherCorner,yield e.bPlusCorner}(o)){let o=e.x,a=e.y;s?(s=!1,t=r=o,i=n=a):(o<t?t=o:o>r&&(r=o),a<i?i=a:a>n&&(n=a))}return v.parallelogramByCornerSideSide(new g(t,i),new g(0,n-i),new g(r-t,0))}}class b{static fromJSON(e){return b.mkPP(g.fromJSON(e.start),g.fromJSON(e.end))}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}offsetCurve(e,t){return null}constructor(e,t,r,i){this.parStart=0,this.parEnd=1,this.start=new g(e,t),this.end=new g(r,i)}trim(e,t){if(e=Math.max(this.parStart,e),t=Math.min(this.parEnd,t),e>t)throw"wrong params in trimming";let r=this.value(e),i=this.value(t);return g.close(r,i,l.distanceEpsilon)?null:b.mkPP(r,i)}value(e){return this.start.add(this.end.sub(this.start).mul(e))}trimWithWrap(e,t){return null}pNodeOverICurve(){let e=this.end.sub(this.start).mul(.5);return{parallelogram:v.parallelogramByCornerSideSide(this.start,e,e),seg:this,leafBoxesOffset:0,node:{low:0,high:1,chord:this}}}normal(){let e=this.start.sub(this.end);return new g(-(e=e.div(e.length)).y,e.x)}static mkPP(e,t){return new b(e.x,e.y,t.x,t.y)}static mkLinePXY(e,t,r){return new b(e.x,e.y,t,r)}derivative(e){return this.end.sub(this.start)}secondDerivative(e){return new g(0,0)}thirdDerivative(e){return new g(0,0)}reverse(){return b.mkPP(this.end,this.start)}translate(e){this.start=this.start.add(e),this.end=this.end.add(e)}scaleFromOrigin(e,t){return b.mkPP(this.start.scale(e,t),this.end.scale(e,t))}getParameterAtLength(e){let t=this.end.sub(this.start).length;if(t<l.tolerance)return 0;let r=e/t;return r>1?1:r<0?0:r}transform(e){return b.mkPP(e.multiplyPoint(this.start),e.multiplyPoint(this.end))}closestParameterWithinBounds(e,t,r){let i=this.closestParameter(e);return i<t&&(i=t),i>r&&(i=r),i}lengthPartial(e,t){return this.value(t).sub(this.value(e)).length}get length(){return this.start.sub(this.end).length}get boundingBox(){return M.mkPP(this.start,this.end)}clone(){return b.mkPP(this.start.clone(),this.end.clone())}static closestParameterOnLineSegment(e,t,r){let i=r.sub(t),n=e.sub(t),s=i.dot(n);if(s<=0+l.tolerance)return 0;let o=i.dot(i);return o<=s+l.tolerance?1:s/o}closestParameter(e){return b.closestParameterOnLineSegment(e,this.start,this.end)}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}static IntersectPPPP(e,t,r,i){let n=g.lineLineIntersection(e,t,r,i);if(null!=n){if(y(n,e,t)&&y(n,r,i))return n;else return}}curvature(e){return 0}curvatureDerivative(e){return 0}curvatureSecondDerivative(e){return 0}static minDistBetweenLineSegments(e,t,r,i){let n,s;let o=t.sub(e),a=i.sub(r),h=e.sub(r),u=g.crossProduct(o,a),c=o.dot(o),d=o.dot(a),f=a.dot(a),p=o.dot(h),m=a.dot(h),v=Math.abs(u),b=v,y=v;v<l.tolerance?(n=0,b=1,s=m,y=f):(n=g.crossProduct(a,h),s=g.crossProduct(o,h),u<0&&(n=-n,s=-s),n<0?(n=0,s=m,y=f):n>b&&(n=b=1,s=m+d,y=f)),s<0?(s=0,0>-p?n=0:-p>c?n=b:(n=-p,b=c)):s>y&&(s=y=1,-p+d<0?n=0:-p+d>c?n=b:(n=-p+d,b=c));let x=Math.abs(n)<l.tolerance?0:n/b,_=Math.abs(s)<l.tolerance?0:s/y;return{parab:x,parcd:_,dist:h.add(o.mul(x).sub(a.mul(_))).length}}}function y(e,t,r){return e.x>=Math.min(t.x,r.x)-l.distanceEpsilon&&e.y>=Math.min(t.y,r.y)-l.distanceEpsilon&&e.x<=Math.max(t.x,r.x)+l.distanceEpsilon&&e.y<=Math.max(t.y,r.y)+l.distanceEpsilon}function x(e,t,r,i){let n=g.getTriangleOrientation(e,t,r),s=g.getTriangleOrientation(e,t,i),o=g.getTriangleOrientation(r,i,e),a=g.getTriangleOrientation(r,i,t);return!!(n!=s&&o!=a||n==eo.Collinear&&y(r,e,t)||s==eo.Collinear&&y(i,e,t)||o==eo.Collinear&&y(e,r,i)||a==eo.Collinear&&y(t,r,i))||!1}class _{static distToSegm(e,t,r){let i=r.sub(t);if(i.length<l.intersectionEpsilon)return e.sub(t.add(r).div(2)).length;let n=new g(-i.y,i.x);return n=n.mul(1/n.length),Math.abs(e.sub(t).dot(n))}static createParallelogramOnSubSeg(e,t,r){let i=r.derivative(e),n=r.derivative(t),s=new g(-n.y,n.x),o=r.value(e),a=r.value(t),h=a.sub(o).dot(s),u=i.dot(s),c=Math.abs(h)<l.distanceEpsilon;if(!(!c&&Math.abs(u)<l.distanceEpsilon))return i=i.mul(c?0:h/u),v.parallelogramByCornerSideSide(o,i,a.sub(o).sub(i))}static createParallelogramNodeForCurveSeg(e,t,r,i){if(e===r.parStart&&t===r.parEnd&&g.close(r.start,r.end,l.distanceEpsilon))return _.createNodeWithSegmentSplit(e,t,r,i);let n=r.value(e),s=r.value(t),o=s.sub(n),a=r.value((e+t)/2);if(_.distToSegm(a,n,s)<=l.intersectionEpsilon&&o.dot(o)<l.lineSegmentThreshold*l.lineSegmentThreshold&&t-e<l.lineSegmentThreshold){let i=b.mkPP(n,s),o=i.pNodeOverICurve();o.seg=r;let a=o.node;return a.low=e,a.high=t,a.chord=i,o}if(_.WithinEpsilon(r,e,t,i)){let n=_.createParallelogramOnSubSeg(e,t,r);if(void 0!==n)return{parallelogram:n,seg:r,leafBoxesOffset:i,node:{low:e,high:t,chord:null}}}return _.createNodeWithSegmentSplit(e,t,r,i)}static WithinEpsilon(e,t,r,i){let n=(r-t)/3,s=e.value(t),o=e.value(r);return!(_.distToSegm(e.value(t+n),s,o)>i)&&_.distToSegm(e.value(t+2*n),s,o)<=i}static createParallelogramNodeForCurveSegDefaultOffset(e){return _.createParallelogramNodeForCurveSeg(e.parStart,e.parEnd,e,l.defaultLeafBoxesOffset)}static createNodeWithSegmentSplit(e,t,r,i){let n={parallelogram:null,seg:r,leafBoxesOffset:1,node:{children:[]}},s=n.node;return s.children.push(_.createParallelogramNodeForCurveSeg(e,.5*(e+t),r,i)),s.children.push(_.createParallelogramNodeForCurveSeg(.5*(e+t),t,r,i)),n.parallelogram=v.parallelogramOfTwo(s.children[0].parallelogram,s.children[1].parallelogram),n}}class S{constructor(e,t,r,i,n){this.par0=e,this.par1=t,this.x=r,this.seg0=i,this.seg1=n}}class w{static closestPoint(e,t,r,i,n){let s;let o=r,a=0,h=0,u=!1;do{let r=e.value(o),u=e.derivative(o),c=e.secondDerivative(o),d=u.dot(u)+r.sub(t).dot(c);if(Math.abs(d)<l.tolerance)return o;(o-=s=r.sub(t).dot(u.div(d)))>n+l.tolerance?(o=n,h++):o<i-l.tolerance&&(o=i,h++),a++}while(Math.abs(s)>l.tolerance&&!(u=a>=5||h>=5));return u&&e.value(r).sub(t).length<l.distanceEpsilon&&(o=r),o}}class T{isFullEllipse(){return this.parEnd===2*Math.PI&&0===this.parStart}static fromJSON(e){return new T(e.parStart,e.parEnd,g.fromJSON(e.axis0),g.fromJSON(e.axis1),g.fromJSON(e.center))}toJSON(){return{parStart:this.parStart,parEnd:this.parEnd,axis0:this.aAxis.toJSON(),axis1:this.bAxis.toJSON(),center:this.center.toJSON()}}offsetCurve(e,t){let r=t.sub(this.center),i=g.angle(this.aAxis,r);if(this.aAxis.mul(Math.cos(i)).add(this.bAxis.mul(Math.sin(i))).length<r.length){let t=this.aAxis.length,r=this.bAxis.length;return T.mkEllipsePPP(this.aAxis.normalize().mul(t+e),this.bAxis.normalize().mul(r+e),this.center)}{let t=this.aAxis.length,r=this.bAxis.length;return T.mkEllipsePPP(this.aAxis.normalize().mul(t-e),this.bAxis.normalize().mul(r-e),this.center)}}reverse(){return null}static mkEllipsePPP(e,t,r){return new T(0,2*Math.PI,e,t,r)}constructor(e,t,r,i,n){for(this.parStart=e,this.parEnd=t,this.aAxis=r,this.bAxis=i,this.center=n,this.pNode=null,this.setBoundingBox();this.parStart<0;)this.parStart+=2*Math.PI,this.parEnd+=2*Math.PI}get start(){return this.value(this.parStart)}get end(){return this.value(this.parEnd)}trim(e,t){return new T(Math.max(e,this.parStart),Math.min(t,this.parEnd),this.aAxis,this.bAxis,this.center)}trimWithWrap(e,t){return null}get boundingBox(){return this.box}value(e){return this.center.add(g.mkPoint(Math.cos(e),this.aAxis,Math.sin(e),this.bAxis))}derivative(e){return g.mkPoint(-Math.sin(e),this.aAxis,Math.cos(e),this.bAxis)}secondDerivative(e){return g.mkPoint(-Math.cos(e),this.aAxis,-Math.sin(e),this.bAxis)}thirdDerivative(e){return g.mkPoint(Math.sin(e),this.aAxis,-Math.cos(e),this.bAxis)}pNodeOverICurve(){return null!=this.pNode?this.pNode:this.pNode=_.createParallelogramNodeForCurveSegDefaultOffset(this)}setBoundingBox(){if(c(this.parStart,0)&&c(this.parEnd,2*Math.PI))this.box=this.fullBox();else{let e;this.box=M.mkPP(this.start,this.end);for(let t=Math.ceil(this.parStart/(Math.PI/2));(e=t*Math.PI/2)<this.parEnd;t++)e>this.parStart&&this.box.add(this.value(e))}}static mkEllipse(e,t,r,i,n,s){return new T(e,t,r,i,new g(n,s))}static mkFullEllipsePPP(e,t,r){return new T(0,2*Math.PI,e,t,r)}static mkFullEllipseNNP(e,t,r){return new T(0,2*Math.PI,new g(e,0),new g(0,t),r)}static mkCircle(e,t){return T.mkFullEllipseNNP(e,e,t)}translate(e){this.center=this.center.add(e),this.box.center=this.box.center.add(e),this.pNode=null}scaleFromOrigin(e,t){return new T(this.parStart,this.parEnd,this.aAxis.mul(e),this.bAxis.mul(t),this.center.scale(e,t))}getParameterAtLength(e){let t=this.parStart,r=this.parEnd,i=e+.001,n=e-.001;for(;r-t>l.distanceEpsilon;){let e=.5*(r+t),s=this.lengthPartial(this.parStart,e);if(s>i)r=e;else{if(!(s<n))return e;t=e}}return(r+t)/2}transform(e){if(null!=e){let t=e.multiplyPoint(this.aAxis).sub(e.offset()),r=e.multiplyPoint(this.bAxis).sub(e.offset());return new T(this.parStart,this.parEnd,t,r,e.multiplyPoint(this.center))}return this.clone()}closestParameterWithinBounds(e,t,r){let i=(r-t)/9,n=t,s=Number.MAX_VALUE;for(let r=0;r<=8;r++){let o=t+r*i,a=e.sub(this.value(o)),l=a.dot(a);l<s&&(s=l,n=o)}0===n&&r===2*Math.PI&&(t=-Math.PI);let o=w.closestPoint(this,e,n,t,r);return o<0&&(o+=2*Math.PI),o}lengthPartial(e,t){return C.lengthWithInterpolationAndThreshold(this.trim(e,t),l.lineSegmentThreshold/100)}get length(){return(this.aAxis.length+this.bAxis.length)*Math.abs(this.parEnd-this.parStart)/2}clone(){return new T(this.parStart,this.parEnd,this.aAxis.clone(),this.bAxis.clone(),this.center.clone())}closestParameter(e){let t=0,r=(this.parEnd-this.parStart)/9,i=this.parStart,n=Number.MAX_VALUE;for(let t=0;t<=8;t++){let s=this.parStart+t*r,o=e.sub(this.value(s)),a=o.dot(o);a<n&&(n=a,i=s)}let s=!1;0===i&&this.parEnd===2*Math.PI&&(s=!0,t=this.parStart,this.parStart=-Math.PI);let o=w.closestPoint(this,e,i,this.parStart,this.parEnd);return o<0&&(o+=2*Math.PI),s&&(this.parStart=t),o}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}curvature(e){throw"NotImplementedException()"}curvatureDerivative(e){throw"NotImplementedException();"}curvatureSecondDerivative(e){throw"NotImplementedException()"}orientedCounterclockwise(){return g.crossProduct(this.aAxis,this.bAxis)>0}fullBox(){let e=this.aAxis.add(this.bAxis);return M.mkPP(this.center.add(e),this.center.sub(e))}isArc(){return Math.abs(this.aAxis.dot(this.bAxis))<l.tolerance&&Math.abs(this.aAxis.length-this.bAxis.length)<l.tolerance&&g.closeDistEps(this.aAxis.rotate90Ccw(),this.bAxis)}}class P{initValues(){this.a=this.curveA.value(this.si),this.b=this.curveB.value(this.ti),this.a_b=this.a.sub(this.b),this.ad=this.curveA.derivative(this.si),this.add=this.curveA.secondDerivative(this.si),this.bd=this.curveB.derivative(this.ti),this.bdd=this.curveB.secondDerivative(this.ti)}constructor(e,t,r,i,n,s,o,a){this.curveA=e,this.curveB=t,this.aMin=r,this.bMin=n,this.aMax=i,this.bMax=s,this.aGuess=o,this.bGuess=a,this.si=o,this.ti=a}Fs(){return this.a_b.dot(this.ad)}Fss(){return this.a_b.dot(this.add)+this.ad.dot(this.ad)}Fst(){return-this.bd.dot(this.ad)}Ftt(){return-this.a_b.dot(this.bdd)+this.bd.dot(this.bd)}Ft(){return-this.a_b.dot(this.bd)}delta(e,t,r,i){return e*i-r*t}solve(){let e,t=0,r=0,i=!1;if(this.initValues(),this.curveA instanceof b&&this.curveB instanceof b){let e=this.curveB.derivative(0);if(e=e.div(e.length),Math.abs(Math.abs(this.curveA.normal().dot(e)))<l.distanceEpsilon||this.delta(this.Fss(),this.Fst(),this.Fst(),this.Ftt())<l.tolerance){this.success=!0,this.parallelLineSegLineSegMinDist();return}}do{let n;let s=this.delta(this.Fss(),this.Fst(),this.Fst(),this.Ftt());if(Math.abs(s)<l.tolerance){this.success=!1,i=!0;break}e={s:this.delta(-this.Fs(),this.Fst(),-this.Ft(),this.Ftt())/s,t:this.delta(this.Fss(),-this.Fs(),this.Fst(),-this.Ft())/s};let o=this.si+e.s,a=this.ti+e.t;o>this.aMax+l.distanceEpsilon||o<this.aMin-l.distanceEpsilon||a>this.bMax+l.distanceEpsilon||a<this.bMin-l.distanceEpsilon?(t++,this.chopDsDt(e),this.si+=e.s,this.ti+=e.t,n=!0):(n=!1,this.si=o,this.ti=a,this.si>this.aMax?this.si=this.aMax:this.si<this.aMin&&(this.si=this.aMin),this.ti>this.bMax?this.ti=this.bMax:this.ti<this.bMin&&(this.ti=this.bMin)),this.initValues(),r++,i=t>=10||r>=100||0===e.s&&0===e.t&&n}while((Math.abs(e.s)>=l.tolerance||Math.abs(e.t)>=l.tolerance)&&!i);if(i){let e=this.curveA.value(this.aGuess).sub(this.curveB.value(this.bGuess));if(e.dot(e)<l.distanceEpsilon*l.distanceEpsilon){this.aSolution=this.aGuess,this.bSolution=this.bGuess,this.aPoint=this.curveA.value(this.aGuess),this.bPoint=this.curveB.value(this.bGuess),this.success=!0;return}}this.aSolution=this.si,this.bSolution=this.ti,this.aPoint=this.a,this.bPoint=this.b,this.success=!i}chopDsDt(e){if(0!==e.s&&0!==e.t){let t=1;this.si+e.s>this.aMax?t=(this.aMax-this.si)/e.s:this.si+e.s<this.aMin&&(t=(this.aMin-this.si)/e.s);let r=1;this.ti+e.t>this.bMax?r=(this.bMax-this.ti)/e.t:this.ti+e.t<this.bMin&&(r=(this.bMin-this.ti)/e.t);let i=Math.min(t,r);e.s*=i,e.t*=i}else 0===e.s?this.ti+e.t>this.bMax?e.t=this.bMax-this.ti:this.ti+e.t<this.bMin&&(e.t=this.bMin-this.ti):this.si+e.s>this.aMax?e.s=this.aMax-this.si:this.si+e.s<this.aMin&&(e.s=this.aMin-this.si)}parallelLineSegLineSegMinDist(){let e,t,r;let i=this.curveA,n=this.curveB,s=i.start,o=i.end,a=n.start,h=n.end,u=o.sub(s),c=u.length,d=0;if(c>l.distanceEpsilon){e=(u=u.div(c)).dot(o.sub(s)),t=u.dot(a.sub(s)),r=u.dot(h.sub(s));let i=!1;if(t>r){i=!0;let e=t;t=r,r=e}if(r<d)this.aSolution=0,this.bSolution=i?0:1;else if(t>e)this.aSolution=1,this.bSolution=i?1:0;else{let n=Math.min(e,r);this.aSolution=n/(e-d),this.bSolution=(n-t)/(r-t),i&&(this.bSolution=1-this.bSolution)}}else{let r=h.sub(a),i=r.length;if(i>l.distanceEpsilon){if(r=r.div(i),d=0,e=r.dot(h.sub(a)),(t=r.dot(s.sub(a)))<d)this.bSolution=0,this.aSolution=1;else if(t>e)this.bSolution=1,this.aSolution=0;else{let r=Math.min(e,t);this.bSolution=r/(e-d),this.aSolution=0}}else this.aSolution=0,this.bSolution=0}this.aPoint=this.curveA.value(this.aSolution),this.bPoint=this.curveB.value(this.bSolution)}}class E{toJSON(){return{b:this.b.map(e=>e.toJSON())}}static fromJSON(e){return E.mkBezier(e.b.map(g.fromJSON))}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}B(e){return this.b[e]}pNodeOverICurve(){return null!=this.pBoxNode?this.pBoxNode:this.pBoxNode=_.createParallelogramNodeForCurveSegDefaultOffset(this)}value(e){let t=e*e;return this.l.mul(t*e).add(this.e.mul(t).add(this.c.mul(e)).add(this.b[0]))}static adjustParamTo01(e){return e>1?1:e<0?0:e}trim(e,t){if(e=E.adjustParamTo01(e),t=E.adjustParamTo01(t),e>t)return this.trim(t,e);if(e>1-l.tolerance)return new E(this.b[3],this.b[3],this.b[3],this.b[3]);let r=[,,,],i=[,,],n=new E(this.casteljau(e,r,i),i[1],r[2],this.b[3]),s=n.casteljau((t-e)/(1-e),r,i);return new E(n.b[0],r[0],i[0],s)}trimWithWrap(e,t){throw"NotImplementedException()"}casteljau(e,t,r){let i=1-e;for(let r=0;r<3;r++)t[r]=g.mkPoint(i,this.b[r],e,this.b[r+1]);for(let n=0;n<2;n++)r[n]=g.mkPoint(i,t[n],e,t[n+1]);return g.mkPoint(i,r[0],e,r[1])}derivative(e){return this.l.mul(3*e*e).add(this.e.mul(2*e)).add(this.c)}secondDerivative(e){return g.mkPoint(6*e,this.l,2,this.e)}thirdDerivative(e){return this.l.mul(6)}constructor(e,t,r,i){this.b=[,,,,],this.parStart=0,this.parEnd=1,this.b[0]=e,this.b[1]=t,this.b[2]=r,this.b[3]=i,this.c=this.b[1].sub(this.b[0]).mul(3),this.e=this.b[2].sub(this.b[1]).mul(3).sub(this.c),this.l=this.b[3].sub(this.b[0]).sub(this.c).sub(this.e)}get start(){return this.b[0]}get end(){return this.b[3]}reverse(){return new E(this.b[3],this.b[2],this.b[1],this.b[0])}translate(e){this.b[0]=this.b[0].add(e),this.b[1]=this.b[1].add(e),this.b[2]=this.b[2].add(e),this.b[3]=this.b[3].add(e),this.c=this.b[1].sub(this.b[0]).mul(3),this.e=this.b[2].sub(this.b[1]).mul(3).sub(this.c),this.l=this.b[3].sub(this.b[0]).sub(this.c).sub(this.e),this.bbox&&(this.bbox=M.translate(this.bbox,e)),this.pBoxNode=null}scaleFromOrigin(e,t){return new E(this.b[0].scale(e,t),this.b[1].scale(e,t),this.b[2].scale(e,t),this.b[3].scale(e,t))}offsetCurve(e,t){return null}lengthPartial(e,t){return this.trim(e,t).length}get length(){return E.lengthOnControlPolygon(this.b[0],this.b[1],this.b[2],this.b[3])}static lengthOnControlPolygon(e,t,r,i){let n=i.sub(e).length,s=t.sub(e).length+r.sub(t).length+i.sub(r).length;if(s-n>l.lineSegmentThreshold){let n=g.middle(e,t),s=g.middle(t,r),o=g.middle(r,i),a=g.middle(n,s),l=g.middle(o,s),h=g.middle(a,l);return E.lengthOnControlPolygon(e,n,a,h)+E.lengthOnControlPolygon(h,l,o,i)}return(s+n)/2}get boundingBox(){return this.bbox?this.bbox:this.bbox=M.mkOnPoints(this.b)}transform(e){return new E(e.multiplyPoint(this.b[0]),e.multiplyPoint(this.b[1]),e.multiplyPoint(this.b[2]),e.multiplyPoint(this.b[3]))}closestParameterWithinBounds(e,t,r){let i=(r-t)/8,n=0,s=Number.MAX_VALUE;for(let r=0;r<9;r++){let o=e.sub(this.value(r*i+t)),a=o.dot(o);a<s&&(s=a,n=r*i+t)}return w.closestPoint(this,e,n,t,r)}clone(){return new E(this.b[0],this.b[1],this.b[2],this.b[3])}static mkBezier(e){return new E(e[0],e[1],e[2],e[3])}curvature(e){let t=this.G(e);return this.F(e)/t}F(e){return this.Xp(e)*this.Ypp(e)-this.Yp(e)*this.Xpp(e)}G(e){let t=this.Xp(e),r=this.Yp(e),i=t*t+r*r;return Math.sqrt(i*i*i)}Xp(e){return 3*this.l.x*e*e+2*this.e.x*e+this.c.x}Ypp(e){return 6*this.l.y*e+2*this.e.y}Yp(e){return 3*this.l.y*e*e+2*this.e.y*e+this.c.y}Xpp(e){return 6*this.l.x*e+2*this.e.x}Xppp(e){return 6*this.l.x}Yppp(e){return 6*this.l.y}curvatureDerivative(e){let t=this.G(e);return(this.Fp(e)*t-this.Gp(e)*this.F(e))/(t*t)}Fp(e){return this.Xp(e)*this.Yppp(e)-this.Yp(e)*this.Xppp(e)}Fpp(e){return this.Xpp(e)*this.Yppp(e)-this.Ypp(e)*this.Xppp(e)}closestParameter(e){let t=0,r=Number.MAX_VALUE;for(let i=0;i<9;i++){let n=e.sub(this.value(.125*i)),s=n.dot(n);s<r&&(r=s,t=.125*i)}return w.closestPoint(this,e,t,0,1)}curvatureSecondDerivative(e){let t=this.G(e);return(this.Qp(e)*t-2*this.Q(e)*this.Gp(e))/(t*t*t)}Q(e){return this.Fp(e)*this.G(e)-this.Gp(e)*this.F(e)}Qp(e){return this.Fpp(e)*this.G(e)-this.Gpp(e)*this.F(e)}Gpp(e){let t=this.Xp(e),r=this.Yp(e),i=this.Xpp(e),n=this.Ypp(e),s=this.Xppp(e),o=this.Yppp(e),a=Math.sqrt(t*t+r*r),l=t*i+r*n;return 3*(l*l/a+a*(i*i+t*s+n*n+r*o))}Gp(e){let t=this.Xp(e),r=this.Yp(e),i=this.Xpp(e);return 3*Math.sqrt(t*t+r*r)*(t*i+r*this.Ypp(e))}getParameterAtLength(e){let t=0,r=1;for(;r-t>l.tolerance;){let i=(r+t)/2,n=this.evaluateError(e,i);if(n>0)r=i;else{if(!(n<0))return i;t=i}}return(t+r)/2}evaluateError(e,t){let r=1-t,i=g.mkPoint(r,this.b[0],t,this.b[1]),n=g.mkPoint(r,this.b[1],t,this.b[2]),s=g.mkPoint(r,this.b[2],t,this.b[3]),o=g.mkPoint(r,i,t,n),a=g.mkPoint(r,n,t,s),h=g.mkPoint(r,o,t,a),u=E.lengthOnControlPolygon(this.b[0],i,o,h);return u>e+l.distanceEpsilon?1:u<e-l.distanceEpsilon?-1:0}}(en=el||(el={}))[en.Outside=0]="Outside",en[en.Boundary=1]="Boundary",en[en.Inside=2]="Inside";class C{static fromJSON(e){let t=new C;for(let r of e.segs)switch(r.tag){case"bezier":t.addSegment(E.fromJSON(r.segData));break;case"ellipse":t.addSegment(T.fromJSON(r.segData));break;case"lineSegment":t.addSegment(b.fromJSON(r.segData));break;default:throw Error("not implemented")}return t}toJSON(){return{segs:this.segs.map(e=>(function(e){if(e instanceof T)return{tag:"ellipse",segData:e.toJSON()};if(e instanceof b)return{tag:"lineSegment",segData:e.toJSON()};if(e instanceof E)return{tag:"bezier",segData:e.toJSON()};throw Error("not implemented")})(e))}}static CurvesIntersect(e,t){return e===t||null!=C.intersectionOne(e,t,!1)}static lengthWithInterpolationAndThreshold(e,t){throw Error("not implemented")}static lengthWithInterpolation(e){throw"not implemented"}get parStart(){return 0}get parEnd(){return this.parEnd_}lengthPartial(e,t){this.adjustStartEndEndParametersToDomain({start:e,end:t});let r=this.getSegIndexParam(e),i=this.getSegIndexParam(t);if(r.segIndex<i.segIndex){let e=this.segs[r.segIndex],t=e.lengthPartial(r.par,e.parEnd);for(let e=r.segIndex+1;e<i.segIndex;e++)t+=this.segs[e].length;return t+(e=this.segs[i.segIndex]).lengthPartial(e.parStart,i.par)}throw Error("not implemented.")}reverse(){let e=new C;for(let t=this.segs.length-1;t>=0;t--)e.addSegment(this.segs[t].reverse());return e}constructor(){this.segs=[],this.parEnd_=0}mkCurveWithSegs(e){for(let t of(this.segs=e,e))this.parEnd_+=C.paramSpan(t)}get start(){return this.segs[0].start}get end(){return this.segs[this.segs.length-1].end}scaleFromOrigin(e,t){let r=new C;for(let i of this.segs)r.addSegment(i.scaleFromOrigin(e,t));return r}trim(e,t){let r={start:e,end:t};this.adjustStartEndEndParametersToDomain(r);let i=this.getSegIndexParam(r.start),n=this.getSegIndexParam(r.end);if(i.segIndex===n.segIndex)return this.segs[i.segIndex].trim(i.par,n.par);let s=new C;i.par<this.segs[i.segIndex].parEnd&&(s=s.addSegment(this.segs[i.segIndex].trim(i.par,this.segs[i.segIndex].parEnd)));for(let e=i.segIndex+1;e<n.segIndex;e++)s=s.addSegment(this.segs[e]);return this.segs[n.segIndex].parStart<n.par&&(s=s.addSegment(this.segs[n.segIndex].trim(this.segs[n.segIndex].parStart,n.par))),s}translate(e){for(let t of this.segs)t.translate(e);this.boundingBox_&&(this.boundingBox_=M.translate(this.boundingBox_,e)),this.pBNode=null}adjustStartEndEndParametersToDomain(e){if(e.start>e.end){let t=e.start;e.start=e.end,e.end=t}e.start<this.parStart&&(e.start=this.parStart),e.end>this.parEnd&&(e.end=this.parEnd)}trimWithWrap(e,t){if(e<t)return this.trim(e,t);let r=new C;return r.addSegment(this.trim(e,this.parEnd)),r.addSegment(this.trim(this.parStart,t)),r}addSegs(e){for(let t of e)this.addSegment(t);return this}addSegment(e){if(null==e)return this;if(this.boundingBox_=null,e instanceof C)for(let t of e.segs)this.segs.push(t),this.parEnd_+=C.paramSpan(t);else this.segs.push(e),this.parEnd_+=C.paramSpan(e);return this}pNodeOverICurve(){if(null!=this.pBNode)return this.pBNode;let e=[],t=[];for(let r of this.segs){let i=r.pNodeOverICurve();e.push(i.parallelogram),t.push(i)}return this.pBNode={parallelogram:v.getParallelogramOfAGroup(e),seg:this,leafBoxesOffset:l.defaultLeafBoxesOffset,node:{children:t}},this.pBNode}static intersectionOne(e,t,r){let i=C.curveCurveXWithParallelogramNodesOne(e.pNodeOverICurve(),t.pNodeOverICurve());return r&&null!=i&&(i=C.liftIntersectionToCurves(e,t,i)),i}static getAllIntersections(e,t,r){return e instanceof b?C.getAllIntersectionsOfLineAndICurve(e,t,r):C.getAllIntersectionsInternal(e,t,r)}static getAllIntersectionsInternal(e,t,r){let i=[];if(C.curveCurveXWithParallelogramNodes(e.pNodeOverICurve(),t.pNodeOverICurve(),i),r)for(let r=0;r<i.length;r++)i[r]=C.liftIntersectionToCurves(e,t,i[r]);return i}static getAllIntersectionsOfLineAndICurve(e,t,r){return t instanceof A?C.getAllIntersectionsOfLineAndPolyline(e,t):t instanceof C?C.getAllIntersectionsOfLineAndCurve(e,t,r):t instanceof T&&t.isArc()?C.getAllIntersectionsOfLineAndArc(e,t):C.getAllIntersectionsInternal(e,t,r)}static getAllIntersectionsOfLineAndCurve(e,t,r){let i=[],n=e.pNodeOverICurve(),s=t.pNodeOverICurve();if(!1===v.intersect(n.parallelogram,s.parallelogram))return i;let o=0;for(let n of t.segs){let s=C.getAllIntersections(e,n,!1);if(r){for(let e of s)e.par1+=o-n.parStart,e.seg1=t;o+=n.parEnd-n.parStart}for(let e of s)!C.alreadyInside(i,e)&&i.push(e)}return i}static closeIntersections(e,t){return g.close(e.x,t.x,l.intersectionEpsilon)}static closeIntersectionPoints(e,t){return g.close(e,t,l.intersectionEpsilon)}static alreadyInside(e,t){for(let r=0;r<e.length;r++){let i=e[r];if(C.closeIntersections(i,t))return!0}return!1}static getAllIntersectionsOfLineAndArc(e,t){let r=e.end.sub(e.start),i=[],n=r.length;if(n<l.distanceEpsilon){let r=e.start.sub(t.center);if(c(r.length,t.aAxis.length)){let n=g.angle(t.aAxis,r);t.parStart-l.tolerance<=n&&(n=Math.max(n,t.parStart))<=t.parEnd+l.tolerance&&(n=Math.min(t.parEnd,n),i.push(new S(0,n,e.start,e,t)))}return i}let s=r.rotate90Ccw().div(n),o=e.start.sub(t.center).dot(s),a=t.center.add(s.mul(o)),h=t.aAxis.length,u=Math.abs(o);if(h<u-l.distanceEpsilon)return i;if(r=s.rotate90Cw(),c(h,u))C.tryToAddPointToLineCircleCrossing(e,t,i,a,n,r);else{let s=Math.sqrt(h*h-o*o),l=r.mul(s);C.tryToAddPointToLineCircleCrossing(e,t,i,a.add(l),n,r),C.tryToAddPointToLineCircleCrossing(e,t,i,a.sub(l),n,r)}return i}static tryToAddPointToLineCircleCrossing(e,t,r,i,n,s){let o=i.sub(e.start).dot(s);if(o<-l.distanceEpsilon||(o=Math.max(o,0))>n+l.distanceEpsilon)return;o=Math.min(o,n)/n;let a=g.angle(t.aAxis,i.sub(t.center));t.parStart-l.tolerance<=a&&(a=Math.max(a,t.parStart))<=t.parEnd+l.tolerance&&(a=Math.min(t.parEnd,a),r.push(new S(o,a,i,e,t)))}static getAllIntersectionsOfLineAndPolyline(e,t){let r=[],i=0,n=t.startPoint;for(;null!=n&&null!=n.getNext();n=n.getNext()){let s=C.crossTwoLineSegs(e.start,e.end,n.point,n.getNext().point,0,1,0,1);s&&(C.adjustSolution(e.start,e.end,n.point,n.getNext().point,s),!C.oldIntersection(r,s.x)&&r.push(new S(s.aSol,i+s.bSol,s.x,e,t))),i++}if(t.closed){let s=C.crossTwoLineSegs(e.start,e.end,n.point,t.start,0,1,0,1);s&&(C.adjustSolution(e.start,e.end,n.point,t.start,s),!C.oldIntersection(r,s.x)&&r.push(new S(s.aSol,i+s.bSol,s.x,e,t)))}return r}static adjustSolution(e,t,r,i,n){C.closeIntersectionPoints(n.x,e)?(n.x=e,n.aSol=0):C.closeIntersectionPoints(n.x,t)&&(n.x=t,n.aSol=1),C.closeIntersectionPoints(n.x,r)?(n.x=r,n.bSol=Math.floor(n.bSol)):C.closeIntersectionPoints(n.x,i)&&(n.x=i,n.bSol=Math.ceil(n.bSol))}static curveCurveXWithParallelogramNodesOne(e,t){if(!v.intersect(e.parallelogram,t.parallelogram))return null;let r=e.node,i=t.node,n=r.hasOwnProperty("children"),s=i.hasOwnProperty("children");if(n&&s)for(let e of r.children)for(let t of i.children){let r=C.curveCurveXWithParallelogramNodesOne(e,t);if(null!=r)return r}else if(s)for(let t of i.children){let r=C.curveCurveXWithParallelogramNodesOne(e,t);if(null!=r)return r}else if(!n)return C.crossOverIntervalsOne(e,t);else for(let e of r.children){let r=C.curveCurveXWithParallelogramNodesOne(e,t);if(null!=r)return r}return null}static curveCurveXWithParallelogramNodes(e,t,r){if(!v.intersect(e.parallelogram,t.parallelogram))return;let i=e.node.hasOwnProperty("children"),n=t.node.hasOwnProperty("children");if(i&&n)for(let i of e.node.children)for(let e of t.node.children)C.curveCurveXWithParallelogramNodes(i,e,r);else if(n)for(let i of t.node.children)C.curveCurveXWithParallelogramNodes(e,i,r);else if(i)for(let i of e.node.children)C.curveCurveXWithParallelogramNodes(i,t,r);else r=C.crossOverLeaves(e,t,r)}static crossOverIntervalsOne(e,t){let r=e.node,i=t.node,n=(r.high-r.low)/2,s=(i.high-i.low)/2;for(let o=1;o<2;o++){let a=o*n+r.low;for(let n=1;n<2;n++){let l;let h=n*s+i.low;if(null==r.chord&&null==i.chord?l=C.crossWithinIntervalsWithGuess(e.seg,t.seg,r.low,r.high,i.low,i.high,a,h):null!=r.chord&&null==i.chord?l=C.crossWithinIntervalsWithGuess(r.chord,t.seg,0,1,i.low,i.high,.5*o,h):null==r.chord?(l=C.crossWithinIntervalsWithGuess(e.seg,i.chord,r.low,r.high,0,1,a,.5*n))&&(l.bSol=i.low+l.bSol*(i.high-i.low)):(l=C.crossWithinIntervalsWithGuess(r.chord,i.chord,0,1,0,1,.5*o,.5*n))&&(l.aSol=r.low+l.aSol*(r.high-r.low),l.bSol=i.low+l.bSol*(i.high-i.low)),l)return C.createIntersectionOne(e,t,l.aSol,l.bSol,l.x)}}return C.goDeeperOne(e,t)}static crossOverLeaves(e,t,r){let i;let n=e.node,s=t.node,o=!1,a=(n.high-n.low)/2+n.low,l=(s.high-s.low)/2+s.low;return null==n.chord&&null==s.chord?i=C.crossWithinIntervalsWithGuess(e.seg,t.seg,n.low,n.high,s.low,s.high,a,l):null!=n.chord&&null==s.chord?(i=C.crossWithinIntervalsWithGuess(n.chord,t.seg,0,1,s.low,s.high,.5,l))&&(i.aSol=n.low+i.aSol*(n.high-n.low)):null==n.chord?(i=C.crossWithinIntervalsWithGuess(e.seg,s.chord,n.low,n.high,0,1,a,.5))&&(i.bSol=s.low+i.bSol*(s.high-s.low)):(i=C.crossWithinIntervalsWithGuess(n.chord,s.chord,0,1,0,1,.5,.5))&&(i.bSol=s.low+i.bSol*(s.high-s.low),i.aSol=n.low+i.aSol*(n.high-n.low)),i&&(C.addIntersection(e,t,r,i),o=!0),!o&&C.goDeeper(r,e,t),r}static addIntersection(e,t,r,i){let n=e.node;C.closeIntersectionPoints(i.x,e.seg.value(n.low))?(i.x=e.seg.value(n.low),i.aSol=n.low):C.closeIntersectionPoints(i.x,e.seg.value(n.high))&&(i.x=e.seg.value(n.high),i.aSol=n.high);let s=t.node;if(C.closeIntersectionPoints(i.x,t.seg.value(s.low))?(i.x=t.seg.value(s.low),i.bSol=s.low):C.closeIntersectionPoints(i.x,t.seg.value(s.high))&&(i.x=t.seg.value(s.high),i.bSol=s.high),!C.oldIntersection(r,i.x)){let n=new S(i.aSol,i.bSol,i.x,e.seg,t.seg);r.push(n)}}static oldIntersection(e,t){for(let r of e)if(t.sub(r.x).length<100*l.distanceEpsilon)return!0;return!1}static createIntersectionOne(e,t,r,i,n){let s=e.node,o=t.node;return C.closeIntersectionPoints(n,e.seg.value(s.low))?(n=e.seg.value(s.low),r=s.low):C.closeIntersectionPoints(n,e.seg.value(s.high))&&(n=e.seg.value(s.high),r=s.high),C.closeIntersectionPoints(n,t.seg.value(o.low))?(n=t.seg.value(o.low),i=o.low):C.closeIntersectionPoints(n,t.seg.value(o.high))&&(n=t.seg.value(o.high),i=o.high),new S(r,i,n,e.seg,t.seg)}static liftIntersectionToCurves_(e,t,r,i,n,s,o){let a=e instanceof C?C.liftParameterToCurve(e,r-s.parStart,s):r;return new S(a,t instanceof C?C.liftParameterToCurve(t,i-o.parStart,o):i,n,e,t)}static DropIntersectionToSegs(e){let t,r,i,n;if(e.seg0 instanceof C){let i=e.seg0.getSegParam(e.par0);t=i.seg,r=i.par}else r=e.par0,t=e.seg0;if(e.seg1 instanceof C){let t=e.seg1.getSegParam(e.par1);n=t.par,i=t.seg}else n=e.par1,i=e.seg1;return new S(r,n,e.x,t,i)}static liftIntersectionToCurves(e,t,r){return C.liftIntersectionToCurves_(e,t,r.par0,r.par1,r.x,r.seg0,r.seg1)}static liftParameterToCurve(e,t,r){if(e===r)return t;if(!e.hasOwnProperty("segs"))return;let i=0;for(let n of e.segs){if(n===r)return t+i;i+=C.paramSpan(n)}throw"bug in liftParameterToCurve"}static paramSpan(e){return e.parEnd-e.parStart}static goDeeperOne(e,t){let r=e.node,i=t.node;if(e.leafBoxesOffset>l.distanceEpsilon&&t.leafBoxesOffset>l.distanceEpsilon){let n=_.createParallelogramNodeForCurveSeg(r.low,r.high,e.seg,e.leafBoxesOffset/2),s=_.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2);return C.curveCurveXWithParallelogramNodesOne(n,s)}if(e.leafBoxesOffset>l.distanceEpsilon){let i=_.createParallelogramNodeForCurveSeg(r.low,r.high,e.seg,e.leafBoxesOffset/2);return C.curveCurveXWithParallelogramNodesOne(i,t)}if(t.leafBoxesOffset>l.distanceEpsilon){let r=_.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2);return C.curveCurveXWithParallelogramNodesOne(e,r)}let n=e.seg.value(r.low),s=e.seg.value(r.high);if(!g.closeDistEps(n,s)){let r=t.seg.value(i.low),o=t.seg.value(i.high);if(!g.closeDistEps(r,o)){let i=e.seg instanceof b?e.seg:b.mkPP(n,s),a=t.seg instanceof b?t.seg:b.mkPP(r,o),l=C.crossWithinIntervalsWithGuess(i,a,0,1,0,1,.5,.5);if(l)return C.adjustParameters(e,i,t,a,l),C.createIntersectionOne(e,t,l.aSol,l.bSol,l.x)}}return null}static goDeeper(e,t,r){let i=t.node,n=r.node,s=t.leafBoxesOffset>l.distanceEpsilon,o=r.leafBoxesOffset>l.distanceEpsilon;if(s&&o){let s=_.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2),o=_.createParallelogramNodeForCurveSeg(n.low,n.high,r.seg,r.leafBoxesOffset/2);C.curveCurveXWithParallelogramNodes(s,o,e)}else if(s){let n=_.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2);C.curveCurveXWithParallelogramNodes(n,r,e)}else if(o){let i=_.createParallelogramNodeForCurveSeg(n.low,n.high,r.seg,r.leafBoxesOffset/2);C.curveCurveXWithParallelogramNodes(t,i,e)}else{let s=t.seg.value(i.low),o=t.seg.value(i.high);if(!g.closeDistEps(s,o)){let i=r.seg.value(n.low),a=r.seg.value(n.high);if(!g.closeDistEps(i,a)){let n=t.seg instanceof b?t.seg:b.mkPP(s,o),l=r.seg instanceof b?r.seg:b.mkPP(i,a),h=C.crossWithinIntervalsWithGuess(n,l,0,1,0,1,.5,.5);h&&(C.adjustParameters(t,n,r,l,h),C.addIntersection(t,r,e,h))}}}}static adjustParameters(e,t,r,i,n){if(t!==e.seg&&e.seg instanceof A==!1)n.aSol=e.seg.closestParameter(n.x);else{let t=e.node;n.aSol=t.low+n.aSol*(t.high-t.low)}if(i!==r.seg&&r.seg instanceof A==!1)n.bSol=r.seg.closestParameter(n.x);else{let e=r.node;n.bSol=e.low+n.bSol*(e.high-e.low)}}getSegParam(e){let t=this.parStart;for(let r of this.segs){let i=t+r.parEnd-r.parStart;if(e>=t&&e<=i)return{par:e-t+r.parStart,seg:r};t=i}let r=this.segs[this.segs.length-1];return{seg:r,par:r.parEnd}}getSegIndexParam(e){let t=0,r=this.segs.length;for(let i=0;i<r;i++){let r=this.segs[i],n=t+r.parEnd-r.parStart;if(e>=t&&e<=n)return{segIndex:i,par:e-t+r.parStart};t=n}let i=this.segs[r-1];return{segIndex:r-1,par:i.parEnd}}value(e){var t;return(t=this.getSegParam(e)).seg.value(t.par)}derivative(e){var t;return(t=this.getSegParam(e)).seg.derivative(t.par)}secondDerivative(e){var t;return(t=this.getSegParam(e)).seg.secondDerivative(t.par)}thirdDerivative(e){var t;return(t=this.getSegParam(e)).seg.thirdDerivative(t.par)}static crossWithinIntervalsWithGuess(e,t,r,i,n,s,o,a){if(e instanceof b&&t instanceof b){let o=C.crossTwoLineSegs(e.start,e.end,t.start,t.end,r,i,n,s);if(void 0!==o)return o}let h=C.minDistWithinIntervals(e,t,r,i,n,s,o,a);if(null==h)return;let u=h.aX.sub(h.bX);return u.dot(u)>=l.distanceEpsilon?void 0:{aSol:h.aSol,bSol:h.bSol,x:g.middle(h.aX,h.bX)}}static crossTwoLineSegs(e,t,r,i,n,s,o,h){let u=t.sub(e),c=r.sub(i),d=r.sub(e),f=a.solve(u.x,c.x,d.x,u.y,c.y,d.y);if(null==f)return;let p=f.x,g=f.y,m=e.add(u.mul(p));if(p<n-l.tolerance||(p=Math.max(p,n))>s+l.tolerance)return;if(p=Math.min(p,s),!(g<o-l.tolerance)){if(!((g=Math.max(g,o))>h+l.tolerance))return{aSol:p,bSol:g=Math.min(g,h),x:m}}}static PointRelativeToCurveLocation(e,t){if(!t.boundingBox.contains(e))return el.Outside;let r=2*t.boundingBox.diagonal,i=Math.PI/180,n=0;for(let s=13;s<360;s+=13){let o=new g(Math.cos(s*i),Math.sin(s*i)),a=b.mkPP(e,e.add(o.mul(r))),l=this.getAllIntersectionsOfLineAndICurve(a,t,!0);if(C.AllIntersectionsAreGood(l,t)){for(let t of l)if(g.closeDistEps(t.x,e))return el.Boundary;if(l.length%2==1?n++:n--,n>=2)return el.Inside;if(n<=-2)return el.Outside}}return el.Boundary}static AllIntersectionsAreGood(e,t){let r=t.hasOwnProperty("segs"),i=null;if(!r&&t instanceof A&&(i=t.toCurve()),i){for(let t of e)if(!C.RealCut(C.DropIntersectionToSegs(t),i,!1))return!1}return!0}static RealCut(e,t,r){let i=e.seg0,n=e.seg1,s=e.par0,o=e.par1,a=e.x,h=i.derivative(s).normalize(),u=n.derivative(o).normalize().rotate(Math.PI/2);if(g.closeDistEps(a,n.end)){let e=null;for(let r=0;r<t.segs.length-1;r++)if(t.segs[r]===n){e=t.segs[r+1];break}if(null==e)return!1;let r=h.rotate(Math.PI/2);return!(r.dot(n.derivative(n.parEnd))*r.dot(e.derivative(e.parStart))<l.tolerance)}if(g.closeDistEps(a,n.start)){let e=null;for(let r=t.segs.length-1;r>0;r--)if(t.segs[r]===n){e=t.segs[r-1];break}if(null==e)return!1;let r=h.rotate(Math.PI/2);return!(r.dot(n.derivative(n.parStart))*r.dot(e.derivative(e.parEnd))<l.tolerance)}let c=h.dot(u);return r?c>l.distanceEpsilon:Math.abs(c)>l.distanceEpsilon}static realCutWithClosedCurve(e,t,r){let i=e.seg0,n=e.seg1,s=e.par0,o=e.par1,a=e.x,h=i.derivative(s).normalize(),u=n.derivative(o).normalize().rotate(Math.PI/2);if(g.closeDistEps(a,n.end)){let e=null;for(let r=0;r<t.segs.length;r++)if(t.segs[r]===n){e=t.segs[(r+1)%t.segs.length];break}if(null==e)throw Error();let r=h.rotate(Math.PI/2);return!(r.dot(n.derivative(n.parEnd))*r.dot(e.derivative(e.parStart))<l.tolerance)}if(g.closeDistEps(a,n.start)){let e=null;for(let r=0;r<t.segs.length;r++)if(t.segs[r]===n){e=t.segs[r>0?r-1:t.segs.length-1];break}let r=h.rotate(Math.PI/2);return!(r.dot(n.derivative(n.parStart))*r.dot(e.derivative(e.parEnd))<l.tolerance)}let c=h.dot(u);return r?c>l.distanceEpsilon:Math.abs(c)>l.distanceEpsilon}static minDistWithinIntervals(e,t,r,i,n,s,o,a){let l=new P(e,t,r,i,n,s,o,a);return l.solve(),l.success?{aSol:l.aSolution,bSol:l.bSolution,aX:l.aPoint,bX:l.bPoint}:void 0}offsetCurve(e,t){throw Error("Method not implemented.")}get boundingBox(){if(this.boundingBox_)return this.boundingBox_;if(0===this.segs.length)this.boundingBox_=M.mkEmpty();else{let e=this.segs[0].boundingBox.clone();for(let t=1;t<this.segs.length;t++)e.addRecSelf(this.segs[t].boundingBox);return this.boundingBox_=e}}clone(){let e=new C;for(let t of this.segs)e.addSegment(t.clone());return null!=this.boundingBox_&&(e.boundingBox_=this.boundingBox_.clone()),e}getParameterAtLength(e){let t=0;for(let r of this.segs){let i=r.length;if(i>=e)return t+r.getParameterAtLength(e);e-=i,t+=r.parEnd-r.parStart}return this.parEnd}get length(){let e=0;for(let t of this.segs)e+=t.length;return e}transform(e){let t=new C;for(let r of this.segs)t.addSegment(r.transform(e));return this.boundingBox_&&(t.boundingBox_=this.boundingBox_.transform(e)),t}closestParameterWithinBounds(e,t,r){let i=0,n=Number.MAX_VALUE,s=0;for(let o of this.segs){if(s>r)break;let a=C.paramSpan(o);if(s+a>=t){let a=Math.max(o.parStart,o.parStart+(t-s)),l=Math.min(o.parEnd,o.parStart+(r-s)),h=o.closestParameterWithinBounds(e,a,l),u=e.sub(o.value(h)),c=u.dot(u);c<n&&(i=s+h-o.parStart,n=c)}s+=a}return i}closestParameter(e){let t=0,r=Number.MAX_VALUE,i=0;for(let n of this.segs){let s=n.closestParameter(e),o=e.sub(n.value(s)),a=o.dot(o);if(a<r){if(t=i+s-n.parStart,0===a)break;r=a}i+=C.paramSpan(n)}return t}static addLineSegment(e,t,r){return e.addSegment(b.mkPP(t,r))}static addLineSegmentCNNP(e,t,r,i){return C.addLineSegment(e,new g(t,r),i)}static addLineSegmentCNNNN(e,t,r,i,n){C.addLineSegment(e,new g(t,r),new g(i,n))}static continueWithLineSegmentNN(e,t,r){C.addLineSegment(e,e.end,new g(t,r))}static continueWithLineSegmentP(e,t){C.addLineSegment(e,e.end,t)}static closeCurve(e){return C.continueWithLineSegmentP(e,e.start),e}leftDerivative(e){let t=this.tryToGetLeftSegment(e);return null!=t?t.derivative(t.parEnd):this.derivative(e)}rightDerivative(e){let t=this.tryToGetRightSegment(e);return null!=t?t.derivative(t.parStart):this.derivative(e)}tryToGetLeftSegment(e){if(Math.abs(e-this.parStart)<l.tolerance)return this.start.equal(this.end)?this.segs[this.segs.length-1]:null;for(let t of this.segs)if(Math.abs(e-=C.paramSpan(t))<l.tolerance)return t;return null}tryToGetRightSegment(e){if(Math.abs(e-this.parEnd)<l.tolerance)return this.start===this.end?this.segs[0]:null;for(let t of this.segs){if(Math.abs(e)<l.tolerance)return t;e-=C.paramSpan(t)}return null}static ClosestPoint(e,t){return e.value(e.closestParameter(t))}static CurveIsInsideOther(e,t){if(!t.boundingBox.containsRect(e.boundingBox))return!1;let r=C.getAllIntersections(e,t,!0);if(0===r.length)return C.NonIntersectingCurveIsInsideOther(e,t);if(1===r.length)return e.start.equal(r[0].x)?C.PointRelativeToCurveLocation(e.value((e.parStart+e.parEnd)/2),t)==el.Inside:C.PointRelativeToCurveLocation(e.start,t)===el.Inside;for(let i of C.PointsBetweenIntersections(e,r))if(C.PointRelativeToCurveLocation(i,t)===el.Outside)return!1;return!0}static*PointsBetweenIntersections(e,t){t.sort((e,t)=>e.par0-t.par0);for(let r=0;r<t.length-1;r++)yield e.value((t[r].par0+t[r+1].par0)/2);let r=t[t.length-1].par0,i=t[0].par0,n=e.parEnd-r+(i-e.parStart),s=r+n/2;s>e.parEnd&&(s=e.parStart+(s-e.parEnd)),yield e.value(s)}static NonIntersectingCurveIsInsideOther(e,t){for(let r=e.parStart;r<e.parEnd;r+=.5){let i=C.PointRelativeToCurveLocation(e.value(r),t);if(el.Boundary!==i)return el.Inside===i}return el.Outside!==C.PointRelativeToCurveLocation(e.end,t)}static ClosedCurveInteriorsIntersect(e,t){if(!t.boundingBox.intersects(e.boundingBox))return!1;let r=C.getAllIntersections(e,t,!0);if(0===r.length)return C.NonIntersectingCurveIsInsideOther(e,t)||C.NonIntersectingCurveIsInsideOther(t,e);if(1===r.length)return e.start.equal(r[0].x)?C.PointRelativeToCurveLocation(e.value((e.parStart+e.parEnd)/2),t)!==el.Inside&&t.start.equal(r[0].x)?C.PointRelativeToCurveLocation(t.value((t.parStart+t.parEnd)/2),e)===el.Inside:C.PointRelativeToCurveLocation(t.start,e)===el.Inside:C.PointRelativeToCurveLocation(e.start,t)===el.Inside;for(let i of C.PointsBetweenIntersections(e,r))if(C.PointRelativeToCurveLocation(i,t)===el.Inside)break;return!0}curvature(e){let t=this.getSegParam(e);return t.seg.curvature(t.par)}curvatureDerivative(e){throw Error("Not implemente")}curvatureSecondDerivative(e){throw Error("Not implemented")}static createBezierSeg(e,t,r,i,n){let s=g.mkPoint(e,r.point,1-e,i.point),o=g.mkPoint(t,n.point,1-t,i.point),a=i.point.mul(2/3);return new E(s,s.div(3).add(a),a.add(o.div(3)),o)}static createBezierSegN(e,t,r,i){let n=r.mul(i);return new E(e,e.add(n),t.add(n),t)}static findCorner(e){let t=e.next;if(null==t.next)return;let r=t.next;if(null!=r)return{b:t,c:r}}static trimEdgeSplineWithNodeBoundaries(e,t,r,i){let n=r.parStart,s=r.parEnd;null!=e&&(n=C.findNewStart(r,n,e,i)),null!=t&&(s=C.findNewEnd(r,t,i,s));let o=Math.min(n,s),a=Math.max(n,s);return o<a?r.trim(o,a):r}static findNewEnd(e,t,r,i){let n=C.getAllIntersections(e,t,!0);if(0===n.length)return i=e.parEnd;if(r)for(let t of(i=e.parEnd,n))t.par0<i&&(i=t.par0);else for(let t of(i=e.parStart,n))t.par0>i&&(i=t.par0);return i}static findNewStart(e,t,r,i){let n=C.getAllIntersections(e,r,!0);if(0===n.length){t=e.parStart;return}if(i)for(let r of(t=e.parStart,n))r.par0>t&&(t=r.par0);else for(let r of(t=e.parEnd,n))r.par0<t&&(t=r.par0);return t}static polylineAroundClosedCurve(e){if(e instanceof T)return C.refineEllipse(e);if(e instanceof A)return e;if(e instanceof C&&C.allSegsAreLines(e)){let t=new A;for(let r of e.segs)t.addPoint(r.start);if(t.closed=!0,!t.isClockwise())return t.reverse()}return e.boundingBox.perimeter()}static allSegsAreLines(e){for(let t of e.segs)if(!(t instanceof b))return!1;return!0}static refineEllipse(e){let t=e.boundingBox.perimeter(),r=Math.PI/4,i=e.boundingBox.width,n=e.boundingBox.height,s=Math.sqrt(i*i+n*n),o=[];for(let i=0;i<4;i++){let n=r+i*Math.PI/2,a=e.value(n),l=e.derivative(n).normalize().mul(s),h=b.mkPP(a.sub(l),a.add(l));for(let e of C.getAllIntersections(t,h,!0))o.push(e)}o.sort((e,t)=>e.par0<t.par0?-1:e.par0>t.par0?1:0);let a=new A;return o.forEach(e=>a.addPoint(e.x)),a.closed=!0,a}static polyFromBox(e){let t=new A;return t.addPoint(e.leftTop),t.addPoint(e.rightTop),t.addPoint(e.rightBottom),t.addPoint(e.leftBottom),t.closed=!0,t}}class A{constructor(){this.initIsRequired=!0,this.isClosed_=!1}toJSON(){return{points:Array.from(this).map(e=>e.toJSON())}}static fromJSON(e){return A.mkFromPoints(e.points.map(e=>g.fromJSON(e)))}RemoveStartPoint(){let e=this.startPoint.next;e.prev=null,this.startPoint=e,this.setInitIsRequired()}RemoveEndPoint(){let e=this.endPoint.prev;e.next=null,this.endPoint=e,this.setInitIsRequired()}setInitIsRequired(){this.initIsRequired=!0}addPointXY(e,t){this.addPoint(new g(e,t))}isClockwise(){return g.getTriangleOrientation(this.startPoint.point,this.startPoint.next.point,this.startPoint.next.next.point)==eo.Clockwise}addPoint(e){let t=new m;t.polyline=this,t.point=e.clone(),null!=this.endPoint?(this.endPoint.next=t,t.prev=this.endPoint,this.endPoint=t):this.startPoint=this.endPoint=t,this.setInitIsRequired()}PrependPoint(e){let t=m.mkFromPoint(e);t.polyline=this,null!=this.startPoint?!g.closeDistEps(e,this.startPoint.point)&&(this.startPoint.prev=t,t.next=this.startPoint,this.startPoint=t):(this.endPoint=t,this.startPoint=t),this.setInitIsRequired()}*[Symbol.iterator](){for(let e=this.startPoint;null!=e;e=e.next)yield e.point}*polylinePoints(){for(let e=this.startPoint;null!=e;e=e.next)yield e}*skip(e){for(let t=this.startPoint;null!=t;t=t.next)e>0?e--:yield t}static parallelogramOfLineSeg(e,t){let r=t.sub(e).div(2);return v.parallelogramByCornerSideSide(e,r,r)}static mkFromPoints(e){let t=new A;for(let r of e)t.addPoint(r);return t}static mkClosedFromPoints(e){let t=A.mkFromPoints(e);return t.closed=!0,t}calculatePbNode(){let e=[],t=[],r=this.startPoint,i=0;for(;null!=r.next;){let n=A.parallelogramOfLineSeg(r.point,r.next.point);e.push(n),t.push({parallelogram:n,seg:this,leafBoxesOffset:0,node:{low:i,high:i+1,chord:b.mkPP(r.point,r.next.point)}}),r=r.next,i++}if(this.isClosed_){let r=A.parallelogramOfLineSeg(this.endPoint.point,this.startPoint.point);e.push(r),t.push({parallelogram:r,seg:this,leafBoxesOffset:0,node:{low:i,high:i+1,chord:b.mkPP(this.endPoint.point,this.startPoint.point)}})}this.pBNode={parallelogram:v.getParallelogramOfAGroup(e),seg:this,leafBoxesOffset:0,node:{children:t}}}init(){for(let e of(this.bBox=M.rectangleOnPoint(this.startPoint.point),this.skip(1)))this.bBox.add(e.point);this.updateCount(),this.calculatePbNode(),this.initIsRequired=!1}updateCount(){this.count_=0;for(let e=this.startPoint;null!=e;e=e.next)this.count_++}get count(){return this.initIsRequired&&this.init(),this.count_}get closed(){return this.isClosed_}set closed(e){this.isClosed_=e}value(e){this.initIsRequired&&this.init();let t=this.getAdjustedParamAndStartEndPoints(e);return g.convSum(t.t,t.a,t.b)}getAdjustedParamAndStartEndPoints(e){let t=this.startPoint;for(;null!=t.next;){if(e<=1)return{a:t.point,b:t.next.point,t:e};t=t.next,e-=1}if(this.closed&&e<=1)return{a:this.endPoint.point,b:this.startPoint.point,t:e};throw Error("out of the parameter domain")}derivative(e){let t=this.getAdjustedParamAndStartEndPoints(e);return t.b.sub(t.a)}secondDerivative(e){return new g(0,0)}thirdDerivative(e){return new g(0,0)}pNodeOverICurve(){return this.initIsRequired&&this.init(),this.pBNode}get boundingBox(){return this.initIsRequired&&this.init(),this.bBox}get parStart(){return 0}get parEnd(){return this.initIsRequired&&this.init(),this.closed?this.count_:this.count_-1}static polylineFromCurve(e){let t=new A;for(let r of(t.addPoint(e.start),e.segs))t.addPoint(r.end);return t.closed=e.start===e.end,t}trim(e,t){let r=this.toCurve();return(r=r.trim(e,t))instanceof C?A.polylineFromCurve(r):A.mkFromPoints([r.start,r.end])}trimWithWrap(e,t){throw Error("Method not implemented.")}translate(e){let t=this.startPoint;for(;t.point=t.point.add(e),t!==this.endPoint;){;t=t.getNext()}this.setInitIsRequired()}scaleFromOrigin(e,t){throw Error("Method not implemented.")}get start(){return this.startPoint.point}get end(){return this.endPoint.point}reverse(){let e=new A;e.closed=this.closed;let t=this.endPoint;for(;e.addPoint(t.point),t!==this.startPoint;){;t=t.getPrev()}return e}offsetCurve(e,t){throw Error("Method not implemented.")}lengthPartial(e,t){throw Error("Method not implemented.")}get length(){throw Error("Method not implemented.")}getParameterAtLength(e){throw Error("Method not implemented.")}transform(e){let t=new A;for(let r of this.polylinePoints())t.addPoint(e.multiplyPoint(r.point));return t.closed=this.closed,t}closestParameterWithinBounds(e,t,r){throw Error("Method not implemented.")}closestParameter(e){let t=0,r=Number.MAX_VALUE,i=0,n=this.startPoint;for(;null!=n.next;){let s=b.mkPP(n.point,n.next.point),o=s.closestParameter(e),a=s.value(o).sub(e),l=a.dot(a);l<r&&(r=l,t=o+i),n=n.next,i++}if(this.closed){let n=b.mkPP(this.endPoint.point,this.startPoint.point),s=n.closestParameter(e),o=n.value(s).sub(e);o.dot(o)<r&&(t=s+i)}return t}clone(){let e=new A;e.closed=this.closed;let t=this.startPoint;for(;e.addPoint(t.point),t!==this.endPoint;){;t=t.getNext()}return e}leftDerivative(e){throw Error("Method not implemented.")}rightDerivative(e){throw Error("Method not implemented.")}curvature(e){throw Error("Method not implemented.")}curvatureDerivative(e){throw Error("Method not implemented.")}curvatureSecondDerivative(e){throw Error("Method not implemented.")}next(e){var t;return null!==(t=e.next)&&void 0!==t?t:this.closed?this.startPoint:null}prev(e){var t;return null!==(t=e.prev)&&void 0!==t?t:this.closed?this.endPoint:null}toCurve(){let e=new C;C.addLineSegment(e,this.startPoint.point,this.startPoint.next.point);let t=this.startPoint.next;for(;null!=(t=t.next);)C.continueWithLineSegmentP(e,t.point);return this.closed&&C.continueWithLineSegmentP(e,this.startPoint.point),e}RemoveCollinearVertices(){for(let e=this.startPoint.next;null!=e.next;e=e.next)g.getTriangleOrientation(e.prev.point,e.point,e.next.point)===eo.Collinear&&(e.prev.next=e.next,e.next.prev=e.prev);return this.setInitIsRequired(),this}}class I{pad(e){this.width+=2*e}constructor(e,t=e){this.width=e,this.height=t}}class M{transform(e){return M.mkPP(e.multiplyPoint(this.leftTop),e.multiplyPoint(this.rightBottom))}translate(e){return M.mkSizeCenter(this.size,this.center.add(e))}equal(e){return this.left_===e.left&&this.right_===e.right&&this.top_===e.top&&this.bottom_===e.bottom}equalEps(e){return c(this.left_,e.left)&&c(this.right_,e.right)&&c(this.top_,e.top)&&c(this.bottom_,e.bottom)}static mkSizeCenter(e,t){let r=e.width/2,i=e.height/2;return new M({left:t.x-r,right:t.x+r,bottom:t.y-i,top:t.y+i})}constructor(e){this.left_=e.left,this.right_=e.right,this.top_=e.top,this.bottom=e.bottom}add_rect(e){return this.addRec(e)}contains_point(e){return this.contains(e)}contains_rect(e){return this.containsRect(e)}intersection_rect(e){return this.intersection(e)}intersects_rect(e){return this.intersects(e)}unite(e){return M.rectangleOfTwo(this,e)}contains_point_radius(e,t){return this.containsWithPadding(e,t)}intersects(e){return this.intersectsOnX(e)&&this.intersectsOnY(e)}intersection(e){if(!this.intersects(e)){let e=M.mkEmpty();return e.setToEmpty(),e}let t=Math.max(this.left,e.left),r=Math.min(this.right,e.right),i=Math.max(this.bottom,e.bottom);return new M({left:t,bottom:i,right:r,top:Math.min(this.top,e.top)})}get center(){return this.leftTop.add(this.rightBottom).mul(.5)}set center(e){let t=this.leftTop.add(this.rightBottom).mul(.5),r=e.sub(t);this.leftTop=this.leftTop.add(r),this.rightBottom=this.rightBottom.add(r)}intersectsOnY(e){return!(e.bottom_>this.top_+l.distanceEpsilon)&&!(e.top_<this.bottom_-l.distanceEpsilon)&&!0}intersectsOnX(e){return!(e.left>this.right_+l.distanceEpsilon)&&!(e.right<this.left_-l.distanceEpsilon)&&!0}static mkEmpty(){return new M({left:0,right:-1,bottom:0,top:-1})}get left(){return this.left_}set left(e){this.left_=e,this.onUpdated()}get right(){return this.right_}set right(e){this.right_=e,this.onUpdated()}get top(){return this.top_}set top(e){this.top_=e,this.onUpdated()}get bottom(){return this.bottom_}set bottom(e){this.bottom_=e,this.onUpdated()}get leftBottom(){return new g(this.left_,this.bottom_)}set leftBottom(e){this.left_=e.x,this.bottom=e.y}get rightTop(){return new g(this.right_,this.top_)}set rightTop(e){this.right_=e.x,this.top_=e.y}get leftTop(){return new g(this.left_,this.top_)}set leftTop(e){this.left_=e.x,this.top_=e.y}get rightBottom(){return new g(this.right_,this.bottom_)}set rightBottom(e){this.right_=e.x,this.bottom=e.y}onUpdated(){}static mkPP(e,t){let r=new M({left:e.x,right:e.x,top:e.y,bottom:e.y});return r.add(t),r}static rectangleOnPoint(e){return new M({left:e.x,right:e.x,top:e.y,bottom:e.y})}static mkLeftBottomSize(e,t,r){let i=e+r.width;return new M({left:e,right:i,top:t+r.height,bottom:t})}static getRectangleOnCoords(e,t,r,i){let n=new M({left:e,bottom:t,right:e,top:t});return n.add(new g(r,i)),n}static mkOnPoints(e){let t=M.mkEmpty();for(let r of e)t.add(r);return t}static mkOnRectangles(e){let t=M.mkEmpty();for(let r of e)t.addRecSelf(r);return t}get width(){return this.right_-this.left_}set width(e){let t=e/2,r=(this.left_+this.right_)/2;this.left_=r-t,this.right_=r+t}isEmpty(){return this.right<this.left}setToEmpty(){this.left=0,this.right=-1}get height(){return this.top_-this.bottom_}set height(e){let t=e/2,r=(this.top_+this.bottom_)/2;this.top_=r+t,this.bottom=r-t}static rectangleOfTwo(e,t){let r=new M({left:e.left_,right:e.right_,top:e.top_,bottom:e.bottom_});return r.addRecSelf(t),r}containsWithPadding(e,t){return this.left_-t-l.distanceEpsilon<=e.x&&e.x<=this.right_+t+l.distanceEpsilon&&this.bottom_-t-l.distanceEpsilon<=e.y&&e.y<=this.top_+t+l.distanceEpsilon}get area(){return(this.right_-this.left_)*(this.top_-this.bottom_)}add(e){this.isEmpty()?(this.left_=this.right_=e.x,this.top_=this.bottom=e.y):(this.left_>e.x&&(this.left_=e.x),this.top_<e.y&&(this.top_=e.y),this.right_<e.x&&(this.right_=e.x),this.bottom_>e.y&&(this.bottom=e.y))}addRecSelf(e){this.add(e.leftTop),this.add(e.rightBottom)}addRec(e){let t=this.clone();return t.add(e.leftTop),t.add(e.rightBottom),t}static translate(e,t){let r=e.clone();return r.center=e.center.add(t),r}static transform(e,t){return M.mkPP(t.multiplyPoint(e.leftTop),t.multiplyPoint(e.rightBottom))}contains(e){return this.containsWithPadding(e,0)}containsRect(e){return this.contains(e.leftTop)&&this.contains(e.rightBottom)}containsRectWithPadding(e,t){return this.containsWithPadding(e.leftTop,t)&&this.containsWithPadding(e.rightBottom,t)}get diagonal(){return Math.sqrt(this.width*this.width+this.height*this.height)}padWidth(e){this.left-=e,this.right+=e}padHeight(e){this.top+=e,this.bottom-=e}pad(e){e<-this.width/2&&(e=-this.width/2),e<-this.height/2&&(e=-this.height/2),this.padWidth(e),this.padHeight(e)}padEverywhere(e){this.left-=e.left,this.right+=e.right,this.bottom-=e.bottom,this.top+=e.top}static intersect(e,t){return e.intersects(t)?M.mkPP(new g(Math.max(e.left,t.left),Math.max(e.bottom,t.bottom)),new g(Math.min(e.right,t.right),Math.min(e.top,t.top))):M.mkEmpty()}perimeter(){let e=new A;return e.addPoint(this.leftTop),e.addPoint(this.rightTop),e.addPoint(this.rightBottom),e.addPoint(this.leftBottom),e.closed=!0,e}scaleAroundCenter(e){this.width=this.width*e,this.height=this.height*e}clone(){return new M({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get size(){return new I(this.width,this.height)}set size(e){this.width=e.width,this.height=e.height}static creatRectangleWithSize(e,t){let r=e.width/2,i=t.x-r,n=t.x+r,s=e.height/2,o=t.y-s;return new M({left:i,right:n,top:t.y+s,bottom:o})}addPointWithSize(e,t){let r=e.width/2,i=e.height/2;this.add(new g(t.x-r,t.y-i)),this.add(new g(t.x+r,t.y-i)),this.add(new g(t.x-r,t.y+i)),this.add(new g(t.x+r,t.y+i))}}class R{constructor(){this.previouisBezierCoefficient=.5,this.nextBezierCoefficient=.5,this.previousTangentCoefficient=1/3,this.nextTangentCoefficient=1/3}static mkSiteP(e){let t=new R;return t.point=e,t}static mkSiteSP(e,t){let r=new R;return r.point=t,r.prev=e,e.next=r,r}static mkSiteSPS(e,t,r){let i=new R;return i.prev=e,i.point=t,i.next=r,e.next=i,r.prev=i,i}get turn(){return null==this.next||null==this.prev?0:g.getTriangleOrientation(this.prev.point,this.point,this.next.point)}clone(){let e=new R;return e.previouisBezierCoefficient=this.previouisBezierCoefficient,e.point=this.point,e}}class O{static mkFromPoints(e){let t=null,r=null;for(let i of e)if(null==r)t=new O(r=R.mkSiteP(i));else{let e=R.mkSiteP(i);e.prev=r,r.next=e,r=e}return t}clone(){let e,t=this.headSite,r=null,i=null;for(;null!=t;)(e=t.clone()).prev=r,null!=r?r.next=e:i=e,t=t.next,r=e;return new O(i)}constructor(e){this.headSite=e}get lastSite(){let e=this.headSite;for(;null!=e.next;)e=e.next;return e}*[Symbol.iterator](){let e=this.headSite;for(;null!=e;)yield e.point,e=e.next}createCurve(){let e;let t=new C,r=this.headSite;for(;;){let e=C.findCorner(r);if(null==e)break;let i=O.createBezierSegOnSite(e.b);0===t.segs.length?!g.closeDistEps(r.point,i.start)&&C.addLineSegment(t,r.point,i.start):!g.closeDistEps(t.end,i.start)&&C.continueWithLineSegmentP(t,i.start),t.addSegment(i),r=e.b}return 0===t.segs.length?g.closeDistEps(r.point,r.next.point)?t.segs.push(new E(r.point,r.point.add(new g(5,5)),r.point.add(new g(-5,5)),e.point)):C.addLineSegment(t,r.point,r.next.point):!g.closeDistEps(t.end,r.next.point)&&C.continueWithLineSegmentP(t,r.next.point),t}static createBezierSegOnSite(e){let t=e.previouisBezierCoefficient,r=e.nextBezierCoefficient,i=e.prev,n=e.next,s=i.point.mul(t).add(e.point.mul(1-t)),o=n.point.mul(r).add(e.point.mul(1-r)),a=s.mul(e.previousTangentCoefficient).add(e.point.mul(1-e.previousTangentCoefficient)),l=o.mul(e.nextTangentCoefficient).add(e.point.mul(1-e.nextTangentCoefficient));return E.mkBezier([s,a,l,o])}}class k{get Elements(){return this.elements}getElem(e,t){return this.elements[e][t]}setElem(e,t,r){this.elements[e][t]=r}static Divide(e,t){return e.multiply(t.inverse())}isIdentity(){return c(this.elements[0][0],1)&&c(this.elements[0][1],0)&&c(this.elements[0][2],0)&&c(this.elements[1][0],0)&&c(this.elements[1][1],1)&&c(this.elements[1][2],0)}offset(){return new g(this.getElem(0,2),this.getElem(1,2))}static getIdentity(){return new k(1,0,0,0,1,0)}constructor(e,t,r,i,n,s){this.elements=[[e,t,r],[i,n,s]]}static rotation(e){let t=Math.cos(e),r=Math.sin(e);return new k(t,-r,0,r,t,0)}static scaleAroundCenterTransformation(e,t,r){let i=1-e,n=1-t;return new k(e,0,i*r.x,0,t,n*r.y)}multiplyPoint(e){return new g(this.getElem(0,0)*e.x+this.getElem(0,1)*e.y+this.getElem(0,2),this.getElem(1,0)*e.x+this.getElem(1,1)*e.y+this.getElem(1,2))}multiply(e){return null!=e?new k(this.getElem(0,0)*e.getElem(0,0)+this.getElem(0,1)*e.getElem(1,0),this.getElem(0,0)*e.getElem(0,1)+this.getElem(0,1)*e.getElem(1,1),this.getElem(0,0)*e.getElem(0,2)+this.getElem(0,1)*e.getElem(1,2)+this.getElem(0,2),this.getElem(1,0)*e.getElem(0,0)+this.getElem(1,1)*e.getElem(1,0),this.getElem(1,0)*e.getElem(0,1)+this.getElem(1,1)*e.getElem(1,1),this.getElem(1,0)*e.getElem(0,2)+this.getElem(1,1)*e.getElem(1,2)+this.getElem(1,2)):null}inverse(){let e=this.getElem(0,0)*this.getElem(1,1)-this.getElem(1,0)*this.getElem(0,1),t=this.getElem(1,1)/e,r=-this.getElem(0,1)/e,i=-this.getElem(1,0)/e,n=this.getElem(0,0)/e,s=-t*this.getElem(0,2)-r*this.getElem(1,2),o=-i*this.getElem(0,2)-n*this.getElem(1,2);return new k(t,r,s,i,n,o)}}class N{static mkEllipse(e,t,r){return T.mkFullEllipseNNP(e,t,r)}static createParallelogram(e,t,r){let i=t/2,n=e/2,s=r.x,o=r.y,a=i/Math.tan(80*Math.PI/180);return A.mkClosedFromPoints([new g(-n-a+s,-i+o),new g(n+s,-i+o),new g(n+s+a,i+o),new g(-n+s,i+o)])}static createHexagon(e,t,r){let i=t/2,n=e/2,s=r.x,o=r.y;return A.mkClosedFromPoints([new g(-n+s,-i+o),new g(n+s,-i+o),new g(n+(i+s),0+o),new g(n+s,i+o),new g(-n+s,i+o),new g(-(n-i)+s,0+o)])}static createOctagon(e,t,r){let i=e/2,n=t/2,s=Array(8);s[0]=new g(i+N.octagonPad*i,n-n*N.octagonPad),s[3]=new g(-1*s[0].x,s[0].y),s[4]=new g(s[3].x,-1*s[3].y),s[7]=new g(s[0].x,-1*s[0].y),s[1]=new g(i-i*N.octagonPad,n+n*N.octagonPad),s[2]=new g(-1*s[1].x,s[1].y),s[6]=new g(s[1].x,-1*s[1].y),s[5]=new g(s[2].x,-1*s[2].y);for(let e=0;e<8;e++)s[e]=s[e].add(r);return A.mkClosedFromPoints(s)}static createInvertedHouse(e,t,r){let i=N.createHouse(e,t,r);return N.rotateCurveAroundCenterByDegree(i,r,180)}static createHouse(e,t,r){let i=e/2,n=t/2,s=r.x,o=r.y,a=new C;return C.addLineSegmentCNNNN(a,s-i,o-n,s+i,o-n),C.continueWithLineSegmentNN(a,s+i,o+n),C.continueWithLineSegmentNN(a,s,o+2*n),C.continueWithLineSegmentNN(a,s-i,o+n),C.closeCurve(a)}static mkDiamond(e,t,r){let i=r.x,n=r.y,s=new C,o=[new g(i,n-t),new g(i+e,n),new g(i,n+t),new g(i-e,n)];return s.addSegs([b.mkPP(o[0],o[1]),b.mkPP(o[1],o[2]),b.mkPP(o[2],o[3]),b.mkPP(o[3],o[0])]),s}static rotateCurveAroundCenterByDegree(e,t,r){return N.rotateCurveAroundCenterByRadian(e,t,r*Math.PI/180)}static rotateCurveAroundCenterByRadian(e,t,r){let i=Math.cos(r),n=Math.sin(r),s=new k(1,0,t.x,0,1,t.y).multiply(new k(i,-n,0,n,i,0)).multiply(new k(1,0,-t.x,0,1,-t.y));return e.transform(s)}static mkCircle(e,t){return T.mkCircle(e,t)}static createRectangle(e,t,r){let i=e/2,n=t/2,s=r.x,o=r.y,a=new C,l=[new g(s-i,o-n),new g(s+i,o-n),new g(s+i,o+n),new g(s-i,o+n)];return a.addSegs([b.mkPP(l[0],l[1]),b.mkPP(l[1],l[2]),b.mkPP(l[2],l[3]),b.mkPP(l[3],l[0])]),a}static isRoundedRect(e){let t,r;if(!(e instanceof C))return;let i=e.segs;if(8!==i.length&&4!==i.length)return;let n=8===i.length;for(let e=0;e<4;e++){let s=n?2*e+1:e;if(0===e){if(!(i[s]instanceof T))return;let e=i[s];t=e.aAxis.length,r=e.bAxis.length}else{if(!(i[s]instanceof T))return;let e=i[s];if(t!==e.aAxis.length||r!==e.bAxis.length)return}}return{radX:t,radY:r}}static mkRectangleWithRoundedCorners(e,t,r,i,n=new g(0,0)){if(0===r||0===i)return N.createRectangle(e,t,n);let s=new C,o=e/2;r>o/2&&(r=o/2);let a=t/2;i>a/2&&(i=a/2);let l=n.x,h=n.y,u=o-r,c=a-i,d=h+a,f=h-a,p=l-o,m=l+o,v=new g(r,0),y=new g(0,i);return u>0&&s.addSegment(b.mkPP(new g(l-u,f),new g(l+u,f))),s.addSegment(T.mkEllipse(1.5*Math.PI,2*Math.PI,v,y,l+u,h-c)),c>0&&s.addSegment(b.mkPP(new g(m,h-c),new g(m,h+c))),s.addSegment(T.mkEllipse(0,.5*Math.PI,v,y,l+u,h+c)),u>0&&s.addSegment(b.mkPP(new g(l+u,d),new g(l-u,d))),s.addSegment(T.mkEllipse(.5*Math.PI,Math.PI,v,y,l-u,h+c)),c>0&&s.addSegment(b.mkPP(new g(p,h+c),new g(p,h-c))),s.addSegment(T.mkEllipse(Math.PI,1.5*Math.PI,v,y,l-u,h-c)),s}}function L(e){return e.parEnd-e.parStart}N.octagonPad=.25,(es=eh||(eh={}))[es.None=0]="None",es[es.North=1]="North",es[es.East=2]="East",es[es.South=4]="South",es[es.West=8]="West";class D{static get DifferenceEpsilon(){return D.differenceEpsilon}static EqualPP(e,t){return D.Equal(e.x,t.x)&&D.Equal(e.y,t.y)}static Equal(e,t){return 0===D.Compare(e,t)}static Compare(e,t){let r=0;return e+D.DifferenceEpsilon<t?r=-1:t+D.DifferenceEpsilon<e&&(r=1),r}static ComparePP(e,t){let r=D.Compare(e.x,t.x);return 0===r&&(r=D.Compare(e.y,t.y)),r}static LessOrEqual(e,t){let r=D.Compare(e,t);return r<0||0===r}static Less(e,t){return 0>D.Compare(e,t)}static GetDirections(e,t){return B.DirectionFromPointToPoint(e,t)}static IsPureDirection(e,t){return B.IsPureDirection(D.GetDirections(e,t))}static IsPureDirectionD(e){return B.IsPureDirection(e)}static IsPureLower(e,t){let r=D.GetDirections(e,t);return eh.East===r||eh.North===r}static GetPureDirectionVV(e,t){return D.GetDirections(e.point,t.point)}}D.differenceEpsilon=l.distanceEpsilon/2;class B{constructor(e){this.Dir=e}get Right(){return new B(B.RotateRight(this.Dir))}static RotateRight(e){switch(e){case eh.North:return eh.East;case eh.East:return eh.South;case eh.South:return eh.West;case eh.West:return eh.North;default:throw Error()}}static RotateLeft(e){switch(e){case eh.North:return eh.West;case eh.West:return eh.South;case eh.South:return eh.East;case eh.East:return eh.North;default:throw Error()}}static ToIndex(e){switch(e){case eh.North:return 0;case eh.East:return 1;case eh.South:return 2;case eh.West:return 3;default:throw Error()}}static VectorDirection(e){let t=eh.None;return e.x>D.DifferenceEpsilon?t=eh.East:e.x<-D.DifferenceEpsilon&&(t=eh.West),e.y>D.DifferenceEpsilon?t|=eh.North:e.y<-D.DifferenceEpsilon&&(t|=eh.South),t}static VectorDirectionPP(e,t){let r=eh.None,i=t.x-e.x,n=t.y-e.y;return i>D.DifferenceEpsilon?r=eh.East:-i>D.DifferenceEpsilon&&(r=eh.West),n>D.DifferenceEpsilon?r|=eh.North:-n>D.DifferenceEpsilon&&(r|=eh.South),r}static DirectionFromPointToPoint(e,t){return B.VectorDirectionPP(e,t)}static OppositeDir(e){switch(e){case eh.North:return eh.South;case eh.West:return eh.East;case eh.South:return eh.North;case eh.East:return eh.West;default:return eh.None}}static IsPureDirection(e){switch(e){case eh.North:case eh.East:case eh.South:case eh.West:return!0;default:return!1}}static IsPureDirectionPP(e,t){return B.IsPureDirection(B.DirectionFromPointToPoint(e,t))}static DirectionsAreParallel(e,t){return e===t||e===B.OppositeDir(t)}ToPoint(){let e=0,t=0;return(this.Dir&eh.East)===eh.East&&e++,(this.Dir&eh.North)===eh.North&&t++,(this.Dir&eh.West)===eh.West&&e--,(this.Dir&eh.South)===eh.South&&t--,new g(e,t)}static toPoint(e){return new B(e).ToPoint()}static negate(e){return new B(B.OppositeDir(e.Dir))}}class F extends o{clone(){let e=new F(null,null);return e.isPositioned=this.isPositioned,e._boundingBox=this._boundingBox.clone(),e.attachmentSegmentEnd=this.attachmentSegmentEnd,e.attachmentSegmentStart=this.attachmentSegmentStart,e}get isPositioned(){return this._isPositioned}set isPositioned(e){this._isPositioned=e}constructor(e,t){super(e),this._isPositioned=!1,t&&(this.boundingBox=M.mkPP(new g(0,0),new g(t.width,t.height)))}get boundingBox(){return this._boundingBox}set boundingBox(e){this._boundingBox=e}setBoundingBox(e){this.isPositioned=!0,this._boundingBox=e}get width(){return this.boundingBox.width}set width(e){this.boundingBox.width=e}get height(){return this.boundingBox.height}set height(e){this.boundingBox.height=e}get center(){return this.boundingBox.center}set center(e){this.boundingBox.center=e}translate(e){this.isPositioned&&(this.center=this.center.add(e))}transform(e){this.isPositioned&&(this.center=e.multiplyPoint(this.center))}positionCenter(e){this.boundingBox.center=e,this.isPositioned=!0}}class V extends o{*getSmoothPolyPoints(){yield this.source.center,this.curve instanceof C?yield*this.getCurvePoints(this.curve):this.curve instanceof b?(yield this.curve.start,yield this.curve.end):this.curve instanceof T?(yield this.curve.start,yield this.curve.value((this.curve.parStart+this.curve.parEnd)/.5),yield this.curve.end):this.curve instanceof E&&(yield this.curve.start,yield this.curve.value(.25),yield this.curve.value(.75),yield this.curve.end),yield this.target.center}*getCurvePoints(e){for(let t of e.segs)if(yield t.start,t instanceof E){let e=function(e){return g.lineLineIntersection(e.b[0],e.b[1],e.b[2],e.b[3])}(t);e&&(yield e)}yield e.end}static getGeom(e){return o.getGeom(e)}clone(){let e=new V(null);return this.smoothedPolyline&&(e.smoothedPolyline=this.smoothedPolyline.clone()),e.curve=this.curve.clone(),null!=this.sourceArrowhead&&(e.sourceArrowhead=this.sourceArrowhead.clone()),null!=this.targetArrowhead&&(e.targetArrowhead=this.targetArrowhead.clone()),e}get label(){return null!=this.edge&&null!=this.edge.label?o.getGeom(this.edge.label):null}set label(e){this.edge.label.setAttr(s.GeomObjectIndex,e)}RaiseLayoutChangeEvent(e){this.edge.raiseEvents(e)}requireRouting(){this.curve=null,this.smoothedPolyline=null}translate(e){if(0!==e.x||0!==e.y){if(null!=this.curve&&this.curve.translate(e),null!=this.smoothedPolyline)for(let t=this.smoothedPolyline.headSite,r=this.smoothedPolyline.headSite;null!=t;t=t.next,r=r.next)t.point=r.point.add(e);if(null!=this.sourceArrowhead&&this.sourceArrowhead.tipPosition&&(this.sourceArrowhead.tipPosition=this.sourceArrowhead.tipPosition.add(e)),null!=this.targetArrowhead&&this.targetArrowhead.tipPosition&&(this.targetArrowhead.tipPosition=this.targetArrowhead.tipPosition.add(e)),this.edge.label){let t=F.getGeom(this.edge.label);t&&t.translate(e)}}}GetMaxArrowheadLength(){let e=0;return(null!=this.sourceArrowhead&&(e=this.sourceArrowhead.length),null!=this.targetArrowhead&&this.targetArrowhead.length>e)?this.targetArrowhead.length:e}transform(e){if(null!=this.curve){if(this.curve=this.curve.transform(e),null!=this.smoothedPolyline)for(let t=this.smoothedPolyline.headSite,r=this.smoothedPolyline.headSite;null!=t;t=t.next,r=r.next)t.point=e.multiplyPoint(t.point);null!=this.sourceArrowhead&&(this.sourceArrowhead.tipPosition=e.multiplyPoint(this.sourceArrowhead.tipPosition)),null!=this.targetArrowhead&&(this.targetArrowhead.tipPosition=e.multiplyPoint(this.targetArrowhead.tipPosition))}}get edge(){return this.entity}get source(){return o.getGeom(this.edge.source)}*sourceArrowheadPoints(e){if(null==this.sourceArrowhead)return;yield this.sourceArrowhead.tipPosition;let t=this.sourceArrowhead.tipPosition.sub(this.curve.start);t=t.rotate90Cw().mul(Math.tan(.5*e*(Math.PI/180))),yield t.add(this.curve.start),yield this.curve.start.sub(t)}*targetArrowheadPoints(e){if(null==this.targetArrowhead)return;yield this.targetArrowhead.tipPosition;let t=this.targetArrowhead.tipPosition.sub(this.curve.end);t=t.rotate90Cw().mul(Math.tan(.5*e*(Math.PI/180))),yield t.add(this.curve.end),yield this.curve.end.sub(t)}get boundingBox(){let e=M.mkEmpty();if(null!=this.smoothedPolyline)for(let t of this.smoothedPolyline)e.add(t);for(let t of(null!=this.curve&&e.addRecSelf(this.curve.boundingBox),this.sourceArrowheadPoints(25)))e.add(t);for(let t of this.targetArrowheadPoints(25))e.add(t);this.label&&e.addRecSelf(this.label.boundingBox);let t=this.lineWidth;return e.left-=t,e.top+=t,e.right+=t,e.bottom-=t,e}isInterGraphEdge(){return this.edge.isInterGraphEdge()}get target(){return o.getGeom(this.edge.target)}constructor(e){super(e),this.lineWidth=1}toString(){return this.source.toString()+"->"+this.target}static RouteSelfEdge(e,t,r){let i=e.boundingBox.width,n=e.boundingBox.height,s=e.boundingBox.center,o=new g(s.x-i/4,s.y),a=new g(s.x-i/4,s.y-n/2-t),l=new g(s.x+i/4,s.y-n/2-t),h=new g(s.x+i/4,s.y);return r.smoothedPolyline=O.mkFromPoints([o,a,l,h]),r.smoothedPolyline.createCurve()}underCollapsedGraph(){return this.source.underCollapsedGraph()||this.target.underCollapsedGraph()}EdgeToAncestor(){return this.edge.EdgeToAncestor()}}var G,U,z,j,H,W,q,X,$,Y,Z,K,J,Q,ee,et,er,ei,en,es,eo,ea,el,eh,eu,ec,ed,ef,ep,eg,em,ev,eb,ey,ex,e_,eS,ew,eT,eP,eE=r("752");(G=eu||(eu={}))[G.Continue=0]="Continue",G[G.Stop=1]="Stop";function eC(e){if(0===e.length)return null;if(1===e.length)return e[0];let t={b0:e[0].irect,seed0:1},r=function(e,t){let r,i=eA(t.b0,e[t.seed0].irect);for(let r=2;r<e.length;r++){let n=eA(t.b0,e[r].irect);n>i&&(t.seed0=r,i=n)}for(let i=0;i<e.length;i++)if(i!==t.seed0){r=i;break}i=e[t.seed0].irect.add_rect(e[r].irect).area;for(let n=0;n<e.length;n++){if(n===t.seed0)continue;let s=e[t.seed0].irect.add_rect(e[n].irect).area;s>i&&(r=n,i=s)}return r}(e,t),i=[],n=[];i.push(e[t.seed0]),n.push(e[r]);let s={box0:e[t.seed0].irect,box1:e[r].irect};!function(e,t,r,i,n,s){for(let o=0;o<e.length;o++){if(o===t||o===r)continue;let a=s.box0.add_rect(e[o].irect),l=a.area-s.box0.area,h=s.box1.add_rect(e[o].irect),u=h.area-s.box1.area;2*i.length<n.length?(i.push(e[o]),s.box0=a):2*n.length<i.length?(n.push(e[o]),s.box1=h):l<u?(i.push(e[o]),s.box0=a):u<l?(n.push(e[o]),s.box1=h):s.box0.area<s.box1.area?(i.push(e[o]),s.box0=a):(n.push(e[o]),s.box1=h)}}(e,t.seed0,r,i,n,s);let o=eM(e.length);return o.irect=s.box0.add_rect(s.box1),o.Left=eC(i),o.Right=eC(n),o}function eA(e,t){return e.add_rect(t).area}function eI(e,t){return null==e||null==t?null:eC(Array.from(e).map(e=>eR(e,t(e))))}function eM(e){let t=new eO;return t.Count=e,t}function eR(e,t){let r=new eO;return r.UserData=e,r.irect=t,r.Count=1,r}class eO{toString(){return this.IsLeaf?this.Count.toString()+" "+this.UserData:this.Count.toString()}get IsLeaf(){return null==this.left}get Left(){return this.left}set Left(e){null!=this.left&&this.left.Parent===this&&(this.left.Parent=null),this.left=e,null!=this.left&&(this.left.Parent=this)}get Right(){return this.right}set Right(e){null!=this.right&&this.right.Parent===this&&(this.right.Parent=null),this.right=e,null!=this.right&&(this.right.Parent=this)}get IsLeftChild(){return this===this.Parent.Left}FirstIntersectedNode(e){var t;if(e.intersects_rect(this.irect))return this.IsLeaf?this:null!==(t=this.Left.FirstIntersectedNode(e))&&void 0!==t?t:this.Right.FirstIntersectedNode(e);return null}FirstHitNodeWithPredicate(e,t){var r;return this.irect.contains_point(e)?this.IsLeaf?t(e,this.UserData)===eu.Stop?this:null:null!==(r=this.Left.FirstHitNodeWithPredicate(e,t))&&void 0!==r?r:this.Right.FirstHitNodeWithPredicate(e,t):null}FirstHitByRectWithPredicate(e,t){var r;return this.irect.intersects_rect(e)?this.IsLeaf?t(this.UserData)===eu.Stop?this:null:null!==(r=this.Left.FirstHitByRectWithPredicate(e,t))&&void 0!==r?r:this.Right.FirstHitByRectWithPredicate(e,t):null}FirstHitNode(e){var t;if(this.irect.contains_point(e))return this.IsLeaf?this:null!==(t=this.Left.FirstHitNode(e))&&void 0!==t?t:this.Right.FirstHitNode(e);return null}*AllHitItems(e,t=null){let r=new eE.Stack;for(r.push(this);r.size>0;){let i=r.pop();i.irect.intersects_rect(e)&&(i.IsLeaf?(null==t||t(i.UserData))&&(yield i.UserData):(r.push(i.left),r.push(i.right)))}}*AllHitItems_(e){let t=new eE.Stack;for(t.push(this);t.size>0;){let r=t.pop();r.irect.contains_point(e)&&(r.IsLeaf?yield r.UserData:(t.push(r.left),t.push(r.right)))}}VisitTree(e,t){!function e(t,r,i){if(t.irect.intersects_rect(i)){if(r(t.UserData)===eu.Continue){if(null!=t.Left)return e(t.Left,r,i)===eu.Continue&&e(t.Right,r,i)===eu.Continue?eu.Continue:eu.Stop;return eu.Continue}return eu.Stop}return eu.Continue}(this,e,t)}Clone(){let e=eM(this.Count);return e.UserData=this.UserData,e.irect=this.irect,null!=this.Left&&(e.Left=this.Left.Clone()),null!=this.Right&&(e.Right=this.Right.Clone()),e}*GetNodeItemsIntersectingRectangle(e){for(let t of this.GetLeafRectangleNodesIntersectingRectangle(e))yield t.UserData}*GetLeafRectangleNodesIntersectingRectangle(e){let t=new eE.Stack;for(t.push(this);t.size>0;){let r=t.pop();r.irect.intersects_rect(e)&&(r.IsLeaf?yield r:(t.push(r.left),t.push(r.right)))}}*GetAllLeaves(){for(let e of this.GetAllLeafNodes())yield e.UserData}*GetAllLeafNodes(){for(let e of this.EnumRectangleNodes(!0))yield e}*EnumRectangleNodes(e){let t=new eE.Stack;for(t.push(this);t.size>0;){let r=t.pop();(r.IsLeaf||!e)&&(yield r),!r.IsLeaf&&(t.push(r.left),t.push(r.right))}}TraverseHierarchy(e,t){t(e),null!=e.Left&&this.TraverseHierarchy(e.Left,t),null!=e.Right&&this.TraverseHierarchy(e.Right,t)}}class ek{constructor(e,t){0>u(e,t)?(this._first=e,this._second=t):(this._first=t,this._second=e)}get first(){return this._first}get second(){return this._second}get Length(){return p(this._first,this._second)}CompareTo(e){let t=u(this._first,e._first);return 0!==t?t:u(this._second,e._second)}static equal(e,t){return e._first.equal(t._first)&&e._second.equal(t._second)}toString(){return this._first+" "+this._second}}class eN{delete(e){return this.deletexy(e.x,e.y)}clear(){this.mapOfSets.clear(),this.size_=0}get size(){return this.size_}static mk(e){let t=new eN;for(let r of e)t.add(r);return t}addxy(e,t){let r=this.mapOfSets.get(e);null==r&&this.mapOfSets.set(e,r=new Set),!r.has(t)&&this.size_++,r.add(t)}add(e){return this.addxy(e.x,e.y),this}deletexy(e,t){let r=this.mapOfSets.get(e);return!!(null!=r&&r.delete(t))&&(this.size_--,!0)}hasxy(e,t){return this.mapOfSets.has(e)&&this.mapOfSets.get(e).has(t)}has(e){return this.hasxy(e.x,e.y)}constructor(){this.size_=0,this.mapOfSets=new Map}forEach(e,t){for(let r of this)e(r,r,t)}*entries(){for(let e of this)yield[e,e]}keys(){return this.values()}*values(){for(let e of this.mapOfSets)for(let t of e[1])yield new g(e[0],t)}[Symbol.iterator](){return this.values()}}function eL(e,t){let r=new Set;for(let i of e)!t.has(i)&&r.add(i);return r}function eD(e,t){let r=new Set(e);for(let e of t)r.add(e);return r}function eB(e,t){for(let r of t)e.push(r)}function eF(e,t){let r=new Set;if(e.size<t.size)for(let i of e)t.has(i)&&r.add(i);else for(let i of t)e.has(i)&&r.add(i);return r}function eV(e,t){for(let r of t)e.add(r)}function eG(e,t){if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}function eU(e,t){let r=[];for(let i of e)for(let e of t(i))r.push(e);return r}function ez(e,t,r){let i=e.get(t);!i&&(i=new Set,e.set(t,i)),i.add(r)}function ej(e,t,r){let i=e.get(t);!i&&(i=[],e.set(t,i)),i.push(r)}function eH(e,t,r){let i=e.get(t);!i&&(i=new Set,e.set(t,i)),i.add(r)}function eW(e,t,r){!function(e,t,r){let i=e.get(t);i&&i.delete(r)}(e,new ek(t[0],t[1]),r)}var eq=r("17");class eX{static assert(e,t=null){if(!e){if(null!=t)throw console.log(t),Error(t);throw Error("condition does not hold")}}}class e${constructor(){this.attrs=[],this._parent=null}addEvent(e){this.events.push(e)}removeEvent(e){let t=this.events.indexOf(e);t>=0&&(this.events=this.events.splice(t,1))}raiseEvents(e){this.events.forEach(t=>t(e))}clearAttr(){this.attrs=[]}setAttr(e,t){this.attrs[e]=t}getAttr(e){return this.attrs[e]}get parent(){return this._parent}set parent(e){this._parent=e}*getAncestors(){let e=this.parent;for(;null!=e;)yield e,e=e.parent}isDescendantOf(e){for(let t of this.getAncestors())if(t===e)return!0;return!1}}(U=ec||(ec={}))[U.None=0]="None",U[U.FromAncestor=1]="FromAncestor",U[U.ToAncestor=2]="ToAncestor";class eY extends e${constructor(e,t){super(),this.source=e,this.target=t,e!==t?(e.outEdges.add(this),t.inEdges.add(this)):e.selfEdges.add(this)}add(){this.source!==this.target?(this.source.outEdges.add(this),this.target.inEdges.add(this)):this.source.selfEdges.add(this)}remove(){this.source!==this.target?(this.source.outEdges.delete(this),this.target.inEdges.delete(this)):this.source.selfEdges.delete(this)}toString(){return"("+this.source.toString()+"->"+this.target.toString()+")"}isInterGraphEdge(){return this.source.parent!==this.target.parent}EdgeToAncestor(){return this.source instanceof eJ&&this.target.isDescendantOf(this.source)?ec.FromAncestor:this.target instanceof eJ&&this.source.isDescendantOf(this.target)?ec.ToAncestor:ec.None}}class eZ extends e${removeOutEdge(e){this.outEdges.delete(e)}removeInEdge(e){this.inEdges.delete(e)}get id(){return this._id}set id(e){this._id=e}toString(){return this.id}constructor(e){super(),this.inEdges=new Set,this.outEdges=new Set,this.selfEdges=new Set,this.id=e}*_edges(){for(let e of this.inEdges)yield e;for(let e of this.outEdges)yield e;for(let e of this.selfEdges)yield e}get edges(){return this._edges()}get outDegree(){return this.outEdges.size}get inDegree(){return this.inEdges.size}get selfDegree(){return this.selfEdges.size}get degree(){return this.outDegree+this.inDegree+this.selfDegree}}class eK{constructor(){this.nodeMap=new Map}remove(e){this.nodeMap.delete(e.id)}get size(){return this.nodeMap.size}*nodes_(){for(let e of this.nodeMap.values())yield e}*graphs_(){for(let e of this.nodes_())e instanceof eJ&&(yield e)}findShallow(e){return this.nodeMap.get(e)}get nodesShallow(){return this.nodes_()}get graphs(){return this.graphs_()}*_edges(){for(let e of this.nodeMap.values()){for(let t of e.outEdges)yield t;for(let t of e.selfEdges)yield t}}interGraphEdges(){throw Error("not implemented")}get nodeShallowCount(){return this.nodeMap.size}get edgeCount(){let e=0;for(let t of this.nodeMap.values())e+=t.outDegree+t.selfDegree;return e}get edges(){return this._edges()}addNode(e){this.nodeMap.set(e.id,e)}nodeIsConsistent(e){for(let t of e.outEdges)if(t.source!==e||t.source===t.target)return!1;for(let t of e.inEdges)if(t.target!==e||t.source===t.target)return!1;for(let t of e.selfEdges)if(t.target!==t.source||t.source!==e)return!1;return!0}isConsistent(){for(let e of this.nodeMap.values())if(!this.nodeIsConsistent(e))return!1;return!0}}class eJ extends eZ{remove(e){this.nodeCollection.remove(e)}removeSubgraph(){let e=this.parent;for(let t of(e&&e.removeNode(this),this.outGoingEdges()))t.attachedAtSource?t.node.removeOutEdge(t.edge):t.node.removeInEdge(t.edge)}*outGoingEdges(){for(let e of this.outEdges){let t=e.target;!this.isAncestor(t)&&(yield{edge:e,node:t,attachedAtSource:!1})}for(let e of this.inEdges){let t=e.source;!this.isAncestor(t)&&(yield{edge:e,node:t,attachedAtSource:!0})}for(let e of this.nodesBreadthFirst){for(let t of e.outEdges){let e=t.target;e!==this&&!this.isAncestor(e)&&(yield{edge:t,node:e,attachedAtSource:!1})}for(let t of e.inEdges){let e=t.source;e!==this&&!this.isAncestor(e)&&(yield{edge:t,node:e,attachedAtSource:!0})}}}isAncestor(e){for(let t of e.getAncestors())if(t===this)return!0;return!1}*getClusteredConnectedComponents(){let e=new Set,t=new eq.Queue;for(let r of this.nodesBreadthFirst){if(e.has(r))continue;e.add(r),t.enqueue(r);let i=new Set;do{let r=t.dequeue();for(let n of(r.parent===this&&i.add(r),this.reachableFrom(r)))!e.has(n)&&(e.add(n),t.enqueue(n))}while(t.length>0);yield Array.from(i)}}*reachableFrom(e){for(let t of e.outEdges)yield t.target;for(let t of e.inEdges)yield t.source;e instanceof eJ&&(yield*e.shallowNodes),e.parent!=this&&(yield e.parent)}hasSomeAttrOnIndex(e){for(let t of this.nodesBreadthFirst)if(t.getAttr(e))return!0;for(let t of this.deepEdges)if(t.getAttr(e))return!0;return!1}*graphs(){for(let e of this.nodeCollection.graphs)yield e}noEmptySubgraphs(){for(let e of this.subgraphsBreadthFirst())if(0===e.shallowNodeCount)return!1;return!0}hasSubgraphs(){for(let e of this.shallowNodes)if(e instanceof eJ)return!0;return!1}*subgraphsBreadthFirst(){for(let e of this.nodesBreadthFirst)e instanceof eJ&&(yield e)}isEmpty(){return 0===this.shallowNodeCount}setEdge(e,t){let r=this.nodeCollection.findShallow(e);if(null==r)return;let i=this.nodeCollection.findShallow(t);if(null!=i)return new eY(r,i)}get shallowNodes(){return this.nodeCollection.nodesShallow}get nodesBreadthFirst(){return this.nodesBreadthFirst_()}*nodesBreadthFirst_(){for(let e of this.nodeCollection.nodesShallow)yield e,e instanceof eJ&&(yield*e.nodesBreadthFirst)}constructor(e="__graph__"){super(e),this.nodeCollection=new eK}findNodeRecursive(e){let t=this.nodeCollection.findShallow(e);if(t)return t;for(let t of this.shallowNodes)if(t instanceof eJ){let r=t.findNodeRecursive(e);if(r)return r}return null}findNode(e){return this.nodeCollection.findShallow(e)}get shallowEdges(){return this.nodeCollection.edges}get deepEdges(){return this.deepEdgesIt()}*deepEdgesIt(){for(let e of this.nodesBreadthFirst){for(let t of e.outEdges)yield t;for(let t of e.selfEdges)yield t;for(let t of e.inEdges)!this.isAncestor(t.source)&&(yield t)}}isConsistent(){return this.parent?this.parent.isConsistent():this.eachNodeIdIsUnique()&&this.nodeCollection.isConsistent()}nodeIsConsistent(e){return this.nodeCollection.nodeIsConsistent(e)}removeNode(e){for(let t of e.outEdges)t.target.inEdges.delete(t);for(let t of e.inEdges)t.source.outEdges.delete(t);for(let t of(this.nodeCollection.remove(e),this.subgraphsBreadthFirst()))t.removeNode(e)}addNode(e){return eX.assert(null==this.findNodeRecursive(e.id)),e.parent=this,this.nodeCollection.addNode(e),e}get shallowNodeCount(){return this.nodeCollection.nodeShallowCount}get nodeCountDeep(){let e=this.nodeCollection.size;for(let t of this.shallowNodes)t instanceof eJ&&(e+=t.nodeCountDeep);return e}get edgeCount(){return this.nodeCollection.edgeCount}liftNode(e){for(;null!=e&&e.parent!==this;)e=e.parent;return e}get deepEdgesCount(){let e=0;for(let t of this.nodesBreadthFirst)e+=t.outDegree+t.selfDegree;return e}eachNodeIdIsUnique(){let e=new Set;for(let t of this.nodesBreadthFirst){if(e.has(t.id))return!1;e.add(t.id)}return!0}*allElements(){for(let e of this.allSuccessorsWidthFirst()){for(let t of(yield e,e.selfEdges))yield t;for(let t of e.outEdges)yield t;for(let t of e.inEdges)!this.isAncestor(t.source)&&(yield t)}yield*this.edges}*allSuccessorsWidthFirst(){for(let e of this.shallowNodes)yield e;for(let e of this.shallowNodes)e instanceof eJ&&(yield*e.allSuccessorsWidthFirst())}*allSuccessorsDepthFirst(){for(let e of this.shallowNodes)e instanceof eJ&&(yield*e.allSuccessorsDepthFirst()),yield e}}function eQ(e,t){return t.has(e.source)&&t.has(e.target)}class e1 extends o{clone(){let e=new e1(null);return this.boundaryCurve&&(e.boundaryCurve=this.boundaryCurve.clone()),e}translate(e){(0!==e.x||0!==e.y)&&this.boundaryCurve.translate(e)}toJSON(){return{boundaryCurve:this.boundaryCurve}}get node(){return this.entity}get boundaryCurve(){return this._boundaryCurve}set boundaryCurve(e){null!=e&&e.boundingBox&&(e.boundingBox.height<e1.minHeight||e.boundingBox.width<e1.minWidth)&&(e=N.mkCircle(e1.minWidth,e.boundingBox.center)),this._boundaryCurve=e}get id(){return this.node.id}toString(){return this.id}static mkNode(e,t){let r=new e1(t);return r.boundaryCurve=e,r}get center(){return this.boundaryCurve.boundingBox.center}set center(e){let t=e.sub(this.center);this.boundaryCurve.translate(t)}fitBoundaryCurveToTarget(e){if(null!=this.boundaryCurve){let t=N.isRoundedRect(this.boundaryCurve);if(null==t){let t=e.width/this.boundaryCurve.boundingBox.width,r=e.height/this.boundaryCurve.boundingBox.height;this.boundaryCurve=this.boundaryCurve.scaleFromOrigin(t,r),this.boundaryCurve.translate(e.center.sub(this.boundaryCurve.boundingBox.center))}else this.boundaryCurve=N.mkRectangleWithRoundedCorners(e.width,e.height,t.radX,t.radY,e.center)}}static getGeom(e){return e.getAttr(s.GeomObjectIndex)}*inEdges(){for(let e of this.node.inEdges)yield o.getGeom(e)}*outEdges(){for(let e of this.node.outEdges)yield o.getGeom(e)}*selfEdges(){for(let e of this.node.selfEdges)yield o.getGeom(e)}get boundingBox(){return this.boundaryCurve?this.boundaryCurve.boundingBox:null}set boundingBox(e){if(!!this.boundaryCurve)1e-4>Math.abs(e.width-this.width)&&1e-4>Math.abs(e.height-this.height)?this.center=e.center:this.fitBoundaryCurveToTarget(e)}get width(){return this.boundaryCurve.boundingBox.width}get height(){return this.boundaryCurve.boundingBox.height}transform(e){null!=this.boundaryCurve&&(this.boundaryCurve=this.boundaryCurve.transform(e))}underCollapsedGraph(){let e=this.node.parent;if(null==e)return!1;let t=o.getGeom(e);return null!=t&&(!!t.isCollapsed||t.underCollapsedGraph())}*getAncestors(){for(let e of this.node.getAncestors())yield o.getGeom(e)}}e1.minHeight=2,e1.minWidth=3;class e0{ProgressStep(){}constructor(e){this.cancelToken=e}}class e2{}e2.GoldenRatio=(1+Math.sqrt(5))/2,e2.GoldenRatioRemainder=2-e2.GoldenRatio;class e3 extends e0{constructor(e,t){super(null),this.desiredAspectRatio=1.2,this.bestPacking=null,this.cachedCosts=new Map,this.rectangles=e,this.desiredAspectRatio=t}get PackedWidth(){return null!=this.bestPacking?this.bestPacking.PackedWidth:0}get PackedHeight(){return null!=this.bestPacking?this.bestPacking.PackedHeight:0}Pack(e,t,r){let i=e3.GetGoldenSectionStep(e,t),n=Math.max(r/10,(t-e)/e3.MaxSteps);t+=n,this.bestPackingCost=Number.MAX_VALUE,1===this.rectangles.length?this.PackLimit(e):2===this.rectangles.length?(this.PackLimit(e),this.PackLimit(t)):this.rectangles.length>2&&e3.GoldenSectionSearch(e=>this.PackLimit(e),e,i,t,n);let s=this.bestPacking.getRects();for(let e=0;e<this.rectangles.length;e++)this.rectangles[e]=s[e]}PackLimit(e){let t=this.cachedCosts.get(e);if(null==t){let r=this.createPacking(this.rectangles,e);r.run(),this.cachedCosts.set(e,t=Math.abs(r.PackedAspectRatio-this.desiredAspectRatio)),t<this.bestPackingCost&&(this.bestPackingCost=t,this.bestPacking=r)}return t}static GoldenSectionSearch(e,t,r,i,n){if(Math.abs(t-i)<n)return e(t)<e(i)?t:i;let s=e3.GetGoldenSectionStep(r,i),o=e(r),a=e(s),l=()=>e3.GoldenSectionSearch(e,s,r,t,n),h=()=>e3.GoldenSectionSearch(e,r,s,i,n);if(a<o)return h();if(a>o)return l();let u=h(),c=l();return e(c)<e(u)?c:u}static GetGoldenSectionStep(e,t){return e<t?e+e2.GoldenRatioRemainder*(t-e):e-e2.GoldenRatioRemainder*(e-t)}}e3.MaxSteps=1e3;class e5 extends e0{get PackedWidth(){return this.packedWidth}set PackedWidth(e){this.packedWidth=e}get PackedHeight(){return this.packedHeight}set PackedHeight(e){this.packedHeight=e}get PackedAspectRatio(){return this.PackedWidth/this.PackedHeight}getRects(){let e=[];for(let[t,r]of this.rectsToCenters)t.center=r,e.push(t);return e}}class e6 extends e5{constructor(e,t,r=!1){super(null),this.rectsToCenters=new Map,this.rectanglesByDescendingHeight=r?e:e6.SortRectangles(e),this.wrapWidth=t}static SortRectangles(e){return e.sort((e,t)=>t.height-e.height),e}run(){this.Pack()}Pack(){this.PackedWidth=0,this.PackedHeight=0;let e=new eE.Stack,t=!1,r=0,i=0,n=0,s=this.rectanglesByDescendingHeight;for(let o=0;t||o<s.length;){let a=s[o],l=e.length>0?e.top:null;if(null==l||l.right+a.width<=this.wrapWidth&&r+a.height<=l.top){let s=new g(l?l.right:0,r).add(new g(a.width/2,a.height/2));a.center=s,this.rectsToCenters.set(a,s),i=Math.max(i,a.right),n=Math.max(n,a.top),e.push(a),t=!1}else r=l.top,e.pop(),t=!0;!t&&o++}this.PackedWidth=i,this.PackedHeight=n}}class e4 extends e3{constructor(e,t){super(e6.SortRectangles(e),t),this.createPacking=(e,t)=>new e6(e,t,!0)}run(){let e=Number.MAX_VALUE,t=0,r=0;for(let i of this.rectangles){let n=i.width;r+=n,e=Math.min(e,n),t=Math.max(t,n)}this.Pack(t,r,e)}}function e9(e){return new te(eC(e.map(([e,t])=>eR(t,e))))}function e8(e){for(let t=e.Parent;null!=t;t=t.Parent)t.Count--,t.irect=t.Left.irect.add_rect(t.Right.irect)}function e7(e){return 2*e.Left.Count>=e.Right.Count&&2*e.Right.Count>=e.Left.Count}class te{clear(){this.RootNode=null}NumberOfIntersectedIsLessThanBound(e,t,r){return function e(t,r,i,n){if(!t.irect.intersects_rect(r))return!0;if(t.IsLeaf)return!n(t.UserData)||0!=--i.bound;return e(t.Left,r,i,n)&&e(t.Right,r,i,n)}(this._rootNode,e,{bound:t},r)}get RootNode(){return this._rootNode}set RootNode(e){this._rootNode=e}constructor(e){this._rootNode=e}*GetAllLeaves(){if(null!=this._rootNode&&this.Count>0)for(let e of this._rootNode.GetAllLeaves())yield e}get Count(){return null==this._rootNode?0:this._rootNode.Count}Add(e,t){this.AddNode(eR(t,e))}AddNode(e){null==this._rootNode?this._rootNode=e:this.Count<=2?this._rootNode=eC(Array.from(this._rootNode.GetAllLeafNodes()).concat([e])):this.AddNodeToTreeRecursive(e,this._rootNode)}Rebuild(){this._rootNode=eC(Array.from(this._rootNode.GetAllLeafNodes()))}AddNodeToTreeRecursive(e,t){if(t.IsLeaf)t.Left=eR(t.UserData,t.irect),t.Right=e,t.Count=2;else{let r,i;if(t.Count++,2*t.Left.Count<t.Right.Count)this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=t.Left.irect.add_rect(e.irect);else if(2*t.Right.Count<t.Left.Count)this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=t.Right.irect.add_rect(e.irect);else{let n=(r=t.Left.irect.add_rect(e.irect)).area-t.Left.irect.area,s=(i=t.Right.irect.add_rect(e.irect)).area-t.Right.irect.area;n<s?(this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=r):n>s?(this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=i):r.area<i.area?(this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=r):(this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=i)}}t.irect=t.Left.irect.add_rect(t.Right.irect)}GetAllIntersecting(e){return null==this._rootNode||0===this.Count?[]:Array.from(this._rootNode.GetNodeItemsIntersectingRectangle(e))}OneIntersecting(e){if(null==this._rootNode||0===this.Count)return;let t=this._rootNode.FirstIntersectedNode(e);if(null!=t)return{intersectedLeaf:t.UserData}}GetAllLeavesIntersectingRectangle(e){return null==this._rootNode||0===this.Count?[]:this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e)}IsIntersecting(e){if(null==this._rootNode||0===this.Count)return!1;for(let t of this._rootNode.GetNodeItemsIntersectingRectangle(e))return!0;return!1}Contains(e,t){if(null==this._rootNode)return!1;for(let r of this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e))if(r.UserData===t)return!0;return!1}Remove(e,t){let r;if(null==this._rootNode)return;for(let i of this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e))i.UserData===t&&(r=i);if(null!=r)return 1===this.RootNode.Count?this.RootNode=null:this.RemoveLeaf(r),r.UserData}RemoveLeaf(e){let t=function(e){for(let t=e.Parent;null!=t;t=t.Parent)if(!e7(t))return t;return null}(e);if(null!=t)!function(e,t){let r=[];for(let i of e.GetAllLeafNodes())i!==t&&r.push(i);let i=eC(r);e.Count=i.Count,e.Left=i.Left,e.Right=i.Right,e.irect=i.Left.irect.add_rect(i.Right.irect)}(t,e),e8(t);else{let t=e.Parent;if(null==t)this._rootNode=new eO;else{var r,i;r=t,i=e.IsLeftChild?t.Right:t.Left,r.UserData=i.UserData,r.Left=i.Left,r.Right=i.Right,r.Count--,r.irect=i.irect,e8(t)}}}UnbalancedNode(e){for(let t=e.Parent;null!=t;t=t.Parent)if(!e7(t))return t;return null}}class tt extends M{constructor(e){super(e),this.radX=e.radX,this.radY=e.radY,this.roundedRect_=N.mkRectangleWithRoundedCorners(this.width,this.height,e.radX,e.radY,this.center)}onUpdated(){!this.isEmpty&&(this.roundedRect_=N.mkRectangleWithRoundedCorners(this.width,this.height,this.radX,this.radY,this.center))}isOk(){return!!this.isEmpty()||this.roundedRect_.boundingBox.equalEps(this)}setRect(e){this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,!this.isEmpty()&&(this.roundedRect_=N.mkRectangleWithRoundedCorners(e.width,e.height,this.radX,this.radY,this.center))}}function tr(e,t){let r=t.map(e=>[e,e.boundingBox]),i=new e4(r.map(e=>e[1]),1.5);for(let[e,t]of(i.run(),r)){let r=t.leftBottom.sub(e.boundingBox.leftBottom);e.translate(r)}e.boundingBox=new M({left:0,bottom:0,right:i.PackedWidth,top:i.PackedHeight})}class ti extends e1{isAncestor(e){return this.graph.isAncestor(e.node)}deepTranslate(e){for(let t of this.nodesBreadthFirst){for(let r of(t instanceof ti?t.boundingBox=t.boundingBox.translate(e):t.translate(e),t.selfEdges()))r.translate(e);for(let r of t.outEdges())this.graph.isAncestor(r.target.node)&&r.translate(e)}this.boundingBox=this.boundingBox.translate(e)}clone(){let e=new ti(null);return e.boundingBox=this.boundingBox.clone(),e.layoutSettings=this.layoutSettings,e.margins=this.margins,e.radX=this.radX,e.radY=this.radY,e}calculateBoundsFromChildren(){let e=M.mkEmpty();for(let t of this.shallowNodes)e.addRecSelf(t.boundingBox);return e.padEverywhere(this.margins),e}*allSuccessorsWidthFirst(){for(let e of this.graph.allSuccessorsWidthFirst())yield e1.getGeom(e)}static getGeom(e){return o.getGeom(e)}edgeCurveOrArrowheadsIntersectRect(e,t){for(let r of e.sourceArrowheadPoints(25))if(t.contains(r))return!0;for(let r of e.targetArrowheadPoints(25))if(t.contains(r))return!0;let r=e.curve,i=t.perimeter();return null!=C.intersectionOne(r,i,!1)||C.PointRelativeToCurveLocation(r.start,i)===el.Inside}isEmpty(){return this.graph.isEmpty()}setSettingsRecursively(e){for(let t of(this.layoutSettings=e,this.nodesBreadthFirst))t.layoutSettings=e}get layoutSettings(){return this._layoutSettings}set layoutSettings(e){this._layoutSettings=e}get labelSize(){return this._labelSize}set labelSize(e){this._labelSize=e}get boundingBox(){return this.rrect?this.rrect.clone():null}set boundingBox(e){e?this.rrect.setRect(e):this.rrect.roundedRect_=null}transform(e){if(!e.isIdentity()){for(let t of this.shallowNodes)t.transform(e);for(let t of this.shallowEdges)t.transform(e),t.label&&t.label.transform(e);this.boundingBox=null==this.rrect||this.rrect.isEmpty()?this.pumpTheBoxToTheGraphWithMargins():this.boundingBox.transform(e)}}translate(e){(0!==e.x||0!==e.y)&&this.deepTranslate(e)}get nodesBreadthFirst(){return this.nodesBreadthFirstIter()}*nodesBreadthFirstIter(){for(let e of this.graph.nodesBreadthFirst)yield o.getGeom(e)}setEdge(e,t){return new V(this.graph.setEdge(e,t))}getPumpedGraphWithMarginsBox(){let e={b:M.mkEmpty()};return tn(this,e),e.b.padEverywhere(this.margins),e.b}pumpTheBoxToTheGraphWithMargins(){return this.boundingBox=this.getPumpedGraphWithMarginsBox()}get center(){return this.boundingBox||this.boundingBox.isEmpty?this.boundingBox.center:new g(0,0)}set center(e){let t=e.sub(this.center),r=new k(1,0,t.x,0,1,t.y);this.transform(r)}get left(){return this.boundingBox.left}get right(){return this.boundingBox.right}get top(){return this.boundingBox.top}get bottom(){return this.boundingBox.bottom}CheckClusterConsistency(){throw Error("Method not implemented.")}get edgeCount(){return this.graph.edgeCount}get boundaryCurve(){return this.rrect.roundedRect_}set boundaryCurve(e){throw Error()}get shallowNodes(){return this.shallowNodes_()}*shallowNodes_(){for(let e of this.graph.shallowNodes)yield o.getGeom(e)}get deepEdges(){return this.deepEdgesIt()}*deepEdgesIt(){for(let e of this.graph.deepEdges)yield o.getGeom(e)}get shallowEdges(){return this.shallowEdgesIt()}*shallowEdgesIt(){for(let e of this.graph.shallowEdges)yield o.getGeom(e)}static mk(e,t=new I(0,0)){let r=new ti(new eJ(e));return r.labelSize=t,r}get Clusters(){return this.subgraphs()}*subgraphs(){for(let e of this.graph.subgraphsBreadthFirst())yield o.getGeom(e)}static mkWithGraphAndLabel(e,t){let r=new ti(e);return r.labelSize=t,r}constructor(e){super(e),this.margins={left:10,top:10,bottom:10,right:10},this.radX=10,this.radY=10,this.rrect=new tt({left:0,right:-1,top:20,bottom:0,radX:this.radX,radY:this.radY})}get deepNodeCount(){let e=0;for(let t of this.graph.nodesBreadthFirst)e++;return e}get subgraphsDepthFirst(){return this.getSubgraphsDepthFirst()}*getSubgraphsDepthFirst(){for(let e of this.graph.allSuccessorsDepthFirst())e instanceof eJ&&(yield ti.getGeom(e))}get uniformMargins(){return Math.max(this.margins.left,this.margins.right,this.margins.right,this.margins.bottom)}set uniformMargins(e){this.margins.left=this.margins.right=this.margins.right=this.margins.bottom=e}get height(){return this.boundingBox.height}get width(){return this.boundingBox.width}get shallowNodeCount(){return this.graph.shallowNodeCount}get graph(){return this.entity}liftNode(e){let t=this.graph.liftNode(e.node);return t?o.getGeom(t):null}findNode(e){let t=this.graph.findNode(e);return t?o.getGeom(t):null}addNode(e){return this.graph.addNode(e.node),e}addLabelToGraphBB(e){this.labelSize&&(e.top+=this.labelSize.height+2,e.width<this.labelSize.width&&(e.width=this.labelSize.width))}}function tn(e,t){for(let r of e.shallowEdges){if(!function(t){if(null==t||null==t.curve||t.underCollapsedGraph())return!1;if(!(e instanceof ti))return!0;{let r=e.entity;return r.isAncestor(t.source.entity)&&r.isAncestor(t.target.entity)}}(r))continue;let i=r.curve.boundingBox;if(t.b.addRecSelf(i),null!=r.edge.label){let e=o.getGeom(r.edge.label);e&&t.b.addRecSelf(e.boundingBox)}}for(let r of e.shallowNodes)"shallowEdges"in r&&tn(r,t),!r.underCollapsedGraph()&&r.boundingBox&&t.b.addRecSelf(r.boundingBox);e instanceof ti&&e.addLabelToGraphBB(t.b)}class ts{get Parents(){return Array.from(this.parents.values())}get Children(){return Array.from(this.children.values())}get BoundaryCurve(){return this.boundaryCurve}set BoundaryCurve(e){this.boundaryCurve=e}get BoundingBox(){return this.BoundaryCurve.boundingBox}get Ports(){return this.ports}static mkShape(){return new ts(null)}constructor(e=null){this.parents=new Set,this.children=new Set,this.ports=new Set,this.BoundaryCurve=e}get IsGroup(){return this.children.size>0}*Descendants(){let e=new eq.Queue;for(let t of this.Children)e.enqueue(t);for(;e.length>0;){let t=e.dequeue();for(let r of(yield t,t.Children))e.enqueue(r)}}*Ancestors(){let e=new eq.Queue;for(let t of this.Parents)e.enqueue(t);for(;e.length>0;){let t=e.dequeue();for(let r of(yield t,t.Parents))e.enqueue(r)}}AddParent(e){this.parents.add(e),e.children.add(this)}AddChild(e){e.parents.add(this),this.children.add(e)}RemoveChild(e){this.children.delete(e),e.parents.delete(this)}RemoveParent(e){this.parents.delete(e),e.children.delete(this)}ToString(){return this.UserData?this.UserData.toString():"null"}}class to{}class ta extends to{constructor(e,t){super(),this.curve=this.curve,this.location=t.clone()}get Location(){return this.location}set Location(e){this.location=e}Translate(e){this.location=this.location.add(e)}get Curve(){return this.curve}set Curve(e){this.curve=e}}class tl extends ta{static mk(e,t){return new tl(e,t,new g(0,0))}get CenterDelegate(){return this.centerDelegate}set CenterDelegate(e){this.centerDelegate=e}get CurveDelegate(){return this.curveDelegate}set CurveDelegate(e){this.curveDelegate=e}get LocationOffset(){return this.locationOffset}set LocationOffset(e){this.locationOffset=e}constructor(e,t,r){super(null,t().add(r)),this.LocationOffset=r,this.CurveDelegate=e,this.CenterDelegate=t}get Location(){return this.CenterDelegate().add(this.LocationOffset)}get Curve(){return this.CurveDelegate()}}class th{constructor(e,t,r,i,n){this.color=e,void 0!==t&&(this.item=t),void 0!==r&&(this.parent=r),void 0!==i&&(this.left=i),void 0!==n&&(this.right=n)}toString(){return this.item.toString()}}(z=ed||(ed={}))[z.Red=0]="Red",z[z.Black=1]="Black";class tu{[Symbol.iterator](){return this.allNodes()}constructor(e){this.comparer=e,this.count=0,this.root=this.nil=new th(ed.Black)}clear(){this.root=this.nil=new th(ed.Black)}toNull(e){return e!==this.nil?e:null}isEmpty(){return this.root===this.nil}getComparer(){return this.comparer}getRoot(){return this.root}find(e,t=this.root){let r;for(;t!==this.nil&&0!==(r=this.comparer(e,t.item));)t=r<0?t.left:t.right;return this.toNull(t)}findFirst(e,t=this.root){if(t===this.nil)return null;let r=null;for(;t!==this.nil;)t=e(t.item)?(r=t).left:t.right;return r}findLast(e,t=this.root){if(t===this.nil)return null;let r=null;for(;t!==this.nil;)t=e(t.item)?(r=t).right:t.left;return r}treeMinimum(e=this.root){for(;e.left!==this.nil;)e=e.left;return this.toNull(e)}treeMaximum(e=this.root){for(;e.right!==this.nil;)e=e.right;return this.toNull(e)}next(e){if(e.right!==this.nil)return this.treeMinimum(e.right);let t=e.parent;for(;t!==this.nil&&e===t.right;)e=t,t=t.parent;return this.toNull(t)}previous(e){if(e.left!==this.nil)return this.treeMaximum(e.left);let t=e.parent;for(;t!==this.nil&&e===t.left;)e=t,t=t.parent;return this.toNull(t)}leftRotate(e){let t=e.right;e.right=t.left,t.left!==this.nil&&(t.left.parent=e),t.parent=e.parent,e.parent===this.nil?this.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}rightRotate(e){let t=e.left;e.left=t.right,t.right!==this.nil&&(t.right.parent=e),t.parent=e.parent,e.parent===this.nil?this.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}deleteFixup(e){for(;e!==this.root&&e.color===ed.Black;)if(e===e.parent.left){let t=e.parent.right;t.color===ed.Red&&(t.color=ed.Black,e.parent.color=ed.Red,this.leftRotate(e.parent),t=e.parent.right),t.left.color===ed.Black&&t.right.color===ed.Black?(t.color=ed.Red,e=e.parent):(t.right.color===ed.Black&&(t.left.color=ed.Black,t.color=ed.Red,this.rightRotate(t),t=e.parent.right),t.color=e.parent.color,e.parent.color=ed.Black,t.right.color=ed.Black,this.leftRotate(e.parent),e=this.root)}else{let t=e.parent.left;t.color===ed.Red&&(t.color=ed.Black,e.parent.color=ed.Red,this.rightRotate(e.parent),t=e.parent.left),t.right.color===ed.Black&&t.left.color===ed.Black?(t.color=ed.Red,e=e.parent):(t.left.color===ed.Black&&(t.right.color=ed.Black,t.color=ed.Red,this.leftRotate(t),t=e.parent.left),t.color=e.parent.color,e.parent.color=ed.Black,t.left.color=ed.Black,this.rightRotate(e.parent),e=this.root)}e.color=ed.Black}deleteSubTree(e){let t;if(e.left===this.nil||e.right===this.nil)t=e;else for(t=e.right;t.left!==this.nil;)t=t.left;let r=t.left!==this.nil?t.left:t.right;return r.parent=t.parent,t.parent===this.nil?this.root=r:t===t.parent.left?t.parent.left=r:t.parent.right=r,t!==e&&(e.item=t.item),t.color===ed.Black&&this.deleteFixup(r),this.toNull(e)}deleteNodeInternal(e){this.count--,this.deleteSubTree(e)}remove(e){let t=this.find(e);return null!=t?(this.count--,this.deleteSubTree(t)):null}insert(e){let t=this.treeInsert(e);return this.insertPrivate(t),this.toNull(t)}treeInsert(e){let t=this.nil,r=this.root,i=0;for(;r!==this.nil;)t=r,r=(i=this.comparer(e,r.item))<0?r.left:r.right;let n=new th(ed.Black,e,t,this.nil,this.nil);return t===this.nil?this.root=n:i<0?t.left=n:t.right=n,this.toNull(n)}insertPrivate(e){for(this.count++,e.color=ed.Red;e!==this.root&&e.parent.color===ed.Red;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===ed.Red?(e.parent.color=ed.Black,t.color=ed.Black,e.parent.parent.color=ed.Red,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,this.leftRotate(e)),e.parent.color=ed.Black,e.parent.parent.color=ed.Red,this.rightRotate(e.parent.parent))}else{let t=e.parent.parent.left;t.color===ed.Red?(e.parent.color=ed.Black,t.color=ed.Black,e.parent.parent.color=ed.Red,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,this.rightRotate(e)),e.parent.color=ed.Black,e.parent.parent.color=ed.Red,this.leftRotate(e.parent.parent))}this.root.color=ed.Black}*allNodes(){if(this.isEmpty())return;let e=this.treeMinimum();for(;null!=e;)yield e.item,e=this.next(e)}toString(){let e="{",t=0;for(let r of this.allNodes())e+=r.toString(),t!==this.count-1&&(e+="\n"),t++;return e+"}"}}class tc{*[Symbol.iterator](){for(let e=1;e<=this.heapSize;e++)yield this.A[e]}Enqueue(e){let t,r,i=this.heapSize+1;this.A[i]=e,this.heapSize++;let n=i>>1;for(;i>1&&this.Less(t=this.A[i],r=this.A[n]);)this.A[n]=t,this.A[i]=r,n=(i=n)>>1}Dequeue(){if(this.heapSize<1)throw Error();let e=this.A[1],t=this.A[this.heapSize];return this.heapSize--,this.ChangeMinimum(t),e}ChangeMinimum(e){this.A[1]=e;let t=1,r=2,i=!1;for(;r<this.heapSize&&!i;){i=!0;let n=this.A[r],s=this.A[r+1];0>this.compare(n,s)?0>this.compare(n,e)&&(this.A[t]=n,this.A[r]=e,i=!1,r=(t=r)<<1):0>this.compare(s,e)&&(this.A[t]=s,this.A[r+1]=e,i=!1,r=(t=r+1)<<1)}if(r===this.heapSize){let i=this.A[r];0>this.compare(i,e)&&(this.A[t]=i,this.A[r]=e)}}get Count(){return this.heapSize}Less(e,t){return 0>this.compare(e,t)}constructor(e){this.heapSize=0,this.A=[],this.compare=e}GetMinimum(){return this.A[1]}}class td{}class tf extends td{get Site(){return this.Vertex.point}constructor(e){super(),this.Vertex=e}get Polyline(){return this.Vertex.polyline}}class tp extends tf{constructor(e){super(e)}}class tg{constructor(e){this.lineSweeper=e}Compare(e,t){switch(g.getTriangleOrientation(t.Start,t.End,this.x)){case eo.Collinear:return 0;case eo.Clockwise:return 1;default:return -1}}SetOperand(e){this.x=this.IntersectionOfSideAndSweepLine(e)}IntersectionOfSideAndSweepLine(e){let t=e.Direction.dot(this.lineSweeper.SweepDirection),r=(this.lineSweeper.Z-e.Start.dot(this.lineSweeper.SweepDirection))/t;return e.Start.add(e.Direction.mul(r))}}class tm extends td{constructor(e){super(),this.site=e}get Site(){return this.site}}class tv{constructor(e,t){this.PreviousZ=Number.NEGATIVE_INFINITY,this.z=Number.NEGATIVE_INFINITY,this.Obstacles=null!=e?e:[],this.SweepDirection=t,this.DirectionPerp=t.rotate(-Math.PI/2),this.EventQueue=new tc((e,t)=>this.Compare(e,t)),this.ObstacleSideComparer=new tg(this),this.LeftObstacleSideTree=new tu((e,t)=>this.ObstacleSideComparer.Compare(e,t)),this.RightObstacleSideTree=new tu((e,t)=>this.ObstacleSideComparer.Compare(e,t))}get EventQueue(){return this.eventQueue}set EventQueue(e){this.eventQueue=e}get DirectionPerp(){return this.directionPerp}set DirectionPerp(e){this.directionPerp=e}get Z(){return this.z}set Z(e){e>this.z+l.tolerance&&(this.PreviousZ=this.z),this.z=e}GetZS(e){return this.SweepDirection.dot(e.Site)}GetZP(e){return this.SweepDirection.dot(e)}SegmentIsNotHorizontal(e,t){return Math.abs(e.sub(t).dot(this.SweepDirection))>l.distanceEpsilon}RemoveLeftSide(e){this.ObstacleSideComparer.SetOperand(e),this.LeftObstacleSideTree.remove(e)}RemoveRightSide(e){this.ObstacleSideComparer.SetOperand(e),this.RightObstacleSideTree.remove(e)}InsertLeftSide(e){this.ObstacleSideComparer.SetOperand(e),this.LeftObstacleSideTree.insert(e)}InsertRightSide(e){this.ObstacleSideComparer.SetOperand(e),this.RightObstacleSideTree.insert(e)}FindFirstObstacleSideToTheLeftOfPoint(e){let t=this.RightObstacleSideTree.findLast(t=>g.pointToTheRightOfLineOrOnLine(e,t.Start,t.End));return null==t?null:t.item}FindFirstObstacleSideToToTheRightOfPoint(e){let t=this.LeftObstacleSideTree.findFirst(t=>!g.pointToTheRightOfLineOrOnLine(e,t.Start,t.End));return null==t?null:t.item}EnqueueEvent(e){this.eventQueue.Enqueue(e)}InitQueueOfEvents(){for(let e of this.Obstacles)this.EnqueueLowestPointsOnObstacles(e);if(null!=this.Ports)for(let e of this.Ports.values())this.EnqueueEvent(new tm(e))}EnqueueLowestPointsOnObstacles(e){let t=this.GetLowestPoint(e);this.EnqueueEvent(new tp(t))}GetLowestPoint(e){let t=e.startPoint,r=e.startPoint.next;for(;null!=r;r=r.next)this.Less(r.point,t.point)&&(t=r);return t}Compare(e,t){let r=e.Site,i=t.Site;return this.ComparePoints(r,i)}Less(e,t){return 0>this.ComparePoints(e,t)}ComparePoints(e,t){let r=this.SweepDirection.dot(e),i=this.SweepDirection.dot(t);return r<i?-1:r>i?1:(r=this.directionPerp.dot(e),r<(i=this.directionPerp.dot(t))?-1:r>i?1:0)}}var tb=r("709");class ty{static closeuv(e,t){return g.closeDistEps(e.point,ty.u,.1)&&g.closeDistEps(t.point,ty.v,.1)}constructor(e,t,r=1){this.LengthMultiplier=1,this.Source=e,this.Target=t,this.Weight=r}get SourcePoint(){return this.Source.point}get TargetPoint(){return this.Target.point}get Length(){return this.SourcePoint.sub(this.TargetPoint).length*this.LengthMultiplier}toString(){return tb.String.format("{0}->{1} ({2})",this.Source,this.Target,this.Weight)}ReversedClone(){return new ty(this.Target,this.Source)}Clone(){return new ty(this.Source,this.Target)}}ty.u=new g(545.833,840.458),ty.v=new g(606.1667261889578,786.2917261889578),ty.DefaultWeight=1;class tx extends ty{static constructorVV(e,t){return new tx(e,t,0)}constructor(e,t,r=0){super(e,t,r)}}class t_{deleteP(e){return this.delete(e.x,e.y)}clear(){this.m.clear()}get size(){return this.m.size}setxy(e,t,r){this.m.set(tS(e,t),r)}set(e,t){this.setxy(e.x,e.y,t)}delete(e,t){return this.m.delete(tS(e,t))}hasxy(e,t){return this.m.has(tS(e,t))}has(e){return this.hasxy(e.x,e.y)}getxy(e,t){return this.m.get(tS(e,t))}get(e){return this.getxy(e.x,e.y)}constructor(){this.m=new Map}*keys(){for(let e of this.m.keys()){let t=e.split(",");yield new g(Number(t[0]),Number(t[1]))}}*[Symbol.iterator](){for(let[e,t]of this.m){let r=e.split(",");yield[new g(Number(r[0]),Number(r[1])),t]}}*values(){yield*this.m.values()}}function tS(e,t){return e.toString()+","+t.toString()}class tw{get InEdges(){return this._inEdges}get OutEdges(){return this._outEdges}get Degree(){return this._inEdges.length+this.OutEdges.count}InEdgesLength(){return this._inEdges.length}addInEdge(e){this._inEdges.push(e)}get IsTerminal(){return this._isTerminal}set IsTerminal(e){this._isTerminal=e}get IsShortestPathTerminal(){return this._isShortestPathTerminal}set IsShortestPathTerminal(e){this._isShortestPathTerminal=e}constructor(e){this._inEdges=[],this._outEdges=new tu((e,t)=>this.Compare(e,t)),this.point=e}toString(){return this.point.toString()}RemoveOutEdge(e){this.OutEdges.remove(e)}RemoveInEdge(e){let t=this._inEdges.indexOf(e);if(-1===t)return;let r=this._inEdges.length-1;t!==r&&(this._inEdges[t]=this._inEdges[r]),this._inEdges.pop()}static FindFirst(e,t){return tw.FindFirst_t(e.root,e,t)}static FindFirst_t(e,t,r){if(e===t.nil)return null;let i=null;for(;e!==t.nil;)e=e.item.TargetPoint.compareTo(r)>=0?(i=e).left:e.right;return i}get(e){let t=tw.FindFirst(this.OutEdges,e.point);return null!=t&&t.item.Target===e||null!=(t=tw.FindFirst(e.OutEdges,this.point))&&t.item.Target===this?t.item:null}Compare(e,t){return e.TargetPoint.compareTo(t.TargetPoint)}ClearEdges(){this._outEdges.clear(),this._inEdges=[]}}class tT{constructor(){this.activeVertices=new Set,this.VertexFactory=e=>new tw(e),this.pointToVertexMap=new t_}*edges_(){for(let e of this.pointToVertexMap.values())for(let t of e.OutEdges)yield t}get Edges(){return this.edges_()}ClearPrevEdgesTable(){for(let e of this.activeVertices)e.prevEdge=null;this.activeVertices.clear()}ShrinkLengthOfPrevEdge(e,t){e.prevEdge.LengthMultiplier=t}PreviosVertex(e){let t=e.prevEdge;return t?t.Source===e?t.Target:t.Source:null}SetPreviousEdge(e,t){this.activeVertices.add(e),e.prevEdge=t}AddHole(e){let t=e.startPoint;for(;t!==e.endPoint;)this.AddEdgePlPl(t,t.next),t=t.next;this.AddEdgePlPl(e.endPoint,e.startPoint)}static*OrientHolesClockwise(e){for(let t of e)for(let e=t.startPoint;;e=e.next){let r=g.getTriangleOrientation(e.point,e.next.point,e.next.next.point);if(r!==eo.Collinear){yield r===eo.Clockwise?t:t.reverse();break}}}AddVertexP(e){let t=this.pointToVertexMap.get(e);if(t)return t;let r=this.VertexFactory(e);return this.pointToVertexMap.set(e,r),r}AddVertexV(e){this.pointToVertexMap.set(e.point,e)}ContainsVertex(e){return this.pointToVertexMap.has(e)}static AddEdgeVV(e,t){let r;if(r=e.get(t))return r;if(e===t)throw Error("Self-edges are not allowed");let i=new ty(e,t);return e.OutEdges.insert(i),t.InEdges.push(i),i}AddEdgePlPl(e,t){this.AddEdgePP(e.point,t.point)}static AddEdge(e){e.Source.OutEdges.insert(e),e.Target.addInEdge(e)}AddEdgeF(e,t,r){let i=this.FindVertex(e),n=null;if(null!=i&&null!=(n=this.FindVertex(t))){let e=i.get(n);if(e)return e}null==i?(i=this.AddVertexP(e),n=this.AddVertexP(t)):null==n&&(n=this.AddVertexP(t));let s=r(i,n);return i.OutEdges.insert(s),n.addInEdge(s),s}AddEdgePP(e,t){return this.AddEdgeF(e,t,(e,t)=>new ty(e,t))}FindVertex(e){return this.pointToVertexMap.get(e)}Vertices(){return this.pointToVertexMap.values()}RemoveVertex(e){for(let t of e.OutEdges)t.Target.RemoveInEdge(t);for(let t of e.InEdges)t.Source.RemoveOutEdge(t);this.pointToVertexMap.deleteP(e.point)}FindEdgePP(e,t){let r=this.FindVertex(e);if(null==r)return null;let i=this.FindVertex(t);return null==i?null:r.get(i)}static RemoveEdge(e){e.Source.RemoveOutEdge(e),e.Target.RemoveInEdge(e)}ClearEdges(){for(let e of this.Vertices())e.ClearEdges()}}class tP{constructor(){this.Removed=!1}}class tE extends tP{get Start(){return this.start}get End(){return this.EndVertex.point}constructor(e,t,r){super(),this.start=e,this.EndVertex=t,this.ConeSide=r}get Direction(){return this.End.sub(this.Start)}toString(){return"BrokenConeSide: "+(this.Start+",")+this.End}}class tC{get Removed(){return this.removed}set Removed(e){this.removed=e}constructor(e,t){this.apex=e,this.coneSweeper=t}get Apex(){return this.apex}set Apex(e){this.apex=e}get RightSideDirection(){return this.coneSweeper.ConeRightSideDirection}get LeftSideDirection(){return this.coneSweeper.ConeLeftSideDirection}get RightSide(){return this.rightSide}set RightSide(e){this.rightSide=e,this.rightSide.Cone=this}get LeftSide(){return this.leftSide}set LeftSide(e){this.leftSide=e,this.leftSide.Cone=this}}class tA extends td{get ConeToClose(){return this.coneToClose}get Site(){return this.site}constructor(e,t){super(),this.site=e,this.coneToClose=t}toString(){return"ConeClosureEvent "+this.site}}class tI extends tP{constructor(e){super(),this.Cone=e}get Start(){return this.Cone.Apex}get Direction(){return this.Cone.LeftSideDirection}toString(){return"ConeLeftSide "+this.Start+" "+this.Direction}}class tM extends tP{constructor(e){super(),this.Cone=e}get Start(){return this.Cone.Apex}get Direction(){return this.Cone.RightSideDirection}toString(){return"ConeRightSide "+this.Start+" "+this.Direction}}class tR{SetOperand(e){this.x=this.IntersectionOfSegmentAndSweepLine(e)}constructor(e){this.coneSweeper=e}Compare(e,t){let r=e instanceof tE,i=t instanceof tE;return r?i?this.CompareBrokenSides(e,t):this.CompareObstacleSideAndConeSide(t):i?this.CompareConeSideAndObstacleSide(e,t):tR.CompareNotIntersectingSegs(e,t)}static CompareNotIntersectingSegs(e,t){switch(g.getTriangleOrientation(e.Start,t.Start,t.Start.add(t.Direction))){case eo.Counterclockwise:return -1;case eo.Clockwise:return 1;default:return 0}}CompareObstacleSideAndConeSide(e){let t=g.getTriangleOrientation(this.x,e.Start,e.Start.add(e.Direction));return t===eo.Counterclockwise?-1:t===eo.Clockwise?1:e instanceof tI?-1:1}CompareConeSideAndObstacleSide(e,t){let r=g.getTriangleOrientation(this.x,t.start,t.End);return r===eo.Counterclockwise?-1:r===eo.Clockwise?1:e instanceof tI?1:-1}IntersectionOfSegmentAndSweepLine(e){let t=e.Direction.dot(this.coneSweeper.SweepDirection),r=(this.coneSweeper.Z-e.Start.dot(this.coneSweeper.SweepDirection))/t;return e.Start.add(e.Direction.mul(r))}CompareBrokenSides(e,t){return e.EndVertex===t.EndVertex?tR.CompareNotIntersectingSegs(e.ConeSide,t.ConeSide):g.getTriangleOrientation(this.x,t.start,t.EndVertex.point)===eo.Counterclockwise?-1:1}}class tO extends td{get EndVertex(){return this.endVertex}constructor(e,t,r){super(),this.coneLeftSide=e,this.intersectionPoint=t,this.endVertex=r}get Site(){return this.intersectionPoint}toString(){return"LeftIntersectionEvent "+this.intersectionPoint}}class tk{get Direction(){return this.End.sub(this.Start)}toString(){return this.Start+" "+this.End}}class tN extends tk{Init(e){this.StartVertex=e}constructor(e){super(),this.Init(e)}get Polyline(){return this.StartVertex.polyline}get Start(){return this.StartVertex.point}get End(){return this.EndVertex.point}}class tL extends tN{constructor(e){super(e),this.end=e.nextOnPolyline.point}get End(){return this.end}get EndVertex(){return this.StartVertex.nextOnPolyline}}class tD extends tf{constructor(e){super(e)}}class tB extends td{get EndVertex(){return this.endVertex}set EndVertex(e){this.endVertex=e}constructor(e,t,r){super(),this.coneRightSide=e,this.intersectionPoint=t,this.endVertex=r}get Site(){return this.intersectionPoint}toString(){return"RightIntersectionEvent "+this.intersectionPoint}}class tF extends tN{constructor(e){super(e),this.end=e.prevOnPolyline.point}get End(){return this.end}get EndVertex(){return this.StartVertex.prevOnPolyline}}class tV extends tf{constructor(e){super(e)}}class tG extends tv{constructor(e,t,r,i,n,s,o){super(e,t),this.visibilityGraph=n,this.ConeRightSideDirection=r,this.ConeLeftSideDirection=i,this.coneSideComparer=new tR(this),this.leftConeSides=new tu((e,t)=>this.coneSideComparer.Compare(e,t)),this.rightConeSides=new tu((e,t)=>this.coneSideComparer.Compare(e,t)),this.Ports=s,this.BorderPolyline=o,this.PortEdgesCreator=(e,t)=>new tx(e,t,0)}static Sweep(e,t,r,i,n,s){new tG(e,t,t.rotate(-r/2),t.rotate(r/2),i,n,s).Calculate()}Calculate(){for(this.InitQueueOfEvents();this.EventQueue.Count>0;)this.ProcessEvent(this.EventQueue.Dequeue());null!=this.BorderPolyline&&this.CloseRemainingCones(),this.CreatePortEdges()}CreatePortEdges(){if(null!=this.portEdgesGraph)for(let e of this.portEdgesGraph.Edges)this.visibilityGraph.AddEdgeF(e.SourcePoint,e.TargetPoint,this.PortEdgesCreator)}CloseRemainingCones(){if(0===this.leftConeSides.count)return;let e=this.BorderPolyline.startPoint,t=this.leftConeSides.count;do{let r=this.leftConeSides.treeMinimum().item.Cone;e=this.FindPolylineSideIntersectingConeRightSide(e,r),e=this.GetPolylinePointInsideOfConeAndRemoveCones(e,r),t--}while(this.leftConeSides.count>0&&t>0)}GetPolylinePointInsideOfConeAndRemoveCones(e,t){let r=e.nextOnPolyline,i=tG.FindInsidePoint(e.point,r.point,t);return g.closeDistEps(i,e.point)?(this.AddEdgeAndRemoveCone(t,e.point),this.AddEdgesAndRemoveRemainingConesByPoint(e.point)):g.closeDistEps(i,r.point)?(this.AddEdgeAndRemoveCone(t,r.point),this.AddEdgesAndRemoveRemainingConesByPoint(r.point),e=r):(e=tG.InsertPointIntoPolylineAfter(this.BorderPolyline,e,i),this.AddEdgeAndRemoveCone(t,e.point),this.AddEdgesAndRemoveRemainingConesByPoint(e.point)),e}static FindInsidePoint(e,t,r){return tG.FindInsidePointBool(e,t,r.Apex,r.Apex.add(r.LeftSideDirection),r.Apex.add(r.RightSideDirection))}static FindInsidePointBool(e,t,r,i,n){if(g.closeDistEps(e,t)||g.PointIsInsideCone(e,r,i,n))return e;if(g.PointIsInsideCone(t,r,i,n))return t;let s=g.middle(e,t);return g.pointToTheLeftOfLine(s,r,i)?tG.FindInsidePointBool(s,t,r,i,n):tG.FindInsidePointBool(e,s,r,i,n)}AddEdgesAndRemoveRemainingConesByPoint(e){let t=[];for(let r of this.leftConeSides)if(g.PointToTheRightOfLineOrOnLine(e,r.Start,r.Start.add(r.Direction)))t.push(r.Cone);else break;for(let r of t)this.AddEdgeAndRemoveCone(r,e)}FindPolylineSideIntersectingConeRightSide(e,t){let r=e,i=t.Apex,n=t.Apex.add(this.ConeRightSideDirection),s=tG.GetSign(e,i,n);for(;;){let t=e.nextOnPolyline,o=tG.GetSign(t,i,n);if(o-s>0)return e;if(e=t,s=o,e===r)throw Error("cannod decide if the polyline intersects the cone!")}}static GetSign(e,t,r){let i=g.signedDoubledTriangleArea(t,r,e.point);return i<0?1:i>0?-1:0}AddEdgeAndRemoveCone(e,t){null!=this.Ports&&this.Ports.has(e.Apex)?this.CreatePortEdge(e,t):this.visibilityGraph.AddEdgePP(e.Apex,t),this.RemoveCone(e)}CreatePortEdge(e,t){null==this.portEdgesGraph&&(this.portEdgesGraph=new tT);let r=this.portEdgesGraph.FindVertex(e.Apex),i=null!=r?Array.from(r.InEdges).concat(Array.from(r.OutEdges.allNodes())):null;if(i)for(let e of i){let i=(e.Target===r?e.Source:e.Target).point;tT.RemoveEdge(e),this.portEdgesGraph.AddEdgePP(i,t)}this.portEdgesGraph.AddEdgePP(e.Apex,t)}static InsertPointIntoPolylineAfter(e,t,r){let i;return null!=t.next?((i=m.mkFromPoint(r)).prev=t,i.next=t.next,t.next.prev=i,t.next=i):((i=m.mkFromPoint(r)).prev=t,t.next=i,e.endPoint=i),i.polyline=e,e.setInitIsRequired(),i}ProcessEvent(e){e instanceof tf?this.ProcessVertexEvent(e):e instanceof tB?this.ProcessRightIntersectionEvent(e):e instanceof tO?this.ProcessLeftIntersectionEvent(e):(e instanceof tA?!e.ConeToClose.Removed&&this.RemoveCone(e.ConeToClose):this.ProcessPortObstacleEvent(e),this.Z=this.GetZS(e))}ProcessPortObstacleEvent(e){this.Z=this.GetZS(e),this.GoOverConesSeeingVertexEvent(e),this.CreateConeOnVertex(e)}ProcessLeftIntersectionEvent(e){if(!1===e.coneLeftSide.Removed){if(Math.abs(e.EndVertex.point.sub(e.Site).dot(this.SweepDirection))<l.distanceEpsilon)this.RemoveCone(e.coneLeftSide.Cone);else{this.RemoveSegFromLeftTree(e.coneLeftSide),this.Z=this.GetZP(e.Site);let t=new tE(e.Site,e.EndVertex,e.coneLeftSide);this.InsertToTree(this.leftConeSides,t),e.coneLeftSide.Cone.LeftSide=t,this.LookForIntersectionOfObstacleSideAndLeftConeSide(e.Site,e.EndVertex),this.TryCreateConeClosureForLeftSide(t)}}else this.Z=this.GetZP(e.Site)}TryCreateConeClosureForLeftSide(e){if(e.Cone.RightSide instanceof tM){let t=e.Cone.RightSide;g.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.EndVertex.point)==eo.Clockwise&&this.CreateConeClosureEvent(e,t)}}CreateConeClosureEvent(e,t){let r=g.RayIntersectsRayInteriors(e.start,e.Direction,t.Start,t.Direction);if(r){let t=new tA(r,e.Cone);this.EnqueueEvent(t)}}ProcessRightIntersectionEvent(e){if(e.coneRightSide.Removed)this.Z=this.GetZP(e.Site);else{this.RemoveSegFromRightTree(e.coneRightSide),this.Z=this.GetZP(e.Site);let t=new tE(e.Site,e.EndVertex,e.coneRightSide);this.InsertToTree(this.rightConeSides,t),e.coneRightSide.Cone.RightSide=t,this.LookForIntersectionOfObstacleSideAndRightConeSide(e.Site,e.EndVertex),this.TryCreateConeClosureForRightSide(t)}}TryCreateConeClosureForRightSide(e){if(e.Cone.LeftSide instanceof tI){let t=e.Cone.LeftSide;g.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.EndVertex.point)==eo.Counterclockwise&&this.CreateConeClosureEvent(e,t)}}RemoveConesClosedBySegment(e,t){this.CloseConesCoveredBySegment(e,t,this.GetZP(e)>this.GetZP(t)?this.leftConeSides:this.rightConeSides)}CloseConesCoveredBySegment(e,t,r){let i=r.findFirst(t=>g.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e)===eo.Counterclockwise);if(null==i||!g.IntervalIntersectsRay(e,t,i.item.Start,i.item.Direction))return;let n=[];do n.push(i.item.Cone),i=r.next(i);while(null!=i&&void 0!==g.IntervalIntersectsRay(e,t,i.item.Start,i.item.Direction));for(let e of n)this.RemoveCone(e)}ProcessVertexEvent(e){this.Z=this.GetZS(e),this.GoOverConesSeeingVertexEvent(e),this.AddConeAndEnqueueEvents(e)}static Diamond(e){return N.mkDiamond(2,2,e)}AddConeAndEnqueueEvents(e){if(e instanceof tD){let t=e.Vertex.nextOnPolyline;this.CloseConesAddConeAtLeftVertex(e,t)}else if(e instanceof tV){let t=e.Vertex.prevOnPolyline;this.CloseConesAddConeAtRightVertex(e,t)}else this.CloseConesAddConeAtLeftVertex(e,e.Vertex.nextOnPolyline),this.CloseConesAddConeAtRightVertex(e,e.Vertex.prevOnPolyline)}CloseConesAddConeAtRightVertex(e,t){let r=e.Vertex.nextOnPolyline.point;this.directionPerp.dot(e.Site.sub(r))>l.distanceEpsilon&&this.RemoveConesClosedBySegment(r,e.Vertex.point),this.directionPerp.dot(t.point.sub(e.Site))>l.distanceEpsilon&&this.RemoveConesClosedBySegment(e.Site,t.point);let i=e.Site,n=i.add(this.ConeLeftSideDirection),s=i.add(this.ConeRightSideDirection),o=t.point;this.GetZP(i.sub(r))>l.distanceEpsilon&&this.RemoveRightSide(new tF(e.Vertex.nextOnPolyline)),this.GetZP(i.sub(t.point))>l.distanceEpsilon&&this.RemoveLeftSide(new tL(t)),this.GetZP(o)+l.distanceEpsilon<this.GetZS(e)&&this.CreateConeOnVertex(e),g.PointToTheRightOfLineOrOnLine(o,i,n)?g.PointToTheLeftOfLineOrOnLine(o,i,s)?this.CaseToTheLeftOfLineOrOnLineConeRp(e,t):(this.GetZP(o.sub(i))>l.distanceEpsilon&&(this.LookForIntersectionOfObstacleSideAndLeftConeSide(e.Site,t),this.InsertRightSide(new tF(e.Vertex))),this.EnqueueRightVertexEvent(new tV(t))):(this.CreateConeOnVertex(e),g.PointToTheLeftOfLineOrOnLine(o.add(this.DirectionPerp),o,i)&&this.EnqueueRightVertexEvent(new tV(t)))}CaseToTheLeftOfLineOrOnLineConeRp(e,t){this.EnqueueRightVertexEvent(new tV(t));let r=new tC(e.Vertex.point,this),i=new tE(r.Apex,t,new tI(r));r.LeftSide=i,r.RightSide=new tM(r);let n=this.InsertToTree(this.rightConeSides,r.RightSide);this.LookForIntersectionWithConeRightSide(n);let s=this.InsertToTree(this.leftConeSides,r.LeftSide);this.FixConeLeftSideIntersections(i,s),this.GetZP(t.point.sub(e.Site))>l.distanceEpsilon&&this.InsertRightSide(new tF(e.Vertex))}LookForIntersectionOfObstacleSideAndRightConeSide(e,t){let r=this.GetLastNodeToTheLeftOfPointInRightSegmentTree(e);if(null!=r&&r.item instanceof tM){let i=g.IntervalIntersectsRay(e,t.point,r.item.Start,this.ConeRightSideDirection);i&&this.SegmentIsNotHorizontal(i,t.point)&&this.EnqueueEvent(this.CreateRightIntersectionEvent(r.item,i,t))}}CreateRightIntersectionEvent(e,t,r){return new tB(e,t,r)}GetLastNodeToTheLeftOfPointInRightSegmentTree(e){return this.rightConeSides.findLast(t=>tG.PointIsToTheRightOfSegment(e,t))}LookForIntersectionOfObstacleSideAndLeftConeSide(e,t){let r=this.GetFirstNodeToTheRightOfPoint(e);if(null==r||!(r.item instanceof tI))return;let i=r.item,n=g.IntervalIntersectsRay(e,t.point,i.Start,this.ConeLeftSideDirection);n&&this.EnqueueEvent(new tO(i,n,t))}GetFirstNodeToTheRightOfPoint(e){return this.leftConeSides.findFirst(t=>tG.PointIsToTheLeftOfSegment(e,t))}static PointIsToTheLeftOfSegment(e,t){return g.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e)===eo.Counterclockwise}static PointIsToTheRightOfSegment(e,t){return g.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e)===eo.Clockwise}FixConeLeftSideIntersections(e,t){do t=this.leftConeSides.next(t);while(null!=t&&g.PointToTheRightOfLineOrOnLine(e.Start,t.item.Start,t.item.Start.add(t.item.Direction)));if(null!=t&&t.item instanceof tI){let r=t.item,i=g.IntervalIntersectsRay(e.start,e.End,r.Start,r.Direction);i&&this.EnqueueEvent(new tO(r,i,e.EndVertex))}}InsertToTree(e,t){return this.coneSideComparer.SetOperand(t),e.insert(t)}CloseConesAddConeAtLeftVertex(e,t){let r=e.Vertex.prevOnPolyline.point;e.Site.sub(r).dot(this.directionPerp)<-l.distanceEpsilon&&this.RemoveConesClosedBySegment(e.Site,r),t.point.sub(e.Site).dot(this.directionPerp)<-l.distanceEpsilon&&this.RemoveConesClosedBySegment(t.point,e.Site);let i=e.Site,n=i.add(this.ConeLeftSideDirection),s=i.add(this.ConeRightSideDirection),o=t.point;this.GetZP(i.sub(r))>l.distanceEpsilon&&this.RemoveLeftSide(new tL(e.Vertex.prevOnPolyline));let a=this.GetZP(o)-this.Z;a<-l.distanceEpsilon&&this.RemoveRightSide(new tF(t));let h=o.sub(e.Site);if(a<-l.distanceEpsilon||c(a,0)&&this.GetZP(h)>0&&h.dot(this.directionPerp)>-l.distanceEpsilon)this.CreateConeOnVertex(e);else if(g.PointToTheLeftOfLineOrOnLine(o,i,s)){if(g.PointToTheLeftOfLineOrOnLine(o,i,n))this.EnqueueEvent(new tD(t)),this.GetZP(h)>l.distanceEpsilon&&(this.LookForIntersectionOfObstacleSideAndRightConeSide(e.Site,t),this.InsertLeftSide(new tL(e.Vertex)));else{this.EnqueueEvent(new tD(t));let r=new tC(e.Vertex.point,this),i=new tE(e.Vertex.point,t,new tM(r));r.RightSide=i,r.LeftSide=new tI(r),this.LookForIntersectionWithConeLeftSide(this.InsertToTree(this.leftConeSides,r.LeftSide));let n=this.InsertToTree(this.rightConeSides,i);this.FixConeRightSideIntersections(i,n),this.GetZP(h)>l.distanceEpsilon&&this.InsertLeftSide(new tL(e.Vertex))}}else this.CreateConeOnVertex(e),this.EnqueueEvent(new tD(t))}RemoveCone(e){e.Removed=!0,this.RemoveSegFromLeftTree(e.LeftSide),this.RemoveSegFromRightTree(e.RightSide)}RemoveSegFromRightTree(e){this.coneSideComparer.SetOperand(e);let t=this.rightConeSides.remove(e);if(e.Removed=!0,null==t){let r=this.Z;this.Z=Math.max(this.GetZP(e.Start),this.Z-.01),this.coneSideComparer.SetOperand(e),t=this.rightConeSides.remove(e),this.Z=r}}RemoveSegFromLeftTree(e){if(e.Removed=!0,this.coneSideComparer.SetOperand(e),null==this.leftConeSides.remove(e)){let t=this.Z;this.Z=Math.max(this.GetZP(e.Start),this.Z-.01),this.coneSideComparer.SetOperand(e),this.leftConeSides.remove(e),this.Z=t}}FixConeRightSideIntersections(e,t){do t=this.rightConeSides.previous(t);while(null!=t&&g.PointToTheLeftOfLineOrOnLine(e.start,t.item.Start,t.item.Start.add(t.item.Direction)));if(null!=t){let r;if(t.item instanceof tM){let i=t.item;(r=g.IntervalIntersectsRay(e.start,e.End,i.Start,i.Direction))&&this.EnqueueEvent(this.CreateRightIntersectionEvent(i,r,e.EndVertex))}}}CreateConeOnVertex(e){let t=new tC(e.Site,this);t.LeftSide=new tI(t),t.RightSide=new tM(t);let r=this.InsertToTree(this.leftConeSides,t.LeftSide),i=this.InsertToTree(this.rightConeSides,t.RightSide);this.LookForIntersectionWithConeRightSide(i),this.LookForIntersectionWithConeLeftSide(r)}LookForIntersectionWithConeLeftSide(e){if(e.item instanceof tI){let t=e.item,r=this.FindFirstObstacleSideToTheLeftOfPoint(t.Start);null!=r&&this.TryIntersectionOfConeLeftSideAndObstacleSide(t,r)}else{let t=e.item;null!=(e=this.leftConeSides.next(e))&&e.item instanceof tI&&this.TryIntersectionOfConeLeftSideAndObstacleConeSide(e.item,t)}}LookForIntersectionWithConeRightSide(e){if(e.item instanceof tM){let t=e.item,r=this.FindFirstObstacleSideToToTheRightOfPoint(t.Start);null!=r&&this.TryIntersectionOfConeRightSideAndObstacleSide(t,r)}else{let t=e.item;null!=(e=this.rightConeSides.previous(e))&&e.item instanceof tM&&this.TryIntersectionOfConeRightSideAndObstacleConeSide(e.item,t)}}TryIntersectionOfConeRightSideAndObstacleConeSide(e,t){let r=g.IntervalIntersectsRay(t.start,t.End,e.Start,e.Direction);r&&this.EnqueueEvent(this.CreateRightIntersectionEvent(e,r,t.EndVertex))}TryIntersectionOfConeRightSideAndObstacleSide(e,t){let r=g.IntervalIntersectsRay(t.Start,t.End,e.Start,e.Direction);r&&this.EnqueueEvent(this.CreateRightIntersectionEvent(e,r,t.EndVertex))}TryIntersectionOfConeLeftSideAndObstacleConeSide(e,t){let r=g.IntervalIntersectsRay(t.start,t.End,e.Start,e.Direction);r&&this.EnqueueEvent(new tO(e,r,t.EndVertex))}TryIntersectionOfConeLeftSideAndObstacleSide(e,t){let r=g.IntervalIntersectsRay(t.Start,t.End,e.Start,e.Direction);r&&this.EnqueueEvent(new tO(e,r,t.EndVertex))}ExtendSegmentToZ(e){let t=e.Direction.dot(this.SweepDirection),r=(this.Z+40-e.Start.dot(this.SweepDirection))/t;return b.mkPP(e.Start,e.Start.add(e.Direction.mul(r)))}GoOverConesSeeingVertexEvent(e){let t=this.FindFirstSegmentInTheRightTreeNotToTheLeftOfVertex(e);if(null==t)return;let r=t.item.Cone,i=r.LeftSide;if(tG.VertexIsToTheLeftOfSegment(e,i))return;let n=[r];if(this.coneSideComparer.SetOperand(i),null==(t=this.leftConeSides.find(i))){let e=this.Z;this.Z=Math.max(this.GetZP(i.Start),this.PreviousZ),this.coneSideComparer.SetOperand(i),t=this.leftConeSides.find(i),this.Z=e}if(null!=t||null!=(t=this.GetRbNodeEmergency(i))){for(t=this.leftConeSides.next(t);null!=t&&!tG.VertexIsToTheLeftOfSegment(e,t.item);)n.push(t.item.Cone),t=this.leftConeSides.next(t);for(let t of n)this.AddEdgeAndRemoveCone(t,e.Site)}}GetRbNodeEmergency(e){if(0===this.leftConeSides.count)return null;for(let t=this.leftConeSides.treeMinimum();null!=t;t=this.leftConeSides.next(t))if(t.item===e)return t;return null}static VertexIsToTheLeftOfSegment(e,t){return g.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.Site)===eo.Counterclockwise}static VertexIsToTheRightOfSegment(e,t){return g.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.Site)===eo.Clockwise}FindFirstSegmentInTheRightTreeNotToTheLeftOfVertex(e){return this.rightConeSides.findFirst(t=>!tG.VertexIsToTheRightOfSegment(e,t))}EnqueueRightVertexEvent(e){if(!(this.GetZP(e.Site.sub(e.Vertex.prevOnPolyline.point))>l.tolerance))this.EnqueueEvent(e)}invariant(){for(let e of this.leftConeSides)if(e.Removed)return!1;for(let e of this.rightConeSides)if(e.Removed)return!1;return!0}}class tU extends e0{constructor(e,t){super(null),this.coneAngle=Math.PI/6,this.ports=new eN,this._obstacles=Array.from(tT.OrientHolesClockwise(e)),this._visibilityGraph=t}static mk(e,t,r,i,n){let s=new tU(e,t);return s.Ports=i,s.BorderPolyline=n,s.ConeAngle=r,s}get ConeAngle(){return this.coneAngle}set ConeAngle(e){this.coneAngle=e}get Ports(){return this.ports}set Ports(e){this.ports=e}get BorderPolyline(){return this.borderPolyline}set BorderPolyline(e){this.borderPolyline=e}get Bidirectional(){return this._bidirectional}set Bidirectional(e){this._bidirectional=e}static GetTotalSteps(e){return Math.floor((2*Math.PI-e/2)/e)+1}run(){let e=2*Math.PI-this.coneAngle/2;if(this.Bidirectional)this.HandleBideractionalCase();else{let t;for(let r=0;(t=this.coneAngle*r)<=e;r++)super.ProgressStep(),this.AddDirection(new g(Math.cos(t),Math.sin(t)),this.BorderPolyline,this._visibilityGraph)}}HandleBideractionalCase(){let e=Math.PI/this.coneAngle;for(let t=0;t<e;t++){let e=t*this.coneAngle,r=new tT;this.AddDirection(new g(Math.cos(e),Math.sin(e)),this.BorderPolyline,r);let i=new tT;this.AddDirection(new g(-1*Math.cos(e),-1*Math.sin(e)),this.BorderPolyline,i),this.AddIntersectionOfBothDirectionSweepsToTheResult(r,i)}}AddIntersectionOfBothDirectionSweepsToTheResult(e,t){for(let r of e.Edges)null!=t.FindEdgePP(r.SourcePoint,r.TargetPoint)&&this._visibilityGraph.AddEdgePP(r.SourcePoint,r.TargetPoint)}AddDirection(e,t,r){tG.Sweep(this._obstacles,e,this.coneAngle,r,this.Ports,t)}}class tz extends to{mk(e,t){let r=new tz(e);return r.HookSize=t,r}constructor(e){super(),this.adjustmentAngle=Math.PI/10,this.hookSize=9,this.curve=e,this.location=this.curve().start}get Location(){return this.location}get Curve(){return this.curve()}SetLocation(e){this.location=e}get AdjustmentAngle(){return this.adjustmentAngle}set AdjustmentAngle(e){this.adjustmentAngle=e}get HookSize(){return this.hookSize}set HookSize(e){this.hookSize=e}}class tj extends tl{get LoosePolyline(){return this.loosePolyline}set LoosePolyline(e){this.loosePolyline=e}constructor(e,t,r=new g(0,0)){super(e,t,r)}static mk(e,t){return new tj(e,t)}}class tH extends to{get Location(){return this.curve.value(this.parameter)}set Location(e){throw Error("Method should not be called.")}static mk(e,t){let r=new tH;return r.curve=e,r.parameter=t,r}get Parameter(){return this.parameter}set Parameter(e){this.parameter=e}get Curve(){return this.curve}set Curve(e){this.curve=e}}class tW{constructor(){this.capacityOverflowCoefficient=tW.DefaultCapacityOverflowCoefficientMultiplier,this.RotateBundles=!1,this.MaxHubRadius=50,this.MinHubRadius=.1,this.CreateUnderlyingPolyline=!1,this.pathLengthImportance=tW.DefaultPathLengthImportance,this.inkImportance=tW.DefaultInkImportance,this.edgeSeparation=tW.DefaultEdgeSeparation,this._edgeWidthShrinkCoeff=1,this.useCubicBezierSegmentsInsideOfHubs=!1,this.angleThreshold=Math.PI/180*45,this.hubRepulsionImportance=100,this.bundleRepulsionImportance=100,this.minimalRatioOfGoodCdtEdges=.9,this.highestQuality=!0,this.KeepOverlaps=!1,this.StopAfterShortestPaths=!1}toJSON(){let e={};return this.capacityOverflowCoefficient!=tW.DefaultCapacityOverflowCoefficientMultiplier&&(e.capacityOverflowCoefficient=this.capacityOverflowCoefficient),this.RotateBundles&&(e.RotateBundles=this.RotateBundles),50!=this.MaxHubRadius&&(e.MaxHubRadius=this.MaxHubRadius),.1!=this.MinHubRadius&&(e.MinHubRadius=this.MinHubRadius),this.CreateUnderlyingPolyline&&(e.CreateUnderlyingPolyline=this.CreateUnderlyingPolyline),this.pathLengthImportance!=tW.DefaultPathLengthImportance&&(e.pathLengthImportance=this.pathLengthImportance),this.inkImportance!=tW.DefaultInkImportance&&(e.inkImportance=this.inkImportance),this.edgeSeparation!=tW.DefaultEdgeSeparation&&(e.edgeSeparation=this.edgeSeparation),1!=this._edgeWidthShrinkCoeff&&(e._edgeWidthShrinkCoeff=this._edgeWidthShrinkCoeff),this.useCubicBezierSegmentsInsideOfHubs&&(e.useCubicBezierSegmentsInsideOfHubs=this.useCubicBezierSegmentsInsideOfHubs),this.angleThreshold!=Math.PI/180*45&&(e.angleThreshold=this.angleThreshold),100!=this.hubRepulsionImportance&&(e.hubRepulsionImportance=this.hubRepulsionImportance),100!=this.bundleRepulsionImportance&&(e.bundleRepulsionImportance=this.bundleRepulsionImportance),.9!=this.minimalRatioOfGoodCdtEdges&&(e.minimalRatioOfGoodCdtEdges=this.minimalRatioOfGoodCdtEdges),!this.highestQuality&&(e.highestQuality=this.highestQuality),this.KeepOverlaps&&(e.KeepOverlaps=this.KeepOverlaps),this.StopAfterShortestPaths&&(e.StopAfterShortestPaths=this.StopAfterShortestPaths),e}static createFromJSON(e){let t=new tW;return e.capacityOverflowCoefficient&&(t.capacityOverflowCoefficient=e.capacityOverflowCoefficient),e.RotateBundles&&(t.RotateBundles=e.RotateBundles),e.MaxHubRadius&&(t.MaxHubRadius=e.MaxHubRadius),e.MinHubRadius&&(t.MinHubRadius=e.MinHubRadius),e.CreateUnderlyingPolyline&&(t.CreateUnderlyingPolyline=e.CreateUnderlyingPolyline),e.pathLengthImportance&&(t.pathLengthImportance=e.pathLengthImportance),e.inkImportance&&(t.inkImportance=e.inkImportance),e.edgeSeparation&&(t.edgeSeparation=e.edgeSeparation),e._edgeWidthShrinkCoeff&&(t._edgeWidthShrinkCoeff=e._edgeWidthShrinkCoeff),e.useCubicBezierSegmentsInsideOfHubs&&(t.useCubicBezierSegmentsInsideOfHubs=e.useCubicBezierSegmentsInsideOfHubs),e.angleThreshold&&(t.angleThreshold=e.angleThreshold),e.hubRepulsionImportance&&(t.hubRepulsionImportance=e.hubRepulsionImportance),e.bundleRepulsionImportance&&(t.bundleRepulsionImportance=e.bundleRepulsionImportance),e.minimalRatioOfGoodCdtEdges&&(t.minimalRatioOfGoodCdtEdges=e.minimalRatioOfGoodCdtEdges),e.highestQuality&&(t.HighestQuality=e.highestQuality),e.KeepOverlaps&&(t.KeepOverlaps=e.KeepOverlaps),e.StopAfterShortestPaths&&(t.StopAfterShortestPaths=e.StopAfterShortestPaths),t}get CapacityOverflowCoefficient(){return this.capacityOverflowCoefficient}set CapacityOverflowCoefficient(e){this.capacityOverflowCoefficient=e}get PathLengthImportance(){return this.pathLengthImportance}set PathLengthImportance(e){this.pathLengthImportance=e}get InkImportance(){return this.inkImportance}set InkImportance(e){this.inkImportance=e}get EdgeSeparation(){return this.edgeSeparation}set EdgeSeparation(e){this.edgeSeparation=e}get edgeWidthShrinkCoeff(){return this._edgeWidthShrinkCoeff}set edgeWidthShrinkCoeff(e){this._edgeWidthShrinkCoeff=e}ActualEdgeWidth(e,t=this.edgeWidthShrinkCoeff){return t*(this.edgeSeparation+e.lineWidth)}get UseCubicBezierSegmentsInsideOfHubs(){return this.useCubicBezierSegmentsInsideOfHubs}set UseCubicBezierSegmentsInsideOfHubs(e){this.useCubicBezierSegmentsInsideOfHubs=e}get AngleThreshold(){return this.angleThreshold}set AngleThreshold(e){this.angleThreshold=e}get HubRepulsionImportance(){return this.hubRepulsionImportance}set HubRepulsionImportance(e){this.hubRepulsionImportance=e}get BundleRepulsionImportance(){return this.bundleRepulsionImportance}set BundleRepulsionImportance(e){this.bundleRepulsionImportance=e}get MinimalRatioOfGoodCdtEdges(){return this.minimalRatioOfGoodCdtEdges}set MinimalRatioOfGoodCdtEdges(e){this.minimalRatioOfGoodCdtEdges=e}get HighestQuality(){return this.highestQuality}set HighestQuality(e){this.highestQuality=e}}tW.DefaultCapacityOverflowCoefficientMultiplier=1e3,tW.DefaultPathLengthImportance=500,tW.DefaultInkImportance=.01,tW.DefaultEdgeSeparation=.5;class tq extends ts{get BoundaryCurve(){return this.node.boundaryCurve}set BoundaryCurve(e){if(e)throw Error("Cannot set BoundaryCurve directly for RelativeShape")}constructor(e){super(null),this.node=e}}class tX{static GetShapes(e,t){let r=new Map;for(let t of e)tX.ProcessAncestorDescendantCouple(t.target,t.source,r),tX.InsertEdgePortsToShapes(r,t);for(let e of t)tX.ProcessAncestorDescendantCouple(e.source,e.target,r),tX.InsertEdgePortsToShapes(r,e);return tX.BindShapes(r),Array.from(r.values())}static InsertEdgePortsToShapes(e,t){e.get(t.target).Ports.add(t.targetPort),e.get(t.source).Ports.add(t.sourcePort)}static BindShapes(e){for(let[t,r]of e){if(t instanceof ti)for(let i of tY(t)){let t=e.get(i);t&&r.AddChild(t)}}}static ProcessAncestorDescendantCouple(e,t,r){let i=t$(t);for(;;){for(let e of tY(i))tX.CreateShapeIfNeeeded(e,r);if(i===e)break;i=t$(i)}tX.CreateShapeIfNeeeded(i,r)}static CreateShapeIfNeeeded(e,t){if(!t.has(e))t.set(e,new tq(e))}static NumberOfActiveNodesIsUnderThreshold(e,t,r){let i=new Set;for(let t of e)if(tX.SetOfActiveNodesIsLargerThanThreshold(t.target,t.source,i,r))return!1;for(let e of t)if(tX.SetOfActiveNodesIsLargerThanThreshold(e.source,e.target,i,r))return!1;return!0}static SetOfActiveNodesIsLargerThanThreshold(e,t,r,i){let n=t$(t);for(;;){for(let e of tY(n))if(r.add(e),r.size>i)return!0;if(n===e)break;n=t$(n)}return r.add(n),r.size>i}}function t$(e){let t=e.node.parent;return o.getGeom(t)}function*tY(e){for(let t of e.graph.shallowNodes)yield o.getGeom(t)}class tZ{constructor(e){this.stamp=0,this.SetPivotAndAllocateHullPointsArray(e)}SetPivotAndAllocateHullPointsArray(e){this.pivot=new g(0,Number.MAX_SAFE_INTEGER);let t=-1,r=0;for(let i of e)i.y<this.pivot.y?(this.pivot=i,t=r):i.y===this.pivot.y&&i.x>this.pivot.x&&(this.pivot=i,t=r),r++;if(r>=1)for(let i of(this.hullPoints=Array(r-1),r=0,e))r!==t?this.hullPoints[r++]={point:i,deleted:!1,stamp:this.stamp++}:t=-1}get StackTopPoint(){return this.stack.point}get StackSecondPoint(){return this.stack.next.point}static*CalculateConvexHull(e){for(let t of new tZ(e).Calculate())yield t}*Calculate(){if(this.pivot.y!==Number.MAX_SAFE_INTEGER){if(0===this.hullPoints.length){yield this.pivot;return}for(let e of(this.SortAllPointsWithoutPivot(),this.Scan(),this.EnumerateStack()))yield e}}*EnumerateStack(){let e=this.stack;for(;null!=e;)yield e.point,e=e.next}Scan(){let e=0;for(;this.hullPoints[e].deleted;)e++;for(this.stack={point:this.pivot,next:null},this.Push(e++),e<this.hullPoints.length&&(this.hullPoints[e].deleted?e++:this.Push(e++));e<this.hullPoints.length;)this.hullPoints[e].deleted?e++:this.LeftTurn(e)?this.Push(e++):this.Pop();for(;this.StackHasMoreThanTwoPoints()&&!this.LeftTurnToPivot();)this.Pop()}LeftTurnToPivot(){return g.getTriangleOrientation(this.StackSecondPoint,this.StackTopPoint,this.pivot)===eo.Counterclockwise}StackHasMoreThanTwoPoints(){return null!=this.stack.next&&null!=this.stack.next.next}Pop(){this.stack=this.stack.next}LeftTurn(e){if(null==this.stack.next)return!0;let t=g.getTriangleOrientationWithIntersectionEpsilon(this.StackSecondPoint,this.StackTopPoint,this.hullPoints[e].point);return t===eo.Counterclockwise||t!==eo.Clockwise&&this.BackSwitchOverPivot(this.hullPoints[e].point)}BackSwitchOverPivot(e){return null==this.stack.next.next&&this.StackTopPoint.x>this.pivot.x+l.distanceEpsilon&&e.x<this.pivot.x-l.distanceEpsilon}Push(e){this.stack={point:this.hullPoints[e].point,next:this.stack}}SortAllPointsWithoutPivot(){this.hullPoints.sort(function(e){return(t,r)=>{if(t===r)return 0;if(null==t)return -1;if(null==r)return 1;switch(g.getTriangleOrientationWithIntersectionEpsilon(e,t.point,r.point)){case eo.Counterclockwise:return -1;case eo.Clockwise:return 1;case eo.Collinear:let i=t.point.x-e.x,n=r.point.x-e.x;if(i>l.distanceEpsilon&&n<-l.distanceEpsilon)return -1;if(i<-l.distanceEpsilon&&n>l.distanceEpsilon)return 1;let s=t.point.sub(e),o=r.point.sub(e),a=s.l1-o.l1;if(a<0)return t.deleted=!0,-1;if(a>0)return r.deleted=!0,1;return t.stamp>r.stamp?t.deleted=!0:r.deleted=!0,0}throw Error()}}(this.pivot))}static createConvexHullAsClosedPolyline(e){return A.mkClosedFromPoints(Array.from(tZ.CalculateConvexHull(e)))}}function tK(e,t,r){e.irect.intersects_rect(t.irect)&&(null==e.Left?null==t.Left?r(e.UserData,t.UserData):(tK(e,t.Left,r),tK(e,t.Right,r)):null!=t.Left?(tK(e.Left,t.Left,r),tK(e.Left,t.Right,r),tK(e.Right,t.Left,r),tK(e.Right,t.Right,r)):(tK(e.Left,t,r),tK(e.Right,t,r)))}function tJ(e,t,r){e.irect.intersects_rect(t.irect)&&(e===t?function(e,t){null!=e.Left&&(tJ(e.Left,e.Left,t),tJ(e.Left,e.Right,t),tJ(e.Right,e.Right,t))}(e,r):null==e.Left?null==t.Left?r(e.UserData,t.UserData):(tJ(e,t.Left,r),tJ(e,t.Right,r)):null!=t.Left?(tJ(e.Left,t.Left,r),tJ(e.Left,t.Right,r),tJ(e.Right,t.Left,r),tJ(e.Right,t.Right,r)):(tJ(e.Left,t,r),tJ(e.Right,t,r)))}function tQ(e,t,r){if(!e.irect.intersects_rect(t.irect))return!1;if(e===t)return function(e,t){return null!=e.Left&&(tQ(e.Left,e.Left,t)||tQ(e.Left,e.Right,t)||tQ(e.Right,e.Right,t))}(e,r);if(null==e.Left){if(null==t.Left)return r(e.UserData,t.UserData);if(tQ(e,t.Left,r)||tQ(e,t.Right,r))return!0}else if(null!=t.Left){if(tQ(e.Left,t.Left,r)||tQ(e.Left,t.Right,r)||tQ(e.Right,t.Left,r)||tQ(e.Right,t.Right,r))return!0}else if(tQ(e.Left,t,r)||tQ(e.Right,t,r))return!0;return!1}let t1=BigInt("6364136223846793005"),t0=(BigInt(1)<<BigInt(32))-BigInt(1),t2=(BigInt(1)<<BigInt(64))-BigInt(1);class t3{constructor(e,t){this._state=BigInt(0),this._inc=(BigInt(t)<<BigInt(1)|BigInt(1))&t2,this._random_b(),this._state=this._state+BigInt(e)&t2,this._random_b()}_random_b(){let e=this._state;this._state=e*t1+this._inc&t2;let t=(e>>BigInt(18)^e)>>BigInt(27),r=e>>BigInt(59),i=r^BigInt(31);return(t>>r|t<<i)&t0}_advance(e){e&=t2;let t=BigInt(1),r=t1,i=BigInt(0),n=this._inc;for(;e>0;)e&BigInt(1)&&(t=t*r&t2,i=i*r+n&t2),n=(r+BigInt(1))*n&t2,r=r*r&t2,e>>=BigInt(1);this._state=t*this._state+i&t2}randint(e){if(e>t0)throw TypeError(`Bound too large: ${e}`);if(e<=0)throw TypeError(`Empty sample space for r: 0  r < ${e}`);let t=BigInt(e),r=(t0^t)%t;for(;;){let e=this._random_b();if(e>=r)return Number(e%t)}}random(){return Number(this._random_b())/0x100000000}}function t5(e){return null==i&&(i=new t3(0,0)),i.randint(e)}function t6(e){i=new t3(e,0)}function t4(){return null==i&&(i=new t3(0,0)),i.random()}function*t9(e){let t=Array(e.nodeCount).fill(!1),r=new eq.Queue;for(let i=0;i<e.nodeCount;i++)if(!t[i]){let n=[];for(t8(i,r,t);r.length>0;){let i=r.dequeue();for(let s of(n.push(i),function*(e,t){for(let r of e.outEdges[t])yield r.target;for(let r of e.inEdges[t])yield r.source}(e,i)))t8(s,r,t)}yield n}}function t8(e,t,r){!1===r[e]&&(t.enqueue(e),r[e]=!0)}function t7(e){let t=new rr;return t.SetEdges(e,rr.vertexCount(e)),t}function re(e){let t=new rr;return t.SetEdges(e,rr.vertexCount(e)),t}function rt(e,t){let r=new rr;return r.SetEdges(e,t),r}class rr{constructor(){this.nodeCount=0}*incidentEdges(e){for(let t of this.outEdges[e])yield t;for(let t of this.inEdges[e])yield t}static deleteFromArray(e,t){let r=e.indexOf(t,0);r>-1&&e.splice(r,1)}removeEdge(e){rr.deleteFromArray(this.edges,e),e.source!==e.target?(rr.deleteFromArray(this.outEdges[e.source],e),rr.deleteFromArray(this.inEdges[e.target],e)):rr.deleteFromArray(this.selfEdges[e.source],e)}static vertexCount(e){let t=0;for(let r of e)r.source>=t&&(t=r.source),r.target>=t&&(t=r.target);return++t}SetEdges(e,t){this.edges=e,this.nodeCount=t;let r=Array(this.nodeCount).fill(0),i=Array(this.nodeCount).fill(0),n=Array(this.nodeCount).fill(0);for(let e of(this.outEdges=Array(this.nodeCount),this.inEdges=Array(this.nodeCount),this.selfEdges=Array(this.nodeCount),this.edges))e.source!==e.target?(r[e.source]++,i[e.target]++):n[e.source]++;for(let e=0;e<this.nodeCount;e++)this.outEdges[e]=Array(r[e]),r[e]=0,this.inEdges[e]=Array(i[e]),i[e]=0,this.selfEdges[e]=Array(n[e]),n[e]=0;for(let e of this.edges){let t=e.source,s=e.target;t!==s?(this.outEdges[t][r[t]++]=e,this.inEdges[s][i[s]++]=e):this.selfEdges[t][n[t]++]=e}}inEdgesCount(e){return this.inEdges[e].length}outEdgesCount(e){return this.outEdges[e].length}selfEdgesCount(e){return this.selfEdges[e].length}addEdge(e){this.edges.push(e),e.source!==e.target?(this.outEdges[e.source].push(e),this.inEdges[e.target].push(e)):this.selfEdges[e.source].push(e)}*nodesOfConnectedGraph(){if(0===this.edges.length)return;let e=new Set,t=new eq.Queue,r=this.edges[0].source;for(rr.enqueue(e,t,r),yield r;t.length>0;){for(let i of(r=t.dequeue(),this.outEdges[r])){let r=i.target;!e.has(r)&&(rr.enqueue(e,t,r),yield r)}for(let i of this.inEdges[r]){let r=i.source;!e.has(r)&&(rr.enqueue(e,t,r),yield r)}}}*pred(e){for(let t of this.inEdges[e])yield t.source}*succ(e){for(let t of this.outEdges[e])yield t.target}static enqueue(e,t,r){t.enqueue(r),e.add(r)}}class ri{constructor(e,t){this.x=e,this.y=t}get source(){return this.x}get target(){return this.y}isDiagonal(){return this.x===this.y}}(j=ef||(ef={}))[j.Increasing=0]="Increasing",j[j.Decreasing=1]="Decreasing",j[j.Extremum=2]="Extremum";class rn{get Sequence(){return this.f}set Sequence(e){this.f=e}get Length(){return this.length}set Length(e){this.length=e}constructor(e,t){this.f=e,this.length=t}FindMinimum(){let e=0,t=this.length-1,r=e+Math.floor((t-e)/2),i=this.f(r);if(i>=this.f(0)&&i>=this.f(this.length-1))return this.f(0)<this.f(this.length-1)?0:this.length-1;for(;t-e>1;)switch(r=e+Math.floor((t-e)/2),this.BehaviourAtIndex(r)){case ef.Decreasing:e=r;break;case ef.Increasing:t=r;break;case ef.Extremum:return r}return e===t?e:this.f(e)<=this.f(t)?e:t}BehaviourAtIndex(e){let t=this.f(e);if(0===e){let e=this.f(1);return e===t?ef.Extremum:e>t?ef.Increasing:ef.Decreasing}if(e===this.length-1){let e=this.f(this.length-2);return e===t?ef.Extremum:e>t?ef.Decreasing:ef.Increasing}let r=t-this.f(e-1);return r*(this.f(e+1)-t)<=0?ef.Extremum:r>0?ef.Increasing:ef.Decreasing}FindMaximum(){let e=0,t=this.length-1,r=e+Math.floor((t-e)/2),i=this.f(r);if(i<=this.f(0)&&i<=this.f(this.length-1))return this.f(0)>this.f(this.length-1)?0:this.length-1;for(;t-e>1;)switch(r=e+Math.floor((t-e)/2),this.BehaviourAtIndex(r)){case ef.Decreasing:t=r;break;case ef.Increasing:e=r;break;case ef.Extremum:return r}return e===t?e:this.f(e)>=this.f(t)?e:t}}class rs{toArray(){let e=[];for(let t=0;t<this.length;t++)e.push(this.f(t));return e}constructor(e,t){this.f=e,this.length=t}GetAdjustedSequenceForMinimum(){let e=this.f(0),t=(this.f(this.length-1)-e)/(this.length-1);return r=>Math.min(this.f(r),e+t*r)}GetAdjustedSequenceForMaximum(){let e=this.f(0),t=(this.f(this.length-1)-e)/(this.length-1);return r=>Math.max(this.f(r),e+t*r)}FindMinimum(){return this.f(0)===this.f(this.length-1)?new rn(this.f,this.length).FindMinimum():new rn(this.GetAdjustedSequenceForMinimum(),this.length).FindMinimum()}FindMaximum(){return this.f(0)===this.f(this.length-1)?new rn(this.f,this.length).FindMaximum():new rn(this.GetAdjustedSequenceForMaximum(),this.length).FindMaximum()}}class ro{constructor(e,t){this.P=e,this.Q=t}LeftFromLineOnP(e,t,r){let i=this.P.pnt(e);return this.upperBranchOnP?g.pointToTheLeftOfLineOrOnLine(r,i,t):g.pointToTheRightOfLineOrOnLine(r,i,t)}LeftFromLineOnQ(e,t,r){let i=this.Q.pnt(e);return this.lowerBranchOnQ?g.pointToTheLeftOfLineOrOnLine(r,i,t):g.pointToTheRightOfLineOrOnLine(r,i,t)}PrevOnP(e){return this.upperBranchOnP?this.P.Prev(e):this.P.Next(e)}PrevOnQ(e){return this.lowerBranchOnQ?this.Q.Prev(e):this.Q.Next(e)}NextOnP(e){return this.upperBranchOnP?this.P.Next(e):this.P.Prev(e)}NextOnQ(e){return this.lowerBranchOnQ?this.Q.Next(e):this.Q.Prev(e)}MedianOnP(e,t){return this.upperBranchOnP?this.P.Median(e,t):this.P.Median(t,e)}MedianOnQ(e,t){return this.lowerBranchOnQ?this.Q.Median(e,t):this.Q.Median(t,e)}ModuleP(e,t){return this.upperBranchOnP?this.P.Module(t-e):this.P.Module(e-t)}ModuleQ(e,t){return this.lowerBranchOnQ?this.Q.Module(t-e):this.Q.Module(e-t)}TangentBetweenBranches(e,t,r,i){for(;t!==e||i!==r;){let n=t!==e?this.MedianOnP(e,t):e,s=i!==r?this.MedianOnQ(r,i):r,o=this.P.pnt(n),a=this.Q.pnt(s),l=!0;this.ModuleP(e,t)>1?this.LeftFromLineOnP(this.NextOnP(n),o,a)?e=n:this.LeftFromLineOnP(this.PrevOnP(n),o,a)?t=n:l=!1:t!==e?this.LeftFromLineOnP(t,this.P.pnt(e),a)?e=t:this.LeftFromLineOnP(e,this.P.pnt(t),a)?t=e:l=!1:l=!1;let h=!0;this.ModuleQ(r,i)>1?this.LeftFromLineOnQ(this.NextOnQ(s),a,o)?r=s:this.LeftFromLineOnQ(this.PrevOnQ(s),a,o)?i=s:h=!1:i!==r?this.LeftFromLineOnQ(i,this.Q.pnt(r),o)?r=i:this.LeftFromLineOnQ(r,this.Q.pnt(i),o)?i=r:h=!1:h=!1,!l&&!h&&(e=n,t=n,r=s,i=s)}return[e,i]}FindDividingBisector(e){let t={pClosest:void 0,qClosest:void 0,p1:void 0,p2:void 0,q1:void 0,q2:void 0};this.FindClosestFeatures(t),e.bisectorPivot=g.middle(t.pClosest,t.qClosest),e.bisectorRay=t.pClosest.sub(t.qClosest).rotate(Math.PI/2),e.p1=t.p1,e.p2=t.p2,e.q1=t.q1,e.q2=t.q2}FindClosestPoints(){let e={q2:void 0,p1:void 0,p2:void 0,q1:void 0,pClosest:void 0,qClosest:void 0};return this.FindClosestFeatures(e),{pClosest:e.pClosest,qClosest:e.qClosest}}FindClosestFeatures(e){let t={leftTangentPoint:void 0,rightTangentPoint:void 0};this.P.GetTangentPoints(t,this.Q.pp(0).point),e.p2=t.leftTangentPoint,e.p1=t.rightTangentPoint,e.p2===e.p1&&(e.p2+=this.P.count),this.Q.GetTangentPoints(t,this.P.pp(0).point),e.q1=t.leftTangentPoint,e.q2=t.rightTangentPoint,e.q2===e.q1&&(e.q2+=this.Q.count),this.FindClosestPoints_(e)}FindClosestPoints_(e){for(;this.ChunksAreLong(e.p2,e.p1,e.q2,e.q1);)this.ShrinkChunks(e);e.p1===e.p2?(e.pClosest=this.P.pp(e.p2).point,e.q1===e.q2?e.qClosest=this.Q.pp(e.q1).point:(e.qClosest=g.ClosestPointAtLineSegment(e.pClosest,this.Q.pp(e.q1).point,this.Q.pp(e.q2).point),g.closeDistEps(e.qClosest,this.Q.pnt(e.q1))?e.q2=e.q1:g.closeDistEps(e.qClosest,this.Q.pnt(e.q2))&&(e.q1=e.q2))):(e.qClosest=this.Q.pp(e.q1).point,e.pClosest=g.ClosestPointAtLineSegment(e.qClosest,this.P.pp(e.p1).point,this.P.pp(e.p2).point),g.closeDistEps(e.pClosest,this.P.pnt(e.p1))?e.p2=e.p1:g.closeDistEps(e.qClosest,this.P.pnt(e.p2))&&(e.p1=e.p2))}ChunksAreLong(e,t,r,i){let n=this.P.Module(e-t)+1;if(n>2)return!0;let s=this.Q.Module(i-r)+1;return!!(s>2)||2===n&&2===s||!1}ShrinkChunks(e){let t=e.p1===e.p2?e.p1:this.P.Median(e.p1,e.p2),r=e.q1===e.q2?e.q1:this.Q.Median(e.q2,e.q1),i=this.P.pp(t).point,n=this.Q.pp(r).point,s={a1:void 0,a2:void 0,b1:void 0,b2:void 0};if(this.GetAnglesAtTheMedian(t,r,i,n,s),!(this.InternalCut(e,t,r,s.a1,s.a2,s.b1,s.b2)||ro.OneOfChunksContainsOnlyOneVertex(e,t,r,s.a1,s.b1))){if(!this.OnlyOneChunkContainsExactlyTwoVertices(e,{mp:t,mq:r},s)){if(e.p2===this.P.Next(e.p1)&&e.q1===this.Q.Next(e.q2)){let t=b.minDistBetweenLineSegments(this.P.pnt(e.p1),this.P.pnt(e.p2),this.Q.pnt(e.q1),this.Q.pnt(e.q2));0===t.parab?e.p2=e.p1:1===t.parab?e.p1=e.p2:0===t.parcd?e.q2=e.q1:1===t.parcd&&(e.q1=e.q2);return}s.a1<=Math.PI&&s.a2<=Math.PI&&s.b1<=Math.PI&&s.b2<=Math.PI?s.a1+s.b1>Math.PI?s.a1>=Math.PI/2?e.p1=t:e.q1=r:s.a2>=Math.PI/2?e.p2=t:e.q2=r:s.a1>Math.PI?e.p1=t:s.a2>Math.PI?e.p2=t:s.b1>Math.PI?e.q1=r:e.q2=r}}}InternalCut(e,t,r,i,n,s,o){let a=!1;if(i>=Math.PI&&n>=Math.PI){let i=this.P.pp(t).point,n=this.Q.pp(r).point,s=this.P.pp(this.P.Next(t)).point,o=g.getTriangleOrientation(i,n,this.Q.pp(0).point);o===g.getTriangleOrientation(i,n,s)?e.p1=this.P.Next(t):e.p2=this.P.Prev(t),a=!0}if(s>=Math.PI&&o>=Math.PI){let i=this.P.pp(t).point,n=this.Q.pp(r).point,s=this.Q.pp(this.Q.Next(r)).point,o=g.getTriangleOrientation(i,n,this.P.pp(0).point);o===g.getTriangleOrientation(i,n,s)?e.q2=this.Q.Next(r):e.q1=this.Q.Prev(r),a=!0}return a}GetAnglesAtTheMedian(e,t,r,i,n){n.a1=g.anglePCP(i,r,this.P.pnt(this.P.Prev(e))),n.a2=g.anglePCP(this.P.pnt(this.P.Next(e)),r,i),n.b1=g.anglePCP(this.Q.pnt(this.Q.Next(t)),i,r),n.b2=g.anglePCP(r,i,this.Q.pnt(this.Q.Prev(t)))}OnlyOneChunkContainsExactlyTwoVertices(e,t,r){let i=e.p2===this.P.Next(e.p1),n=e.q1===this.Q.Next(e.q2);return i&&!n?(this.ProcessShortSide(e,t.mp,t.mq,r.a1,r.b1,r.a2,r.b2),!0):!!n&&!i&&(this.SwapEverything(e,t,r),this.ProcessShortSide(e,t.mp,t.mq,r.a1,r.b1,r.a2,r.b2),this.SwapEverything(e,t,r),!0)}SwapEverything(e,t,r){this.SwapPq();let i=e.p2;e.p2=e.q1,e.q1=i,i=e.q2,e.q2=e.p1,e.p1=i,i=t.mq,t.mq=t.mp,t.mp=i,i=r.a2,r.a2=r.b1,r.b1=i,i=r.b2,r.b2=r.a1,r.a1=i}ProcessShortSide(e,t,r,i,n,s,o){t===e.p2?this.ProcessSide(e,r,i,n,o):s<=Math.PI?s+o>=Math.PI?s>=Math.PI/2?e.p2=e.p1:e.q2=r:n>=Math.PI/2?e.q1=r:s<o&&(g.canProject(this.Q.pnt(r),this.P.pp(e.p1).point,this.P.pp(e.p2).point)?e.q1=r:e.p1=e.p2):i+n<=Math.PI?e.p1=e.p2:e.p2=e.p1}SwapPq(){let e=this.P;this.P=this.Q,this.Q=e}ProcessSide(e,t,r,i,n){let s=this.Q.pnt(t);r<=Math.PI?r+i>=Math.PI?r>=Math.PI/2?e.p1=e.p2:e.q1=t:n>=Math.PI/2?e.q2=t:r<n&&(g.canProject(s,this.P.pp(e.p1).point,this.P.pp(e.p2).point)?e.q2=t:e.p2=e.p1):(e.p2=e.p1,i>=Math.PI?e.q1=t:n>=Math.PI&&(e.q2=t))}static OneOfChunksContainsOnlyOneVertex(e,t,r,i,n){return e.p1===e.p2?(n>=Math.PI/2?e.q1=r:e.q2=r,!0):e.q1===e.q2&&(i>=Math.PI/2?e.p1=t:e.p2=t,!0)}CalculateLeftTangents(){let e={bisectorPivot:null,bisectorRay:null,p1:0,p2:0,q1:0,q2:0};this.FindDividingBisector(e);let t=this.P.FindTheFurthestVertexFromBisector(e.p1,e.p2,e.bisectorPivot,e.bisectorRay),r=this.Q.FindTheFurthestVertexFromBisector(e.q2,e.q1,e.bisectorPivot,e.bisectorRay);this.upperBranchOnP=!1,this.lowerBranchOnQ=!0,this.leftPLeftQ=this.TangentBetweenBranches(t,e.p1,r,e.q1),this.lowerBranchOnQ=!1,this.leftPRightQ=this.TangentBetweenBranches(t,e.p1,r,e.q2)}CalculateRightTangents(){let e={bisectorPivot:null,bisectorRay:null,p1:0,p2:0,q1:0,q2:0};this.FindDividingBisector(e);let t=this.P.FindTheFurthestVertexFromBisector(e.p1,e.p2,e.bisectorPivot,e.bisectorRay),r=this.Q.FindTheFurthestVertexFromBisector(e.q2,e.q1,e.bisectorPivot,e.bisectorRay);this.upperBranchOnP=!0,this.lowerBranchOnQ=!0,this.rightPLeftQ=this.TangentBetweenBranches(t,e.p2,r,e.q1),this.lowerBranchOnQ=!1,this.rightPRightQ=this.TangentBetweenBranches(t,e.p2,r,e.q2)}}class ra{static mkFromPoints(e){return new ra(A.mkClosedFromPoints(e))}get Polyline(){return this.polyline}constructor(e){this.polyline=e,this.points=[];for(let e=this.polyline.startPoint;e;e=e.next)this.points.push(e)}Next(e){return this.Module(e+1)}Prev(e){return this.Module(e-1)}get count(){return this.Polyline.count}Module(e){return e<0?e+this.count:e<this.count?e:e-this.count}pp(e){return this.points[this.Module(e)]}pnt(e){return this.pp(e).point}toString(){return this.polyline.toString()}Median(e,t){return t>e?Math.floor((t+e)/2):this.Module(t+Math.floor((this.count+e)/2))}FindTheFurthestVertexFromBisector(e,t,r,i){let n=i.rotate(Math.PI/2);0>this.polyline.startPoint.point.sub(r).dot(n)&&(n=n.mul(-1)),e===t&&(t=this.Next(e));do{let r=this.Median(t,e),i=this.pnt(r);this.pnt(this.Next(r)).sub(i).dot(n)>=0?t=this.Next(r):this.pnt(this.Prev(r)).sub(i).dot(n)>=0?e=this.Prev(r):t=r,e=r}while(e!==t);return e}static TestPolygonDist(e,t){let r=Number.MAX_SAFE_INTEGER;for(let i=0;i<e.count;i++)for(let n=0;n<t.count;n++)r=Math.min(r,b.minDistBetweenLineSegments(e.pnt(i),e.pnt(i+1),t.pnt(n),t.pnt(n+1)).dist);return r}static Distance(e,t){let r=new ro(e,t).FindClosestPoints();return{p:r.pClosest,q:r.qClosest,dist:r.pClosest.sub(r.qClosest).length}}static DistanceOnly(e,t){return ra.Distance(e,t).dist}static PolygonIsLegalDebug(e){let t=e.Polyline;for(let e=t.startPoint;null!=e.next&&null!=e.next.next;e=e.next)if(g.getTriangleOrientation(e.point,e.next.point,e.next.next.point)===eo.Collinear)return!1;return!0}static DistancePoint(e,t){let r=Number.MAX_VALUE;for(let i=0;i<e.count;i++)r=Math.min(r,g.distToLineSegment(t,e.points[i].point,e.points[(i+1)%e.count].point).dist);return r}GetTangentPoints(e,t){let r=new rs(this.GetSequenceDelegate(t),this.count);e.leftTangentPoint=r.FindMaximum(),e.rightTangentPoint=r.FindMinimum()}GetSequenceDelegate(e){let t=this.pnt(0);return r=>{let i=g.anglePCP(t,e,this.pnt(r));return i<Math.PI?i:i-2*Math.PI}}}class rl{ObstaclesIntersectLine(e,t){return this.ObstaclesIntersectICurve(b.mkPP(e,t))}static PadCorner(e,t,r,i,n){let s=rl.GetPaddedCorner(t,r,i,n);return -1!==s.numberOfPoints&&(e.addPoint(s.a),2===s.numberOfPoints&&e.addPoint(s.b),!0)}static CurveIsClockwise(e,t){return g.getTriangleOrientation(t,e.start,e.start.add(e.derivative(e.parStart)))==eo.Clockwise}static PaddedPolylineBoundaryOfNode(e,t,r=!1){return rl.CreatePaddedPolyline(C.polylineAroundClosedCurve(e),t,r)}static LoosePolylineWithFewCorners(e,t,r){return t<l.distanceEpsilon?e:rl.CreateLoosePolylineOnBisectors(e,t,r)}static CreateLoosePolylineOnBisectors(e,t,r){let i=Array.from(rl.BisectorPoints(e,t));r&&function(){for(let e=0;e<i.length;e++){let t=i[e];i[e]=new g(t.x+(2*t4()-1)*r,t.y+(2*t4()-1)*r)}}();let n=tZ.CalculateConvexHull(i);return A.mkClosedFromPoints(n)}static CreateRectNodeOfPolyline(e){return eR(e,e.boundingBox)}CreateLooseObstacles(){for(let e of(this.tightPolylinesToLooseDistances=new Map,this.LooseObstacles=[],this.TightObstacles)){let t=rl.FindMaxPaddingForTightPolyline(this.RootOfTightHierarchy,e,this.LoosePadding);this.tightPolylinesToLooseDistances.set(e,t),this.LooseObstacles.push(rl.LoosePolylineWithFewCorners(e,t,this.randomizationShift))}this.RootOfLooseHierarchy=rl.CalculateHierarchy(this.LooseObstacles)}CreateTightObstacles(){this.RootOfTightHierarchy=this.CreateTightObstacles_(),this.OverlapsDetected=this.TightObstacles.size<this.Obstacles.length}Calculate(){this.IgnoreTightPadding?this.CreateTightObstaclesIgnoringTightPadding():this.CreateTightObstacles(),!this.IsEmpty()&&this.CreateLooseObstacles()}IsEmpty(){return null==this.TightObstacles||0===this.TightObstacles.size}constructor(e,t,r,i){this.randomizationShift=.01,this.TightObstacles=new Set,this.Obstacles=e,this.TightPadding=t,this.LoosePadding=r,this.IgnoreTightPadding=i}ObstaclesIntersectICurve(e){let t=e.boundingBox;return rl.CurveIntersectsRectangleNode(e,t,this.RootOfTightHierarchy)}static CurveIntersectsRectangleNode(e,t,r){if(!r.irect.intersects(t))return!1;if(null!=r.UserData){let t=r.UserData;return null!=C.intersectionOne(t,e,!1)||rl.PointIsInside(t.start,e)}return rl.CurveIntersectsRectangleNode(e,t,r.Left)||rl.CurveIntersectsRectangleNode(e,t,r.Right)}static PointIsInside(e,t){return C.PointRelativeToCurveLocation(e,t)===el.Inside}CreateTightObstaclesIgnoringTightPadding(){let e=this.Obstacles.map(e=>C.polylineAroundClosedCurve(e)),t=rl.CalculateHierarchy(e),r=rl.GetOverlappedPairSet(t);if(this.TightObstacles=new Set,0===r.size){for(let r of e){let e=rl.FindMaxPaddingForTightPolyline(t,r,this.TightPadding);this.TightObstacles.add(rl.LoosePolylineWithFewCorners(r,e,this.randomizationShift))}this.RootOfTightHierarchy=rl.CalculateHierarchy(Array.from(this.TightObstacles))}else{for(let t of e)this.TightObstacles.add(rl.CreatePaddedPolyline(t,this.TightPadding));if(!this.IsEmpty())for(this.RootOfTightHierarchy=rl.CalculateHierarchy(Array.from(this.TightObstacles)),this.OverlapsDetected=!1;rl.GetOverlappedPairSet(this.RootOfTightHierarchy).size>0;)this.RootOfTightHierarchy=rl.ReplaceTightObstaclesWithConvexHulls(this.TightObstacles,Array.from(r)),this.OverlapsDetected=!0}}CreateTightObstacles_(){if(0===this.Obstacles.length)return null;for(let e of this.Obstacles)rl.CalculateTightPolyline(this.TightObstacles,this.TightPadding,e);return rl.RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(this.TightObstacles)}static CalculateTightPolyline(e,t,r){let i=rl.PaddedPolylineBoundaryOfNode(r,t);e.add(i)}static CalculateHierarchy(e){return eC(e.map(e=>rl.CreateRectNodeOfPolyline(e)))}static RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(e,t=null){let r,i=rl.CalculateHierarchy(Array.from(e));for(;(r=rl.GetOverlappedPairSet(i)).size>0;)i=rl.ReplaceTightObstaclesWithConvexHulls(e,Array.from(r),t);return i}static MapToInt(e){let t=new Map;for(let r=0;r<e.length;r++)t.set(e[r],r);return t}static ReplaceTightObstaclesWithConvexHulls(e,t,r=null){let i=new Set;for(let e of t)i.add(e[0]),i.add(e[1]);let n=Array.from(i),s=rl.MapToInt(n);for(let i of t9(re(Array.from(t).map(e=>new ri(s.get(e[0]),s.get(e[1])))))){let t=i.map(e=>n[e]),s=eU(t,e=>e),o=tZ.createConvexHullAsClosedPolyline(s),a=[];for(let i of t)e.delete(i),null!=r&&(a.push(...r.get(i)),r.delete(i));null!=r&&r.set(o,a),e.add(o)}return rl.CalculateHierarchy(Array.from(e))}static OneCurveLiesInsideOfOther(e,t){return C.PointRelativeToCurveLocation(e.start,t)!==el.Outside||C.PointRelativeToCurveLocation(t.start,e)!==el.Outside}static PolylinesIntersect(e,t){return C.CurvesIntersect(e,t)||rl.OneCurveLiesInsideOfOther(e,t)}static GetOverlappedPairSet(e){let t=new Set;return tJ(e,e,(e,r)=>{rl.PolylinesIntersect(e,r)&&t.add([e,r])}),t}static*BisectorPoints(e,t){for(let r=e.startPoint;null!=r;r=r.next){let e={skip:!1},i=rl.GetStickingVertexOnBisector(r,t,e);!e.skip&&(yield i)}}static GetStickingVertexOnBisector(e,t,r){let i=e.polyline.prev(e).point,n=e.point,s=e.polyline.next(e).point,o=n.sub(i).normalize().add(n.sub(s).normalize()),a=o.length;return a<l.tolerance?r.skip=!0:(r.skip=!1,o=o.div(a)),o.mul(t).add(n)}static FindMaxPaddingForTightPolyline(e,t,r){let i=r,n=new ra(t),s=t.boundingBox.clone();for(let o of(s.pad(2*r),Array.from(e.GetNodeItemsIntersectingRectangle(s)).filter(e=>e!==t)))i=Math.min(i,ra.Distance(n,new ra(o)).dist/rl.LooseDistCoefficient);return i}static GetPaddedCorner(e,t,r,i){let n=e.point,s=t.point,o=r.point;if(g.getTriangleOrientation(n,s,o)===eo.Counterclockwise)return{a:void 0,b:void 0,numberOfPoints:-1};let a=s.sub(n).rotate(Math.PI/2).normalize();if(rl.CornerIsNotTooSharp(n,s,o)){a=a.mul(i);let e=o.sub(s).normalize().mul(i).rotate(Math.PI/2),t=g.lineLineIntersection(n.add(a),s.add(a),s.add(e),o.add(e));return{a:t,b:t,numberOfPoints:1}}let h=s.sub(n).normalize().add(s.sub(o).normalize());if(h.length<l.intersectionEpsilon){let e=s.add(a.mul(i));return{a:e,b:e,numberOfPoints:1}}let u=h.normalize().mul(i),c=u.rotate(Math.PI/2),d=(i-u.dot(a))/c.dot(a),f=c.mul(d);return{a:u.add(f).add(s),b:u.sub(f).add(s),numberOfPoints:2}}static CornerIsNotTooSharp(e,t,r){let i=e.sub(t).rotate(Math.PI/4).add(t);return g.getTriangleOrientation(t,i,r)===eo.Counterclockwise}static CreatePaddedPolyline(e,t,r=!1){let i=new A,n=r?function(e){let t=new A;for(let r=e.startPoint;r;r=r.next){let e=r.point.x+.01*t4(),i=r.point.y+.01*t4();t.addPointXY(e,i)}return t.closed=e.closed,t}(e):e;if(!rl.PadCorner(i,n.endPoint.prev,n.endPoint,n.startPoint,t)||!rl.PadCorner(i,n.endPoint,n.startPoint,n.startPoint.next,t))return rl.CreatePaddedPolyline(A.mkClosedFromPoints(Array.from(tZ.CalculateConvexHull(n))),t);for(let e=n.startPoint;null!=e.next.next;e=e.next)if(!rl.PadCorner(i,e,e.next,e.next.next,t))return rl.CreatePaddedPolyline(A.mkClosedFromPoints(Array.from(tZ.CalculateConvexHull(n))),t);return i.closed=!0,i}}rl.LooseDistCoefficient=2.1;class rh{get TightPolyline(){return this.tightPoly}set TightPolyline(e){this.tightPoly=e}static mk(e,t,r){let i=new rh;return i.TightPolyline=e,i.LooseShape=t,i.Distance=r,i}toString(){return(null==this.TightPolyline?"null":this.TightPolyline.toString().substring(0,5))+","+(null==this.LooseShape?"null":this.LooseShape.toString().substring(0,5))}}class ru{constructor(e,t,r,i){this.loosePolylinesToNodes=new Map,this.MainShape=e,this.TightPadding=t,this.LoosePadding=r,this.ShapesToTightLooseCouples=i}Calculate(e){if(t6(3),0!==this.MainShape.Children.length)this.CreateTightObstacles(),this.CreateTigthLooseCouples(e),this.OverlapsDetected&&this.FillTheMapOfShapeToTightLooseCouples()}FillTheMapOfShapeToTightLooseCouples(){tK(eC(this.MainShape.Children.map(e=>eR(e,e.BoundingBox))),this.coupleHierarchy,this.TryMapShapeToTightLooseCouple.bind(this))}TryMapShapeToTightLooseCouple(e,t){ru.ShapeIsInsideOfPoly(e,t.TightPolyline)&&this.ShapesToTightLooseCouples.set(e,t)}static ShapeIsInsideOfPoly(e,t){return C.PointRelativeToCurveLocation(e.BoundaryCurve.start,t)===el.Inside}CreateTigthLooseCouples(e){let t=[];for(let r of this.tightHierarchy.GetAllLeaves()){let i=rl.FindMaxPaddingForTightPolyline(this.tightHierarchy,r,this.LoosePadding),n=new ts(rl.LoosePolylineWithFewCorners(r,i,e)),s=rh.mk(r,n,i);for(let e of this.tightToShapes.get(r))this.ShapesToTightLooseCouples.set(e,s);t.push(s)}this.coupleHierarchy=eC(t.map(e=>eR(e,e.TightPolyline.boundingBox)))}CreateTightObstacles(){this.tightToShapes=new Map;let e=new Set(this.MainShape.Children.map(this.InitialTightPolyline.bind(this))),t=e.size;this.tightHierarchy=rl.RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(e,this.tightToShapes),this.OverlapsDetected=t>e.size}InitialTightPolyline(e){let t=rl.PaddedPolylineBoundaryOfNode(e.BoundaryCurve,this.TightPadding),r=eU(this.LoosePolylinesUnderShape(e),e=>e).filter(e=>C.PointRelativeToCurveLocation(e,t)===el.Outside);if(0==r.length)return this.tightToShapes&&this.tightToShapes.set(t,[e]),t;let i=Array.from(t).concat(r);return t=A.mkClosedFromPoints(tZ.CalculateConvexHull(i)),this.tightToShapes&&this.tightToShapes.set(t,[e]),t}LoosePolylinesUnderShape(e){return e.Children.map(e=>this.ShapesToTightLooseCouples.get(e).LooseShape.BoundaryCurve)}}class rc{constructor(e,t,r){this.indexToA=e,this.priority=t,this.v=r}}class rd{get count(){return this.heapSize}ContainsElement(e){return this.cache.has(e)}constructor(e=h){this.heapSize=0,this.compare=e,this.cache=new Map,this.A=[]}SwapWithParent(e){let t=this.A[e>>1];this.PutAtI(e>>1,this.A[e]),this.PutAtI(e,t)}Enqueue(e,t){let r=++this.heapSize,i=new rc(r,t,e);for(this.cache.set(e,i),this.A[r]=i;r>1&&this.compare(this.A[r>>1].priority,t)>0;)this.SwapWithParent(r),r>>=1}IsEmpty(){return 0===this.heapSize}PutAtI(e,t){this.A[e]=t,t.indexToA=e}Dequeue(){if(0===this.heapSize)throw Error("dequeue on an empty queue");let e=this.A[1].v;return this.MoveQueueOneStepForward(e),e}DequeueAndGetPriority(e){if(0===this.heapSize)throw Error("dequeue on an empty queue");let t=this.A[1].v;return e.priority=this.A[1].priority,this.MoveQueueOneStepForward(t),t}MoveQueueOneStepForward(e){this.cache.delete(e),this.PutAtI(1,this.A[this.heapSize]);let t=1;for(;;){let e=t,r=t<<1;r<=this.heapSize&&0>this.compare(this.A[r].priority,this.A[t].priority)&&(e=r);let i=r+1;if(i<=this.heapSize&&0>this.compare(this.A[i].priority,this.A[e].priority)&&(e=i),e!==t)this.SwapWithParent(e);else break;t=e}this.heapSize--}DecreasePriority(e,t){let r=this.cache.get(e);if(!r)return;r.priority=t;let i=r.indexToA;for(;i>1&&0>this.compare(this.A[i].priority,this.A[i>>1].priority);){this.SwapWithParent(i);i>>=1}}*GetEnumerator(){for(let e=1;e<=this.heapSize;e++)yield this.A[e].v}Peek(e){if(0===this.count){e.priority=0;return}return e.priority=this.A[1].priority,this.A[1].v}toString(){let e=new tb.StringBuilder;for(let t of this.A)e.Append(t+",");return e.ToString()}}class rf{constructor(e,t,r){for(let e of(this.upperBound=Number.POSITIVE_INFINITY,this._visGraph=r,this._visGraph.ClearPrevEdgesTable(),r.Vertices()))e.Distance=Number.POSITIVE_INFINITY;this.source=e,this.targets=new Set(t),this.source.Distance=0}GetPath(){let e=new rd(h);for(this.source.Distance=0,e.Enqueue(this.source,0);!e.IsEmpty()&&(this.current=e.Dequeue(),!this.targets.has(this.current));){;for(let t of this.current.OutEdges)this.PassableOutEdge(t)&&this.ProcessNeighbor(e,t,t.Target);for(let t of this.current.InEdges)this.PassableInEdge(t)&&this.ProcessNeighbor(e,t,t.Source)}return null==this._visGraph.PreviosVertex(this.current)?null:this.CalculatePath()}PassableOutEdge(e){return e.Source===this.source||this.targets.has(e.Target)||!rf.IsForbidden(e)}PassableInEdge(e){return this.targets.has(e.Source)||e.Target===this.source||!rf.IsForbidden(e)}static IsForbidden(e){return null!=e.IsPassable&&!e.IsPassable()||e instanceof tx}ProcessNeighbor(e,t,r){let i=t.Length,n=this.current.Distance+i;if(!(n>=this.upperBound))this.targets.has(r)&&(this.upperBound=n,this.closestTarget=r),r!==this.source&&null==this._visGraph.PreviosVertex(r)?(r.Distance=n,this._visGraph.SetPreviousEdge(r,t),e.Enqueue(r,n)):n<r.Distance&&(r.Distance=n,this._visGraph.SetPreviousEdge(r,t),e.DecreasePriority(r,n))}CalculatePath(){if(null==this.closestTarget)return null;let e=[],t=this.closestTarget;do e.push(t),t=this._visGraph.PreviosVertex(t);while(t!==this.source);return e.push(this.source),e.reverse()}}class rp{get LengthMultiplier(){return this._lengthMultiplier}set LengthMultiplier(e){this._lengthMultiplier=e}get LengthMultiplierForAStar(){return this._lengthMultiplierForAStar}set LengthMultiplierForAStar(e){this._lengthMultiplierForAStar=e}constructor(e,t,r){this._lengthMultiplier=1,this._lengthMultiplierForAStar=1,this._visGraph=e,this._source=t,this._target=r,this._source.Distance=0}GetPath(e){let t=new rd(h);for(this._source.Distance=0,this._target.Distance=Number.POSITIVE_INFINITY,t.Enqueue(this._source,this.H(this._source));!t.IsEmpty();){let e={priority:0},r=t.DequeueAndGetPriority(e);if(e.priority>=this._target.Distance)break;for(let e of r.OutEdges)if(this.PassableOutEdge(e)){let i=e.Target;this.ProcessNeighbor(t,r,e,i)}for(let e of r.InEdges)if(this.PassableInEdge(e)){let i=e.Source;this.ProcessNeighbor(t,r,e,i)}}return null==this._visGraph.PreviosVertex(this._target)?null:this.CalculatePath(e)}PassableOutEdge(e){return e.Source===this._source||e.Target===this._target||!rp.IsForbidden(e)}PassableInEdge(e){return e.Source===this._target||e.Target===this._source||!rp.IsForbidden(e)}static IsForbidden(e){return null!=e.IsPassable&&!e.IsPassable()||e instanceof tx}ProcessNeighborN(e,t,r,i,n){let s=r.Length+n,o=t.Distance+s;i!==this._source&&null==this._visGraph.PreviosVertex(i)?(i.Distance=o,this._visGraph.SetPreviousEdge(i,r),i!==this._target&&e.Enqueue(i,this.H(i))):i!==this._source&&o<i.Distance&&(i.Distance=o,this._visGraph.SetPreviousEdge(i,r),i!==this._target&&e.DecreasePriority(i,this.H(i)))}ProcessNeighbor(e,t,r,i){let n=r.Length,s=t.Distance+n;i!==this._source&&null==this._visGraph.PreviosVertex(i)?(i.Distance=s,this._visGraph.SetPreviousEdge(i,r),i!==this._target&&e.Enqueue(i,this.H(i))):i!==this._source&&s<i.Distance&&(i.Distance=s,this._visGraph.SetPreviousEdge(i,r),i!==this._target&&e.DecreasePriority(i,this.H(i)))}H(e){return e.Distance+e.point.sub(this._target.point).length*this.LengthMultiplierForAStar}CalculatePath(e){let t=[],r=this._target;do t.push(r),e&&this._visGraph.ShrinkLengthOfPrevEdge(r,this.LengthMultiplier),r=this._visGraph.PreviosVertex(r);while(r!==this._source);return t.push(this._source),t.reverse()}}(H=ep||(ep={}))[H.Regular=0]="Regular",H[H.Tangent=1]="Tangent";class rg{toString(){return tb.String.format("{0},{1}",this.Start,this.End)}get Start(){return this.leftTangent.End.point}get End(){return this.rightTangent.End.point}constructor(e,t){this.LeftTangent=e,this.RightTangent=t}get LeftTangent(){return this.leftTangent}set LeftTangent(e){this.leftTangent=e}get RightTangent(){return this.rightTangent}set RightTangent(e){this.rightTangent=e}get RbNode(){return this.rbNode}set RbNode(e){this.rbNode=e}}class rm{get Comp(){return this.comp}set Comp(e){this.comp=e}get IsHigh(){return!this.IsLow}get IsLow(){return this.lowTangent}set IsLow(e){this.lowTangent=e}get SeparatingPolygons(){return this.separatingPolygons}set SeparatingPolygons(e){this.separatingPolygons=e}get Diagonal(){return this.diagonal}set Diagonal(e){this.diagonal=e}get Start(){return this.start}set Start(e){this.start=e}get End(){return this.end}set End(e){this.end=e}constructor(e,t){this.start=e,this.End=t}toString(){return tb.String.format("{0},{1}",this.Start,this.End)}}class rv{get PointOnTangentAndInsertedDiagonal(){return this.pointOnTheRay}set PointOnTangentAndInsertedDiagonal(e){this.pointOnTheRay=e}Compare(e,t){if(e.Start.equal(t.Start))return 0;if(g.getTriangleOrientation(this.PointOnTangentAndInsertedDiagonal,t.Start,t.End)===eo.Counterclockwise)return -1;return 1}static BelongsToTheDiagonal(e,t,r){return g.closeDistEps(e,g.ClosestPointAtLineSegment(e,t,r))}static IntersectDiagonalWithRay(e,t,r){let i=t.sub(e),n=r.Start,s=r.End,o=a.solve(s.x-n.x,-1*i.x,e.x-n.x,s.y-n.y,-1*i.y,e.y-n.y);return e.add(i.mul(o.y))}}class rb{constructor(e){this.pivot=e}IComparer(e,t){if(e===t)return 0;if(null==e)return -1;if(null==t)return 1;let r=e.Start.point.sub(this.pivot),i=t.Start.point.sub(this.pivot);return rb.CompareVectorsByAngleToXAxis(r,i)}static CompareVectorsByAngleToXAxis(e,t){if(e.y>=0)return t.y<0?-1:rb.CompareVectorsPointingToTheSameYHalfPlane(e,t);return t.y>=0?1:rb.CompareVectorsPointingToTheSameYHalfPlane(e,t)}static CompareVectorsPointingToTheSameYHalfPlane(e,t){let r=e.x*t.y-e.y*t.x;if(r>l.tolerance)return -1;if(r<-l.tolerance)return 1;if(e.x>=0){if(t.x<0)return -1}else if(t.x>=0)return 1;let i=Math.abs(e.x)-Math.abs(t.x);return i<0?-1:i>0?1:(i=Math.abs(e.y)-Math.abs(t.y))<0?-1:i>0?1:0}}class ry extends e0{run(){this.useLeftPTangents=!0,this.CalculateAndAddEdges(),this.useLeftPTangents=!1,this.CalculateAndAddEdges()}CalculateAndAddEdges(){for(let e of this.addedPolygons)this.CalculateVisibleTangentsFromPolygon(e);this.ProgressStep()}CalculateVisibleTangentsFromPolygon(e){this.currentPolygon=e,this.AllocateDataStructures(),this.OrganizeTangents(),this.InitActiveDiagonals(),this.Sweep()}AllocateDataStructures(){this.tangents=[],this.diagonals=[],this.activeDiagonalTree=new tu(this.activeDiagonalComparer.Compare.bind(this.activeDiagonalComparer))}Sweep(){if(!(this.tangents.length<2))for(let e=1;e<this.tangents.length;e++){let t=this.tangents[e];null!=t.Diagonal?(t.Diagonal.RbNode===this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(t),t.IsHigh&&this.RemoveDiagonalFromActiveNodes(t.Diagonal)):t.IsLow&&(this.activeDiagonalComparer.PointOnTangentAndInsertedDiagonal=t.End.point,this.InsertActiveDiagonal(new rg(t,t.Comp)),t.Diagonal.RbNode===this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(t))}}AddVisibleEdge(e){tT.AddEdgeVV(rx(this.visibilityGraph,e.start),rx(this.visibilityGraph,e.End))}InitActiveDiagonals(){if(0===this.tangents.length)return;let e=this.tangents[0],t=e.start.point,r=e.End.point;for(let e of this.diagonals)ry.RayIntersectDiagonal(t,r,e)&&(this.activeDiagonalComparer.PointOnTangentAndInsertedDiagonal=rv.IntersectDiagonalWithRay(t,r,e),this.InsertActiveDiagonal(e));if(e.Diagonal.RbNode===this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(e),!1===e.IsLow){let t=e.Diagonal;this.RemoveDiagonalFromActiveNodes(t)}}RemoveDiagonalFromActiveNodes(e){let t=this.activeDiagonalTree.deleteSubTree(e.RbNode);null!=t&&null!=t.item&&(t.item.RbNode=t),e.LeftTangent.Diagonal=null,e.RightTangent.Diagonal=null}InsertActiveDiagonal(e){e.RbNode=this.activeDiagonalTree.insert(e),ry.MarkDiagonalAsActiveInTangents(e)}static MarkDiagonalAsActiveInTangents(e){e.LeftTangent.Diagonal=e,e.RightTangent.Diagonal=e}static RayIntersectDiagonal(e,t,r){let i=r.Start,n=r.End;return g.getTriangleOrientation(e,i,n)===eo.Counterclockwise&&g.getTriangleOrientation(e,t,i)!==eo.Counterclockwise&&g.getTriangleOrientation(e,t,n)!==eo.Clockwise}static TangentComparison(e,t){return rb.CompareVectorsByAngleToXAxis(e.End.point.sub(e.start.point),t.End.point.sub(t.start.point))}*AllObstacles(){for(let e of this.addedPolygons)yield e;if(this.polygons)for(let e of this.polygons)yield e}OrganizeTangents(){for(let e of this.AllObstacles())e!==this.currentPolygon&&this.ProcessPolygonQ(e);this.tangents.sort(ry.TangentComparison)}ProcessPolygonQ(e){let t=new ro(this.currentPolygon,e);this.useLeftPTangents?t.CalculateLeftTangents():t.CalculateRightTangents();let r=this.useLeftPTangents?t.leftPLeftQ:t.rightPLeftQ,i=new rm(this.currentPolygon.pp(r[0]),e.pp(r[1]));i.IsLow=!0,i.SeparatingPolygons=!this.useLeftPTangents,r=this.useLeftPTangents?t.leftPRightQ:t.rightPRightQ;let n=new rm(this.currentPolygon.pp(r[0]),e.pp(r[1]));n.IsLow=!1,n.SeparatingPolygons=this.useLeftPTangents,i.Comp=n,n.Comp=i,this.tangents.push(i),this.tangents.push(n),this.diagonals.push(new rg(i,n))}constructor(e,t,r){super(null),this.polygons=[],this.activeDiagonalComparer=new rv,this.polygons=e,this.visibilityGraph=r,this.addedPolygons=t}}function rx(e,t){return e.FindVertex(t.point)}class r_{get Pivot(){return this.pivot}set Pivot(e){this.pivot=e}get IntersectionOfTheRayAndInsertedEdge(){return this.pointOnTheRay}set IntersectionOfTheRayAndInsertedEdge(e){this.pointOnTheRay=e}Compare(e,t){if(g.getTriangleOrientation(this.IntersectionOfTheRayAndInsertedEdge,t.point,t.nextOnPolyline.point)===eo.Counterclockwise)return -1;return 1}IntersectionPointBelongsToTheInsertedEdge(e){let t=e.point.sub(this.IntersectionOfTheRayAndInsertedEdge),r=e.nextOnPolyline.point.sub(this.IntersectionOfTheRayAndInsertedEdge);return Math.abs(t.x*r.y-r.x*t.y)<l.distanceEpsilon}IntersectEdgeWithRayPPP(e,t,r){let i=a.solve(t.x-e.x,-r.x,this.Pivot.x-e.x,t.y-e.y,-r.y,this.Pivot.y-e.y);if(!(-l.tolerance<=i.x&&i.x<=1+l.tolerance)||!i)throw Error();return this.Pivot.add(r.mul(i.y))}IntersectEdgeWithRay(e,t){return this.IntersectEdgeWithRayPPP(e.point,e.nextOnPolyline.point,t)}static constructorPP(e,t){let r=new r_;return r.pivot=e,r.pointOnTheRay=t,r}}class rS{get Start(){return this.start}set Start(e){this.start=e}get End(){return this.end}set End(e){this.end=e}constructor(e,t){this.start=e,this.end=t}*Sides(){let e=this.start;for(;e!==this.end;){let t=e;yield t,e=t.nextOnPolyline}}MoveStartClockwise(){return this.Start!==this.End&&(this.Start=this.Start.nextOnPolyline,!0)}toString(){return tb.String.format("Stem({0},{1})",this.Start,this.End)}}class rw{get QVertex(){return this.qV}set QVertex(e){this.qV=e}static CalculatePointVisibilityGraph(e,t,r,i){let n=t.FindVertex(r);if(null!=n)return n;let s=new rw(e,t,r,i);return s.FillGraph(),s.QVertex}FillGraph(){this.ComputeHoleBoundariesPossiblyVisibleFromQ(),this.visibleBoundaries.size>0&&(this.SortSAndInitActiveSides(),this.Sweep())}SortSAndInitActiveSides(){this.InitHeapAndInsertActiveSides();for(let e=this.heapForSorting.GetMinimum();this.sortedListOfPolypoints.push(e.Start),e.MoveStartClockwise()?this.heapForSorting.ChangeMinimum(e):this.heapForSorting.Dequeue(),0!==this.heapForSorting.Count;e=this.heapForSorting.GetMinimum());}InitHeapAndInsertActiveSides(){for(let e of this.GetInitialVisibleBoundaryStemsAndInsertActiveSides())this.heapForSorting.Enqueue(e)}*GetInitialVisibleBoundaryStemsAndInsertActiveSides(){for(let[e,t]of this.visibleBoundaries){let r=!1;for(let i of t.Sides())if(i.point.y<this.q.y){if(i.nextOnPolyline.point.y>=this.q.y){let e=g.getTriangleOrientation(this.q,i.point,i.nextOnPolyline.point);if(e===eo.Counterclockwise||e===eo.Collinear){r=!0,yield new rS(t.Start,i),yield new rS(i.nextOnPolyline,t.End),this.RegisterActiveSide(i);break}}}else if(i.point.y>this.q.y)break;else if(i.point.x>=this.q.x){r=!0,yield new rS(i,t.End),i!==t.Start&&(yield new rS(t.Start,e.prev(i))),this.RegisterActiveSide(i);break}!r&&(yield t)}}RegisterActiveSide(e){this.activeEdgeComparer.IntersectionOfTheRayAndInsertedEdge=this.activeEdgeComparer.IntersectEdgeWithRay(e,new g(1,0)),this.sideNodes.set(e,this.activeSidesTree.insert(e))}constructor(e,t,r,i){this.sideNodes=new Map,this.visibleBoundaries=new Map,this.sortedListOfPolypoints=[],this.holes=Array.from(e),this.visibilityGraph=t,this.q=r,this.qPolylinePoint=m.mkFromPoint(this.q),this.QVertex=this.visibilityGraph.AddVertexP(this.qPolylinePoint.point),this.visibilityKind=i;let n=new rb(this.q);this.heapForSorting=new tc(n.IComparer.bind(n))}Sweep(){for(let e of this.sortedListOfPolypoints)this.SweepPolylinePoint(e)}SweepPolylinePoint(e){let t;let r=rw.GetIncomingSide(e),i=this.GetOutgoingSide(e);if(this.activeEdgeComparer.IntersectionOfTheRayAndInsertedEdge=e.point,t=this.sideNodes.get(r)){if(t===this.activeSidesTree.treeMinimum()&&this.AddEdge(e),null!=i)t.item=i,this.sideNodes.set(i,t);else{let e=this.activeSidesTree.deleteSubTree(t);null!=e&&null!=e.item&&this.sideNodes.set(e.item,e)}this.sideNodes.delete(r)}else if(null!=i){let t;!(t=this.sideNodes.get(i))&&(t=this.activeSidesTree.insert(i),this.sideNodes.set(i,t),t===this.activeSidesTree.treeMinimum()&&this.AddEdge(e))}else throw Error()}AddEdge(e){(this.visibilityKind===ep.Regular||this.visibilityKind===ep.Tangent&&rw.LineTouchesPolygon(this.QVertex.point,e))&&this.visibilityGraph.AddEdgeF(this.QVertex.point,e.point,(e,t)=>new tx(e,t))}static LineTouchesPolygon(e,t){let r=t.polyline.prev(t).point,i=t.polyline.next(t).point,n=t.point;return g.signedDoubledTriangleArea(e,n,r)*g.signedDoubledTriangleArea(e,n,i)>=0}GetOutgoingSide(e){let t=this.visibleBoundaries.get(e.polyline);return e===t.End?null:e}static GetIncomingSide(e){return e.prevOnPolyline}ComputeHoleBoundariesPossiblyVisibleFromQ(){for(let e of(this.InitActiveEdgesAndActiveEdgesComparer(),this.holes))this.ComputeVisiblePartOfTheHole(e)}InitActiveEdgesAndActiveEdgesComparer(){this.activeEdgeComparer=new r_,this.activeEdgeComparer.pivot=this.q,this.activeSidesTree=new tu(this.activeEdgeComparer.Compare.bind(this.activeEdgeComparer))}ComputeVisiblePartOfTheHole(e){let t;let r=!0;for(t=e.startPoint;!this.HoleSideIsVisibleFromQ(e,t);t=e.next(t))r=!1;let i=e.next(t);if(r)for(;this.HoleSideIsVisibleFromQ(e,e.prev(t));)t=e.prev(t);for(;this.HoleSideIsVisibleFromQ(e,i);i=e.next(i));this.visibleBoundaries.set(e,new rS(t,i))}HoleSideIsVisibleFromQ(e,t){return g.signedDoubledTriangleArea(this.q,t.point,e.next(t).point)>=-l.squareOfDistanceEpsilon}}class rT extends e0{constructor(){super(...arguments),this.IgnoreTightPadding=!0,this.activeRectangle=M.mkEmpty(),this.activePolygons=[],this.alreadyAddedOrExcludedPolylines=new Set,this.UseEdgeLengthMultiplier=!1,this.UseInnerPolylingShortcutting=!0,this.UsePolylineEndShortcutting=!0,this.AllowedShootingStraightLines=!0,this.LookForRoundedVertices=!1}rerouteEdge(e){let t=e.smoothedPolyline?A.mkFromPoints(e.smoothedPolyline):A.mkFromPoints(e.getSmoothPolyPoints());this.pathOptimizer.run(t),e.curve=this.pathOptimizer.poly.toCurve()}static constructorANNN(e,t,r,i){return rT.constructorANNNB(e,t,r,i,!1)}get Obstacles(){return this.obstacles_}set Obstacles(e){this.obstacles_=e}get EnteringAngleBound(){return this.enteringAngleBound_}set EnteringAngleBound(e){this.enteringAngleBound_=e}get SourceTightPolyline(){return this._sourceTightPolyline}set SourceTightPolyline(e){this._sourceTightPolyline=e}get TargetTightPolyline(){return this.targetTightPolyline}set TargetTightPolyline(e){this.targetTightPolyline=e}get TargetLoosePolyline(){return this.targetLoosePolyline}set TargetLoosePolyline(e){this.targetLoosePolyline=e}get VisibilityGraph(){return this.visibilityGraph}set VisibilityGraph(e){this.visibilityGraph=e}get SourcePort(){return this.sourcePort}set SourcePort(e){if(this.sourcePort=e,null!=this.sourcePort){if(this.SourceTightPolyline=rT.GetFirstHitPolyline(this.sourcePort.Location,this.ObstacleCalculator.RootOfTightHierarchy),this.sourcePort instanceof ta)this.alreadyAddedOrExcludedPolylines.add(this.SourceLoosePolyline),this.StartPointOfEdgeRouting=this.SourcePort.Location;else{let e=this.sourcePort;this.StartPointOfEdgeRouting=this.TakeBoundaryPortOutsideOfItsLoosePolyline(e.Curve,e.Parameter,this.SourceLoosePolyline)}}}get TargetPort(){return this.targetPort}set TargetPort(e){this.targetPort=e}get LoosePadding(){return this.loosePadding}set LoosePadding(e){this.loosePadding=e,null!=this.ObstacleCalculator&&(this.ObstacleCalculator.LoosePadding=e)}get OffsetForPolylineRelaxing(){return .75*this.TightPadding}get StartPointOfEdgeRouting(){return this.startPointOfRouting_}set StartPointOfEdgeRouting(e){this.startPointOfRouting_=e}ExtendVisibilityGraphToLocation(e){null==this.VisibilityGraph&&(this.VisibilityGraph=new tT);let t=null;if(!this.activeRectangle.contains(e))for(let r of(this.activeRectangle.isEmpty?this.activeRectangle=M.mkPP(this.SourcePort.Location,e):this.activeRectangle.add(e),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle()))this.VisibilityGraph.AddHole(r.Polyline);null==t||0===t.length?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraph(e)):(this.RemovePointVisibilityGraphs(),new ry(t,this.activePolygons,this.VisibilityGraph).run(),eB(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraph(e),this.CalculateSourcePortVisibilityGraph())}RemovePointVisibilityGraphs(){null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),null!=this.sourceVV&&this.VisibilityGraph.RemoveVertex(this.sourceVV)}CalculateEdgeTargetVisibilityGraph(e){this.targetVV=rw.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()),this.VisibilityGraph,e,ep.Tangent)}CalculateSourcePortVisibilityGraph(){this.sourceVV=rw.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()),this.VisibilityGraph,this.StartPointOfEdgeRouting,ep.Tangent)}TakeBoundaryPortOutsideOfItsLoosePolyline(e,t,r){let i=e.value(t),n=e.leftDerivative(t).normalize().add(e.rightDerivative(t).normalize()).normalize();g.getTriangleOrientation(rT.PointInsideOfConvexCurve(e),i,i.add(n))==eo.Counterclockwise&&(n=n.mul(-1)),n=n.rotate(Math.PI/2);let s=r.boundingBox.diagonal,o=b.mkPP(i,i.add(n.mul(s))),a=C.intersectionOne(o,r,!1).x,l=n.mul(a.sub(i).length/2);for(;;){o=b.mkPP(i,a.add(l));let e=!1;for(let t of rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(o,this.ObstacleCalculator.RootOfLooseHierarchy))if(t.seg1!==r){l=l.div(1.5),e=!0;break}if(!e)break}return o.end}static PointInsideOfConvexCurve(e){return e.value(0).add(e.value(1.5)).div(2)}*GetActivePolylines(){for(let e of this.activePolygons)yield e.Polyline}GetAddedPolygonesAndMaybeExtendActiveRectangle(){let e;let t=this.activeRectangle,r=[];do{for(let i of(e=!1,this.ObstacleCalculator.RootOfLooseHierarchy.GetNodeItemsIntersectingRectangle(this.activeRectangle)))!this.alreadyAddedOrExcludedPolylines.has(i)&&(t.addRec(i.boundingBox),r.push(new ra(i)),this.alreadyAddedOrExcludedPolylines.add(i),e=!0);e&&(this.activeRectangle=t)}while(e);return r}PolylineSegmentIntersectsTightHierarchy(e,t){return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchyPPR(e,t,this.ObstacleCalculator.RootOfTightHierarchy)}PolylineIntersectsPolyRectangleNodeOfTightHierarchyPPR(e,t,r){return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(b.mkPP(e,t),r)}PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t){if(!e.boundingBox.intersects(t.irect))return!1;if(null!=t.UserData){for(let r of C.getAllIntersections(e,t.UserData,!1))if(r.seg1!==this.SourceTightPolyline&&r.seg1!==this.TargetTightPolyline||(r.seg1===this.SourceTightPolyline&&this.SourcePort)instanceof tH||(r.seg1===this.TargetTightPolyline&&this.TargetPort)instanceof tH)return!0;return!1}return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t.Left)||this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t.Right)}static IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,t){let r=[];return rT.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t,r),r}static IntersectionsOfLineAndRectangleNodeOverPolyline(e,t,r){if(null!=t&&!!e.boundingBox.intersects(t.irect)){if(null!=t.UserData){eB(r,C.getAllIntersections(e,t.UserData,!0));return}rT.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t.Left,r),rT.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t.Right,r)}}LineCanBeAcceptedForRouting(e){let t=this.SourcePort instanceof ta,r=this.TargetPort instanceof ta;if(!t&&!this.targetIsInsideOfSourceTightPolyline&&!this.InsideOfTheAllowedConeOfBoundaryPort(e.end,this.SourcePort)||!r&&null!=this.TargetPort&&!this.sourceIsInsideOfTargetTightPolyline&&!this.InsideOfTheAllowedConeOfBoundaryPort(e.start,this.TargetPort))return!1;for(let t of rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy)){if(t.seg1!==this.SourceTightPolyline&&t.seg1!==this.targetTightPolyline)return!1}return!0}InsideOfTheAllowedConeOfBoundaryPort(e,t){let r=t.Curve,i=rl.CurveIsClockwise(r,rT.PointInsideOfConvexCurve(r)),n=t.Location,s=this.GetPointOnTheRightBoundaryPortConeSide(n,r,i,t.Parameter),o=this.GetPointOnTheLeftBoundaryPortConeSide(n,r,i,t.Parameter);return g.getTriangleOrientation(n,s,e)!==eo.Clockwise&&g.getTriangleOrientation(n,e,o)!==eo.Clockwise}GetPointOnTheRightBoundaryPortConeSide(e,t,r,i){let n=r?t.rightDerivative(i):t.leftDerivative(i).neg();return e.add(n.rotate(this.EnteringAngleBound))}GetPointOnTheLeftBoundaryPortConeSide(e,t,r,i){let n=r?t.leftDerivative(i).neg():t.rightDerivative(i);return e.add(n.rotate(-this.EnteringAngleBound))}SmoothenCorners(e){let t=e.headSite,r={b:null,c:null};for(;r=C.findCorner(t);)t=this.SmoothOneCorner(t,r.c,r.b)}SmoothOneCorner(e,t,r){let i,n,s;let o=.5;null==e.prev?(s=2,n=1):null==t.next?(s=1,n=2):s=n=1;do i=C.createBezierSeg(o*s,o*n,e,r,t),r.previouisBezierCoefficient=o*s,r.nextBezierCoefficient=o*n,o/=1.5;while(a()>this.loosePadding&&o>.01);return(o*=1.5)<.5&&o>.01&&(o=.5*(o+1.5*o),i=C.createBezierSeg(o*s,o*n,e,r,t),a()>this.loosePadding&&(r.previouisBezierCoefficient=o*s,r.nextBezierCoefficient=o*n)),r;function a(){let e=i.closestParameter(r.point);return r.point.sub(i.value(e)).length}}TryToRemoveInflectionsAndCollinearSegments(e){let t=!0,r={s:null};for(;t;)for(t=!1,r.s=e.headSite;null!=r.s&&null!=r.s.next;r.s=r.s.next)r.s.turn*r.s.next.turn<0&&(t=this.TryToRemoveInflectionEdge(r)||t)}TryToRemoveInflectionEdge(e){if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.prev.point,e.s.next.point)){let t=e.s.prev,r=e.s.next;return t.next=r,r.prev=t,e.s=t,!0}if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.prev.point,e.s.next.next.point)){let t=e.s.prev,r=e.s.next.next;return t.next=r,r.prev=t,e.s=t,!0}if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.point,e.s.next.next.point)){let t=e.s.next.next;return e.s.next=t,t.prev=e.s,!0}return!1}GetShortestPolyline(e,t){this.CleanTheGraphForShortestPath();let r=new rp(this.visibilityGraph,e,t).GetPath(this.UseEdgeLengthMultiplier);if(null==r)return null;let i=A.mkFromPoints(Array.from(r).map(e=>e.point)).RemoveCollinearVertices();return this.pathOptimizer&&(this.pathOptimizer.run(i),i=this.pathOptimizer.poly),i}CleanTheGraphForShortestPath(){this.visibilityGraph.ClearPrevEdgesTable()}get OverlapsDetected(){return this.ObstacleCalculator.OverlapsDetected}get TightHierarchy(){return this.ObstacleCalculator.RootOfTightHierarchy}set TightHierarchy(e){this.ObstacleCalculator.RootOfTightHierarchy=e}get LooseHierarchy(){return this.ObstacleCalculator.RootOfLooseHierarchy}set LooseHierarchy(e){this.ObstacleCalculator.RootOfLooseHierarchy=e}CalculateObstacles(){this.ObstacleCalculator=new rl(this.Obstacles,this.TightPadding,this.LoosePadding,this.IgnoreTightPadding),this.ObstacleCalculator.Calculate()}static constructorANNNB(e,t,r,i,n){let s=new rT(null);return s.IgnoreTightPadding=n,s.EnteringAngleBound=Math.PI/180*80,s.TightPadding=t,s.LoosePadding=r,i>0?(eX.assert(i>Math.PI/180),eX.assert(i<=Math.PI/180*90),s.UseSpanner=!0,s.ExpectedProgressSteps=tU.GetTotalSteps(i)):s.ExpectedProgressSteps=e.length,s.ConeSpannerAngle=i,s.Obstacles=e,s.CalculateObstacles(),s}RouteEdgeToLocation(e){this.TargetPort=new ta(null,e),this.TargetTightPolyline=null,this.TargetLoosePolyline=null;let t=new V(null),r=b.mkPP(this.SourcePort.Location,e);if(this.LineCanBeAcceptedForRouting(r)){this._polyline=new A,this._polyline.addPoint(r.start),this._polyline.addPoint(r.end);let e=O.mkFromPoints(this._polyline);return t.curve=e.createCurve(),t}return this.SourcePort instanceof tH&&(r=b.mkPP(this.StartPointOfEdgeRouting,e),0==rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(r,this.ObstacleCalculator.RootOfTightHierarchy).length)?(this._polyline=new A,this._polyline.addPoint(this.SourcePort.Location),this._polyline.addPoint(r.start),this._polyline.addPoint(r.end),t.curve=O.mkFromPoints(this._polyline).createCurve(),t):(this.ExtendVisibilityGraphToLocation(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),this.SourcePort instanceof tH&&this._polyline.PrependPoint(this.SourcePort.Location),t.curve=O.mkFromPoints(this._polyline).createCurve(),t)}RouteEdgeToPort(e,t,r,i){if(!this.ObstacleCalculator.IsEmpty())return(this.TargetPort=e,this.TargetTightPolyline=rT.GetFirstHitPolyline(e.Location,this.ObstacleCalculator.RootOfTightHierarchy),e instanceof tH)?this.RouteEdgeToBoundaryPort(t,r,i):this.RouteEdgeToFloatingPortOfNode(t,r,i);return null!=this.sourcePort&&null!=this.targetPort?(i.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(this.sourcePort.Location,this.targetPort.Location),b.mkPP(this.sourcePort.Location,this.targetPort.Location)):null}SmoothedPolylineFromTwoPoints(e,t){return this._polyline=new A,this._polyline.addPoint(e),this._polyline.addPoint(t),O.mkFromPoints(this._polyline)}RouteEdgeToFloatingPortOfNode(e,t,r){return this.sourcePort instanceof ta?this.RouteFromFloatingPortToFloatingPort(e,t,r):this.RouteFromBoundaryPortToFloatingPort(e,t,r)}RouteFromBoundaryPortToFloatingPort(e,t,r){let i=this.SourcePort.Location,n=this.targetPort.Location,s=b.mkPP(i,n);if(this.LineCanBeAcceptedForRouting(s))return r.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(s.start,s.end),s;if(!this.targetIsInsideOfSourceTightPolyline){let t=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.SourcePort.Curve,this.SourcePort.Parameter,this.SourceLoosePolyline);if(s=b.mkPP(t,n),this.LineAvoidsTightHierarchyLP(s,e))return r.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(s.start,s.end),s}this.ExtendVisibilityGraphToLocationOfTargetFloatingPort(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV);let o=this.SourceTightPolyline;return!this.targetIsInsideOfSourceTightPolyline&&(this.SourceTightPolyline=null),this.SourceTightPolyline=o,this._polyline.PrependPoint(i),this.SmoothCornersAndReturnCurve(t,r)}SmoothCornersAndReturnCurve(e,t){return t.smoothedPolyline=O.mkFromPoints(this._polyline),e&&this.SmoothenCorners(t.smoothedPolyline),t.smoothedPolyline.createCurve()}RouteFromFloatingPortToFloatingPort(e,t,r){return(this.ExtendVisibilityGraphToLocationOfTargetFloatingPort(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),null==this._polyline)?null:(r.smoothedPolyline=O.mkFromPoints(this._polyline),this.SmoothCornersAndReturnCurve(t,r))}TryShortcutPolyPoint(e){return!!this.LineAvoidsTightHierarchyLPP(b.mkPP(e.point,e.next.next.point),this.SourceTightPolyline,this.targetTightPolyline)&&(e.next=e.next.next,e.next.prev=e,!0)}ExtendVisibilityGraphToLocationOfTargetFloatingPort(e){null==this.VisibilityGraph&&(this.VisibilityGraph=new tT);let t=null,r=this.targetPort.Location;if(!this.activeRectangle.contains(r))for(let e of(this.activeRectangle.isEmpty?this.activeRectangle=M.mkPP(this.SourcePort.Location,r):this.activeRectangle.add(r),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle()))this.VisibilityGraph.AddHole(e.Polyline);null==t?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraphForFloatingPort(r,e),null==this.sourceVV&&this.CalculateSourcePortVisibilityGraph()):(this.RemovePointVisibilityGraphs(),new ry(t,this.activePolygons,this.VisibilityGraph).run(),eB(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraphForFloatingPort(r,e),this.CalculateSourcePortVisibilityGraph())}CalculateEdgeTargetVisibilityGraphForFloatingPort(e,t){this.UseSpanner?this.targetVV=this.AddTransientVisibilityEdgesForPort(e,t):this.targetVV=rw.CalculatePointVisibilityGraph(this.GetActivePolylinesWithException(t),this.VisibilityGraph,e,ep.Tangent)}AddTransientVisibilityEdgesForPort(e,t){let r=this.GetVertex(e);if(null!=r)return r;if(r=this.visibilityGraph.AddVertexP(e),null!=t)for(let r of t)this.visibilityGraph.AddEdgeF(e,r,(e,t)=>new tx(e,t));else r=rw.CalculatePointVisibilityGraph(this.GetActivePolylines(),this.VisibilityGraph,e,ep.Tangent);return r}GetVertex(e){let t=this.visibilityGraph.FindVertex(e);return null==t&&this.LookForRoundedVertices&&(t=this.visibilityGraph.FindVertex(g.RoundPoint(e))),t}*GetActivePolylinesWithException(e){for(let t of this.activePolygons)t.Polyline!==e&&(yield t.Polyline)}RouteEdgeToBoundaryPort(e,t,r){return(this.TargetLoosePolyline=e,this.sourcePort instanceof ta)?this.RouteFromFloatingPortToBoundaryPort(t,r):this.RouteFromBoundaryPortToBoundaryPort(t,r)}RouteFromBoundaryPortToBoundaryPort(e,t){let r;let i=this.SourcePort.Location,n=this.targetPort.Location,s=b.mkPP(i,n);if(this.LineCanBeAcceptedForRouting(s))this._polyline=new A,this._polyline.addPoint(s.start),this._polyline.addPoint(s.end),t.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(s.start,s.end),r=O.mkFromPoints(this._polyline).createCurve();else{let o=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.targetPort.Curve,this.targetPort.Parameter,this.TargetLoosePolyline);if(s=b.mkPP(i,o),this.InsideOfTheAllowedConeOfBoundaryPort(o,this.SourcePort)&&this.LineAvoidsTightHierarchyLP(s,this._sourceTightPolyline))this._polyline=new A,this._polyline.addPoint(s.start),this._polyline.addPoint(s.end),this._polyline.addPoint(n),r=this.SmoothCornersAndReturnCurve(e,t);else if(s=b.mkPP(this.StartPointOfEdgeRouting,n),this.InsideOfTheAllowedConeOfBoundaryPort(this.StartPointOfEdgeRouting,this.TargetPort)&&this.LineAvoidsTightHierarchy(s))this._polyline=new A,this._polyline.addPoint(i),this._polyline.addPoint(s.start),this._polyline.addPoint(s.end),r=this.SmoothCornersAndReturnCurve(e,t);else{let s;if(s=b.IntersectPPPP(i,this.StartPointOfEdgeRouting,n,o))this._polyline=new A,this._polyline.addPoint(i),this._polyline.addPoint(s),this._polyline.addPoint(n),r=this.SmoothCornersAndReturnCurve(e,t);else if(g.closeDistEps(this.StartPointOfEdgeRouting,o))this._polyline=new A,this._polyline.addPoint(i),this._polyline.addPoint(o),this._polyline.addPoint(n),r=this.SmoothCornersAndReturnCurve(e,t);else if(this.LineAvoidsTightHierarchy(b.mkPP(this.StartPointOfEdgeRouting,o)))this._polyline=new A,this._polyline.addPoint(i),this._polyline.addPoint(this.StartPointOfEdgeRouting),this._polyline.addPoint(o),this._polyline.addPoint(n),r=this.SmoothCornersAndReturnCurve(e,t);else{this.ExtendVisibilityGraphToTargetBoundaryPort(o),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV);let s={tmpTargetTight:null},a=this.HideSourceTargetTightsIfNeeded(s);this.RecoverSourceTargetTights(a,s.tmpTargetTight),this._polyline.PrependPoint(i),this._polyline.addPoint(n),r=this.SmoothCornersAndReturnCurve(e,t)}}}return r}RecoverSourceTargetTights(e,t){this.SourceTightPolyline=e,this.TargetTightPolyline=t}HideSourceTargetTightsIfNeeded(e){let t=this.SourceTightPolyline;return e.tmpTargetTight=this.TargetTightPolyline,this.TargetTightPolyline=null,this.SourceTightPolyline=null,t}LineAvoidsTightHierarchy(e){return 0===rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy).length}RouteFromFloatingPortToBoundaryPort(e,t){let r;let i=this.targetPort.Location;if(this.InsideOfTheAllowedConeOfBoundaryPort(this.sourcePort.Location,this.targetPort)&&(r=b.mkPP(this.SourcePort.Location,i),this.LineCanBeAcceptedForRouting(r)))return t.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(r.start,r.end),r;let n=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.TargetPort.Curve,this.TargetPort.Parameter,this.TargetLoosePolyline);return(r=b.mkPP(this.SourcePort.Location,n),this.LineAvoidsTightHierarchyLP(r,this._sourceTightPolyline))?(this._polyline=A.mkFromPoints([r.start,r.end,i]),t.smoothedPolyline=O.mkFromPoints(this._polyline),t.smoothedPolyline.createCurve()):(this.ExtendVisibilityGraphToTargetBoundaryPort(n),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),this._polyline.addPoint(i),this.SmoothCornersAndReturnCurve(e,{smoothedPolyline:null}))}LineAvoidsTightHierarchyLP(e,t){let r=!0;for(let i of rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy))if(i.seg1!==t){r=!1;break}return r}LineAvoidsTightHierarchyLPP(e,t,r){let i=!0;for(let n of rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy))if(!(n.seg1===t||n.seg1===r)){i=!1;break}return i}LineAvoidsTightHierarchyPPPP(e,t,r,i){return this.LineAvoidsTightHierarchyLPP(b.mkPP(e,t),r,i)}ExtendVisibilityGraphToTargetBoundaryPort(e){let t=null;if(null==this.VisibilityGraph&&(this.VisibilityGraph=new tT),!this.activeRectangle.contains(e)||!this.activeRectangle.containsRect(this.TargetLoosePolyline.boundingBox))for(let r of(this.activeRectangle.isEmpty?(this.activeRectangle=this.TargetLoosePolyline.boundingBox.clone(),this.activeRectangle.add(this.SourcePort.Location),this.activeRectangle.add(this.StartPointOfEdgeRouting),this.activeRectangle.add(e)):(this.activeRectangle.add(e),this.activeRectangle.addRec(this.TargetLoosePolyline.boundingBox)),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle()))this.VisibilityGraph.AddHole(r.Polyline);null==t?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraph(e)):(this.RemovePointVisibilityGraphs(),new ry(t,this.activePolygons,this.VisibilityGraph).run(),eB(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraph(e),this.CalculateSourcePortVisibilityGraph())}GetHitLoosePolyline(e){return this.ObstacleCalculator.IsEmpty()||null==this.ObstacleCalculator.RootOfLooseHierarchy?null:rT.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy)}static GetFirstHitPolyline(e,t){let r=rT.GetFirstHitRectangleNode(e,t);return r?r.UserData:null}static GetFirstHitRectangleNode(e,t){return null==t?null:t.FirstHitNodeWithPredicate(e,(e,t)=>C.PointRelativeToCurveLocation(e,t)!==el.Outside?eu.Stop:eu.Continue)}Clean(){this.TargetPort=null,this.SourcePort=null,this.SourceTightPolyline=null,this.SourceLoosePolyline=null,this.TargetLoosePolyline=null,this.targetTightPolyline=null,this.VisibilityGraph=null,this.targetVV=null,this.sourceVV=null,this.activePolygons=[],this.alreadyAddedOrExcludedPolylines.clear(),this.activeRectangle.setToEmpty()}SetSourcePortAndSourceLoosePolyline(e,t){this.SourceLoosePolyline=t,this.sourcePort=e,null!=this.sourcePort&&(this.SourceTightPolyline=rT.GetFirstHitPolyline(this.sourcePort.Location,this.ObstacleCalculator.RootOfTightHierarchy),this.sourcePort instanceof ta?(this.alreadyAddedOrExcludedPolylines.add(this.SourceLoosePolyline),this.StartPointOfEdgeRouting=this.SourcePort.Location):this.StartPointOfEdgeRouting=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.SourcePort.Curve,this.sourcePort.Parameter,this.SourceLoosePolyline))}run(){this.CalculateWholeTangentVisibilityGraph()}CalculateWholeTangentVisibilityGraph(){this.VisibilityGraph=new tT,this.CalculateWholeVisibilityGraphOnExistingGraph()}CalculateWholeVisibilityGraphOnExistingGraph(){let e;for(let e of(this.activePolygons=Array.from(this.AllPolygons()),this.ObstacleCalculator.LooseObstacles))this.VisibilityGraph.AddHole(e);(e=this.UseSpanner?new tU(this.ObstacleCalculator.LooseObstacles,this.VisibilityGraph):new ry([],this.activePolygons,this.visibilityGraph)).run()}RouteSplineFromPortToPortWhenTheWholeGraphIsReady(e,t,r,i){let n=e instanceof ta&&t instanceof tH||e instanceof tz;if(n){let r=e;e=t,t=r}this.sourcePort=e,this.targetPort=t,this.FigureOutSourceTargetPolylinesAndActiveRectangle();let s=this.GetEdgeGeomByRouting(r,i);return null==s?null:(this.targetVV=null,this.sourceVV=null,n&&(s=s.reverse()),s)}GetEdgeGeomByRouting(e,t){let r;if(this.sourceIsInsideOfTargetTightPolyline=null==this.TargetTightPolyline||C.PointRelativeToCurveLocation(this.sourcePort.Location,this.TargetTightPolyline)===el.Inside,this.sourcePort instanceof tH){let t=this.sourcePort;this.StartPointOfEdgeRouting=this.targetIsInsideOfSourceTightPolyline?t.Location:this.TakeBoundaryPortOutsideOfItsLoosePolyline(t.Curve,t.Parameter,this.SourceLoosePolyline),this.CalculateSourcePortVisibilityGraph();let i={smoothedPolyline:null};r=this.targetPort instanceof tH?this.RouteFromBoundaryPortToBoundaryPort(e,i):this.RouteFromBoundaryPortToFloatingPort(this.targetLoosePolyline,e,i)}else this.targetPort instanceof ta?(this.ExtendVisibilityGraphFromFloatingSourcePort(),r=this.RouteFromFloatingPortToFloatingPort(this.targetLoosePolyline,e,t)):r=this.RouteFromFloatingPortToAnywherePort(this.targetPort.LoosePolyline,e,t,this.targetPort);return r}RouteFromFloatingPortToAnywherePort(e,t,r,i){return i.Curve.boundingBox.contains(this.sourcePort.Location)?(this.sourceVV=this.GetVertex(this.sourcePort.Location),this._polyline=this.GetShortestPolylineToMulitpleTargets(this.sourceVV,Array.from(this.Targets(e))),null==this._polyline)?null:(this.FixLastPolylinePointForAnywherePort(i),i.HookSize>0&&this.BuildHook(i),this.SmoothCornersAndReturnCurve(t,r)):(r.smoothedPolyline=null,null)}BuildHook(e){let t=e.Curve,r=T.mkFullEllipseNNP(e.HookSize,e.HookSize,this._polyline.end),i=C.getAllIntersections(t,r,!0);g.getTriangleOrientation(i[0].x,this._polyline.end,this._polyline.endPoint.prev.point)==eo.Counterclockwise&&i.reverse();let n=this._polyline.end.sub(this._polyline.endPoint.prev.point).normalize(),s=t.derivative(i[0].par0).normalize(),o=s.dot(n);if(.2>Math.abs(o))this.ExtendPolyline(s,i[0],n,e);else{let r=t.derivative(i[1].par0).normalize();r.dot(n)<o?this.ExtendPolyline(r,i[1],n,e):this.ExtendPolyline(s,i[0],n,e)}}ExtendPolyline(e,t,r,i){let n,s=e.rotate(Math.PI/2);0>s.dot(r)&&(s=s.neg());let o=t.x.add(s.mul(i.HookSize));if(!!(n=g.lineLineIntersection(o,o.add(e),this._polyline.end,this._polyline.end.add(r))))this._polyline.addPoint(n),this._polyline.addPoint(o),this._polyline.addPoint(t.x)}FixLastPolylinePointForAnywherePort(e){for(;;){let t=this.GetLastPointInsideOfCurveOnPolyline(e.Curve);t.next.next=null,this._polyline.endPoint=t.next;let r=t.next.point.sub(t.point),i=(r=r.normalize().mul(e.Curve.boundingBox.diagonal)).rotate(-1*e.AdjustmentAngle),n=r.rotate(e.AdjustmentAngle),s=C.intersectionOne(e.Curve,b.mkPP(t.point,t.point.add(i)),!0),o=C.intersectionOne(e.Curve,b.mkPP(t.point,t.point.add(n)),!0);if(null==s||null==o)return;let a=rT.GetTrimmedCurveForHookingUpAnywhere(e.Curve,t,s,o),l=a.value(a.closestParameter(t.point));if(!this.LineAvoidsTightHierarchyLPP(b.mkPP(t.point,l),this.SourceTightPolyline,null)){let r=C.intersectionOne(e.Curve,b.mkPP(t.point,t.next.point),!1);if(null==r)return;this._polyline.endPoint.point=r.x;break}if(this._polyline.endPoint.point=l,null==t.prev||!this.TryShortcutPolyPoint(t.prev))break}}static GetTrimmedCurveForHookingUpAnywhere(e,t,r,i){let n,s,o;let a=g.getTriangleOrientation(i.x,r.x,t.point)===eo.Clockwise,l=r.par0,h=i.par0;if(a)return l<h?e.trim(l,h):(s=e.trim(l,e.parEnd),n=e.trim(e.parStart,h),(o=new C).addSegs([s,n]));return h<l?e.trim(h,l):(s=e.trim(h,e.parEnd),n=e.trim(e.parStart,l),(o=new C).addSegs([s,n]))}GetLastPointInsideOfCurveOnPolyline(e){for(let t=this._polyline.endPoint.prev;null!=t;t=t.prev)if(null==t.prev||C.PointRelativeToCurveLocation(t.point,e)===el.Inside)return t;throw Error()}GetShortestPolylineToMulitpleTargets(e,t){this.CleanTheGraphForShortestPath();let r=new rf(e,t,this.VisibilityGraph).GetPath();if(null==r)return null;let i=new A;for(let e of r)i.addPoint(e.point);return i.RemoveCollinearVertices()}Targets(e){return Array.from(e).map(e=>this.visibilityGraph.FindVertex(e))}ExtendVisibilityGraphFromFloatingSourcePort(){let e=this.sourcePort;this.StartPointOfEdgeRouting=e.Location,this.UseSpanner?this.sourceVV=this.AddTransientVisibilityEdgesForPort(this.sourcePort.Location,this.SourceLoosePolyline):this.sourceVV=rw.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()).filter(e=>e!==this.SourceLoosePolyline),this.VisibilityGraph,this.StartPointOfEdgeRouting,ep.Tangent)}FigureOutSourceTargetPolylinesAndActiveRectangle(){let e=this.sourcePort.Curve.value(this.sourcePort.Curve.parStart);this._sourceTightPolyline=rT.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfTightHierarchy),this.SourceLoosePolyline=rT.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy),e=this.targetPort.Curve.value(this.targetPort.Curve.parStart),this.targetTightPolyline=rT.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfTightHierarchy),this.targetLoosePolyline=rT.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy),this.activeRectangle=M.mkPP(new g(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),new g(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY))}*AllPolygons(){for(let e of this.ObstacleCalculator.LooseObstacles)yield new ra(e)}GetVisibilityGraph(){return this.VisibilityGraph}AddActivePolygons(e){eB(this.activePolygons,e)}ClearActivePolygons(){this.activePolygons=[]}}class rP{toJSON(){let e="{";return this.tipPosition&&(e+='"tipPosition": '+this.tipPosition.toJSON()),e+="}"}clone(){let e=new rP;return e.length=this.length,e.width=this.width,e.tipPosition=this.tipPosition,e}constructor(){this.length=rP.defaultArrowheadLength,this.width=0,this.length=rP.defaultArrowheadLength}static calculateArrowheads(e){if(null==e.sourceArrowhead&&null==e.targetArrowhead)return!0;let t=rP.findTrimStartForArrowheadAtSource(e);if(null==t)return!1;let r=rP.findTrimEndForArrowheadAtTarget(e);if(null==r||t>r-l.intersectionEpsilon||C.closeIntersectionPoints(e.curve.value(t),e.curve.value(r)))return!1;let i=e.curve.trim(t,r);return null!=i&&(null!=e.sourceArrowhead&&(e.sourceArrowhead.tipPosition=e.curve.start),null!=e.targetArrowhead&&(e.targetArrowhead.tipPosition=e.curve.end),e.curve=i,!0)}static getIntersectionsWithArrowheadCircle(e,t,r){let i=T.mkFullEllipseNNP(t,t,r);return C.getAllIntersections(i,e,!0)}static findTrimEndForArrowheadAtTarget(e){let t,r;let i=l.distanceEpsilon*l.distanceEpsilon,n=e.curve.parEnd;if(null==e.targetArrowhead||e.targetArrowhead.length<=l.distanceEpsilon)return n;let s=e.curve,o=e.targetArrowhead.length,a=10;do{if(0==--a)return;n=0!==(r=rP.getIntersectionsWithArrowheadCircle(s,o,s.end)).length?Math.max(...r.map(e=>e.par1)):s.parEnd,t=e.curve.value(n),o/=2}while(t.sub(s.start).lengthSquared<i||0===r.length);return n}static findTrimStartForArrowheadAtSource(e){let t,r;if(null==e.sourceArrowhead||e.sourceArrowhead.length<=l.distanceEpsilon)return e.curve.parStart;let i=l.distanceEpsilon*l.distanceEpsilon,n=e.sourceArrowhead.length,s=e.curve,o=10;for(;--o>0;){if(0===(t=rP.getIntersectionsWithArrowheadCircle(s,n,s.start)).length)return s.parStart;if(r=Math.min(...t.map(e=>e.par1)),t.filter(e=>e.par1===r)[0].x.sub(s.end).lengthSquared>=i)return r;n/=2}}static trimSplineAndCalculateArrowheads(e,t,r){return rP.trimSplineAndCalculateArrowheadsII(e,e.source.boundaryCurve,e.target.boundaryCurve,t,r)}static trimSplineAndCalculateArrowheadsII(e,t,r,i,n){if(e.curve=C.trimEdgeSplineWithNodeBoundaries(t,r,i,n),null==e.curve)return!1;if((null==e.sourceArrowhead||e.sourceArrowhead.length<l.distanceEpsilon)&&(null==e.targetArrowhead||e.targetArrowhead.length<l.distanceEpsilon))return!0;let s=!1,o=null!=e.sourceArrowhead?e.sourceArrowhead.length:0,a=null!=e.targetArrowhead?e.targetArrowhead.length:0,h=e.curve.end.sub(e.curve.start).length;null!=e.sourceArrowhead&&(e.sourceArrowhead.length=Math.min(h,o)),null!=e.targetArrowhead&&(e.targetArrowhead.length=Math.min(h,a));let u=10;for(;(null!=e.sourceArrowhead&&e.sourceArrowhead.length>l.intersectionEpsilon||null!=e.targetArrowhead&&e.targetArrowhead.length>l.intersectionEpsilon)&&!s&&(!(s=rP.calculateArrowheads(e))&&(null!=e.sourceArrowhead&&(e.sourceArrowhead.length*=.5),null!=e.targetArrowhead&&(e.targetArrowhead.length*=.5)),0!=--u););return!s&&(null!=e.sourceArrowhead&&(e.sourceArrowhead.tipPosition=i.start),null!=e.targetArrowhead&&(e.targetArrowhead.tipPosition=i.end)),null!=e.sourceArrowhead&&(e.sourceArrowhead.length=o),null!=e.targetArrowhead&&(e.targetArrowhead.length=a),s}static createBigEnoughSpline(e){let t;let r=e.source.center,i=e.target.center,n=i.sub(r);n.length<.001?(t=new g(1,0),i=r.add(t.rotate(Math.PI/2))):t=n.rotate(Math.PI/2);let s=1;null!=e.sourceArrowhead&&(s+=e.sourceArrowhead.length),null!=e.targetArrowhead&&(s+=e.targetArrowhead.length),t=t.normalize().mul(1.5*s);for(let n=1;n<1e4;n*=2){let s=C.createBezierSegN(r,i,t,n);if(rP.trimSplineAndCalculateArrowheadsII(e,e.source.boundaryCurve,e.target.boundaryCurve,s,!1))return}rP.createEdgeCurveWithNoTrimming(e,r,i)}static createEdgeCurveWithNoTrimming(e,t,r){let i=r.sub(t).normalize(),n=t,s=r,o=e.targetArrowhead;null!=o&&(o.tipPosition=r,s=r.sub(i.mul(o.length)));let a=e.sourceArrowhead;null!=a&&(a.tipPosition=t,n=t.add(i.mul(a.length))),e.curve=b.mkPP(n,s)}}rP.defaultArrowheadLength=5;class rE{constructor(){this.m=new Map}clear(){this.m.clear()}get size(){return this.m.size}set(e,t){this.m.set(rA(e),t)}delete(e){this.m.delete(rA(e))}has(e){return this.m.has(rA(e))}getPP(e,t){return this.get(new ek(e,t))}get(e){return this.m.get(rA(e))}*keys(){for(let e of this.m.keys()){let t=rC(e);yield t}}*[Symbol.iterator](){for(let[e,t]of this.m)yield[rC(e),t]}*values(){yield*this.m.values()}}function rC(e){let t=e.split(" "),r=t[0],i=t[1],n=r.split(","),s=new g(Number(n[0]),Number(n[1]));return new ek(s,new g(Number((n=i.split(","))[0]),Number(n[1])))}function rA(e){var t,r;return t=e.first,r=e.second,[rI(t),rI(r)].sort().join(" ")}function rI(e){return e.x.toString()+","+e.y.toString()}class rM{static GetShapes(e,t=Array.from(e.shallowEdges)){let r=new Map;for(let i of(function e(t,r){for(let i of t.shallowNodes)if(i instanceof ti){let t=rM.CreateShapeWithClusterBoundaryPort(i);r.set(i,t);if(!i.isCollapsed)for(let n of(e(i,r),i.shallowNodes))t.AddChild(r.get(n))}else r.set(i,rM.CreateShapeWithCenterPort(i))}(e,r),t)){let e=r.get(i.source);e&&null!=i.sourcePort&&e.Ports.add(i.sourcePort),(e=r.get(i.target))&&null!=i.targetPort&&e.Ports.add(i.targetPort)}return Array.from(r.values())}static CreateShapeWithCenterPort(e){let t=new tq(e),r=tl.mk(()=>e.boundaryCurve,()=>e.center);for(let i of(t.Ports.add(r),e.inEdges()))rM.FixPortAtTarget(r,i);for(let t of e.outEdges())rM.FixPortAtSource(r,t);for(let t of e.selfEdges())rM.FixPortAtSource(r,t),rM.FixPortAtTarget(r,t);return t}static CreateShapeWithClusterBoundaryPort(e){let t,r=new tq(e),i=tj.mk(()=>e.boundaryCurve,()=>e.center);r.Ports.add(i);for(let r of e.inEdges())r.EdgeToAncestor()===ec.ToAncestor?(null==t&&(t=new tz(()=>e.boundaryCurve)),r.targetPort=t):rM.FixPortAtTarget(i,r);for(let r of e.outEdges())r.EdgeToAncestor()===ec.FromAncestor?(null==t&&(t=new tz(()=>e.boundaryCurve)),r.sourcePort=t):rM.FixPortAtSource(i,r);for(let t of e.selfEdges())rM.FixPortAtSource(i,t),rM.FixPortAtTarget(i,t);return r}static FixPortAtSource(e,t){null!=t&&null==t.sourcePort&&(t.sourcePort=e)}static FixPortAtTarget(e,t){null!=t&&null==t.targetPort&&(t.targetPort=e)}}class rR{isEmpty(){if(0===this.arrayOfMaps.length)return!0;for(let e of this.arrayOfMaps)if(e.size>0)return!1;return!0}set(e,t,r){let i=this.arrayOfMaps[e];void 0===i&&(this.arrayOfMaps[e]=i=new Map),i.set(t,r)}setPair(e,t){this.set(e.x,e.y,t)}delete(e,t){if(e<0||e>=this.arrayOfMaps.length)return;let r=this.arrayOfMaps[e];void 0!==r&&(r.delete(t),0===r.size&&(this.arrayOfMaps[e]=void 0))}has(e,t){if(e<0||e>=this.arrayOfMaps.length)return!1;let r=this.arrayOfMaps[e];return void 0!==r&&r.has(t)}get(e,t){if(e<0||e>=this.arrayOfMaps.length)return null;let r=this.arrayOfMaps[e];return void 0===r?null:r.get(t)}getI(e){return this.get(e.x,e.y)}constructor(){this.arrayOfMaps=[]}*keys(){for(let e=0;e<this.arrayOfMaps.length;e++){let t=this.arrayOfMaps[e];if(void 0!==t)for(let r of t)yield new ri(e,r[0])}}*keyValues(){for(let e=0;e<this.arrayOfMaps.length;e++){let t=this.arrayOfMaps[e];if(void 0!==t)for(let r of t)yield[new ri(e,r[0]),r[1]]}}*values(){for(let e=0;e<this.arrayOfMaps.length;e++){let t=this.arrayOfMaps[e];if(void 0!==t)for(let e of t)yield e[1]}}get size(){let e=0;for(let t=0;t<this.arrayOfMaps.length;t++){let r=this.arrayOfMaps[t];void 0!==r&&(e+=r.size)}return e}}(W=eg||(eg={}))[W.NotVisited=0]="NotVisited",W[W.InStack=1]="InStack",W[W.Visited=2]="Visited";class rO{constructor(e,t){this.v=e,this.i=t}}class rk{static getFeedbackSetWithConstraints(e,t){throw Error("Method not implemented.")}static push(e,t,r,i){t[r]=eg.InStack,e.push(new rO(r,i))}static getFeedbackSet(e){let t=new rR;if(null==e||0===e.nodeCount)return[];let r=Array(e.nodeCount).fill(eg.NotVisited);for(let i=0;i<e.nodeCount;i++){if(r[i]===eg.Visited)continue;let n=new eE.Stack,s=0;for(rk.push(n,r,i,s);n.size>0;){let o=n.pop();r[i=o.v]=eg.Visited,s=o.i;let a=e.outEdges[i];for(;s<a.length;s++){let o=a[s];if(o.source===o.target)continue;let l=r[o.target];l===eg.InStack?t.set(o.source,o.target,o):l===eg.NotVisited&&(rk.push(n,r,i,s+1),i=o.target,r[o.target]=eg.Visited,a=e.outEdges[i],s=-1)}}}return Array.from(t.values())}}class rN{constructor(){this.isEmpty=!0}AddValue(e){this.isEmpty?(this.max=e,this.min=e,this.isEmpty=!1):e<this.min?this.min=e:e>this.max&&(this.max=e)}get length(){return this.max-this.min}static sign(e){return e>l.distanceEpsilon?1:e<-l.distanceEpsilon?-1:0}}class rL{SetActiveState(e,t){this.IsActive=e,this.VectorIndex=t,this.IsActive?(this.Left.ActiveConstraintCount++,this.Right.ActiveConstraintCount++):(this.Left.ActiveConstraintCount--,this.Right.ActiveConstraintCount--)}SetVectorIndex(e){this.VectorIndex=e}Reinitialize(){this.IsActive=!1,this.IsUnsatisfiable=!1,this.ClearDfDv()}UpdateGap(e){this.Gap=e}static constructorVVNB(e,t,r,i){let n=new rL(e);return n.Left=e,n.Right=t,n.Gap=r,n.IsEquality=i,n.Lagrangian=0,n.IsActive=!1,n}constructor(e){this.Right=e,this.Left=e}ToString(){return tb.String.format("  Cst: [{0}] [{1}] {2} {3:F5} vio {4:F5} Lm {5:F5}/{6:F5} {7}actv",this.Left,this.Right,this.IsEquality?"==":">=",this.Gap,this.Violation,this.Lagrangian,2*this.Lagrangian,this.IsActive?"+":this.IsUnsatisfiable?"!":"-")}get Violation(){return this.Left.ActualPos*this.Left.Scale+(this.Gap-this.Right.ActualPos*this.Right.Scale)}ClearDfDv(){this.Lagrangian=0}CompareTo(e){let t=this.Left.CompareTo(e.Left);return 0===t&&(t=this.Right.CompareTo(e.Right)),0===t&&(t=h(this.Gap,e.Gap)),t}}class rD{static constructorDCVV(e,t,r,i){let n=new rD(t);return n.Set(e,t,r,i),n}constructor(e){this.ConstraintToEval=e,this.Depth=-1}Set(e,t,r,i){return this.Parent=e,this.ConstraintToEval=t,this.VariableToEval=r,this.VariableDoneEval=i,this.Depth=0,this.ChildrenHaveBeenPushed=!1,t.Lagrangian=0,this}get IsLeftToRight(){return this.VariableToEval===this.ConstraintToEval.Right}toString(){return tb.String.format("{0} {1}{2} - {3}{4} ({5})","",this.IsLeftToRight?"":"*",this.ConstraintToEval.Left.Name,this.IsLeftToRight?"*":"",this.ConstraintToEval.Right.Name,this.Depth)}}class rB{constructor(e,t){this.Constraint=e,this.IsForward=t}}class rF{constructor(e,t){this.Variables=[],null!=e&&this.AddVariable(e),this.allConstraints=t}toString(){return tb.String.format("[Block: nvars = {0} refpos = {1:F5} scale = {2:F5}]",this.Variables.length,this.ReferencePos,this.Scale)}ComputeDfDv(e){this.allConstraints.DfDvStack=new eE.Stack;let t=new rL(e);this.dfDvDummyParentNode=new rD(t);let r=this.GetDfDvNode(this.dfDvDummyParentNode,t,e,null);for(this.allConstraints.DfDvStack.push(r);;){let e=this.allConstraints.DfDvStack.top,t=this.allConstraints.DfDvStack.length;if(!e.ChildrenHaveBeenPushed){for(let t of(e.ChildrenHaveBeenPushed=!0,e.VariableToEval.LeftConstraints))if(t.IsActive&&t.Right!==e.VariableDoneEval){let r=this.GetDfDvNode(e,t,t.Right,e.VariableToEval);1===t.Right.ActiveConstraintCount?this.ProcessDfDvLeafNodeDirectly(r):this.PushDfDvNode(r)}for(let t of e.VariableToEval.RightConstraints)if(t.IsActive&&t.Left!==e.VariableDoneEval){let r=this.GetDfDvNode(e,t,t.Left,e.VariableToEval);1===t.Left.ActiveConstraintCount?this.ProcessDfDvLeafNodeDirectly(r):this.PushDfDvNode(r)}if(this.allConstraints.DfDvStack.length>t)continue}if(this.allConstraints.DfDvStack.pop(),this.ProcessDfDvLeafNode(e),e===r)break}}ProcessDfDvLeafNode(e){let t=e.VariableToEval.DfDv;e.IsLeftToRight?(e.ConstraintToEval.Lagrangian=e.ConstraintToEval.Lagrangian+t,e.Parent.ConstraintToEval.Lagrangian=e.Parent.ConstraintToEval.Lagrangian+e.ConstraintToEval.Lagrangian):(e.ConstraintToEval.Lagrangian=-((e.ConstraintToEval.Lagrangian+t)*1),e.Parent.ConstraintToEval.Lagrangian=e.Parent.ConstraintToEval.Lagrangian-e.ConstraintToEval.Lagrangian),this.CheckForConstraintPathTarget(e),this.Debug_CheckForViolatedActiveConstraint(e.ConstraintToEval),this.allConstraints.RecycleDfDvNode(e)}Debug_CheckForViolatedActiveConstraint(e){e.Violation,this.allConstraints.SolverParameters.GapTolerance}ProcessDfDvLeafNodeDirectly(e){this.ProcessDfDvLeafNode(e)}GetDfDvNode(e,t,r,i){let n=this.allConstraints.DfDvRecycleStack.size>0?this.allConstraints.DfDvRecycleStack.pop().Set(e,t,r,i):rD.constructorDCVV(e,t,r,i);return n.Depth=n.Parent.Depth+1,this.allConstraints.MaxConstraintTreeDepth<n.Depth&&(this.allConstraints.MaxConstraintTreeDepth=n.Depth),n}PushDfDvNode(e){this.PushOnDfDvStack(e)}AddVariableAndPushDfDvNode(e,t){e.push(t.VariableToEval),this.PushOnDfDvStack(t)}PushOnDfDvStack(e){this.allConstraints.DfDvStack.push(e)}CheckForConstraintPathTarget(e){if(this.pathTargetVariable===e.VariableToEval){for(;e.Parent!==this.dfDvDummyParentNode;)this.constraintPath.push(new rB(e.ConstraintToEval,e.IsLeftToRight)),e=e.Parent;this.pathTargetVariable=null}}Expand(e){null==this.constraintPath&&(this.constraintPath=[]),this.constraintPath=[],this.pathTargetVariable=e.Right,this.ComputeDfDv(e.Left);let t=null;if(this.constraintPath.length>0){for(let e of this.constraintPath)e.IsForward&&(null==t||e.Constraint.Lagrangian<t.Lagrangian)&&!e.Constraint.IsEquality&&(t=e.Constraint);null!=t&&this.allConstraints.DeactivateConstraint(t)}if(this.constraintPath=[],this.pathTargetVariable=null,null==t){e.IsUnsatisfiable=!0,this.allConstraints.NumberOfUnsatisfiableConstraints++;return}let r=[];this.GetConnectedVariables(r,e.Right,e.Left);let i=e.Violation,n=r.length;for(let e=0;e<n;e++)r[e].OffsetInBlock=r[e].OffsetInBlock+i;this.allConstraints.ActivateConstraint(e),e.ClearDfDv(),this.UpdateReferencePos()}Split(e){if(e&&this.UpdateReferencePos(),this.Variables.length<2)return null;let t=null;this.ComputeDfDv(this.Variables[0]);let r=this.allConstraints.SolverParameters.Advanced.MinSplitLagrangianThreshold,i=this.Variables.length;for(let e=0;e<i;e++)for(let i of this.Variables[e].LeftConstraints)i.IsActive&&!i.IsEquality&&i.Lagrangian<r&&(t=i,r=i.Lagrangian);return null==t?null:this.SplitOnConstraint(t)}SplitOnConstraint(e){this.allConstraints.DeactivateConstraint(e);let t=new rF(null,this.allConstraints);return this.TransferConnectedVariables(t,e.Right,e.Left),t.Variables.length>0?(this.UpdateReferencePos(),t.UpdateReferencePos()):t=null,t}AddVariable(e){this.Variables.push(e),e.Block=this,1===this.Variables.length?(this.Scale=e.Scale,this.ReferencePos=e.ActualPos,this.sumAd=e.ActualPos*e.Weight,this.sumAb=0,this.sumA2=e.Weight,e.OffsetInBlock=0):this.AddVariableToBlockSums(e)}UpdateReferencePos(){this.Scale=this.Variables[0].Scale,this.sumAd=0,this.sumAb=0,this.sumA2=0;let e=this.Variables.length;for(let t=0;t<e;t++)this.AddVariableToBlockSums(this.Variables[t]);this.UpdateReferencePosFromSums()}AddVariableToBlockSums(e){let t=this.Scale/e.Scale,r=e.OffsetInBlock/e.Scale,i=t*e.Weight;this.sumAd+=i*e.DesiredPos,this.sumAb+=i*r,this.sumA2+=i*t}UpdateReferencePosFromSums(){if(!(Number.isFinite(this.sumAd)&&Number.isFinite(this.sumAb)&&Number.isFinite(this.sumA2)))throw Error("infinite numbers");this.ReferencePos=(this.sumAd-this.sumAb)/this.sumA2,this.UpdateVariablePositions()}UpdateVariablePositions(){let e=this.Scale*this.ReferencePos,t=this.Variables.length;for(let r=0;r<t;r++){let t=this.Variables[r];t.ActualPos=(e+t.OffsetInBlock)/t.Scale}}GetConnectedVariables(e,t,r){this.RecurseGetConnectedVariables(e,t,r)}RecurseGetConnectedVariables(e,t,r){this.allConstraints.DfDvStack=new eE.Stack;let i=new rL(t);for(this.dfDvDummyParentNode=new rD(i),this.allConstraints.DfDvStack.push(this.GetDfDvNode(this.dfDvDummyParentNode,i,t,r)),e.push(t);this.allConstraints.DfDvStack.length>0;){let t=this.allConstraints.DfDvStack.top,r=this.allConstraints.DfDvStack.length;if(!t.ChildrenHaveBeenPushed){for(let r of(t.ChildrenHaveBeenPushed=!0,t.VariableToEval.LeftConstraints))r.IsActive&&r.Right!==t.VariableDoneEval&&(1===r.Right.ActiveConstraintCount?e.push(r.Right):this.AddVariableAndPushDfDvNode(e,this.GetDfDvNode(t,r,r.Right,t.VariableToEval)));for(let r of t.VariableToEval.RightConstraints)r.IsActive&&r.Left!==t.VariableDoneEval&&(1===r.Left.ActiveConstraintCount?e.push(r.Left):this.AddVariableAndPushDfDvNode(e,this.GetDfDvNode(t,r,r.Left,t.VariableToEval)))}if(!(this.allConstraints.DfDvStack.length>r))this.allConstraints.RecycleDfDvNode(this.allConstraints.DfDvStack.pop())}}TransferConnectedVariables(e,t,r){this.GetConnectedVariables(e.Variables,t,r);let i=e.Variables.length;for(let t=0;t<i;t++)e.Variables[t].Block=e;let n=this.Variables.length-1;for(let t=this.Variables.length-1;t>=0;t--)this.Variables[t].Block===e&&(t<n&&(this.Variables[t]=this.Variables[n]),n--);if(this.Variables=this.Variables.slice(0,n+1),0===this.Variables.length){for(let t=0;t<i;t++){let r=e.Variables[t];this.Variables.push(r),r.Block=this}e.Variables=[]}}}class rV{get Count(){return this.Vector.length}item(e){return this.Vector[e]}constructor(){this.Vector=[]}Add(e){e.VectorIndex=this.Vector.length,this.Vector.push(e)}Remove(e){let t=this.Vector[this.Vector.length-1];this.Vector[e.VectorIndex]=t,t.VectorIndex=e.VectorIndex,this.Vector.pop()}toString(){return this.Vector.toString()}}class rG{constructor(){this.nextConstraintIndex=0,this.DfDvStack=new eE.Stack,this.DfDvRecycleStack=new eE.Stack}get IsEmpty(){return null==this.Vector}Create(e){this.Vector=Array(e),this.firstActiveConstraintIndex=e}Add(e){e.SetVectorIndex(this.nextConstraintIndex),this.Vector[this.nextConstraintIndex++]=e}ActivateConstraint(e){this.firstActiveConstraintIndex--,this.SwapConstraint(e)}DeactivateConstraint(e){this.SwapConstraint(e),this.firstActiveConstraintIndex++}SwapConstraint(e){let t=this.Vector[this.firstActiveConstraintIndex];t.SetVectorIndex(e.VectorIndex),this.Vector[e.VectorIndex]=t,this.Vector[this.firstActiveConstraintIndex]=e,e.SetActiveState(!e.IsActive,this.firstActiveConstraintIndex)}Reinitialize(){if(null!=this.Vector){for(let e of this.Vector)e.Reinitialize();this.firstActiveConstraintIndex=this.Vector.length}}RecycleDfDvNode(e){this.DfDvRecycleStack.length<1024&&this.DfDvRecycleStack.push(e)}toString(){return this.Vector.toString()}}class rU{constructor(){this.GapTolerance=1e-4,this.QpscConvergenceEpsilon=1e-5,this.QpscConvergenceQuotient=1e-6,this.OuterProjectIterationsLimit=-1,this.InnerProjectIterationsLimit=-1,this.TimeLimit=-1,this.Advanced=new rz}Clone(){let e=this.MemberwiseClone();return e.Advanced=this.Advanced.Clone(),e}MemberwiseClone(){let e=new rU;return e.GapTolerance=this.GapTolerance,e.QpscConvergenceEpsilon=this.QpscConvergenceEpsilon,e.QpscConvergenceQuotient=this.QpscConvergenceQuotient,e.OuterProjectIterationsLimit=this.OuterProjectIterationsLimit,e.InnerProjectIterationsLimit=this.InnerProjectIterationsLimit,e.TimeLimit=this.TimeLimit,e}}class rz{constructor(){this.ForceQpsc=!1,this.ScaleInQpsc=!0,this.MinSplitLagrangianThreshold=-1e-7,this.UseViolationCache=!0,this.ViolationCacheMinBlocksDivisor=10,this.ViolationCacheMinBlocksCount=100}Clone(){let e=new rz;return e.ForceQpsc=this.ForceQpsc,e.ScaleInQpsc=this.ScaleInQpsc,e.MinSplitLagrangianThreshold=this.MinSplitLagrangianThreshold,e.UseViolationCache=this.UseViolationCache,e.ViolationCacheMinBlocksDivisor=this.ViolationCacheMinBlocksDivisor,e.ViolationCacheMinBlocksCount=this.ViolationCacheMinBlocksCount,e}}class rj{constructor(e){this.Variable=e,this.OrigWeight=e.Weight,this.OrigScale=e.Scale,this.OrigDesiredPos=this.Variable.DesiredPos}}class rH{constructor(e,t){this.Value=e,this.Column=t}}class rW{constructor(e,t){this.newMatrixRow=[],this.previousFunctionValue=Number.MAX_VALUE,this.solverParameters=e,this.matrixQ=Array(t).fill(0),this.vectorWiDi=Array(t).fill(0),this.vectorQpscVars=Array(t).fill(0),this.gradientVector=Array(t).fill(0),this.vectorQg=Array(t).fill(0),this.vectorPrevY=Array(t).fill(0),this.vectorCurY=Array(t).fill(0)}AddVariable(e){if(this.isFirstProjectCall=!0,this.vectorWiDi[e.Ordinal]=-(2*(e.Weight*e.DesiredPos)*1),this.vectorPrevY[e.Ordinal]=e.Weight,null!=e.Neighbors)for(let t of e.Neighbors)this.vectorPrevY[e.Ordinal]=this.vectorPrevY[e.Ordinal]+t.Weight,this.vectorPrevY[t.Neighbor.Ordinal]=this.vectorPrevY[t.Neighbor.Ordinal]-t.Weight;for(let e=0;e<this.vectorPrevY.length;e++)0!==this.vectorPrevY[e]&&(this.newMatrixRow.push(new rH(2*this.vectorPrevY[e],e)),this.vectorPrevY[e]=0);this.matrixQ[e.Ordinal]=Array.from(this.newMatrixRow),this.newMatrixRow=[],this.vectorQpscVars[e.Ordinal]=new rj(e),e.Weight=1}VariablesComplete(){for(let e of this.vectorQpscVars){let t=e.Variable;for(let e of this.matrixQ[t.Ordinal])e.Column===t.Ordinal&&(this.solverParameters.Advanced.ScaleInQpsc&&(t.Scale=1/Math.sqrt(Math.abs(e.Value)),!Number.isFinite(t.Scale)&&(t.Scale=1),t.Scale,this.vectorWiDi[t.Ordinal]=this.vectorWiDi[t.Ordinal]*t.Scale),this.vectorCurY[t.Ordinal]=t.ActualPos,t.DesiredPos=t.ActualPos)}if(!!this.solverParameters.Advanced.ScaleInQpsc)for(let e=0;e<this.matrixQ.length;e++){let t=this.matrixQ[e];for(let r=0;r<t.length;r++)t[r].Column===e?t[r].Value=1:t[r].Value=t[r].Value*(this.vectorQpscVars[e].Variable.Scale*this.vectorQpscVars[t[r].Column].Variable.Scale)}}PreProject(){if(this.isFirstProjectCall)for(let e of this.vectorQpscVars)this.vectorCurY[e.Variable.Ordinal]=e.Variable.ActualPos;if(this.MatrixVectorMultiply(this.vectorCurY,this.gradientVector),this.HasConverged())return!1;rW.VectorVectorAdd(this.gradientVector,this.vectorWiDi,this.gradientVector);let e=rW.VectorVectorMultiply(this.gradientVector,this.gradientVector),t=0;if(0!==e&&(this.MatrixVectorMultiply(this.gradientVector,this.vectorQg),t=rW.VectorVectorMultiply(this.vectorQg,this.gradientVector)),0===t)return!1;let r=e/t;rW.VectorCopy(this.vectorPrevY,this.vectorCurY),rW.VectorScaledVectorSubtract(this.vectorPrevY,r,this.gradientVector,this.vectorCurY);for(let e=0;e<this.vectorCurY.length;e++)this.vectorQpscVars[e].Variable.DesiredPos=this.vectorCurY[e];return!0}PostProject(){for(let e of this.vectorQpscVars)this.vectorCurY[e.Variable.Ordinal]=e.Variable.ActualPos;rW.VectorVectorSubtract(this.vectorPrevY,this.vectorCurY,this.vectorCurY);let e=rW.VectorVectorMultiply(this.gradientVector,this.vectorCurY),t=0;if(0!==e){this.MatrixVectorMultiply(this.vectorCurY,this.vectorQg);let r=rW.VectorVectorMultiply(this.vectorQg,this.vectorCurY);(t=0===r?1:e/r)>1?t=1:t<0&&(t=0)}return rW.VectorScaledVectorSubtract(this.vectorPrevY,t,this.vectorCurY,this.vectorCurY),this.isFirstProjectCall=!1,t>0}QpscComplete(){for(let e of this.vectorQpscVars)e.Variable.Weight=e.OrigWeight,e.Variable.DesiredPos=e.OrigDesiredPos,this.solverParameters.Advanced.ScaleInQpsc&&(e.Variable.ActualPos=e.Variable.ActualPos*e.Variable.Scale,e.Variable.Scale=e.OrigScale);return this.previousFunctionValue}HasConverged(){let e=this.GetFunctionValue(this.vectorCurY),t=!1;if(!this.isFirstProjectCall){let r=this.previousFunctionValue-e,i=0;0!==r&&(i=Math.abs(r/(0!==this.previousFunctionValue?this.previousFunctionValue:e))),(Math.abs(r)<this.solverParameters.QpscConvergenceEpsilon||Math.abs(i)<this.solverParameters.QpscConvergenceQuotient)&&(t=!0)}return this.previousFunctionValue=e,t}GetFunctionValue(e){return rW.VectorVectorMultiply(this.gradientVector,e)/2+rW.VectorVectorMultiply(this.vectorWiDi,e)}static VectorVectorMultiply(e,t){let r=0;for(let i=0;i<e.length;i++)r+=e[i]*t[i];return r}MatrixVectorMultiply(e,t){let r=0;for(let i of this.matrixQ){let n=0;for(let t of i)n+=t.Value*e[t.Column];t[r++]=n}}static VectorVectorAdd(e,t,r){for(let i=0;i<e.length;i++)r[i]=e[i]+t[i]}static VectorVectorSubtract(e,t,r){for(let i=0;i<e.length;i++)r[i]=e[i]-t[i]}static VectorScaledVectorSubtract(e,t,r,i){for(let n=0;n<e.length;n++)i[n]=e[n]-t*r[n]}static VectorCopy(e,t){for(let r=0;r<t.length;r++)e[r]=t[r]}}class rq{constructor(){this.NumberOfUnsatisfiableConstraints=0,this.OuterProjectIterations=0,this.InnerProjectIterationsTotal=0,this.MinInnerProjectIterations=0,this.MaxInnerProjectIterations=0,this.MaxConstraintTreeDepth=0,this.GoalFunctionValue=0,this.TimeLimitExceeded=!1,this.OuterProjectIterationsLimitExceeded=!1,this.InnerProjectIterationsLimitExceeded=!1}get ExecutionLimitExceeded(){return this.TimeLimitExceeded||this.OuterProjectIterationsLimitExceeded||this.InnerProjectIterationsLimitExceeded}Clone(){let e=new rq;return e.GoalFunctionValue=this.GoalFunctionValue,e.InnerProjectIterationsLimitExceeded=this.InnerProjectIterationsLimitExceeded,e.InnerProjectIterationsTotal=this.InnerProjectIterationsTotal,e.MaxConstraintTreeDepth=this.MaxConstraintTreeDepth,e.OuterProjectIterations=this.OuterProjectIterations,e.OuterProjectIterationsLimitExceeded=this.OuterProjectIterationsLimitExceeded,e.AlgorithmUsed=this.AlgorithmUsed,e.NumberOfUnsatisfiableConstraints=this.NumberOfUnsatisfiableConstraints,e.MaxInnerProjectIterations=this.MaxInnerProjectIterations,e}}(q=em||(em={}))[q.ProjectOnly=0]="ProjectOnly",q[q.QpscWithScaling=1]="QpscWithScaling",q[q.QpscWithoutScaling=2]="QpscWithoutScaling";class rX{constructor(e,t){this.Neighbor=e,this.Weight=t}}class r${get DfDv(){return 2*(this.Weight*(this.ActualPos-this.DesiredPos))/this.Scale}constructor(e,t,r,i,n){if(this.ActiveConstraintCount=0,i<=0)throw Error("weight");if(n<=0)throw Error("scale");let s=r*i;if(!Number.isFinite(s)||Number.isNaN(s)||!Number.isFinite(s=r*n)||Number.isNaN(s))throw Error("desiredPos");this.Ordinal=e,this.UserData=t,this.DesiredPos=r,this.Weight=i,this.Scale=n,this.OffsetInBlock=0,this.ActualPos=this.DesiredPos}Reinitialize(){this.ActiveConstraintCount=0,this.OffsetInBlock=0,this.ActualPos=this.DesiredPos}AddNeighbor(e,t){null==this.Neighbors&&(this.Neighbors=[]),this.Neighbors.push(new rX(e,t))}toString(){return tb.String.format("{0} {1:F5} ({2:F5}) {3:F5} {4:F5}",this.Name,this.ActualPos,this.DesiredPos,this.Weight,this.Scale)}get Name(){return null==this.UserData?"-0-":this.UserData.toString()}SetConstraints(e,t){this.LeftConstraints=e,this.RightConstraints=t}CompareTo(e){return h(this.Ordinal,e.Ordinal)}}class rY{get IsFull(){return this.numConstraints===rY.MaxConstraints}Clear(){this.LowViolation=0,this.numConstraints=0,!this.constraints&&(this.constraints=Array(rY.MaxConstraints))}FilterBlock(e){this.LowViolation=Number.MAX_VALUE;let t=this.numConstraints>0;for(let t=this.numConstraints-1;t>=0;t--){let r=this.constraints[t];if(r.Left.Block===e||r.Right.Block===e||r.IsActive||r.IsUnsatisfiable)t<this.numConstraints-1&&(this.constraints[t]=this.constraints[this.numConstraints-1]),this.numConstraints--;else{let e=r.Left.ActualPos*r.Left.Scale+(r.Gap-r.Right.ActualPos*r.Right.Scale);e<this.LowViolation&&(this.LowViolation=e)}}return 0===this.numConstraints&&(this.LowViolation=0),t}FindIfGreater(e){let t=null;for(let r=0;r<this.numConstraints;r++){let i=this.constraints[r],n=i.Left.ActualPos*i.Left.Scale+(i.Gap-i.Right.ActualPos*i.Right.Scale);n>e&&(e=n,t=i)}return t}Insert(e,t){let r=0,i=t,n=t;for(let e=0;e<this.numConstraints;e++){let t=this.constraints[e],s=t.Left.ActualPos*t.Left.Scale+(t.Gap-t.Right.ActualPos*t.Right.Scale);s<i?(n=i,r=e,i=s):s<n&&(n=s)}this.IsFull?(this.constraints[r]=e,this.LowViolation=n):(this.constraints[this.numConstraints++]=e,this.IsFull&&(this.LowViolation=i))}}rY.MaxConstraints=20;class rZ{constructor(e,t){this.NumberOfLeftConstraints=0,this.Constraints=e,this.NumberOfLeftConstraints=t}}class rK{constructor(){this.allBlocks=new rV,this.allConstraints=new rG,this.numberOfConstraints=0,this.numberOfVariables=0,this.equalityConstraints=[],this.loadedVariablesAndConstraintLists=new Map,this.emptyConstraintList=[],this.updatedConstraints=[],this.violationCache=new rY,this.violationCacheMinBlockCutoff=0,this.nextVariableOrdinal=0,this.solverParams=new rU,this.solverSolution=new rq}get IsQpsc(){return this.hasNeighbourPairs||this.solverParams.Advanced.ForceQpsc}AddVariableAN(e,t){return this.AddVariableANNN(e,t,1,1)}AddVariableANN(e,t,r){return this.AddVariableANNN(e,t,r,1)}AddVariableANNN(e,t,r,i){if(!this.allConstraints.IsEmpty)throw Error("Cannot add Variables or Constraints once Solve() has been called");let n=new r$(this.nextVariableOrdinal++,e,t,r,i),s=new rF(n,this.allConstraints);return n.Block=s,this.allBlocks.Add(s),this.numberOfVariables++,this.loadedVariablesAndConstraintLists.set(n,new rZ([],0)),n}UpdateVariables(){for(let e of this.allBlocks.Vector)e.UpdateReferencePos()}get Variables(){return eU(this.allBlocks.Vector,e=>e.Variables)}get VariableCount(){return this.numberOfVariables}*Constraints(){if(this.allConstraints.IsEmpty)for(let e of this.loadedVariablesAndConstraintLists.keys()){let t=this.loadedVariablesAndConstraintLists.get(e);if(null!=t.Constraints){let r=t.Constraints.length;for(let i=0;i<r;i++){let r=t.Constraints[i];if(e===r.Left)return yield,r}}}else for(let e of this.allConstraints.Vector)yield e}get ConstraintCount(){return this.numberOfConstraints}AddEqualityConstraint(e,t,r){return this.AddConstraintVVNB(e,t,r,!0)}AddConstraintVVNB(e,t,r,i){if(!this.allConstraints.IsEmpty)throw Error("Cannot add Variables or Constraints once Solve() has been called");if(e===t)throw Error("Cannot add a constraint between a variable and itself");let n=this.loadedVariablesAndConstraintLists.get(e),s=this.loadedVariablesAndConstraintLists.get(t),o=rL.constructorVVNB(e,t,r,i);return this.loadedVariablesAndConstraintLists.set(e,new rZ(n.Constraints,n.NumberOfLeftConstraints+1)),n.Constraints.push(o),s.Constraints.push(o),this.numberOfConstraints++,i&&this.equalityConstraints.push(o),o}AddConstraint(e,t,r){return this.AddConstraintVVNB(e,t,r,!1)}SetConstraintUpdate(e,t){t!==e.Gap&&this.updatedConstraints.push([e,t])}AddNeighborPair(e,t,r){if(r<=0||Number.isNaN(r)||!Number.isFinite(r))throw Error("relationshipWeight");if(e===t)throw Error();e.AddNeighbor(t,r),t.AddNeighbor(e,r),this.hasNeighbourPairs=!0}Solve(){return this.SolvePar(null)}SolvePar(e){e&&(this.solverParams=e.Clone()),this.solverParams.OuterProjectIterationsLimit<0&&(this.solverParams.OuterProjectIterationsLimit=100*(Math.floor(Math.log2(this.numberOfVariables))+1)),this.solverParams.InnerProjectIterationsLimit<0&&(this.solverParams.InnerProjectIterationsLimit=2*this.numberOfConstraints+100*(Math.max(0,Math.floor(Math.log2(this.numberOfConstraints)))+1));let t=!this.allConstraints.IsEmpty;if(this.CheckForUpdatedConstraints(),this.solverSolution=new rq,this.solverSolution.MinInnerProjectIterations=Number.MAX_VALUE,this.allConstraints.MaxConstraintTreeDepth=0,this.allConstraints.SolverParameters=this.solverParams,0===this.numberOfConstraints){if(!this.IsQpsc)return this.solverSolution.Clone()}else!t&&this.SetupConstraints();return this.allConstraints.NumberOfUnsatisfiableConstraints=0,this.MergeEqualityConstraints(),this.IsQpsc?this.SolveQpsc():(this.SolveByStandaloneProject(),this.CalculateStandaloneProjectGoalFunctionValue()),this.solverSolution.MinInnerProjectIterations>this.solverSolution.MaxInnerProjectIterations&&(this.solverSolution.MinInnerProjectIterations=this.solverSolution.MaxInnerProjectIterations),this.solverSolution.NumberOfUnsatisfiableConstraints=this.allConstraints.NumberOfUnsatisfiableConstraints,this.solverSolution.MaxConstraintTreeDepth=this.allConstraints.MaxConstraintTreeDepth,this.solverSolution.Clone()}CheckForUpdatedConstraints(){if(0===this.updatedConstraints.length)return;let e=this.IsQpsc;for(let[t,r]of this.updatedConstraints){if(t.UpdateGap(r),!e&&!t.IsEquality){this.SplitOnConstraintIfActive(t);continue}e=!0}this.updatedConstraints=[],e&&this.ReinitializeBlocks()}SplitOnConstraintIfActive(e){if(e.IsActive){let t=e.Left.Block.SplitOnConstraint(e);null!=t&&this.allBlocks.Add(t)}}SetupConstraints(){for(let e of(this.allConstraints.Create(this.numberOfConstraints),this.loadedVariablesAndConstraintLists.keys())){let t=this.loadedVariablesAndConstraintLists.get(e),r=t.Constraints,i=0,n=0,s=0;null!=r&&(i=r.length,s=i-(n=t.NumberOfLeftConstraints));let o=this.emptyConstraintList;0!==n&&(o=Array(n));let a=this.emptyConstraintList;0!==s&&(a=Array(s)),e.SetConstraints(o,a);let l=0,h=0;for(let t=0;t<i;t++){let i=r[t];e===i.Left?o[l++]=i:a[h++]=i}for(let t of e.LeftConstraints)this.allConstraints.Add(t)}this.loadedVariablesAndConstraintLists.clear(),this.violationCacheMinBlockCutoff=Number.MAX_VALUE,this.solverParams.Advanced.UseViolationCache&&this.solverParams.Advanced.ViolationCacheMinBlocksDivisor>0&&(this.violationCacheMinBlockCutoff=Math.min(this.allBlocks.Count/this.solverParams.Advanced.ViolationCacheMinBlocksDivisor,this.solverParams.Advanced.ViolationCacheMinBlocksCount))}SolveByStandaloneProject(){for(;;){if(!this.RunProject())return;if(!this.SplitBlocks())break}}RunProject(){return this.solverSolution.OuterProjectIterations++,this.Project(),!this.CheckForLimitsExceeded()}CheckForLimitsExceeded(){return this.solverParams.OuterProjectIterationsLimit>0&&this.solverSolution.OuterProjectIterations>=this.solverParams.OuterProjectIterationsLimit?(this.solverSolution.OuterProjectIterationsLimitExceeded=!0,!0):!!this.solverSolution.InnerProjectIterationsLimitExceeded||!1}CalculateStandaloneProjectGoalFunctionValue(){this.solverSolution.GoalFunctionValue=0;let e=this.allBlocks.Count;for(let t=0;t<e;t++){let e=this.allBlocks.item(t),r=e.Variables.length;for(let t=0;t<r;t++){let r=e.Variables[t];this.solverSolution.GoalFunctionValue+=r.Weight*(r.ActualPos*r.ActualPos),this.solverSolution.GoalFunctionValue-=2*(r.Weight*(r.DesiredPos*r.ActualPos))}}}SolveQpsc(){if(this.solverSolution.AlgorithmUsed=this.solverParams.Advanced.ScaleInQpsc?em.QpscWithScaling:em.QpscWithoutScaling,!this.QpscMakeFeasible())return;let e=new rW(this.solverParams,this.numberOfVariables);for(let t of this.allBlocks.Vector)for(let r of t.Variables)e.AddVariable(r);e.VariablesComplete(),this.ReinitializeBlocks(),this.MergeEqualityConstraints();let t=!1;for(;e.PreProject()||t;){;if(t=this.SplitBlocks(),!this.RunProject()||!e.PostProject()&&!t)break}this.solverSolution.GoalFunctionValue=e.QpscComplete()}QpscMakeFeasible(){return this.RunProject()}ReinitializeBlocks(){let e=Array.from(this.allBlocks.Vector);for(let t of(this.allBlocks.Vector=[],e))for(let e of t.Variables){e.Reinitialize();let t=new rF(e,this.allConstraints);this.allBlocks.Add(t)}this.allConstraints.Reinitialize(),this.violationCache.Clear()}MergeEqualityConstraints(){for(let e of this.equalityConstraints){if(e.Left.Block===e.Right.Block){Math.abs(e.Violation)>this.solverParams.GapTolerance&&(e.IsUnsatisfiable=!0,this.allConstraints.NumberOfUnsatisfiableConstraints++);continue}this.MergeBlocks(e)}}Project(){if(0===this.numberOfConstraints)return!1;this.violationCache.Clear(),this.lastModifiedBlock=null;let e=this.allBlocks.Count>this.violationCacheMinBlockCutoff,t=1,r=this.GetMaxViolatedConstraint({maxViolation:0},e);if(!r)return!1;for(;r;){if(r.Left.Block===r.Right.Block?(r.Left.Block.Expand(r),r.IsUnsatisfiable&&this.violationCache.Clear(),this.lastModifiedBlock=r.Left.Block):this.lastModifiedBlock=this.MergeBlocks(r),this.solverParams.InnerProjectIterationsLimit>0&&t>=this.solverParams.InnerProjectIterationsLimit){this.solverSolution.InnerProjectIterationsLimitExceeded=!0;break}!(e=this.allBlocks.Count>this.violationCacheMinBlockCutoff)&&this.violationCache.Clear(),t++;let i={maxViolation:0};r=this.GetMaxViolatedConstraint(i,e)}return this.solverSolution.InnerProjectIterationsTotal=this.solverSolution.InnerProjectIterationsTotal+t,this.solverSolution.MaxInnerProjectIterations<t&&(this.solverSolution.MaxInnerProjectIterations=t),this.solverSolution.MinInnerProjectIterations>t&&(this.solverSolution.MinInnerProjectIterations=t),!0}MergeBlocks(e){let t=e.Left.Block,r=e.Right.Block,i=e.Left.OffsetInBlock+(e.Gap-e.Right.OffsetInBlock);r.Variables.length>t.Variables.length&&(t=e.Right.Block,r=e.Left.Block,i=-i);let n=r.Variables.length;for(let e=0;e<n;e++){let n=r.Variables[e];n.OffsetInBlock+=i,t.AddVariable(n)}return t.UpdateReferencePosFromSums(),this.allConstraints.ActivateConstraint(e),this.allBlocks.Remove(r),t}SplitBlocks(){let e=[],t=this.allBlocks.Count;for(let r=0;r<t;r++){let t=this.allBlocks.item(r).Split(this.IsQpsc);null!=t&&e.push(t)}let r=e.length;for(let t=0;t<r;t++){let r=e[t];this.allBlocks.Add(r)}return 0!==e.length}GetMaxViolatedConstraint(e,t){e.maxViolation=this.solverParams.GapTolerance;let r=this.SearchViolationCache(e.maxViolation);return null!=r?r:this.SearchAllConstraints(e.maxViolation,t)}SearchViolationCache(e){let t=null;if(null==this.lastModifiedBlock)return;this.lastModifiedBlock.Variables.length<this.numberOfVariables+1&&this.violationCache.FilterBlock(this.lastModifiedBlock);let r=this.lastModifiedBlock.Variables.length;for(let i=0;i<r;i++){let r=this.lastModifiedBlock.Variables[i];for(let i of r.LeftConstraints)if(!i.IsActive&&!i.IsUnsatisfiable){if(f(i.Left.ActualPos*i.Left.Scale+(i.Gap-i.Right.ActualPos*i.Right.Scale),e)>0)null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),e=i.Violation,t=i}for(let i of r.RightConstraints)if(!i.IsActive&&!i.IsUnsatisfiable&&i.Left.Block!==this.lastModifiedBlock){let r=i.Left.ActualPos*i.Left.Scale+(i.Gap-i.Right.ActualPos*i.Right.Scale);if(f(r,e)>0)null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),e=r,t=i}}let i=this.violationCache.FindIfGreater(e);return null!=i&&(null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),t=i),t}SearchAllConstraints(e,t){let r=null;for(let i of(this.violationCache.Clear(),this.allConstraints.Vector)){if(i.IsActive)break;if(i.IsUnsatisfiable)continue;let n=i.Left.ActualPos*i.Left.Scale+(i.Gap-i.Right.ActualPos*i.Right.Scale),s=null,o=0;if(f(n,e)>0)e>this.violationCache.LowViolation&&(s=r,o=e),e=n,r=i;t&&(null==s&&i!==r&&(!this.violationCache.IsFull||n>this.violationCache.LowViolation)&&(s=i,o=n),null!=s&&o>this.violationCache.LowViolation&&this.violationCache.Insert(s,o))}return r}}class rJ{constructor(){this.variables=new Map,this.fixedVars=new Map,this.FailToAdjustEpsilon=.001,this.InitSolver()}AddVariableWithIdealPositionNNN(e,t,r){this.variables.set(e,this.solver.AddVariableANN(e,t,r))}AddVariableWithIdealPositionNN(e,t){this.AddVariableWithIdealPositionNNN(e,t,1)}AddLeftRightSeparationConstraintNNNB(e,t,r,i){let n=this.GetVariable(e);if(null==n)return;let s=this.GetVariable(t);if(null!=s)this.solver.AddConstraintVVNB(n,s,r,i)}AddLeftRightSeparationConstraintNNN(e,t,r){this.AddLeftRightSeparationConstraintNNNB(e,t,r,!1)}AddGoalTwoVariablesAreCloseNNN(e,t,r){let i=this.GetVariable(e);if(null==i)return;let n=this.GetVariable(t);if(null!=n)this.solver.AddNeighborPair(i,n,r)}AddGoalTwoVariablesAreClose(e,t){this.AddGoalTwoVariablesAreCloseNNN(e,t,1)}GetVariable(e){return this.variables.get(e)}Solve(){this.SolveP(null)}SolveP(e){this.SolvePNS(e,{executionLimitExceeded:!1})}SolvePNS(e,t){let r;do{this.solution=null;let i=null;if(null!=e&&null==(i=e))throw Error("parameters");this.solution=this.solver.SolvePar(i),t.executionLimitExceeded=this.solution.ExecutionLimitExceeded,r=this.AdjustConstraintsForMovedFixedVars()}while(r&&!1===this.solution.ExecutionLimitExceeded);return!1===this.solution.ExecutionLimitExceeded}AdjustConstraintsForMovedFixedVars(){let e=new Set;for(let[t,r]of this.fixedVars.entries())!rJ.Close(r,this.GetVariableResolvedPosition(t))&&e.add(t);return 0!==e.size&&this.AdjustConstraintsForMovedFixedVarSet(e)}static Close(e,t){return 5e-4>Math.abs(e-t)}AdjustConstraintsForMovedFixedVarSet(e){for(;e.size>0;){let t;for(let r of e){t=r;break}if(!this.AdjustSubtreeOfFixedVar(t,e))return!1}return!0}AdjustSubtreeOfFixedVar(e,t){let r={successInAdjusting:!1},i=this.AdjustConstraintsOfNeighborsOfFixedVariable(e,r);if(!r.successInAdjusting||0===i.length)return!1;for(let e of i)t.delete(e);return!0}AdjustConstraintsOfNeighborsOfFixedVariable(e,t){let r=this.variables.get(e).Block.Variables,i=new rN,n=new rN,s=1;for(let e of r){if(!!this.fixedVars.has(e.UserData))i.AddValue(e.ActualPos),n.AddValue(e.DesiredPos),n.length>0&&(s=Math.max(s,i.length/n.length))}return 1===s&&(s=2),t.successInAdjusting=this.FixActiveConstraints(r,s),r.map(e=>e.UserData)}FixActiveConstraints(e,t){let r=!1;for(let i of e)for(let e of i.LeftConstraints)e.IsActive&&(e.Gap>this.FailToAdjustEpsilon&&(r=!0),this.solver.SetConstraintUpdate(e,e.Gap/t));return r}GetVariableResolvedPosition(e){let t=this.GetVariable(e);return null==t?0:t.ActualPos}InitSolver(){this.solver=new rK,this.variables.clear()}AddFixedVariable(e,t){this.AddVariableWithIdealPositionNNN(e,t,rJ.FixedVarWeight),this.fixedVars.set(e,t)}ContainsVariable(e){return this.variables.has(e)}GetVariableIdealPosition(e){return this.variables.get(e).DesiredPos}get Solution(){return this.solution}}rJ.FixedVarWeight=1e9;class rQ{constructor(){this.lowBound=Number.NEGATIVE_INFINITY,this.upperBound=Number.POSITIVE_INFINITY}get Position(){return this.position}set Position(e){e<this.lowBound?this.position=this.lowBound:e>this.upperBound?this.position=this.upperBound:this.position=e}get LowBound(){return this.lowBound}set LowBound(e){this.lowBound=e}get UpperBound(){return this.upperBound}set UpperBound(e){this.upperBound=e}toString(){return this.lowBound+(" "+(this.Position+" "))+this.upperBound}}class r1{constructor(e){this.idealPositions=new Map,this.varList=[],this.constraints=new Set,this.solverShell=new rJ,this.boundsToInt=new Map,this.varSepartion=e}SetLowBound(e,t){let r=this.Var(t);r.LowBound=Math.max(e,r.LowBound)}Var(e){return this.varList[e]}SetUpperBound(e,t){let r=this.Var(e);r.UpperBound=Math.min(t,r.UpperBound)}Solve(){this.SolveByRegularSolver()}SolveByRegularSolver(){this.CreateVariablesForBounds();for(let e=0;e<this.varList.length;e++){let t=this.varList[e];t.IsFixed?this.solverShell.AddFixedVariable(e,t.Position):(this.solverShell.AddVariableWithIdealPositionNN(e,this.idealPositions.get(e)),t.LowBound!==Number.NEGATIVE_INFINITY&&this.constraints.add(new ri(this.GetBoundId(t.LowBound),e)),t.UpperBound!==Number.POSITIVE_INFINITY&&this.constraints.add(new ri(e,this.GetBoundId(t.UpperBound))))}for(let e of(this.CreateGraphAndRemoveCycles(),this.graph.edges)){let t=0;e.x<this.varList.length&&(t+=this.varList[e.x].Width),e.y<this.varList.length&&(t+=this.varList[e.y].Width),t/=2,this.solverShell.AddLeftRightSeparationConstraintNNN(e.x,e.y,this.varSepartion+t)}this.solverShell.Solve();for(let e=0;e<this.varList.length;e++)this.varList[e].Position=this.solverShell.GetVariableResolvedPosition(e)}GetBoundId(e){return this.boundsToInt.get(e)}CreateVariablesForBounds(){for(let e of this.varList){if(!e.IsFixed)e.LowBound!==Number.NEGATIVE_INFINITY&&this.RegisterBoundVar(e.LowBound),e.UpperBound!==Number.POSITIVE_INFINITY&&this.RegisterBoundVar(e.UpperBound)}}RegisterBoundVar(e){if(!this.boundsToInt.has(e)){let t=this.varList.length+this.boundsToInt.size;this.boundsToInt.set(e,t),this.solverShell.AddFixedVariable(t,e)}}CreateGraphAndRemoveCycles(){this.graph=rt(Array.from(this.constraints),this.varList.length+this.boundsToInt.size);let e=rk.getFeedbackSet(this.graph);if(null!=e)for(let t of e)this.graph.removeEdge(t)}GetVariablePosition(e){return this.varList[e].Position}AddConstraint(e,t){this.constraints.add(new ri(e,t))}AddVariableNNNN(e,t,r,i){this.idealPositions.set(e,r),this.AddVariableNNBN(e,t,!1,i)}AddFixedVariable(e,t){this.AddVariableNNBN(e,t,!0,0)}AddVariableNNBN(e,t,r,i){let n=new rQ;n.Position=t,n.IsFixed=r,n.Width=i,this.varList.push(n)}}class r0{clone(){let e=new r0;return e.transparency=this.transparency,e.width=this.width,e.color=this.color,e.icurve=this.icurve.clone(),e.label=this.label,e.dashArray=this.dashArray,e.drawPN=this.drawPN,e}static mkDebugCurveTWCILD(e,t,r,i,n,s,o=!1){let a=new r0;return a.transparency=e,a.width=t,a.color=r,a.icurve=i,a.label=n,a.dashArray=s,a.drawPN=o,a}static mkDebugCurveTWCI(e,t,r,i){return r0.mkDebugCurveTWCILD(e,t,r,i,null,null)}static mkDebugCurveWCI(e,t,r){return r0.mkDebugCurveTWCI(255,e,t,r)}static mkDebugCurveCI(e,t){return r0.mkDebugCurveWCI(1,e,t)}static mkDebugCurveI(e){return r0.mkDebugCurveCI("Black",e)}}r0.colors=["DeepSkyBlue","IndianRed","Orange","Gold","DarkRed","Plum","Red","Violet","Indigo","Yellow","OrangeRed","Tomato","Purple","SaddleBrown","Green","Navy","Aqua","Pink","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","Lime","BurlyWood","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","CadetBlue","Chartreuse","DarkBlue","DarkCyan","DarkGoldenrod","DarkGray","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkTurquoise","DarkViolet","DeepPink","DimGray","DodgerBlue","Firebrick","FloralWhite","ForestGreen","Fuchsia","CodeAnalysis","Gainsboro","GhostWhite","Goldenrod","Gray","GreenYellow","Honeydew","HotPink","Ivory","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenrodYellow","LightGray","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSteelBlue","LightYellow","LimeGreen","Linen","Magenta","Maroon","MediumAquamarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","OldLace","Olive","OliveDrab","Orchid","PaleGoldenrod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","PowderBlue","RosyBrown","RoyalBlue","Salmon","SandyBrown","SeaGreen","CodeAnalysis","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Transparent","Turquoise","Aquamarine","Azure","Beige","Wheat","White","WhiteSmoke","YellowGreen","Khaki","AntiqueWhite"];class r2 extends ty{constructor(e,t){super(e,t),this.RightNeighbors=new Set,this.setOfLongestSegs=new Set,this.RightBound=Number.POSITIVE_INFINITY,this.LeftBound=Number.NEGATIVE_INFINITY,this.Direction=B.DirectionFromPointToPoint(e.point,t.point)}AddRightNeighbor(e){this.RightNeighbors.add(e)}get LongestNudgedSegments(){return this.setOfLongestSegs}AddLongestNudgedSegment(e){this.setOfLongestSegs.add(e)}BoundFromRight(e){e=Math.max(e,this.LeftBound),this.RightBound=Math.min(e,this.RightBound)}BoundFromLeft(e){e=Math.min(e,this.RightBound),this.LeftBound=Math.max(e,this.LeftBound)}}class r3{constructor(e){this.Point=e}*GetEnumerator(){let e;for(e=this;null!=e;e=e.Next)yield e.Point}get X(){return this.Point.x}get Y(){return this.Point.y}InsertVerts(e,t,r){for(t--;e<t;t--)this.SetNewNext(r[t])}InsertVertsInReverse(e,t,r){for(e++;e<t;e++)this.SetNewNext(r[e])}SetNewNext(e){let t=new r3(e),r=this.Next;this.Next=t,t.Next=r}}class r5{toString(){return this.Source+" "+this.Target}constructor(e,t){this.IsFixed=!1,this.Reversed=!1,this.index=-1,this.AxisEdge=e,this.Width=t}get LongestNudgedSegment(){return this.longestNudgedSegment}set LongestNudgedSegment(e){this.longestNudgedSegment=e,null!=this.longestNudgedSegment&&(this.longestNudgedSegment.AddEdge(this),this.AxisEdge.AddLongestNudgedSegment(this.longestNudgedSegment))}get Source(){return this.Reversed?this.AxisEdge.TargetPoint:this.AxisEdge.SourcePoint}get Target(){return this.Reversed?this.AxisEdge.SourcePoint:this.AxisEdge.TargetPoint}static VectorsAreParallel(e,t){return c(e.x*t.y-e.y*t.x,0)}static EdgesAreParallel(e,t){return r5.VectorsAreParallel(e.AxisEdge.TargetPoint.sub(e.AxisEdge.SourcePoint),t.AxisEdge.TargetPoint.sub(t.AxisEdge.SourcePoint))}get Direction(){return this.Reversed?B.OppositeDir(this.AxisEdge.Direction):this.AxisEdge.Direction}get Index(){return this.index}set Index(e){this.index=e}}class r6{get PathVisibilityGraph(){return this.pathVisibilityGraph}constructor(e){this.pathVisibilityGraph=new tT,this.axisEdgesToPathOrders=new Map,this.OriginalPaths=e}GetOrder(){return this.FillTheVisibilityGraphByWalkingThePaths(),this.InitPathOrder(),this.OrderPaths(),this.axisEdgesToPathOrders}FillTheVisibilityGraphByWalkingThePaths(){for(let e of this.OriginalPaths)this.FillTheVisibilityGraphByWalkingPath(e)}FillTheVisibilityGraphByWalkingPath(e){let t=this.CreatePathEdgesFromPoints(function*(){if(e.PathPoints instanceof r3)for(let t=e.PathPoints;null!=t;t=t.Next)yield t.Point;else for(let t of e.PathPoints)yield t}(),e.Width),r=t.next();for(!r.done&&e.SetFirstEdge(r.value);!1===(r=t.next()).done;)e.AddEdge(r.value)}*CreatePathEdgesFromPoints(e,t){let r=e.next(),i=r.value;for(;!(r=e.next()).done;)yield this.CreatePathEdge(i,r.value,t),i=r.value}CreatePathEdge(e,t,r){switch(B.DirectionFromPointToPoint(e,t)){case eh.East:case eh.North:return new r5(this.GetAxisEdge(e,t),r);case eh.South:case eh.West:{let i=new r5(this.GetAxisEdge(t,e),r);return i.Reversed=!0,i}default:throw Error("Not a rectilinear path")}}GetAxisEdge(e,t){return this.PathVisibilityGraph.AddEdgeF(e,t,(e,t)=>new r2(e,t))}InitPathOrder(){for(let e of this.PathVisibilityGraph.Edges)this.axisEdgesToPathOrders.set(e,[]);for(let e of this.OriginalPaths)for(let t of e.PathEdges())this.axisEdgesToPathOrders.get(t.AxisEdge).push(t)}OrderPaths(){for(let e of r6.WalkGraphEdgesInTopologicalOrderIfPossible(this.PathVisibilityGraph))this.OrderPathEdgesSharingEdge(e)}OrderPathEdgesSharingEdge(e){let t=this.PathOrderOfVisEdge(e);t.sort(r6.CompareTwoPathEdges);let r=0;for(let e of t)e.Index=r++}static CompareTwoPathEdges(e,t){if(e===t)return 0;let r=r6.CompareInDirectionStartingFromAxisEdge(e,t,e.AxisEdge,e.AxisEdge.Direction);return 0!==r?r:-r6.CompareInDirectionStartingFromAxisEdge(e,t,e.AxisEdge,B.OppositeDir(e.AxisEdge.Direction))}static CompareInDirectionStartingFromAxisEdge(e,t,r,i){for(;;){if(null==(e=r6.GetNextPathEdgeInDirection(e,r,i))||null==(t=r6.GetNextPathEdgeInDirection(t,r,i)))return 0;if(e.AxisEdge===t.AxisEdge){i=r6.FindContinuedDirection(r,i,e.AxisEdge),r=e.AxisEdge;let n=r6.GetExistingOrder(e,t);if(n===r6.NotOrdered)continue;return i===r.Direction?n:-n}let n=i===r.Direction?r.Target:r.Source,s=r6.OtherVertex(e.AxisEdge,n),o=r6.OtherVertex(t.AxisEdge,n),a=r6.ProjectionForCompare(r,i!==r.Direction);return h(a(s.point),a(o.point))}}static FindContinuedDirection(e,t,r){return e.Direction===t?r.Source===e.Target?r.Direction:B.OppositeDir(r.Direction):r.Source===e.Source?r.Direction:B.OppositeDir(r.Direction)}static OtherVertex(e,t){return e.Source===t?e.Target:e.Source}static ProjectionForCompare(e,t){return e.Direction===eh.North?t?e=>-e.x:e=>e.x:t?e=>e.y:e=>-e.y}static GetNextPathEdgeInDirection(e,t,r){return t.Direction===r?e.Reversed?e.Prev:e.Next:e.Reversed?e.Next:e.Prev}static GetExistingOrder(e,t){let r=e.Index;return -1===r?r6.NotOrdered:h(r,t.Index)}PathOrderOfVisEdge(e){return this.axisEdgesToPathOrders.get(e)}static InitQueueOfSources(e,t,r){for(let i of r.Vertices()){let r=i.InEdgesLength();t.set(i,r),0===r&&e.enqueue(i)}}static*WalkGraphEdgesInTopologicalOrderIfPossible(e){let t=new eq.Queue,r=new Map;for(r6.InitQueueOfSources(t,r,e);t.length>0;)for(let e of t.dequeue().OutEdges){let i=r.get(e.Target);r.set(e.Target,i-1),1===i&&t.enqueue(e.Target),yield e}}}r6.NotOrdered=Number.MAX_VALUE;class r4 extends td{constructor(e,t){super(),this.site=t,this.AxisEdge=e}get Site(){return this.site}}class r9 extends td{constructor(e,t){super(),this.site=t,this.AxisEdge=e}get Site(){return this.site}}class r8{get Edges(){return this.edges}AddEdge(e){this.UpPoint=e.TargetPoint,this.edges.add(e)}constructor(e){this.edges=new Set,this.Source=e}RemoveAxis(e){this.edges.delete(e)}IsEmpty(){return 0===this.edges.size}}class r7 extends tv{constructor(e,t,r,i,n){super(t,new B(e).ToPoint()),this.DirectionPerp=new B(e).Right.ToPoint(),this.PathOrders=i,this.xProjection=e===eh.North?e=>e.x:e=>-e.y,this.edgeContainersTree=new tu((e,t)=>this.CompareAA(e,t)),this.SweepPole=B.VectorDirection(this.SweepDirection),this.AxisEdges=n,this.AxisEdgesToObstaclesTheyOriginatedFrom=r}FindFreeSpace(){this.InitTheQueueOfEvents(),this.ProcessEvents()}ProcessEvents(){for(;this.EventQueue.Count>0;)this.ProcessEvent(this.EventQueue.Dequeue())}ProcessEvent(e){e instanceof tf?this.ProcessVertexEvent(e):(this.Z=this.GetZP(e.Site),e instanceof r9?this.ProcessLowEdgeEvent(e):this.ProcessHighEdgeEvent(e))}ProcessHighEdgeEvent(e){let t=e.AxisEdge;this.RemoveEdge(t),this.ConstraintEdgeWithObstaclesAtZ(t,t.Target.point)}ProcessLowEdgeEvent(e){let t=e.AxisEdge,r=this.GetOrCreateAxisEdgesContainer(t);r.item.AddEdge(t);let i=this.edgeContainersTree.previous(r);if(null!=i)for(let e of i.item.edges)for(let t of r.item.edges)this.TryToAddRightNeighbor(e,t);let n=this.edgeContainersTree.next(r);if(null!=n)for(let e of r.item.Edges)for(let t of n.item.edges)this.TryToAddRightNeighbor(e,t);this.ConstraintEdgeWithObstaclesAtZ(t,t.Source.point)}TryToAddRightNeighbor(e,t){this.ProjectionsOfEdgesOverlap(e,t)&&e.AddRightNeighbor(t)}ProjectionsOfEdgesOverlap(e,t){return this.SweepPole===eh.North?!(e.TargetPoint.y<t.SourcePoint.y-l.distanceEpsilon||t.TargetPoint.y<e.SourcePoint.y-l.distanceEpsilon):!(e.TargetPoint.x<t.SourcePoint.x-l.distanceEpsilon||t.TargetPoint.x<e.SourcePoint.x-l.distanceEpsilon)}GetObstacleBoundaries(e){return this.Obstacles.map(t=>r0.mkDebugCurveWCI(1,e,t))}ConstraintEdgeWithObstaclesAtZ(e,t){this.ConstraintEdgeWithObstaclesAtZFromLeft(e,t),this.ConstraintEdgeWithObstaclesAtZFromRight(e,t)}ConstraintEdgeWithObstaclesAtZFromRight(e,t){let r=this.GetActiveSideFromRight(t);if(null==r||this.NotRestricting(e,r.item.Polyline))return;let i=this.ObstacleSideComparer.IntersectionOfSideAndSweepLine(r.item);e.BoundFromRight(i.dot(this.DirectionPerp))}GetActiveSideFromRight(e){return this.LeftObstacleSideTree.findFirst(t=>r7.PointToTheLeftOfLineOrOnLineLocal(e,t.Start,t.End))}ConstraintEdgeWithObstaclesAtZFromLeft(e,t){let r=this.GetActiveSideFromLeft(t);if(null==r||this.NotRestricting(e,r.item.Polyline))return;let i=this.ObstacleSideComparer.IntersectionOfSideAndSweepLine(r.item);e.BoundFromLeft(i.dot(this.DirectionPerp))}static PointToTheLeftOfLineOrOnLineLocal(e,t,r){return g.signedDoubledTriangleArea(e,t,r)>-r7.AreaComparisonEpsilon}static PointToTheRightOfLineOrOnLineLocal(e,t,r){return g.signedDoubledTriangleArea(t,r,e)<r7.AreaComparisonEpsilon}GetActiveSideFromLeft(e){return this.RightObstacleSideTree.findLast(t=>r7.PointToTheRightOfLineOrOnLineLocal(e,t.Start,t.End))}static EdgeMidPoint(e){return g.middle(e.SourcePoint,e.TargetPoint)}GetOrCreateAxisEdgesContainer(e){let t=e.Source.point,r=this.GetAxisEdgesContainerNode(t);return null!=r?r:this.edgeContainersTree.insert(new r8(t))}GetAxisEdgesContainerNode(e){let t=this.xProjection(e),r=this.edgeContainersTree.findFirst(e=>this.xProjection(e.Source)>=t-l.distanceEpsilon/2);return null!=r&&this.xProjection(r.item.Source)<=t+l.distanceEpsilon/2?r:null}ProcessVertexEvent(e){this.Z=this.GetZS(e),e instanceof tD?this.ProcessLeftVertex(e,e.Vertex.nextOnPolyline):(e instanceof tV||this.ProcessLeftVertex(e,e.Vertex.nextOnPolyline),this.ProcessRightVertex(e,e.Vertex.prevOnPolyline))}ProcessRightVertex(e,t){let r=e.Site;this.ProcessPrevSegmentForRightVertex(e,r);let i=t.point.sub(e.Site),n=i.dot(this.DirectionPerp),s=i.dot(this.SweepDirection);s<=l.distanceEpsilon?n>0&&s>=0?this.EnqueueEvent(new tV(t)):this.RestrictEdgeContainerToTheRightOfEvent(e.Vertex):(this.InsertRightSide(new tF(e.Vertex)),this.EnqueueEvent(new tV(t)),this.RestrictEdgeContainerToTheRightOfEvent(e.Vertex))}RestrictEdgeContainerToTheRightOfEvent(e){let t=e.point,r=this.xProjection(t),i=this.edgeContainersTree.findFirst(e=>r<=this.xProjection(e.Source));if(null!=i)for(let r of i.item.Edges)!this.NotRestricting(r,e.polyline)&&r.BoundFromLeft(this.DirectionPerp.dot(t))}NotRestricting(e,t){return this.AxisEdgesToObstaclesTheyOriginatedFrom.get(e)===t}ProcessPrevSegmentForRightVertex(e,t){let r=e.Vertex.nextOnPolyline.point;t.sub(r).dot(this.SweepDirection)>l.distanceEpsilon&&this.RemoveRightSide(new tF(e.Vertex.nextOnPolyline))}RemoveEdge(e){let t=this.GetAxisEdgesContainerNode(e.Source.point);t.item.RemoveAxis(e),t.item.IsEmpty()&&this.edgeContainersTree.deleteNodeInternal(t)}ProcessLeftVertex(e,t){let r=e.Site;this.ProcessPrevSegmentForLeftVertex(e,r);let i=t.point.sub(e.Site),n=i.dot(this.DirectionPerp),s=i.dot(this.SweepDirection);s<=l.distanceEpsilon?n<0&&s>=0&&this.EnqueueEvent(new tD(t)):(this.InsertLeftSide(new tL(e.Vertex)),this.EnqueueEvent(new tD(t))),this.RestrictEdgeFromTheLeftOfEvent(e.Vertex)}RestrictEdgeFromTheLeftOfEvent(e){let t=e.point,r=this.GetContainerNodeToTheLeftOfEvent(t);if(null!=r)for(let i of r.item.Edges)!this.NotRestricting(i,e.polyline)&&i.BoundFromRight(t.dot(this.DirectionPerp))}GetContainerNodeToTheLeftOfEvent(e){let t=this.xProjection(e);return this.edgeContainersTree.findLast(e=>this.xProjection(e.Source)<=t)}ProcessPrevSegmentForLeftVertex(e,t){let r=e.Vertex.prevOnPolyline.point;t.sub(r).dot(this.SweepDirection)>l.distanceEpsilon&&this.RemoveLeftSide(new tL(e.Vertex.prevOnPolyline))}InitTheQueueOfEvents(){for(let e of(this.InitQueueOfEvents(),this.AxisEdges))this.EnqueueEventsForEdge(e)}EnqueueEventsForEdge(e){this.EdgeIsParallelToSweepDir(e)&&(this.EnqueueEvent(r7.EdgeLowPointEvent(e,e.Source.point)),this.EnqueueEvent(r7.EdgeHighPointEvent(e,e.Target.point)))}EdgeIsParallelToSweepDir(e){return e.Direction===this.SweepPole||e.Direction===B.OppositeDir(this.SweepPole)}static EdgeHighPointEvent(e,t){return new r4(e,t)}static EdgeLowPointEvent(e,t){return new r9(e,t)}CompareAA(e,t){return h(e.Source.dot(this.DirectionPerp),t.Source.dot(this.DirectionPerp))}}r7.AreaComparisonEpsilon=l.intersectionEpsilon;class ie extends tk{constructor(e){super(),this.CompassDirection=eh.None,this.edges=[],this._isFixed=!1,this.Id=-1,this.IdealPosition=0,this.Id=e}get Start(){return this.start}get End(){return this.end}get Edges(){return this.edges}AddEdge(e){if(0===this.Edges.length){let t=B.VectorDirectionPP(e.Source,e.Target);switch(t){case eh.South:t=eh.North;break;case eh.West:t=eh.East}this.CompassDirection=t,this.start=e.Source,this.end=e.Source}switch(this.CompassDirection){case eh.North:this.TryPointForStartAndEndNorth(e.Source),this.TryPointForStartAndEndNorth(e.Target);break;case eh.East:this.TryPointForStartAndEndEast(e.Source),this.TryPointForStartAndEndEast(e.Target)}this.Edges.push(e)}TryPointForStartAndEndNorth(e){e.y<this.start.y?this.start=e:e.y>this.end.y&&(this.end=e)}TryPointForStartAndEndEast(e){e.x<this.start.x?this.start=e:e.x>this.end.x&&(this.end=e)}get IsFixed(){return this._isFixed}set IsFixed(e){this._isFixed=e}get Width(){let e=0;for(let t of this.edges)e=Math.max(e,t.Width);return e}GetLeftBound(){if(!this.IsFixed){let e=Number.NEGATIVE_INFINITY;for(let t of this.edges)e=Math.max(e,t.AxisEdge.LeftBound);return e}return this.CompassDirection===eh.North?this.Edges[0].Source.x:-this.Edges[0].Source.y}GetRightBound(){if(!this.IsFixed){let e=Number.POSITIVE_INFINITY;for(let t of this.edges)e=Math.min(e,t.AxisEdge.RightBound);return e}return this.Position()}Position(){return this.CompassDirection===eh.North?this.Edges[0].Source.x:-this.Edges[0].Source.y}}class it{constructor(e,t){this.tree=new tu((e,t)=>h(e.Point.x,t.Point.x)),this.VerticalPoints=t,this.HorizontalPoints=e}SplitPoints(){if(0!==this.VerticalPoints.length&&0!==this.HorizontalPoints.length)this.InitEventQueue(),this.ProcessEvents()}ProcessEvents(){for(;!this.Queue.IsEmpty();){let e={priority:0},t=this.Queue.DequeueAndGetPriority(e);this.ProcessEvent(t,e.priority)}}ProcessEvent(e,t){c(e.Next.Point.x,e.Point.x)?t===it.Low(e)?this.ProcessLowLinkedPointEvent(e):this.ProcessHighLinkedPointEvent(e):this.IntersectWithTree(e)}IntersectWithTree(e){let t,r,i;let n=e.Y;if(e.Point.x<e.Next.Point.x?(r=e.Point.x,t=e.Next.Point.x,i=!0):(t=e.Point.x,r=e.Next.Point.x,i=!1),i)for(let i=this.tree.findFirst(e=>r<=e.Point.x);null!=i&&i.item.Point.x<=t;i=this.tree.next(i)){let t=new g(i.item.Point.x,n);e=it.TrySplitHorizontalPoint(e,t,!0),it.TrySplitVerticalPoint(i.item,t)}else for(let i=this.tree.findLast(e=>e.Point.x<=t);null!=i&&i.item.Point.x>=r;i=this.tree.previous(i)){let t=new g(i.item.Point.x,n);e=it.TrySplitHorizontalPoint(e,t,!1),it.TrySplitVerticalPoint(i.item,t)}}static TrySplitVerticalPoint(e,t){it.Low(e)+l.distanceEpsilon<t.y&&t.y+l.distanceEpsilon<it.High(e)&&e.SetNewNext(t)}static TrySplitHorizontalPoint(e,t,r){return r&&e.X+l.distanceEpsilon<t.x&&t.x+l.distanceEpsilon<e.Next.X||!r&&e.Next.X+l.distanceEpsilon<t.x&&t.x+l.distanceEpsilon<e.X?(e.SetNewNext(t),e.Next):e}ProcessHighLinkedPointEvent(e){this.tree.remove(e)}ProcessLowLinkedPointEvent(e){this.tree.insert(e)}InitEventQueue(){for(let e of(this.Queue=new rd(h),this.VerticalPoints))this.Queue.Enqueue(e,it.Low(e));for(let e of this.HorizontalPoints)this.Queue.Enqueue(e,e.Point.y)}static Low(e){return Math.min(e.Point.y,e.Next.Point.y)}static High(e){return Math.max(e.Point.y,e.Next.Point.y)}}class ir{constructor(e){this.verticesToPathOffsets=new t_,this.Paths=e}MergePaths(){for(let e of(this.InitVerticesToPathOffsetsAndRemoveSelfCycles(),this.Paths))this.ProcessPath(e)}ProcessPath(e){let t=new Map,r=null;for(let i=e.PathPoints;null!=i;i=i.Next){let n=this.verticesToPathOffsets.get(i.Point);if(null!=r){if(t.size>0)for(let[r,s]of n){let n=t.get(r);n&&(this.CollapseLoopingPath(r,n,s,e,i),t.delete(r))}for(let[e,i]of r)!n.has(e)&&t.set(e,i)}r=n}}CollapseLoopingPath(e,t,r,i,n){let s=ir.FindLinkedPointInPath(i,t.Point),o=Array.from(ir.GetPointsInBetween(s,n));ir.Before(t,r)?(this.CleanDisappearedPiece(t,r,e),this.ReplacePiece(t,r,o,e)):(this.CleanDisappearedPiece(r,t,e),this.ReplacePiece(r,t,o.reverse(),e))}static*GetPointsInBetween(e,t){for(let r=e.Next;r!==t;r=r.Next)yield r.Point}ReplacePiece(e,t,r,i){let n=e;for(let e of r){let t=new r3(e);n.Next=t,n=t,this.verticesToPathOffsets.get(e).set(i,n)}n.Next=t}CleanDisappearedPiece(e,t,r){for(let i of ir.GetPointsInBetween(e,t))this.verticesToPathOffsets.get(i).delete(r)}static Before(e,t){for(e=e.Next;null!=e;e=e.Next)if(e===t)return!0;return!1}static FindLinkedPointInPath(e,t){for(let r=e.PathPoints;;r=r.Next)if(r.Point.equal(t))return r}InitVerticesToPathOffsetsAndRemoveSelfCycles(){for(let e of this.Paths)for(let t=e.PathPoints;null!=t;t=t.Next){let r=this.verticesToPathOffsets.get(t.Point);!r&&this.verticesToPathOffsets.set(t.Point,r=new Map);let i=r.get(e);i?(this.CleanDisappearedPiece(i,t,e),i.Next=t.Next):r.set(e,t)}}}class ii{static RefinePaths(e,t){ii.AdjustPaths(e);let r=ii.CreatePathsToFirstLinkedVerticesMap(e);ii.Refine(Array.from(r.values())),ii.CrossVerticalAndHorizontalSegs(r.values()),ii.ReconstructPathsFromLinkedVertices(r),t&&new ir(e).MergePaths()}static AdjustPaths(e){for(let t of e)t.PathPoints=ii.AdjustPathPoints(t.PathPoints)}static AdjustPathPoints(e){if(!e||0===e.length)return;let t=[],r=g.RoundPoint(e[0]);t.push(r);for(let i=1;i<e.length;i++){let n=g.RoundPoint(e[i]);!r.equal(n)&&(r=n,t.push(r))}return t}static CrossVerticalAndHorizontalSegs(e){let t=[],r=[];for(let i of e)for(let e=i;null!=e.Next;e=e.Next)c(e.Point.x,e.Next.Point.x)?r.push(e):t.push(e);new it(t,r).SplitPoints()}static ReconstructPathsFromLinkedVertices(e){for(let[t,r]of e)t.PathPoints=r}static Refine(e){ii.RefineInDirection(eh.North,e),ii.RefineInDirection(eh.East,e)}static*groupByProj(e,t){let r=new Map;for(let i of t){let t=e(i.Point),n=r.get(t);!n&&(n=[],r.set(t,n)),n.push(i)}for(let e of r.values())yield e}static RefineInDirection(e,t){let r={projectionToPerp:void 0,projectionToDirection:void 0};ii.GetProjectionsDelegates(e,r);let i=Array.from(ii.GetAllLinkedVertsInDirection(r.projectionToPerp,t));for(let e of ii.groupByProj(r.projectionToPerp,i))ii.RefineCollinearBucket(e,r.projectionToDirection)}static GetProjectionsDelegates(e,t){e===eh.East?(t.projectionToDirection=e=>e.x,t.projectionToPerp=e=>e.y):(t.projectionToPerp=e=>e.x,t.projectionToDirection=e=>e.y)}static*GetAllLinkedVertsInDirection(e,t){for(let r of t)for(let t=r;null!=t.Next;t=t.Next)c(e(t.Point),e(t.Next.Point))&&(yield t)}static RefineCollinearBucket(e,t){let r=new Set,i=[];for(let n of e){let e=t(n.Point);!r.has(e)&&(r.add(e),i.push([n.Point,e])),e=t(n.Next.Point),!r.has(e)&&(r.add(e),i.push([n.Next.Point,e]))}i.sort((e,t)=>e[1]-t[1]);let n=i.map(e=>e[0]),s=new Map;for(let e=0;e<i.length;e++)s.set(i[e][1],e);for(let r of e){let e=s.get(t(r.Point)),i=s.get(t(r.Next.Point));Math.abs(i-e)>1&&ii.InsertPoints(r,n,e,i)}}static InsertPoints(e,t,r,i){r<i?e.InsertVerts(r,i,t):e.InsertVertsInReverse(i,r,t)}static CreatePathsToFirstLinkedVerticesMap(e){let t=new Map;for(let r of e)t.set(r,ii.CreateLinkedVertexOfEdgePath(r));return t}static CreateLinkedVertexOfEdgePath(e){let t=e.PathPoints,r=new r3(t[0]),i=r;for(let e=1;e<t.length;e++)r.Next=new r3(t[e]),r=r.Next;return i}}class is{constructor(e,t){this.Points=e,this.I=t}static equal(e,t){return e.I===t.I&&e.Points===t.Points}get Start(){return this.Points[this.I]}get End(){return this.Points[this.I+1]}}class io{constructor(e,t){this.segTree=new te(null),this.crossedOutPaths=new Set,this.HierarchyOfObstacles=new te(t),this.Paths=e}static RemoveStaircases(e,t){new io(e,t).Calculate()}Calculate(){let e;this.InitHierarchies();do for(let t of(e=!1,this.Paths.filter(e=>!this.crossedOutPaths.has(e))))this.ProcessPath(t)&&(e=!0);while(e)}ProcessPath(e){let t={pts:e.PathPoints,canHaveStaircase:!1};return this.ProcessPoints(t)?(e.PathPoints=t.pts,!0):(!t.canHaveStaircase&&this.crossedOutPaths.add(e),!1)}ProcessPoints(e){let t=this.FindStaircaseStart(e);return!(t<0)&&(e.pts=this.RemoveStaircasePN(e.pts,t),!0)}FindStaircaseStart(e){if(e.canHaveStaircase=!1,e.pts.length<5)return -1;let t=[new is(e.pts,0),new is(e.pts,1),new is(e.pts,2),new is(e.pts,3)],r=0;for(let i=0;;){let n={canHaveStaircaseAtI:!1};if(this.IsStaircase(e.pts,i,t,n))return e.canHaveStaircase=!0,i;if(e.canHaveStaircase=e.canHaveStaircase||n.canHaveStaircaseAtI,i++,e.pts.length<i+5)return -1;t[r]=new is(e.pts,i+3),r++,r%=4}}static GetFlippedPoint(e,t){return c(e[t].y,e[t+1].y)?new g(e[t+4].x,e[t].y):new g(e[t].x,e[t+4].y)}Crossing(e,t,r){return io.IsCrossing(b.mkPP(e,t),this.segTree,r)}static IsCrossing(e,t,r){for(let i of t.GetAllIntersecting(e.boundingBox))if(-1===r.findIndex(e=>e===i))return!0;return!1}IntersectObstacleHierarchyPPP(e,t,r){return this.IntersectObstacleHierarchyL(b.mkPP(e,t))||this.IntersectObstacleHierarchyL(b.mkPP(t,r))}IntersectObstacleHierarchyL(e){return this.HierarchyOfObstacles.GetAllIntersecting(e.boundingBox).some(t=>null!=C.intersectionOne(e,t,!1))}IsStaircase(e,t,r,i){let n=e[t],s=e[t+1],o=e[t+2],a=e[t+3],l=e[t+4];return i.canHaveStaircaseAtI=!1,B.DirectionFromPointToPoint(n,s)===B.DirectionFromPointToPoint(o,a)&&B.DirectionFromPointToPoint(s,o)===B.DirectionFromPointToPoint(a,l)&&(o=io.GetFlippedPoint(e,t),!this.IntersectObstacleHierarchyPPP(s,o,a)&&(i.canHaveStaircaseAtI=!0,!this.Crossing(s,o,r)))}RemoveStaircasePN(e,t){let r=e[t],i=e[t+1],n=Math.abs(r.y-i.y)<l.distanceEpsilon/2;return this.RemoveStaircasePNB(e,t,n)}RemoveStaircasePNB(e,t,r){this.RemoveSegs(e);let i=Array(e.length-2);(function(e,t,r){let i=0;for(;r-- >0;)t[i++]=e[i++]})(e,i,t+1);let n=e[t+1],s=e[t+3];return i[t+1]=r?new g(s.x,n.y):new g(n.x,s.y),function(e,t,r,i,n){for(;n-- >0;)r[i++]=e[t++]}(e,t+4,i,t+2,i.length-t-2),this.InsertNewSegs(i,t),i}RemoveSegs(e){for(let t=0;t<e.length-1;t++)this.RemoveSeg(new is(e,t))}RemoveSeg(e){this.segTree.Remove(io.Rect(e),e)}InsertNewSegs(e,t){this.InsSeg(e,t),this.InsSeg(e,t+1)}InitHierarchies(){for(let e of this.Paths)this.InsertPathSegs(e)}InsertPathSegs(e){this.InsertSegs(e.PathPoints)}InsertSegs(e){for(let t=0;t<e.length-1;t++)this.InsSeg(e,t)}InsSeg(e,t){let r=new is(e,t);this.segTree.Add(io.Rect(r),r)}static Rect(e){return M.mkPP(e.Start,e.End)}}class ia{get HasGroups(){return null!=this.HierarchyOfGroups&&this.HierarchyOfGroups.Count>0}constructor(e,t,r,i){this.AncestorsSets=i,this.HierarchyOfGroups=eC(Array.from(i.keys()).filter(e=>e.IsGroup).map(e=>eR(e,e.BoundingBox))),this.Obstacles=r,this.EdgeSeparation=2*t,this.Paths=e,this.HierarchyOfObstacles=eC(r.map(e=>eR(e,e.boundingBox))),this.MapPathsToTheirObstacles()}MapPathsToTheirObstacles(){for(let e of(this.PathToObstacles=new Map,this.Paths))this.MapPathToItsObstacles(e)}MapPathToItsObstacles(e){if(!e.PathPoints||0===e.PathPoints.length)return;let t=e.PathPoints,r=this.HierarchyOfObstacles.FirstHitNodeWithPredicate(t[0],ia.ObstacleTest),i=this.HierarchyOfObstacles.FirstHitNodeWithPredicate(t[t.length-1],ia.ObstacleTest);null!=r&&null!=i&&this.PathToObstacles.set(e,[r.UserData,i.UserData])}static ObstacleTest(e,t){return C.PointRelativeToCurveLocation(e,t)!==el.Outside?eu.Stop:eu.Continue}Calculate(e,t){this.NudgingDirection=e,ii.RefinePaths(this.Paths,t),this.GetPathOrdersAndPathGraph(),this.MapAxisEdgesToTheirObstacles(),this.DrawPaths()}MapAxisEdgesToTheirObstacles(){for(let e of(this.axisEdgesToObstaclesTheyOriginatedFrom=new Map,this.Paths))this.MapPathEndAxisEdgesToTheirObstacles(e);for(let e of this.Paths)this.UmmapPathInteriourFromStrangerObstacles(e)}UmmapPathInteriourFromStrangerObstacles(e){let t=this.FindFirstUnmappedEdge(e);if(null==t)return;let r=this.FindLastUnmappedEdge(e);for(let e=t;null!=e&&e!==r;e=e.Next)this.axisEdgesToObstaclesTheyOriginatedFrom.delete(e.AxisEdge)}FindLastUnmappedEdge(e){for(let t=e.LastEdge;null!=t;t=t.Prev)if(t.AxisEdge.Direction!==this.NudgingDirection)return t;return null}FindFirstUnmappedEdge(e){for(let t=e.FirstEdge;null!=t;t=t.Next)if(t.AxisEdge.Direction!==this.NudgingDirection)return t;return null}MapPathEndAxisEdgesToTheirObstacles(e){let t=this.PathToObstacles.get(e);t&&(this.ProcessThePathStartToMapAxisEdgesToTheirObstacles(e,t[0]),this.ProcessThePathEndToMapAxisEdgesToTheirObstacles(e,t[1]))}ProcessThePathEndToMapAxisEdgesToTheirObstacles(e,t){for(let r=e.LastEdge;null!=r&&B.DirectionsAreParallel(r.Direction,this.NudgingDirection);r=r.Prev)this.axisEdgesToObstaclesTheyOriginatedFrom.set(r.AxisEdge,t)}ProcessThePathStartToMapAxisEdgesToTheirObstacles(e,t){for(let r=e.FirstEdge;null!=r&&B.DirectionsAreParallel(r.Direction,this.NudgingDirection);r=r.Next)this.axisEdgesToObstaclesTheyOriginatedFrom.set(r.AxisEdge,t)}GetPathOrdersAndPathGraph(){let e=new r6(this.Paths);this.PathOrders=e.GetOrder(),this.PathVisibilityGraph=e.PathVisibilityGraph}static GetCurvesForShow(e,t){let r=[];for(let t of e){let e=new A;for(let r of t.PathPoints)e.addPoint(r);r.push(e)}return r.concat(Array.from(t))}DrawPaths(){this.SetWidthsOfArrowheads(),this.CreateLongestNudgedSegments(),this.FindFreeSpaceInDirection(Array.from(this.PathVisibilityGraph.Edges)),this.MoveLongestSegsIdealPositionsInsideFeasibleIntervals(),this.PositionShiftedEdqges()}SetWidthsOfArrowheads(){for(let e of this.Paths)ia.SetWidthsOfArrowheadsForEdge(e)}static SetWidthsOfArrowheadsForEdge(e){let t=e.GeomEdge;if(null!=t.targetArrowhead){let r=e.LastEdge;r.Width=Math.max(t.targetArrowhead.width,r.Width)}if(null!=t.sourceArrowhead){let r=e.FirstEdge;r.Width=Math.max(t.sourceArrowhead.width,r.Width)}}PositionShiftedEdqges(){this.Solver=new r1(this.EdgeSeparation);for(let e=0;e<this.LongestNudgedSegs.length;e++)this.CreateVariablesOfLongestSegment(this.LongestNudgedSegs[e]);this.CreateConstraintsOfTheOrder(),this.CreateConstraintsBetweenLongestSegments(),this.Solver.SolveByRegularSolver(),this.ShiftPathEdges()}MoveLongestSegsIdealPositionsInsideFeasibleIntervals(){for(let e=0;e<this.LongestNudgedSegs.length;e++){let t=this.LongestNudgedSegs[e];ia.MoveLongestSegIdealPositionsInsideFeasibleInterval(t)}}static MoveLongestSegIdealPositionsInsideFeasibleInterval(e){if(e.IsFixed)return;let t=e.GetLeftBound(),r=e.GetRightBound();e.IdealPosition<t?e.IdealPosition=t:e.IdealPosition>r&&(e.IdealPosition=r)}ShiftPathEdges(){for(let e of this.Paths)e.PathPoints=this.GetShiftedPoints(e)}GetShiftedPoints(e){return ia.RemoveSwitchbacksAndMiddlePoints(this.GetShiftedPointsSimple(e))}static Rectilinearise(e,t){if(e.x===t.x||e.y===t.y)return t;let r=Math.abs(e.x-t.x);return r<Math.abs(e.y-t.y)?new g(e.x,t.y):new g(t.x,e.y)}GetShiftedPointsSimple(e){let t=[],r=e.FirstEdge;for(let i of(t.push(this.ShiftedPoint(r.Source,r.LongestNudgedSegment)),e.PathEdges()))t.push(this.ShiftedEdgePositionOfTarget(i));return t}ShiftedEdgePositionOfTarget(e){return null!=e.LongestNudgedSegment||null==e.Next?this.ShiftedPoint(e.Target,e.LongestNudgedSegment):this.ShiftedPoint(e.Next.Source,e.Next.LongestNudgedSegment)}ShiftedPoint(e,t){if(null==t)return e;let r=this.Solver.GetVariablePosition(t.Id);return this.NudgingDirection===eh.North?new g(r,e.y):new g(e.x,-r)}static LineSegOfLongestSeg(e,t){let r=t===eh.East?e=>e.x:e=>e.y,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(let t of e.Edges)ia.UpdateMinMaxWithPoint(i,r,t.Source),ia.UpdateMinMaxWithPoint(i,r,t.Target);return t===eh.East?new b(i.min,-e.IdealPosition,i.max,-e.IdealPosition):new b(e.IdealPosition,i.min,e.IdealPosition,i.max)}static UpdateMinMaxWithPoint(e,t,r){let i=t(r);e.min>i&&(e.min=i),e.max<i&&(e.max=i)}CreateConstraintsBetweenLongestSegments(){for(let e of this.LongestNudgedSegs)this.CreateConstraintsBetweenLongestSegmentsForSegment(e)}CreateConstraintsBetweenLongestSegmentsForSegment(e){let t=new Set;for(let r of e.Edges){let e=r.AxisEdge;if(null!=e)for(let r of e.RightNeighbors)for(let e of r.LongestNudgedSegments)t.add(e)}for(let r of t)this.ConstraintTwoLongestSegs(e,r)}CreateConstraintsOfTheOrder(){for(let e of this.PathOrders)ia.ParallelToDirection(e[0],this.NudgingDirection)&&this.CreateConstraintsOfThePathOrder(e[1])}static ParallelToDirection(e,t){switch(t){case eh.North:case eh.South:return c(e.SourcePoint.x,e.TargetPoint.x);default:return c(e.SourcePoint.y,e.TargetPoint.y)}}CreateConstraintsOfThePathOrder(e){let t=null;for(let r of e.filter(e=>null!=e.LongestNudgedSegment))null!=t&&this.ConstraintTwoLongestSegs(t.LongestNudgedSegment,r.LongestNudgedSegment),t=r}ConstraintTwoLongestSegs(e,t){(!e.IsFixed||!t.IsFixed)&&this.Solver.AddConstraint(e.Id,t.Id)}CreateVariablesOfLongestSegment(e){if(e.IsFixed)this.Solver.AddFixedVariable(e.Id,ia.SegmentPosition(e,this.NudgingDirection));else{let t=e.GetLeftBound(),r=e.GetRightBound();t>=r?(this.Solver.AddFixedVariable(e.Id,ia.SegmentPosition(e,this.NudgingDirection)),e.IsFixed=!0):(this.Solver.AddVariableNNNN(e.Id,ia.SegmentPosition(e,this.NudgingDirection),e.IdealPosition,e.Width),t!==Number.NEGATIVE_INFINITY&&this.Solver.SetLowBound(t,e.Id),r!==Number.POSITIVE_INFINITY&&this.Solver.SetUpperBound(e.Id,r))}}static SegmentPosition(e,t){return t===eh.North?e.Start.x:-e.Start.y}FindFreeSpaceInDirection(e){this.BoundAxisEdgesByRectsKnownInAdvance(),new r7(this.NudgingDirection,this.Obstacles,this.axisEdgesToObstaclesTheyOriginatedFrom,this.PathOrders,e).FindFreeSpace()}BoundAxisEdgesByRectsKnownInAdvance(){for(let e of this.Paths)this.HasGroups&&this.BoundPathByMinCommonAncestors(e),this.BoundAxisEdgesAdjacentToSourceAndTargetOnEdge(e)}BoundPathByMinCommonAncestors(e){for(let t of this.GetMinCommonAncestors(e.GeomEdge)){let r=t.BoundingBox;for(let t of e.PathEdges()){let e=t.AxisEdge;e.Direction===this.NudgingDirection&&this.BoundAxisEdgeByRect(r,e)}}}GetMinCommonAncestors(e){null==this.PortToShapes&&(this.PortToShapes=ia.MapPortsToShapes(this.AncestorsSets.keys()));let t=function(e,t){let r=new Set;if(e.size<t.size)for(let i of e)t.has(i)&&r.add(i);else for(let i of t)e.has(i)&&r.add(i);return r}(this.AncestorsForPort(e.sourcePort),this.AncestorsForPort(e.targetPort));return Array.from(t).filter(e=>!e.Children.some(e=>t.has(e)))}AncestorsForPort(e){let t=this.PortToShapes.get(e);return t?this.AncestorsSets.get(t):new Set(this.HierarchyOfGroups.AllHitItems(M.mkPP(e.Location,e.Location),null))}BoundAxisEdgeAdjacentToObstaclePort(e,t){null==e.Curve?this.BoundAxisByPoint(e.Location,t):e.Curve.boundingBox.contains(e.Location)&&this.BoundAxisEdgeByRect(e.Curve.boundingBox,t)}BoundAxisByPoint(e,t){null!=t&&t.Direction===this.NudgingDirection&&(this.NudgingDirection===eh.North?(t.BoundFromLeft(e.x),t.BoundFromRight(e.x)):(t.BoundFromLeft(-e.y),t.BoundFromRight(-e.y)))}BoundAxisEdgesAdjacentToSourceAndTargetOnEdge(e){this.BoundAxisEdgeAdjacentToObstaclePort(e.GeomEdge.sourcePort,e.FirstEdge.AxisEdge),this.BoundAxisEdgeAdjacentToObstaclePort(e.GeomEdge.targetPort,e.LastEdge.AxisEdge)}BoundAxisEdgeByRect(e,t){null!=t&&t.Direction===this.NudgingDirection&&(this.NudgingDirection===eh.North?(t.BoundFromLeft(e.left),t.BoundFromRight(e.right)):(t.BoundFromLeft(-1*e.top),t.BoundFromRight(-1*e.bottom)))}CreateLongestNudgedSegments(){let e=this.NudgingDirection===eh.East?e=>-e.y:e=>e.x;this.LongestNudgedSegs=[];for(let t=0;t<this.Paths.length;t++)this.CreateLongestNudgedSegmentsForPath(this.Paths[t],e)}CreateLongestNudgedSegmentsForPath(e,t){this.GoOverPathAndCreateLongSegs(e),ia.CalculateIdealPositionsForLongestSegs(e,t)}static CalculateIdealPositionsForLongestSegs(e,t){let r=null,i=null,n=t(e.Start);for(let s of e.PathEdges())if(null!=s.LongestNudgedSegment){if(r=s.LongestNudgedSegment,null!=i){let e;ia.SetIdealPositionForSeg(i,e=t(i.start),n,t(r.Start)),n=e,i=null}}else null!=r&&(i=r,r=null);null!=i?ia.SetIdealPositionForSeg(i,t(i.Start),n,t(e.End)):null!=r&&(r.IdealPosition=t(r.Start))}static SetIdealPositionForSeg(e,t,r,i){let n=Math.max(r,i),s=Math.min(r,i);s+l.distanceEpsilon<t?t<n?e.IdealPosition=.5*(n+s):e.IdealPosition=n:e.IdealPosition=s}GoOverPathAndCreateLongSegs(e){let t=null,r=B.OppositeDir(this.NudgingDirection);for(let i of e.PathEdges()){let e=i.Direction;e===this.NudgingDirection||e===r?(null==t?(i.LongestNudgedSegment=t=new ie(this.LongestNudgedSegs.length),this.LongestNudgedSegs.push(t)):i.LongestNudgedSegment=t,i.IsFixed&&(t.IsFixed=!0)):(i.LongestNudgedSegment=null,t=null)}}static BuildPolylineForPath(e){let t={points:e.PathPoints.map(e=>e.clone())};return ia.ExtendPolylineToPorts(t,e),t.points}static ExtendPolylineToPorts(e,t){ia.ExtendPolylineToSourcePort(e,t.GeomEdge.sourcePort.Location),ia.ExtendPolylineToTargetPort(e,t.GeomEdge.targetPort.Location),e.points.length<2&&(e.points=[,,],e.points[0]=t.GeomEdge.sourcePort.Location,e.points[1]=t.GeomEdge.targetPort.Location)}static ExtendPolylineToTargetPort(e,t){let r=e.points.length-1,i=B.VectorDirectionPP(e.points[r-1],e.points[r]);if(ia.ProjectionsAreClose(e.points[r-1],i,t)){e.points=e.points.slice(0,r);return}let n=e.points[r];i===eh.East||i===eh.West?e.points[r]=new g(t.x,n.y):e.points[r]=new g(n.x,t.y)}static ProjectionsAreClose(e,t,r){return t===eh.East||t===eh.West?c(e.x,r.x):c(e.y,r.y)}static ExtendPolylineToSourcePort(e,t){let r=B.VectorDirectionPP(e.points[0],e.points[1]);if(ia.ProjectionsAreClose(e.points[1],r,t)){e.points=e.points.slice(1);return}let i=e.points[0];r===eh.East||r===eh.West?e.points[0]=new g(t.x,i.y):e.points[0]=new g(i.x,t.y)}static RemoveSwitchbacksAndMiddlePoints(e){let t=[],r=e[0];t.push(r);let i=e[1],n=B.VectorDirectionPP(r,i),s=1;for(;++s<e.length;){let o=B.VectorDirectionPP(i,e[s]);!(o===n||B.OppositeDir(o)===n||o===eh.None)&&(!g.closeDistEps(r,i)&&t.push(r=ia.Rectilinearise(r,i)),n=o),i=e[s]}return!g.closeDistEps(r,i)&&t.push(ia.Rectilinearise(r,i)),t}static NudgePaths(e,t,r,i,n){if(0===e.length)return;let s=new ia(e,t,r,i);for(let t of(s.Calculate(eh.North,!0),s.Calculate(eh.East,!1),s.Calculate(eh.North,!1),n&&s.RemoveStaircases(),e))t.GeomEdge.curve=A.mkFromPoints(ia.BuildPolylineForPath(t))}RemoveStaircases(){io.RemoveStaircases(this.Paths,this.HierarchyOfObstacles)}static MapPortsToShapes(e){let t=new Map;for(let r of e)for(let e of r.Ports)t.set(e,r);return t}static*GetEdgePathFromPathEdgesAsDebugCurves(e,t,r,i){let n=i.ArrayOfPathPoints(),s=n.length,o=s>1?(t-e)/(s-1):1;for(let t=0;t<n.length-1;t++)yield r0.mkDebugCurveTWCI(200,e+o*t,r,b.mkPP(n[t],n[t+1]))}}class il{constructor(e,t){this.Crossings=[],this.Location=e,this.Crossings=t}}class ih{Count(){return this.ListOfPointsAndCrossings.length}constructor(){this.ListOfPointsAndCrossings=[],this.index=0,this.ListOfPointsAndCrossings=[]}Add(e,t){this.ListOfPointsAndCrossings.push(new il(e,t))}Pop(){return this.ListOfPointsAndCrossings[this.index++]}CurrentIsBeforeOrAt(e){return!(this.index>=this.ListOfPointsAndCrossings.length)&&0>=D.ComparePP(this.ListOfPointsAndCrossings[this.index].Location,e)}get First(){return this.ListOfPointsAndCrossings[0]}get Last(){return this.ListOfPointsAndCrossings[this.ListOfPointsAndCrossings.length-1]}Reset(){this.index=0}MergeFrom(e){if(this.Reset(),null==e)return;let t=this.ListOfPointsAndCrossings.length,r=0,i=e.ListOfPointsAndCrossings.length,n=0,s=Array(this.ListOfPointsAndCrossings.length);for(;r<t||n<i;){if(r>=t){s.push(e.ListOfPointsAndCrossings[n++]);continue}if(n>=i){s.push(this.ListOfPointsAndCrossings[r++]);continue}let o=this.ListOfPointsAndCrossings[r],a=e.ListOfPointsAndCrossings[n],l=D.ComparePP(o.Location,a.Location);0===l?(s.push(o),++r,++n):-1===l?(s.push(o),++r):(s.push(a),++n)}this.ListOfPointsAndCrossings=s}Trim(e,t){if(this.Reset(),null!=this.ListOfPointsAndCrossings&&0!==this.ListOfPointsAndCrossings.length)this.ListOfPointsAndCrossings=this.ListOfPointsAndCrossings.filter(r=>D.ComparePP(r.Location,e)>=0&&0>=D.ComparePP(r.Location,t))}static ToCrossingArray(e,t){let r=0,i=e.length;for(let n=0;n<i;n++)e[n].DirectionToInside===t&&r++;if(0===r)return null;let n=Array(r),s=0;for(let r=0;r<i;r++)e[r].DirectionToInside===t&&(n[s++]=e[r]);return n}ToString(){return tb.String.format("{0} [{1}]",this.ListOfPointsAndCrossings.length,this.index)}}class iu{static EdgeDirectionVE(e){return iu.EdgeDirectionVV(e.Source,e.Target)}static EdgeDirectionVV(e,t){return D.GetDirections(e.point,t.point)}static GetEdgeEnd(e,t){return t===iu.EdgeDirectionVE(e)?e.Target:e.Source}static FindAdjacentVertex(e,t){for(let r of e.InEdges)if(D.GetDirections(e.point,r.SourcePoint)===t)return r.Source;for(let r of e.OutEdges)if(D.GetDirections(e.point,r.TargetPoint)===t)return r.Target;return null}static FindAdjacentEdge(e,t){for(let r of e.InEdges)if(D.GetDirections(r.SourcePoint,e.point)===t)return r;for(let r of e.OutEdges)if(D.GetDirections(e.point,r.TargetPoint)===t)return r;return null}static FindBendPointBetween(e,t,r){return iu.IsVerticalD(r)?new g(t.x,e.y):new g(e.x,t.y)}static SegmentIntersectionPPP(e,t,r){let i=D.GetDirections(e,t);return iu.IsVerticalD(i)?new g(e.x,r.y):new g(r.x,e.y)}static SegmentIntersectionSP(e,t){return iu.SegmentIntersectionPPP(e.Start,e.End,t)}static SegmentsIntersection(e,t){return iu.IntervalsIntersect(e.Start,e.End,t.Start,t.End)}static SegmentsIntersectLL(e,t){return iu.IntervalsIntersect(e.start,e.end,t.start,t.end)}static IntervalsOverlapSS(e,t){return iu.IntervalsOverlapPPPP(e.Start,e.End,t.Start,t.End)}static IntervalsOverlapPPPP(e,t,r,i){return iu.IntervalsAreCollinear(e,t,r,i)&&D.ComparePP(e,i)!==D.ComparePP(t,r)}static IntervalsAreCollinear(e,t,r,i){let n=iu.IsVerticalPP(e,t);return iu.IsVerticalPP(r,i)===n&&(n?D.Equal(e.x,r.x):D.Equal(e.y,r.y))}static IntervalsAreSame(e,t,r,i){return D.EqualPP(e,r)&&D.EqualPP(t,i)}static IntervalsIntersect(e,t,r,i){let n=iu.SegmentIntersectionPPP(e,t,r);return iu.PointIsOnSegmentPPP(e,t,n)&&iu.PointIsOnSegmentPPP(r,i,n)?n:void 0}static SegmentIntersectionEP(e,t){return iu.SegmentIntersectionPPP(e.SourcePoint,e.TargetPoint,t)}static PointIsOnSegmentPPP(e,t,r){return D.EqualPP(e,r)||D.EqualPP(t,r)||D.GetDirections(e,r)===D.GetDirections(r,t)}static PointIsOnSegmentSP(e,t){return iu.PointIsOnSegmentPPP(e.Start,e.End,t)}static IsVerticalD(e){return 0!=(e&(eh.North|eh.South))}static IsVerticalE(e){return iu.IsVerticalD(D.GetDirections(e.SourcePoint,e.TargetPoint))}static IsVerticalPP(e,t){return iu.IsVerticalD(D.GetDirections(e,t))}static IsVertical(e){return iu.IsVerticalD(D.GetDirections(e.start,e.end))}static IsAscending(e){return(e&(eh.North|eh.East))!=0}static Slope(e,t,r){let i=t.sub(e);return i.dot(r.PerpDirectionAsPoint)/i.dot(r.DirectionAsPoint)}static SortAscending(e,t){let r=D.GetDirections(e,t);return eh.None===r||iu.IsAscending(r)?[e,t]:[t,e]}static RectangleBorderIntersect(e,t,r){switch(r){case eh.North:case eh.South:return new g(t.x,iu.GetRectangleBound(e,r));case eh.East:case eh.West:return new g(iu.GetRectangleBound(e,r),t.y);default:throw Error()}}static GetRectangleBound(e,t){switch(t){case eh.North:return e.top;case eh.South:return e.bottom;case eh.East:return e.right;case eh.West:return e.left;default:throw Error()}}static RectangleInteriorsIntersect(e,t){return 0>D.Compare(e.bottom,t.top)&&0>D.Compare(t.bottom,e.top)&&0>D.Compare(e.left,t.right)&&0>D.Compare(t.left,e.right)}static PointIsInRectangleInterior(e,t){return 0>D.Compare(e.y,t.top)&&0>D.Compare(t.bottom,e.y)&&0>D.Compare(e.x,t.right)&&0>D.Compare(t.left,e.x)}}class ic{get Dir(){return this.dir}set Dir(e){this.dir=e}constructor(e){this.Dir=e,this.DirectionAsPoint=B.toPoint(this.Dir),this.PerpDirection=eh.North===e?eh.East:eh.North,this.PerpDirectionAsPoint=B.toPoint(this.PerpDirection),this.OppositeDirection=B.OppositeDir(e)}get IsHorizontal(){return eh.East===this.Dir}get IsVertical(){return eh.North===this.Dir}Compare(e,t){let r=this.ComparePerpCoord(e,t);return 0!==r?r:this.CompareScanCoord(e,t)}CompareScanCoord(e,t){return D.Compare(e.sub(t).dot(this.DirectionAsPoint),0)}ComparePerpCoord(e,t){return D.Compare(e.sub(t).dot(this.PerpDirectionAsPoint),0)}IsFlatS(e){return this.IsFlatPP(e.Start,e.End)}IsFlatPP(e,t){return D.Equal(t.sub(e).dot(this.PerpDirectionAsPoint),0)}IsPerpendicularS(e){return this.IsPerpendicularPP(e.Start,e.End)}IsPerpendicularPP(e,t){return D.Equal(t.sub(e).dot(this.DirectionAsPoint),0)}Coord(e){return e.dot(this.DirectionAsPoint)}Min(e,t){return 0>=this.Compare(e,t)?e:t}Max(e,t){return this.Compare(e,t)>=0?e:t}get PerpendicularInstance(){return this.IsHorizontal?ic.VerticalInstance:ic.HorizontalInstance}static GetInstance(e){return iu.IsVerticalD(e)?ic.VerticalInstance:ic.HorizontalInstance}ToString(){return this.Dir.toString()}}ic.HorizontalInstance=new ic(eh.East),ic.VerticalInstance=new ic(eh.North);class id extends tk{static mk(e,t){return new id(e,t,id.NormalWeight,null)}constructor(e,t,r,i){super(),this.Update(e,t),this.Weight=r,this.GroupBoundaryPointAndCrossingsList=i}get Start(){return this.startPoint}get End(){return this.endPoint}get IsVertical(){return id.IsVerticalSegment(this.Start,this.End)}get ScanDirection(){return this.IsVertical?ic.VerticalInstance:ic.HorizontalInstance}get IsOverlapped(){return id.OverlappedWeight===this.Weight}get IsReflection(){return id.ReflectionWeight===this.Weight}static IsVerticalSegment(e,t){return e.x===t.x}MergeGroupBoundaryCrossingList(e){null!=e&&(null==this.GroupBoundaryPointAndCrossingsList&&(this.GroupBoundaryPointAndCrossingsList=new ih),this.GroupBoundaryPointAndCrossingsList.MergeFrom(e))}TrimGroupBoundaryCrossingList(){null!=this.GroupBoundaryPointAndCrossingsList&&this.GroupBoundaryPointAndCrossingsList.Trim(this.Start,this.End)}Update(e,t){this.startPoint=e,this.endPoint=t}SetInitialVisibilityVertex(e){this.LowestVisibilityVertex=e,this.HighestVisibilityVertex=e}AppendVisibilityVertex(e,t){if(null==this.HighestVisibilityVertex)!this.AddGroupCrossingsBeforeHighestVisibilityVertex(e,t)&&this.SetInitialVisibilityVertex(t);else{if(D.IsPureLower(t.point,this.HighestVisibilityVertex.point))return;!this.AddGroupCrossingsBeforeHighestVisibilityVertex(e,t)&&this.AppendHighestVisibilityVertex(t)}}AddVisibilityEdge(e,t){let r=new ty(e,t,this.Weight);return tT.AddEdge(r),r}AppendHighestVisibilityVertex(e){!D.EqualPP(this.HighestVisibilityVertex.point,e.point)&&(this.AddVisibilityEdge(this.HighestVisibilityVertex,e),this.HighestVisibilityVertex=e)}LoadStartOverlapVertexIfNeeded(e){if(this.NeedStartOverlapVertex){let t=e.FindVertex(this.Start);this.AppendVisibilityVertex(e,null!=t?t:e.AddVertexP(this.Start))}}LoadEndOverlapVertexIfNeeded(e){if(this.NeedEndOverlapVertex){let t=e.FindVertex(this.End);this.AppendVisibilityVertex(e,null!=t?t:e.AddVertexP(this.End))}}OnSegmentIntersectorBegin(e){!this.AppendGroupCrossingsThroughPoint(e,this.Start)&&this.LoadStartOverlapVertexIfNeeded(e)}OnSegmentIntersectorEnd(e){this.AppendGroupCrossingsThroughPoint(e,this.End),this.GroupBoundaryPointAndCrossingsList=null,(null==this.HighestVisibilityVertex||D.IsPureLower(this.HighestVisibilityVertex.point,this.End))&&this.LoadEndOverlapVertexIfNeeded(e)}static Subsume(e,t,r,i,n,s,o,a){if(a.extendStart=!0,a.extendEnd=!0,null==e.seg||!iu.IntervalsOverlapPPPP(e.seg.Start,e.seg.End,t,r))return!1;if(e.seg.Weight!==i)return e.seg.Start===t&&e.seg.End===r&&(e.seg.Weight=Math.min(e.seg.Weight,i),!0);return a.extendStart=-1===s.CompareScanCoord(t,e.seg.Start),a.extendEnd=1===s.CompareScanCoord(r,e.seg.End),(a.extendStart||a.extendEnd)&&(o.Remove(e.seg),e.seg.startPoint=s.Min(e.seg.Start,t),e.seg.endPoint=s.Max(e.seg.End,r),e.seg=o.InsertUnique(e.seg).item,e.seg.MergeGroupBoundaryCrossingList(n)),!0}IntersectsSegment(e){return void 0!==iu.SegmentsIntersection(this,e)}toString(){return"["+this.Start+" -> "+this.End+(this.IsOverlapped?" olap":" free")+"]"}ContainsPoint(e){return D.EqualPP(this.Start,e)||D.EqualPP(this.End,e)||D.GetDirections(this.Start,e)===D.GetDirections(e,this.End)}get HasSparsePerpendicularCoords(){return null!=this.sparsePerpendicularCoords&&this.sparsePerpendicularCoords.size>0}CreatePointFromPerpCoord(e){return this.IsVertical?new g(this.Start.x,e):new g(e,this.Start.y)}AddSparseVertexCoord(e){null==this.sparsePerpendicularCoords&&(this.sparsePerpendicularCoords=new Set),this.sparsePerpendicularCoords.add(e)}AddSparseEndpoint(e){return!this.sparsePerpendicularCoords.has(e)&&(this.sparsePerpendicularCoords.add(e),!0)}CreateSparseVerticesAndEdges(e){var t;if(null!=this.sparsePerpendicularCoords){for(let r of(this.AppendGroupCrossingsThroughPoint(e,this.Start),Array.from(this.sparsePerpendicularCoords.values()).sort(h))){let i=this.CreatePointFromPerpCoord(r);this.AppendVisibilityVertex(e,null!==(t=e.FindVertex(i))&&void 0!==t?t:e.AddVertexP(i))}this.AppendGroupCrossingsThroughPoint(e,this.End),this.GroupBoundaryPointAndCrossingsList=null,this.sparsePerpendicularCoords.clear(),this.sparsePerpendicularCoords=null}}HasVisibility(){return null!=this.LowestVisibilityVertex}AddGroupCrossingsBeforeHighestVisibilityVertex(e,t){return!!this.AppendGroupCrossingsThroughPoint(e,t.point)&&(D.IsPureLower(this.HighestVisibilityVertex.point,t.point)&&(this.AddVisibilityEdge(this.HighestVisibilityVertex,t),this.HighestVisibilityVertex=t),!0)}AppendGroupCrossingsThroughPoint(e,t){var r;if(null==this.GroupBoundaryPointAndCrossingsList)return!1;let i=!1;for(;this.GroupBoundaryPointAndCrossingsList.CurrentIsBeforeOrAt(t);){let t=this.GroupBoundaryPointAndCrossingsList.Pop(),n=null,s=null;D.ComparePP(t.Location,this.Start)>0&&(n=ih.ToCrossingArray(t.Crossings,this.ScanDirection.OppositeDirection)),0>D.ComparePP(t.Location,this.End)&&(s=ih.ToCrossingArray(t.Crossings,this.ScanDirection.Dir)),i=!0;let o=null!==(r=e.FindVertex(t.Location))&&void 0!==r?r:e.AddVertexP(t.Location);e.AddVertexP(t.Location),null!=n||null!=s?(this.AddLowCrossings(e,o,n),this.AddHighCrossings(e,o,s)):null==this.LowestVisibilityVertex?this.SetInitialVisibilityVertex(o):this.AppendHighestVisibilityVertex(o)}return i}static GetCrossingInteriorVertex(e,t,r){var i;let n=r.GetInteriorVertexPoint(t.point);return null!==(i=e.FindVertex(n))&&void 0!==i?i:e.AddVertexP(n)}AddCrossingEdge(e,t,r,i){let n=null;null!=this.HighestVisibilityVertex&&(D.EqualPP(this.HighestVisibilityVertex.point,r.point)?n=e.FindEdgePP(t.point,r.point):this.AppendHighestVisibilityVertex(t)),null==n&&(n=this.AddVisibilityEdge(t,r));let s=i.map(e=>e.Group.InputShape),o=n.IsPassable;null==o?n.IsPassable=()=>{for(let e of s)if(e.IsTransparent)return!0;return!1}:n.IsPassable=()=>{for(let e of s)if(e.IsTransparent||o())return!0;return!1},null==this.LowestVisibilityVertex&&this.SetInitialVisibilityVertex(t),this.HighestVisibilityVertex=r}AddLowCrossings(e,t,r){if(null!=r){let i=id.GetCrossingInteriorVertex(e,t,r[0]);this.AddCrossingEdge(e,i,t,r)}}AddHighCrossings(e,t,r){if(null!=r){let i=id.GetCrossingInteriorVertex(e,t,r[0]);this.AddCrossingEdge(e,t,i,r)}}}id.NormalWeight=ty.DefaultWeight,id.ReflectionWeight=5,id.OverlappedWeight=500;class ip{constructor(e,t,r,i,n){this.IsClosed=!1,this.Vertex=e,this.Direction=null!=t?B.DirectionFromPointToPoint(t.Vertex.point,e.point):eh.None,this.ResetEntry(t,r,i,n)}ResetEntry(e,t,r,i){this.PreviousEntry=e,this.Length=t,this.NumberOfBends=r,this.Cost=i}get PreviousVertex(){return null==this.PreviousEntry?null:this.PreviousEntry.Vertex}toString(){return this.Vertex.point+(" "+(this.Direction+(" "+(this.IsClosed+" "))))+this.Cost}}class ig{constructor(){this.Clear()}Set(e,t){this.Vertex=e,this.Weight=t}Clear(){this.Vertex=null,this.Weight=Number.NaN}}class im{CombinedCost(e,t){return this.LengthImportance*e+this.BendsImportance*t}TotalCostFromSourceToVertex(e,t){return this.CombinedCost(e,t)+this.sourceCostAdjustment}constructor(){this.nextNeighbors=[new ig,new ig,new ig],this.LengthImportance=1,this.BendsImportance=1}InitPath(e,t,r){if(t===r||!this.InitEntryDirectionsAtTarget(r))return!1;this.Target=r,this.Source=t;let i=this.TotalCostFromSourceToVertex(0,0)+this.HeuristicDistanceFromVertexToTarget(t.point,eh.None);return!(i>=this.upperBoundOnCost)&&(this.queue=new rd(h),this.visitedVertices=[t],null==e?this.EnqueueInitialVerticesFromSource(i):this.EnqueueInitialVerticesFromSourceEntries(e),this.queue.count>0)}InitEntryDirectionsAtTarget(e){for(let t of(this.EntryDirectionsToTarget=eh.None,e.OutEdges))this.EntryDirectionsToTarget=this.EntryDirectionsToTarget|B.DirectionFromPointToPoint(t.TargetPoint,e.point);for(let t of e.InEdges)this.EntryDirectionsToTarget=this.EntryDirectionsToTarget|B.DirectionFromPointToPoint(t.SourcePoint,e.point);return this.EntryDirectionsToTarget!==eh.None}static IsInDirs(e,t){return e===(e&t)}MultistageAdjustedCostBound(e){return Number.isFinite(e)?e+this.BendsImportance:e}HeuristicDistanceFromVertexToTarget(e,t){let r;let i=this.Target.point.sub(e);if(c(i.x,0)&&c(i.y,0))return this.targetCostAdjustment;let n=B.VectorDirection(i);return t===eh.None&&(t=eh.East|(eh.North|(eh.West|eh.South))),r=this.GetNumberOfBends(t,n),this.CombinedCost(im.ManhattanDistance(e,this.Target.point),r)+this.targetCostAdjustment}GetNumberOfBends(e,t){return B.IsPureDirection(t)?this.GetNumberOfBendsForPureDirection(e,t):im.GetBendsForNotPureDirection(t,e,this.EntryDirectionsToTarget)}GetNumberOfBendsForPureDirection(e,t){if((t&e)===t)return im.IsInDirs(t,this.EntryDirectionsToTarget)?0:im.IsInDirs(im.Left(t),this.EntryDirectionsToTarget)||im.IsInDirs(im.Right(t),this.EntryDirectionsToTarget)?2:4;return this.GetNumberOfBendsForPureDirection(im.AddOneTurn[e],t)+1}static GetBendsForNotPureDirection(e,t,r){let i=e&t;if(i===eh.None)return im.GetBendsForNotPureDirection(e,im.AddOneTurn[t],r)+1;let n=e&r;return n===eh.None?im.GetBendsForNotPureDirection(e,t,im.AddOneTurn[r])+1:(i|n)===e?1:2}static Left(e){switch(e){case eh.None:return eh.None;case eh.North:return eh.West;case eh.East:return eh.North;case eh.South:return eh.East;case eh.West:return eh.South;default:throw Error("direction")}}static Right(e){switch(e){case eh.None:return eh.None;case eh.North:return eh.East;case eh.East:return eh.South;case eh.South:return eh.West;case eh.West:return eh.North;default:throw Error("direction")}}static RestorePathV(e){return im.RestorePath(e,null)}static RestorePath(e,t){if(null==e.entry)return[];let r=[],i=!1,n=eh.None;for(;;){n===e.entry.Direction?i=!0:(i=!1,r.push(e.entry.Vertex.point),n=e.entry.Direction);let s=e.entry.PreviousEntry;if(null==s||e.entry.Vertex===t)break;e.entry=s}return i&&r.push(e.entry.Vertex.point),r.reverse(),r}QueueReversedEntryToNeighborVertexIfNeeded(e,t,r){let i={numberOfBends:0,length:0},n=t.PreviousVertex,s=im.GetLengthAndNumberOfBendsToNeighborVertex(e,n,r,i);if(this.CombinedCost(i.length,i.numberOfBends)<this.CombinedCost(t.Length,t.NumberOfBends)||1===e.Vertex.Degree){let t=this.TotalCostFromSourceToVertex(i.length,i.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(n.point,s);this.EnqueueEntry(e,n,i.length,i.numberOfBends,t)}}UpdateEntryToNeighborVertexIfNeeded(e,t,r){let i={numberOfBends:0,length:0},n=im.GetLengthAndNumberOfBendsToNeighborVertex(e,t.Vertex,r,i);if(this.CombinedCost(i.length,i.numberOfBends)<this.CombinedCost(t.Length,t.NumberOfBends)){let r=this.TotalCostFromSourceToVertex(i.length,i.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(t.Vertex.point,n);t.ResetEntry(e,i.length,i.numberOfBends,r),this.queue.DecreasePriority(t,r)}}CreateAndEnqueueEntryToNeighborVertex(e,t,r){let i={numberOfBends:0,length:0},n=im.GetLengthAndNumberOfBendsToNeighborVertex(e,t,r,i),s=this.TotalCostFromSourceToVertex(i.length,i.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(t.point,n);s<this.upperBoundOnCost&&(null==t.VertexEntries&&this.visitedVertices.push(t),this.EnqueueEntry(e,t,i.length,i.numberOfBends,s))}EnqueueEntry(e,t,r,i,n){let s=new ip(t,e,r,i,n);t.SetVertexEntry(s),this.queue.Enqueue(s,s.Cost)}static GetLengthAndNumberOfBendsToNeighborVertex(e,t,r,i){i.length=e.Length+im.ManhattanDistance(e.Vertex.point,t.point)*r;let n=B.DirectionFromPointToPoint(e.Vertex.point,t.point);return i.numberOfBends=e.NumberOfBends,e.Direction!==eh.None&&n!==e.Direction&&i.numberOfBends++,n}static ManhattanDistance(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}GetPathWithCost(e,t,r,i,n,s,o){if(this.upperBoundOnCost=o,this.sourceCostAdjustment=r,this.targetCostAdjustment=s,!this.InitPath(e,t,n))return null;for(;this.queue.count>0;){let e=this.queue.Dequeue(),t=e.Vertex;if(t===this.Target){if(null==i)return this.Cleanup(),e;if(e.Direction,this.EntryDirectionsToTarget===eh.None){let e=0;for(let t of this.Target.VertexEntries)i[e++]=t;return this.Cleanup(),null}this.upperBoundOnCost=Math.min(this.MultistageAdjustedCostBound(e.Cost),this.upperBoundOnCost);continue}for(let t of(e.IsClosed=!0,this.nextNeighbors))t.Clear();let r=im.Right(e.Direction);for(let i of(this.ExtendPathAlongInEdges(e,t.InEdges,r),this.ExtendPathAlongOutEdges(e,t.OutEdges,r),this.nextNeighbors))null!=i.Vertex&&this.ExtendPathToNeighborVertex(e,i.Vertex,i.Weight)}if(null!=i&&null!=this.Target.VertexEntries)for(let e=0;e<this.Target.VertexEntries.length;e++)i[e]=this.Target.VertexEntries[e];return this.Cleanup(),null}ExtendPathAlongInEdges(e,t,r){for(let i of t)this.ExtendPathAlongEdge(e,i,!0,r)}ExtendPathAlongOutEdges(e,t,r){let i=t.isEmpty()?null:t.treeMinimum();for(;null!=i;i=t.next(i))this.ExtendPathAlongEdge(e,i.item,!1,r)}ExtendPathAlongEdge(e,t,r,i){if(!im.IsPassable(t))return;let n=r?t.Source:t.Target;if(n===e.PreviousVertex){if(e.Vertex.Degree>1||e.Vertex!==this.Source)return;this.ExtendPathToNeighborVertex(e,n,t.Weight);return}let s=B.DirectionFromPointToPoint(e.Vertex.point,n.point),o=this.nextNeighbors[2];s!==e.Direction&&(o=this.nextNeighbors[s===i?1:0]),o.Set(n,t.Weight)}EnqueueInitialVerticesFromSource(e){let t=new ip(this.Source,null,0,0,e);for(let e of(t.IsClosed=!0,this.Source.OutEdges))im.IsPassable(e)&&this.ExtendPathToNeighborVertex(t,e.Target,e.Weight);for(let e of this.Source.InEdges)im.IsPassable(e)&&this.ExtendPathToNeighborVertex(t,e.Source,e.Weight)}EnqueueInitialVerticesFromSourceEntries(e){for(let t of e)null!=t&&this.queue.Enqueue(t,t.Cost)}ExtendPathToNeighborVertex(e,t,r){let i=B.DirectionFromPointToPoint(e.Vertex.point,t.point),n=null!=t.VertexEntries?t.VertexEntries[B.ToIndex(i)]:null;null==n?!this.CreateAndEnqueueReversedEntryToNeighborVertex(e,t,r)&&this.CreateAndEnqueueEntryToNeighborVertex(e,t,r):!n.IsClosed&&this.UpdateEntryToNeighborVertexIfNeeded(e,n,r)}CreateAndEnqueueReversedEntryToNeighborVertex(e,t,r){if(null!=e.Vertex.VertexEntries){let i=B.DirectionFromPointToPoint(t.point,e.Vertex.point),n=e.Vertex.VertexEntries[B.ToIndex(i)];if(null!=n)return this.QueueReversedEntryToNeighborVertexIfNeeded(e,n,r),!0}return!1}static IsPassable(e){return null==e.IsPassable||e.IsPassable()}Cleanup(){for(let e of this.visitedVertices)e.RemoveVertexEntries();this.visitedVertices=[],this.queue=null}}im.DefaultBendPenaltyAsAPercentageOfDistance=4,im.AddOneTurn=[eh.None,eh.North|eh.East|eh.West,eh.North|eh.East|eh.South,15,eh.East|eh.South|eh.West,15,15,15,13,15,15,15,15,15,15,15];class iv{constructor(e){this.bendPenaltyAsAPercentageOfDistance=im.DefaultBendPenaltyAsAPercentageOfDistance,this.currentPassTargetEntries=[,,,,],this.bendPenaltyAsAPercentageOfDistance=e}GetPath(e,t){let r={entry:this.GetPathStage(null,e,null,t)};return im.RestorePathV(r)}GetPathStage(e,t,r,i){let n=new im,s={bestEntry:null,bestCost:Number.MAX_VALUE/id.OverlappedWeight},o=Number.POSITIVE_INFINITY,a=iv.Barycenter(t),l=iv.Barycenter(i),h=im.ManhattanDistance(a,l);n.BendsImportance=Math.max(.001,h*(.01*this.bendPenaltyAsAPercentageOfDistance));let u=n.LengthImportance,d=null!=r?this.currentPassTargetEntries:null,f=[];for(let e of t)for(let t of i)f.push([e,t]);for(let[t,i]of(f.sort(([e,t],[r,i])=>p(e,t)-p(r,i)),f)){if(g.closeDistEps(t.point,i.point))continue;let h=m(t,a)*u,f=m(i,l)*u,v=s.bestCost;if(null!=r){for(let e=0;e<d.length;e++)d[e]=null;v=n.MultistageAdjustedCostBound(s.bestCost)}let b=n.GetPathWithCost(e,t,h,d,i,f,v);if(null!=d){iv.UpdateTargetEntriesForEachDirection(r,d,s);continue}if(null==b)continue;let y=b.Cost/p(t,i);(b.Cost<s.bestCost||c(b.Cost,s.bestCost)&&y<o)&&(s.bestCost=b.Cost,s.bestEntry=b,o=b.Cost/p(t,i))}return s.bestEntry;function p(e,t){return im.ManhattanDistance(e.point,t.point)}function m(e,t){return im.ManhattanDistance(e.point,t)}}static UpdateTargetEntriesForEachDirection(e,t,r){for(let i=0;i<t.length;i++){let n=t[i];if(null!=n)(null==e[i]||n.Cost<e[i].Cost)&&(e[i]=n,n.Cost<r.bestCost&&(r.bestCost=n.Cost,r.bestEntry=n))}}static Barycenter(e){let t=new g(0,0);for(let r of e)t=t.add(r.point);return t.div(e.length)}}class ib{get PathPoints(){return this._pathPoints}set PathPoints(e){this._pathPoints=e}get Width(){return this.GeomEdge.lineWidth}constructor(e){this.GeomEdge=e}get End(){return this.LastEdge.Target}get Start(){return this.FirstEdge.Source}ArrayOfPathPoints(){return this._pathPoints instanceof r3?Array.from(iy(this._pathPoints)):this._pathPoints}*PathEdges(){for(let e=this.FirstEdge;null!=e;e=e.Next)yield e}AddEdge(e){e.Path=this,this.LastEdge.Next=e,e.Prev=this.LastEdge,this.LastEdge=e}SetFirstEdge(e){this.FirstEdge=e,this.LastEdge=e,e.Path=this}toString(){let e=new tb.StringBuilder;for(let t of(this.PathPoints instanceof r3&&e.Append("L"),iy(this.PathPoints)))e.Append(t.toString());return e.ToString()}}function*iy(e){if(e instanceof r3)for(let t=e;null!=t;t=t.Next)yield t.Point;else for(let t of e)yield t}class ix extends tN{get Obstacle(){return this.obstacle}set Obstacle(e){this.obstacle=e}constructor(e,t,r,i){super(t),this.Slope=0,this.SlopeInverse=0,this.Obstacle=e,this.endVertex=i?t.nextOnPolyline:t.prevOnPolyline,!r.IsPerpendicularPP(t.point,this.endVertex.point)&&(this.Slope=iu.Slope(t.point,this.endVertex.point,r),this.SlopeInverse=1/this.Slope)}get EndVertex(){return this.endVertex}}class i_ extends ix{constructor(e,t,r){super(e,t,r,r.IsHorizontal)}}class iS extends ix{constructor(e,t,r){super(e,t,r,r.IsVertical)}}class iw{get PaddedPolyline(){return this._PaddedPolyline}set PaddedPolyline(e){this._PaddedPolyline=e}get looseVisibilityPolyline(){return null==this._looseVisibilityPolyline&&(this._looseVisibilityPolyline=iw.CreateLoosePolyline(this.VisibilityPolyline)),this._looseVisibilityPolyline}set looseVisibilityPolyline(e){this._looseVisibilityPolyline=e}GetPortChanges(e){return e.addedPorts=eL(this.InputShape.Ports,this.Ports),e.removedPorts=eL(this.Ports,this.InputShape.Ports),(0!==e.addedPorts.size||0!==e.removedPorts.size)&&(this.Ports=new Set(this.InputShape.Ports),!0)}get IsInConvexHull(){return null!=this.ConvexHull}get IsGroup(){return null!=this.InputShape&&this.InputShape.IsGroup}get VisibilityBoundingBox(){return this.VisibilityPolyline.boundingBox}get VisibilityPolyline(){return null!=this.ConvexHull?this.ConvexHull.Polyline:this.PaddedPolyline}static CreateSentinel(e,t,r,i){let n=iw.mk(e,t,i);return n.CreateInitialSides(n.PaddedPolyline.startPoint,r),n}CreateInitialSides(e,t){this.ActiveLowSide=new i_(this,e,t),this.ActiveHighSide=new iS(this,e,t),t.IsFlatS(this.ActiveHighSide)&&(this.ActiveHighSide=new iS(this,this.ActiveHighSide.EndVertex,t))}constructor(e,t){if(null==e)return;this.PaddedPolyline=rl.PaddedPolylineBoundaryOfNode(e.BoundaryCurve,t),iw.RoundVerticesAndSimplify(this.PaddedPolyline),this.IsRectangle=this.IsPolylineRectangle(),this.InputShape=e,this.Ports=new Set(this.InputShape.Ports)}static mk(e,t,r){let i=new iw(null,0);return i.PaddedPolyline=A.mkClosedFromPoints([g.RoundPoint(e),g.RoundPoint(t)]),i.Ordinal=r,i}IsPolylineRectangle(){if(4!==this.PaddedPolyline.count)return!1;let e=this.PaddedPolyline.startPoint,t=e.nextOnPolyline,r=B.VectorDirectionPP(e.point,t.point);if(!B.IsPureDirection(r))return!1;do{t=(e=t).nextOnPolyline;let i=B.DirectionFromPointToPoint(e.point,t.point);if(i!==B.RotateRight(r))return!1;r=i}while(e!==this.PaddedPolyline.startPoint);return!0}static RoundVerticesAndSimplify(e){let t=e.startPoint;do t.point=g.RoundPoint(t.point),t=t.nextOnPolyline;while(t!==e.startPoint);iw.RemoveCloseAndCollinearVerticesInPlace(e),e.setInitIsRequired()}get IsPrimaryObstacle(){return null==this.ConvexHull||this===this.ConvexHull.PrimaryObstacle}static RemoveCloseAndCollinearVerticesInPlace(e){let t=10*l.intersectionEpsilon;for(let r=e.startPoint.next;null!=r;r=r.next)g.close(r.prev.point,r.point,t)&&(null==r.next?e.RemoveEndPoint():(r.prev.next=r.next,r.next.prev=r.prev));return g.close(e.start,e.end,t)&&e.RemoveStartPoint(),null!=(e=e.RemoveCollinearVertices()).endPoint.prev&&e.endPoint.prev!==e.startPoint&&g.getTriangleOrientation(e.endPoint.prev.point,e.end,e.start)===eo.Collinear&&e.RemoveEndPoint(),null!=e.startPoint.next&&e.endPoint.prev!==e.startPoint&&g.getTriangleOrientation(e.end,e.start,e.startPoint.next.point)===eo.Collinear&&e.RemoveStartPoint(),e.setInitIsRequired(),e}get isOverlapped(){return void 0!==this.clump&&this.clump.length>0}get IsSentinel(){return null==this.InputShape}IsInSameClump(e){return this.isOverlapped&&this.clump===e.clump}Close(){this.ActiveLowSide=null,this.ActiveHighSide=null}SetConvexHull(e){this.clump=null,this.IsRectangle=!1,this.ConvexHull=e,this.looseVisibilityPolyline=null}static CreateLoosePolyline(e){let t=rl.CreatePaddedPolyline(e,10*l.intersectionEpsilon);return iw.RoundVerticesAndSimplify(t),t}get IsTransparentAncestor(){return null!=this.InputShape&&this.InputShape.IsTransparent}set IsTransparentAncestor(e){this.InputShape.IsTransparent=e}}iw.FirstSentinelOrdinal=1,iw.FirstNonSentinelOrdinal=10;class iT{get Obstacle(){return this.ObstaclePort.Obstacle}get InitialWeight(){return this.IsOverlapped?id.OverlappedWeight:id.NormalWeight}get IsCollinearWithPort(){return B.IsPureDirection(D.GetDirections(this.VisibilityBorderIntersect,this.ObstaclePort.Location))}get IsVertical(){return iu.IsVertical(this.MaxVisibilitySegment)}get WantVisibilityIntersection(){return!this.IsOverlapped&&this.CanExtend&&(!this.ObstaclePort.HasCollinearEntrances||this.IsCollinearWithPort)}get CanExtend(){return D.GetDirections(this.MaxVisibilitySegment.start,this.MaxVisibilitySegment.end)!==eh.None}constructor(e,t,r,i){this.IsOverlapped=!1,this.unpaddedToPaddedBorderWeight=id.NormalWeight,this.ObstaclePort=e,this.UnpaddedBorderIntersect=t,this.OutwardDirection=r;let n=b.mkPP(this.UnpaddedBorderIntersect,iu.RectangleBorderIntersect(e.Obstacle.VisibilityBoundingBox,this.UnpaddedBorderIntersect,r)),s=C.getAllIntersections(n,e.Obstacle.VisibilityPolyline,!0);this.VisibilityBorderIntersect=g.RoundPoint(s[0].x);let o={pacList:null};this.MaxVisibilitySegment=i.CreateMaxVisibilitySegment(this.VisibilityBorderIntersect,this.OutwardDirection,o),this.pointAndCrossingsList=o.pacList,(this.Obstacle.isOverlapped||this.Obstacle.IsGroup&&!this.Obstacle.IsInConvexHull)&&(this.IsOverlapped=i.IntersectionIsInsideAnotherObstacle(null,this.Obstacle,this.VisibilityBorderIntersect,ic.GetInstance(this.OutwardDirection)),(!this.Obstacle.IsGroup||this.IsOverlapped||this.InteriorEdgeCrossesObstacle(i))&&(this.unpaddedToPaddedBorderWeight=id.OverlappedWeight)),this.Obstacle.IsInConvexHull&&this.unpaddedToPaddedBorderWeight===id.NormalWeight&&this.SetUnpaddedToPaddedBorderWeightFromHullSiblingOverlaps(i)}SetUnpaddedToPaddedBorderWeightFromHullSiblingOverlaps(e){(this.Obstacle.IsGroup?this.InteriorEdgeCrossesObstacle(e):this.InteriorEdgeCrossesConvexHullSiblings())&&(this.unpaddedToPaddedBorderWeight=id.OverlappedWeight)}InteriorEdgeCrossesObstacle(e){let t=M.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect);return this.InteriorEdgeCrossesObstacleRFI(t,e=>e.VisibilityPolyline,Array.from(e.Root.GetLeafRectangleNodesIntersectingRectangle(t)).filter(e=>!e.UserData.IsGroup&&e.UserData!==this.Obstacle).map(e=>e.UserData))}InteriorEdgeCrossesConvexHullSiblings(){let e=M.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect);return this.InteriorEdgeCrossesObstacleRFI(e,e=>e.PaddedPolyline,this.Obstacle.ConvexHull.Obstacles.filter(e=>e!==this.Obstacle))}InteriorEdgeCrossesObstacleRFI(e,t,r){let i=null;for(let n of r){let r=t(n);if(!!iu.RectangleInteriorsIntersect(e,r.boundingBox)){if(i=null!=i?i:b.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect),null!=C.intersectionOne(i,r,!1)||el.Outside!==C.PointRelativeToCurveLocation(this.UnpaddedBorderIntersect,r))return!0}}return!1}get HasGroupCrossings(){return null!=this.pointAndCrossingsList&&this.pointAndCrossingsList.Count()>0}HasGroupCrossingBeforePoint(e){if(!this.HasGroupCrossings)return!1;let t=iu.IsAscending(this.OutwardDirection)?this.pointAndCrossingsList.First:this.pointAndCrossingsList.Last;return D.GetDirections(this.MaxVisibilitySegment.start,t.Location)===D.GetDirections(t.Location,e)}AddToAdjacentVertex(e,t,r,i){let n=e.VisGraph.FindVertex(this.VisibilityBorderIntersect);if(null!=n){this.ExtendEdgeChain(e,n,n,r,i);return}this.OutwardDirection===D.GetDirections(t.point,this.VisibilityBorderIntersect)?(this.VisibilityBorderIntersect=t.point,n=t):(n=e.FindOrAddVertex(this.VisibilityBorderIntersect),e.FindOrAddEdge(n,t,this.InitialWeight)),this.ExtendEdgeChain(e,n,t,r,i)}ExtendEdgeChain(e,t,r,i,n){e.ExtendEdgeChainVRLPB(r,i,this.MaxVisibilitySegment,this.pointAndCrossingsList,this.IsOverlapped);let s=e.FindOrAddVertex(this.UnpaddedBorderIntersect);e.FindOrAddEdge(s,t,this.unpaddedToPaddedBorderWeight),n&&e.ConnectVertexToTargetVertex(this.ObstaclePort.CenterVertex,s,this.OutwardDirection,this.InitialWeight)}toString(){return tb.String.format("{0} {1}~{2} {3}",this.ObstaclePort.Location,this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect,this.OutwardDirection)}}class iP{constructor(e,t){this.HasCollinearEntrances=!1,this.VisibilityRectangle=M.mkEmpty(),this.Port=e,this.Obstacle=t,this.PortEntrances=[],this.Location=g.RoundPoint(this.Port.Location)}CreatePortEntrance(e,t,r){let i=new iT(this,e,t,r);this.PortEntrances.push(i),this.VisibilityRectangle.add(i.MaxVisibilitySegment.end),this.HasCollinearEntrances=this.HasCollinearEntrances||i.IsCollinearWithPort}ClearVisibility(){this.PortEntrances=[]}AddToGraph(e,t){t&&(this.CenterVertex=e.FindOrAddVertex(this.Location))}RemoveFromGraph(){this.CenterVertex=null}get LocationHasChanged(){return!g.closeDistEps(this.Location,g.RoundPoint(this.Port.Location))}get PortCurve(){return this.Port.Curve}get PortLocation(){return this.Port.Location}toString(){return this.Port+this.Obstacle.toString()}}class iE{get Point(){return this.Vertex.point}get InitialWeight(){return this.IsOverlapped?id.OverlappedWeight:id.NormalWeight}get IsOutOfBounds(){return eh.None!==this.OutOfBoundsDirectionFromGraph}constructor(e,t){this.maxVisibilitySegmentsAndCrossings=[,,,,],this.OutOfBoundsDirectionFromGraph=eh.None,this.GetVertex(e,t)}GetVertex(e,t){this.Vertex=e.FindOrAddVertex(t)}AddEdgeToAdjacentEdge(e,t,r,i){let n=iu.SegmentIntersectionEP(t,this.Point),s=e.VisGraph.FindVertex(n);return null!=s?this.AddToAdjacentVertex(e,s,r,i):s=e.AddEdgeToTargetEdge(this.Vertex,t,n),this.ExtendEdgeChain(e,s,r,i),s}AddToAdjacentVertex(e,t,r,i){!D.EqualPP(this.Point,t.point)&&e.FindOrAddEdge(this.Vertex,t,this.InitialWeight),this.ExtendEdgeChain(e,t,r,i)}ExtendEdgeChain(e,t,r,i){let n=this.IsOverlapped;n&&(n=e.ObstacleTree.PointIsInsideAnObstaclePD(t.point,r));let s=this.GetSegmentAndCrossings(this.IsOverlapped?t:this.Vertex,r,e);e.ExtendEdgeChainVRLPB(t,i,s[0],s[1],n)}GetSegmentAndCrossings(e,t,r){let i=B.ToIndex(t),n=this.maxVisibilitySegmentsAndCrossings[i];if(null==n){let s={pacList:null};n=[r.ObstacleTree.CreateMaxVisibilitySegment(e.point,t,s),s.pacList],this.maxVisibilitySegmentsAndCrossings[i]=n}else D.GetDirections(e.point,n[0].start)===t&&(n[0].start=e.point);return n}MaxVisibilityInDirectionForNonOverlappedFreePoint(e,t){return this.GetSegmentAndCrossings(this.Vertex,e,t)[0].end}AddOobEdgesFromGraphCorner(e,t){let r=D.GetDirections(t,this.Vertex.point),i=e.VisGraph.FindVertex(t);e.ConnectVertexToTargetVertex(i,this.Vertex,r&(eh.North|eh.South),id.NormalWeight),e.ConnectVertexToTargetVertex(i,this.Vertex,r&(eh.East|eh.West),id.NormalWeight)}RemoveFromGraph(){this.Vertex=null}toString(){return this.Vertex.toString()}}class iC{constructor(e,t){this.BoundaryWidth=l.distanceEpsilon,this.Group=e,this.DirectionToInside=t}GetInteriorVertexPoint(e){return g.RoundPoint(e.add(B.toPoint(this.DirectionToInside).mul(this.BoundaryWidth)))}toString(){return tb.String.format("{0} {1}",this.DirectionToInside,this.Group)}}iC.BoundaryWidth=l.distanceEpsilon;class iA extends td{constructor(e){super(),this.site=e}get Site(){return this.site}}class iI extends tf{constructor(e,t){super(t),this.Obstacle=e}}class iM extends iI{constructor(e,t){super(e,t)}}class iR{AddPendingPerpendicularCoord(e){null==this.pendingPerpCoords&&(this.pendingPerpCoords=[]),this.pendingPerpCoords.push(e)}ResetForIntersections(){this.CurrentSegment=this.FirstSegment}get IsHorizontal(){return!this.FirstSegment.IsVertical}constructor(e){this.Coord=e}TraverseToSegmentContainingPoint(e){if(this.CurrentSegment.ContainsPoint(e))return!0;let t=this.IsHorizontal?e.y:e.x;if(!D.Equal(this.Coord,t)){for(;this.MoveNext(););return!1}for(;;){if((null==this.CurrentSegment.NextSegment||D.GetDirections(this.CurrentSegment.End,e)==D.GetDirections(e,this.CurrentSegment.NextSegment.Start))&&g.closeIntersections(this.CurrentSegment.End,e))return this.CurrentSegment.Update(this.CurrentSegment.Start,e),!0;if(!this.MoveNext())return!1;if(this.CurrentSegment.ContainsPoint(e))return!0;if(D.IsPureLower(e,this.CurrentSegment.Start))return this.CurrentSegment.Update(e,this.CurrentSegment.End),!0}}MoveNext(){return this.CurrentSegment=this.CurrentSegment.NextSegment,this.HasCurrent}get HasCurrent(){return null!=this.CurrentSegment}PointIsCurrentEndAndNextStart(e){return e.equal(this.CurrentSegment.End)&&null!=this.CurrentSegment.NextSegment&&e.equal(this.CurrentSegment.NextSegment.Start)}AddPerpendicularCoord(e){let t=this.IsHorizontal?new g(e,this.Coord):new g(this.Coord,e);this.TraverseToSegmentContainingPoint(t),this.CurrentSegment.AddSparseVertexCoord(e)}toString(){return null==this.FirstSegment?"-0- "+this.Coord:this.IsHorizontal?"(H) Y === "+this.Coord:"(V) X === "}AppendScanSegment(e){null==this.FirstSegment?this.FirstSegment=e:this.CurrentSegment.NextSegment=e,this.CurrentSegment=e}AddPendingPerpendicularCoordsToScanSegments(){if(null!=this.pendingPerpCoords)for(let e of(this.ResetForIntersections(),this.pendingPerpCoords))this.AddPerpendicularCoord(e)}}class iO{constructor(e,t){for(let r of(this.CurrentSlotIndex=0,this.vector=[],this.IsHorizontal=t,Array.from(e).sort((e,t)=>e>t?1:e<t?-1:0)))this.vector.push(new iR(r))}get Length(){return this.vector.length}get CurrentSlot(){return this.vector[this.CurrentSlotIndex]}Item(e){return this.vector[e]}CreateScanSegment(e,t,r,i){this.CurrentSlot.AppendScanSegment(new id(e,t,r,i))}ScanSegmentsCompleteForCurrentSlot(){this.CurrentSlotIndex++}ScanSegmentsComplete(){for(let e of this.vector)e.AddPendingPerpendicularCoordsToScanSegments()}Items(){return this.vector}ResetForIntersections(){for(let e of this.vector)e.ResetForIntersections()}FindNearest(e,t){let r=0,i=this.vector.length-1;if(e<=this.vector[r].Coord)return r;if(e>=this.vector[i].Coord)return i;for(;i-r>2;){let t=r+(i-r>>1),n=this.vector[t];if(e<n.Coord){i=t;continue}if(e>n.Coord){r=t;continue}return t}for(r++;r<=i;r++){let i=this.vector[r];if(e<i.Coord)return t>0?r:r-1;if(e===i.Coord)break}return r}CreateSparseVerticesAndEdges(e){for(let t of this.vector){t.ResetForIntersections();for(let r=t.FirstSegment;null!=r;r=r.NextSegment)r.CreateSparseVerticesAndEdges(e)}}GetParallelCoord(e){return this.IsHorizontal?e.y:e.x}GetPerpendicularCoord(e){return this.IsHorizontal?e.x:e.y}ConnectAdjoiningSegmentEndpoints(){for(let e of this.vector){e.ResetForIntersections();let t=e.FirstSegment;for(let e=t.NextSegment;null!=e;e=e.NextSegment){if(e.HasSparsePerpendicularCoords&&t.HasSparsePerpendicularCoords&&e.Start===t.End){let r=this.GetPerpendicularCoord(e.Start);t.AddSparseEndpoint(r),e.AddSparseEndpoint(r)}t=e}}}toString(){return(this.IsHorizontal?"(H) count":"(V) count === ")+this.vector.length}}class ik extends td{constructor(e,t,r){super(),this.InitialObstacle=e,this.ReflectingObstacle=t,this.site=r}static mk(e,t,r){let i=new ik(e.ReflectingObstacle,t,r);return i.PreviousSite=e,i}IsStaircaseStep(e){return this.InitialObstacle===e}get Site(){return this.site}}class iN{constructor(){this.eventTree=new tc((e,t)=>this.Compare(e,t))}Reset(e){this.scanDirection=e}Enqueue(e){this.eventTree.Enqueue(e)}Dequeue(){return this.eventTree.Dequeue()}get Count(){return this.eventTree.Count}Compare(e,t){if(e===t)return 0;if(null==e)return -1;if(null==t)return 1;let r=this.scanDirection.ComparePerpCoord(e.Site,t.Site);return r||(r=(e instanceof ik?0:1)-(t instanceof ik?0:1))?r:this.scanDirection.CompareScanCoord(e.Site,t.Site)}}class iL{constructor(){this.pointCrossingMap=new t_,this.pointList=[]}AddIntersection(e,t,r){let i=this.pointCrossingMap.get(e);!i&&(i=[],this.pointCrossingMap.set(e,i));let n=i.length;for(let e=0;e<n;e++){let r=i[e];if(r.Group===t)return r}let s=new iC(t,r);return i.push(s),s}Clear(){this.pointCrossingMap.clear()}GetOrderedListBetween(e,t){if(0===this.pointCrossingMap.size)return null;if(D.ComparePP(e,t)>0){let r=e;e=t,t=r}for(let r of(this.pointList=[],this.pointCrossingMap.keys()))D.ComparePP(r,e)>=0&&0>=D.ComparePP(r,t)&&this.pointList.push(r);this.pointList.sort((e,t)=>e.compareTo(t));let r=new ih,i=this.pointList.length;for(let e=0;e<i;e++){let t=this.pointList[e];r.Add(t,this.pointCrossingMap.get(t))}return r}toString(){return tb.String.format("{0}",this.pointCrossingMap.size)}}class iD extends ik{constructor(e,t,r){super(e.ReflectingObstacle,t.Obstacle,r),this.Side=t}}class iB{constructor(e){this.staleSites=[],this.scanDirection=e,this.eventTree=new tu((e,t)=>this.CompareBB(e,t)),this.findFirstPred=e=>this.CompareToFindFirstPoint(e.Site)>=0}Add(e){this.eventTree.insert(e)}MarkStaleSite(e){this.staleSites.push(e)}RemoveStaleSites(){let e=this.staleSites.length;if(e>0){for(let t=0;t<e;t++)this.RemoveExact(this.staleSites[t]);this.staleSites=[]}}RemoveSitesForFlatBottom(e,t){for(let r=this.FindFirstInRange(e,t);null!=r;r=this.FindNextInRange(r,t))this.MarkStaleSite(r.item);this.RemoveStaleSites()}Find(e){return this.FindFirstInRange(e,e)}RemoveExact(e){let t=this.eventTree.find(e);return null!=t&&t.item.Site===e.Site&&(this.eventTree.deleteNodeInternal(t),!0)}FindFirstInRange(e,t){this.findFirstPoint=e;let r=this.eventTree.findFirst(this.findFirstPred);return null!=r&&0>=this.Compare(r.item.Site,t)?r:null}CompareToFindFirstPoint(e){return this.Compare(e,this.findFirstPoint)}FindNextInRange(e,t){let r=this.eventTree.next(e);return null!=r&&0>=this.Compare(r.item.Site,t)?r:null}CompareBB(e,t){return this.scanDirection.CompareScanCoord(e.Site,t.Site)}Compare(e,t){return this.scanDirection.CompareScanCoord(e,t)}}class iF extends iI{constructor(e,t){super(e,t)}}class iV extends iI{constructor(e,t){super(e,t)}}class iG extends iI{constructor(e,t){super(e,t)}}class iU extends ik{constructor(e,t,r){super(e.ReflectingObstacle,t.obstacle,r),this.Side=t}}class iz{get LowNeighborSide(){return null==this.LowNeighbor?null:this.LowNeighbor.item}get HighNeighborSide(){return null==this.HighNeighbor?null:this.HighNeighbor.item}Clear(){this.LowNeighbor=null,this.LowOverlapEnd=null,this.GroupSideInterveningBeforeLowNeighbor=null,this.HighNeighbor=null,this.HighOverlapEnd=null,this.GroupSideInterveningBeforeHighNeighbor=null}SetSides(e,t,r,i){if(iu.IsAscending(e)){this.HighNeighbor=t,this.HighOverlapEnd=r,this.GroupSideInterveningBeforeHighNeighbor=i;return}this.LowNeighbor=t,this.LowOverlapEnd=r,this.GroupSideInterveningBeforeLowNeighbor=i}}class ij{has(e){return this.hasxy(e.x,e.y)}remove(e){if(!(e.x<0)&&!(e.x>=this.arrayOfSets.length))return this.arrayOfSets[e.x].delete(e.y)}hasxy(e,t){if(e<0||e>=this.arrayOfSets.length)return!1;let r=this.arrayOfSets[e];return void 0!==r&&r.has(t)}constructor(){this.arrayOfSets=[]}static mk(e){let t=new ij;for(let r of e)t.add(r);return t}*values(){for(let e=0;e<this.arrayOfSets.length;e++){let t=this.arrayOfSets[e];if(t)for(let r of t.values())yield new ri(e,r)}}add(e){let t=this.arrayOfSets[e.x];null==t&&(this.arrayOfSets[e.x]=t=new Set),t.add(e.y)}addNN(e,t){let r=this.arrayOfSets[e];null==r&&(this.arrayOfSets[e]=r=new Set),r.add(t)}clear(){for(let e of this.arrayOfSets)e&&e.clear()}}class iH{constructor(e,t){this.Polyline=e,this.Obstacles=Array.from(t),this.PrimaryObstacle=this.Obstacles[0],iw.RoundVerticesAndSimplify(this.Polyline)}}class iW{static MungeClosestIntersectionInfo(e,t,r){let i=t.seg1.boundingBox,n=g.RoundPoint(t.x).clone();return r?new g(iW.MungeIntersect(e.x,n.x,i.left,i.right),n.y):new g(n.x,iW.MungeIntersect(e.y,n.y,i.bottom,i.top))}static MungeIntersect(e,t,r,i){if(e<t){let e=Math.min(r,i);t<e&&(t=e)}else if(e>t){let e=Math.max(r,i);t>e&&(t=e)}return g.RoundDouble(t)}}class iq{constructor(){this.CurrentGroupBoundaryCrossingMap=new iL,this.overlapPairs=new ij,this.hasOverlaps=!1,this.lookupIntPair=new ri(-1,-1)}get GraphBox(){return this.Root.irect}Init(e,t,r){this.CreateObstacleListAndOrdinals(e),this.AncestorSets=t,this.CreateRoot(),this.shapeIdToObstacleMap=r}CreateObstacleListAndOrdinals(e){this.allObstacles=Array.from(e);let t=iw.FirstNonSentinelOrdinal;for(let e of this.allObstacles)e.Ordinal=t++}OrdinalToObstacle(e){return this.allObstacles[e-iw.FirstNonSentinelOrdinal]}CreateRoot(){if(this.Root=iq.CalculateHierarchy(this.GetAllObstacles()),!!this.OverlapsExist())this.AccreteClumps(),this.AccreteConvexHulls(),this.GrowGroupsToAccommodateOverlaps(),this.Root=iq.CalculateHierarchy(this.GetAllObstacles().filter(e=>e.IsPrimaryObstacle))}OverlapsExist(){return null!=this.Root&&(tJ(this.Root,this.Root,(e,t)=>this.CheckForInitialOverlaps(e,t)),this.hasOverlaps)}OverlapPairAlreadyFound(e,t){return this.lookupIntPair.x=t.Ordinal,this.lookupIntPair.y=e.Ordinal,this.overlapPairs.has(this.lookupIntPair)}CheckForInitialOverlaps(e,t){if(this.hasOverlaps)return;let r={bIsInsideA:!1,aIsInsideB:!1};if(iq.ObstaclesIntersect(e,t,r)){this.hasOverlaps=!0;return}if((!!r.aIsInsideB||!!r.bIsInsideA)&&(!e.IsGroup||!t.IsGroup)&&(!e.IsGroup||!r.bIsInsideA)&&(!t.IsGroup||!r.aIsInsideB))this.hasOverlaps=!0}AccreteClumps(){this.AccumulateObstaclesForClumps(),this.CreateClumps()}AccreteConvexHulls(){for(;;)if(this.AccumulateObstaclesForConvexHulls(),!this.CreateConvexHulls())return}static CalculateHierarchy(e){return eC(Array.from(e).map(e=>eR(e,e.VisibilityBoundingBox)))}AccumulateObstaclesForClumps(){this.overlapPairs.clear();let e=iq.CalculateHierarchy(this.GetAllObstacles().filter(e=>!e.IsGroup&&e.IsRectangle));if(null!=e)tK(e,e,(e,t)=>this.EvaluateOverlappedPairForClump(e,t))}EvaluateOverlappedPairForClump(e,t){if(e===t||this.OverlapPairAlreadyFound(e,t))return;let r={bIsInsideA:!1,aIsInsideB:!1};if(!!iq.ObstaclesIntersect(e,t,r)||!!r.aIsInsideB||!!r.bIsInsideA)this.overlapPairs.add(new ri(e.Ordinal,t.Ordinal))}AccumulateObstaclesForConvexHulls(){this.overlapPairs.clear();let e=iq.CalculateHierarchy(this.GetAllObstacles().filter(e=>e.IsPrimaryObstacle&&!e.IsGroup));if(null!=e)tK(e,e,(e,t)=>this.EvaluateOverlappedPairForConvexHull(e,t))}EvaluateOverlappedPairForConvexHull(e,t){if(e===t||this.OverlapPairAlreadyFound(e,t))return;let r={bIsInsideA:!1,aIsInsideB:!1};if((!!iq.ObstaclesIntersect(e,t,r)||!!r.aIsInsideB||!!r.bIsInsideA)&&(!!e.IsInConvexHull||!!t.IsInConvexHull||!e.IsRectangle||!t.IsRectangle))this.overlapPairs.add(new ri(e.Ordinal,t.Ordinal)),this.AddClumpToConvexHull(e),this.AddClumpToConvexHull(t),this.AddConvexHullToConvexHull(e),this.AddConvexHullToConvexHull(t)}GrowGroupsToAccommodateOverlaps(){for(;;)if(this.AccumulateObstaclesForGroupOverlaps(),!this.GrowGroupsToResolveOverlaps())return}AccumulateObstaclesForGroupOverlaps(){let e=iq.CalculateHierarchy(this.GetAllObstacles().filter(e=>e.IsGroup)),t=iq.CalculateHierarchy(this.GetAllObstacles().filter(e=>e.IsPrimaryObstacle));if(null!=e&&null!=t)tK(e,t,(e,t)=>this.EvaluateOverlappedPairForGroup(e,t))}EvaluateOverlappedPairForGroup(e,t){if(e===t||this.OverlapPairAlreadyFound(e,t))return;let r={bIsInsideA:!1,aIsInsideB:!1},i=iq.ObstaclesIntersect(e,t,r);if(!i&&!r.aIsInsideB&&!r.bIsInsideA)return;if(e.IsRectangle&&t.IsRectangle){!t.IsGroup&&(r.aIsInsideB||iq.FirstRectangleContainsACornerOfTheOther(t.VisibilityBoundingBox,e.VisibilityBoundingBox))&&(t.OverlapsGroupCorner=!0);return}if(!!i||!t.IsGroup&&!r.bIsInsideA)this.overlapPairs.add(new ri(e.Ordinal,t.Ordinal))}static FirstRectangleContainsACornerOfTheOther(e,t){return e.contains(t.leftBottom)||e.contains(t.leftTop)||e.contains(t.rightTop)||e.contains(t.rightBottom)}static FirstPolylineStartIsInsideSecondPolyline(e,t){return C.PointRelativeToCurveLocation(e.start,t)!==el.Outside}AddClumpToConvexHull(e){if(e.isOverlapped){for(let t of e.clump.filter(t=>t.Ordinal!==e.Ordinal))this.overlapPairs.add(new ri(e.Ordinal,t.Ordinal));e.clump=[]}}AddConvexHullToConvexHull(e){if(e.IsInConvexHull){for(let t of e.ConvexHull.Obstacles.filter(t=>t.Ordinal!==e.Ordinal))this.overlapPairs.add(new ri(e.Ordinal,t.Ordinal));e.ConvexHull.Obstacles=[]}}CreateClumps(){for(let e of t9(t7(Array.from(this.overlapPairs.values())))){if(1===e.length)continue;let t=e.map(e=>this.OrdinalToObstacle(e));for(let e of t)e.clump=t}}CreateConvexHulls(){let e=!1;for(let t of t9(t7(Array.from(this.overlapPairs.values())))){if(1===t.length)continue;e=!0;let r=t.map(this.OrdinalToObstacle),i=eU(r,e=>e.VisibilityPolyline),n=new iH(tZ.createConvexHullAsClosedPolyline(i),r);for(let e of r)e.SetConvexHull(n)}return e}GrowGroupsToResolveOverlaps(){let e=!1;for(let t of this.overlapPairs.values()){e=!0;let r=this.OrdinalToObstacle(t.x),i=this.OrdinalToObstacle(t.y);!iq.ResolveGroupAndGroupOverlap(r,i)&&iq.ResolveGroupAndObstacleOverlap(r,i)}return this.overlapPairs.clear(),e}static ResolveGroupAndGroupOverlap(e,t){return!!t.IsGroup&&(e.VisibilityPolyline.boundingBox.area>t.VisibilityPolyline.boundingBox.area?iq.ResolveGroupAndObstacleOverlap(e,t):iq.ResolveGroupAndObstacleOverlap(t,e),!0)}static ResolveGroupAndObstacleOverlap(e,t){let r=t.looseVisibilityPolyline;iq.GrowGroupAroundLoosePolyline(e,r);let i={bIsInsideA:!1,aIsInsideB:!1};for(;iq.ObstaclesIntersect(t,e,i)||!i.aIsInsideB;)r=iw.CreateLoosePolyline(r),iq.GrowGroupAroundLoosePolyline(e,r)}static GrowGroupAroundLoosePolyline(e,t){let r=Array.from(e.VisibilityPolyline).concat(Array.from(t));e.SetConvexHull(new iH(tZ.createConvexHullAsClosedPolyline(r),[e]))}static ObstaclesIntersect(e,t,r){return C.CurvesIntersect(e.VisibilityPolyline,t.VisibilityPolyline)?(r.aIsInsideB=!1,r.bIsInsideA=!1,!0):(r.aIsInsideB=iq.FirstPolylineStartIsInsideSecondPolyline(e.VisibilityPolyline,t.VisibilityPolyline),r.bIsInsideA=!r.aIsInsideB&&iq.FirstPolylineStartIsInsideSecondPolyline(t.VisibilityPolyline,e.VisibilityPolyline),(!e.IsRectangle||!t.IsRectangle)&&!!iq.ObstaclesAreCloseEnoughToBeConsideredTouching(e,t,r.aIsInsideB,r.bIsInsideA)&&(r.aIsInsideB=!1,r.bIsInsideA=!1,!0))}static ObstaclesAreCloseEnoughToBeConsideredTouching(e,t,r,i){if(!r&&!i)return C.CurvesIntersect(e.looseVisibilityPolyline,t.VisibilityPolyline);let n=r?e.looseVisibilityPolyline:t.looseVisibilityPolyline,s=r?t.VisibilityPolyline:e.VisibilityPolyline;for(let e of n)if(C.PointRelativeToCurveLocation(e,s)===el.Outside){let t=C.ClosestPoint(s,e);if(!g.closeIntersections(e,t))return!0}return!1}AdjustSpatialAncestors(){if(this.SpatialAncestorsAdjusted)return!1;for(let e of this.GetAllGroups()){let t=e.VisibilityBoundingBox;for(let r of this.Root.GetNodeItemsIntersectingRectangle(t))if(r!==e&&C.ClosedCurveInteriorsIntersect(r.VisibilityPolyline,e.VisibilityPolyline)){if(r.IsInConvexHull)for(let t of r.ConvexHull.Obstacles)this.AncestorSets.get(t.InputShape).add(e.InputShape);this.AncestorSets.get(r.InputShape).add(e.InputShape)}}let e=[];for(let t of this.Root.GetAllLeaves()){let r=t.VisibilityBoundingBox;for(let i of e=e.concat(Array.from(this.AncestorSets.get(t.InputShape)).filter(e=>!r.intersects(this.shapeIdToObstacleMap.get(e).VisibilityBoundingBox))))this.AncestorSets.get(t.InputShape).delete(i);e=[]}return this.SpatialAncestorsAdjusted=!0,!0}GetAllGroups(){return this.GetAllObstacles().filter(e=>e.IsGroup)}Clear(){this.Root=null,this.AncestorSets=null}CreateMaxVisibilitySegment(e,t,r){let i=iu.RectangleBorderIntersect(this.GraphBox,e,t);if(D.GetDirections(e,i)===eh.None)return r.pacList=null,b.mkPP(e,e);let n=this.RestrictSegmentWithObstacles(e,i);return r.pacList=this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(n.start,n.end),n}GetAllObstacles(){return this.allObstacles}GetAllPrimaryObstacles(){return this.Root.GetAllLeaves()}IntersectionIsInsideAnotherObstacle(e,t,r,i){return this.insideHitTestIgnoreObstacle1=t,this.insideHitTestIgnoreObstacle2=e,this.insideHitTestScanDirection=i,null!=this.Root.FirstHitNodeWithPredicate(r,this.InsideObstacleHitTest.bind(this))}PointIsInsideAnObstaclePD(e,t){return this.PointIsInsideAnObstacle(e,ic.GetInstance(t))}PointIsInsideAnObstacle(e,t){return this.insideHitTestIgnoreObstacle1=null,this.insideHitTestIgnoreObstacle2=null,this.insideHitTestScanDirection=t,null!=this.Root.FirstHitNodeWithPredicate(e,this.InsideObstacleHitTest.bind(this))}InsideObstacleHitTest(e,t){if(t===this.insideHitTestIgnoreObstacle1||t===this.insideHitTestIgnoreObstacle2||t.IsGroup||!iu.PointIsInRectangleInterior(e,t.VisibilityBoundingBox))return eu.Continue;let r=iu.RectangleBorderIntersect(t.VisibilityBoundingBox,e,this.insideHitTestScanDirection.dir).add(this.insideHitTestScanDirection.DirectionAsPoint),i=iu.RectangleBorderIntersect(t.VisibilityBoundingBox,e,this.insideHitTestScanDirection.OppositeDirection).sub(this.insideHitTestScanDirection.DirectionAsPoint),n=b.mkPP(i,r),s=C.getAllIntersections(n,t.VisibilityPolyline,!0);if(2===s.length){let t=g.RoundPoint(s[0].x),r=g.RoundPoint(s[1].x);if(!D.EqualPP(e,t)&&!D.EqualPP(e,r)&&e.compareTo(t)!==e.compareTo(r)&&!c(Math.floor(s[0].par1),Math.floor(s[1].par1)))return eu.Stop}return eu.Continue}SegmentCrossesAnObstacle(e,t){this.stopAtGroups=!0,this.wantGroupCrossings=!1;let r=this.RestrictSegmentPrivate(e,t);return!D.EqualPP(r.end,t)}SegmentCrossesANonGroupObstacle(e,t){this.stopAtGroups=!1,this.wantGroupCrossings=!1;let r=this.RestrictSegmentPrivate(e,t);return!D.EqualPP(r.end,t)}RestrictSegmentWithObstacles(e,t){return this.stopAtGroups=!1,this.wantGroupCrossings=!0,this.RestrictSegmentPrivate(e,t)}RestrictSegmentPrivate(e,t){return this.GetRestrictedIntersectionTestSegment(e,t),this.currentRestrictedRay=b.mkPP(e,t),this.restrictedRayLengthSquared=e.sub(t).lengthSquared,this.CurrentGroupBoundaryCrossingMap.Clear(),this.RecurseRestrictRayWithObstacles(this.Root),this.currentRestrictedRay}GetRestrictedIntersectionTestSegment(e,t){let r=D.GetDirections(e,t),i=eh.West===r?this.GraphBox.right:eh.East===r?this.GraphBox.left:e.x,n=eh.West===r?this.GraphBox.left:eh.East===r?this.GraphBox.right:t.x,s=eh.South===r?2*this.GraphBox.top:eh.North===r?this.GraphBox.bottom:e.y,o=eh.South===r?this.GraphBox.bottom:eh.North===r?this.GraphBox.top:e.y;this.restrictedIntersectionTestSegment=b.mkPP(new g(i,s),new g(n,o))}RecurseRestrictRayWithObstacles(e){if(!iu.RectangleInteriorsIntersect(this.currentRestrictedRay.boundingBox,e.irect))return;let t=e.UserData;if(null!=t){let e=C.getAllIntersections(this.restrictedIntersectionTestSegment,t.VisibilityPolyline,!0);if(!t.IsGroup||this.stopAtGroups){this.LookForCloserNonGroupIntersectionToRestrictRay(e);return}this.wantGroupCrossings&&this.AddGroupIntersectionsToRestrictedRay(t,e);return}this.RecurseRestrictRayWithObstacles(e.Left),this.RecurseRestrictRayWithObstacles(e.Right)}LookForCloserNonGroupIntersectionToRestrictRay(e){let t=0,r=null,i=this.restrictedRayLengthSquared,n=D.GetDirections(this.restrictedIntersectionTestSegment.start,this.restrictedIntersectionTestSegment.end);for(let s of e){let e=g.RoundPoint(s.x),o=D.GetDirections(this.currentRestrictedRay.start,e);if(o===B.OppositeDir(n))continue;if(t++,eh.None===o){i=0,r=s;continue}let a=e.sub(this.currentRestrictedRay.start).lengthSquared;if(a<i){if(s.x.sub(this.currentRestrictedRay.start).lengthSquared<l.squareOfDistanceEpsilon)continue;i=a,r=s}}if(null!=r){if(1===t){let e=g.RoundPoint(r.x);if(g.closeIntersections(e,this.currentRestrictedRay.start)||g.closeIntersections(e,this.currentRestrictedRay.end))return}this.restrictedRayLengthSquared=i,this.currentRestrictedRay.end=iW.MungeClosestIntersectionInfo(this.currentRestrictedRay.start,r,!iu.IsVerticalPP(this.currentRestrictedRay.start,this.currentRestrictedRay.end))}}AddGroupIntersectionsToRestrictedRay(e,t){for(let r of t){let t=g.RoundPoint(r.x);if(t.sub(this.currentRestrictedRay.start).lengthSquared>this.restrictedRayLengthSquared)continue;let i=D.GetDirections(this.currentRestrictedRay.start,this.currentRestrictedRay.end),n=r.seg1,s=B.VectorDirection(n.derivative(r.par1)),o=i;0!=(s&B.RotateRight(i))&&(o=B.OppositeDir(o)),this.CurrentGroupBoundaryCrossingMap.AddIntersection(t,e,o)}}}class iX{constructor(e,t){this.scanDirection=e,this.SideTree=new tu((e,t)=>this.Compare(e,t)),this.linePositionAtLastInsertOrRemove=t}Insert(e,t){return this.linePositionAtLastInsertOrRemove=t,this.SideTree.insert(e)}get Count(){return this.SideTree.count}Remove(e,t){this.linePositionAtLastInsertOrRemove=t,this.SideTree.remove(e)}Find(e){return -1===this.scanDirection.ComparePerpCoord(this.linePositionAtLastInsertOrRemove,e.Start)?null:this.SideTree.find(e)}NextLowB(e){return this.NextLowR(this.Find(e))}NextLowR(e){return this.SideTree.previous(e)}NextHighB(e){return this.NextHighR(this.Find(e))}NextHighR(e){return this.SideTree.next(e)}Next(e,t){return iu.IsAscending(e)?this.SideTree.next(t):this.SideTree.previous(t)}Lowest(){return this.SideTree.treeMinimum()}Compare(e,t){if(e.Obstacle===t.Obstacle)return e===t?0:e instanceof i_?-1:1;let r=iZ.ScanLineIntersectSidePBS(this.linePositionAtLastInsertOrRemove,e,this.scanDirection),i=iZ.ScanLineIntersectSidePBS(this.linePositionAtLastInsertOrRemove,t,this.scanDirection),n=r.compareTo(i);if(0===n)0==(n=(e instanceof i_?1:0)-(t instanceof i_?1:0))&&(n=h(e.Obstacle.Ordinal,t.Obstacle.Ordinal));return n}}class i${constructor(e){this.lookupSegment=id.mk(new g(0,0),new g(0,1)),this.ScanDirection=e,this.segmentTree=new tu((e,t)=>this.Compare(e,t)),this.findIntersectorPred=e=>this.CompareIntersector(e),this.findPointPred=e=>this.CompareToPoint(e)}get Segments(){return this.segmentTree.allNodes()}InsertUnique(e){this.AssertValidSegmentForInsertion(e);let t=this.segmentTree.find(e);return null!=t?t:this.segmentTree.insert(e)}AssertValidSegmentForInsertion(e){}Remove(e){this.segmentTree.remove(e)}Find(e,t){this.lookupSegment.Update(e,t);let r=this.segmentTree.find(this.lookupSegment);return null!=r&&D.EqualPP(r.item.End,t)?r.item:null}FindLowestIntersector(e,t){let r=this.FindLowestIntersectorNode(e,t);return null!=r?r.item:null}FindLowestIntersectorNode(e,t){this.lookupSegment.Update(e,e);let r=this.segmentTree.findLast(this.findIntersectorPred);if(D.EqualPP(e,t))null!=r&&0>this.ScanDirection.Compare(r.item.End,e)&&(r=null);else for(this.lookupSegment.Update(e,t);null!=r&&!r.item.IntersectsSegment(this.lookupSegment);){if(this.ScanDirection.Compare(r.item.Start,t)>0)return null;r=this.segmentTree.next(r)}return r}FindHighestIntersector(e,t){this.lookupSegment.Update(t,t);let r=this.segmentTree.findLast(this.findIntersectorPred);if(D.EqualPP(e,t))null!=r&&0>this.ScanDirection.Compare(r.item.End,e)&&(r=null);else for(this.lookupSegment.Update(e,t);null!=r&&!r.item.IntersectsSegment(this.lookupSegment);){if(0>this.ScanDirection.Compare(r.item.End,e))return null;r=this.segmentTree.previous(r)}return null!=r?r.item:null}CompareIntersector(e){return 0>=this.ScanDirection.Compare(e.Start,this.lookupSegment.Start)}FindSegmentContainingPoint(e,t){return this.FindSegmentOverlappingPoints(e,e,t)}FindSegmentOverlappingPoints(e,t,r){this.lookupSegment.Update(e,t);let i=this.segmentTree.findFirst(this.findPointPred);if(null!=i){let e=i.item;if(0>=this.ScanDirection.Compare(e.Start,t))return e}return null}CompareToPoint(e){return this.ScanDirection.Compare(e.End,this.lookupSegment.Start)>=0}MergeAndRemoveNextNode(e,t){return -1===this.ScanDirection.Compare(e.End,t.item.End)&&e.Update(e.Start,t.item.End),e.MergeGroupBoundaryCrossingList(t.item.GroupBoundaryPointAndCrossingsList),this.segmentTree.deleteNodeInternal(t),this.segmentTree.find(e)}MergeSegments(){if(this.segmentTree.count<2)return;let e=this.segmentTree.treeMinimum(),t=this.segmentTree.next(e);for(;null!=t;t=this.segmentTree.next(e))switch(this.ScanDirection.Compare(t.item.Start,e.item.End)){case 1:e=t;break;case 0:t.item.IsOverlapped===e.item.IsOverlapped?e=this.MergeAndRemoveNextNode(e.item,t):(e.item.NeedEndOverlapVertex=!0,t.item.NeedStartOverlapVertex=!0,e=t);break;default:if(e.item.IsOverlapped!==t.item.IsOverlapped){if(e.item.IsOverlapped)e.item.Start===t.item.Start?e=this.MergeAndRemoveNextNode(t.item,e):(e.item.Update(e.item.Start,t.item.Start),e=t);else if(e.item.End===t.item.End)e=this.MergeAndRemoveNextNode(e.item,t);else{let r=t.item,i=e.item;this.segmentTree.deleteNodeInternal(t),r.Update(i.End,r.End),this.segmentTree.insert(r),r.TrimGroupBoundaryCrossingList(),e=this.segmentTree.find(i)}break}e=this.MergeAndRemoveNextNode(e.item,t)}}Compare(e,t){if(e===t)return 0;if(null==e)return -1;if(null==t)return 1;let r=this.ScanDirection.Compare(e.Start,t.Start);return 0===r&&(r=-1*this.ScanDirection.Compare(e.End,t.End)),r}}class iY extends tw{constructor(e){super(e)}SetVertexEntry(e){null==this.VertexEntries&&(this.VertexEntries=[,,,,]),this.VertexEntries[B.ToIndex(e.Direction)]=e}RemoveVertexEntries(){this.VertexEntries=null}}class iZ{constructor(e){this.ObstacleTree=new iq,this.CurrentGroupBoundaryCrossingMap=new iL,this.LowNeighborSides=new iz,this.HighNeighborSides=new iz,this.ScanDirection=ic.HorizontalInstance,this.eventQueue=new iN,this.HorizontalScanSegments=new i$(ic.HorizontalInstance),this.VerticalScanSegments=new i$(ic.VerticalInstance),this.wantReflections=e}get ParallelScanSegments(){return this.ScanDirection.IsHorizontal?this.HorizontalScanSegments:this.VerticalScanSegments}get PerpendicularScanSegments(){return this.ScanDirection.IsHorizontal?this.VerticalScanSegments:this.HorizontalScanSegments}static NewVisibilityGraph(){let e=new tT;return e.VertexFactory=e=>new iY(e),e}GenerateVisibilityGraph(){if(null==this.ObstacleTree.Root)return;this.InitializeEventQueue(ic.HorizontalInstance);let e=iw.FirstSentinelOrdinal,t=new g(this.ObstacleTree.GraphBox.left-iZ.SentinelOffset,this.ObstacleTree.GraphBox.bottom-iZ.SentinelOffset),r=new g(this.ObstacleTree.GraphBox.left-iZ.SentinelOffset,this.ObstacleTree.GraphBox.top+iZ.SentinelOffset),i=iw.CreateSentinel(t,r,this.ScanDirection,e++);this.scanLine.Insert(i.ActiveHighSide,this.ObstacleTree.GraphBox.leftBottom),t=new g(this.ObstacleTree.GraphBox.right+iZ.SentinelOffset,this.ObstacleTree.GraphBox.bottom-iZ.SentinelOffset),r=new g(this.ObstacleTree.GraphBox.right+iZ.SentinelOffset,this.ObstacleTree.GraphBox.top+iZ.SentinelOffset),i=iw.CreateSentinel(t,r,this.ScanDirection,e++),this.scanLine.Insert(i.ActiveLowSide,this.ObstacleTree.GraphBox.leftBottom),this.ProcessEvents(),this.InitializeEventQueue(ic.VerticalInstance),t=new g(this.ObstacleTree.GraphBox.left-iZ.SentinelOffset,this.ObstacleTree.GraphBox.bottom-iZ.SentinelOffset),r=new g(this.ObstacleTree.GraphBox.right+iZ.SentinelOffset,this.ObstacleTree.GraphBox.bottom-iZ.SentinelOffset),i=iw.CreateSentinel(t,r,this.ScanDirection,e++),this.scanLine.Insert(i.ActiveHighSide,this.ObstacleTree.GraphBox.leftBottom),t=new g(this.ObstacleTree.GraphBox.left-iZ.SentinelOffset,this.ObstacleTree.GraphBox.top+iZ.SentinelOffset),r=new g(this.ObstacleTree.GraphBox.right+iZ.SentinelOffset,this.ObstacleTree.GraphBox.top+iZ.SentinelOffset),i=iw.CreateSentinel(t,r,this.ScanDirection,e),this.scanLine.Insert(i.ActiveLowSide,this.ObstacleTree.GraphBox.leftBottom),this.ProcessEvents()}static ScanLineIntersectSidePBS(e,t,r){let i=t.Direction,n=t.Start.x,s=t.Start.y;return r.IsHorizontal?(n+=i.x/i.y*(e.y-t.Start.y),n=iW.MungeIntersect(e.x,n,t.Start.x,t.End.x),s=e.y):(n=e.x,s+=i.y/i.x*(e.x-t.Start.x),s=iW.MungeIntersect(e.y,s,t.Start.y,t.End.y)),new g(n,s)}GetOpenVertex(e){let t=e.startPoint,r=this.TraversePolylineForEvents(t),i=this.PointCompare(r.point,t.point);for(;;r=this.TraversePolylineForEvents(r)){let e=this.PointCompare(r.point,t.point);if(e<=0)t=r;else if(e>0&&i<=0)break;i=e}return t}TraversePolylineForEvents(e){return this.ScanDirection.IsHorizontal?e.nextOnPolyline:e.prevOnPolyline}InitializeEventQueue(e){this.ScanDirection=e,this.eventQueue.Reset(this.ScanDirection),this.EnqueueBottomVertexEvents(),this.scanLine=new iX(this.ScanDirection,this.ObstacleTree.GraphBox.leftBottom),this.lookaheadScan=new iB(this.ScanDirection)}EnqueueBottomVertexEvents(){for(let e of this.ObstacleTree.GetAllPrimaryObstacles()){let t=this.GetOpenVertex(e.VisibilityPolyline);this.eventQueue.Enqueue(new iM(e,t))}}IsFlat(e){return this.ScanDirection.IsFlatS(e)}IsPerpendicular(e){return this.ScanDirection.IsPerpendicularS(e)}ScanLineIntersectSide(e,t){return iZ.ScanLineIntersectSidePBS(e,t,this.ScanDirection)}SideReflectsUpward(e){return e instanceof i_?this.ScanDirection.Coord(e.End)>this.ScanDirection.Coord(e.Start):this.ScanDirection.Coord(e.End)<this.ScanDirection.Coord(e.Start)}SideReflectsDownward(e){return e instanceof i_?this.ScanDirection.Coord(e.End)<this.ScanDirection.Coord(e.Start):this.ScanDirection.Coord(e.End)>this.ScanDirection.Coord(e.Start)}StoreLookaheadSite(e,t,r,i){if(!!this.wantReflections){if(!this.IsPerpendicular(t)){if(!i&&!iu.PointIsInRectangleInterior(r,t.Obstacle.VisibilityBoundingBox))return;this.SideReflectsUpward(t)&&null==this.lookaheadScan.Find(r)&&this.lookaheadScan.Add(new ik(e,t.Obstacle,r))}}}LoadReflectionEvents(e){this.LoadReflectionEventsBB(e,e)}LoadReflectionEventsBB(e,t){if(null==e||this.SideReflectsUpward(e)||this.IsPerpendicular(e))return;let r=M.mkPP(e.Start,e.End),i=M.mkPP(t.Start,t.End);if(this.ScanDirection.IsHorizontal?!r.intersectsOnX(i):!r.intersectsOnY(i))return;let n=M.intersect(r,i),s=n.leftBottom,o=n.rightTop,a=this.lookaheadScan.FindFirstInRange(s,o);for(;null!=a;){let t=iZ.ScanLineIntersectSidePBS(a.item.Site,e,this.ScanDirection.PerpendicularInstance);this.ScanDirection.ComparePerpCoord(t,a.item.Site)>0?this.AddReflectionEvent(a.item,e,t):a.item.ReflectingObstacle!==e.Obstacle&&this.lookaheadScan.MarkStaleSite(a.item),a=this.lookaheadScan.FindNextInRange(a,o)}this.lookaheadScan.RemoveStaleSites()}AddPerpendicularReflectionSegment(e,t,r){if(this.lookaheadScan.RemoveExact(e.PreviousSite)){if(null==t)return!1;if(e.PreviousSite.IsStaircaseStep(e.ReflectingObstacle)){if(!iu.PointIsInRectangleInterior(e.Site,e.ReflectingObstacle.VisibilityBoundingBox)||!this.InsertPerpendicularReflectionSegment(e.PreviousSite.Site,e.Site))return!1;if(null!=r&&e.IsStaircaseStep(r.Obstacle))return this.ScanLineCrossesObstacle(e.Site,r.Obstacle)}}return!1}AddParallelReflectionSegment(e,t,r,i){{let n=this.ScanLineIntersectSide(i.Site,null!=t?t:r),s=null!=t?n:i.Site,o=null!=t?i.Site:n;return null==t?t=this.scanLine.NextLowB(r).item:r=this.scanLine.NextHighB(t).item,this.InsertParallelReflectionSegment(s,o,e,t,r,i)}}AddReflectionEvent(e,t,r){null!=t?this.eventQueue.Enqueue(new iU(e,t,r)):this.eventQueue.Enqueue(new iD(e,t,r))}AddSideToScanLine(e,t){let r=this.scanLine.Insert(e,t);return this.LoadReflectionEvents(e),r}RemoveSideFromScanLine(e,t){this.scanLine.Remove(e.item,t)}PointCompare(e,t){return this.ScanDirection.Compare(e,t)}Clear(){this.ObstacleTree.Clear(),this.eventQueue=new iN,this.HorizontalScanSegments=new i$(ic.HorizontalInstance),this.VerticalScanSegments=new i$(ic.VerticalInstance),this.VisibilityGraph=null}ProcessEvents(){for(;this.eventQueue.Count>0;){let e=this.eventQueue.Dequeue();e instanceof iM?this.ProcessEventO(e):e instanceof iF?this.ProcessEventLB(e):e instanceof iV?this.ProcessEventHB(e):e instanceof iG?this.ProcessEventCV(e):e instanceof iU?this.ProcessEventLR(e):e instanceof iD?this.ProcessEventHR(e):this.ProcessCustomEvent(e),this.LowNeighborSides.Clear(),this.HighNeighborSides.Clear()}}ProcessCustomEvent(e){}ScanLineCrossesObstacle(e,t){return this.ScanDirection.ComparePerpCoord(e,t.VisibilityBoundingBox.leftBottom)>0&&0>this.ScanDirection.ComparePerpCoord(e,t.VisibilityBoundingBox.rightTop)}FindInitialNeighborSides(e,t){t.lowNborSideNode=this.scanLine.NextLowR(e),t.highNborSideNode=this.scanLine.NextHighR(e)}FindNeighborsBRR(e,t,r){this.LowNeighborSides.Clear(),this.HighNeighborSides.Clear(),this.FindNeighbors(e,t,this.LowNeighborSides),this.FindNeighbors(e,r,this.HighNeighborSides)}FindNeighbors(e,t,r){let i=e instanceof iM?t.item.Start:t.item.End,n={lowNborSideNode:null,highNborSideNode:null};this.FindInitialNeighborSides(t,n),this.SkipToNeighbor(this.ScanDirection.OppositeDirection,t.item,i,n.lowNborSideNode,r),this.SkipToNeighbor(this.ScanDirection.Dir,t.item,i,n.highNborSideNode,r)}SkipToNeighbor(e,t,r,i,n){let s=null,o=null;for(;;i=this.scanLine.Next(e,i)){if(i.item.Obstacle!==t.Obstacle){if(i.item.Obstacle.IsGroup){this.ProcessGroupSideEncounteredOnTraversalToNeighbor(i,r,e)&&null==o&&(o=i.item);continue}if(i.item instanceof iS===iu.IsAscending(e)){this.ScanLineCrossesObstacle(r,i.item.Obstacle)&&(s=i,o=null);continue}break}}n.SetSides(e,i,s,o)}ProcessGroupSideEncounteredOnTraversalToNeighbor(e,t,r){if(!this.ScanLineCrossesObstacle(t,e.item.Obstacle))return!1;let i=e.item instanceof i_===iu.IsAscending(r)?r:B.OppositeDir(r),n=this.ScanLineIntersectSide(t,e.item);return this.CurrentGroupBoundaryCrossingMap.AddIntersection(n,e.item.Obstacle,i),!0}FindNeighborsAndProcessVertexEvent(e,t,r){this.CurrentGroupBoundaryCrossingMap.Clear(),this.FindNeighborsBRR(r,e,t),this.ProcessVertexEvent(e,t,r),this.CurrentGroupBoundaryCrossingMap.Clear()}ProcessEventO(e){var t,r;let i=e.Obstacle;i.CreateInitialSides(e.Vertex,this.ScanDirection),this.AddSideToScanLine(i.ActiveLowSide,e.Site);let n=this.AddSideToScanLine(i.ActiveHighSide,e.Site),s=this.scanLine.Find(i.ActiveLowSide);this.FindNeighborsAndProcessVertexEvent(s,n,e);let o=null!==(t=this.LowNeighborSides.GroupSideInterveningBeforeLowNeighbor)&&void 0!==t?t:this.LowNeighborSides.LowNeighborSide;this.SideReflectsUpward(o)&&this.LoadReflectionEvents(i.ActiveLowSide);let a=null!==(r=this.HighNeighborSides.GroupSideInterveningBeforeHighNeighbor)&&void 0!==r?r:this.HighNeighborSides.HighNeighborSide;if(this.SideReflectsUpward(a)&&this.LoadReflectionEvents(i.ActiveHighSide),i.ActiveHighSide.Start!==i.ActiveLowSide.Start){let t=new iS(i,e.Vertex,this.ScanDirection);this.lookaheadScan.RemoveSitesForFlatBottom(t.Start,t.End)}this.EnqueueLowBendVertexEvent(i.ActiveLowSide),this.EnqueueHighBendOrCloseVertexEvent(i.ActiveHighSide)}ProcessEventLB(e){let t=e.Obstacle,r=new i_(t,e.Vertex,this.ScanDirection);this.ScanDirection.ComparePerpCoord(r.End,r.Start)>0&&(this.RemoveSideFromScanLine(this.scanLine.Find(t.ActiveLowSide),e.Site),this.AddSideToScanLine(r,e.Site),t.ActiveLowSide=r,this.EnqueueLowBendVertexEvent(r))}EnqueueLowBendVertexEvent(e){this.eventQueue.Enqueue(new iF(e.Obstacle,e.EndVertex))}ProcessEventHB(e){let t=e.Obstacle,r=new iS(t,e.Vertex,this.ScanDirection);this.RemoveSideFromScanLine(this.scanLine.Find(t.ActiveHighSide),e.Site);let i=this.AddSideToScanLine(r,e.Site);if(t.ActiveHighSide=r,this.EnqueueHighBendOrCloseVertexEvent(t.ActiveHighSide),this.wantReflections&&this.ScanDirection.IsHorizontal&&r.Start.x===t.VisibilityBoundingBox.right&&this.SideReflectsUpward(r)){let e=this.scanLine.NextHighR(i);e.item instanceof i_&&this.SideReflectsDownward(e.item)&&(!t.isOverlapped||!this.ObstacleTree.PointIsInsideAnObstacle(r.Start,this.ScanDirection))&&(this.StoreLookaheadSite(e.item.Obstacle,r,r.Start,!0),this.LoadReflectionEvents(e.item))}}EnqueueHighBendOrCloseVertexEvent(e){let t=e.Obstacle,r=this.ScanDirection.IsHorizontal?e.EndVertex.prevOnPolyline:e.EndVertex.nextOnPolyline;this.ScanDirection.ComparePerpCoord(r.point,e.End)>0?this.eventQueue.Enqueue(new iV(t,e.EndVertex)):this.eventQueue.Enqueue(new iG(t,e.EndVertex))}CreateCloseEventSegmentsAndFindNeighbors(e){let t=e.Obstacle,r=this.scanLine.Find(t.ActiveLowSide),i=this.scanLine.Find(t.ActiveHighSide);if(1===this.scanLine.Compare(t.ActiveLowSide,t.ActiveHighSide)){let e=r;r=i,i=e}if(this.FindNeighborsAndProcessVertexEvent(r,i,e),this.wantReflections&&t.isOverlapped)for(let e=this.scanLine.NextHighR(r);e.item!==i.item;e=this.scanLine.NextHighR(e))this.LoadReflectionEvents(e.item);this.scanLine.Remove(t.ActiveLowSide,e.Site),this.scanLine.Remove(t.ActiveHighSide,e.Site)}ProcessEventCV(e){this.CreateCloseEventSegmentsAndFindNeighbors(e);let t=this.LowNeighborSides.LowNeighbor.item,r=this.HighNeighborSides.HighNeighbor.item,i=e.Obstacle;this.LoadReflectionEvents(t),this.LoadReflectionEvents(r),i.Close()}ProcessEventLR(e){let t=e.Side.Obstacle,r=this.scanLine.NextLowB(e.Side).item;this.AddPerpendicularReflectionSegment(e,e.Side,r)&&this.AddParallelReflectionSegment(t,r,null,e)&&this.LoadReflectionEvents(t.ActiveLowSide)}ProcessEventHR(e){let t=e.Side.Obstacle,r=this.scanLine.NextHighB(e.Side).item;this.AddPerpendicularReflectionSegment(e,e.Side,r)&&this.AddParallelReflectionSegment(t,null,r,e)&&this.LoadReflectionEvents(t.ActiveHighSide)}MakeInBoundsLocation(e){let t=Math.max(e.x,this.ObstacleTree.GraphBox.left),r=Math.max(e.y,this.ObstacleTree.GraphBox.bottom);return new g(Math.min(t,this.ObstacleTree.GraphBox.right),Math.min(r,this.ObstacleTree.GraphBox.top))}IsInBoundsV(e){return this.IsInBoundsP(e.point)}IsInBoundsP(e){return D.EqualPP(e,this.MakeInBoundsLocation(e))}}iZ.SentinelOffset=1;class iK extends iZ{constructor(){super(!1),this.horizontalVertexPoints=new eN,this.verticalVertexPoints=new eN,this.boundingBoxSteinerPoints=new eN,this.xCoordAccumulator=new Set,this.yCoordAccumulator=new Set,this.horizontalCoordMap=new Map,this.verticalCoordMap=new Map}Clear(){super.Clear(),this.Cleanup()}Cleanup(){this.horizontalVertexPoints.clear(),this.verticalVertexPoints.clear(),this.boundingBoxSteinerPoints.clear(),this.xCoordAccumulator.clear(),this.yCoordAccumulator.clear(),this.horizontalCoordMap.clear(),this.verticalCoordMap.clear()}GenerateVisibilityGraph(){this.AccumulateVertexCoords(),this.CreateSegmentVectorsAndPopulateCoordinateMaps(),this.RunScanLineToCreateSegmentsAndBoundingBoxSteinerPoints(),this.GenerateSparseIntersectionsFromVertexPoints(),this.CreateScanSegmentTrees(),this.Cleanup()}AccumulateVertexCoords(){for(let e of this.ObstacleTree.GetAllObstacles())this.xCoordAccumulator.add(e.VisibilityBoundingBox.left),this.xCoordAccumulator.add(e.VisibilityBoundingBox.right),this.yCoordAccumulator.add(e.VisibilityBoundingBox.top),this.yCoordAccumulator.add(e.VisibilityBoundingBox.bottom)}CreateSegmentVectorsAndPopulateCoordinateMaps(){this.horizontalScanSegmentVector=new iO(this.yCoordAccumulator,!0),this.verticalScanSegmentVector=new iO(this.xCoordAccumulator,!1);for(let e=0;e<this.horizontalScanSegmentVector.Length;e++)this.horizontalCoordMap.set(this.horizontalScanSegmentVector.Item(e).Coord,e);for(let e=0;e<this.verticalScanSegmentVector.Length;e++)this.verticalCoordMap.set(this.verticalScanSegmentVector.Item(e).Coord,e)}RunScanLineToCreateSegmentsAndBoundingBoxSteinerPoints(){super.GenerateVisibilityGraph(),this.horizontalScanSegmentVector.ScanSegmentsComplete(),this.verticalScanSegmentVector.ScanSegmentsComplete(),this.xCoordAccumulator.clear(),this.yCoordAccumulator.clear()}InitializeEventQueue(e){super.InitializeEventQueue(e),this.SetVectorsAndCoordMaps(e),this.AddAxisCoordinateEvents(e)}AddAxisCoordinateEvents(e){if(e.IsHorizontal){for(let e of this.yCoordAccumulator)this.eventQueue.Enqueue(new iA(new g(this.ObstacleTree.GraphBox.left-iK.SentinelOffset,e)));return}for(let e of this.xCoordAccumulator)this.eventQueue.Enqueue(new iA(new g(e,this.ObstacleTree.GraphBox.bottom-iK.SentinelOffset)))}ProcessCustomEvent(e){!this.ProcessAxisCoordinate(e)&&this.ProcessCustomEvent(e)}ProcessAxisCoordinate(e){return e instanceof iA&&(this.CreateScanSegmentsOnAxisCoordinate(e.Site),!0)}InsertPerpendicularReflectionSegment(e,t){return!1}InsertParallelReflectionSegment(e,t,r,i,n,s){return!1}ProcessVertexEvent(e,t,r){let i=this.ScanDirection.IsHorizontal?this.horizontalVertexPoints:this.verticalVertexPoints;i.add(r.Site);let n=this.LowNeighborSides.LowNeighbor.item,s=this.HighNeighborSides.HighNeighbor.item,o=this.ScanDirection.Dir,a=this.ScanDirection.OppositeDirection,l=this.ScanLineIntersectSide(r.Site,n),h=this.ScanLineIntersectSide(r.Site,s);if(this.ObstacleTree.GraphBox.contains(l)){let e=iu.RectangleBorderIntersect(n.Obstacle.VisibilityBoundingBox,l,o);D.IsPureLower(e,r.Site)&&this.boundingBoxSteinerPoints.add(e)}if(this.ObstacleTree.GraphBox.contains(h)){let e=iu.RectangleBorderIntersect(s.Obstacle.VisibilityBoundingBox,h,a);D.IsPureLower(r.Site,e)&&this.boundingBoxSteinerPoints.add(e)}let u={lowCorner:void 0,highCorner:void 0};iK.GetBoundingCorners(e.item.Obstacle.VisibilityBoundingBox,r instanceof iM,this.ScanDirection.IsHorizontal,u),(D.IsPureLower(l,u.lowCorner)||n.Obstacle.IsInSameClump(r.Obstacle))&&i.add(u.lowCorner),(D.IsPureLower(u.highCorner,h)||s.Obstacle.IsInSameClump(r.Obstacle))&&i.add(u.highCorner)}static GetBoundingCorners(e,t,r,i){if(t){i.lowCorner=e.leftBottom,i.highCorner=r?e.rightBottom:e.leftTop;return}i.lowCorner=r?e.leftTop:e.rightBottom,i.highCorner=e.rightTop}CreateScanSegmentsOnAxisCoordinate(e){this.CurrentGroupBoundaryCrossingMap.Clear();let t=this.scanLine.Lowest(),r=this.scanLine.NextHighR(t),i=0,n=e,s=!1;for(;null!=r;r=this.scanLine.NextHighR(r)){if(this.SkipSide(n,r.item))continue;if(r.item.Obstacle.IsGroup){(0===i||s)&&this.HandleGroupCrossing(e,r.item);continue}if(r.item instanceof i_){if(i>0){i++;continue}n=this.CreateScanSegment(n,r.item,id.NormalWeight),this.CurrentGroupBoundaryCrossingMap.Clear(),i=1,s=r.item.Obstacle.isOverlapped;continue}if(!(++i>0))n=r.item.Obstacle.isOverlapped||r.item.Obstacle.OverlapsGroupCorner?this.CreateScanSegment(n,r.item,id.OverlappedWeight):this.ScanLineIntersectSide(n,r.item),this.CurrentGroupBoundaryCrossingMap.Clear(),s=!1}let o=this.ScanDirection.IsHorizontal?new g(this.ObstacleTree.GraphBox.right+iK.SentinelOffset,n.y):new g(n.x,this.ObstacleTree.GraphBox.top+iK.SentinelOffset);this.parallelSegmentVector.CreateScanSegment(n,o,id.NormalWeight,this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(n,o)),this.parallelSegmentVector.ScanSegmentsCompleteForCurrentSlot()}HandleGroupCrossing(e,t){if(!this.ScanLineCrossesObstacle(e,t.Obstacle))return;let r=t instanceof i_?this.ScanDirection.Dir:this.ScanDirection.OppositeDirection,i=this.ScanLineIntersectSide(e,t),n=this.CurrentGroupBoundaryCrossingMap.AddIntersection(i,t.Obstacle,r);this.AddPerpendicularCoordForGroupCrossing(i);let s=n.GetInteriorVertexPoint(i);this.AddPerpendicularCoordForGroupCrossing(s)}AddPerpendicularCoordForGroupCrossing(e){let t=this.FindPerpendicularSlot(e,0);-1!==t&&this.perpendicularSegmentVector.Item(t).AddPendingPerpendicularCoord(this.parallelSegmentVector.CurrentSlot.Coord)}SkipSide(e,t){if(t.Obstacle.IsSentinel)return!0;let r=t.Obstacle.VisibilityBoundingBox;return this.ScanDirection.IsHorizontal?e.y===r.bottom||e.y===r.top:e.x===r.left||e.x===r.right}CreateScanSegment(e,t,r){let i=this.ScanLineIntersectSide(e,t);return e!==i&&this.parallelSegmentVector.CreateScanSegment(e,i,r,this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(e,i)),i}GenerateSparseIntersectionsFromVertexPoints(){this.VisibilityGraph=iK.NewVisibilityGraph(),this.GenerateSparseIntersectionsAlongHorizontalAxis(),this.GenerateSparseIntersectionsAlongVerticalAxis(),this.ConnectAdjoiningScanSegments(),this.horizontalScanSegmentVector.CreateSparseVerticesAndEdges(this.VisibilityGraph),this.verticalScanSegmentVector.CreateSparseVerticesAndEdges(this.VisibilityGraph)}GenerateSparseIntersectionsAlongHorizontalAxis(){this.currentAxisPointComparer=u;let e=Array.from(this.horizontalVertexPoints.values()).sort(this.currentAxisPointComparer),t=Array.from(this.boundingBoxSteinerPoints.values()).sort(this.currentAxisPointComparer);this.ScanDirection=ic.HorizontalInstance,this.SetVectorsAndCoordMaps(this.ScanDirection),this.GenerateSparseIntersections(e,t)}GenerateSparseIntersectionsAlongVerticalAxis(){this.currentAxisPointComparer=(e,t)=>e.compareTo(t);let e=Array.from(this.verticalVertexPoints.values()).sort(this.currentAxisPointComparer),t=Array.from(this.boundingBoxSteinerPoints.values()).sort(this.currentAxisPointComparer);this.ScanDirection=ic.VerticalInstance,this.SetVectorsAndCoordMaps(this.ScanDirection),this.GenerateSparseIntersections(e,t)}SetVectorsAndCoordMaps(e){e.IsHorizontal?(this.parallelSegmentVector=this.horizontalScanSegmentVector,this.perpendicularSegmentVector=this.verticalScanSegmentVector,this.perpendicularCoordMap=this.verticalCoordMap):(this.parallelSegmentVector=this.verticalScanSegmentVector,this.perpendicularSegmentVector=this.horizontalScanSegmentVector,this.perpendicularCoordMap=this.horizontalCoordMap)}ConnectAdjoiningScanSegments(){this.horizontalScanSegmentVector.ConnectAdjoiningSegmentEndpoints(),this.verticalScanSegmentVector.ConnectAdjoiningSegmentEndpoints()}GenerateSparseIntersections(e,t){this.perpendicularSegmentVector.ResetForIntersections(),this.parallelSegmentVector.ResetForIntersections();let r=1,i={j:0};for(let n of this.parallelSegmentVector.Items())for(;n.CurrentSegment.ContainsPoint(e[r])||this.AddSteinerPointsToInterveningSegments(e[r],t,i,n)&&n.TraverseToSegmentContainingPoint(e[r]);){;if(this.AddPointsToCurrentSegmentIntersections(t,i,n),this.GenerateIntersectionsFromVertexPointForCurrentSegment(e[r],n),n.PointIsCurrentEndAndNextStart(e[r])){n.MoveNext();continue}if(++r>=e.length)return}}AddSteinerPointsToInterveningSegments(e,t,r,i){for(;r.j<t.length&&-1===this.currentAxisPointComparer(t[r.j],e);){if(!i.TraverseToSegmentContainingPoint(t[r.j]))return!1;this.AddPointsToCurrentSegmentIntersections(t,r,i)}return!0}AddPointsToCurrentSegmentIntersections(e,t,r){for(;t.j<e.length&&r.CurrentSegment.ContainsPoint(e[t.j]);t.j++){let i=this.FindPerpendicularSlot(e[t.j],0);this.AddSlotToSegmentIntersections(r,i)}}GenerateIntersectionsFromVertexPointForCurrentSegment(e,t){let r=this.FindPerpendicularSlot(t.CurrentSegment.Start,1),i=this.FindPerpendicularSlot(t.CurrentSegment.End,-1),n=this.FindPerpendicularSlot(e,0);if(!(r>=i))this.AddSlotToSegmentIntersections(t,r),this.AddSlotToSegmentIntersections(t,i),n>r&&n<i&&(this.AddSlotToSegmentIntersections(t,n),this.AddBinaryDivisionSlotsToSegmentIntersections(t,r,n,i))}FindPerpendicularSlot(e,t){return iK.FindIntersectingSlot(this.perpendicularSegmentVector,this.perpendicularCoordMap,e,t)}static FindIntersectingSlot(e,t,r,i){let n=e.GetParallelCoord(r),s=t.get(n);return void 0!==s?s:0===i?-1:e.FindNearest(n,i)}AddSlotToSegmentIntersections(e,t){let r=this.perpendicularSegmentVector.Item(t);e.CurrentSegment.AddSparseVertexCoord(r.Coord),r.AddPerpendicularCoord(e.Coord)}AddBinaryDivisionSlotsToSegmentIntersections(e,t,r,i){let n=0,s=this.perpendicularSegmentVector.Length-1;for(;s-n>1;){let o=n+Math.floor((s-n)/2);if(r<=o){r<(s=o)&&s<=i&&this.AddSlotToSegmentIntersections(e,s);continue}r>(n=o)&&n>=t&&this.AddSlotToSegmentIntersections(e,n)}}CreateScanSegmentTrees(){iK.CreateScanSegmentTree(this.horizontalScanSegmentVector,this.HorizontalScanSegments),iK.CreateScanSegmentTree(this.verticalScanSegmentVector,this.VerticalScanSegments)}static CreateScanSegmentTree(e,t){for(let r of e.Items())for(let e=r.FirstSegment;null!=e;e=e.NextSegment)e.HasVisibility()&&t.InsertUnique(e)}}class iJ{get ObstacleTree(){return this.GraphGenerator.ObstacleTree}get VisGraph(){return this.GraphGenerator.VisibilityGraph}get IsSparseVg(){return this.GraphGenerator instanceof iK}constructor(e){this.AddedVertices=[],this.AddedEdges=[],this.edgesToRestore=[],this.LimitPortVisibilitySpliceToEndpointBoundingBox=!1,this.GraphGenerator=e}AddVertex(e){let t=this.VisGraph.AddVertexP(e);return this.AddedVertices.push(t),t}FindOrAddVertex(e){let t=this.VisGraph.FindVertex(e);return null!=t?t:this.AddVertex(e)}FindOrAddEdgeVV(e,t){return this.FindOrAddEdge(e,t,id.NormalWeight)}FindOrAddEdge(e,t,r){let i=D.GetPureDirectionVV(e,t),n={bracketSource:void 0,bracketTarget:void 0,splitVertex:void 0};iJ.GetBrackets(e,t,i,n);let s=this.VisGraph.FindEdgePP(n.bracketSource.point,n.bracketTarget.point);return s=null!=s?this.SplitEdge(s,n.splitVertex):this.CreateEdge(n.bracketSource,n.bracketTarget,r)}static GetBrackets(e,t,r,i){if(i.splitVertex=t,!iJ.FindBracketingVertices(e,t.point,r,i)){let n={bracketSource:null,bracketTarget:null};iJ.FindBracketingVertices(t,e.point,B.OppositeDir(r),n)&&(i.bracketSource=n.bracketTarget,i.splitVertex=e),i.bracketTarget=n.bracketSource}}static FindBracketingVertices(e,t,r,i){for(i.bracketSource=e;i.bracketTarget=iu.FindAdjacentVertex(i.bracketSource,r),null!=i.bracketTarget;){;if(g.closeDistEps(i.bracketTarget.point,t))return!0;if(r!==D.GetDirections(i.bracketTarget.point,t))break;i.bracketSource=i.bracketTarget}return null!=i.bracketTarget}CreateEdge(e,t,r){let i=e,n=t;!D.IsPureLower(i.point,n.point)&&(i=t,n=e);let s=new tx(i,n,r);return tT.AddEdge(s),this.AddedEdges.push(s),s}RemoveFromGraph(){this.RemoveAddedVertices(),this.RemoveAddedEdges(),this.RestoreRemovedEdges()}RemoveAddedVertices(){for(let e of this.AddedVertices)null!=this.VisGraph.FindVertex(e.point)&&this.VisGraph.RemoveVertex(e);this.AddedVertices=[]}RemoveAddedEdges(){for(let e of this.AddedEdges)null!=this.VisGraph.FindVertex(e.SourcePoint)&&tT.RemoveEdge(e);this.AddedEdges=[]}RestoreRemovedEdges(){for(let e of this.edgesToRestore)tT.AddEdge(e);this.edgesToRestore=[]}FindNextEdge(e,t){return iu.FindAdjacentEdge(e,t)}FindPerpendicularOrContainingEdge(e,t,r){for(;;){let i=iu.FindAdjacentVertex(e,t);if(null==i)break;let n=D.GetDirections(i.point,r);if(0!=(B.OppositeDir(t)&n))return this.VisGraph.FindEdgePP(e.point,i.point);e=i}return null}FindNearestPerpendicularOrContainingEdge(e,t,r){let i,n;D.GetDirections(e.point,r);let s=e;for(;eh.None!==i;){let e=iu.FindAdjacentVertex(s,i);if(null==e||0!=(B.OppositeDir(i)&D.GetDirections(e.point,r)))break;s=e,D.GetDirections(s.point,r)}for(;null==(n=this.FindPerpendicularOrContainingEdge(s,t,r))&&s!==e;){;s=iu.FindAdjacentVertex(s,B.OppositeDir(i))}return n}ConnectVertexToTargetVertex(e,t,r,i){if(g.closeDistEps(e.point,t.point))return;let n=D.GetDirections(e.point,t.point);if(D.IsPureDirectionD(n)){this.FindOrAddEdgeVV(e,t);return}let s=iu.FindBendPointBetween(e.point,t.point,r),o=this.FindOrAddVertex(s);this.FindOrAddEdge(e,o,i),this.FindOrAddEdge(o,t,i)}AddEdgeToTargetEdge(e,t,r){let i=this.VisGraph.FindVertex(r);return null==i&&(i=this.AddVertex(r),this.SplitEdge(t,i)),this.FindOrAddEdgeVV(e,i),i}SplitEdge(e,t){return null==e?null:g.closeDistEps(e.Source.point,t.point)||g.closeDistEps(e.Target.point,t.point)?e:(!(e instanceof tx)&&this.edgesToRestore.push(e),tT.RemoveEdge(e),(this.IsSparseVg||e.Weight===id.OverlappedWeight)&&t.Degree>0)?(this.FindOrAddEdge(t,e.Source,e.Weight),this.FindOrAddEdge(t,e.Target,e.Weight)):(this.CreateEdge(t,e.Target,e.Weight),this.CreateEdge(e.Source,t,e.Weight))}ExtendEdgeChainVRLPB(e,t,r,i,n){let s=D.GetDirections(r.start,r.end);if(s===eh.None)return;let o=iu.GetRectangleBound(t,s),a=iu.IsVerticalD(s)?g.RoundPoint(new g(e.point.x,o)):g.RoundPoint(new g(o,e.point.y));if(g.closeDistEps(a,e.point)||D.GetDirections(e.point,a)!==s)return;let l=r;D.GetDirections(a,l.end)===s&&(l=b.mkPP(l.start,a)),this.ExtendEdgeChain(e,s,l,r,i,n)}ExtendEdgeChain(e,t,r,i,n,s){if(D.GetDirections(e.point,r.end)!==t)return;let o=B.RotateLeft(t),a=iu.FindAdjacentVertex(e,o);if(null==a&&(o=B.OppositeDir(o),null==(a=iu.FindAdjacentVertex(e,o))))return;let l=B.OppositeDir(o),h={spliceTarget:null};this.ExtendSpliceWorker(a,t,l,r,i,s,h)&&this.ExtendSpliceWorker(h.spliceTarget,t,o,r,i,s,h),this.SpliceGroupBoundaryCrossings(n,e,r)}SpliceGroupBoundaryCrossings(e,t,r){if(null==e||0===e.Count())return;e.Reset();let i=r.start,n=r.end,s=D.GetDirections(i,n);!iu.IsAscending(s)&&(i=r.end,n=r.start,s=B.OppositeDir(s)),t=iJ.TraverseToFirstVertexAtOrAbove(t,i,B.OppositeDir(s));for(let r=t;null!=r;r=iu.FindAdjacentVertex(r,s)){let i=D.ComparePP(r.point,n)>=0;for(;e.CurrentIsBeforeOrAt(r.point);){let i=e.Pop();D.ComparePP(i.Location,t.point)>0&&0>=D.ComparePP(i.Location,n)&&this.SpliceGroupBoundaryCrossing(r,i,B.OppositeDir(s)),D.ComparePP(i.Location,t.point)>=0&&0>D.ComparePP(i.Location,n)&&this.SpliceGroupBoundaryCrossing(r,i,s)}if(i)break}}static TraverseToFirstVertexAtOrAbove(e,t,r){let i=e,n=B.OppositeDir(r);for(;;){let e=iu.FindAdjacentVertex(i,r);if(null==e||D.GetDirections(e.point,t)===n)break;i=e}return i}SpliceGroupBoundaryCrossing(e,t,r){var i,n;let s=ih.ToCrossingArray(t.Crossings,r);if(null!=s){let r=null!==(i=this.VisGraph.FindVertex(t.Location))&&void 0!==i?i:this.AddVertex(t.Location);!e.point.equal(r.point)&&this.FindOrAddEdgeVV(e,r);let o=s[0].GetInteriorVertexPoint(t.Location),a=null!==(n=this.VisGraph.FindVertex(o))&&void 0!==n?n:this.AddVertex(o),l=this.FindOrAddEdgeVV(r,a),h=s.map(e=>e.Group.InputShape);l.IsPassable=()=>h.some(e=>e.IsTransparent)}}ExtendSpliceWorker(e,t,r,i,n,s,o){let a=iu.FindAdjacentVertex(e,r);o.spliceTarget=iu.FindAdjacentVertex(a,r);let l={spliceSource:e};for(;iJ.GetNextSpliceSource(l,r,t);){;let e=iu.FindBendPointBetween(a.point,l.spliceSource.point,B.OppositeDir(r));if(iJ.IsPointPastSegmentEnd(n,e))break;if(o.spliceTarget=iJ.GetSpliceTarget(l,r,e),null==o.spliceTarget){if(this.IsSkippableSpliceSourceWithNullSpliceTarget(l.spliceSource,t))continue;if(this.ObstacleTree.SegmentCrossesAnObstacle(l.spliceSource.point,e))return!1}let h=this.VisGraph.FindVertex(e);if(null!=h){if(null==o.spliceTarget||null!=this.VisGraph.FindEdgePP(a.point,e))return null==o.spliceTarget&&this.FindOrAddEdge(a,h,s?id.OverlappedWeight:id.NormalWeight),!1}else h=this.AddVertex(e);if(this.FindOrAddEdge(a,h,s?id.OverlappedWeight:id.NormalWeight),this.FindOrAddEdge(l.spliceSource,h,s?id.OverlappedWeight:id.NormalWeight),s&&(s=this.SeeIfSpliceIsStillOverlapped(t,h)),a=h,0==(t&D.GetDirections(e,i.end))){o.spliceTarget=null;break}}return null!=o.spliceTarget}static GetNextSpliceSource(e,t,r){let i=iu.FindAdjacentVertex(e.spliceSource,r);if(null==i)for(i=e.spliceSource;;){if(null==(i=iu.FindAdjacentVertex(i,B.OppositeDir(t))))return!1;let e=iu.FindAdjacentVertex(i,r);if(null!=e){i=e;break}}return e.spliceSource=i,!0}static GetSpliceTarget(e,t,r){let i=D.GetDirections(e.spliceSource.point,r),n=i,s=e.spliceSource;for(;n===i&&(e.spliceSource=s,null!=(s=iu.FindAdjacentVertex(e.spliceSource,t)));){;if(g.closeDistEps(s.point,r)){s=iu.FindAdjacentVertex(s,t);break}n=D.GetDirections(s.point,r)}return s}SeeIfSpliceIsStillOverlapped(e,t){let r=this.FindNextEdge(t,B.RotateLeft(e)),i=null!=r&&id.NormalWeight===r.Weight;return!i&&(i=null!=(r=this.FindNextEdge(t,B.RotateRight(e)))&&id.NormalWeight===r.Weight),!i||this.ObstacleTree.PointIsInsideAnObstaclePD(t.point,e)}IsSkippableSpliceSourceWithNullSpliceTarget(e,t){if(iJ.IsSkippableSpliceSourceEdgeWithNullTarget(iu.FindAdjacentEdge(e,t)))return!0;let r=iu.FindAdjacentEdge(e,B.OppositeDir(t));return iJ.IsSkippableSpliceSourceEdgeWithNullTarget(r)||iJ.IsReflectionEdge(r)}static IsSkippableSpliceSourceEdgeWithNullTarget(e){return null!=e&&null!=e.IsPassable&&c(e.Length,iC.BoundaryWidth)}static IsReflectionEdge(e){return null!=e&&e.Weight===id.ReflectionWeight}static IsPointPastSegmentEnd(e,t){return D.GetDirections(e.start,e.end)===D.GetDirections(e.end,t)}toString(){return tb.String.format("{0} {1}",this.AddedVertices.length,this.edgesToRestore.length)}}class iQ{get LimitPortVisibilitySpliceToEndpointBoundingBox(){return this.TransUtil.LimitPortVisibilitySpliceToEndpointBoundingBox}set LimitPortVisibilitySpliceToEndpointBoundingBox(e){this.TransUtil.LimitPortVisibilitySpliceToEndpointBoundingBox=e}get VisGraph(){return this.graphGenerator.VisibilityGraph}get HScanSegments(){return this.graphGenerator.HorizontalScanSegments}get VScanSegments(){return this.graphGenerator.VerticalScanSegments}get ObstacleTree(){return this.graphGenerator.ObstacleTree}get AncestorSets(){return this.ObstacleTree.AncestorSets}constructor(e){this.obstaclePortMap=new Map,this.freePointMap=new t_,this.freePointLocationsUsedByRouteEdges=new eN,this.RouteToCenterOfObstacles=!1,this.obstaclePortsInGraph=[],this.freePointsInGraph=new Set,this.activeAncestors=[],this.TransUtil=new iJ(e),this.graphGenerator=e}Clear(){this.TransUtil.RemoveFromGraph(),this.obstaclePortMap.clear()}CreateObstaclePorts(e){for(let t of e.Ports)this.CreateObstaclePort(e,t)}CreateObstaclePort(e,t){if(null==t.Curve)return null;let r=g.RoundPoint(t.Location);if(el.Outside===C.PointRelativeToCurveLocation(r,e.InputShape.BoundaryCurve)||e.InputShape.BoundaryCurve!==t.Curve&&el.Outside===C.PointRelativeToCurveLocation(r,t.Curve))return null;let i=new iP(t,e);return this.obstaclePortMap.set(t,i),i}FindVertices(e){let t=[],r=this.obstaclePortMap.get(e);if(r){if(this.RouteToCenterOfObstacles)t.push(r.CenterVertex);else for(let e of r.PortEntrances){let r=this.VisGraph.FindVertex(e.UnpaddedBorderIntersect);null!=r&&t.push(r)}}else t.push(this.VisGraph.FindVertex(g.RoundPoint(e.Location)));return t}RemoveObstaclePorts(e){for(let t of e.Ports)this.RemoveObstaclePort(t)}RemoveObstaclePort(e){this.obstaclePortMap.delete(e)}AddControlPointsToGraph(e,t){this.GetPortSpliceLimitRectangle(e),this.activeAncestors=[];let r={oport:null},i={oport:null},n=this.FindAncestorsAndObstaclePort(e.sourcePort,r),s=this.FindAncestorsAndObstaclePort(e.targetPort,i);if(this.AncestorSets.size>0&&null!=r.oport&&null!=i.oport){let e=eL(s,n),r=eL(n,s);this.ActivateAncestors(r,e,t)}this.AddPortToGraph(e.sourcePort,r.oport),this.AddPortToGraph(e.targetPort,i.oport)}ConnectOobWaypointToEndpointVisibilityAtGraphBoundary(e,t){if(null==e||!e.IsOutOfBounds)return;let r=this.FindVertices(t),i=e.OutOfBoundsDirectionFromGraph&(eh.North|eh.South);this.ConnectToGraphAtPointsCollinearWithVertices(e,i,r),i=e.OutOfBoundsDirectionFromGraph&(eh.East|eh.West),this.ConnectToGraphAtPointsCollinearWithVertices(e,i,r)}ConnectToGraphAtPointsCollinearWithVertices(e,t,r){if(eh.None===t)return;let i=B.OppositeDir(t);for(let n of r){let r=this.InBoundsGraphBoxIntersect(n.point,t),s=this.VisGraph.FindVertex(r);null!=s&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,s,i,id.NormalWeight)}}SetAllAncestorsActive(e,t){if(0===this.AncestorSets.size)return!1;this.ObstacleTree.AdjustSpatialAncestors(),this.ClearActiveAncestors();let r=this.FindAncestorsAndObstaclePort(e.sourcePort,{oport:null}),i=this.FindAncestorsAndObstaclePort(e.targetPort,{oport:null});return!!(this.AncestorSets.size>0)&&null!=r&&null!=i&&(this.ActivateAncestors(r,i,t),!0)}SetAllGroupsActive(){for(let e of(this.ClearActiveAncestors(),this.ObstacleTree.GetAllGroups()))e.IsTransparentAncestor=!0,this.activeAncestors.push(e)}FindAncestorsAndObstaclePort(e,t){return(t.oport=this.FindObstaclePort(e),0===this.AncestorSets.size)?null:null!=t.oport?this.AncestorSets.get(t.oport.Obstacle.InputShape):new Set(Array.from(this.ObstacleTree.Root.AllHitItems(M.mkPP(e.Location,e.Location),e=>e.IsGroup)).map(e=>e.InputShape))}ActivateAncestors(e,t,r){for(let i of eD(e,t)){let e=r.get(i);e.IsTransparentAncestor=!0,this.activeAncestors.push(e)}}ClearActiveAncestors(){for(let e of this.activeAncestors)e.IsTransparentAncestor=!1;this.activeAncestors=[]}RemoveControlPointsFromGraph(){this.ClearActiveAncestors(),this.RemoveObstaclePortsFromGraph(),this.RemoveFreePointsFromGraph(),this.TransUtil.RemoveFromGraph(),this.portSpliceLimitRectangle=M.mkEmpty()}RemoveObstaclePortsFromGraph(){for(let e of this.obstaclePortsInGraph)e.RemoveFromGraph();this.obstaclePortsInGraph=[]}RemoveFreePointsFromGraph(){for(let e of this.freePointsInGraph)e.RemoveFromGraph();this.freePointsInGraph.clear()}RemoveStaleFreePoints(){if(this.freePointMap.size>this.freePointLocationsUsedByRouteEdges.size)for(let e of Array.from(this.freePointMap).filter(e=>!this.freePointLocationsUsedByRouteEdges.has(e[0])))this.freePointMap.deleteP(e[0])}ClearVisibility(){for(let e of(this.freePointMap.clear(),this.obstaclePortMap.values()))e.ClearVisibility()}BeginRouteEdges(){this.RemoveControlPointsFromGraph(),this.freePointLocationsUsedByRouteEdges.clear()}EndRouteEdges(){this.RemoveStaleFreePoints()}FindObstaclePort(e){let t=this.obstaclePortMap.get(e);if(t){let r={removedPorts:null,addedPorts:null};if(t.Obstacle.GetPortChanges(r)){for(let e of r.addedPorts)this.CreateObstaclePort(t.Obstacle,e);for(let e of r.removedPorts)this.RemoveObstaclePort(e);t=this.obstaclePortMap.get(e)}}return t}AddPortToGraph(e,t){if(null!=t){this.AddObstaclePortToGraph(t);return}this.AddFreePointToGraph(e.Location)}AddObstaclePortToGraph(e){if(!e.LocationHasChanged||(this.RemoveObstaclePort(e.Port),null!=(e=this.CreateObstaclePort(e.Obstacle,e.Port))))for(let t of(e.AddToGraph(this.TransUtil,this.RouteToCenterOfObstacles),this.obstaclePortsInGraph.push(e),this.CreateObstaclePortEntrancesIfNeeded(e),e.PortEntrances))this.AddObstaclePortEntranceToGraph(t)}CreateObstaclePortEntrancesIfNeeded(e){if(!(e.PortEntrances.length>0))this.CreateObstaclePortEntrancesFromPoints(e)}GetPortVisibilityIntersection(e){let t=this.FindObstaclePort(e.sourcePort),r=this.FindObstaclePort(e.targetPort);if(null==t||null==r||t.Obstacle.IsInConvexHull||r.Obstacle.IsInConvexHull)return null;if(this.CreateObstaclePortEntrancesIfNeeded(t),this.CreateObstaclePortEntrancesIfNeeded(r),!t.VisibilityRectangle.intersects(r.VisibilityRectangle))return null;for(let e of t.PortEntrances){if(!!e.WantVisibilityIntersection)for(let t of r.PortEntrances){if(!t.WantVisibilityIntersection)continue;let r=e.IsVertical===t.IsVertical?iQ.GetPathPointsFromOverlappingCollinearVisibility(e,t):iQ.GetPathPointsFromIntersectingVisibility(e,t);if(null!=r)return r}}return null}static GetPathPointsFromOverlappingCollinearVisibility(e,t){return!iu.IntervalsAreSame(e.MaxVisibilitySegment.start,e.MaxVisibilitySegment.end,t.MaxVisibilitySegment.end,t.MaxVisibilitySegment.start)||e.HasGroupCrossings||t.HasGroupCrossings||g.closeDistEps(e.UnpaddedBorderIntersect,t.UnpaddedBorderIntersect)?null:[e.UnpaddedBorderIntersect,t.UnpaddedBorderIntersect]}static GetPathPointsFromIntersectingVisibility(e,t){let r=iu.SegmentsIntersectLL(e.MaxVisibilitySegment,t.MaxVisibilitySegment);return!r||e.HasGroupCrossingBeforePoint(r)||t.HasGroupCrossingBeforePoint(r)?null:[e.UnpaddedBorderIntersect,r,t.UnpaddedBorderIntersect]}CreateObstaclePortEntrancesFromPoints(e){let t=this.graphGenerator.ObstacleTree.GraphBox,r=M.mkPP(g.RoundPoint(e.PortCurve.boundingBox.leftBottom),g.RoundPoint(e.PortCurve.boundingBox.rightTop)),i=g.RoundPoint(e.PortLocation),n=!1,s={xx0:null,xx1:null};if(!D.Equal(i.y,r.top)&&!D.Equal(i.y,r.bottom)){n=!0;let o=new b(t.left,i.y,t.right,i.y);this.GetBorderIntersections(i,o,e.PortCurve,s);let a=new g(Math.min(s.xx0.x,s.xx1.x),i.y);a.x<r.left&&(a=new g(r.left,a.y));let l=new g(Math.max(s.xx0.x,s.xx1.x),i.y);l.x>r.right&&(l=new g(r.right,l.y)),this.CreatePortEntrancesAtBorderIntersections(r,e,i,a,l)}if(!D.Equal(i.x,r.left)&&!D.Equal(i.x,r.right)){n=!0;let o=new b(i.x,t.bottom,i.x,t.top);this.GetBorderIntersections(i,o,e.PortCurve,s);let a=new g(i.x,Math.min(s.xx0.y,s.xx1.y));a.y<t.bottom&&(a=new g(a.x,t.bottom));let l=new g(i.x,Math.max(s.xx0.y,s.xx1.y));l.y>t.top&&(l=new g(l.x,t.top)),this.CreatePortEntrancesAtBorderIntersections(r,e,i,a,l)}!n&&this.CreateEntrancesForCornerPort(r,e,i)}GetBorderIntersections(e,t,r,i){let n=C.getAllIntersections(t,r,!0);i.xx0=g.RoundPoint(n[0].x),i.xx1=g.RoundPoint(n[1].x)}CreatePortEntrancesAtBorderIntersections(e,t,r,i,n){let s=D.GetDirections(i,n);!D.EqualPP(i,r)&&this.CreatePortEntrance(e,t,n,s),!D.EqualPP(n,r)&&this.CreatePortEntrance(e,t,i,B.OppositeDir(s))}static GetDerivative(e,t){let r=e.PortCurve.closestParameter(t),i=e.PortCurve.derivative(r),n=(e.PortCurve.parStart+e.PortCurve.parEnd)/2;return!rl.CurveIsClockwise(e.PortCurve,e.PortCurve.value(n))&&(i=i.mul(-1)),i}CreatePortEntrance(e,t,r,i){t.CreatePortEntrance(r,i,this.ObstacleTree);let n=ic.GetInstance(i),s=iu.GetRectangleBound(e,i)-n.Coord(r);if(s<0&&(s=-s),s>l.intersectionEpsilon){let e;let n=B.VectorDirection(iQ.GetDerivative(t,r));B.OppositeDir(i),eh.None!==(i&n)&&(e=B.OppositeDir(e)),t.CreatePortEntrance(r,e,this.ObstacleTree)}}CreateEntrancesForCornerPort(e,t,r){let i=eh.North;D.EqualPP(r,e.leftBottom)?i=eh.South:D.EqualPP(r,e.leftTop)?i=eh.West:D.EqualPP(r,e.rightTop)?i=eh.North:D.EqualPP(r,e.rightBottom)&&(i=eh.East),t.CreatePortEntrance(r,i,this.ObstacleTree),t.CreatePortEntrance(r,B.RotateRight(i),this.ObstacleTree)}AddObstaclePortEntranceToGraph(e){let t=this.VisGraph.FindVertex(e.VisibilityBorderIntersect);if(t){e.ExtendEdgeChain(this.TransUtil,t,t,this.portSpliceLimitRectangle,this.RouteToCenterOfObstacles);return}let r={targetVertex:null},i=e.IsOverlapped?id.OverlappedWeight:id.NormalWeight;null!=this.FindorCreateNearestPerpEdgePPDNT(e.MaxVisibilitySegment.end,e.VisibilityBorderIntersect,e.OutwardDirection,i,r)&&e.AddToAdjacentVertex(this.TransUtil,r.targetVertex,this.portSpliceLimitRectangle,this.RouteToCenterOfObstacles)}InBoundsGraphBoxIntersect(e,t){return iu.RectangleBorderIntersect(this.graphGenerator.ObstacleTree.GraphBox,e,t)}FindorCreateNearestPerpEdgePPDN(e,t,r,i){return this.FindorCreateNearestPerpEdgePPDNT(e,t,r,i,{targetVertex:null})}FindorCreateNearestPerpEdgePPDNT(e,t,r,i,n){let s=iu.SortAscending(e,t),o=s[0],a=s[1],l=iu.IsVerticalD(r)?this.HScanSegments:this.VScanSegments,h=iu.IsAscending(r)?l.FindLowestIntersector(o,a):l.FindHighestIntersector(o,a);if(null==h)return n.targetVertex=null,null;let u=iu.SegmentIntersectionSP(h,o);return this.FindOrCreateNearestPerpEdgeFromNearestPerpSegment(iu.IsAscending(r)?o:a,h,u,i,n)}FindOrCreateNearestPerpEdgeFromNearestPerpSegment(e,t,r,i,n){var s;let o={segsegVertex:this.VisGraph.FindVertex(r),targetVertex:null};if(null==o.segsegVertex){let n=this.FindOrCreateSegmentIntersectionVertexAndAssociatedEdge(e,r,t,i,o);if(null!=n)return n}else if(D.EqualPP(e,r))return n.targetVertex=o.segsegVertex,this.TransUtil.FindNextEdge(n.targetVertex,B.OppositeDir(t.ScanDirection.Dir));let a=D.GetDirections(r,e),l=D.GetDirections(o.segsegVertex.point,e);if(a===l){let t={bracketTarget:null,bracketSource:null};return iJ.FindBracketingVertices(o.segsegVertex,e,a,t),null!==(s=this.TransUtil.FindNextEdge(t.bracketSource,B.RotateLeft(a)))&&void 0!==s?s:this.TransUtil.FindNextEdge(t.bracketSource,B.RotateRight(a))}l&=~a;let h=this.TransUtil.FindNearestPerpendicularOrContainingEdge(o.segsegVertex,l,e);return null==h?(n.targetVertex=this.TransUtil.AddVertex(r),this.TransUtil.FindOrAddEdge(n.targetVertex,t.HighestVisibilityVertex,t.Weight)):(o.segsegVertex=iu.GetEdgeEnd(h,B.OppositeDir(l)),r=iu.SegmentIntersectionPPP(e,r,o.segsegVertex.point),D.EqualPP(o.segsegVertex.point,r))?(n.targetVertex=o.segsegVertex,this.TransUtil.FindNextEdge(o.segsegVertex,l)):(n.targetVertex=this.TransUtil.FindOrAddVertex(r),this.TransUtil.FindOrAddEdge(o.segsegVertex,n.targetVertex,i))}FindOrCreateSegmentIntersectionVertexAndAssociatedEdge(e,t,r,i,n){let s=(r.IsVertical?this.HScanSegments:this.VScanSegments).FindHighestIntersector(r.Start,t);if(null==s)return n.segsegVertex=null,n.targetVertex=this.TransUtil.AddVertex(t),this.TransUtil.FindOrAddEdge(n.targetVertex,r.LowestVisibilityVertex,r.Weight);let o=iu.SegmentsIntersection(r,s);if(n.segsegVertex=this.VisGraph.FindVertex(o),!n.segsegVertex){n.segsegVertex=this.TransUtil.AddVertex(o);let e=this.AddEdgeToClosestSegmentEnd(r,n.segsegVertex,r.Weight);if(this.AddEdgeToClosestSegmentEnd(s,n.segsegVertex,s.Weight),D.EqualPP(n.segsegVertex.point,t))return n.targetVertex=n.segsegVertex,e}return D.EqualPP(e,t)?(n.targetVertex=this.TransUtil.FindOrAddVertex(t),this.TransUtil.FindOrAddEdge(n.segsegVertex,n.targetVertex,i)):(n.targetVertex=null,null)}AddEdgeToClosestSegmentEnd(e,t,r){return D.IsPureLower(e.HighestVisibilityVertex.point,t.point)?this.TransUtil.FindOrAddEdge(e.HighestVisibilityVertex,t,r):D.IsPureLower(t.point,e.LowestVisibilityVertex.point)?this.TransUtil.FindOrAddEdge(t,e.LowestVisibilityVertex,r):this.TransUtil.FindOrAddEdgeVV(e.LowestVisibilityVertex,t)}GetPortSpliceLimitRectangle(e){if(!this.LimitPortVisibilitySpliceToEndpointBoundingBox){this.portSpliceLimitRectangle=this.graphGenerator.ObstacleTree.GraphBox;return}this.portSpliceLimitRectangle=this.GetPortRectangle(e.sourcePort),this.portSpliceLimitRectangle.addRecSelf(this.GetPortRectangle(e.targetPort))}GetPortRectangle(e){let t=this.obstaclePortMap.get(e);return t?t.Obstacle.VisibilityBoundingBox.clone():M.mkOnPoints([g.RoundPoint(e.Location)])}AddToLimitRectangle(e){this.graphGenerator.IsInBoundsP(e)&&this.portSpliceLimitRectangle.add(e)}FindOrCreateFreePoint(e){let t=this.freePointMap.get(e);return t?t.GetVertex(this.TransUtil,e):(t=new iE(this.TransUtil,e),this.freePointMap.set(e,t)),this.freePointsInGraph.add(t),this.freePointLocationsUsedByRouteEdges.add(e),t}AddFreePointToGraph(e){let t;e=g.RoundPoint(e);let r=this.VisGraph.FindVertex(e),i=this.FindOrCreateFreePoint(e);if(null!=r)return i;if(!this.graphGenerator.IsInBoundsP(e))return this.CreateOutOfBoundsFreePoint(i),i;let n=null;i.IsOverlapped=this.ObstacleTree.PointIsInsideAnObstacle(i.Point,this.HScanSegments.ScanDirection),this.VScanSegments.FindSegmentContainingPoint(e,!0),null!=t&&(n=this.FindOrCreateNearestPerpEdgeFromNearestPerpSegment(e,t,e,i.InitialWeight,{targetVertex:null}));let s=eh.South;if(null!=n)s=iu.EdgeDirectionVE(n),this.ConnectFreePointToLateralEdge(i,B.RotateLeft(s)),this.ConnectFreePointToLateralEdge(i,B.RotateRight(s));else for(let e=0;e<4;e++)this.ConnectFreePointToLateralEdge(i,s),s=B.RotateLeft(s);return i}CreateOutOfBoundsFreePoint(e){let t=e.Point,r=this.graphGenerator.MakeInBoundsLocation(t),i=D.GetDirections(r,t);if(e.OutOfBoundsDirectionFromGraph=i,!D.IsPureDirectionD(i)){e.AddOobEdgesFromGraphCorner(this.TransUtil,r);return}let n=this.VisGraph.FindVertex(r),s=B.OppositeDir(i);if(null!=n)e.AddToAdjacentVertex(this.TransUtil,n,s,this.portSpliceLimitRectangle);else{let o=this.FindorCreateNearestPerpEdgePPDN(t,r,i,id.NormalWeight);null!=o&&(n=e.AddEdgeToAdjacentEdge(this.TransUtil,o,s,this.portSpliceLimitRectangle))}let o=iu.FindAdjacentVertex(n,B.RotateLeft(s));null!=o&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,o,s,id.NormalWeight);let a=iu.FindAdjacentVertex(n,B.RotateRight(s));null!=a&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,a,s,id.NormalWeight)}ConnectFreePointToLateralEdge(e,t){let r=e.IsOverlapped?this.InBoundsGraphBoxIntersect(e.Point,t):e.MaxVisibilityInDirectionForNonOverlappedFreePoint(t,this.TransUtil),i=this.FindorCreateNearestPerpEdgePPDN(r,e.Point,t,e.InitialWeight);null!=i&&e.AddEdgeToAdjacentEdge(this.TransUtil,i,t,this.portSpliceLimitRectangle)}}class i1 extends e0{get RouteToCenterOfObstacles(){return this.PortManager.RouteToCenterOfObstacles}set RouteToCenterOfObstacles(e){this.PortManager.RouteToCenterOfObstacles=e}get LimitPortVisibilitySpliceToEndpointBoundingBox(){return this.PortManager.LimitPortVisibilitySpliceToEndpointBoundingBox}set LimitPortVisibilitySpliceToEndpointBoundingBox(e){this.PortManager.LimitPortVisibilitySpliceToEndpointBoundingBox=e}AddEdgeGeometryToRoute(e){g.closeDistEps(g.RoundPoint(e.sourcePort.Location),g.RoundPoint(e.targetPort.Location))?this.selfEdges.push(e):this.EdgesToRoute.push(e)}get EdgeGeometriesToRoute(){return this.EdgesToRoute}RemoveAllEdgeGeometriesToRoute(){this.EdgesToRoute=[]}get UseSparseVisibilityGraph(){return this.GraphGenerator instanceof iK}get Obstacles(){return Array.from(this.ShapeToObstacleMap.values()).map(e=>e.InputShape)}get PaddedObstacles(){return Array.from(this.ShapeToObstacleMap.values()).map(e=>e.PaddedPolyline)}AddObstacles(e){this.AddShapes(e),this.RebuildTreeAndGraph()}AddShapes(e){for(let t of e)this.AddObstacleWithoutRebuild(t)}AddObstacle(e){this.AddObstacleWithoutRebuild(e),this.RebuildTreeAndGraph()}UpdateObstacles(e){for(let t of e)this.UpdateObstacleWithoutRebuild(t);this.RebuildTreeAndGraph()}UpdateObstacle(e){this.UpdateObstacleWithoutRebuild(e),this.RebuildTreeAndGraph()}RemoveObstacles(e){for(let t of e)this.RemoveObstacleWithoutRebuild(t);this.RebuildTreeAndGraph()}RemoveObstacle(e){this.RemoveObstacleWithoutRebuild(e),this.RebuildTreeAndGraph()}AddObstacleWithoutRebuild(e){if(null==e.BoundaryCurve)throw Error("Shape must have a BoundaryCurve");this.CreatePaddedObstacle(e)}UpdateObstacleWithoutRebuild(e){if(null==e.BoundaryCurve)throw Error("Shape must have a BoundaryCurve");this.PortManager.RemoveObstaclePorts(this.ShapeToObstacleMap.get(e)),this.CreatePaddedObstacle(e)}CreatePaddedObstacle(e){let t=new iw(e,this.Padding);this.ShapeToObstacleMap.set(e,t),this.PortManager.CreateObstaclePorts(t)}RemoveObstacleWithoutRebuild(e){let t=this.ShapeToObstacleMap.get(e);this.ShapeToObstacleMap.delete(e),this.PortManager.RemoveObstaclePorts(t)}RemoveAllObstacles(){this.InternalClear(!1)}RebuildTreeAndGraph(){let e=null!=this.ObsTree.Root,t=null!=this.GraphGenerator.VisibilityGraph;this.InternalClear(!0),e&&this.GenerateObstacleTree(),t&&this.GenerateVisibilityGraph()}get VisibilityGraph(){return this.GenerateVisibilityGraph(),this.GraphGenerator.VisibilityGraph}Clear(){this.InternalClear(!1)}static constructorEmpty(){return i1.constructorC(null)}static constructorC(e){return new i1([],i1.DefaultPadding,i1.DefaultCornerFitRadius)}static constructorI(e){return new i1(e,i1.DefaultPadding,i1.DefaultCornerFitRadius)}static constructorINN(e,t,r){return new i1(e,t,r)}constructor(e,t,r){super(null),this.Padding=0,this.CornerFitRadius=0,this.edgeSeparatian=3,this.BendPenaltyAsAPercentageOfDistance=0,this.ShapeToObstacleMap=new Map,this.EdgesToRoute=[],this.removeStaircases=!0,this.selfEdges=[],this.Padding=t,this.CornerFitRadius=r,this.BendPenaltyAsAPercentageOfDistance=im.DefaultBendPenaltyAsAPercentageOfDistance,this.GraphGenerator=new iK,this.PortManager=new iQ(this.GraphGenerator),this.AddShapes(e)}static constructorGNAN(e,t,r,i){let n=new i1(rM.GetShapes(e),r,i);if(null==t)for(let t of e.deepEdges)n.AddEdgeGeometryToRoute(t);else for(let e of t)n.AddEdgeGeometryToRoute(e);return n}run(){this.GenerateVisibilityGraph(),this.GeneratePaths()}GeneratePaths(){let e=this.EdgesToRoute.map(e=>new ib(e));this.FillEdgePathsWithShortestPaths(e),this.NudgePaths(e),this.RouteSelfEdges(),this.FinaliseEdgeGeometries()}RouteSelfEdges(){for(let e of this.selfEdges){let t={smoothedPolyline:null};e.curve=V.RouteSelfEdge(e.sourcePort.Curve,Math.max(this.Padding,2*e.GetMaxArrowheadLength()),t)}}FillEdgePathsWithShortestPaths(e){this.PortManager.BeginRouteEdges();let t=new iv(this.BendPenaltyAsAPercentageOfDistance);for(let r of e)this.AddControlPointsAndGeneratePath(t,r);this.PortManager.EndRouteEdges()}AddControlPointsAndGeneratePath(e,t){let r=this.PortManager.GetPortVisibilityIntersection(t.GeomEdge);if(null!=r){this.GeneratePathThroughVisibilityIntersection(t,r);return}this.SpliceVisibilityAndGeneratePath(e,t)}GeneratePathThroughVisibilityIntersection(e,t){e.PathPoints=t}SpliceVisibilityAndGeneratePath(e,t){this.PortManager.AddControlPointsToGraph(t.GeomEdge,this.ShapeToObstacleMap),!this.GeneratePath(e,t,!1)&&this.RetryPathsWithAdditionalGroupsEnabled(e,t),this.PortManager.RemoveControlPointsFromGraph()}GeneratePath(e,t,r){let i=this.PortManager.FindVertices(t.GeomEdge.sourcePort),n=this.PortManager.FindVertices(t.GeomEdge.targetPort);return i1.GetSingleStagePath(t,e,i,n,r)}static GetSingleStagePath(e,t,r,i,n){return e.PathPoints=t.GetPath(r,i),n&&i1.EnsureNonNullPath(e),null!=e.PathPoints&&e.PathPoints.length>0}static EnsureNonNullPath(e){null==e.PathPoints&&(D.IsPureDirection(e.GeomEdge.sourcePort.Location,e.GeomEdge.targetPort.Location)?e.PathPoints=[e.GeomEdge.sourcePort.Location,e.GeomEdge.targetPort.Location]:e.PathPoints=[e.GeomEdge.sourcePort.Location,new g(e.GeomEdge.sourcePort.Location.x,e.GeomEdge.targetPort.Location.y),e.GeomEdge.targetPort.Location])}RetryPathsWithAdditionalGroupsEnabled(e,t){(!this.PortManager.SetAllAncestorsActive(t.GeomEdge,this.ShapeToObstacleMap)||!this.GeneratePath(e,t,!1))&&(this.PortManager.SetAllGroupsActive(),this.GeneratePath(e,t,!0))}NudgePaths(e){let t=this.ObsTree.SpatialAncestorsAdjusted?sL.GetAncestorSetsMap(this.Obstacles):this.AncestorsSets;ia.NudgePaths(e,this.edgeSeparatian,this.PaddedObstacles,t,this.RemoveStaircases)}get RemoveStaircases(){return this.removeStaircases}set RemoveStaircases(e){this.removeStaircases=e}FinaliseEdgeGeometries(){for(let e of this.EdgesToRoute.concat(this.selfEdges)){if(null!=e.curve)e.curve instanceof A&&(e.curve=i1.FitArcsIntoCorners(this.CornerFitRadius,Array.from(e.curve))),i1.CalculateArrowheads(e)}}CreateVisibilityGraph(){this.GraphGenerator.Clear(),this.InitObstacleTree(),this.GraphGenerator.GenerateVisibilityGraph()}static CalculateArrowheads(e){rP.trimSplineAndCalculateArrowheadsII(e,e.sourcePort.Curve,e.targetPort.Curve,e.curve,!0)}get ObsTree(){return this.GraphGenerator.ObstacleTree}GenerateObstacleTree(){if(null==this.Obstacles||0===this.Obstacles.length)throw Error("No obstacles have been added");null==this.ObsTree.Root&&this.InitObstacleTree()}InitObstacleTree(){this.AncestorsSets=sL.GetAncestorSetsMap(this.Obstacles),this.ObsTree.Init(this.ShapeToObstacleMap.values(),this.AncestorsSets,this.ShapeToObstacleMap)}InternalClear(e){this.GraphGenerator.Clear(),this.ClearShortestPaths(),e?this.PortManager.ClearVisibility():(this.PortManager.Clear(),this.ShapeToObstacleMap.clear(),this.EdgesToRoute=[])}ClearShortestPaths(){for(let e of this.EdgesToRoute)e.curve=null}GenerateVisibilityGraph(){if(null==this.Obstacles||0===this.Obstacles.length)throw Error("No obstacles have been set");null==this.GraphGenerator.VisibilityGraph&&this.CreateVisibilityGraph()}static FitArcsIntoCorners(e,t){if(0==e)return A.mkFromPoints(t);let r=i1.GetFittedArcSegs(e,t),i=new C,n=null;for(let e of r){let r=i1.EllipseIsAlmostLineSegment(e);null!=n?r?C.continueWithLineSegmentP(i,i1.CornerPoint(e)):(C.continueWithLineSegmentP(i,e.start),i.addSegment(e)):r?C.addLineSegment(i,t[0],i1.CornerPoint(e)):(C.addLineSegment(i,t[0],e.start),i.addSegment(e)),n=e}return i.segs.length>0?C.continueWithLineSegmentP(i,t[t.length-1]):C.addLineSegment(i,t[0],t[t.length-1]),i}static CornerPoint(e){return e.center.add(e.aAxis.add(e.bAxis))}static EllipseIsAlmostLineSegment(e){return e.aAxis.lengthSquared<1e-4||e.aAxis.lengthSquared<1e-4}static*GetFittedArcSegs(e,t){let r=t[1].sub(t[0]),i=r.normalize(),n=Math.min(e,r.length/2);for(let s=1;s<t.length-1;s++){let o=(r=t[s+1].sub(t[s])).length;if(o<l.intersectionEpsilon){yield new T(0,0,new g(0,0),new g(0,0),t[s]);continue}let a=r.div(o);Math.abs(a.dot(i))>.9&&(yield new T(0,0,new g(0,0),new g(0,0),t[s]));let h=Math.min(e,r.length/2),u=a.mul(-h),c=i.mul(n);yield new T(0,Math.PI/2,u,c,t[s].sub(c.add(u))),i=a,n=h}}}i1.DefaultPadding=1,i1.DefaultCornerFitRadius=3;class i0{constructor(e,t,r,i=1){this.Source=e,this.Target=t,this.CrossingWeight=r,this.Weight=i}toString(){return tb.String.format("{0}->{1}",this.Source,this.Target)}}class i2{static FindClosestPoints(e,t){let r=C.minDistWithinIntervals(e,t,e.parStart,e.parEnd,t.parStart,t.parEnd,(e.parStart+e.parEnd)/2,(t.parStart+t.parEnd)/2);if(r)return{curveClosestPoint:r.aX,labelSideClosest:r.bX}}static GetSegmentInFrontOfLabel(e,t){if(e instanceof C){for(let r of e.segs)if((r.start.y-t)*(r.end.y-t)<=0)return r}return null}static ShiftLabel(e,t,r){let i=e.lineWidth/2,n=t.sub(r),s=n.length;s>i&&e.label.positionCenter(e.label.center.add(n.div(s*(s-i))))}static updateLabel(e,t){let r=null;t.labelIsToTheRightOfTheSpline?(e.label.positionCenter(new g(t.x+t.rightAnchor/2,t.y)),r=b.mkPP(e.label.boundingBox.leftTop,e.label.boundingBox.leftBottom)):t.labelIsToTheLeftOfTheSpline&&(e.label.positionCenter(new g(t.x-t.leftAnchor/2,t.y)),r=b.mkPP(e.label.boundingBox.rightTop,e.label.boundingBox.rightBottom));let i=i2.GetSegmentInFrontOfLabel(e.curve,e.label.center.y);if(null!=i&&0===C.getAllIntersections(e.curve,C.polyFromBox(e.label.boundingBox),!1).length){let t=i2.FindClosestPoints(i,r);if(t)i2.ShiftLabel(e,t.curveClosestPoint,t.labelSideClosest);else{let t,n;let s=i.closestParameter(r.start),o=i.closestParameter(r.end);i.value(s).sub(r.start).length<i.value(o).sub(r.end).length?(t=i.value(s),n=r.start):(t=i.value(o),n=r.end),i2.ShiftLabel(e,t,n)}}}}class i3{get CrossingWeight(){return 1}constructor(e,t,r,i=1,n=1){this.reversed=!1,this.source=e,this.target=t,this.edge=r,this.weight=i,this.separation=n}get hasLabel(){return null!=this.edge.label}get labelWidth(){return this.edge.label.width}get labelHeight(){return this.edge.label.height}reverse(){let e=this.source;this.source=this.target,this.target=e,this.reversed=!this.reversed}toString(){return"edge("+this.source+"->"+this.target+")"}get curve(){return this.edge.curve}set curve(e){this.edge.curve=e}get underlyingPolyline(){return this.edge.smoothedPolyline}get LayerSpan(){return null!=this.LayerEdges?this.LayerEdges.length:0}isSelfEdge(){return this.source===this.target}reversedClone(){let e=new i3(this.target,this.source,this.edge);if(null!=this.LayerEdges){let t=this.LayerEdges.length;e.LayerEdges=Array(t);for(let r=0;r<t;r++){let i=this.LayerEdges[t-1-r];e.LayerEdges[r]=new i0(i.Target,i.Source,i.CrossingWeight)}e.LayerEdges[0].Source=this.target,e.LayerEdges[this.LayerEdges.length-1].Target=this.source}return e}get count(){return this.LayerEdges.length}getNode(e){if(e>=0){if(e<this.LayerEdges.length)return this.LayerEdges[e].Source;if(e===this.LayerEdges.length)return this.LayerEdges[e-1].Target}throw Error("wrong index "+e)}updateEdgeLabelPosition(e){if(null!=this.edge.label){let t=this.LayerEdges.length/2,r=this.LayerEdges[t];i2.updateLabel(this.edge,e[r.Source])}}[Symbol.iterator](){return this.nodes()}*nodes(){for(let e of(yield this.LayerEdges[0].Source,this.LayerEdges))yield e.Target}}class i5{constructor(){this.maxLayerOfGeomGraph=new Set,this.minLayerOfGeomGraph=new Set,this.sameLayerConstraints=[],this.upDownConstraints=[],this.gluedUpDownIntConstraints=new ij,this.sameLayerDictionaryOfRepresentatives=new Map,this.representativeToItsLayer=new Map,this.maxLayerInt=[],this.minLayerInt=[],this.sameLayerInts=[],this.upDownInts=[]}getFeedbackSetExternal(e,t){throw Error("Method not implemented.")}pinNodeToMaxLayer(e){this.maxLayerOfGeomGraph.add(e)}pinNodeToMinLayer(e){this.minLayerOfGeomGraph.add(e)}get isEmpty(){return 0===this.maxLayerOfGeomGraph.size&&0===this.minLayerOfGeomGraph.size&&0===this.sameLayerConstraints.length&&0===this.upDownConstraints.length}clear(){this.maxLayerOfGeomGraph.clear(),this.minLayerOfGeomGraph.clear(),this.sameLayerConstraints=[],this.upDownConstraints=[]}getFeedbackSetImp(e,t){return this.nodeIdToIndex=t,this.intGraph=e,this.maxRepresentative=-1,this.minRepresentative=-1,this.createIntegerConstraints(),this.glueTogetherSameConstraintsMaxAndMin(),this.addMaxMinConstraintsToGluedConstraints(),this.removeCyclesFromGluedConstraints(),this.getFeedbackSet()}removeCyclesFromGluedConstraints(){let e=rt(Array.from(this.gluedUpDownIntConstraints.values()),this.intGraph.nodeCount);for(let t of rk.getFeedbackSetWithConstraints(e,null))this.gluedUpDownIntConstraints.remove(t)}addMaxMinConstraintsToGluedConstraints(){if(-1!==this.maxRepresentative)for(let e=0;e<this.intGraph.nodeCount;e++){let t=this.nodeToRepr(e);t!==this.maxRepresentative&&this.gluedUpDownIntConstraints.add(new ri(this.maxRepresentative,t))}if(-1!==this.minRepresentative)for(let e=0;e<this.intGraph.nodeCount;e++){let t=this.nodeToRepr(e);t!==this.minRepresentative&&this.gluedUpDownIntConstraints.add(new ri(t,this.minRepresentative))}}glueTogetherSameConstraintsMaxAndMin(){this.createDictionaryOfSameLayerRepresentatives(),this.upDownInts.map(this.gluedIntPairNN),this.gluedUpDownIntConstraints=new ij}gluedIntPairNN(e){return new ri(this.nodeToRepr(e[0]),this.nodeToRepr(e[1]))}gluedIntPairI(e){return new ri(this.nodeToRepr(e.source),this.nodeToRepr(e.target))}gluedIntPair(e){return new ri(this.nodeToRepr(e.source),this.nodeToRepr(e.target))}gluedIntEdge(e){let t=this.nodeToRepr(e.source),r=new i3(t,this.nodeToRepr(e.target),e.edge);return r.separation=e.separation,r.weight=0,r}nodeToRepr(e){let t=this.sameLayerDictionaryOfRepresentatives.get(e);return t||e}createDictionaryOfSameLayerRepresentatives(){for(let e of t9(this.createGraphOfSameLayers()))this.glueSameLayerNodesOfALayer(e)}createGraphOfSameLayers(){return rt(this.createEdgesOfSameLayers(),this.intGraph.nodeCount)}createEdgesOfSameLayers(){let e=[];return -1!==this.maxRepresentative&&this.maxLayerInt.filter(e=>e!==this.maxRepresentative).map(e=>new ri(this.maxRepresentative,e)).forEach(t=>e.push(t)),-1!==this.minRepresentative&&this.minLayerInt.filter(e=>e!==this.minRepresentative).map(e=>new ri(this.minRepresentative,e)).forEach(t=>e.push(t)),this.sameLayerInts.forEach(t=>e.push(new ri(t[0],t[1]))),e}glueSameLayerNodesOfALayer(e){if(e.length>1){let t=-1;if(this.componentsIsMaxLayer(e))for(let r of e)this.sameLayerDictionaryOfRepresentatives.set(r,t=this.maxRepresentative);else if(this.componentIsMinLayer(e))for(let r of e)this.sameLayerDictionaryOfRepresentatives.set(r,t=this.minRepresentative);else for(let r of e)-1===t&&(t=r),this.sameLayerDictionaryOfRepresentatives.set(r,t);this.representativeToItsLayer.set(t,e)}}componentIsMinLayer(e){return e.findIndex(e=>this.minRepresentative===e)>=0}componentsIsMaxLayer(e){return e.findIndex(e=>this.maxRepresentative===e)>=0}createIntegerConstraints(){this.createMaxIntConstraints(),this.createMinIntConstraints(),this.createUpDownConstraints(),this.createSameLayerConstraints()}createSameLayerConstraints(){this.sameLayerInts=this.createIntConstraintsFromStringCouples(this.sameLayerConstraints)}createUpDownConstraints(){this.upDownInts=this.createIntConstraintsFromStringCouples(this.upDownConstraints)}createIntConstraintsFromStringCouples(e){return e.map(e=>[this.nodeIndex(e[0]),this.nodeIndex(e[1])]).filter(e=>-1!==e[0]&&-1!==e[1])}createMinIntConstraints(){this.minLayerInt=this.createIntConstraintsFromExtremeLayer(this.minLayerOfGeomGraph),this.minLayerInt.length>0&&(this.minRepresentative=this.minLayerInt[0])}createMaxIntConstraints(){this.maxLayerInt=this.createIntConstraintsFromExtremeLayer(this.maxLayerOfGeomGraph),this.maxLayerInt.length>0&&(this.maxRepresentative=this.maxLayerInt[0])}createIntConstraintsFromExtremeLayer(e){return Array.from(e).map(e=>this.nodeIndex(e)).filter(e=>-1!==e)}nodeIndex(e){let t=this.nodeIdToIndex.get(e.node.id);return t||-1}getFeedbackSet(){return this.gluedIntGraph=this.createGluedGraph(),Array.from(this.unglueIntPairs(rk.getFeedbackSetWithConstraints(this.gluedIntGraph,this.gluedUpDownIntConstraints)))}*unglueIntPairs(e){for(let t of e)for(let e of this.unglueEdge(t))yield e}*unglueEdge(e){for(let t of this.unglueNode(e.source))for(let r of this.intGraph.outEdges[t])this.nodeToRepr(r.target)===e.target&&(yield r)}createGluedGraph(){let e=new ij;return this.intGraph.edges.forEach(t=>e.add(this.gluedIntPairI(t))),rt(Array.from(e.values()),this.intGraph.nodeCount)}unglueNode(e){let t=this.representativeToItsLayer.get(e);return t?t:[e]}getGluedNodeCounts(){let e=Array(this.nodeIdToIndex.size).fill(0);for(let t=0;t<e.length;t++)e[this.nodeToRepr(t)]++;return e}}class i6{constructor(){this.leftRightConstraints=[],this.leftRightNeighbors=[],this.nodeToBlockRoot=new Map,this.upDownVerticalConstraints=[],this.BlockRootToBlock=new Map}get IsEmpty(){return 0===this.leftRightNeighbors.length&&0===this.upDownVerticalConstraints.length&&0===this.leftRightConstraints.length}AddSameLayerNeighbors(e){for(let t=0;t<e.length-1;t++)this.AddSameLayerNeighborsPair(e[t],e[t+1])}AddSameLayerNeighborsPair(e,t){this.leftRightNeighbors.push([e,t])}NodeToBlockRootSoft(e){let t=this.nodeToBlockRoot.get(e);return t||e}CreateMappingOfNeibBlocks(){let e=this.BasicGraphFromLeftRightIntNeibs();for(let t=0;t<e.nodeCount;t++)if(0===e.inEdges[t].length&&!this.nodeToBlockRoot.has(t)){let r=[],i=t;for(let n=e.outEdges[i];n.length>0;n=e.outEdges[i])i=n[0].y,r.push(i),this.nodeToBlockRoot.set(i,t);r.length>0&&this.BlockRootToBlock.set(t,r)}}BasicGraphFromLeftRightIntNeibs(){return t7(Array.from(this.LeftRightIntNeibs.values()).map(e=>new ri(e.x,e.y)))}NodeIndex(e){let t=this.nodeIdToIndex.get(e.id);return t||-1}PrepareForOrdering(e,t){this.nodeIdToIndex=e,this.MapNodesToToIntegers(t),this.CreateMappingOfNeibBlocks(),this.LiftLeftRightRelationsToNeibBlocks()}LiftLeftRightRelationsToNeibBlocks(){for(let e of(this.LeftRighInts=ij.mk(this.leftRightConstraints.map(e=>{var t;return t=this.NodeIndex(e[0]),[t,this.NodeIndex(e[1])]}).filter(e=>-1!==e[0]&&-1!==e[1]).map(e=>new ri(this.NodeToBlockRootSoft(e[0]),this.NodeToBlockRootSoft(e[1]))).filter(e=>e.x!=e.x)),rk.getFeedbackSet(t7(Array.from(this.LeftRighInts.values())))))this.LeftRighInts.remove(new ri(e.source,e.target))}MapNodesToToIntegers(e){this.LeftRightIntNeibs=ij.mk(Array.from(this.leftRightNeighbors.values()).map(e=>[this.NodeIndex(e[0]),this.NodeIndex(e[1])]).filter(e=>-1!==e[0]&&-1!==e[1]).map(e=>new ri(e[0],e[1]))),this.VerticalInts=ij.mk(this.upDownVerticalConstraints.map(e=>[this.NodeIndex(e[0]),this.NodeIndex(e[1])]).filter(t=>-1!==t[0]&&-1!==t[1]&&e[t[0]]>e[t[1]]).map(e=>new ri(e[0],e[1])))}}(X=ev||(ev={}))[X.TB=0]="TB",X[X.LR=1]="LR",X[X.BT=2]="BT",X[X.RL=3]="RL",X[X.None=4]="None",($=eb||(eb={}))[$.Spline=0]="Spline",$[$.SplineBundling=1]="SplineBundling",$[$.StraightLine=2]="StraightLine",$[$.SugiyamaSplines=3]="SugiyamaSplines",$[$.Rectilinear=4]="Rectilinear",$[$.RectilinearToCenter=5]="RectilinearToCenter",$[$.None=6]="None";class i4{toJSON(){let e={};return this.EdgeRoutingMode!=eb.Spline&&(e.edgeRoutingMode=eb.Spline),this.ConeAngle!=Math.PI/180*30&&(e.coneAngle=this.ConeAngle),3!=this.padding&&(e.padding=this.padding),1.5!=this.polylinePadding&&(e.polylinePadding=this.polylinePadding),this.bundlingSettings&&(e.bundlingSettingsJSON=this.bundlingSettings.toJSON()),e}static fromJSON(e){let t=new i4;return e.edgeRoutingMode&&(e.edgeRoutingMode=t.edgeRoutingMode),e.coneAngle&&(t.coneAngle=e.coneAngle),e.padding&&(t.padding=e.padding),e.polylinePadding&&(t.polylinePadding=e.polylinePadding),e.bundlingSettingsJSON&&(t.bundlingSettings=tW.createFromJSON(e.bundlingSettingsJSON)),e.routingToParentConeAngle&&(t.routingToParentConeAngle=e.routingToParentConeAngle),e.simpleSelfLoopsForParentEdgesThreshold&&(t.simpleSelfLoopsForParentEdgesThreshold=e.simpleSelfLoopsForParentEdgesThreshold),e.incrementalRoutingThreshold&&(t.incrementalRoutingThreshold=e.incrementalRoutingThreshold),e.routeMultiEdgesAsBundles&&(t.routeMultiEdgesAsBundles=e.routeMultiEdgesAsBundles),e.KeepOriginalSpline&&(t.KeepOriginalSpline=e.KeepOriginalSpline),t}constructor(){this.coneAngle=Math.PI/180*30,this.padding=2,this.polylinePadding=1,this.routingToParentConeAngle=Math.PI/6,this.simpleSelfLoopsForParentEdgesThreshold=200,this.incrementalRoutingThreshold=5e6,this.routeMultiEdgesAsBundles=!0,this.KeepOriginalSpline=!1,this.EdgeRoutingMode=eb.Spline}get EdgeRoutingMode(){return this.edgeRoutingMode}set EdgeRoutingMode(e){e===eb.SplineBundling&&null==this.bundlingSettings&&null==this.bundlingSettings&&(this.bundlingSettings=new tW),this.edgeRoutingMode=e}get ConeAngle(){return this.coneAngle}set ConeAngle(e){this.coneAngle=e}get Padding(){return this.padding}set Padding(e){this.padding=e}get PolylinePadding(){return this.polylinePadding}set PolylinePadding(e){this.polylinePadding=e}get RoutingToParentConeAngle(){return this.routingToParentConeAngle}set RoutingToParentConeAngle(e){this.routingToParentConeAngle=e}get SimpleSelfLoopsForParentEdgesThreshold(){return this.simpleSelfLoopsForParentEdgesThreshold}set SimpleSelfLoopsForParentEdgesThreshold(e){this.simpleSelfLoopsForParentEdgesThreshold=e}get IncrementalRoutingThreshold(){return this.incrementalRoutingThreshold}set IncrementalRoutingThreshold(e){this.incrementalRoutingThreshold=e}get RouteMultiEdgesAsBundles(){return this.routeMultiEdgesAsBundles}set RouteMultiEdgesAsBundles(e){this.routeMultiEdgesAsBundles=e}}class i9{constructor(){this.edgeRoutingSettings=new i4,this.nodeSeparation=10,this.packingAspectRatio=1.5}static fromJSON(e){let t=new i9;return 10!=e.nodeSeparation&&(t.nodeSeparation=e.nodeSeparation),e.packingAspectRatio&&(t.packingAspectRatio=e.packingAspectRatio),e.edgeRoutingSettings&&(t.edgeRoutingSettings=i4.fromJSON(e.edgeRoutingSettings)),t}toJSON(){let e=!1,t={};return 10!=this.nodeSeparation&&(t.nodeSeparation=this.nodeSeparation,e=!0),1.5!=this.packingAspectRatio&&(t.packingAspectRatio=this.packingAspectRatio,e=!0),(t.edgeRoutingSettings=this.edgeRoutingSettings.toJSON())&&(e=!0),e?t:void 0}get NodeSeparation(){return this.nodeSeparation}set NodeSeparation(e){this.nodeSeparation=e}get PackingAspectRatio(){return this.packingAspectRatio}set PackingAspectRatio(e){this.packingAspectRatio=e}}(Y=ey||(ey={}))[Y.None=0]="None",Y[Y.Top=1]="Top",Y[Y.Bottom=2]="Bottom";class i8{get NodeSeparation(){return this.commonSettings.NodeSeparation}get edgeRoutingSettings(){return this.commonSettings.edgeRoutingSettings}set edgeRoutingSettings(e){this.commonSettings.edgeRoutingSettings=e}toJSON(){let e={};return this.sameRanks&&(e.sameRanks=this.sameRanks),this.verticalConstraints&&(e.verticalConstraints=this.verticalConstraints),this.horizontalConstraints&&(e.horizontalConstraints=this.horizontalConstraints),5!=this.NoGainAdjacentSwapStepsBound&&(e.horizontalConstraints=this.horizontalConstraints),1!=this.NoGainStepsForOrderingMultiplier&&(e.RepetitionCoefficientForOrdering=this.NoGainStepsForOrderingMultiplier),this.AspectRatio&&(e.AspectRatio=this.AspectRatio),24!=this.MaxNumberOfPassesInOrdering&&(e.MaxNumberOfPassesInOrdering=this.MaxNumberOfPassesInOrdering),600!=this.BrandesThreshold&&(e.BrandesThreshold=this.BrandesThreshold),.1!=this.LabelCornersPreserveCoefficient&&(e.LabelCornersPreserveCoefficient=this.LabelCornersPreserveCoefficient),9!=this.MinNodeHeight&&(e.MinNodeHeight=this.MinNodeHeight),13.5!=this.MinNodeWidth&&(e.MinNodeWidth=this.MinNodeWidth),this.SnapToGridByY!=ey.None&&(e.SnapToGridByY=this.SnapToGridByY),30!=this.yLayerSep&&(e.yLayerSep=this.yLayerSep),this.transform&&(e.transform=this.transform.elements),this.GridSizeByY&&(e.GridSizeByY=this.GridSizeByY),this.GridSizeByX&&(e.GridSizeByX=this.GridSizeByX),e.commonLayoutSettings=this.commonSettings.toJSON(),e}static fromJSON(e){let t=new i8;return e.sameRanks&&(t.sameRanks=e.sameRanks),e.verticalConstraints&&(t.verticalConstraints=e.verticalConstraints),e.horizontalConstraints&&(t.horizontalConstraints=e.horizontalConstraints),e.NoGainAdjacentSwapStepsBound&&(t.horizontalConstraints=e.horizontalConstraints),e.RepetitionCoefficientForOrdering&&(t.NoGainStepsForOrderingMultiplier=e.RepetitionCoefficientForOrdering),e.AspectRatio&&(t.AspectRatio=e.AspectRatio),e.MaxNumberOfPassesInOrdering&&(t.MaxNumberOfPassesInOrdering=e.MaxNumberOfPassesInOrdering),e.BrandesThreshold&&(t.BrandesThreshold=e.BrandesThreshold),e.LabelCornersPreserveCoefficient&&(t.LabelCornersPreserveCoefficient=e.LabelCornersPreserveCoefficient),e.MinNodeHeight&&(t.MinNodeHeight=e.MinNodeHeight),e.MinNodeWidth&&(t.MinNodeWidth=t.MinNodeWidth),e.SnapToGridByY&&(t.SnapToGridByY=e.SnapToGridByY),e.yLayerSep&&(t.yLayerSep=e.yLayerSep),e.transform&&(t.transform=new k(e.transform[0][0],e.transform[0][1],e.transform[0][2],e.transform[1][0],e.transform[1][1],e.transform[1][2])),e.GridSizeByY&&(t.GridSizeByY=e.GridSizeByY),e.GridSizeByX&&(t.GridSizeByX=e.GridSizeByX),e.commonLayoutSettings&&(t.commonSettings=i9.fromJSON(e.commonLayoutSettings)),t}get LayerSeparation(){return this.yLayerSep}set LayerSeparation(e){this.yLayerSep=Math.max(30,e)}ActualLayerSeparation(e){return e?this.LayerSeparation/2:this.LayerSeparation}constructor(){this.commonSettings=new i9,this.verticalConstraints=new i5,this.horizontalConstraints=new i6,this.NoGainAdjacentSwapStepsBound=5,this.NoGainStepsForOrderingMultiplier=1,this.AspectRatio=0,this.MaxNumberOfPassesInOrdering=24,this.BrandesThreshold=600,this.LabelCornersPreserveCoefficient=.1,this.MinNodeHeight=9,this.MinNodeWidth=13.5,this.SnapToGridByY=ey.None,this.yLayerSep=30,this.transform=k.getIdentity(),this.GridSizeByY=0,this.GridSizeByX=0,this.commonSettings.edgeRoutingSettings.EdgeRoutingMode=eb.SugiyamaSplines}transformIsRotation(e){let t=k.rotation(e);for(let e=0;e<2;e++)for(let r=0;r<3;r++)if(!c(t.elements[e][r],this.transform.elements[e][r]))return!1;return!0}get layerDirection(){if(this.transformIsRotation(0))return ev.TB;if(this.transformIsRotation(Math.PI/2))return ev.LR;if(this.transformIsRotation(-Math.PI/2))return ev.RL;if(this.transformIsRotation(Math.PI))return ev.BT;throw Error("unexpected layout direction")}set layerDirection(e){switch(e){case ev.TB:this.transform=k.getIdentity();break;case ev.LR:this.transform=k.rotation(Math.PI/2);break;case ev.RL:this.transform=k.rotation(-Math.PI/2);break;case ev.BT:this.transform=k.rotation(Math.PI);break;default:throw Error("unexpected layout direction")}}}class i7 extends e0{constructor(e,t,r){super(null),this.graph=e,this.source=t,this.length=r}get Result(){return this.result}run(){let e=new rd((e,t)=>e-t),t=new Map;for(let r of this.graph.shallowNodes){let i=r===this.source?0:Number.POSITIVE_INFINITY;e.Enqueue(r,i),t.set(r,i)}for(;e.count>0;){let r={priority:0},i=e.DequeueAndGetPriority(r);t.set(i,r.priority);let n=t.get(i);for(let r of i.inEdges()){let i=r.source,s=n+this.length(r);t.get(i)>s&&(t.set(i,s),e.DecreasePriority(i,s))}for(let r of i.outEdges()){let i=r.target,s=n+this.length(r);t.get(i)>s&&(t.set(i,s),e.DecreasePriority(i,s))}}this.result=Array(this.graph.shallowNodeCount);let r=0;for(let e of this.graph.shallowNodes){let i=t.get(e);void 0!==i?this.result[r++]=i:this.result[r++]=Number.POSITIVE_INFINITY}}}class ne extends e0{get Result(){return this.result}set Result(e){this.result=e}constructor(e,t){super(null),this.graph=e,this.length=t}run(){this.result=Array(this.graph.shallowNodeCount);let e=0;for(let t of this.graph.shallowNodes){let r=new i7(this.graph,t,this.length);r.run(),this.Result[e++]=r.Result}}static Stress(e,t){let r=0;if(0===e.edgeCount)return r;let i=new ne(e,t);i.run();let n=i.Result,s=0;for(let r of e.shallowEdges)s+=t(r);s/=e.edgeCount;let o=0;for(let t of e.shallowNodes){let i=0;for(let a of e.shallowNodes){if(o!==i){let e=t.center.sub(a.center).length,l=s*n[o][i],h=l-e;r+=h*h/(l*l)}i++}o++}return r}}class nt extends e0{get Result(){return this.result}constructor(e,t,r){super(null),this.graph=e,this.pivotArray=t,this.length=r}run(){this.result=Array(this.pivotArray.length);let e=Array.from(this.graph.shallowNodes),t=Array(this.graph.shallowNodeCount).fill(Number.POSITIVE_INFINITY),r=e[0];this.pivotArray[0]=0;for(let i=0;;i++){let n=new i7(this.graph,r,this.length);if(n.run(),this.Result[i]=n.Result,i+1<this.pivotArray.length){let n=0;for(let e=0;e<this.Result[i].length;e++)t[e]=Math.min(t[e],this.Result[i][e]),t[e]>t[n]&&(n=e);r=e[n],this.pivotArray[i+1]=n}else break}}}class nr{static Rotate(e,t,r){let i=Math.sin(Math.PI/180*r),n=Math.cos(Math.PI/180*r);for(let r=0;r<e.length;r++){let s=n*e[r]+i*t[r];t[r]=n*t[r]-i*e[r],e[r]=s}}}class ni{static DoubleCenter(e){let t=Array(e.length).fill(0),r=Array(e[0].length).fill(0),i=0;for(let n=0;n<e.length;n++)for(let s=0;s<e[0].length;s++)t[n]+=e[n][s],r[s]+=e[n][s],i+=e[n][s];for(let r=0;r<e.length;r++)t[r]/=e.length;for(let t=0;t<e[0].length;t++)r[t]/=e[0].length;i/=e.length,i/=e[0].length;for(let n=0;n<e.length;n++)for(let s=0;s<e[0].length;s++)e[n][s]-=t[n]+r[s]-i}static SquareEntries(e){for(let t=0;t<e.length;t++)for(let r=0;r<e[0].length;r++)e[t][r]=Math.pow(e[t][r],2)}static Multiply(e,t){for(let r=0;r<e.length;r++)for(let i=0;i<e[0].length;i++)e[r][i]*=t}static MultiplyX(e,t){if(e[0].length!==t.length)return null;let r=Array(t.length).fill(0);for(let i=0;i<e.length;i++)for(let n=0;n<e[0].length;n++)r[i]+=e[i][n]*t[n];return r}static Norm(e){let t=0;for(let r=0;r<e.length;r++)t+=Math.pow(e[r],2);return Math.sqrt(t)}static Normalize(e){let t=ni.Norm(e);if(t<=0)return 0;for(let r=0;r<e.length;r++)e[r]/=t;return t}static RandomUnitLengthVector(e){let t=Array(e);for(let r=0;r<e;r++)t[r]=t4();return ni.Normalize(t),t}static SpectralDecomposition(e,t){ni.SpectralDecompositionIE(e,t,30,1e-6)}static SpectralDecompositionIE(e,t,r,i){let n=e[0].length;t.u1=ni.RandomUnitLengthVector(n),t.lambda1=0,t.u2=ni.RandomUnitLengthVector(n),t.lambda2=0;let s=0,o=1-i;for(let i=0;i<r&&s<o;i++){let r=ni.MultiplyX(e,t.u1),i=ni.MultiplyX(e,t.u2);t.lambda1=ni.Normalize(r),t.lambda2=ni.Normalize(i),ni.MakeOrthogonal(i,r),ni.Normalize(i),s=Math.min(ni.DotProduct(t.u1,r),ni.DotProduct(t.u2,i)),t.u1=r,t.u2=i}}static DotProduct(e,t){if(e.length!==t.length)return 0;let r=0;for(let i=0;i<e.length;i++)r+=e[i]*t[i];return r}static MakeOrthogonal(e,t){if(e.length!==t.length)return;let r=ni.DotProduct(e,t)/ni.DotProduct(t,t);for(let i=0;i<e.length;i++)e[i]-=r*t[i]}static ClassicalScaling(e,t){let r=Array(e.length);for(let t=0;t<e.length;t++)r[t]=e[t].slice();ni.SquareEntries(r),ni.DoubleCenter(r),ni.Multiply(r,-.5),ni.SpectralDecomposition(r,t),t.lambda1=Math.sqrt(Math.abs(t.lambda1)),t.lambda2=Math.sqrt(Math.abs(t.lambda2));for(let e=0;e<t.u1.length;e++)t.u1[e]*=t.lambda1,t.u2[e]*=t.lambda2}static DistanceScalingSubset(e,t,r,i,n){let s=t.length,o=e.length,a=Array(o);for(let t=0;t<o;t++)for(let r=0;r<s;r++)0===e[t][r]&&(a[t]=r);let l=Array(o).fill(0);for(let e=0;e<o;e++)for(let t=0;t<s;t++)a[e]!==t&&(l[e]+=i[e][t]);for(let h=0;h<n;h++)for(let n=0;n<o;n++){let o=0,h=0;for(let l=0;l<s;l++)if(n!==l){let s=Math.sqrt(Math.pow(t[a[n]]-t[l],2)+Math.pow(r[a[n]]-r[l],2));s>0&&(s=1/s),o+=i[n][l]*(t[l]+e[n][l]*(t[a[n]]-t[l])*s),h+=i[n][l]*(r[l]+e[n][l]*(r[a[n]]-r[l])*s)}t[a[n]]=o/l[n],r[a[n]]=h/l[n]}}static DistanceScaling(e,t,r,i,n){let s=t.length,o=Array(s).fill(0);for(let e=0;e<s;e++)for(let t=0;t<s;t++)e!==t&&(o[e]+=i[e][t]);for(let a=0;a<n;a++)for(let n=0;n<s;n++){let a=0,l=0;for(let o=0;o<s;o++)if(n!==o){let s=Math.sqrt(Math.pow(t[n]-t[o],2)+Math.pow(r[n]-r[o],2));s>0&&(s=1/s),a+=i[n][o]*(t[o]+e[n][o]*(t[n]-t[o])*s),l+=i[n][o]*(r[o]+e[n][o]*(r[n]-r[o])*s)}t[n]=a/o[n],r[n]=l/o[n]}}static ExponentialWeightMatrix(e,t){let r=Array(e.length);for(let i=0;i<e.length;i++){r[i]=Array(e[i].length).fill(0);for(let n=0;n<e[i].length;n++)e[i][n]>0&&(r[i][n]=Math.pow(e[i][n],t))}return r}static EuclideanDistanceMatrix(e,t){let r=Array(e.length);for(let i=0;i<e.length;i++){r[i]=Array(e.length);for(let n=0;n<e.length;n++)r[i][n]=Math.sqrt(Math.pow(e[i]-e[n],2)+Math.pow(t[i]-t[n],2))}return r}static LandmarkClassicalScaling(e,t,r){let i=Array(e.length);for(let t=0;t<e.length;t++){i[t]=Array(e.length);for(let n=0;n<e.length;n++)i[t][n]=e[t][r[n]]}ni.SquareEntries(i);let n=Array(e.length).fill(0);for(let t=0;t<e.length;t++){for(let r=0;r<e.length;r++)n[t]+=i[t][r];n[t]/=e.length}ni.DoubleCenter(i),ni.Multiply(i,-.5);let s={u1:[],u2:[],lambda1:0,lambda2:0};ni.SpectralDecomposition(i,s),s.lambda1=Math.sqrt(Math.abs(s.lambda1)),s.lambda2=Math.sqrt(Math.abs(s.lambda2)),t.x=Array(e[0].length).fill(0),t.y=Array(e[0].length).fill(0);for(let r=0;r<t.x.length;r++)for(let o=0;o<i.length;o++){let i=(Math.pow(e[o][r],2)-n[o])/2;t.x[r]-=s.u1[o]*i,t.y[r]-=s.u2[o]*i}}}class nn{constructor(e,t){this.constrained=!1,this.Capacity=1e6,1===ng.AbovePP(e.point,t.point)?(this.upperSite=e,this.lowerSite=t):(this.lowerSite=e,this.upperSite=t),this.upperSite.AddEdgeToSite(this)}get CcwTriangle(){return this.ccwTriangle}set CcwTriangle(e){this.ccwTriangle=e}get CwTriangle(){return this.cwTriangle}set CwTriangle(e){this.cwTriangle=e}GetOtherTriangle_c(e){return this.cwTriangle.Contains(e)?this.ccwTriangle:this.cwTriangle}IsAdjacent(e){return e===this.upperSite||e===this.lowerSite}GetOtherTriangle_T(e){return this.ccwTriangle===e?this.cwTriangle:this.ccwTriangle}toString(){return tb.String.format("({0},{1})",this.upperSite,this.lowerSite)}OtherSite(e){return this.upperSite===e?this.lowerSite:this.upperSite}}class ns{cleanRemovedEdges(){for(let e of this.Edges)null===e.CcwTriangle&&null===e.CwTriangle&&this.Edges.splice(this.Edges.indexOf(e),1)}constructor(e){this.Owner=null,this.InEdges=[],this.point=e}static mkSO(e,t){let r=new ns(e);return r.Owner=t,r}AddEdgeToSite(e){null==this.Edges&&(this.Edges=[]),this.Edges.push(e)}EdgeBetweenUpperSiteAndLowerSite(e){if(null!=this.Edges){for(let t of this.Edges)if(t.lowerSite===e)return t}return null}AddInEdge(e){this.InEdges.push(e)}*Triangles(){let e;if(null!=this.Edges&&this.Edges.length>0)e=this.Edges[0];else{if(null==this.InEdges||!(this.InEdges.length>0))return;e=this.InEdges[0]}let t=e;do{let e=t.upperSite===this?t.CcwTriangle:t.CwTriangle;if(null==e){t=null;break}yield e,t=e.Edges.getItem(e.Edges.index(t)+2)}while(t!==e);if(t!==e)for(t=e;;){let e=t.upperSite===this?t.CwTriangle:t.CcwTriangle;if(null==e)break;yield e,t=e.Edges.getItem(e.Edges.index(t)+1)}}toString(){return this.point.toString()}}class no{get x(){return this.LeftSite.point.x}constructor(e,t){this.RightSite=t.upperSite===e?t.lowerSite:t.upperSite,this.LeftSite=e,this.Edge=t}toString(){return"("+this.LeftSite.toString()+", "+this.Edge.toString()+","+this.RightSite.toString()+")"}}class na{has(e){return e===this.item0||e===this.item1||e===this.item2}index(e){return e===this.item0?0:e===this.item1?1:e===this.item2?2:-1}getItem(e){switch(e){case 0:case 3:case -3:return this.item0;case 1:case 4:case -2:return this.item1;case 2:case 5:case -1:return this.item2;default:throw Error()}}setItem(e,t){switch(e){case 0:case 3:case -3:this.item0=t;break;case 1:case 4:case -2:this.item1=t;break;case 2:case 5:case -1:this.item2=t;break;default:throw Error()}}[Symbol.iterator](){return this.GetEnumerator()}*GetEnumerator(){yield this.item0,yield this.item1,yield this.item2}}class nl{constructor(){this.Edges=new na,this.Sites=new na}containsPoint(e){return nl.PointLocationForTriangle(e,this)!==el.Outside}static PointLocationForTriangle(e,t){let r=!1;for(let i=0;i<3;i++){let n=g.signedDoubledTriangleArea(e,t.Sites.getItem(i).point,t.Sites.getItem(i+1).point);if(n<-l.distanceEpsilon)return el.Outside;n<l.distanceEpsilon&&(r=!0)}return r?el.Boundary:el.Inside}intersectsLine(e,t,r){if(nl.PointLocationForTriangle(e,this)!=el.Outside||nl.PointLocationForTriangle(t,this)!=el.Outside)return!0;for(let r of this.Edges)if(this.abIntersectsTrianglSide(e,t,r))return!0;return!1}abIntersectsTrianglSide(e,t,r){return x(e,t,r.lowerSite.point,r.upperSite.point)}static mkSSSD(e,t,r,i){let n=g.getTriangleOrientation(e.point,t.point,r.point),s=new nl;switch(n){case eo.Counterclockwise:s.FillCcwTriangle(e,t,r,i);break;case eo.Clockwise:s.FillCcwTriangle(e,r,t,i);break;default:throw Error()}return s}static mkSED(e,t,r){let i=new nl;switch(g.getTriangleOrientation(t.upperSite.point,t.lowerSite.point,e.point)){case eo.Counterclockwise:t.CcwTriangle=i,i.Sites.setItem(0,t.upperSite),i.Sites.setItem(1,t.lowerSite);break;case eo.Clockwise:t.CwTriangle=i,i.Sites.setItem(0,t.lowerSite),i.Sites.setItem(1,t.upperSite);break;default:throw Error()}return i.Edges.setItem(0,t),i.Sites.setItem(2,e),i.CreateEdge(1,r),i.CreateEdge(2,r),i}static mkSSSEE(e,t,r,i,n,s){let o=nl.mkSSSD(e,t,r,s);return o.Edges.setItem(0,i),o.Edges.setItem(1,n),o.BindEdgeToTriangle(e,i),o.BindEdgeToTriangle(t,n),o.CreateEdge(2,s),o}BindEdgeToTriangle(e,t){e===t.upperSite?t.CcwTriangle=this:t.CwTriangle=this}FillCcwTriangle(e,t,r,i){this.Sites.setItem(0,e),this.Sites.setItem(1,t),this.Sites.setItem(2,r);for(let e=0;e<3;e++)this.CreateEdge(e,i)}CreateEdge(e,t){let r=this.Sites.getItem(e),i=t(r,this.Sites.getItem(e+1));this.Edges.setItem(e,i),this.BindEdgeToTriangle(r,i)}Contains(e){return this.Sites.has(e)}OppositeEdge(e){let t=this.Sites.index(e);return this.Edges.getItem(t+1)}OppositeSite(e){let t=this.Edges.index(e);return this.Sites.getItem(t+2)}BoundingBox(){let e=M.mkPP(this.Sites.getItem(0).point,this.Sites.getItem(1).point);return e.add(this.Sites.getItem(2).point),e}static mkSSSEED(e,t,r,i,n,s){let o=new nl;return o.Sites.setItem(0,e),o.Sites.setItem(1,t),o.Sites.setItem(2,r),o.Edges.setItem(0,i),o.Edges.setItem(1,n),o.BindEdgeToTriangle(e,i),o.BindEdgeToTriangle(t,n),o.CreateEdge(2,s),o}toString(){return this.Sites.getItem(0).toString()+","+this.Sites.getItem(1).toString()+","+this.Sites.getItem(2).toString()}}class nh{constructor(e){this.Edge=e}}class nu extends e0{constructor(e,t,r,i){if(super(null),this.front=new tu((e,t)=>e.x-t.x),this.triangles=new Set,this.listOfSites=e,0===this.listOfSites.length)return;this.p_1=t,this.p_2=r,this.createEdgeDelegate=i;let n=nl.mkSSSD(t,r,this.listOfSites[0],i);this.triangles.add(n),this.front.insert(new no(t,n.Edges.getItem(2))),this.front.insert(new no(this.listOfSites[0],n.Edges.getItem(1)))}run(){if(0!==this.listOfSites.length){for(let e=1;e<this.listOfSites.length;e++)this.ProcessSite(this.listOfSites[e]);this.FinalizeTriangulation()}}FinalizeTriangulation(){this.RemoveP1AndP2Triangles(),this.triangles.size>0&&this.MakePerimeterConvex()}MakePerimeterConvex(){let e=this.CreateDoubleLinkedListOfPerimeter();for(;;){let t=this.FindConcaveEdge(e);if(null==t)return;e=this.ShortcutTwoListElements(t)}}FindConcaveEdge(e){let t,r=e;do{if(t=r.Next,g.getTriangleOrientation(r.Start.point,r.End.point,t.End.point)===eo.Counterclockwise)return r;r=t}while(t!==e);return null}static FindPivot(e){let t=e,r=e;do((r=r.Next).Start.point.x<t.Start.point.x||r.Start.point.x===t.Start.point.x&&r.Start.point.y<t.Start.point.y)&&(t=r);while(r!==e);return t}FindFirsePerimeterEdge(){for(let e of this.triangles)for(let t of e.Edges)if(null==t.GetOtherTriangle_T(e))return t;return null}CreateDoubleLinkedListOfPerimeter(){let e;let t=this.FindFirsePerimeterEdge(),r=t,i=null,n=null,s=[];do e=nu.CreatePerimeterElementFromEdge(r),s.push(b.mkPP(e.Start.point,e.End.point)),r=nu.FindNextEdgeOnPerimeter(r),null!=n?(e.Prev=n,n.Next=e):i=e,n=e;while(r!==t);return i.Prev=e,e.Next=i,i}static FindNextEdgeOnPerimeter(e){var t;let r=null!==(t=e.CwTriangle)&&void 0!==t?t:e.CcwTriangle;for(e=r.Edges.getItem(r.Edges.index(e)+2);null!=e.CwTriangle&&null!=e.CcwTriangle;)e=(r=e.GetOtherTriangle_T(r)).Edges.getItem(r.Edges.index(e)+2);return e}static CreatePerimeterElementFromEdge(e){let t=new nh(e);return null!=e.CwTriangle?(t.Start=e.upperSite,t.End=e.lowerSite):(t.End=e.upperSite,t.Start=e.lowerSite),t}RemoveP1AndP2Triangles(){let e=new Set;for(let t of this.triangles)(t.Sites.has(this.p_1)||t.Sites.has(this.p_2))&&e.add(t);for(let t of e)nu.RemoveTriangleWithEdges(this.triangles,t)}static RemoveTriangleWithEdges(e,t){for(let r of(e.delete(t),t.Edges))r.CwTriangle===t?r.CwTriangle=null:r.CcwTriangle=null,null==r.CwTriangle&&null==r.CcwTriangle&&nc(r.upperSite.Edges,r)}static RemoveTriangleButLeaveEdges(e,t){for(let r of(e.delete(t),t.Edges))r.CwTriangle===t?r.CwTriangle=null:r.CcwTriangle=null}ProcessSite(e){this.PointEvent(e);for(let t=0;t<e.Edges.length;t++){let r=e.Edges[t];r.constrained&&this.EdgeEvent(r)}}EdgeEvent(e){if(!nu.EdgeIsProcessed(e))this.traversingEdge=e,this.runEdgeInserter()}static EdgeIsProcessed(e){return null!=e.CwTriangle||null!=e.CcwTriangle}ShowFrontWithSite(e,t=null){let r=[];if(null!=e.Edges)for(let t of e.Edges)r.push(r0.mkDebugCurveTWCI(200,.8,t.constrained?"Pink":"Brown",b.mkPP(t.upperSite.point,t.lowerSite.point)));for(let t of(r.push(r0.mkDebugCurveTWCI(200,1,"Brown",T.mkFullEllipseNNP(.5,.5,e.point))),this.triangles))for(let e=0;e<3;e++){let i=t.Edges.getItem(e);r.push(r0.mkDebugCurveTWCI(i.constrained?155:100,i.constrained?.8:.4,i.constrained?"Pink":"Navy",b.mkPP(i.upperSite.point,i.lowerSite.point)))}if(null!=t)for(let e of t)r.push(r0.mkDebugCurveTWCI(100,.5,"Red",e));for(let e of this.front)r.push(r0.mkDebugCurveTWCI(100,5.5,"Green",b.mkPP(e.Edge.upperSite.point,e.Edge.lowerSite.point)))}Show(e){nu.ShowCdt(Array.from(this.triangles.values()),this.front,null,null,[],e)}static ShowCdt(e,t,r,i,n,s){let o=[];if(null!=r)for(let e of r)o.push(r0.mkDebugCurveTWCI(200,.1,"Red",e));if(null!=i)for(let e of i)o.push(r0.mkDebugCurveTWCI(200,.1,"Blue",e));if(null!=t)for(let e of t)o.push(r0.mkDebugCurveTWCI(200,.1,"Green",b.mkPP(e.Edge.upperSite.point,e.Edge.lowerSite.point)));for(let t of e)for(let e=0;e<3;e++){let r=t.Edges.getItem(e);o.push(nu.GetDebugCurveOfCdtEdge(r))}o.concat(n)}static GetDebugCurveOfCdtEdge(e){return null==e.CcwTriangle||null==e.CwTriangle?r0.mkDebugCurveTWCI(255,.5,e.constrained?"Brown":"Black",b.mkPP(e.upperSite.point,e.lowerSite.point)):r0.mkDebugCurveTWCI(200,e.constrained?.8:.2,e.constrained?"Pink":"Navy",b.mkPP(e.upperSite.point,e.lowerSite.point))}PointEvent(e){let t=this.ProjectToFront(e),r={rightSite:null},i=t.item.x+l.distanceEpsilon<e.point.x?this.MiddleCase(e,t,r):this.LeftCase(e,t,r),n=this.InsertSiteIntoFront(i,e,r.rightSite);this.TriangulateEmptySpaceToTheRight(n),n=nu.FindNodeInFrontBySite(this.front,i),this.TriangulateEmptySpaceToTheLeft(n)}LeftCase(e,t,r){let i=t.item;this.InsertAndLegalizeTriangle(e,i);let n=this.front.previous(t),s=n.item.LeftSite;return r.rightSite=t.item.RightSite,this.InsertAndLegalizeTriangle(e,n.item),this.front.deleteNodeInternal(n),this.front.remove(i),s}MiddleCase(e,t,r){let i=t.item.LeftSite;return r.rightSite=t.item.RightSite,this.InsertAndLegalizeTriangle(e,t.item),this.front.deleteNodeInternal(t),i}TriangulateEmptySpaceToTheLeft(e){let t=e.item.RightSite,r=this.front.previous(e);for(;null!=r;){let i=r.item,n=i.LeftSite,s=i.RightSite;if(0>s.point.sub(t.point).dot(n.point.sub(s.point)))e=this.ShortcutTwoFrontElements(r,e),r=this.front.previous(e);else{this.TryTriangulateBasinToTheLeft(e);break}}}ShortcutTwoListElements(e){var t;let r=e.Next,i=nl.mkSSSEE(e.Start,e.End,r.End,e.Edge,r.Edge,this.createEdgeDelegate);this.triangles.add(i);let n=i.Edges.getItem(2);this.LegalizeEdge(e.Start,i.OppositeEdge(e.Start)),i=null!==(t=n.CcwTriangle)&&void 0!==t?t:n.CwTriangle,this.LegalizeEdge(r.End,i.OppositeEdge(r.End));let s=new nh(n);return s.Start=e.Start,s.End=r.End,e.Prev.Next=s,s.Prev=e.Prev,s.Next=r.Next,r.Next.Prev=s,s}ShortcutTwoFrontElements(e,t){var r;let i=e.item,n=t.item,s=nl.mkSSSEED(i.LeftSite,i.RightSite,n.RightSite,i.Edge,n.Edge,this.createEdgeDelegate);this.triangles.add(s),this.front.deleteNodeInternal(e),this.front.remove(n);let o=s.Edges.getItem(2);return this.LegalizeEdge(i.LeftSite,s.OppositeEdge(i.LeftSite)),s=null!==(r=o.CcwTriangle)&&void 0!==r?r:o.CwTriangle,this.LegalizeEdge(n.RightSite,s.OppositeEdge(n.RightSite)),this.front.insert(new no(i.LeftSite,o))}TryTriangulateBasinToTheLeft(e){if(!nu.DropsSharpEnoughToTheLeft(e.item))return;let t=new eE.Stack;for(t.push(e.item.LeftSite);;){let r=t.pop();e=nu.FindNodeInFrontBySite(this.front,r);let i=this.front.previous(e);if(null==i)return;if(g.getTriangleOrientation(i.item.LeftSite.point,e.item.LeftSite.point,e.item.RightSite.point)==eo.Counterclockwise)t.push(i.item.LeftSite),this.ShortcutTwoFrontElements(i,e);else if(e.item.LeftSite.point.y>e.item.RightSite.point.y)t.push(i.item.LeftSite);else{if(i.item.LeftSite.point.y<=i.item.RightSite.point.y)return;t.push(i.item.LeftSite)}}}static DropsSharpEnoughToTheLeft(e){let t=e.Edge;if(e.RightSite!==t.upperSite)return!1;let r=t.lowerSite.point.sub(t.upperSite.point);return r.x>=.5*r.y}InsertSiteIntoFront(e,t,r){let i=null,n=null;for(let s of t.Edges)if(null==n&&s.lowerSite===e&&(n=s),null==i&&s.lowerSite===r&&(i=s),null!=n&&null!=i)break;return this.front.insert(new no(e,n)),this.front.insert(new no(t,i))}TriangulateEmptySpaceToTheRight(e){let t=e.item.LeftSite.point,r=this.front.next(e);for(;null!=r;){let i=r.item,n=i.LeftSite,s=i.RightSite;if(0>n.point.sub(t).dot(s.point.sub(n.point)))e=this.ShortcutTwoFrontElements(e,r),r=this.front.next(e);else{this.TryTriangulateBasinToTheRight(e);break}}}TryTriangulateBasinToTheRight(e){if(!nu.DropsSharpEnoughToTheRight(e.item))return;let t=new eE.Stack;for(t.push(e.item.LeftSite);;){let r=t.pop();e=nu.FindNodeInFrontBySite(this.front,r);let i=this.front.next(e);if(null==i)return;if(g.getTriangleOrientation(e.item.LeftSite.point,e.item.RightSite.point,i.item.RightSite.point)==eo.Counterclockwise)this.ShortcutTwoFrontElements(e,i),t.push(r);else if(e.item.LeftSite.point.y>e.item.RightSite.point.y)t.push(e.item.RightSite);else{if(i.item.LeftSite.point.y>=i.item.RightSite.point.y)return;t.push(e.item.RightSite)}}}static DropsSharpEnoughToTheRight(e){let t=e.Edge;if(e.LeftSite!==t.upperSite)return!1;let r=t.lowerSite.point.sub(t.upperSite.point);return r.x<=-.5*r.y}static FindNodeInFrontBySite(e,t){return e.findLast(e=>e.LeftSite.point.x<=t.point.x)}InsertAndLegalizeTriangle(e,t){var r;if(g.getTriangleOrientation(e.point,t.LeftSite.point,t.RightSite.point)!==eo.Collinear){let r=nl.mkSED(e,t.Edge,this.createEdgeDelegate);this.triangles.add(r),this.LegalizeEdge(e,r.Edges.getItem(0))}else{let i=t.Edge;nc(i.upperSite.Edges,i);let n=null!==(r=i.CcwTriangle)&&void 0!==r?r:i.CwTriangle,s=n.OppositeSite(i);nu.RemoveTriangleButLeaveEdges(this.triangles,n),n=nl.mkSSSD(t.LeftSite,s,e,this.createEdgeDelegate);let o=nl.mkSSSD(t.RightSite,s,e,this.createEdgeDelegate);this.triangles.add(n),this.triangles.add(o),this.LegalizeEdge(e,n.OppositeEdge(e)),this.LegalizeEdge(e,o.OppositeEdge(e))}}LegalizeEdge(e,t){if(!t.constrained&&null!=t.CcwTriangle&&null!=t.CwTriangle)t.CcwTriangle.Contains(e)?this.LegalizeEdgeForOtherCwTriangle(e,t):this.LegalizeEdgeForOtherCcwTriangle(e,t)}LegalizeEdgeForOtherCwTriangle(e,t){let r=t.CwTriangle.Edges.index(t);if(nd(e,t.upperSite,t.CwTriangle.Sites.getItem(r+2),t.lowerSite)){let r=np(e,t);this.LegalizeEdge(e,r.CwTriangle.OppositeEdge(e)),this.LegalizeEdge(e,r.CcwTriangle.OppositeEdge(e))}}LegalizeEdgeForOtherCcwTriangle(e,t){let r=t.CcwTriangle.Edges.index(t);if(nd(e,t.lowerSite,t.CcwTriangle.Sites.getItem(r+2),t.upperSite)){let r=np(e,t);this.LegalizeEdge(e,r.CwTriangle.OppositeEdge(e)),this.LegalizeEdge(e,r.CcwTriangle.OppositeEdge(e))}}ProjectToFront(e){return this.front.findLast(t=>t.x<=e.point.x)}runEdgeInserter(){this.initEdgeInserter(),this.TraceEdgeThroughTriangles(),this.TriangulatePolygon0(this.rightPolygon,this.traversingEdge.upperSite,this.traversingEdge.lowerSite,!0),this.TriangulatePolygon0(this.leftPolygon,this.traversingEdge.upperSite,this.traversingEdge.lowerSite,!1),this.UpdateFront()}initEdgeInserter(){this.rightPolygon=[],this.leftPolygon=[],this.addedTriangles=[],this.piercedEdge=null,this.piercedTriangle=null,this.piercedToTheLeftFrontElemNode=null,this.piercedToTheRightFrontElemNode=null}UpdateFront(){let e=new Set;for(let t of this.addedTriangles)for(let r of t.Edges)if(null==r.CwTriangle||null==r.CcwTriangle){if(r.lowerSite==this.p_2&&r.upperSite==this.p_1)continue;e.add(r)}for(let t of e)this.AddEdgeToFront(t)}AddEdgeToFront(e){let t=e.upperSite.point.x<e.lowerSite.point.x?e.upperSite:e.lowerSite;this.front.insert(new no(t,e))}TriangulatePolygon0(e,t,r,i){e.length>0&&this.TriangulatePolygon1(0,e.length-1,e,t,r,i)}TriangulatePolygon1(e,t,r,i,n,s){let o=r[e],a=e;for(let l=e+1;l<=t;l++){let e=r[l];(function(e){return s?nf(e,i,o,n):nf(e,i,n,o)})(e)&&(a=l,o=e)}let l=nl.mkSSSD(i,n,o,this.createEdgeDelegate);this.triangles.add(l),this.addedTriangles.push(l),e<a&&this.TriangulatePolygon1(e,a-1,r,i,o,s),a<t&&this.TriangulatePolygon1(a+1,t,r,o,n,s)}TraceEdgeThroughTriangles(){this.initEdgeTracer(),this.Traverse()}Traverse(){for(;!this.BIsReached();)null!=this.piercedToTheLeftFrontElemNode?this.ProcessLeftFrontPiercedElement():null!=this.piercedToTheRightFrontElemNode?this.ProcessRightFrontPiercedElement():this.ProcessPiercedEdge();for(let e of(null!=this.piercedTriangle&&this.removePiercedTriangle(this.piercedTriangle),this.FindMoreRemovedFromFrontElements(),this.elementsToBeRemovedFromFront))this.front.remove(e)}ProcessLeftFrontPiercedElement(){let e=this.piercedToTheLeftFrontElemNode;do this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToLeftPolygon(e.item.LeftSite),e=this.front.previous(e);while(g.pointToTheLeftOfLine(e.item.LeftSite.point,this.a.point,this.b.point));if(this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToRightPolygon(e.item.LeftSite),e.item.LeftSite===this.b){this.piercedToTheLeftFrontElemNode=e;return}this.FindPiercedTriangle(e),this.piercedToTheLeftFrontElemNode=null}FindPiercedTriangle(e){var t;let r=e.item.Edge,i=null!==(t=r.CcwTriangle)&&void 0!==t?t:r.CwTriangle,n=i.Edges.index(r);for(let e=1;e<=2;e++){let t=i.Edges.getItem(e+n),r=rN.sign(g.signedDoubledTriangleArea(t.lowerSite.point,this.a.point,this.b.point));if(rN.sign(g.signedDoubledTriangleArea(t.upperSite.point,this.a.point,this.b.point))*r<=0){this.piercedTriangle=i,this.piercedEdge=t;break}}}FindMoreRemovedFromFrontElements(){for(let e of this.removedTriangles)for(let t of e.Edges)if(null==t.CcwTriangle&&null==t.CwTriangle){let e=t.upperSite.point.x<t.lowerSite.point.x?t.upperSite:t.lowerSite,r=nu.FindNodeInFrontBySite(this.front,e);r.item.Edge===t&&this.elementsToBeRemovedFromFront.push(r.item)}}ProcessPiercedEdge(){this.piercedEdge.CcwTriangle===this.piercedTriangle?(this.AddSiteToLeftPolygon(this.piercedEdge.lowerSite),this.AddSiteToRightPolygon(this.piercedEdge.upperSite)):(this.AddSiteToLeftPolygon(this.piercedEdge.upperSite),this.AddSiteToRightPolygon(this.piercedEdge.lowerSite)),this.removePiercedTriangle(this.piercedTriangle),this.PrepareNextStateAfterPiercedEdge()}PrepareNextStateAfterPiercedEdge(){var e,t;let r=null!==(e=this.piercedEdge.CwTriangle)&&void 0!==e?e:this.piercedEdge.CcwTriangle,i=r.Edges.index(this.piercedEdge);for(let e=1;e<=2;e++){let n=r.Edges.getItem(e+i),s=rN.sign(g.signedDoubledTriangleArea(n.lowerSite.point,this.a.point,this.b.point));if(rN.sign(g.signedDoubledTriangleArea(n.upperSite.point,this.a.point,this.b.point))*s<=0){if(null!=n.CwTriangle&&null!=n.CcwTriangle){this.piercedTriangle=r,this.piercedEdge=n;break}this.piercedTriangle=null,this.piercedEdge=null;let e=n.upperSite.point.x<n.lowerSite.point.x?n.upperSite:n.lowerSite,i=nu.FindNodeInFrontBySite(this.front,e);e.point.x<this.a.point.x?this.piercedToTheLeftFrontElemNode=i:this.piercedToTheRightFrontElemNode=i,this.removePiercedTriangle(null!==(t=n.CwTriangle)&&void 0!==t?t:n.CcwTriangle);break}}}removePiercedTriangle(e){for(let t of(this.triangles.delete(e),e.Edges))t.CwTriangle===e?t.CwTriangle=null:t.CcwTriangle=null,this.removedTriangles.push(e)}ProcessRightFrontPiercedElement(){let e=this.piercedToTheRightFrontElemNode;do this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToRightPolygon(e.item.RightSite),e=this.front.next(e);while(g.pointToTheRightOfLine(e.item.RightSite.point,this.a.point,this.b.point));if(this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToLeftPolygon(e.item.RightSite),e.item.RightSite===this.b){this.piercedToTheRightFrontElemNode=e;return}this.FindPiercedTriangle(e),this.piercedToTheRightFrontElemNode=null}AddSiteToLeftPolygon(e){this.AddSiteToPolygonWithCheck(e,this.leftPolygon)}AddSiteToPolygonWithCheck(e,t){if(e!==this.b)(0===t.length||t[t.length-1]!==e)&&t.push(e)}AddSiteToRightPolygon(e){this.AddSiteToPolygonWithCheck(e,this.rightPolygon)}BIsReached(){var e;let t=null!==(e=this.piercedToTheLeftFrontElemNode)&&void 0!==e?e:this.piercedToTheRightFrontElemNode;return null!=t?t.item.Edge.IsAdjacent(this.b):this.piercedEdge.IsAdjacent(this.b)}initEdgeTracer(){this.elementsToBeRemovedFromFront=[],this.a=this.traversingEdge.upperSite,this.b=this.traversingEdge.lowerSite,this.removedTriangles=[];let e=nu.FindNodeInFrontBySite(this.front,this.a),t=this.front.previous(e);if(g.pointToTheLeftOfLine(this.b.point,t.item.LeftSite.point,t.item.RightSite.point))this.piercedToTheLeftFrontElemNode=t;else if(g.pointToTheRightOfLine(this.b.point,e.item.RightSite.point,e.item.LeftSite.point))this.piercedToTheRightFrontElemNode=e;else for(let e of this.a.Edges){let t=e.CcwTriangle;if(null==t||g.pointToTheLeftOfLine(this.b.point,e.lowerSite.point,e.upperSite.point))continue;let r=t.Edges.index(e),i=t.Sites.getItem(r+2);if(g.pointToTheLeftOfLineOrOnLine(this.b.point,i.point,e.upperSite.point)){this.piercedEdge=t.Edges.getItem(r+1),this.piercedTriangle=t;break}}}}function nc(e,t){if(0===e.length)return;let r=e.findIndex(e=>t===e);r>=0&&(r!==e.length-1&&(e[r]=e[e.length-1]),e.pop())}function nd(e,t,r,i){return function(e,t,r,i){return g.getTriangleOrientation(t.point,e.point,r.point)===eo.Clockwise&&g.getTriangleOrientation(r.point,e.point,i.point)===eo.Clockwise}(e,t,r,i)&&nf(e,t,r,i)}function nf(e,t,r,i){let n=t.point.x-e.point.x,s=t.point.y-e.point.y,o=r.point.x-e.point.x,a=r.point.y-e.point.y,h=i.point.x-e.point.x,u=i.point.y-e.point.y,c=n*n+s*s,d=o*o+a*a,f=h*h+u*u;return n*(a*f-u*d)-o*(s*f-u*c)+h*(s*d-a*c)>l.tolerance}function np(e,t){let r,i;t.CcwTriangle.Contains(e)?(r=t.CcwTriangle,i=t.CwTriangle):(r=t.CwTriangle,i=t.CcwTriangle);let n=r.Edges.index(t),s=i.Edges.index(t),o=i.Sites.getItem(s+2),a=r.Edges.getItem(n+1),l=i.Edges.getItem(s+1),h=ng.GetOrCreateEdge(e,o);return r.Sites.setItem(n+1,o),r.Edges.setItem(n,l),r.Edges.setItem(n+1,h),i.Sites.setItem(s+1,e),i.Edges.setItem(s,a),i.Edges.setItem(s+1,h),l.lowerSite===o?l.CcwTriangle=r:l.CwTriangle=r,a.lowerSite===e?a.CcwTriangle=i:a.CwTriangle=i,h.upperSite===e?(h.CcwTriangle=i,h.CwTriangle=r):(h.CcwTriangle=r,h.CwTriangle=i),nc(t.upperSite.Edges,t),h}class ng extends e0{constructor(e,t,r){super(null),this.isolatedSites=[],this.obstacles=[],this.PointsToSites=new t_,this.simplifyObstacles=!0,this.rectangleNodeOnTriangles=null,this.isolatedSites=e,this.obstacles=t,this.isolatedSegments=r}static constructor_(e){let t=new ng(null,null,null);return t.isolatedSitesWithObject=e,t}FillAllInputSites(){if(null!=this.isolatedSitesWithObject)for(let e of this.isolatedSitesWithObject)this.AddSite(e[0],e[1]);if(null!=this.isolatedSites)for(let e of this.isolatedSites)this.AddSite(e,null);if(null!=this.obstacles)for(let e of this.obstacles)this.AddPolylineToAllInputSites(e);if(null!=this.isolatedSegments)for(let e of this.isolatedSegments)this.AddConstrainedEdge(e.A,e.B,null);this.AddP1AndP2(),this.allInputSites=Array.from(this.PointsToSites.values())}AddSite(e,t){let r;return(r=this.PointsToSites.get(e))?r.Owner=t:(r=ns.mkSO(e,t),this.PointsToSites.set(e,r)),r}AddP1AndP2(){let e=M.mkEmpty();for(let t of this.PointsToSites.keys())e.add(t);this.P1=new ns(e.leftBottom.add(new g(-10,-10))),this.P2=new ns(e.rightBottom.add(new g(10,-10)))}AddPolylineToAllInputSites(e){if(this.simplifyObstacles)for(let t=e.startPoint;null!=t;){let r=t.point;if(!(t=t.next))break;for(;t.next&&g.getTriangleOrientation(r,t.point,t.next.point)===eo.Collinear;)t=t.next;this.AddConstrainedEdge(r,t.point,e)}else for(let t=e.startPoint;null!=t.next;t=t.next)this.AddConstrainedEdge(t.point,t.next.point,e);e.closed&&this.AddConstrainedEdge(e.endPoint.point,e.startPoint.point,e)}AddConstrainedEdge(e,t,r){let i,n;ng.AbovePP(e,t)>0?(i=this.AddSite(e,r),n=this.AddSite(t,r)):(i=this.AddSite(t,r),n=this.AddSite(e,r)),ng.CreateEdgeOnOrderedCouple(i,n).constrained=!0}static GetOrCreateEdge(e,t){if(1===ng.AboveCC(e,t)){let r=e.EdgeBetweenUpperSiteAndLowerSite(t);return null!=r?r:ng.CreateEdgeOnOrderedCouple(e,t)}{let r=t.EdgeBetweenUpperSiteAndLowerSite(e);return null!=r?r:ng.CreateEdgeOnOrderedCouple(t,e)}}static CreateEdgeOnOrderedCouple(e,t){return new nn(e,t)}GetTriangles(){return this.sweeper.triangles}run(){this.Initialization(),this.SweepAndFinalize()}SweepAndFinalize(){this.sweeper=new nu(this.allInputSites,this.P1,this.P2,ng.GetOrCreateEdge),this.sweeper.run(),this.cleanRemovedEdges()}cleanRemovedEdges(){for(let e of this.PointsToSites.values())e.cleanRemovedEdges()}Initialization(){this.FillAllInputSites(),this.allInputSites.sort(ng.OnComparison)}static OnComparison(e,t){return ng.AboveCC(e,t)}static AbovePP(e,t){let r=e.y-t.y;return r>0?1:r<0?-1:(r=e.x-t.x)>0?-1:r<0?1:0}static AboveCC(e,t){return ng.AbovePP(e.point,t.point)}RestoreEdgeCapacities(){for(let e of this.allInputSites)for(let t of e.Edges)!t.constrained&&(t.ResidualCapacity=t.Capacity)}SetInEdges(){for(let e of this.PointsToSites.values())for(let t of e.Edges)t.lowerSite.AddInEdge(t)}FindSite(e){return this.PointsToSites.get(e)}static PointIsInsideOfTriangle(e,t){for(let r=0;r<3;r++){let i=t.Sites.getItem(r).point,n=t.Sites.getItem(r+1).point;if(g.signedDoubledTriangleArea(e,i,n)<-1*l.distanceEpsilon)return!1}return!0}getRectangleNodeOnTriangles(){return null==this.rectangleNodeOnTriangles&&(this.rectangleNodeOnTriangles=eC(Array.from(this.GetTriangles().values()).map(e=>eR(e,e.BoundingBox())))),this.rectangleNodeOnTriangles}}function nm(e){let t=Array.from(e.GetAllLeaves()),r=e.irect,i=r.diagonal/4,n=r.clone();return n.pad(i),function(e){let t=new ng(null,e,null);return t.run(),t}(t.concat([n.perimeter()]))}class nv{constructor(e,t){this.start=e,this.end=t}add(e){this.add_d(e)}add_rect(e){let t=this.clone();return t.add_d(e.start),t.add_d(e.end),t}clone(){return new nv(this.start,this.end)}contains_point(e){return this.contains_d(e)}contains_rect(e){return this.contains_d(e.start)&&this.contains_d(e.end)}intersection_rect(e){return new nv(Math.max(this.start,e.start),Math.min(this.end,e.end))}intersects_rect(e){return this.intersects(e)}contains_point_radius(e,t){return this.contains_d(e-t)&&this.contains_d(e+t)}static mkInterval(e,t){let r=new nv(e.start,e.end);return r.add_d(t.start),r.add_d(t.end),r}add_d(e){this.start>e&&(this.start=e),this.end<e&&(this.end=e)}get Start(){return this.start}set Start(e){this.start=e}get Length(){return this.end-this.start}contains_d(e){return this.start<=e&&e<=this.end}GetInRange(e){return e<this.start?this.start:e>this.end?this.end:e}intersects(e){return!(e.start>this.end+l.distanceEpsilon)&&!(e.end<this.start-l.distanceEpsilon)}}class nb{get Count(){return this.heapSize}constructor(e){this.heapSize=0,this._priors=Array(e),this._heap=Array(e+1),this._reverse_heap=Array(e)}SwapWithParent(e){let t=this._heap[e>>1];this.PutAtI(e>>1,this._heap[e]),this.PutAtI(e,t)}Enqueue(e,t){this.heapSize++;let r=this.heapSize;for(this._priors[e]=t,this.PutAtI(r,e);r>1&&this._priors[this._heap[r>>1]]>t;)this.SwapWithParent(r),r>>=1}PutAtI(e,t){this._heap[e]=t,this._reverse_heap[t]=e}Dequeue(){if(0===this.heapSize)throw Error();let e=this._heap[1];if(this.heapSize>1){this.PutAtI(1,this._heap[this.heapSize]);let e=1;for(;;){let t=e,r=e<<1;r<=this.heapSize&&this._priors[this._heap[r]]<this._priors[this._heap[e]]&&(t=r);let i=r+1;if(i<=this.heapSize&&this._priors[this._heap[i]]<this._priors[this._heap[t]]&&(t=i),t!==e)this.SwapWithParent(t);else break;e=t}}return this.heapSize--,e}IsEmpty(){return 0===this.heapSize}DecreasePriority(e,t){this._priors[e]=t;let r=this._reverse_heap[e];for(;r>1&&this._priors[this._heap[r]]<this._priors[this._heap[r>>1]];){this.SwapWithParent(r);r>>=1}}}class ny{constructor(e,t,r,i){this._numberOfOverlaps=0,this._proximityEdges=e,this._nodeSizes=t,this._nodePositions=r,this._forLayers=i,this._q=new nb(2*t.length)}Run(){return this.InitQueue(),this.FindOverlaps(),this._numberOfOverlaps}FindOverlaps(){for(;this._q.Count>0;){let e=this._q.Dequeue();e<this._nodePositions.length?(this.FindOverlapsWithInterval(e),this.AddIntervalToTree(e)):(e-=this._nodePositions.length,this.RemoveIntervalFromTree(e))}}RemoveIntervalFromTree(e){this._intervalTree.Remove(this.GetInterval(e),e)}AddIntervalToTree(e){let t=this.GetInterval(e);null==this._intervalTree&&(this._intervalTree=e9([])),this._intervalTree.Add(t,e)}FindOverlapsWithInterval(e){if(null==this._intervalTree)return;let t=this.GetInterval(e);for(let r of this._intervalTree.GetAllIntersecting(t)){let t=nw.GetIdealEdge(e,r,this._nodePositions[e],this._nodePositions[r],this._nodeSizes);if(t.overlapFactor<=1)return;this._proximityEdges.push(t),this._numberOfOverlaps++}}GetInterval(e){let t=this._nodeSizes[e].width/2,r=this._nodePositions[e].x;return new nv(r-t,r+t)}InitQueue(){for(let e=0;e<this._nodeSizes.length;e++){let t=this._nodeSizes[e].height/2,r=this._nodePositions[e].y;this._q.Enqueue(e,r-t),this._q.Enqueue(this._nodeSizes.length+e,r+t)}}}class nx{constructor(e,t,r){this.treeNodes=new Set,this.hedgehog=new Map,this.graph=e,this.weight=t,this.root=r,this.q=new nb(this.graph.nodeCount)}NodeIsInTree(e){return this.treeNodes.has(e)}GetTreeEdges(){let e=[];for(this.Init();e.length<this.graph.nodeCount-1&&this.q.Count>0;)this.AddEdgeToTree(e);return e}AddEdgeToTree(e){let t=this.q.Dequeue(),r=this.hedgehog.get(t);this.treeNodes.add(t),e.push(r),this.UpdateOutEdgesOfV(t),this.UpdateInEdgesOfV(t)}UpdateOutEdgesOfV(e){for(let t of this.graph.outEdges[e]){let e=t.target;if(this.NodeIsInTree(e))continue;let r=this.hedgehog.get(e);if(r){let i=this.weight(r),n=this.weight(t);n<i&&(this.q.DecreasePriority(e,n),this.hedgehog.set(e,t))}else this.q.Enqueue(e,this.weight(t)),this.hedgehog.set(e,t)}}UpdateInEdgesOfV(e){for(let t of this.graph.inEdges[e]){let e=t.source;if(this.NodeIsInTree(e))continue;let r=this.hedgehog.get(e);if(r){let i=this.weight(r),n=this.weight(t);n<i&&(this.q.DecreasePriority(e,n),this.hedgehog.set(e,t))}else this.q.Enqueue(e,this.weight(t)),this.hedgehog.set(e,t)}}Init(){for(let e of(this.treeNodes.add(this.root),this.graph.outEdges[this.root])){let t=this.weight(e);this.q.Enqueue(e.target,t),this.hedgehog.set(e.target,e)}for(let e of this.graph.inEdges[this.root]){let t=this.weight(e);this.q.Enqueue(e.source,t),this.hedgehog.set(e.source,e)}}}class n_{static GetMst(e,t){if(0===e.length)return null;let r=e.map(e=>new ri(e.source,e.target)),i=new rR;for(let t=0;t<e.length;t++)i.setPair(r[t],e[t]);return new nx(rt(r,t),e=>i.get(e.source,e.target).weight,r[0].source).GetTreeEdges().map(e=>i.get(e.source,e.target))}static GetMstOnCdt(e,t){let r=Array.from(e.PointsToSites.values()),i=new Map;for(let e=0;e<r.length;e++)i.set(r[e],e);let n=n_.GetEdges(r,i);return new nx(re(Array.from(n.keys())),e=>t(n.get(e.source,e.target)),0).GetTreeEdges().map(e=>n.get(e.source,e.target))}static GetEdges(e,t){let r=new rR;for(let i=0;i<e.length;i++){let n=e[i],s=t.get(n);for(let e of n.Edges)r.set(s,t.get(e.lowerSite),e)}return r}}class nS{constructor(){this.epsilon=.01,this.iterationsMax=1e3,this.stopOnMaxIterat=!1,this.nodeSeparation=4,this.randomizationSeed=1,this.randomizationShift=.1}get StopOnMaxIterat(){return this.stopOnMaxIterat}set StopOnMaxIterat(e){this.stopOnMaxIterat=e}get Epsilon(){return this.epsilon}set Epsilon(e){this.epsilon=e}get IterationsMax(){return this.iterationsMax}set IterationsMax(e){this.iterationsMax=e}get NodeSeparation(){return this.nodeSeparation}set NodeSeparation(e){this.nodeSeparation=e}get RandomizationSeed(){return this.randomizationSeed}set RandomizationSeed(e){this.randomizationSeed=e}get RandomizationShift(){return this.randomizationShift}set RandomizationShift(e){this.randomizationShift=e}Clone(){let e=new nS;return e.Epsilon=this.Epsilon,e.IterationsMax=this.IterationsMax,e.StopOnMaxIterat=this.StopOnMaxIterat,e.NodeSeparation=this.NodeSeparation,e.RandomizationSeed=this.RandomizationSeed,e.RandomizationShift=this.randomizationShift,e}}class nw{constructor(e,t){this._settings=e,this._nodes=t}static RemoveOverlaps(e,t){let r=new nS;r.RandomizationShift=1,r.NodeSeparation=t,new nw(r,e).RemoveOverlaps()}RemoveOverlaps(){if(this._nodes.length<3){this.RemoveOverlapsOnTinyGraph();return}let e={nodePositions:[],nodeSizes:[]};for(function(e,t,r,i){r.nodePositions=t.map(e=>e.center),i&&function(e,t,r){let i=new eN;for(let n=0;n<e.length;n++){let s=e[n];if(r||i.has(s))do{let e=s.x+(2*t.random()-1)*r;s=new g(e,s.y+(2*t.random()-1)*r)}while(i.has(s));e[n]=s,i.add(s)}}(r.nodePositions,new t3(0,0),i),r.nodeSizes=t.map(t=>{let r=t.boundingBox.size;return r.width+=e.NodeSeparation,r.height+=e.NodeSeparation,r})}(this._settings,this._nodes,e,this._settings.RandomizationShift),this.lastRunNumberIterations=0;this.OneIteration(e.nodePositions,e.nodeSizes,!1);)this.lastRunNumberIterations++;for(;this.OneIteration(e.nodePositions,e.nodeSizes,!0);)this.lastRunNumberIterations++;for(let t=0;t<this._nodes.length;t++)this._nodes[t].center=e.nodePositions[t]}RemoveOverlapsOnTinyGraph(){if(1!==this._nodes.length){if(2===this._nodes.length){let e=this._nodes[0],t=this._nodes[1];g.closeDistEps(e.center,t.center)&&(t.center=t.center.add(new g(.001,0)));let r=this.GetIdealDistanceBetweenTwoNodes(e,t),i=g.middle(e.center,t.center),n=e.center.sub(t.center),s=n.length;n=n.mul(r/s*.5),e.center=i.add(n),t.center=i.sub(n)}}}GetIdealDistanceBetweenTwoNodes(e,t){let r=e.center.sub(t.center),i=Math.abs(r.x),n=Math.abs(r.y),s=(e.width+t.width)/2+this._settings.NodeSeparation,o=(e.height+t.height)/2+this._settings.NodeSeparation,a=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY;return i>l.tolerance&&(a=s/i),n>l.tolerance&&(h=o/n),Math.min(a,h)*r.length}static AvgEdgeLength(e){let t=0,r=0;for(let i of e)for(let e of i.outEdges())r+=i.center.sub(e.target.center).length,t++;return t>0?r/t:1}OneIteration(e,t,r){let i=[];for(let t=0;t<e.length;t++)i.push([e[t],t]);let n=ng.constructor_(i);n.run();let s=new Map;for(let t=0;t<e.length;t++)s.set(n.PointsToSites.get(e[t]),t);let o=0,a=[];for(let e of n.PointsToSites.values())for(let r of e.Edges){let e=r.upperSite.point,i=r.lowerSite.point,n=s.get(r.upperSite),l=s.get(r.lowerSite),h=nw.GetIdealEdge(n,l,e,i,t);a.push(h),h.overlapFactor>1&&o++}if(0===o||r){let i=this.FindProximityEdgesWithSweepLine(a,t,e);if(0===o&&0===i||0===o&&!r)return!1}let l=n_.GetMst(a,e.length);return nw.MoveNodePositions(l,e,l[0].source),!0}FindProximityEdgesWithSweepLine(e,t,r){return new ny(e,t,r,this._overlapForLayers).Run()}static GetIdealEdge(e,t,r,i,n){let s={overlapFactor:0},o=nw.GetIdealEdgeLength(e,t,r,i,n,s),a=r.sub(i).length,l=M.mkSizeCenter(n[e],r),h=M.mkSizeCenter(n[t],i),u=s.overlapFactor>1?a-o:nw.GetDistanceRects(l,h);return{source:Math.min(e,t),target:Math.max(e,t),overlapFactor:s.overlapFactor,idealDistance:o,weight:u}}static GetIdealEdgeLength(e,t,r,i,n,s){let o;let a=r.sub(i),l=a.length,h=Math.abs(a.x),u=Math.abs(a.y),c=(n[e].width+n[t].width)/2,d=(n[e].height+n[t].height)/2;if(h>=c||u>=d)return s.overlapFactor=1,a.length;if(h>1e-10)o=u>1e-10?Math.min(c/h,d/u):c/h;else{if(!(u>1e-10))return s.overlapFactor=2,Math.sqrt(c*c+d*d)/4;o=d/u}return o=Math.max(o,1.001),s.overlapFactor=o,o*l}static GetDistanceRects(e,t){if(e.intersects(t))return 0;let r=0,i=0;return e.right<t.left?i=e.left-t.right:t.right<e.left&&(i=e.left-t.right),e.top<t.bottom?r=t.bottom-e.top:t.top<e.bottom&&(r=e.bottom-t.top),Math.sqrt(i*i+r*r)}static MoveNodePositions(e,t,r){let i=t.map(e=>e.clone()),n=new Set;n.add(r);for(let r=0;r<e.length;r++){let s=e[r];n.has(s.source)?nw.MoveNode(s.source,s.target,i,t,n,s.idealDistance):nw.MoveNode(s.target,s.source,i,t,n,s.idealDistance)}}static MoveNode(e,t,r,i,n,s){let o=r[t].sub(r[e]);o=o.mul(s/o.length+.01),i[t]=i[e].add(o),n.add(t)}GetLastRunIterations(){return this.lastRunNumberIterations}}class nT extends e0{constructor(e,t,r,i){super(r),this.settings=e,this.graph=t,this.length=i}run(){this.LayoutConnectedGraphWithMds(),this.graph.pumpTheBoxToTheGraphWithMargins()}static ScaleToAverageEdgeLength(e,t,r,i){let n=new Map,s=0;for(let t of e.shallowNodes)n.set(t,s),s++;let o=0,a=0;for(let s of e.shallowEdges){let e=n.get(s.source),l=n.get(s.target);a+=Math.sqrt(Math.pow(t[e]-t[l],2)+Math.pow(r[e]-r[l],2)),o+=i(s)}if(o>0&&(a/=o),a>0)for(let e=0;e<t.length;e++)t[e]/=a,r[e]/=a}static LayoutGraphWithMds(e,t,r,i){if(r.x=Array(e.shallowNodeCount),r.y=Array(e.shallowNodeCount),0===r.x.length)return;if(1===r.x.length){r.x[0]=r.y[0]=0;return}let n=Math.min(t.PivotNumber,e.shallowNodeCount),s=t.GetNumberOfIterationsWithMajorization(e.shallowNodeCount),o=t.Exponent,a=Array(n),l=new nt(e,a,i);l.run();let h=l.Result;if(ni.LandmarkClassicalScaling(h,r,a),nT.ScaleToAverageEdgeLength(e,r.x,r.y,i),s>0){let t=new ne(e,i);t.run();let n=t.Result,a=ni.ExponentialWeightMatrix(n,o);ni.DistanceScalingSubset(n,r.x,r.y,a,s)}}LayoutConnectedGraphWithMds(){let e={x:[],y:[]};nT.LayoutGraphWithMds(this.graph,this.settings,e,this.length),0!==this.settings.RotationAngle&&nr.Rotate(e.x,e.y,this.settings.RotationAngle);let t=0;for(let r of this.graph.shallowNodes)r.boundingBox&&(r.center=new g(e.x[t]*this.settings.ScaleX,e.y[t]*this.settings.ScaleY)),t++;this.settings.removeOverlaps&&nw.RemoveOverlaps(Array.from(this.graph.shallowNodes),this.settings.NodeSeparation),this.graph.pumpTheBoxToTheGraphWithMargins()}ScaleNodes(e,t){for(let r of e)r.center=r.center.mul(t)}static PackGraphs(e,t){if(0===e.length)return M.mkEmpty();if(1===e.length)return e[0].boundingBox;let r=e.map(e=>e.boundingBox),i=[];for(let t of e)i.push({g:t,lb:t.boundingBox.leftBottom.clone()});let n=new e4(r,t.PackingAspectRatio);for(let{g:e,lb:t}of(n.run(),i)){let r=e.boundingBox.leftBottom.sub(t);e.translate(r)}return new M({left:0,bottom:0,right:n.PackedWidth,top:n.PackedHeight})}}class nP{constructor(){this.commonSettings=new i9,this.pivotNumber=50,this.iterationsWithMajorization=30,this.scaleX=100,this.scaleY=100,this.exponent=-2,this.rotationAngle=0,this._removeOverlaps=!0,this._callIterationsWithMajorizationThreshold=2e3,this.adjustScale=!1}static fromJSON(e){let t=new nP;return e.pivotNumber&&(t.pivotNumber=e.pivotNumber),e.iterationsWithMajorization&&(t.iterationsWithMajorization=e.iterationsWithMajorization),e.scaleX&&(t.scaleX=e.scaleX),e.scaleY&&(t.scaleY=e.scaleY),e.exponent&&(t.exponent=e.exponent),e.rotationAngle&&(t.rotationAngle=e.rotationAngle),void 0!=e.removeOverlaps&&(t._removeOverlaps=e.removeOverlaps),e._callIterationsWithMajorizationThreshold&&(t._callIterationsWithMajorizationThreshold=e._callIterationsWithMajorizationThreshold),t}toJSON(){let e={};return 50!=this.pivotNumber&&(e.pivotNumber=this.pivotNumber),30!=this.iterationsWithMajorization&&(e.iterationsWithMajorization=this.iterationsWithMajorization),200!=this.scaleX&&(e.scaleX=this.scaleX),200!=this.scaleY&&(e.scaleY=this.scaleY),-2!=this.exponent&&(e.exponent=this.exponent),0!=this.rotationAngle&&(e.rotationAngle=this.rotationAngle),!this._removeOverlaps&&(e.removeOverlaps=this._removeOverlaps),3e3!=this._callIterationsWithMajorizationThreshold&&(e._callIterationsWithMajorizationThreshold=this._callIterationsWithMajorizationThreshold),e}get NodeSeparation(){return this.commonSettings.NodeSeparation}set NodeSeparation(e){this.commonSettings.NodeSeparation=e}get edgeRoutingSettings(){return this.commonSettings.edgeRoutingSettings}set edgeRoutingSettings(e){this.commonSettings.edgeRoutingSettings=e}get removeOverlaps(){return this._removeOverlaps}set removeOverlaps(e){this._removeOverlaps=e}get PivotNumber(){return this.pivotNumber}set PivotNumber(e){this.pivotNumber=e}get IterationsWithMajorization(){return this.iterationsWithMajorization}set IterationsWithMajorization(e){this.iterationsWithMajorization=e}get ScaleX(){return this.scaleX}set ScaleX(e){this.scaleX=e}get ScaleY(){return this.scaleY}set ScaleY(e){this.scaleY=e}get Exponent(){return this.exponent}set Exponent(e){this.exponent=e}get RotationAngle(){return this.rotationAngle}set RotationAngle(e){this.rotationAngle=e%360}get AdjustScale(){return this.adjustScale}set AdjustScale(e){this.adjustScale=e}GetNumberOfIterationsWithMajorization(e){return e>this.CallIterationsWithMajorizationThreshold?0:this.IterationsWithMajorization}get CallIterationsWithMajorizationThreshold(){return this._callIterationsWithMajorizationThreshold}set CallIterationsWithMajorizationThreshold(e){this._callIterationsWithMajorizationThreshold=e}}class nE extends e0{get scaleX(){return this.settings.ScaleX}set scaleX(e){this.settings.ScaleX=e}get scaleY(){return this.settings.ScaleY}set scaleY(e){this.settings.ScaleY=e}constructor(e,t,r,i){super(t),this.graph=e,this.length=r,this.settings=i,this.settings.ScaleX=this.settings.ScaleY=200}run(){new nT(this.settings,this.graph,this.cancelToken,this.length).run()}}function nC(e,t,r){if(t)for(let e of t){if(r&&r.canceled)return;nA.RouteEdge(e)}else for(let t of e.nodesBreadthFirst){if(r&&r.canceled)return;for(let e of t.outEdges())null==e.curve&&nA.RouteEdge(e);for(let e of t.selfEdges())null==e.curve&&nA.RouteEdge(e)}}class nA extends e0{constructor(e,t){super(null),this.edges=e,this.padding=t}run(){for(let e of(sL.CreatePortsIfNeeded(this.edges),this.edges))nA.RouteEdge(e)}static RouteEdge(e){null==e.sourcePort&&(e.sourcePort=tl.mk(()=>e.source.boundaryCurve,()=>e.source.center)),null==e.targetPort&&(e.targetPort=tl.mk(()=>e.target.boundaryCurve,()=>e.target.center)),!nA.ContainmentLoop(e)&&(e.curve=nA.GetEdgeLine(e)),rP.trimSplineAndCalculateArrowheadsII(e,e.sourcePort.Curve,e.targetPort.Curve,e.curve,!1)}static ContainmentLoop(e){let t=e.sourcePort.Curve,r=e.targetPort.Curve;if(null==t||null==r)return!1;let i=t.boundingBox,n=r.boundingBox,s=i.containsRect(n),o=!s&&n.containsRect(i);return(!!s||!!o)&&(e.curve=nA.CreateLoop(i,n,o),!0)}static CreateLoop(e,t,r){return r?nA.CreateLoop_(e,t,!1):nA.CreateLoop_(t,e,!0)}static CreateLoop_(e,t,r){let i=e.center,n=nA.FindClosestPointOnBoxBoundary(e.center,t),s=n.sub(i),o=(Math.abs(s.x)<l.distanceEpsilon?Math.min(i.y-t.bottom,t.top-i.y):Math.min(i.x-t.left,t.right-i.x))/2,a=Math.min(1,o);s.length<=l.distanceEpsilon&&(s=new g(1,0));let h=s.normalize(),u=h.rotate(Math.PI/2),c=n.add(h.mul(1)),d=c.add(u.mul(a)),f=n.add(u.mul(a)),p=i.add(u.mul(a));return(r?O.mkFromPoints([p,f,d,c,n,i]):O.mkFromPoints([i,n,c,d,f,p])).createCurve()}static FindClosestPointOnBoxBoundary(e,t){let r=e.x-t.left<t.right-e.x?t.left:t.right,i=e.y-t.bottom<t.top-e.y?t.bottom:t.top;return Math.abs(r-e.x)<Math.abs(i-e.y)?new g(r,e.y):new g(e.x,i)}static GetEdgeLine(e){let t,r,i,n;null==e.sourcePort?(t=e.source.center,r=e.source.boundaryCurve):(t=e.sourcePort.Location,r=e.sourcePort.Curve),null==e.targetPort?(i=e.target.center,n=e.target.boundaryCurve):(i=e.targetPort.Location,n=e.targetPort.Curve);let s=b.mkPP(t,i),o=C.getAllIntersections(r,s,!1);if(o.length>0){let e=s.trim(o[0].par1,1);e instanceof b&&(s=e,(o=C.getAllIntersections(n,s,!1)).length>0&&(e=s.trim(0,o[0].par1))instanceof b&&(s=e))}return s}static CreateSimpleEdgeCurveWithUnderlyingPolyline(e){let t=e.sourcePort?e.sourcePort.Location:e.source.center,r=e.targetPort?e.targetPort.Location:e.target.center;if(e.source===e.target){let r=2/(3*e.source.boundaryCurve.boundingBox.width),i=e.source.boundingBox.height/4;e.smoothedPolyline=nA.CreateUnderlyingPolylineForSelfEdge(t,r,i),e.curve=e.smoothedPolyline.createCurve()}else e.smoothedPolyline=O.mkFromPoints([t,r]),e.curve=e.smoothedPolyline.createCurve();rP.trimSplineAndCalculateArrowheadsII(e,e.source.boundaryCurve,e.target.boundaryCurve,e.curve,!1)}static CreateUnderlyingPolylineForSelfEdge(e,t,r){let i=e.add(new g(0,r)),n=e.add(new g(t,r)),s=e.add(new g(t,-1*r)),o=e.add(new g(0,-1*r)),a=R.mkSiteP(e),l=new O(a);return a=R.mkSiteSP(a,i),a=R.mkSiteSP(a,n),a=R.mkSiteSP(a,s),a=R.mkSiteSP(a,o),R.mkSiteSP(a,e),l}static SetStraightLineEdgesWithUnderlyingPolylines(e){for(let t of(sL.CreatePortsIfNeeded(Array.from(e.deepEdges)),e.deepEdges))nA.CreateSimpleEdgeCurveWithUnderlyingPolyline(t)}}(Z=ex||(ex={}))[Z.OverlapsOtherLabels=0]="OverlapsOtherLabels",Z[Z.OverlapsNodes=1]="OverlapsNodes",Z[Z.OverlapsEdges=2]="OverlapsEdges",Z[Z.OverlapsNothing=Number.MAX_VALUE]="OverlapsNothing",(K=e_||(e_={}))[K.Any=0]="Any",K[K.Port=1]="Port",K[K.Starboard=2]="Starboard",K[K.Top=3]="Top",K[K.Bottom=4]="Bottom",K[K.Left=5]="Left",K[K.Right=6]="Right";class nI{}class nM{constructor(){this.points=[],this.coveredLength=0}AddFirst(e){if(0!==this.points.length){let t=this.points[0];this.coveredLength=this.coveredLength+e.Center.sub(t.Center).length}return this.points.unshift(e),this.coveredLength}AddLast(e){if(0!==this.points.length){let t=this.points[this.points.length-1];this.coveredLength=this.coveredLength+e.Center.sub(t.Center).length}return this.points.push(e),this.coveredLength}}(J=eS||(eS={}))[J.AlongCurve=0]="AlongCurve",J[J.Horizontal=1]="Horizontal";class nR{constructor(e){this.location=e,this.boundingBox=M.rectangleOnPoint(e)}}class nO{constructor(e,t){this.data=t,this.boundingBox=e}}class nk{constructor(e){this.innerPoints=[],this.outerPoints=[],this.placementSide=e_.Any,this.placementOffset=.5,this.edgePoints=e,this.placementSide}}class nN extends e0{get CollisionGranularity(){return this.granularity}set CollisionGranularity(e){this.granularity=e}static constructorG(e){return new nN(Array.from(e.nodesBreadthFirst),Array.from(e.deepEdges).filter(e=>e.label))}static constructorGA(e,t){return new nN(Array.from(e.nodesBreadthFirst),t.filter(e=>e.label))}constructor(e,t){super(null),this.placementStrategy=[eS.Horizontal,eS.AlongCurve],this.obstacleMaps=[],this.edgeInfos=new Map,this.granularity=nN.MinGranularity,this.ScaleCollisionGranularity=!0,this.granularity=this.ScaleCollisionGranularity?this.interpolateGranularity(t.length):nN.MinGranularity,this.InitializeObstacles(e,t),this.edges=t}interpolateGranularity(e){if(e<=nN.LowerEdgeBound)return nN.MaxGranularity;if(e>=nN.UpperEdgeBound)return nN.MinGranularity;let t=(nN.UpperEdgeBound-nN.LowerEdgeBound)/(e-nN.LowerEdgeBound);return Math.ceil(nN.MinGranularity+t)}InitializeObstacles(e,t){let r=this.GetEdgeObstacles(t);this.obstacleMaps[1]=e9(e.map(e=>[e.boundingBox,new nO(e.boundingBox,e)])),this.obstacleMaps[2]=e9(r.map(e=>[e.boundingBox,new nO(e.boundingBox,e)]))}static CurvePoints(e,t){let r=[],i=e.end.sub(e.start).lengthSquared/(t*t);return nN.SubdivideCurveSegment(r,e,i,e.parStart,e.parEnd),r.sort(nN.compareByArgument),r}static compareByArgument(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}static SubdivideCurveSegment(e,t,r,i,n){if(e.length>64)return;let s=t.value(i),o=t.value(n);if(s.sub(o).lengthSquared>r){let s=(i+n)/2;nN.SubdivideCurveSegment(e,t,r,i,s),nN.SubdivideCurveSegment(e,t,r,s,n)}else e.push([i,s])}static PlaceLabelsAtDefaultPositions(e,t){for(let e of t)e.label&&new nN([e.source,e.target],[e]).run()}GetEdgeObstacles(e){let t=[];for(let r of e){if(null==r.curve)continue;let e=nN.CurvePoints(r.curve,this.CollisionGranularity);for(let i of(this.edgeInfos.set(r,new nk(e)),e))t.push(new nR(i[1]))}return t}AddLabelObstacle(e){null==this.labelObstacleMap?(this.labelObstacleMap=e9([[e.boundingBox,e]]),this.obstacleMaps[0]=this.labelObstacleMap):this.labelObstacleMap.Add(e.boundingBox,e)}run(){for(let e of(this.edges.sort((e,t)=>this.edgeInfos.get(e).edgePoints.length-this.edgeInfos.get(t).edgePoints.length),this.edges))this.PlaceLabel(e)}PlaceLabel(e){let t=!1;for(let r of this.placementStrategy){switch(r){case eS.AlongCurve:t=this.PlaceEdgeLabelOnCurve(e.label);break;case eS.Horizontal:t=this.PlaceEdgeLabelHorizontally(e);break;default:throw Error("unexpected case")}if(t)break}t?this.CalculateCenterLabelInfoCenter(e.label):this.PlaceLabelAtFirstPosition(e.label)}getLabelInfo(e){let t=e.parent;return this.edgeInfos.get(t)}PlaceLabelAtFirstPosition(e){let t=e.parent,r=t.curve,i=this.edgeInfos.get(t).edgePoints,n=this.StartIndex(e,i.map(e=>e[1])),s=i[n][1],o=r.derivative(i[n][0]);o.length<l.distanceEpsilon&&(o=new g(1,1)),o=o.normalize();let a=new I(e.width,e.height),h=this.getLabelInfo(e),u=nN.GetPossibleSides(h.placementSide,o)[0],c=nN.GetLabelBounds(s,o,a,u);this.SetLabelBounds(this.getLabelInfo(e),c)}StartIndex(e,t){let r=this.getLabelInfo(e);return Math.min(t.length-1,Math.max(0,Math.floor(t.length*r.placementOffset)))}CalculateCenterLabelInfoCenter(e){let t=this.getLabelInfo(e),r=new g(0,0);for(let e of t.innerPoints)r=r.add(e);for(let e of t.outerPoints)r=r.add(e);e.positionCenter(r.div(t.innerPoints.length+t.outerPoints.length))}PlaceEdgeLabelHorizontally(e){let t=e.label,r=this.getLabelInfo(t).edgePoints,i=new I(t.width,t.height),n=-1,s=M.mkEmpty(),o=e.curve;for(let e of nN.ExpandingSearch(this.StartIndex(t,r.map(e=>e[1])),0,r.length)){let a=r[e],l=o.derivative(a[0]);if(!c(l.lengthSquared,0)){for(let e of(l=l.normalize(),nN.GetPossibleSides(this.getLabelInfo(t).placementSide,l))){let r=nN.GetLabelBounds(a[1],l,i,e),o=this.ConflictIndexRL(r,t);if(o>n&&(n=o,s=r,n===Number.MAX_VALUE))break}if(n===Number.MAX_VALUE)break}}if(n>=0){this.SetLabelBounds(this.getLabelInfo(t),s);let e=new nO(s,null);this.AddLabelObstacle(e);let r=this.getLabelInfo(t);return 0===n?r.placementResult=ex.OverlapsOtherLabels:1===n?r.placementResult=ex.OverlapsNodes:2===n?r.placementResult=ex.OverlapsEdges:r.placementResult=ex.OverlapsNothing,!0}return!1}static GetLabelBounds(e,t,r,i){let n=t.rotate(Math.PI/2).mul(i),s=e.add(n),o=n.x>0?s.x:s.x-r.width,a=n.y>0?s.y:s.y-r.height;if(.75>Math.abs(n.x)){let e=Math.acos(Math.abs(n.y)/1),t=1/Math.sin(e),i=1/Math.cos(e);o+=(n.x>0?-1:1)*Math.min(t,r.width/2),a+=(n.y>0?1:-1)*i}else if(.75>Math.abs(n.y)){let e=Math.acos(Math.abs(n.x)/1),t=1/Math.sin(e),i=1/Math.cos(e);o+=(n.x>0?1:-1)*i,a+=(n.y>0?-1:1)*Math.min(t,r.height/2)}return M.mkLeftBottomSize(o,a,r)}SetLabelBounds(e,t){e.innerPoints=[t.leftTop,t.rightTop],e.outerPoints=[t.leftBottom,t.rightBottom]}static GetPossibleSides(e,t){switch(0===t.length&&(e=e_.Any),e){case e_.Port:return[-1];case e_.Starboard:return[1];case e_.Top:if(c(t.x,0))return nN.GetPossibleSides(e_.Left,t);return[1];case e_.Bottom:if(c(t.x,0))return nN.GetPossibleSides(e_.Right,t);return[t.x<0?-1:1];case e_.Left:if(c(t.y,0))return nN.GetPossibleSides(e_.Top,t);return[t.y<0?-1:1];case e_.Right:if(c(t.y,0))return nN.GetPossibleSides(e_.Bottom,t);return[t.y<0?1:-1];default:return[-1,1]}}static*ExpandingSearch(e,t,r){let i=e+1,n=i;for(;n>t;)yield--n;for(;i<r;)yield i++}static PointSetLength(e){let t=0,r=null;for(let i of e)null!=r&&(t+=r.sub(i.Center).length),r=i.Center;return t}PlaceEdgeLabelOnCurve(e){let t=e.parent,r=this.getLabelInfo(e);r.innerPoints=null;let i=r.edgePoints,n=e.height/2,s=new I(n,n),o=e.width;for(let r of nN.ExpandingSearch(this.StartIndex(e,i),0,i.length))for(let a of this.GetSidesAndEdgeCurve(e,t,i,r)){let l=new nM,h={coveredLength:0};if(this.ProcessExpandingSearchOnSide(r,i,t.curve,a,n,3,s,h,l,o),h.coveredLength>=o)return this.CaseOfCoveredLengthGreaterThanLabelLength(e,l,h.coveredLength,o,s),!0}return!1}CaseOfCoveredLengthGreaterThanLabelLength(e,t,r,i,n){let s=[],o=[],a=Array.from(t.points),l=r-i;if(l>0){let e=a[a.length-1],t=a[a.length-2],r=e.Center.sub(t.Center),i=r.length;l>i&&(e=a[0],t=a[1],i=(r=e.Center.sub(t.Center)).length);let n=r.mul((i-l)/i);e.Center=t.Center.add(n),e.Inner=t.Inner.add(n),e.Outer=t.Outer.add(n)}this.GoOverOrderedPointsAndAddLabelObstacels(a,s,o,n);let h=this.getLabelInfo(e);h.innerPoints=s,h.outerPoints=o}GoOverOrderedPointsAndAddLabelObstacels(e,t,r,i){for(let n of e){let e=n.Center;t.push(n.Inner),r.push(n.Outer);let s=new nO(M.mkSizeCenter(new I(2*i.width,2*i.height),e),null);this.AddLabelObstacle(s)}}ProcessExpandingSearchOnSide(e,t,r,i,n,s,o,a,l,h){for(let u of nN.ExpandingSearch(e,0,t.length)){let[d,f]=t[u],p=r.derivative(d);if(c(p.lengthSquared,0))continue;let g=p.rotate(Math.PI/2).normalize().mul(i),m=f.add(g.mul(n+s));if(this.Conflict(m,n,o))break;{let t=new nI;if(t.Center=m,t.Inner=f.add(g.mul(s)),t.Outer=f.add(g.mul(2*n+s)),a.coveredLength=u<=e?l.AddFirst(t):l.AddLast(t),a.coveredLength>=h)break}}}GetSidesAndEdgeCurve(e,t,r,i){let n=t.curve.derivative(r[i][0]);return nN.GetPossibleSides(this.getLabelInfo(e).placementSide,n)}Conflict(e,t,r){return this.ConflictIndex(e,t,r)!==Number.MAX_VALUE}ConflictIndexRL(e,t){let r=t.parent,i=r.source,n=r.target;for(let t=0;t<this.obstacleMaps.length;t++){if(null!=this.obstacleMaps[t])for(let r of this.obstacleMaps[t].GetAllIntersecting(e)){if(!(t===ex.OverlapsNodes&&r instanceof nO&&r.data instanceof ti&&(i.node.isDescendantOf(r.data.graph)||n.node.isDescendantOf(r.data))))return t}}return Number.MAX_VALUE}ConflictIndex(e,t,r){let i=M.creatRectangleWithSize(new I(2*r.width,2*r.height),e),n=t*t;for(let t=0;t<this.obstacleMaps.length;t++){if(null!=this.obstacleMaps[t]){for(let t=0;t<this.obstacleMaps.length;t++)if(null!=this.obstacleMaps[t])for(let r of this.obstacleMaps[t].GetAllIntersecting(i)){if(!(r instanceof nR))return t;if(e.sub(r.location).lengthSquared<n)return t}return Number.MAX_VALUE}}}}nN.MinGranularity=5,nN.MaxGranularity=50,nN.LowerEdgeBound=500,nN.UpperEdgeBound=3e3;class nL extends n{clone(){throw Error("Method not implemented.")}rebind(e){this.entity=e,this.bind(s.AlgorithmDataIndex)}constructor(e,t=null){super(e,s.AlgorithmDataIndex),this.data=t}static getAlgData(e){return e.getAttr(s.AlgorithmDataIndex)}}function nD(e){let t=nL.getAlgData(e.node);return null==t?null:t.data}class nB{get Center(){return this.center}set Center(e){this.geomNode.center=e,this.center=e}ResetBounds(){this.previousCenter=this.geomNode.center,this.center=this.geomNode.center,this.Width=this.geomNode.width,this.Height=this.geomNode.height}constructor(e,t){this.force=new g(0,0),this.stayWeight=1,this.index=e,this.geomNode=t,this.ResetBounds()}ToString(){return"FINode("+(this.index+"):")+this.geomNode}}class nF{constructor(e){this._length=1,this.mEdge=e,this.sourceFiNode=nD(this.mEdge.source),this.targetFiNode=nD(this.mEdge.target)}get source(){return this.sourceFiNode.index}get target(){return this.targetFiNode.index}get length(){return this._length}set length(e){this._length=e}vector(){return this.sourceFiNode.geomNode.center.sub(this.targetFiNode.geomNode.center)}}class nV{get Center(){return this.c}set Center(e){this.c=e}get Radius(){return this.r}set Radius(e){this.r=e,this.r2=e*e}Distance2(e){let t=this.c.y-e.y,r=this.c.x-e.x;return r*r+t*t}Contains(e){return this.Distance2(e)-1e-7<=this.r2}ContainsPN(e,t){for(let r=0;r<e.length;r++)if(-1==t.findIndex(e=>e==r)&&!this.Contains(e[r]))return!1;return!0}static constructorP(e){let t=new nV;return t.c=e,t.r=0,t.r2=0,t}static midPoint(e,t){return new g((t.x+e.x)/2,(t.y+e.y)/2)}static constructorPP(e,t){let r=new nV;return r.c=nV.midPoint(e,t),r.r2=r.Distance2(e),r.r=Math.sqrt(r.r2),eX.assert(r.OnBoundary(e)),eX.assert(r.OnBoundary(t)),r}OnBoundary(e){let t=this.Distance2(e);return Math.abs(t-this.r2)/(t+this.r2)<1e-5}static centre(e,t,r){let i;eX.assert(t.x!=e.x),eX.assert(r.x!=t.x);let n=(t.y-e.y)/(t.x-e.x),s=(r.y-t.y)/(r.x-t.x);eX.assert(s!=n);let o=(n*s*(e.y-r.y)+s*(e.x+t.x)-n*(t.x+r.x))/(2*(s-n));return i=Math.abs(n)>Math.abs(s)?(e.y+t.y)/2-(o-(e.x+t.x)/2)/n:(t.y+r.y)/2-(o-(t.x+r.x)/2)/s,new g(o,i)}static Collinear(e,t,r){return e.x*(t.y-r.y)+(t.x*(r.y-e.y)+r.x*(e.y-t.y))==0}static constructorPPP(e,t,r){nV.count++;let i=new nV;if(nV.Collinear(e,t,r)){let n=new g(Math.min(e.x,Math.min(t.x,r.x)),Math.min(e.y,Math.max(t.y,r.y))),s=new g(Math.max(e.x,Math.max(t.x,r.x)),Math.max(e.y,Math.max(t.y,r.y)));i.c=nV.midPoint(n,s),i.r2=i.Distance2(s),i.r=Math.sqrt(i.r2)}else{let n=t.x-e.x,s=r.x-t.x,o=r.x-e.x;0!=n?0!=s?i.c=nV.centre(e,t,r):(eX.assert(0!=o),i.c=nV.centre(t,e,r)):(eX.assert(0!=s),i.c=nV.centre(t,r,e)),i.r2=i.Distance2(e),i.r=Math.sqrt(i.r2),eX.assert(i.OnBoundary(e)),eX.assert(i.OnBoundary(t)),eX.assert(i.OnBoundary(r))}return i}}nV.count=0;function nG(e,t){let r=e.x,i=e.y,n=t.x,s=t.y,o=.5*(r+n),a=.5*(i+s);return{x:o,y:a,r:Math.sqrt((r-o)*(r-o)+(i-a)*(i-a))}}class nU{static LinearComputation(e){let t=function(e){let t=e.slice();return function(e){let t,r,i;for(i=e.length-1;i>0;i--)t=t5(i+1),r=e[i],e[i]=e[t],e[t]=r;}(t),function e(t,r,i,n){let s=null;return 3===n?s=function(e,t,r){let i=e.x,n=e.y,s=t.x,o=t.y,a=r.x,l=r.y,h=s-i,u=o-n,c=a-i,d=l-n,f=h*(s+i)*.5+u*(o+n)*.5,p=c*(a+i)*.5+d*(l+n)*.5,g=h*d-u*c,m=(d*f-u*p)/g,v=(-c*f+h*p)/g;return{x:m,y:v,r:Math.sqrt((i-m)*(i-m)+(n-v)*(n-v))}}(i[0],i[1],i[2]):1===r&&0===n?s={x:t[0].x,y:t[0].y,r:0}:0===r&&2===n?s=nG(i[0],i[1]):1===r&&1===n?s=nG(i[0],t[0]):(s=e(t,r-1,i,n),!function(e,t){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)<=t.r*t.r}(t[r-1],s)&&(i[n++]=t[r-1],s=e(t,r-1,i,n))),s}(t,e.length,[],0)}(e),r=new nV;return r.Center=new g(t.x,t.y),r.Radius=t.r,r}static SlowComputation(e){let t=e.length,r=null,i=null;for(let n=0;n<t;n++)for(let s=0;s<t;s++){if(n!=s){let t=nV.constructorPP(e[n],e[s]);t.ContainsPN(e,[n,s])&&(null==r||r.Radius>t.Radius)&&(r=t,i=[n,s])}for(let o=0;o<t;o++)if(o!=n&&o!=s&&!nV.Collinear(e[n],e[s],e[o])){let t=nV.constructorPPP(e[n],e[s],e[o]);t.ContainsPN(e,[n,s,o])&&(null==r||r.Radius>t.Radius)&&(r=t,i=[n,s,o])}}return eX.assert(null!=i),r}}class nz{static constructorNPA(e,t,r){let i=new nz;i.p=e,i.z0=new nj(t.x,t.y),i.a=Array(e);for(let t=0;t<e;t++)i.a[t]=i.compute(t,r);return i}static constructorPMM(e,t,r){let i=new nz;eX.assert(t.p==r.p),i.p=t.p,i.z0=new nj(e.x,e.y);let n=r.shift(i.z0),s=t.shift(i.z0);i.a=Array(i.p);for(let e=0;e<i.p;e++)i.a[e]=nH(s[e],n[e]);return i}static factorial(e){let t=1;for(let r=2;r<=e;r++)t*=r;return t}static binomial(e,t){return nz.factorial(e)/(nz.factorial(t)*nz.factorial(e-t))}sum(e,t){let r=nj.constructorN(0);for(let i=1;i<=e;i++){let n=nj.constructorN(nz.binomial(e-1,i-1));r=nH(r,nW(this.a[i],nW(nj.Pow(t,e-i),n)))}return r}shift(e){let t=Array(this.p),r=t[0]=this.a[0],i=nq(this.z0,e);for(let e=1;e<this.p;e++){let n=nj.constructorN(e);t[e]=nH(nW(function(e){return new nj(-e.re,-e.im)}(r),nX(nj.Pow(i,e),n)),this.sum(e,i))}return t}compute(e,t){let r=t.length,i=nj.constructorN(0);if(0==e)i.re=r;else{for(let n=0;n<r;n++){let r=t[n],s=new nj(r.x,r.y);i=nq(i,nj.Pow(nq(s,this.z0),e))}i.divideBy(e)}return i}ApproximateForce(e){let t=nq(new nj(e.x,e.y),this.z0),r=nX(this.a[0],t),i=t,n=0;for(;r=nq(r,nX(function(e,t){return new nj(e.re*t,e.im*t)}(this.a[n],n),i)),++n!=this.p;){;i=nW(i,t)}return new g(r.re,-r.im)}static Force(e,t){let r=t.sub(e),i=r.lengthSquared;if(i<.1)return 0!=i?r.div(.1):new g(1,0);return r.div(i)}}class nj{constructor(e,t){this.re=e,this.im=t}static constructorN(e){return new nj(e,0)}divideBy(e){this.re/=e,this.im/=e}static Pow(e,t){switch(eX.assert(t>=0),t){case 0:return nj.constructorN(1);case 1:return e;case 2:return nW(e,e);case 3:return nW(e,nW(e,e));default:return nW(nj.Pow(e,t/2),nj.Pow(e,t/2+t%2))}}}function nH(e,t){return new nj(e.re+t.re,e.im+t.im)}function nW(e,t){return new nj(e.re*t.re-e.im*t.im,e.re*t.im+t.re*e.im)}function nq(e,t){return new nj(e.re-t.re,e.im-t.im)}function nX(e,t){let r=t.re*t.re+t.im*t.im;if(0==r)return nj.constructorN(0);let i=e.re*t.re+e.im*t.im;return new nj(i/r,(e.im*t.re-e.re*t.im)/r)}(Q=ew||(ew={}))[Q.Horizontal=0]="Horizontal",Q[Q.Vertical=1]="Vertical";class n${intersects(e){return e.med.Center.sub(this.med.Center).length<e.med.Radius+this.med.Radius}}class nY extends n${constructor(e,t,r){super(),this.med=e,this.parent=t.parent,null!=this.parent&&(this.parent.leftChild==t?this.parent.leftChild=this:this.parent.rightChild=this),this.leftChild=t,this.rightChild=r,t.parent=this,r.parent=this}computeMultipoleCoefficients(e){this.leftChild.computeMultipoleCoefficients(e),this.rightChild.computeMultipoleCoefficients(e),this.multipoleCoefficients=nz.constructorPMM(this.med.Center,this.leftChild.multipoleCoefficients,this.rightChild.multipoleCoefficients)}}class nZ extends n${constructor(e){super(),this.particles=e,this.ComputeMinimumEnclosingDisc()}computeMultipoleCoefficients(e){this.multipoleCoefficients=nz.constructorNPA(e,this.med.Center,this.ps)}ComputeMinimumEnclosingDisc(){let e=this.Size();this.ps=Array(e);for(let t=0;t<e;t++)this.ps[t]=this.particles[0][t].point;return this.med=nU.LinearComputation(this.ps)}Min(e){return this.particles[e][0].pos(e)}Size(){return this.particles[0].length}Max(e){return this.particles[e][this.Size()-1].pos(e)}Dimension(e){return this.Max(e)-this.Min(e)}Split(e){let t=this.Dimension(ew.Horizontal)>this.Dimension(ew.Vertical)?ew.Horizontal:ew.Vertical,r=t==ew.Horizontal?ew.Vertical:ew.Horizontal,i=this.Size(),n=i>>1,s=i-n,o=[Array(n),Array(n)],a=[Array(s),Array(s)],l=0,h=0;for(let e=0;e<i;e++){let r=this.particles[t][e];e<n?(o[t][e]=r,r.splitLeft=!0):(a[t][e-n]=r,r.splitLeft=!1)}for(let e=0;e<i;e++){let t=this.particles[r][e];t.splitLeft?o[r][h++]=t:a[r][l++]=t}let u=this.med;return this.particles=o,this.ComputeMinimumEnclosingDisc(),e.rightSibling=new nZ(a),new nY(u,this,e.rightSibling)}ComputeForces(){for(let e of this.particles[0])for(let t of this.particles[0])e!=t&&(e.force=e.force.add(nz.Force(e.point,t.point)))}}class nK{pos(e){return e==ew.Horizontal?this.point.x:this.point.y}constructor(e){this.point=e,this.force=new g(0,0)}}class nJ{particlesBy(e){return this.particles.map(e=>e).sort((t,r)=>t.pos(e)-r.pos(e))}constructor(e,t){this.particles=e;let r=[];r.push(this.particlesBy(ew.Horizontal)),r.push(this.particlesBy(ew.Vertical)),this.leaves=[];let i=new nZ(r);this.leaves.push(i);let n={rightSibling:null};this.root=i.Split(n),this.leaves.push(n.rightSibling);let s=new nQ(t);for(s.EnqueueLL(i,n.rightSibling);s.length>0;)(i=s.dequeue()).Split(n),this.leaves.push(n.rightSibling),s.EnqueueLL(i,n.rightSibling)}ComputeForces(e){for(let t of(this.root.computeMultipoleCoefficients(e),this.leaves)){t.ComputeForces();let e=[];for(e.push(this.root);e.length>0;){let r=e.pop();if(t.intersects(r)){if(r instanceof nZ)for(let e of t.particles[0])for(let t of r.particles[0])e!=t&&(e.force=e.force.add(nz.Force(e.point,t.point)));else e.push(r.leftChild),e.push(r.rightChild)}else for(let e of t.particles[0])e.force=e.force.sub(r.multipoleCoefficients.ApproximateForce(e.point))}}}}class nQ extends eq.Queue{constructor(e){super(),this.B=e}EnqueueLL(e,t){e.Size()>this.B&&this.enqueue(e),t.Size()>this.B&&this.enqueue(t)}}class n1 extends e0{constructor(e,t,r){if(super(null),this.clustersInfo=new Map,this.clusterEdges=[],this.graph=e,this.settings=t,this.initFiNodesEdges(),this.edges=Array.from(this.graph.shallowEdges).map(e=>nL.getAlgData(e.edge).data),this.nodes=Array.from(this.graph.shallowNodes).map(e=>nL.getAlgData(e.node).data),this.components=[],this.settings.InterComponentForces)this.components.push(this.nodes);else for(let e of(this.basicGraph=rt(this.edges,this.nodes.length),t9(this.basicGraph))){let t=Array(e.length),r=0;for(let i of e)t[r++]=this.nodes[i];this.components.push(t)}this.computeWeight(e),this.setCurrentConstraintLevel(r)}initFiNodesEdges(){let e=0;for(let t of this.graph.shallowNodes){let r=new nB(e++,t);new nL(t.node,r)}for(let e of this.graph.shallowEdges){let t=new nF(e);new nL(e.edge,t)}}getCurrentConstraintLevel(){return this.currentConstraintLevel}setCurrentConstraintLevel(e){this.currentConstraintLevel=e,this.settings.Unconverge()}ResetNodePositions(){for(let e of this.nodes)e.ResetBounds()}AddRepulsiveForce(e,t){e.force=t.mul(10*this.settings.RepulsiveForceConstant)}AddLogSpringForces(e,t,r){let i=t.length,n=7e-4*this.settings.AttractiveForceConstant*i*Math.log((i+.1)/(r+.1));e.sourceFiNode.force=e.sourceFiNode.force.add(t.mul(n)),e.targetFiNode.force=e.targetFiNode.force.sub(t.mul(n))}AddSquaredSpringForces(e,t,r){let i=t.length,n=this.settings.AttractiveForceConstant*(i-r)/(r*r+.1);e.sourceFiNode.force=e.sourceFiNode.force.add(t.mul(n)),e.targetFiNode.force=e.targetFiNode.force.sub(t.mul(n))}AddSpringForces(e){let t;if(this.settings.RespectEdgePorts){let r=e.sourceFiNode.Center,i=e.targetFiNode.Center,n=e.mEdge.sourcePort;n instanceof ta&&(r=n.Location);let s=e.mEdge.targetPort;s instanceof ta&&(i=s.Location),t=r.sub(i)}else t=e.vector();this.settings.LogScaleEdgeForces?this.AddLogSpringForces(e,t,e.length):this.AddSquaredSpringForces(e,t,e.length)}static AddGravityForce(e,t,r){null!=r&&(r.force=r.force.sub(e.sub(r.Center).mul(1e-4*t)))}ComputeRepulsiveForces(e){let t=e.length;if(t>16&&this.settings.ApproximateRepulsion){let r=Array(e.length),i=Math.PI/t*2,n=0;for(let s=0;s<t;s++)r[s]=new nK(e[s].Center.add(new g(Math.cos(n),Math.sin(n)).mul(1e-5))),n+=i;new nJ(r,8).ComputeForces(5);for(let t=0;t<e.length;t++)this.AddRepulsiveForce(e[t],r[t].force)}else for(let t of e){let r=new g(0,0);for(let i of e)t!=i&&(r=r.add(nz.Force(t.Center,i.Center)));this.AddRepulsiveForce(t,r)}}SetBarycenter(e){let t=this.clustersInfo.get(e);if(void 0!=t)return t.barycenter;let r=new g(0,0);if(e.shallowNodeCount||function(e){for(let t of e.Clusters)return!0;return!1}(e)){let t=this.clustersInfo.get(e);if((void 0==t||void 0==t.weight)&&this.computeWeight(e),null!=t.weight){for(let t of e.shallowNodes)r=t instanceof e1?r.add(t.center):r.add(this.SetBarycenter(t).mul(this.clustersInfo.get(t).weight));this.clustersInfo.get(e).barycenter=r=r.div(t.weight)}}else this.clustersInfo.get(e).barycenter=r;return r}computeWeight(e){let t=0;for(let r of e.shallowNodes)r.entity instanceof eJ?t+=this.computeWeight(r):t++;let r=this.clustersInfo.get(e);return null==r&&this.clustersInfo.set(e,r={barycenter:new g(0,0)}),r.weight=t,t}AddClusterForces(e){if(null!=e){for(let t of(this.SetBarycenter(e),this.clusterEdges)){let e=o.getGeom(t.source),r=o.getGeom(t.target),i=nL.getAlgData(t.source).data,n=nL.getAlgData(t.target).data,s=e.hasOwnProperty("shallowNodes"),a=s?this.clustersInfo.get(e).barycenter:e.center,l=r.hasOwnProperty("shallowNodes"),h=l?this.clustersInfo.get(r).barycenter:r.center,u=a.sub(h),c=u.length,d=1e-8*(this.settings.AttractiveInterClusterForceConstant*(c*Math.log(c+.1)));if(u=u.mul(d),s)for(let t of e.shallowNodes){let e=nL.getAlgData(t.node).data;e.force=e.force.add(u)}else i.force=i.force.add(u);if(l)for(let e of r.shallowNodes){let t=nL.getAlgData(e.node).data;t.force=t.force.sub(u)}else n.force=n.force.sub(u)}for(let t of e.subgraphsDepthFirst){let e=this.clustersInfo.get(t).barycenter;for(let r of t.shallowNodes)n1.AddGravityForce(e,this.settings.ClusterGravity,nD(r))}}}ComputeForces(){if(null!=this.components)for(let e of this.components)this.ComputeRepulsiveForces(e);else this.ComputeRepulsiveForces(this.nodes);for(let e of(this.edges.forEach(e=>this.AddSpringForces(e)),this.components)){let t=new g(0,0);for(let r=0;r<e.length;r++)t=t.add(e[r].Center);t=t.div(e.length);let r=Number.NEGATIVE_INFINITY;for(let i=0;i<e.length;i++){let n=e[i];n1.AddGravityForce(t,this.settings.GravityConstant,n),n.force.length>r&&(r=n.force.length)}if(r>100)for(let t=0;t<e.length;t++)e[t].force=e[t].force.mul(100/r)}this.AddClusterForces(this.graph)}VerletIntegration(){let e=this.energy;this.energy=this.ComputeDescentDirection(1),this.UpdateStepSize(e);let t=0;for(let e=0;e<this.nodes.length;e++){let r=this.nodes[e];t+=r.Center.sub(r.previousCenter).lengthSquared}return t}ComputeDescentDirection(e){this.ResetForceVectors(),this.settings.ApplyForces&&this.ComputeForces();let t=0;for(let r of this.nodes){t+=r.force.lengthSquared;let i=r.Center.sub(r.previousCenter).mul(this.settings.Friction),n=r.force.mul(-this.stepSize*e);r.previousCenter=r.Center,eX.assert(!Number.isNaN(n.x),"!double.IsNaN(a.X)"),eX.assert(!Number.isNaN(n.y),"!double.IsNaN(a.Y)"),eX.assert(Number.isFinite(n.x),"!double.IsInfinity(a.X)"),eX.assert(Number.isFinite(n.y),"!double.IsInfinity(a.Y)"),i=(i=i.add(n)).div(r.stayWeight),r.Center=r.Center.add(i)}return t}ResetForceVectors(){for(let e of this.nodes)e.force=new g(0,0)}UpdateStepSize(e){this.energy<e?++this.progress>=3&&(this.progress=0,this.stepSize/=this.settings.Decay):(this.progress=0,this.stepSize*=this.settings.Decay)}RungeKuttaIntegration(){let e=Array(this.nodes.length),t=Array(this.nodes.length),r=Array(this.nodes.length),i=Array(this.nodes.length),n=Array(this.nodes.length),s=this.energy;for(let t=0;t<this.nodes.length;t++)this.nodes[t].previousCenter=this.nodes[t].Center,e[t]=this.nodes[t].Center;this.ComputeDescentDirection(3);for(let r=0;r<this.nodes.length;r++)t[r]=this.nodes[r].Center.sub(this.nodes[r].previousCenter),this.nodes[r].Center=e[r].add(t[r].mul(.5));this.ComputeDescentDirection(3);for(let t=0;t<this.nodes.length;t++)r[t]=this.nodes[t].Center.sub(this.nodes[t].previousCenter),this.nodes[t].previousCenter=e[t],this.nodes[t].Center=e[t].add(r[t].mul(.5));this.ComputeDescentDirection(3);for(let t=0;t<this.nodes.length;t++)i[t]=this.nodes[t].Center.sub(this.nodes[t].previousCenter),this.nodes[t].previousCenter=e[t],this.nodes[t].Center=e[t].add(i[t]);this.energy=this.ComputeDescentDirection(3);for(let s=0;s<this.nodes.length;s++){n[s]=this.nodes[s].Center.sub(this.nodes[s].previousCenter),this.nodes[s].previousCenter=e[s];let o=t[s].add(r[s].mul(2).add(i[s].mul(2)).add(n[s])).div(6);this.nodes[s].Center=e[s].add(o)}return this.UpdateStepSize(s),this.nodes.reduce((e,t)=>t.Center.sub(t.previousCenter).lengthSquared+e,0)}run(){this.settings.Converged=!1,this.settings.EdgeRoutesUpToDate=!1,0==this.settings.Iterations++&&(this.stepSize=this.settings.InitialStepSize,this.energy=Number.MAX_VALUE,this.progress=0);for(let e=0;e<this.settings.MinorIterations;e++){if((this.settings.RungeKuttaIntegration?this.RungeKuttaIntegration():this.VerletIntegration())<this.settings.DisplacementThreshold||this.settings.Iterations>this.settings.MaxIterations){this.settings.Converged=!0;break}this.ProgressStep()}}}class n0{get edgeRoutingSettings(){return this.commonSettings.edgeRoutingSettings}set edgeRoutingSettings(e){this.commonSettings.edgeRoutingSettings=e}get PackingAspectRatio(){return this.commonSettings.PackingAspectRatio}set PackingAspectRatio(e){this.commonSettings.PackingAspectRatio=e}get NodeSeparation(){return this.commonSettings.NodeSeparation}set NodeSeparation(e){this.commonSettings.NodeSeparation=e}get MaxIterations(){return this.maxIterations}set MaxIterations(e){this.maxIterations=e}get MinorIterations(){return this.minorIterations}set MinorIterations(e){this.minorIterations=e}get Iterations(){return this.iterations}set Iterations(e){this.iterations=e}get ProjectionIterations(){return this.projectionIterations}set ProjectionIterations(e){this.projectionIterations=e}get ApproximateRepulsion(){return this.approximateRepulsion}set ApproximateRepulsion(e){this.approximateRepulsion=e}get InitialStepSize(){return this.initialStepSize}set InitialStepSize(e){if(e<=0||e>2)throw Error("ForceScalar should be greater than 0 and less than 2 (if we let you set it to 0 nothing would happen, greater than 2 would most likely be very unstable!)");this.initialStepSize=e}get Decay(){return this.decay}set Decay(e){if(e<.1||e>1)throw Error("Setting decay too small gives no progress.  1==no decay, 0.1==minimum allowed value");this.decay=e}get Friction(){return this.friction}set Friction(e){if(e<0||e>1)throw Error("Setting friction less than 0 or greater than 1 would just be strange.  1==no friction, 0==no conservation of velocity");this.friction=e}get RepulsiveForceConstant(){return this.repulsiveForceConstant}set RepulsiveForceConstant(e){this.repulsiveForceConstant=e}get AttractiveForceConstant(){return this.attractiveForceConstant}set AttractiveForceConstant(e){this.attractiveForceConstant=e}get GravityConstant(){return this.gravity}set GravityConstant(e){this.gravity=e}get InterComponentForces(){return this.interComponentForces}set InterComponentForces(e){this.interComponentForces=e}get ApplyForces(){return this.applyForces}set ApplyForces(e){this.applyForces=e}constructor(){this.commonSettings=new i9,this.maxIterations=100,this.clusterMargin=10,this.minorIterations=3,this.projectionIterations=5,this.approximateRepulsion=!0,this.RungeKuttaIntegration=!1,this.initialStepSize=1.4,this.decay=.9,this.friction=.8,this.repulsiveForceConstant=1,this.attractiveForceConstant=1,this.gravity=1,this.interComponentForces=!0,this.applyForces=!0,this.AvoidOverlaps=!0,this.approximateRouting=!0,this.logScaleEdgeForces=!0,this.displacementThreshold=.1,this.maxConstraintLevel=2,this.minConstraintLevel=0,this.attractiveInterClusterForceConstant=1,this.clusterGravity=1,this.commonSettings.NodeSeparation*=2}ResetLayout(){this.Unconverge(),null!=this.algorithm&&this.algorithm.ResetNodePositions()}Unconverge(){this.iterations=0,this.converged=!1}InitializeLayoutGN(e,t){this.InitializeLayout(e,t)}InitializeLayout(e,t){this.algorithm=new n1(e,this,t),this.ResetLayout()}Uninitialize(){this.algorithm=null}get IsInitialized(){return null!=this.algorithm}IncrementalRunG(e){this.IncrementalRunGF(e)}SetupIncrementalRun(e){this.IsInitialized?this.IsDone&&this.ResetLayout():this.InitializeLayout(e,this.MaxConstraintLevel)}IncrementalRunGF(e){this.SetupIncrementalRun(e),this.algorithm.run()}IncrementalRun(e,t){null!=e&&e.throwIfCanceled(),this.SetupIncrementalRun(t),this.algorithm.cancelToken=e,this.algorithm.run()}Clone(){return n0.ctorClone(this)}get ApproximateRouting(){return this.approximateRouting}set ApproximateRouting(e){this.approximateRouting=e}get LogScaleEdgeForces(){return this.logScaleEdgeForces}set LogScaleEdgeForces(e){this.logScaleEdgeForces=e}get DisplacementThreshold(){return this.displacementThreshold}set DisplacementThreshold(e){this.displacementThreshold=e}get Converged(){return this.converged}set Converged(e){this.converged=e}get PercentDone(){return this.Converged?100:100*this.iterations/this.MaxIterations}get IsDone(){return this.Converged||this.iterations>=this.MaxIterations}get Energy(){return null!=this.algorithm?this.algorithm.energy:0}get MaxConstraintLevel(){return this.maxConstraintLevel}set MaxConstraintLevel(e){this.maxConstraintLevel!=e&&(this.maxConstraintLevel=e,this.IsInitialized&&this.Uninitialize())}get MinConstraintLevel(){return this.minConstraintLevel}set MinConstraintLevel(e){this.minConstraintLevel=e}getCurrentConstraintLevel(){return null==this.algorithm?0:this.algorithm.getCurrentConstraintLevel()}setCurrentConstraintLevel(e){this.algorithm.setCurrentConstraintLevel(e)}get AttractiveInterClusterForceConstant(){return this.attractiveInterClusterForceConstant}set AttractiveInterClusterForceConstant(e){this.attractiveInterClusterForceConstant=e}static ctorClone(e){let t=new n0;return t.maxIterations=e.maxIterations,t.minorIterations=e.minorIterations,t.projectionIterations=e.projectionIterations,t.approximateRepulsion=e.approximateRepulsion,t.initialStepSize=e.initialStepSize,t.RungeKuttaIntegration=e.RungeKuttaIntegration,t.decay=e.decay,t.friction=e.friction,t.repulsiveForceConstant=e.repulsiveForceConstant,t.attractiveForceConstant=e.attractiveForceConstant,t.gravity=e.gravity,t.interComponentForces=e.interComponentForces,t.applyForces=e.applyForces,t.AvoidOverlaps=e.AvoidOverlaps,t.RespectEdgePorts=e.RespectEdgePorts,t.RouteEdges=e.RouteEdges,t.approximateRouting=e.approximateRouting,t.logScaleEdgeForces=e.logScaleEdgeForces,t.displacementThreshold=e.displacementThreshold,t.minConstraintLevel=e.minConstraintLevel,t.maxConstraintLevel=e.maxConstraintLevel,t.attractiveInterClusterForceConstant=e.attractiveInterClusterForceConstant,t.clusterGravity=e.clusterGravity,t.PackingAspectRatio=e.PackingAspectRatio,t.NodeSeparation=e.NodeSeparation,t.clusterMargin=e.clusterMargin,t}get ClusterGravity(){return this.clusterGravity}set ClusterGravity(e){this.clusterGravity=e}static CreateFastIncrementalLayoutSettings(){let e=new n0;return e.ApplyForces=!1,e.ApproximateRepulsion=!0,e.ApproximateRouting=!0,e.AttractiveForceConstant=1,e.AttractiveInterClusterForceConstant=1,e.AvoidOverlaps=!0,e.ClusterGravity=1,e.Decay=.9,e.DisplacementThreshold=5e-8,e.Friction=.8,e.GravityConstant=1,e.InitialStepSize=2,e.InterComponentForces=!1,e.Iterations=0,e.LogScaleEdgeForces=!1,e.MaxConstraintLevel=2,e.MaxIterations=20,e.MinConstraintLevel=0,e.MinorIterations=1,e.ProjectionIterations=5,e.RepulsiveForceConstant=2,e.RespectEdgePorts=!1,e.RouteEdges=!1,e.RungeKuttaIntegration=!0,e.NodeSeparation=20,e}}class n2{constructor(e){this.topNodes=e}get nodesBreadthFirst(){return this.nodesBreadthFirst_()}*nodesBreadthFirst_(){for(let e of this.topNodes)if(yield e1.getGeom(e),e instanceof eJ)for(let t of e.nodesBreadthFirst)yield e1.getGeom(t)}get Clusters(){return this.clusters()}*clusters(){for(let e of this.topNodes)e instanceof eJ&&(yield ti.getGeom(e))}get subgraphsDepthFirst(){return this.subgraphsDepthFirst_()}*subgraphsDepthFirst_(){for(let e of this.topNodes)if(e instanceof eJ){let t=ti.getGeom(e);yield*t.subgraphsDepthFirst,yield t}}get shallowEdges(){return this.edges_()}*edges_(){for(let e of this.topNodes){for(let t of e.outEdges)yield V.getGeom(t);for(let t of e.selfEdges)yield V.getGeom(t)}}get shallowNodes(){return this.shallowNodes_()}*shallowNodes_(){for(let e of this.topNodes)yield e1.getGeom(e)}pumpTheBoxToTheGraphWithMargins(){let e={b:M.mkEmpty()};return tn(this,e),this.boundingBox=e.b}get shallowNodeCount(){return this.topNodes.length}translate(e){for(let t of(this.boundingBox&&(this.boundingBox.center=this.boundingBox.center.add(e)),this.topNodes))e1.getGeom(t).translate(e)}}class n3{static LinearInterpolation(e,t,r,i,n){return e<t?i:e>r?n:i+(e-t)/(r-t)*(n-i)}static NegativeLinearInterpolation(e,t,r,i,n){return e<t?n:e>r?i:i+(1-(e-t)/(r-t))*(n-i)}}class n5 extends e0{constructor(e,t){super(null),this.SingleComponent=!1,this.graph=e,this.settings=n0.ctorClone(t),this.settings.ApplyForces=!0,this.settings.InterComponentForces=!0,this.settings.RungeKuttaIntegration=!1,this.settings.RespectEdgePorts=!1}run(){if(this.SingleComponent)this.componentCount=1,this.LayoutComponent(this.graph);else{let e=Array.from(this.graph.graph.getClusteredConnectedComponents()).map(e=>new n2(e));for(let t of(this.componentCount=e.length,e))this.LayoutComponent(t);this.graph.boundingBox=nT.PackGraphs(e,this.settings.commonSettings)}}LayoutComponent(e){if(e.shallowNodeCount>1){if(this.settings.MaxIterations=n3.NegativeLinearInterpolation(e.shallowNodeCount,50,500,5,10),this.settings.MinorIterations=n3.NegativeLinearInterpolation(e.shallowNodeCount,50,500,3,20),0==this.settings.MinConstraintLevel){let t=new nP;t.removeOverlaps=!1,t.IterationsWithMajorization=0,new nE(e,null,()=>1,new nP).run()}let t=new n1(e,this.settings,this.settings.MinConstraintLevel);for(let r of this.GetConstraintLevels(e)){if(r>this.settings.MaxConstraintLevel)break;r>this.settings.MinConstraintLevel&&t.setCurrentConstraintLevel(r);do t.run();while(!this.settings.IsDone)}this.settings.AvoidOverlaps&&nw.RemoveOverlaps(Array.from(this.graph.shallowNodes),this.settings.NodeSeparation)}e.pumpTheBoxToTheGraphWithMargins(),e.uniformMargins=this.settings.NodeSeparation,e.translate(e.boundingBox.leftBottom.mul(-1))}GetConstraintLevels(e){let t=new Set;return t.add(0),this.settings.AvoidOverlaps&&e.shallowNodeCount<2e3&&t.add(2),t}}function n6(e){!e.layoutSettings&&(e.layoutSettings=n4(e))}function n4(e){let t=function(e){let t=e.parent;for(;t;){if(t.layoutSettings)return t.layoutSettings;t=t.parent}return null}(e);if(t)return t;if(e.graph.shallowNodeCount>2e3||e.graph.deepEdgesCount>4e3)return new n0;let r=!1;for(let t of e.deepEdges)if(null!=t.sourceArrowhead||null!=t.targetArrowhead){r=!0;break}return r?new i8:new n0}function n9(e,t,r=()=>1){if(n6(e),e.layoutSettings instanceof i8)new or(e,e.layoutSettings,t).run();else if(e.layoutSettings instanceof nP)new nE(e,t,r,e.layoutSettings).run();else if(e.layoutSettings instanceof n0){let t=new n5(e,e.layoutSettings);t.SingleComponent=!0,t.run()}else throw Error("not implemented")}function n8(e,t=null){n6(e),function e(t,r,i,n,s,o=1,a=()=>1){if(t.graph.isEmpty())return;t.shallowNodes.next(),null==t.parent&&(t6(o),function(e){for(let t of e.deepEdges)t.label&&(t.label.isPositioned=!1)}(t));let l=function(){let e=new Set,r=t.graph;if(null==r.parent)return e;for(let t of r.shallowNodes){for(let i of t.outEdges){let n=r.liftNode(i.target);(null==n||n===t)&&e.add(i)}for(let i of t.inEdges){let n=r.liftNode(i.source);(null==n||n===t)&&e.add(i)}}for(let t of e)t.remove();return e}();(function(t){for(let o of t.shallowNodes)o instanceof ti&&e(o,r,i,n,s)})(t);let h=function(e){let t=[];for(let r of e.nodesBreadthFirst){let i=e.liftNode(r);if(null!=i)for(let n of r.outEdges.values()){let s=n.target,o=e.liftNode(s);if(null==o||i===r&&o===s||i===o)continue;n.remove();let a=new V(new eY(i,o));t.push([a,n])}}return t}(t.graph),u=function(e){var t;let r=e.graph,i=function*(e){let t=new Set,r=new eq.Queue;for(let n of e.shallowNodes){if(t.has(n))continue;let e=[];for(i(n,r,t);r.length>0;){let n=r.dequeue();for(let s of(e.push(n),function*(e){for(let t of e.outEdges)yield t.target;for(let t of e.inEdges)yield t.source}(n)))i(s,r,t)}yield e}function i(e,t,r){!r.has(e)&&(t.enqueue(e),r.add(e))}}(r),n=[],s=0;for(let o of i){let i=new eJ(r.id+s++);i.parent=r;let a=new ti(i);for(let r of(a.layoutSettings=null!==(t=e.layoutSettings)&&void 0!==t?t:n4(e),o))r.parent=i,i.addNode(r);n.push(a)}return n}(t);if(function(){if(1===u.length)i(t,r,a);else{for(let e of u)i(e,r,a),e.boundingBox=e.pumpTheBoxToTheGraphWithMargins();s(t,u)}}(),h.forEach(e=>{e[0].edge.remove(),e[1].add()}),u.forEach(e=>{for(let r of e.graph.shallowNodes)r.parent=t.graph}),l.forEach(e=>e.add()),null==t.graph.parent){let e=function(e){let t=[];for(let r of e.nodesBreadthFirst){for(let e of r.outEdges())null==e.curve&&t.push(e);for(let e of r.selfEdges())null==e.curve&&t.push(e)}return t}(t);n(t,e,r),st(t,e),t.pumpTheBoxToTheGraphWithMargins()}}(e,t,n9,se,tr),function(e){let t=e.boundingBox.leftBottom;if(t.x<0||t.y<0){let r=new g(-t.x,-t.y);e.translate(r)}}(e)}function n7(e){for(;;){if(e.layoutSettings&&e.layoutSettings.commonSettings.edgeRoutingSettings)return e.layoutSettings.commonSettings.edgeRoutingSettings;let t=e.graph.parent;if(t)e=o.getGeom(t);else break}let t=new i4;return t.EdgeRoutingMode=eb.Spline,t}function se(e,t,r){let i=n7(e);i.EdgeRoutingMode===eb.Rectilinear?function(e,t,r,i=1,n=3,s=3){let o=i1.constructorGNAN(e,t,i,n);o.edgeSeparatian=s,o.run()}(e,t,r):i.EdgeRoutingMode===eb.Spline||i.EdgeRoutingMode===eb.SplineBundling?function(e,t,r){let i=n7(e);new sL(e,t,i.Padding,i.PolylinePadding,i.coneAngle,i.bundlingSettings,r).run()}(e,t,r):i.EdgeRoutingMode===eb.StraightLine?nC(e,t,r):i.EdgeRoutingMode!==eb.None&&new sL(e,t).run(),st(e,t)}function st(e,t){if(0!==t.length)nN.constructorGA(e,t).run()}class sr{static constructorStatic(e,t){let r=new sr;for(let i of(r.edges=e,r.nodeBoundaries=t,r.boundingBox=M.mkEmpty(),r.nodeBoundaries))r.boundingBox=r.boundingBox.addRec(i.boundingBox);return r}AddGraph(e){this.edges=this.edges.concat(e.edges),this.nodeBoundaries=eD(this.nodeBoundaries,e.nodeBoundaries),this.boundingBox.addRec(e.boundingBox)}AddNodeBoundary(e){this.nodeBoundaries.add(e),this.boundingBox.addRec(e.boundingBox)}}(ee=eT||(eT={}))[ee.Success=0]="Success",ee[ee.Overlaps=1]="Overlaps",ee[ee.EdgeSeparationIsTooLarge=2]="EdgeSeparationIsTooLarge";class si{get CurrentPiercedEdge(){return this.currentPiercedEdge}get CurrentTriangle(){return this.currentTriangle}constructor(e,t,r){this.currentTriangle=e,this.start=t,this.end=r}FindFirstPiercedEdge(){let e=this.GetHyperplaneSign(this.currentTriangle.Sites.item0),t=this.GetHyperplaneSign(this.currentTriangle.Sites.item1);if(e!==t&&g.getTriangleOrientation(this.end,this.currentTriangle.Sites.item0.point,this.currentTriangle.Sites.item1.point)==eo.Clockwise)return this.positiveSign=e,this.negativeSign=t,this.currentTriangle.Edges.item0;let r=this.GetHyperplaneSign(this.currentTriangle.Sites.item2);return t!==r&&g.getTriangleOrientation(this.end,this.currentTriangle.Sites.item1.point,this.currentTriangle.Sites.item2.point)==eo.Clockwise?(this.positiveSign=t,this.negativeSign=r,this.currentTriangle.Edges.item1):(this.positiveSign=r,this.negativeSign=e,this.currentTriangle.Edges.item2)}FindNextPierced(){let e;if(this.currentTriangle=this.currentPiercedEdge.GetOtherTriangle_T(this.currentTriangle),null==this.currentTriangle){this.currentPiercedEdge=null;return}let t=this.currentTriangle.Edges.index(this.currentPiercedEdge),r=this.currentTriangle.Sites.getItem(t+2),i=this.GetHyperplaneSign(r);0===this.negativeSign?-1===i||0===i?(this.negativeSign=i,e=t+1):e=t+2:0===this.positiveSign?1===i||0===i?(this.positiveSign=i,e=t+2):e=t+1:i!==this.positiveSign?(this.negativeSign=i,e=t+1):(this.positiveSign=i,e=t+2),this.currentPiercedEdge=g.signedDoubledTriangleArea(this.end,this.currentTriangle.Sites.getItem(e).point,this.currentTriangle.Sites.getItem(e+1).point)<-l.distanceEpsilon?this.currentTriangle.Edges.getItem(e):null}GetHyperplaneSign(e){let t=g.signedDoubledTriangleArea(this.start,e.point,this.end);return t>l.distanceEpsilon?1:t<-l.distanceEpsilon?-1:0}MoveNext(){return null==this.currentPiercedEdge?this.currentPiercedEdge=this.FindFirstPiercedEdge():this.FindNextPierced(),null!=this.currentPiercedEdge}}class sn{EdgeIsLegal_(e,t,r,i){if(ng.PointIsInsideOfTriangle(t,r))return!0;let n=new si(r,e,t);for(;n.MoveNext();){let e=n.CurrentPiercedEdge;if(e.constrained){let t=e.lowerSite.Owner;if(!i.has(t))return!1}}return!0}constructor(e,t){this.ComputeForcesForBundles=!1,this.metroGraphData=e,this.bundlingSettings=t}BundleAvoidsObstacles(e,t,r,i,n,s){s.closestDist=[];let o=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,t),a=this.FindCloseObstaclesForBundle(t.cdtTriangle,i,r,o,n);if(null==a)return!1;for(let e of a){let t=e[1];s.closestDist.push(t)}return!0}FindCloseObstaclesForBundle(e,t,r,i,n){let s=new Map,o=[];if(!this.ThreadLineSegmentThroughTriangles(e,t,r,i,o))return null;if(!this.ComputeForcesForBundles&&!this.bundlingSettings.HighestQuality)return s;let a=new Set;for(let e of o)for(let o of e.Sites){let e,l,h;if(a.has(o))continue;a.add(o);let u=o.Owner;if(i.has(u))continue;let c=sn.FindPolylinePoint(u,o.point),d=b.minDistBetweenLineSegments(c.point,c.nextOnPolyline.point,t,r),f=d.dist,p=d.parab,g=d.parcd,m=b.minDistBetweenLineSegments(c.point,c.prevOnPolyline.point,t,r),v=m.dist,y=m.parab,x=m.parcd;if(f<v){if((h=f)>n)continue;e=c.point.add(c.nextOnPolyline.point.sub(c.point).mul(p)),l=t.add(r.sub(t).mul(g))}else{if((h=v)>n)continue;e=c.point.add(c.prevOnPolyline.point.sub(c.point).mul(y)),l=t.add(r.sub(t).mul(x))}!s.get(u)&&s.set(u,[e,l])}return s}ThreadLineSegmentThroughTriangles(e,t,r,i,n){if(ng.PointIsInsideOfTriangle(r,e))return n.push(e),!0;let s=new si(e,t,r);for(n.push(e);s.MoveNext();){n.push(s.CurrentTriangle);let e=s.CurrentPiercedEdge;if(e.constrained){let t=e.lowerSite.Owner;if(!i.has(t))return!1}}return null!=s.CurrentTriangle&&n.push(s.CurrentTriangle),!0}static PointLocationInsideTriangle(e,t){let r=!1;for(let i=0;i<3;i++){let n=g.signedDoubledTriangleArea(e,t.Sites.getItem(i).point,t.Sites.getItem(i+1).point);if(n<-1*l.distanceEpsilon)return el.Outside;n<l.distanceEpsilon&&(r=!0)}return r?el.Boundary:el.Inside}static FindPolylinePoint(e,t){for(let r of e.polylinePoints())if(r.point.equal(t))return r;throw Error("polyline point "+t+" not found")}EdgeIsLegal(e,t,r,i){let n=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,t);return this.ThreadLineSegmentThroughTriangles(e.cdtTriangle,r,i,n,[])}EdgeIsLegalSSPPS(e,t,r){let i=e.Position,n=e.cdtTriangle,s=t.Position;if(ng.PointIsInsideOfTriangle(s,n))return!0;let o=new si(n,i,s);for(;o.MoveNext();){let e=o.CurrentPiercedEdge;if(e.constrained){let t=e.lowerSite.Owner;if(!r.has(t))return!1}}return!0}}class ss{constructor(e,t,r,i){this.metroGraphData=e,this.obstaclesToIgnoreLambda=i,this.bundlingSettings=t,this.obstacleTree=r}ObstaclesToIgnoreForBundle(e,t){return null!=e&&null!=t?eD(this.obstaclesToIgnoreLambda(e),this.obstaclesToIgnoreLambda(t)):null==e&&null==t?new Set:null!=e?this.obstaclesToIgnoreLambda(e):this.obstaclesToIgnoreLambda(t)}HubAvoidsObstaclesSPNBA(e,t,r,i){return ss.IntersectCircleWithTree(this.obstacleTree,t,r,this.obstaclesToIgnoreLambda(e),i.touchedObstacles,{minimalDistance:r})}HubAvoidsObstaclesPNS__(e,t,r){return this.HubAvoidsObstaclesPNSTT(e,t,r,{touchedObstacles:[]},{minimalDistance:0})}GetMinimalDistanceToObstacles(e,t,r){let i={minimalDistance:r};return ss.IntersectCircleWithTree(this.obstacleTree,t,r,this.obstaclesToIgnoreLambda(e),[],i)?i.minimalDistance:0}HubAvoidsObstaclesPNSTT(e,t,r,i,n){return i.touchedObstacles=[],n.minimalDistance=t,ss.IntersectCircleWithTree(this.obstacleTree,e,t,r,i.touchedObstacles,n)}static IntersectCircleWithTree(e,t,r,i,n,s){if(!e.irect.contains_point_radius(t,r))return!0;if(null==e.UserData){let o=ss.IntersectCircleWithTree(e.Left,t,r,i,n,s);if(!o||!(o=ss.IntersectCircleWithTree(e.Right,t,r,i,n,s)))return!1}else{let o=e.UserData;if(i.has(o))return!0;if(C.PointRelativeToCurveLocation(t,o)!==el.Outside)return ss.containingPoly=o,!1;let a=o.value(o.closestParameter(t)),l=a.sub(t).length;l<=r&&n.push([o,a]),s.minimalDistance=Math.min(l,s.minimalDistance)}return!0}static Create4gon(e,t,r,i){let n=t.sub(e).normalize();return n=new g(n.y,-1*n.x),A.mkFromPoints([e.add(n.mul(r/2)),e.sub(n.mul(r/2)),t.sub(n.mul(i/2)),t.add(n.mul(i/2))])}}class so{constructor(e,t,r,i){this.Width=t,this.Polyline=e,this.sourceAndTargetLoosePolylines=r,this.Index=i}UpdateLengths(){let e=0;for(let t=this.Polyline.startPoint;null!=t.next;t=t.next)e+=t.next.point.sub(t.point).length;this.Length=e,this.IdealLength=this.Polyline.end.sub(this.Polyline.start).length}}class sa{constructor(e,t,r){this.metroline=e,this.station=t,this.polyPoint=r}get Metroline(){return this.metroline}get PolyPoint(){return this.polyPoint}}class sl{constructor(e,t,r){this.Radius=0,this.BundleBases=new Map,this.MetroNodeInfos=[],this._cachedIdealRadius=0,this.SerialNumber=e,this.IsReal=t,this.Position=r}debStop(){return 28===this.SerialNumber&&this.Position.sub(new g(841.2662778763244,303.3817005853006)).length<.001}get Position(){return this._Position}set Position(e){this._Position=e}getELP(){return this.EnterableLoosePolylines}setELP(e){this.EnterableLoosePolylines=e}addEL(e){this.EnterableLoosePolylines.add(e)}get cachedIdealRadius(){return this._cachedIdealRadius}set cachedIdealRadius(e){this._cachedIdealRadius=e}AddEnterableLoosePolyline(e){null==this.EnterableLoosePolylines&&(this.EnterableLoosePolylines=new Set),this.EnterableLoosePolylines.add(e)}AddEnterableTightPolyline(e){null==this.EnterableTightPolylines&&(this.EnterableTightPolylines=new Set),this.EnterableTightPolylines.add(e)}}class sh{constructor(){this.Width=0,this.Metrolines=[],this.cachedBundleCost=0}get Count(){return this.Metrolines.length}}class su{constructor(e,t){this.metroGraphData=e,this.bundlingSettings=t}CreateNodeRadii(){for(let e of this.metroGraphData.VirtualStations())e.Radius=0,e.cachedIdealRadius=su.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e);for(let e of(this.GrowHubs(!1),this.GrowHubs(!0),this.metroGraphData.VirtualStations()))e.Radius=Math.max(e.Radius,this.bundlingSettings.MinHubRadius)}GrowHubs(e){let t=new rd(h);for(let r of this.metroGraphData.VirtualStations())t.Enqueue(r,-this.CalculatePotential(r,e));let r=!1;for(;!t.IsEmpty();){let i={priority:0},n=t.DequeueAndGetPriority(i);if(i.priority>=0)break;this.TryGrowHub(n,e)&&(t.Enqueue(n,-this.CalculatePotential(n,e)),r=!0)}return r}TryGrowHub(e,t){let r=this.CalculateAllowedHubRadius(e);if(e.Radius>=r)return!1;let i=t?su.CalculateIdealHubRadiusWithAdjacentEdges(this.bundlingSettings,e):e.cachedIdealRadius;if(e.Radius>=i)return!1;let n=.05*(i-e.Radius);n<1&&(n=1);let s=Math.min(e.Radius+n,r);return!(s<=e.Radius)&&(e.Radius=s,!0)}CalculatePotential(e,t){let r=t?su.CalculateIdealHubRadiusWithAdjacentEdges(this.bundlingSettings,e):e.cachedIdealRadius;return r<=e.Radius?0:(r-e.Radius)/r}CalculateAllowedHubRadius(e){let t=this.bundlingSettings.MaxHubRadius;for(let r of e.Neighbors)t=Math.min(t,r.Position.sub(e.Position).length/1.05-r.Radius);let r=this.metroGraphData.tightIntersections.GetMinimalDistanceToObstacles(e,e.Position,t);return r<t&&(t=r-.001),Math.max(t,.1)}static CalculateIdealHubRadius(e,t,r){let i=1;for(let n of r.Neighbors)i=Math.max(i,e.GetWidthSSN(n,r,t.EdgeSeparation)/2+t.EdgeSeparation);return i=Math.min(i,2*t.MaxHubRadius)}static CalculateIdealHubRadiusWithNeighborsMBS(e,t,r){return su.CalculateIdealHubRadiusWithNeighborsMBNP(e,t,r,r.Position)}static CalculateIdealHubRadiusWithNeighborsMBNP(e,t,r,i){let n=su.CalculateIdealHubRadius(e,t,r);if(r.Neighbors.length>1){let s=r.Neighbors;for(let o=0;o<s.length;o++){let a=s[o],l=s[(o+1)%s.length];n=Math.max(n,su.GetMinRadiusForTwoAdjacentBundles(n,r,i,a,l,e,t))}}return n=Math.min(n,2*t.MaxHubRadius)}static CalculateIdealHubRadiusWithAdjacentEdges(e,t){let r=e.MaxHubRadius;for(let e of t.Neighbors)r=Math.min(r,t.Position.sub(e.Position).length/2);return r}static GetMinRadiusForTwoAdjacentBundles(e,t,r,i,n,s,o){let a=s.GetWidthSSN(t,i,o.EdgeSeparation),l=s.GetWidthSSN(t,n,o.EdgeSeparation);return su.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(e,r,i.Position,n.Position,a,l,o)}static GetMinRadiusForTwoAdjacentBundlesNPPPNNB(e,t,r,i,n,s,o){if(n<l.distanceEpsilon||s<l.distanceEpsilon)return e;let a=g.anglePCP(r,t,i);if((a=Math.min(a,2*Math.PI-a))<l.distanceEpsilon)return 2*o.MaxHubRadius;if(a>=Math.PI/2)return 1.05*e;let h=Math.sin(a),u=n/(4*h),c=s/(4*h),d=2*Math.sqrt(u*u+(c*c+c*Math.cos(a)*u*2));return d=Math.max(d=Math.min(d,2*o.MaxHubRadius),e)}}class sc{constructor(e,t,r,i){this.metroGraphData=e,this.bundlingSettings=t,this.costCalculator=r,this.cdt=i}InitializeCostCache(){for(let e of this.metroGraphData.VirtualStations())e.cachedIdealRadius=su.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e),e.cachedRadiusCost=this.costCalculator.RadiusCost(e,e.Position),e.cachedBundleCost=0;for(let e of this.metroGraphData.VirtualEdges()){let t=e[0],r=e[1],i=this.metroGraphData.GetIjInfo(t,r);i.cachedBundleCost=this.costCalculator.BundleCost(t,r,t.Position),t.cachedBundleCost+=i.cachedBundleCost,r.cachedBundleCost+=i.cachedBundleCost}}UpdateCostCache(e){let t=this.cdt.getRectangleNodeOnTriangles();for(let r of(e.cdtTriangle=t.FirstHitNodeWithPredicate(e.Position,sc.testPointInside).UserData,e.cachedIdealRadius=su.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e),e.cachedRadiusCost=this.costCalculator.RadiusCost(e,e.Position),e.cachedBundleCost=0,e.Neighbors)){!r.IsReal&&(r.cachedIdealRadius=su.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,r),r.cachedRadiusCost=this.costCalculator.RadiusCost(r,r.Position));let t=this.metroGraphData.GetIjInfo(e,r);r.cachedBundleCost-=t.cachedBundleCost,t.cachedBundleCost=this.costCalculator.BundleCost(e,r,e.Position),e.cachedBundleCost+=t.cachedBundleCost,r.cachedBundleCost+=t.cachedBundleCost}}static testPointInside(e,t){return ng.PointIsInsideOfTriangle(e,t)?eu.Stop:eu.Continue}}class sd{constructor(){this.mainMap=new Map}get isEmpty(){return 0===this.mainMap.size||this.everyMapIsEmpty()}everyMapIsEmpty(){for(let e of this.mainMap.values())if(e.size)return!1;return!0}get(e,t){let r=this.mainMap.get(e);if(r)return r.get(t)}has(e,t){let r=this.mainMap.get(e);return!!r&&r.has(t)}set(e,t,r){let i=this.mainMap.get(e);!i&&(i=new Map,this.mainMap.set(e,i)),i.set(t,r)}*[Symbol.iterator](){for(let[e,t]of this.mainMap)for(let[r,i]of t)yield[e,r,i]}*keys(){for(let[e,t]of this.mainMap)for(let[r]of t)yield[e,r]}}class sf{constructor(e,t,r,i,n,s,o,a){this.cachedEnterableLooseForEnd=new t_,this.bundlingSettings=i,this.regularEdges=e,null!=n?this.cdt=n:this.cdt=nm(t),this.EdgeLooseEnterable=s,this.EdgeTightEnterable=o,this.LoosePolylineOfPort=a,this.looseIntersections=new ss(this,i,t,e=>e.getELP()),this.tightIntersections=new ss(this,i,r,e=>e.EnterableTightPolylines),this.cdtIntersections=new sn(this,i),this.Initialize(!1)}get Ink(){return this.ink}get Edges(){return this.regularEdges}VirtualStations(){return Array.from(this.Stations).filter(e=>!e.IsReal)}get Metrolines(){return this.metrolines}get LooseTree(){return this.looseIntersections.obstacleTree}get TightTree(){return this.tightIntersections.obstacleTree}*VirtualEdges(){for(let e of this.edgeInfoDictionary.keys())yield e}RealEdgeCount(e,t){let r=e.SerialNumber<t.SerialNumber?[e,t]:[t,e],i=this.edgeInfoDictionary.get(r[0],r[1]);return i?i.Count:0}MetroNodeInfosOfNode(e){return e.MetroNodeInfos}GetIjInfo(e,t){let r=e.SerialNumber<t.SerialNumber?[e,t]:[t,e];return this.edgeInfoDictionary.get(r[0],r[1])}MoveNode(e,t){let r=e.Position;for(let i of(this.PointToStations.deleteP(r),this.PointToStations.set(t,e),e.Position=t,this.MetroNodeInfosOfNode(e)))i.PolyPoint.point=t;for(let i of this.MetroNodeInfosOfNode(e)){let e=i.Metroline,n=i.PolyPoint.prev.point,s=i.PolyPoint.next.point;e.Length+=s.sub(t).length+n.sub(t).length-s.sub(r).length-n.sub(r).length}for(let i of e.Neighbors)this.ink+=t.sub(i.Position).length-r.sub(i.Position).length;for(let t of(this.SortNeighbors(e),e.Neighbors))this.SortNeighbors(t)}GetWidthSSN(e,t,r){let i=e.SerialNumber<t.SerialNumber?[e,t]:[t,e],n=this.edgeInfoDictionary.get(i[0],i[1]);return n?n.Width+(n.Count-1)*r:0}GetWidthAN(e,t){let r=0;for(let t of e)r+=t.Width;let i=e.length;return r+=i>0?(i-1)*t:0}Initialize(e){this.SimplifyRegularEdges(),this.InitializeStationData(),this.InitializeEdgeData(),this.InitializeVirtualGraph(),this.InitializeEdgeNodeInfo(e),this.InitializeCdtInfo()}SimplifyRegularEdges(){for(let e of this.regularEdges)this.SimplifyRegularEdge(e)}SimplifyRegularEdge(e){let t=e.curve,r=new eE.Stack,i=new eN;for(let e=t.endPoint;null!=e;e=e.prev){let t=e.point;if(i.has(e.point)){let n=e.next;for(;;){let e=r.top;if(e.equal(t))break;i.delete(e),r.pop(),n=n.next}n.prev=e.prev,n.prev.next=n}else r.push(t),i.add(t)}}InitializeStationData(){for(let e of(this.Stations=[],this.PointToStations=new t_,this.regularEdges)){let t=e.curve;this.ProcessPolylinePoints(t)}}ProcessPolylinePoints(e){let t=e.startPoint;for(this.RegisterStation(t,!0),t=t.next;t!==e.endPoint;t=t.next)this.RegisterStation(t,!1);this.RegisterStation(t,!0)}RegisterStation(e,t){if(!this.PointToStations.has(e.point)){let r=new sl(this.Stations.length,t,e.point);this.PointToStations.set(e.point,r),this.Stations.push(r)}}InitializeEdgeData(){this.metrolines=[];for(let e=0;e<this.regularEdges.length;e++){let t=this.regularEdges[e];this.InitEdgeData(t,e)}}InitEdgeData(e,t){let r=new so(e.curve,this.bundlingSettings.ActualEdgeWidth(e),this.EdgeSourceAndTargetFunc(e),t);this.metrolines.push(r),this.PointToStations.get(r.Polyline.start).BoundaryCurve=e.sourcePort.Curve,this.PointToStations.get(r.Polyline.end).BoundaryCurve=e.targetPort.Curve}EdgeSourceAndTargetFunc(e){return()=>[this.LoosePolylineOfPort(e.sourcePort),this.LoosePolylineOfPort(e.targetPort)]}InitializeVirtualGraph(){let e=new Map;for(let t of this.metrolines){let r,i=this.PointToStations.get(t.Polyline.start);for(let n=t.Polyline.startPoint;null!=n.next;n=n.next,i=r)ez(e,i,r=this.PointToStations.get(n.next.point)),ez(e,r,i)}for(let t of this.Stations)t.Neighbors=Array.from(e.get(t))}GetUnorderedIjInfo(e,t){return e.SerialNumber<t.SerialNumber?this.GetCreateOrderedIjInfo(e,t):this.GetCreateOrderedIjInfo(t,e)}static closedeb(e,t){return e.Position.sub(new g(360.561,428.416)).length<.1&&t.Position.sub(new g(414.281,440.732)).length<.1}GetCreateOrderedIjInfo(e,t){let r=this.edgeInfoDictionary.get(e,t);return r?r:(r=new sh,this.edgeInfoDictionary.set(e,t,r),r)}InitializeEdgeNodeInfo(e){for(let t of(this.edgeInfoDictionary=new sd,this.InitAllMetroNodeInfos(e),this.SortAllNeighbors(),this.InitEdgeIjInfos(),this.ink=0,this.VirtualEdges()))this.ink+=t[0].Position.sub(t[1].Position).length}InitAllMetroNodeInfos(e){for(let t=0;t<this.metrolines.length;t++){let r=this.metrolines[t];this.InitMetroNodeInfos(r),this.InitNodeEnterableLoosePolylines(r,this.regularEdges[t]),e&&this.InitNodeEnterableTightPolylines(r,this.regularEdges[t]),r.UpdateLengths()}}InitMetroNodeInfos(e){for(let t=e.Polyline.startPoint;null!=t;t=t.next){let r=this.PointToStations.get(t.point);r.MetroNodeInfos.push(new sa(e,r,t))}}InitNodeEnterableLoosePolylines(e,t){let r=null!=this.EdgeLooseEnterable?this.EdgeLooseEnterable.get(t):new Set;for(let t=e.Polyline.startPoint.next;null!=t&&null!=t.next;t=t.next){let e=this.PointToStations.get(t.point);null!=e.getELP()?e.setELP(eF(e.getELP(),r)):e.setELP(new Set(r))}this.AddLooseEnterableForMetrolineStartEndPoints(e)}AddLooseEnterableForMetrolineStartEndPoints(e){this.AddLooseEnterableForEnd(e.Polyline.start),this.AddLooseEnterableForEnd(e.Polyline.end)}AddTightEnterableForMetrolineStartEndPoints(e){this.AddTightEnterableForEnd(e.Polyline.start),this.AddTightEnterableForEnd(e.Polyline.end)}AddLooseEnterableForEnd(e){let t=this.PointToStations.get(e);if(this.cachedEnterableLooseForEnd.has(e))t.setELP(this.cachedEnterableLooseForEnd.get(e));else{for(let r of this.LooseTree.AllHitItems_(e))C.PointRelativeToCurveLocation(e,r)===el.Inside&&t.AddEnterableLoosePolyline(r);this.cachedEnterableLooseForEnd.set(e,t.getELP())}}AddTightEnterableForEnd(e){let t=this.PointToStations.get(e);for(let r of this.TightTree.AllHitItems_(e))C.PointRelativeToCurveLocation(e,r)===el.Inside&&t.AddEnterableTightPolyline(r)}InitNodeEnterableTightPolylines(e,t){let r=null!=this.EdgeTightEnterable?this.EdgeTightEnterable.get(t):new Set;for(let t=e.Polyline.startPoint.next;null!=t&&null!=t.next;t=t.next){let e=this.PointToStations.get(t.point),i=e.EnterableTightPolylines;null!=i?e.EnterableTightPolylines=eF(i,r):e.EnterableTightPolylines=new Set(r)}this.AddTightEnterableForMetrolineStartEndPoints(e)}SortAllNeighbors(){for(let e of this.Stations)this.SortNeighbors(e)}SortNeighbors(e){if(e.Neighbors.length<=2)return;let t=e.Neighbors[0].Position,r=e.Position;e.Neighbors.sort((e,i)=>sp(t.sub(r),e.Position.sub(r),i.Position.sub(r)))}InitEdgeIjInfos(){for(let e of this.metrolines){let t;let r=e.Polyline,i=this.PointToStations.get(r.start);for(let r=e.Polyline.startPoint;null!=r.next;r=r.next,i=t){t=this.PointToStations.get(r.next.point);let n=this.GetUnorderedIjInfo(i,t);n.Width+=e.Width,n.Metrolines.push(e)}}}InitializeCdtInfo(){let e=this.cdt.getRectangleNodeOnTriangles();for(let t of this.Stations)t.cdtTriangle=e.FirstHitNodeWithPredicate(t.Position,sc.testPointInside).UserData}PointIsAcceptableForEdge(e,t){if(null==this.LoosePolylineOfPort)return!0;let r=e.sourceAndTargetLoosePolylines();return C.PointRelativeToCurveLocation(t,r[0])===el.Outside&&C.PointRelativeToCurveLocation(t,r[1])===el.Outside}}function sp(e,t,r){let i=g.crossProduct(e,r),n=e.dot(r),s=g.crossProduct(e,t),o=e.dot(t);if(c(s,0)&&function(e,t){return f(e,t)>=0}(o,0))return c(i,0)&&function(e,t){return f(e,t)>=0}(n,0)?0:1;return c(i,0)&&function(e,t){return f(e,t)>=0}(n,0)?-1:c(s,0)||c(i,0)||s*i>0?f(g.crossProduct(r,t),0):-f(Math.sign(s),0)}function sg(e,t){return f(e,t)>=0}class sm{constructor(e,t){this.metroGraphData=e,this.bundlingSettings=t}static InkError(e,t,r){return(e-t)*r.InkImportance}static PathLengthsError(e,t,r,i){return(e-t)*(i.PathLengthImportance/r)}static RError(e,t,r){return e<=t?0:r.HubRepulsionImportance*((1-t/e)*(e-t))}static BundleError(e,t,r){return e<=t?0:r.BundleRepulsionImportance*((1-t/e)*(e-t))}static Cost(e,t){let r=t.InkImportance*e.Ink;for(let i of e.Metrolines)r+=t.PathLengthImportance*i.Length/i.IdealLength;return r+=this.CostOfForces(e)}static CostOfForces(e){let t=0;for(let r of e.VirtualStations())t+=r.cachedRadiusCost;for(let r of e.VirtualEdges()){let i=r[0],n=r[1];t+=e.GetIjInfo(i,n).cachedBundleCost}return t}InkGain(e,t){let r=this.metroGraphData.Ink,i=this.metroGraphData.Ink;for(let r of e.Neighbors){let n=r.Position;i-=n.sub(e.Position).length,i+=n.sub(t).length}return sm.InkError(r,i,this.bundlingSettings)}PathLengthsGain(e,t){let r=0;for(let i of this.metroGraphData.MetroNodeInfosOfNode(e)){let n=i.Metroline.Length,s=i.PolyPoint.prev.point,o=i.PolyPoint.next.point,a=i.Metroline.Length+o.sub(t).length+s.sub(t).length-o.sub(e.Position).length-s.sub(e.Position).length;r+=sm.PathLengthsError(n,a,i.Metroline.IdealLength,this.bundlingSettings)}return r}RadiusGain(e,t){let r;return r=0+e.cachedRadiusCost-this.RadiusCost(e,t)}RadiusCost(e,t){let r;r=g.closeDistEps(e.Position,t)?e.cachedIdealRadius:su.CalculateIdealHubRadiusWithNeighborsMBNP(this.metroGraphData,this.bundlingSettings,e,t);let i={touchedObstacles:[]};if(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesSPNBA(e,t,r,i))return sm.Inf;let n=0;for(let e of i.touchedObstacles){let i=e[1].sub(t).length;n+=sm.RError(r,i,this.bundlingSettings)}return n}BundleGain(e,t){let r=e.cachedBundleCost;for(let i of e.Neighbors){let n=this.BundleCost(e,i,t);if(f(n,sm.Inf)>=0)return-sm.Inf;r-=n}return r}BundleCost(e,t,r){let i=this.metroGraphData.GetWidthSSN(e,t,this.bundlingSettings.EdgeSeparation),n={closestDist:[]};if(!this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(e,t,r,t.Position,i,n))return sm.Inf;let s=0;for(let e of n.closestDist){let t=e[0].sub(e[1]).length;s+=sm.BundleError(i/2,t,this.bundlingSettings)}return s}}sm.Inf=1e9;class sv{get Polylines(){return Array.from(this.polylineToEdgeGeom.keys())}constructor(e){this.polylineToEdgeGeom=new Map,this.pathsThroughPoints=new t_,this.interestingPoints=new eN,this.metroGraphData=e}Run(){this.Init(),this.SwitchFlips()}Init(){for(let e of this.metroGraphData.Edges)this.polylineToEdgeGeom.set(e.curve,e);for(let e of this.Polylines)this.RegisterPolylinePointInPathsThrough(e.polylinePoints())}RegisterPolylinePointInPathsThrough(e){for(let t of e)this.RegisterPolylinePointInPathsThroughP(t)}RegisterPolylinePointInPathsThroughP(e){(function(e,t,r){let i=e.get(t);!i&&(i=new Set,e.set(t,i)),i.add(r)})(this.pathsThroughPoints,e.point,e)}UnregisterPolylinePointsInPathsThrough(e){for(let t of e)this.UnregisterPolylinePointInPathsThrough(t)}UnregisterPolylinePointInPathsThrough(e){(function(e,t,r){let i=e.get(t);i&&(i.delete(r),0===i.size&&e.deleteP(t))})(this.pathsThroughPoints,e.point,e)}SwitchFlips(){let e=new Set(this.Polylines),t=new eq.Queue;for(let e of this.Polylines)t.enqueue(e);for(;t.length>0;){let r=t.dequeue();e.delete(r);let i=this.ProcessPolyline(r);null!=i&&(!e.has(r)&&(e.add(r),t.enqueue(r)),!e.has(i)&&(e.add(i),t.enqueue(i)))}}ProcessPolyline(e){let t=new Map;for(let r=e.startPoint.next;null!=r;r=r.next)for(let e of(this.FillDepartedPolylinePoints(r,t),this.pathsThroughPoints.get(r.point))){let i=t.get(e.polyline);if(i){if(this.ProcessFlip(r,i))return e.polyline;t.delete(e.polyline)}}return null}FillDepartedPolylinePoints(e,t){let r=e.prev.point;for(let i of this.pathsThroughPoints.get(r))!this.IsNeighborOnTheSamePolyline(i,e)&&!t.has(i.polyline)&&t.set(i.polyline,i)}ProcessFlip(e,t){let r=e.polyline,i=t.polyline,n=e.point,s=t.point,o=this.polylineToEdgeGeom.get(r),a=this.polylineToEdgeGeom.get(i);if(o.lineWidth!==a.lineWidth||null==this.metroGraphData.EdgeLooseEnterable||!eG(this.metroGraphData.EdgeLooseEnterable.get(o),this.metroGraphData.EdgeLooseEnterable.get(a)))return!1;let l=this.FindPointsOnPolyline(r,n,s),h=l[0],u=l[1],c=l[2],d=(l=this.FindPointsOnPolyline(i,n,s))[0],f=l[1],p=l[2],g=this.FindRelationOnFirstPoint(h,d,c,p),m=this.FindRelationOnLastPoint(u,f,c,p);return(2===g||2===m)&&1!==g&&1!==m&&(this.UnregisterPolylinePointsInPathsThrough(r.polylinePoints()),this.UnregisterPolylinePointsInPathsThrough(i.polylinePoints()),this.Swap(h,d,u,f,c,p),this.RegisterPolylinePointInPathsThrough(r.polylinePoints()),this.RegisterPolylinePointInPathsThrough(i.polylinePoints()),this.RegisterInterestingPoint(h.point),this.RegisterInterestingPoint(u.point),this.numberOfReducedCrossings++,!0)}FindPointsOnPolyline(e,t,r){let i,n;for(let s=e.startPoint;null!=s;s=s.next)if(null==i){if(s.point.equal(t)){if(null!=n)return[s,n,!1];i=s}else null==n&&s.point.equal(r)&&(n=s)}else if(s.point.equal(r))return[i,s,!0]}PolylinePointsAreInForwardOrder(e,t){for(let r=e;null!=r;r=r.next)if(r===t)return!0;return!1}Next(e,t){return t?e.next:e.prev}Prev(e,t){return t?e.prev:e.next}FindRelationOnFirstPoint(e,t,r,i){let n=e,s=t;for(;;){let n=this.Prev(e,r),s=this.Prev(t,i);if(null==n||null==s)return 0;if(!n.point.equal(s.point))break;e=n,t=s}return this.PolylinesIntersect(n,s,e,t,r,i)}FindRelationOnLastPoint(e,t,r,i){let n=e,s=t;for(;;){let n=this.Next(e,r),s=this.Next(t,i);if(null==n||null==s)return 0;if(!n.point.equal(s.point))break;e=n,t=s}for(;this.Next(e,r).point.equal(this.Prev(t,i).point);)e=this.Next(e,r),t=this.Prev(t,i);return this.PolylinesIntersect(e,t,n,s,r,i)}PolylinesIntersect(e,t,r,i,n,s){let o=this.Prev(e,n),a=this.Next(e,n),l=this.Next(r,n),h=this.Prev(r,n),u=this.Next(t,s),c=this.Prev(i,s);if(e.point.equal(r.point)){let t=e.point,r=sp(h.point.sub(t),c.point.sub(t),a.point.sub(t));return r===sp(h.point.sub(t),u.point.sub(t),a.point.sub(t))?1:2}{let t=sp(o.point.sub(e.point),a.point.sub(e.point),u.point.sub(e.point));return t===sp(l.point.sub(r.point),c.point.sub(r.point),h.point.sub(r.point))?1:2}}Swap(e,t,r,i,n,s){let o=this.GetRangeOnPolyline(this.Next(e,n),r,n),a=this.GetRangeOnPolyline(this.Next(t,s),i,s);this.ChangePolylineSegment(e,r,n,a),this.ChangePolylineSegment(t,i,s,o),sb.RemoveSelfCyclesFromPolyline(e.polyline),sb.RemoveSelfCyclesFromPolyline(t.polyline)}ChangePolylineSegment(e,t,r,i){let n=e;for(let e of i){let t=m.mkFromPoint(e.point);t.polyline=n.polyline,r?(t.prev=n,n.next=t):(t.next=n,n.prev=t),n=t}r?(n.next=t,t.prev=n):(n.prev=t,t.next=n)}GetRangeOnPolyline(e,t,r){let i=[];for(let n=e;n!==t;n=this.Next(n,r))i.push(n);return i}IsNeighborOnTheSamePolyline(e,t){return null!=e.prev&&e.prev.point.equal(t.point)||null!=e.next&&e.next.point.equal(t.point)}RegisterInterestingPoint(e){!this.interestingPoints.has(e)&&this.interestingPoints.add(e)}GetChangedHubs(){return this.interestingPoints}NumberOfReducedCrossings(){return this.numberOfReducedCrossings}PolylineIsOK(e){let t=new eN;for(let r=e.startPoint;null!=r;r=r.next){if(r===e.startPoint){if(null!=r.prev)return!1}else if(r.prev.next!==r)return!1;if(r===e.endPoint){if(null!=r.next)return!1}else if(r.next.prev!==r)return!1;if(t.has(r.point))return!1;t.add(r.point)}return null==e.startPoint.prev&&null==e.endPoint.next&&!0}}class sb{constructor(e,t){this.foundCrossings=new eN,this.crossingsThatShouldBecomeHubs=new eN,this.metroGraphData=e,this.polylineAcceptsPoint=t}*Vertices(){for(let e of this.Polylines)for(let t of e.polylinePoints())yield t}get Polylines(){return this.metroGraphData.Edges.map(e=>e.curve)}Edges(){let e=new rE;for(let t of this.Vertices())t.next&&e.set(new ek(t.point,t.next.point),0);return Array.from(e.keys())}run(){if(0===this.metroGraphData.Edges.length)return!1;let e=new rE,t=new te(null);for(let e of this.Vertices()){let r=M.mkOnPoints([e.point]);r.pad(l.intersectionEpsilon),t.Add(r,e.point)}let r=eI(this.Edges(),e=>M.mkPP(e.first,e.second));tJ(r,r,(r,i)=>this.IntersectTwoEdges.bind(r,i,e,t)),this.SortInsertedPoints(e);let i=this.InsertPointsIntoPolylines(e),n=this.FixPaths(),s=this.RemoveUnimportantCrossings();return n||i||s}FixPaths(){let e=!1;return this.RemoveSelfCycles()&&(e=!0),this.ReduceEdgeCrossings()&&(e=!0),e}SortInsertedPoints(e){for(let t of e)this.SortInsideSegment(t[0],t[1])}SortInsideSegment(e,t){t.sort((t,r)=>h(p(t,e.first),p(r,e.first)))}InsertPointsIntoPolylines(e){let t=!1;for(let r of this.metroGraphData.Metrolines)return this.InsertPointsIntoPolyline(r,e)&&(t=!0),t}InsertPointsIntoPolyline(e,t){let r=!1;for(let i=e.Polyline.startPoint;null!=i.next;i=i.next)this.InsertPointsOnPolypoint(i,t,e)&&(r=!0);return r}InsertPointsOnPolypoint(e,t,r){let i=new ek(e.point,e.next.point),n=e.point!==i.first,s=t.get(i);if(!s)return!1;let o=e.next,a=e.polyline;if(n)for(let t=s.length-1;t>=0;t--){if(null!=this.polylineAcceptsPoint&&!this.polylineAcceptsPoint(r,s[t]))continue;let i=m.mkFromPoint(s[t]);i.prev=e,i.polyline=a,e.next=i,e=i}else for(let t=0;t<s.length;t++){if(null!=this.polylineAcceptsPoint&&!this.polylineAcceptsPoint(r,s[t]))continue;let i=m.mkFromPoint(s[t]);i.prev=e,i.polyline=a,e.next=i,e=i}return e.next=o,o.prev=e,!0}RemoveSelfCycles(){let e=!1;for(let t of this.Polylines)sb.RemoveSelfCyclesFromPolyline(t)&&(e=!0);return e}static RemoveSelfCyclesFromPolyline(e){let t=!1,r=new t_;for(let i=e.startPoint;null!=i;i=i.next){let e=i.point,n=r.get(e);if(n){for(let e=n.next;e!==i.next;e=e.next)r.deleteP(e.point);n.next=i.next,i.next.prev=n,t=!0}else r.set(i.point,i)}return t}ReduceEdgeCrossings(){let e=new sv(this.metroGraphData);for(let t of(e.Run(),e.GetChangedHubs()))this.crossingsThatShouldBecomeHubs.add(t);return e.NumberOfReducedCrossings()>0}RemoveUnimportantCrossings(){let e=!1;for(let t of(this.pointsToDelete=function(e,t){let r=new eN;for(let i of e)!t.has(i)&&r.add(i);return r}(this.foundCrossings,this.crossingsThatShouldBecomeHubs),this.Polylines))this.RemoveUnimportantCrossingsFromPolyline(t)&&(e=!0);return e}RemoveUnimportantCrossingsFromPolyline(e){let t=!1;for(let r=e.startPoint.next;null!=r&&null!=r.next;r=r.next)if(this.pointsToDelete.has(r.point)&&g.getTriangleOrientation(r.prev.point,r.point,r.next.point)===eo.Collinear){let e=r.prev,i=r.next;e.next=i,i.prev=e,r=e,t=!0}return t}IntersectTwoEdges(e,t,r,i){let n=b.IntersectPPPP(e.first,e.second,t.first,t.second);if(n){let s=this.FindExistingVertexOrCreateNew(i,n);(this.AddVertexToSplittingList(e,r,s)||this.AddVertexToSplittingList(t,r,s))&&this.foundCrossings.add(s)}}FindExistingVertexOrCreateNew(e,t){let r=e.RootNode.FirstHitNode(t);if(null!=r)return r.UserData;let i=M.mkOnPoints([t]);return i.pad(l.intersectionEpsilon),e.Add(i,t),t}AddVertexToSplittingList(e,t,r){if(!C.closeIntersectionPoints(r,e.first)&&!C.closeIntersectionPoints(r,e.second)){let i=t.get(e);if(!i&&(i=[],t.set(e,i)),!i.find(e=>e.equal(r)))return i.push(r),!0}return!1}}class sy{isCorrectlyOrienected(){return g.getTriangleOrientation(this.Curve.boundingBox.center,this.Curve.value(this.parEnd),this.Curve.value(this.parStart))!==eo.Counterclockwise}get Count(){return this.points.length}constructor(e,t,r,i){this.BelongsToRealNode=i,this.Curve=t,this.Position=r,this.points=Array(e),this.tangents=Array(e),this.OrientedHubSegments=Array(e)}get CurveCenter(){return this.Curve.boundingBox.center}get OppositeBase(){return null!=this.OutgoingBundleInfo?this.OutgoingBundleInfo.TargetBase:this.IncomingBundleInfo.SourceBase}get length(){return this.points.length}get Points(){return this.points}get Tangents(){return this.tangents}get InitialMidParameter(){return this.initialMidParameter}set InitialMidParameter(e){this.initialMidParameter=e,this.InitialMidPoint=this.Curve.value(e)}get ParStart(){return this.parStart}set ParStart(e){this.parStart=e,this.StartPoint=this.Curve.value(this.parStart)}get ParEnd(){return this.parEnd}set ParEnd(e){this.parEnd=e,this.EndPoint=this.Curve.value(this.parEnd)}get ParMid(){return(this.parStart+this.parEnd)/2}get MidPoint(){return g.middle(this.StartPoint,this.EndPoint)}get Span(){return this.SpanBetweenTwoParameters(this.parStart,this.parEnd)}SpanBetweenTwoParameters(e,t){return e<=t?t-e:t-e+L(this.Curve)}RotateLeftPoint(e,t){return 0===e?this.EndPoint:this.RotatePoint(e,this.parEnd,t)}RotateRigthPoint(e,t){return 0===e?this.StartPoint:this.RotatePoint(e,this.parStart,t)}RotatePoint(e,t,r){let i=L(this.Curve)*r;return t+=e*i,t=this.AdjustParam(t),this.Curve.value(t)}AdjustParam(e){return e>this.Curve.parEnd?e=this.Curve.parStart+(e-this.Curve.parEnd):e<this.Curve.parStart&&(e=this.Curve.parEnd-(this.Curve.parStart-e)),e}RotateBy(e,t,r){let i=L(this.Curve)*r;0!==e&&(this.ParStart=this.AdjustParam(this.ParStart+e*i)),0!==t&&(this.ParEnd=this.AdjustParam(this.ParEnd+t*i))}RelativeOrderOfBasesIsPreserved(e,t,r){let i=L(this.Curve)*r,n=this.parStart+e*i,s=this.parStart<this.parEnd?this.parEnd+t*i:this.parEnd+L(this.Curve)+t*i;if(n>s||this.SpanBetweenTwoParameters(n,s)>L(this.Curve)/2)return!1;if(null==this.Prev||this.SpanBetweenTwoParameters(this.Prev.ParMid,this.ParMid)>i&&this.SpanBetweenTwoParameters(this.ParMid,this.Next.ParMid)>i)return!0;let o=this.RotateLeftPoint(t,r),a=this.RotateRigthPoint(e,r),l=g.middle(o,a),h=this.MidPoint;return g.getTriangleOrientation(this.CurveCenter,this.Prev.MidPoint,h)==g.getTriangleOrientation(this.CurveCenter,this.Prev.MidPoint,l)&&g.getTriangleOrientation(this.CurveCenter,this.Next.MidPoint,h)==g.getTriangleOrientation(this.CurveCenter,this.Next.MidPoint,l)&&!0}}class sx{constructor(e,t,r,i){this.SourceBase=e,this.TargetBase=t,this.obstaclesToIgnore=r,this.HalfWidthArray=i,this.TotalRequiredWidth=2*this.HalfWidthArray.reduce((e,t)=>e+t,0),this.longEnoughSideLength=e.Curve.boundingBox.addRec(t.Curve.boundingBox).diagonal;let n=Math.max(e.Curve.boundingBox.diagonal,t.Curve.boundingBox.diagonal);if(this.TotalRequiredWidth>n){let e=this.TotalRequiredWidth/n;for(let t=0;t<this.HalfWidthArray.length;t++)this.HalfWidthArray[t]/=e;this.TotalRequiredWidth/=e}}SetParamsFeasiblySymmetrically(e){this.CalculateTightObstaclesForBundle(e,this.obstaclesToIgnore),this.SetEndParamsSymmetrically()}CalculateTightObstaclesForBundle(e,t){let r=this.SourceBase.Curve.boundingBox.diagonal/2,i=this.TargetBase.Curve.boundingBox.diagonal/2,n=ss.Create4gon(this.SourceBase.Position,this.TargetBase.Position,2*r,2*i);this.tightObstaclesInTheBoundingBox=Array.from(e.AllHitItems(n.boundingBox,e=>!t.has(e)&&C.ClosedCurveInteriorsIntersect(n,e)))}SetEndParamsSymmetrically(){let e=this.TargetBase.Position,t=this.SourceBase.Position,r=e.sub(t).normalize(),i=r.rotate90Ccw(),n=g.middle(e,t),s=r.mul(this.longEnoughSideLength),o=n.add(s),a=n.sub(s);if(this.SetRLParamsIfWidthIsFeasible(i.mul(this.TotalRequiredWidth/2),o,a)){this.SetInitialMidParams();return}let l=this.TotalRequiredWidth,h=0,u=l/2;for(;l-h>sx.FeasibleWidthEpsilon;)this.SetRLParamsIfWidthIsFeasible(i.mul(u/2),o,a)?h=u:l=u,u=.5*(l+h);u<=sx.FeasibleWidthEpsilon&&(this.SetRLParamsIfWidthIsFeasible_(i.mul(sx.FeasibleWidthEpsilon),new g(0,0),o,a)||this.SetRLParamsIfWidthIsFeasible_(new g(0,0),i.mul(-sx.FeasibleWidthEpsilon),o,a))&&(u=2*sx.FeasibleWidthEpsilon),this.SourceBase.InitialMidParameter=this.SourceBase.AdjustParam(this.SourceBase.ParStart+this.SourceBase.Span/2),this.TargetBase.InitialMidParameter=this.TargetBase.AdjustParam(this.TargetBase.ParStart+this.TargetBase.Span/2)}mkNameFromLRST(){return"./tmp/leftRight"+this.SourceBase.Position.toString()+"_"+this.TargetBase.Position.toString()+".svg"}SetRLParamsIfWidthIsFeasible(e,t,r){return this.SetRLParamsIfWidthIsFeasible_(e,e.neg(),t,r)}SetRLParamsIfWidthIsFeasible_(e,t,r,i){let n={par:0},s={par:0},o={par:0},a={par:0},l=this.TrimSegWithBoundaryCurves(b.mkPP(r.add(e),i.add(e)),s,o);return!(null==l||this.tightObstaclesInTheBoundingBox.find(e=>null!=C.intersectionOne(l,e,!1))||null==(l=this.TrimSegWithBoundaryCurves(b.mkPP(r.add(t),i.add(t)),a,n))||this.tightObstaclesInTheBoundingBox.find(e=>null!=C.intersectionOne(l,e,!1)))&&(this.SourceBase.IsParent?(this.SourceBase.ParStart=s.par,this.SourceBase.ParEnd=a.par):(this.SourceBase.ParStart=a.par,this.SourceBase.ParEnd=s.par),this.TargetBase.IsParent?(this.TargetBase.ParStart=n.par,this.TargetBase.ParEnd=o.par):(this.TargetBase.ParStart=o.par,this.TargetBase.ParEnd=n.par),!0)}SetInitialMidParams(){let e={par:0},t={par:0};null!=this.TrimSegWithBoundaryCurves(b.mkPP(this.TargetBase.CurveCenter,this.TargetBase.CurveCenter),t,e)?(this.SourceBase.InitialMidParameter=t.par,this.TargetBase.InitialMidParameter=e.par):(this.SourceBase.InitialMidParameter=this.SourceBase.AdjustParam(this.SourceBase.ParStart+this.SourceBase.Span/2),this.TargetBase.InitialMidParameter=this.TargetBase.AdjustParam(this.TargetBase.ParStart+this.TargetBase.Span/2))}mkNameFromST(){return"./tmp/mparam"+this.SourceBase.Position.toString()+"_"+this.TargetBase.Position.toString()+".svg"}TrimSegWithBoundaryCurves(e,t,r){let i,n,s=C.getAllIntersections(e,this.SourceBase.Curve,!0);return 0===s.length?(r.par=0,t.par=0,null):(i=1===s.length?s[0]:this.SourceBase.IsParent?s[0].par0<s[1].par0?s[1]:s[0]:s[0].par0<s[1].par0?s[0]:s[1],0===(s=C.getAllIntersections(e,this.TargetBase.Curve,!0)).length)?(r.par=0,t.par=0,null):(n=1===s.length?s[0]:this.TargetBase.IsParent?s[0].par0>s[1].par0?s[1]:s[0]:s[0].par0>s[1].par0?s[0]:s[1],t.par=i.par1,r.par=n.par1,b.mkPP(i.x,n.x))}RotateBy(e,t,r,i,n){let s=0!==e||0!==t,o=0!==r||0!==i;s&&this.SourceBase.RotateBy(e,t,n),o&&this.TargetBase.RotateBy(r,i,n),this.UpdateSourceAndTargetBases(s,o)}UpdateSourceAndTargetBases(e,t){e&&this.UpdatePointsOnBundleBase(this.SourceBase),t&&this.UpdatePointsOnBundleBase(this.TargetBase),this.UpdateTangentsOnBases()}UpdateTangentsOnBases(){let e=this.TargetBase.length;for(let t=0;t<e;t++){let r=this.TargetBase.Points[t].sub(this.SourceBase.Points[e-1-t]),i=r.length;i>=l.tolerance&&(r=r.div(i),this.TargetBase.Tangents[t]=r,this.SourceBase.Tangents[e-1-t]=r.neg())}}UpdatePointsOnBundleBase(e){let t=e.length,r=e.Points,i=b.mkPP(e.EndPoint,e.StartPoint),n=1/this.TotalRequiredWidth,s=this.HalfWidthArray[0];r[0]=i.value(s*n);for(let e=1;e<t;e++)s+=this.HalfWidthArray[e-1]+this.HalfWidthArray[e],r[e]=i.value(s*n)}RotationIsLegal(e,t,r,i,n){if(this.SourceBase.IsParent||this.TargetBase.IsParent){if(0!==t||0!==i){let e=this.SourceBase.RotateLeftPoint(t,n),r=this.TargetBase.RotateLeftPoint(i,n);if(!this.LineIsLegal(e,r))return!1}if(0!==e||0!==r){let t=this.SourceBase.RotateRigthPoint(e,n),i=this.TargetBase.RotateRigthPoint(r,n);if(!this.LineIsLegal(t,i))return!1}}else{if(0!==t||0!==r){let e=this.SourceBase.RotateLeftPoint(t,n),i=this.TargetBase.RotateRigthPoint(r,n);if(!this.LineIsLegal(e,i))return!1}if(0!==e||0!==i){let t=this.SourceBase.RotateRigthPoint(e,n),r=this.TargetBase.RotateLeftPoint(i,n);if(!this.LineIsLegal(t,r))return!1}}return!!((0===e&&0===t||this.SourceBase.RelativeOrderOfBasesIsPreserved(e,t,n))&&(0===r&&0===i||this.TargetBase.RelativeOrderOfBasesIsPreserved(r,i,n)))||!1}LineIsLegal(e,t){return null==this.tightObstaclesInTheBoundingBox.find(r=>null!=C.intersectionOne(b.mkPP(e,t),r,!1))}}sx.FeasibleWidthEpsilon=.1;class s_{get Segment(){return this.segment}set Segment(e){this.segment=e}constructor(e,t,r,i){this.Segment=e,this.Reversed=t,this.Index=r,this.BundleBase=i}value(e){return this.Reversed?this.Segment.value(this.Segment.parEnd-e):this.Segment.value(e)}}class sS{constructor(e,t,r){this.fixedBundles=new Set,this.stepsWithProgress=0,this.metroOrdering=e,this.metroGraphData=t,this.bundlingSettings=r}Run(){this.AllocateBundleBases(),this.SetBasesRightLeftParamsToTheMiddles(),this.bundlingSettings.KeepOverlaps?(this.UpdateSourceAndTargetBases(),this.CreateOrientedSegs()):(this.SetRightLeftParamsFeasiblySymmetrically(),this.AdjustStartEndParamsToAvoidBaseOverlaps(),this.UpdateSourceAndTargetBases(),this.CreateOrientedSegs(),this.bundlingSettings.RotateBundles&&this.RotateBundlesToDiminishCost(),this.AdjustStartEndParamsToAvoidBaseOverlaps(),this.UpdateSourceAndTargetBases())}AllocateBundleBases(){for(let e of(this.externalBases=new Map,this.internalBases=new Map,this.Bundles=[],this.metroGraphData.Stations))null==e.BoundaryCurve&&(e.BoundaryCurve=T.mkCircle(e.Radius,e.Position));for(let e of this.metroGraphData.Stations)for(let t of e.Neighbors)if(e.SerialNumber<t.SerialNumber){let r=new sy(this.metroGraphData.RealEdgeCount(e,t),e.BoundaryCurve,e.Position,e.IsReal);e.BundleBases.set(t,r);let i=new sy(this.metroGraphData.RealEdgeCount(e,t),t.BoundaryCurve,t.Position,t.IsReal);t.BundleBases.set(e,i),C.PointRelativeToCurveLocation(t.Position,e.BoundaryCurve)!==el.Outside?(r.IsParent=!0,ej(this.internalBases,e,r),ej(this.externalBases,t,i)):C.PointRelativeToCurveLocation(e.Position,t.BoundaryCurve)!==el.Outside?(i.IsParent=!0,ej(this.externalBases,e,r),ej(this.internalBases,t,i)):(ej(this.externalBases,e,r),ej(this.externalBases,t,i));let n=new sx(r,i,this.metroGraphData.tightIntersections.ObstaclesToIgnoreForBundle(e,t),Array.from(this.metroOrdering.GetOrder(e,t)).map(e=>e.Width/2));r.OutgoingBundleInfo=i.IncomingBundleInfo=n,this.Bundles.push(n)}this.SetBundleBaseNeighbors()}SetBundleBaseNeighbors(){for(let e of this.externalBases.keys()){let t=this.externalBases.get(e);this.SortBundlesCounterClockwise(t),this.SetLeftRightBases(t)}for(let e of this.internalBases.keys()){let t=this.internalBases.get(e);this.SortBundlesCounterClockwise(t),this.SetLeftRightBases(t)}}SortBundlesCounterClockwise(e){if(e.length>2){let t=e[0].OppositeBase.Position,r=e[0].CurveCenter;e.sort((e,i)=>sp(t.sub(r),e.OppositeBase.Position.sub(r),i.OppositeBase.Position.sub(r)))}}SetLeftRightBases(e){let t=e.length;if(!(t<=1))for(let r=0;r<t;r++)e[r].Prev=e[(r-1+t)%t],e[r].Next=e[(r+1)%t]}CreateOrientedSegs(){for(let e of this.metroGraphData.Metrolines)this.CreateOrientedSegsOnLine(e)}CreateOrientedSegsOnLine(e){for(let t=e.Polyline.startPoint.next;null!=t.next;t=t.next)this.CreateOrientedSegsOnLineVertex(e,t)}CreateOrientedSegsOnLineVertex(e,t){let r=this.metroGraphData.PointToStations.get(t.prev.point),i=this.metroGraphData.PointToStations.get(t.point),n=this.metroGraphData.PointToStations.get(t.next.point),s=i.BundleBases.get(r),o=i.BundleBases.get(n),a=this.metroOrdering.GetLineIndexInOrder(r,i,e),l=this.metroOrdering.GetLineIndexInOrder(n,i,e),h=s.OrientedHubSegments[a]=new s_(null,!1,a,s),u=o.OrientedHubSegments[l]=new s_(null,!0,l,o);u.Other=h,h.Other=u}UpdateSourceAndTargetBases(){for(let e of this.Bundles)e.UpdateSourceAndTargetBases(!0,!0)}SetBasesRightLeftParamsToTheMiddles(){for(let e of this.Bundles){let t=e.SourceBase,r=e.TargetBase;t.ParEnd=t.ParStart=this.GetBaseMiddleParamInDirection(t,t.Position,r.Position),r.ParEnd=r.ParStart=this.GetBaseMiddleParamInDirection(r,r.Position,t.Position)}}GetBaseMiddleParamInDirection(e,t,r){let i=e.Curve;if(i instanceof T&&i.isArc())return g.angle(i.aAxis,r.sub(t));for(let e of C.getAllIntersections(i,b.mkPP(t,r),!0)){let i=e.x;if(0>=i.sub(t).dot(i.sub(r)))return e.par0}throw Error()}SetRightLeftParamsFeasiblySymmetrically(){for(let e of this.Bundles)e.SetParamsFeasiblySymmetrically(this.metroGraphData.TightTree)}AdjustStartEndParamsToAvoidBaseOverlaps(){for(let e of this.externalBases.values())this.AdjustCurrentBundleWidthsOnCurve(e);for(let e of this.internalBases.values())this.AdjustCurrentBundleWidthsOnCurve(e)}AdjustCurrentBundleWidthsOnCurve(e){let t=e.length;if(!(t<=1))for(let r=0;r<t;r++){let t=e[r],i=t.Next;this.ShrinkBasesToMakeTwoConsecutiveNeighborsHappy(t,i)}}ShrinkBasesToMakeTwoConsecutiveNeighborsHappy(e,t){let r=function(e,t){let r=L(e.Curve),i=e.ParEnd,n=e.ParStart<e.ParEnd?e.ParStart:e.ParStart-r,s=t.ParEnd,o=t.ParStart<t.ParEnd?t.ParStart:t.ParStart-r;i>s?i-o>r&&(o+=r,s+=r):s-n>r&&(n+=r,i+=r);let a=Math.min(i,s),l=Math.max(n,o);return l<=a?{start:l,end:a,rbaseMiddle:(n+i)/2,lbaseMiddle:(o+s)/2}:null}(e,t);if(null==r||c(r.start,r.end))return;let i=r.rbaseMiddle;if(i<r.lbaseMiddle){let r=e;e=t,t=r}let n=e.Span,s=t.Span,o=(r.end*n+r.start*s)/(s+n);e.ParStart=e.AdjustParam(o+l.distanceEpsilon),t.ParEnd=t.AdjustParam(o-l.distanceEpsilon)}RegularCut(e,t,r,i,n,s){let o=(n*i+s*e)/(n+s),a=Math.min(t,i),l=Math.max(e,r);return o<l&&(o=l),o>a&&(o=a),o}RotateBundlesToDiminishCost(){let e=sS.MaxParameterChange,t={cost:this.Cost()},r=0;for(;r++<sS.MaxIterations;){let r=t.cost;if(this.RotateBundlesToDiminishCostOneIteration(e,t),(e=this.UpdateParameterChange(e,r,t.cost))<sS.MinParameterChange)break}}UpdateParameterChange(e,t,r){return r+1<t?(this.stepsWithProgress++,this.stepsWithProgress>=5&&(this.stepsWithProgress=0,this.fixedBundles.clear())):(this.stepsWithProgress=0,e*=.8,this.fixedBundles.clear()),e}RotateBundlesToDiminishCostOneIteration(e,t){let r=!1;for(let i of this.Bundles)!this.fixedBundles.has(i)&&(this.OptimizeBundle(i,e,t)?r=!0:this.fixedBundles.add(i));return r}OptimizeBundle(e,t,r){let i=this.CostBi(e);if(i<sS.CostThreshold)return!1;let n=0,s=-1,o=-1;for(let r=0;r<sS.Deltas.length-1;r++){let a=this.DeltaWithChangedAngles(sS.Deltas[r][0],sS.Deltas[r][1],0,0,e,i,t);a>sS.CostDeltaThreshold&&a>n&&(o=r,s=sS.Deltas.length-1,n=a),(a=this.DeltaWithChangedAngles(0,0,sS.Deltas[r][0],sS.Deltas[r][1],e,i,t))>sS.CostDeltaThreshold&&a>n&&(o=sS.Deltas.length-1,s=r,n=a)}return!(n<sS.CostDeltaThreshold)&&(r.cost-=n,e.RotateBy(sS.Deltas[o][0],sS.Deltas[o][1],sS.Deltas[s][0],sS.Deltas[s][1],t),!0)}DeltaWithChangedAngles(e,t,r,i,n,s,o){if(!n.RotationIsLegal(e,t,r,i,o))return 0;n.RotateBy(e,t,r,i,o);let a=this.CostBN(n,s);return n.RotateBy(-1*e,-1*t,-1*r,-1*i,o),s-a}CostBi(e){return sS.SeparationCoeff*this.SeparationCost(e)+(sS.SqueezeCoeff*this.SqueezeCost(e)+(sS.AssymetryCoeff*this.AssymetryCost(e)+sS.CenterCoeff*this.CenterCostBi(e)))}CostBN(e,t){let r;return(r=0+sS.CenterCoeff*this.CenterCostBi(e))>t||(r+=sS.SeparationCoeff*this.SeparationCost(e))>t||(r+=sS.SqueezeCoeff*this.SqueezeCost(e))>t?r:r+=sS.AssymetryCoeff*this.AssymetryCost(e)}SqueezeCost(e){let t=e.TargetBase.MidPoint.sub(e.SourceBase.MidPoint).normalize().rotate90Ccw(),r=Math.abs(e.SourceBase.StartPoint.sub(e.SourceBase.EndPoint).dot(t)),i=Math.abs(e.TargetBase.StartPoint.sub(e.TargetBase.EndPoint).dot(t)),n=Math.abs(e.TotalRequiredWidth-r)/e.TotalRequiredWidth,s=Math.abs(e.TotalRequiredWidth-i)/e.TotalRequiredWidth,o=Math.abs(r-i)/e.TotalRequiredWidth;return Math.exp(10*n)-1+(Math.exp(10*s)-1)+o}CenterCostBi(e){return e.SourceBase.BelongsToRealNode||e.TargetBase.BelongsToRealNode?this.CenterCostBb(e.SourceBase)+this.CenterCostBb(e.TargetBase):0}CenterCostBb(e){if(!e.BelongsToRealNode)return 0;let t=e.ParMid,r=Math.min(e.InitialMidParameter,t),i=Math.max(e.InitialMidParameter,t),n=Math.min(i-r,r+(L(e.Curve)-i));return e.CurveCenter.equal(e.Position)||e.IsParent?n*n*25:n*n*500}AssymetryCost(e){return this.GetAssymetryCostForBase(e.SourceBase)+this.GetAssymetryCostForBase(e.TargetBase)}GetAssymetryCostForBase(e){if(e.BelongsToRealNode)return 0;let t=e.OppositeBase.BelongsToRealNode?200:500,r=0;for(let i of e.OrientedHubSegments){let n=i.Index,s=i.Other.Index,o=e.Points[n],a=e.Tangents[n],l=i.Other.BundleBase,h=l.Points[s],u=l.Tangents[s],c=e.Count+l.Count;r+=this.GetAssymetryCostOnData(o,a,h,u,t)/c}return r}GetAssymetryCostOnData(e,t,r,i,n){let s=e.sub(r);if(s.length<l.distanceEpsilon)return 0;let o=t.add(i).dot(s),a=g.crossProduct(s,t),h=g.crossProduct(s,i),u=a-h;return 10*(o*o+u*u)+n*(a*a+h*h)}SeparationCost(e){return this.SeparationCostForBundleBase(e.SourceBase)+this.SeparationCostForBundleBase(e.TargetBase)}SeparationCostForBundleBase(e){return null==e.Prev?0:this.SeparationCostForAdjacentBundleBases(e,e.Prev)+this.SeparationCostForAdjacentBundleBases(e,e.Next)}SeparationCostForAdjacentBundleBases(e,t){let r=e.Curve,i=this.IntervalsOverlapLength(e.ParStart,e.ParEnd,t.ParStart,t.ParEnd,r);return Math.exp(i/(10*Math.min(e.Span,t.Span)))-1}IntervalsOverlapLength(e,t,r,i,n){let s=n.parStart,o=n.parEnd;if(e<t)return r<i?this.IntersectRegularIntervals(e,t,r,i):this.IntersectRegularIntervals(e,t,r,o)+this.IntersectRegularIntervals(e,t,s,i);return r<i?this.IntersectRegularIntervals(e,o,r,i)+this.IntersectRegularIntervals(s,t,r,i):this.IntersectRegularIntervals(e,o,r,o)+this.IntersectRegularIntervals(s,t,s,i)}IntersectRegularIntervals(e,t,r,i){let n=Math.max(e,r),s=Math.min(t,i);return n<s?s-n:0}Cost(){let e=0;for(let t of this.Bundles){let r=sS.SeparationCoeff*this.SeparationCost(t),i=sS.AssymetryCoeff*this.AssymetryCost(t),n=sS.SqueezeCoeff*this.SqueezeCost(t);e+=(r+i)/2+n+sS.CenterCoeff*this.CenterCostBi(t)}return e}}sS.Deltas=[[1,-1],[1,-1]],sS.SeparationCoeff=1,sS.SqueezeCoeff=1,sS.CenterCoeff=10,sS.AssymetryCoeff=1,sS.MaxIterations=200,sS.MaxParameterChange=8/360,sS.MinParameterChange=.1/360,sS.CostThreshold=1e-5,sS.CostDeltaThreshold=.01;class sw{constructor(){this.Metrolines=[]}Add(e){this.Metrolines.push(e)}}class sT{constructor(e){this.Metrolines=e,this.BuildOrder()}*GetOrder(e,t){let r=new ek(e.Position,t.Position),i=this.bundles.get(r).Metrolines;if(e.Position===r.first)for(let e=0;e<i.length;e++)yield i[e];else for(let e=i.length-1;e>=0;e--)yield i[e]}GetLineIndexInOrder(e,t,r){let i=new ek(e.Position,t.Position),n=e.Position!==i.first,s=this.bundles.get(i).LineIndexInOrder;return n?s.size-1-s.get(r):s.get(r)}BuildOrder(){for(let e of(this.bundles=new rE,this.Metrolines))for(let t=e.Polyline.startPoint;null!=t.next;t=t.next){let r=new ek(t.point,t.next.point),i=this.bundles.get(r);!i&&this.bundles.set(r,i=new sw),i.Add(e)}for(let e of this.bundles)this.BuildOrderPP(e[0],e[1])}BuildOrderPP(e,t){if(!t.orderFixed){t.Metrolines.sort((t,r)=>this.CompareLines(t,r,e.first,e.second)),t.orderFixed=!0,t.LineIndexInOrder=new Map;for(let e=0;e<t.Metrolines.length;e++)t.LineIndexInOrder.set(t.Metrolines[e],e)}}CompareLines(e,t,r,i){let n,s;let o={polyPoint:null,next:null,prev:null};this.FindStationOnLine(r,i,e,o);let a=o.polyPoint,l=o.next,u=o.prev;this.FindStationOnLine(r,i,t,o);let c=o.polyPoint,d=o.next,f=o.prev,p=a,g=c;for(;null!=(s=u(p))&&null!=(n=f(g))&&s.point.equal(n.point);){let r=new ek(s.point,p.point);if(this.bundles.get(r).orderFixed)return this.CompareOnFixedOrder(r,e,t,!s.point.equal(r.first));p=s,g=n}if(null!=s&&null!=n){let e=p.point;return-sT.IsLeft(l(p).point.sub(e),s.point.sub(e),n.point.sub(e))}for(p=a,g=c;null!=(s=l(p))&&null!=(n=d(g))&&s.point.equal(n.point);){let r=new ek(s.point,p.point);if(this.bundles.get(r).orderFixed)return this.CompareOnFixedOrder(r,e,t,!p.point.equal(r.first));p=s,g=n}if(null!=s&&null!=n){let e=p.point;return sT.IsLeft(u(p).point.sub(e),s.point.sub(e),n.point.sub(e))}return h(e.Index,t.Index)}CompareOnFixedOrder(e,t,r,i){let n=this.bundles.get(e).LineIndexInOrder;return(i?-1:1)*h(n.get(t),n.get(r))}FindStationOnLine(e,t,r,i){for(let n=r.Polyline.startPoint;null!=n.next;n=n.next){if(n.point.equal(e)&&n.next.point.equal(t)){i.next=e=>e.next,i.prev=e=>e.prev,i.polyPoint=n;return}if(n.point.equal(t)&&n.next.point.equal(e)){i.next=e=>e.prev,i.prev=e=>e.next,i.polyPoint=n.next;return}}throw Error()}static IsLeft(e,t,r){return sp(e,t,r)}}class sP extends e0{constructor(e,t){super(null),this.metroGraphData=e,this.bundlingSettings=t}run(){this.CreateMetroOrdering(),this.InitRadii(),this.FinalizePaths()}InitRadii(){new su(this.metroGraphData,this.bundlingSettings).CreateNodeRadii()}CreateMetroOrdering(){this.metroOrdering=new sT(this.metroGraphData.Metrolines)}FinalizePaths(){this.CreateBundleBases(),this.CreateSegmentsInsideHubs(),this.CreateCurves()}CreateBundleBases(){new sS(this.metroOrdering,this.metroGraphData,this.bundlingSettings).Run()}CreateCurves(){for(let e=0;e<this.metroGraphData.Metrolines.length;e++)this.CreateCurveLine(this.metroGraphData.Metrolines[e],this.metroGraphData.Edges[e])}CreateCurveLine(e,t){let r=new C,i=sP.FindCurveStart(this.metroGraphData,this.metroOrdering,e);for(let t of sP.HubSegsOfLine(this.metroGraphData,this.metroOrdering,e)){if(null!=t)r.addSegment(b.mkPP(i,t.start)),r.addSegment(t),i=t.end}r.addSegment(b.mkPP(i,sP.FindCurveEnd(this.metroGraphData,this.metroOrdering,e))),t.curve=r}static FindCurveStart(e,t,r){let i=e.PointToStations.get(r.Polyline.startPoint.point),n=e.PointToStations.get(r.Polyline.startPoint.next.point),s=i.BundleBases.get(n),o=s.IsParent?t.GetLineIndexInOrder(i,n,r):t.GetLineIndexInOrder(n,i,r);return s.Points[o]}static FindCurveEnd(e,t,r){let i=e.PointToStations.get(r.Polyline.endPoint.prev.point),n=e.PointToStations.get(r.Polyline.endPoint.point),s=n.BundleBases.get(i),o=s.IsParent?t.GetLineIndexInOrder(n,i,r):t.GetLineIndexInOrder(i,n,r);return s.Points[o]}static*HubSegsOfLine(e,t,r){for(let i=r.Polyline.startPoint.next;null!=i.next;i=i.next)yield sP.SegOnLineVertex(e,t,r,i)}static SegOnLineVertex(e,t,r,i){let n=e.PointToStations.get(i.prev.point),s=e.PointToStations.get(i.point),o=s.BundleBases.get(n),a=t.GetLineIndexInOrder(n,s,r);if(null==o.OrientedHubSegments[a]||null==o.OrientedHubSegments[a].Segment){let n=e.PointToStations.get(i.next.point),l=s.BundleBases.get(n),h=t.GetLineIndexInOrder(n,s,r);return b.mkPP(o.Points[a],l.Points[h])}return o.OrientedHubSegments[a].Segment}CreateSegmentsInsideHubs(){for(let e of this.metroGraphData.Metrolines)this.CreateOrientedSegsOnLine(e);this.bundlingSettings.UseCubicBezierSegmentsInsideOfHubs&&this.FanBezierSegs()}CreateOrientedSegsOnLine(e){for(let t=e.Polyline.startPoint.next;null!=t.next;t=t.next)this.CreateICurveForOrientedSeg(e,t)}CreateICurveForOrientedSeg(e,t){let r=this.metroGraphData.PointToStations.get(t.prev.point),i=this.metroGraphData.PointToStations.get(t.point),n=this.metroGraphData.PointToStations.get(t.next.point),s=i.BundleBases.get(r),o=i.BundleBases.get(n),a=this.metroOrdering.GetLineIndexInOrder(r,i,e),l=this.metroOrdering.GetLineIndexInOrder(n,i,e),h=this.bundlingSettings.UseCubicBezierSegmentsInsideOfHubs?sP.StandardBezier(s.Points[a],s.Tangents[a],o.Points[l],o.Tangents[l]):sP.BiArc(s.Points[a],s.Tangents[a],o.Points[l],o.Tangents[l]);s.OrientedHubSegments[a].Segment=h,o.OrientedHubSegments[l].Segment=h}static ShowHubs(e,t,r,i,n=[]){let s=sP.GetAllDebugCurves(t,e);null!=r&&s.push(r0.mkDebugCurveTWCI(255,1,"red",N.mkDiamond(5,25,r.Position))),s.concat(n)}static GetAllDebugCurves(e,t){return sP.GraphNodes(t).concat(sP.VertexDebugCurves(e,t)).concat(sP.DebugEdges(t))}static DebugEdges(e){return e.Edges.map(e=>r0.mkDebugCurveTWCI(40,.1,"gray",e.curve))}static VertexDebugCurves(e,t){return sP.DebugCircles(t).concat(sP.DebugHubBases(t)).concat(sP.DebugSegs(t)).concat(sP.BetweenHubs(e,t))}static BetweenHubs(e,t){let r=[];for(let i of t.Metrolines){let n=sP.GetInterestingSegs(t,e,i),s=sP.GetMonotoneColor(i.Polyline.start,i.Polyline.end,n);for(let e of n)r.push(r0.mkDebugCurveTWCI(100,i.Width,s,b.mkPP(e[0],e[1])))}return r}static GetInterestingSegs(e,t,r){let i=[];if(0===e.Stations.length||null==e.Stations[0].BundleBases||0===e.Stations[0].BundleBases.size)return[];let n=sP.FindCurveStart(e,t,r);for(let s of sP.HubSegsOfLine(e,t,r)){if(null!=s)i.push([n,s.start]),n=s.end}return i.push([n,sP.FindCurveEnd(e,t,r)]),i}static GetMonotoneColor(e,t,r){return"green"}static DebugHubBases(e){let t=[];for(let r of e.Stations)for(let e of r.BundleBases.values())t.push(r0.mkDebugCurveTWCI(100,1,"red",b.mkPP(e.EndPoint,e.StartPoint)));return t}static DebugCircles(e){return e.Stations.map(e=>r0.mkDebugCurveTWCI(100,.1,"blue",N.mkCircle(e.Radius,e.Position)))}static DebugSegs(e){let t=[];for(let r of e.VirtualStations())for(let e of r.BundleBases.values())for(let r of e.OrientedHubSegments){if(null!=r)if(null==r.Segment){let i=r.Other.BundleBase,n=r.Index,s=r.Other.Index;t.push(b.mkPP(e.Points[n],i.Points[s]))}else t.push(r.Segment)}return t.map(e=>r0.mkDebugCurveTWCI(100,.01,"green",e))}static GraphNodes(e){return e.Edges.map(e=>e.sourcePort.Curve).concat(e.Edges.map(e=>e.targetPort.Curve)).map(e=>r0.mkDebugCurveTWCI(40,1,"black",e))}static BiArc(e,t,r,i){let n;let s=e.sub(r);if(s.length<l.distanceEpsilon)return null;let o=s.dot(t.sub(i)),a=-t.dot(i);if(0>=t.dot(r.sub(e))&&0>=t.dot(i))return sP.StandardBezier(e,t,r,i);let h=2*(a-1),u=2*o,c=s.dot(s);if(Math.abs(h)<l.distanceEpsilon){if(!(Math.abs(u)>l.distanceEpsilon))return null;n=-c/u}else{let e=u*u-4*h*c;e<0&&(e=0),(n=(-u+(e=Math.sqrt(e)))/(2*h))<0&&(n=(-u-e)/(2*h))}let d=e.add(t.mul(n)),f=r.add(i.mul(n)),p=g.middle(d,f),m=g.getTriangleOrientation(e,d,p);if(m!==g.getTriangleOrientation(p,f,r))return sP.StandardBezier(e,t,r,i);let v=new C;return v.addSegs([sP.ArcOn(e,d,p),sP.ArcOn(p,f,r)]),v}static ArcOn(e,t,r){let i={center:null};if(1e-4>Math.abs(g.signedDoubledTriangleArea(e,t,r))||!sP.FindArcCenter(e,t,r,i))return b.mkPP(e,r);let n=i.center,s=p(e,n);if(p(e,t)/s<1e-4)return b.mkPP(e,r);let o=e.sub(n),a=Math.atan2(o.y,o.x),l=r.sub(n),h=Math.atan2(l.y,l.x),u=h-a;if(u<0&&(u+=2*Math.PI,h+=2*Math.PI),u<=Math.PI)return new T(a,h,new g(s,0),new g(0,s),n);for(h>2*Math.PI&&(h-=2*Math.PI),a=Math.PI-a,h=Math.PI-h,a<0&&(a+=2*Math.PI);h<a;)h+=2*Math.PI;return u=h-a,new T(a,h,new g(-s,0),new g(0,s),n)}static FindArcCenter(e,t,r,i){let n=t.sub(e).rotate90Cw(),s=t.sub(r).rotate90Cw();return i.center=g.lineLineIntersection(e,e.add(n),r,r.add(s)),null!=i.center}static StandardBezier(e,t,r,i){let n=p(e,r)/4;return E.mkBezier([e,e.add(t.mul(n)),r.add(i.mul(n)),r])}FanBezierSegs(){let e=!0,t=0;for(;e&&t++<5;)for(let t of(e=!1,this.metroGraphData.Stations))for(let r of t.BundleBases.values())e||(e=this.FanEdgesOfHubSegment(r))}FanEdgesOfHubSegment(e){let t=!1;for(let r=0;r<e.Count-1;r++)t||(t=this.FanCouple(e,r,e.CurveCenter,e.Curve.boundingBox.diagonal/2));return t}FanCouple(e,t,r,i){let n=e.OrientedHubSegments[t],s=e.OrientedHubSegments[t+1];if(null==n||x(n.Segment.start,n.Segment.end,s.Segment.start,s.Segment.end)||g.getTriangleOrientation(n.value(0),n.value(.5),n.value(1))!=g.getTriangleOrientation(s.value(0),s.value(.5),s.value(1)))return!1;let o=this.BaseLength(n),a=this.BaseLength(s);return!(Math.abs(o-a)<l.intersectionEpsilon)&&(o>a?this.AdjustLongerSeg(n,s,r,i):this.AdjustLongerSeg(s,n,r,i))}AdjustLongerSeg(e,t,r,i){let n=e.value(0).sub(t.value(0)),s=e.value(1).sub(t.value(1)),o=Math.min(n.length,s.length),a=t.value(.5),l=Math.max(n.length,s.length);return 0!==this.NicelyAligned(e.Segment,n,s,a,o,l)&&this.FitLonger(e,n,s,a,o,l,r,i)}FitLonger(e,t,r,i,n,s,o,a){let l=e.Segment,h=l.start,u=l.end,c=0,d=l.start.mul(1-sP.SqueezeBound).add(l.B(1).mul(sP.SqueezeBound)),f=l.end.mul(1-sP.SqueezeBound).add(l.B(2).mul(sP.SqueezeBound)),p=l.B(1).mul(2).sub(l.start),m=l.B(2).mul(2).sub(l.end),v={highP:p};this.PullControlPointToTheCircle(l.start,v,o,a),p=v.highP;let b=this.NicelyAligned(l,t,r,i,n,s);for(;;){if(-1===b){let e=g.middle(l.B(1),d),t=g.middle(l.B(2),f);p=l.B(1),m=l.B(2),l=new E(h,e,t,u)}else{let e=g.middle(l.B(1),p),t=(l.B(2),m);d=l.B(1),f=l.B(2),l=new E(h,e,t,u)}if(0===(b=this.NicelyAligned(l,t,r,i,n,s)))return e.Segment=l,e.Other.Segment=l,!0;if(c++>10)return!1}}PullControlPointToTheCircle(e,t,r,i){let n=g.ProjectionToLine(e,t.highP,r),s=Math.sqrt(i*i-n.sub(r).lengthSquared),o=t.highP.sub(n),a=o.length;a>s&&(t.highP=n.add(o.mul(s/a)))}NicelyAligned(e,t,r,i,n,s){let o=e.value(.5).sub(i),a=o.length;return 0>t.dot(o)||0>r.dot(o)||a<n-.001?1:a>s+.001?-1:0}BaseLength(e){return e.value(0).sub(e.value(1)).lengthSquared}}sP.SqueezeBound=.2;class sE{static FixRouting(e,t){return this.FixRoutingMBP(e,t,null)}static FixRoutingMBP(e,t,r){return new sE(e,t).FixRoutingP(r)}constructor(e,t){this.stepsWithProgress=0,this.metroGraphData=e,this.bundlingSettings=t,this.costCalculator=new sm(this.metroGraphData,this.bundlingSettings),this.cache=new sc(this.metroGraphData,this.bundlingSettings,this.costCalculator,this.metroGraphData.cdt)}FixRoutingP(e){this.stationsForOptimizations=this.GetStationsForOptimizations(e),this.cache.InitializeCostCache();let t=sE.MaxStep,r=Number.POSITIVE_INFINITY,i=this.metroGraphData.VirtualStations().map(e=>e.Position),n=0;for(;n++<sE.MaxIterations;){let e=this.TryMoveStations();if(n<=1&&!e)return!1;if(!e)break;let s=r;r=sm.Cost(this.metroGraphData,this.bundlingSettings),t=this.UpdateMaxStep(t,s,r);let o=i;if(i=this.metroGraphData.VirtualStations().map(e=>e.Position),t<sE.MinStep||this.Converged(t,o,i))break}return!0}static stationsArePositionedCorrectly(e){for(let t of e.VirtualEdges())if(!this.edgeIsPositionedCorrectly(t,e))return!1;return!0}static edgeIsPositionedCorrectly(e,t){let r=e[0],i=e[1],n=t.looseIntersections.ObstaclesToIgnoreForBundle(r,i),s=b.mkPP(r.Position,i.Position),o=Array.from(t.looseIntersections.obstacleTree.GetNodeItemsIntersectingRectangle(s.boundingBox)).filter(e=>!n.has(e)).filter(e=>C.CurvesIntersect(s,e));return!(o.length>0)||(sP.ShowHubs(t,null,null,"./tmp/badcross.svg",[r0.mkDebugCurveTWCI(200,1,"Brown",s),r0.mkDebugCurveTWCI(200,1,"Red",N.mkCircle(2,r.Position)),r0.mkDebugCurveTWCI(200,1,"Blue",N.mkCircle(5,i.Position)),r0.mkDebugCurveTWCI(100,1,"Blue",N.mkCircle(5,i.Position))].concat(o.map(e=>r0.mkDebugCurveTWCI(100,1,"Pink",e)))),!1)}GetStationsForOptimizations(e){if(null==e)return new Set(this.metroGraphData.VirtualStations());{let t=new Set;for(let r of e){let e=this.metroGraphData.PointToStations.get(r);e&&!e.IsReal&&t.add(e)}return t}}Converged(e,t,r){let i=0,n=0;for(let e=0;e<t.length;e++)n+=t[e].sub(r[e]).lengthSquared,i+=t[e].lengthSquared;return Math.sqrt(n/i)<sE.MinRelativeChange}UpdateMaxStep(e,t,r){return r+1<t?(this.stepsWithProgress++,this.stepsWithProgress>=5&&(this.stepsWithProgress=0,e=Math.min(sE.MaxStep,e/.8))):(this.stepsWithProgress=0,e*=.8),e}TryMoveStations(){let e=!1,t=new Set;for(let r of this.stationsForOptimizations)if(this.TryMoveStation(r))for(let i of(e=!0,t.add(r),r.Neighbors))!i.IsReal&&t.add(i);return this.stationsForOptimizations=t,e}TryMoveStation(e){let t=this.BuildDirection(e);if(0===t.length)return!1;let r=this.BuildStepLength(e,t);if(r<sE.MinStep&&(t=function(){return new g(1+2*t4(),1+2*t4())}(),(r=this.BuildStepLength(e,t))<sE.MinStep))return!1;let i=t.mul(r),n=e.Position.add(i);return!this.metroGraphData.PointToStations.has(n)&&!!this.moveIsLegalForAdjacentBundles(e,n)&&(this.metroGraphData.MoveNode(e,n),this.cache.UpdateCostCache(e),!0)}moveIsLegalForAdjacentBundles(e,t){for(let r of this.metroGraphData.looseIntersections.obstacleTree.AllHitItems(M.mkOnPoints([t]),e=>C.PointRelativeToCurveLocation(t,e)!==el.Outside))if(!1===e.getELP().has(r))return!1;for(let r of e.Neighbors){let i=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(r,e);if(!this.metroGraphData.cdtIntersections.EdgeIsLegal_(r.Position,t,r.cdtTriangle,i))return!1}return!0}BuildDirection(e){let t=this.BuildForceForInk(e),r=this.BuildForceForPathLengths(e),i=this.BuildForceForRadius(e),n=this.BuildForceForBundle(e),s=t.add(r.add(i.add(n)));return s.length<.1?new g(0,0):s.normalize()}BuildStepLength(e,t){let r=sE.MinStep,i=this.CostGain(e,e.Position.add(t.mul(r)));if(i<.01)return 0;for(;2*r<=sE.MaxStep;){let n=this.CostGain(e,e.Position.add(t.mul(2*r)));if(n<=i)break;r*=2,i=n}return r}CostGain(e,t){let r=this.costCalculator.RadiusGain(e,t);if(r<-0xbc614e)return -0xbc614e;let i=this.costCalculator.BundleGain(e,t);if(i<-0xbc614e)return -0xbc614e;let n=this.costCalculator.InkGain(e,t);return r+n+this.costCalculator.PathLengthsGain(e,t)+i}BuildForceForInk(e){let t=new g(0,0);for(let r of e.Neighbors){let i=r.Position.sub(e.Position);t=t.add(i.normalize())}return t.mul(this.bundlingSettings.InkImportance)}BuildForceForPathLengths(e){let t=new g(0,0);for(let r of this.metroGraphData.MetroNodeInfosOfNode(e)){let i=r.Metroline,n=r.PolyPoint.next.point,s=r.PolyPoint.prev.point,o=n.sub(e.Position),a=s.sub(e.Position);t=(t=t.add(o.div(o.length*i.IdealLength))).add(a.div(a.length*i.IdealLength))}return t.mul(this.bundlingSettings.PathLengthImportance)}BuildForceForRadius(e){let t=new g(0,0),r=e.cachedIdealRadius,i={touchedObstacles:[]};if(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesSPNBA(e,e.Position,r,i))throw sP.ShowHubs(this.metroGraphData,null,e,"./tmp/hubs.svg",[r0.mkDebugCurveTWCI(255,1,"Brown",ss.containingPoly),r0.mkDebugCurveTWCI(100,1,"Blue",N.mkCircle(r,e.Position))]),Error();for(let n of i.touchedObstacles){let i=2*(1-n[1].sub(e.Position).length/r),s=e.Position.sub(n[1]).normalize();t=t.add(s.mul(i))}return t.mul(this.bundlingSettings.HubRepulsionImportance)}BuildForceForBundle(e){let t=new g(0,0);for(let r of e.Neighbors){let i=this.metroGraphData.GetWidthSSN(e,r,this.bundlingSettings.EdgeSeparation),n={closestDist:[]};this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(e,r,e.Position,r.Position,i/2,n);for(let e of n.closestDist){let r=2*(1-e[0].sub(e[1]).length/(i/2)),n=e[0].sub(e[1]).normalize().neg();t=t.add(n.mul(r))}}return t.mul(this.bundlingSettings.BundleRepulsionImportance)}}sE.MaxIterations=100,sE.MaxStep=50,sE.MinStep=1,sE.MinRelativeChange=5e-4;class sC{constructor(e,t){this.metroGraphData=e,this.bundlingSettings=t}static FixRouting(e,t){let r=new sC(e,t);r.GlueConflictingStations(),r.UnglueEdgesFromBundleToSaveInk(!0);let i=0;for(;++i<10;){let e=r.GlueConflictingStations();if(e||(e=r.RelaxConstrainedEdges()),e||(e=i<=3&&r.UnglueEdgesFromBundleToSaveInk(!1)),e||(e=r.GlueCollinearNeighbors(i)),e||(e=3===i&&r.RemoveDoublePathCrossings()),!e)break}for(e.cdtIntersections.ComputeForcesForBundles=!0,r.RemoveDoublePathCrossings(),r.UnglueEdgesFromBundleToSaveInk(!0);r.GlueConflictingStations(););e.Initialize(!0)}GlueConflictingStations(){let e=this.GetCirclesHierarchy();if(null==e)return!1;let t=new Map,r=new Set;if(tJ(e,e,(e,i)=>this.TryToGlueStations(e,i,t,r)),0===t.size)return!1;for(let e=0;e<this.metroGraphData.Edges.length;e++)this.RegenerateEdge(t,e);let i=new eN;for(let e of r)for(let t of(i.add(e.Position),e.Neighbors))!t.IsReal&&i.add(t.Position);return this.metroGraphData.Initialize(!1),sE.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,i),!0}GetCirclesHierarchy(){for(let e of this.metroGraphData.VirtualStations())e.Radius=this.GetCurrentHubRadius(e);return eC(this.metroGraphData.VirtualStations().map(function(e){let t=e.Position,r=Math.max(e.Radius,5),i=new g(r,r);return eR(e,M.mkPP(t.add(i),t.sub(i)))}))}GetCurrentHubRadius(e){if(e.IsReal)return e.BoundaryCurve.boundingBox.diagonal/2;{let t=e.cachedIdealRadius,r=this.metroGraphData.looseIntersections.GetMinimalDistanceToObstacles(e,e.Position,t);for(let t of e.Neighbors)r=Math.min(r,e.Position.sub(t.Position).length);return r}}TryToGlueStations(e,t,r,i){if(!eG(e.getELP(),t.getELP()))return!1;let n=e.Position.sub(t.Position).length,s=Math.max(e.Radius,5);if(!(n>=s+Math.max(t.Radius,5)))!this.TryGlueOrdered(e,t,i,r)&&this.TryGlueOrdered(t,e,i,r)}TryGlueOrdered(e,t,r,i){return!!(!i.has(e)&&!r.has(e)&&this.StationGluingIsAllowed(e,t,i))&&(this.Map(e,t,r,i),!0)}Map(e,t,r,i){i.set(e,t),r.add(t)}StationGluingIsAllowed(e,t,r){for(let i of e.Neighbors){let n=sC.Glued(i,r),s=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(n,e);if(!this.metroGraphData.cdtIntersections.EdgeIsLegalSSPPS(n,t,s))return!1}return!(0>this.ComputeCostDeltaAfterStationGluing(e,t,r))&&!0}ComputeCostDeltaAfterStationGluing(e,t,r){let i=e.Position.sub(t.Position).length;if(e.Radius>=i||t.Radius>=i)return 1;let n=0,s=this.metroGraphData.Ink,o=this.metroGraphData.Ink-t.Position.sub(e.Position).length;for(let i of e.Neighbors){let n=sC.Glued(i,r);o-=n.Position.sub(e.Position).length,o+=0===this.metroGraphData.RealEdgeCount(n,t)?n.Position.sub(t.Position).length:0}for(let r of(n+=sm.InkError(s,o,this.bundlingSettings),this.metroGraphData.MetroNodeInfosOfNode(e))){let i=r.Metroline.Length,s=r.Metroline.Length,o=r.PolyPoint,a=o.prev,l=o.next;s-=a.point.sub(e.Position).length+l.point.sub(e.Position).length,s+=a.point.sub(t.Position).length+l.point.sub(t.Position).length,n+=sm.PathLengthsError(i,s,r.Metroline.IdealLength,this.bundlingSettings)}return n}RegenerateEdge(e,t){let r=this.metroGraphData.Metrolines[t].Polyline;for(let e of r)if(!this.metroGraphData.PointToStations.has(e))return;let i=!1;for(let t of r)if(e.has(this.metroGraphData.PointToStations.get(t))){i=!0;break}if(!i)return;let n=Array.from(r).map(e=>this.metroGraphData.PointToStations.get(e));this.metroGraphData.Edges[t].curve=A.mkFromPoints(sC.GluedPolyline(n,e))}static GluedPolyline(e,t){let r;let i=new eE.Stack;i.push(e[0]);let n=new Set;for(r=1;r<e.length-1;r++){let s=sC.Glued(e[r],t);if(n.has(s)){for(;i.top!==s;)n.delete(i.pop());continue}if(!g.closeDistEps(s.Position,i.top.Position))n.add(s),i.push(s)}return i.push(e[r]),Array.from(i).reverse().map(e=>e.Position)}static Glued(e,t){var r;return null!==(r=t.get(e))&&void 0!==r?r:e}UnglueEdgesFromBundleToSaveInk(e){let t=new rE;for(let e of(this.ink=this.metroGraphData.Ink,this.polylineLength=new Map,this.metroGraphData.Metrolines)){this.polylineLength.set(e,e.Length);for(let r=e.Polyline.startPoint;null!=r.next;r=r.next)eH(t,new ek(r.point,r.next.point),e)}let r=new eN,i=!1;for(let e of this.metroGraphData.Metrolines){let n=eF(this.metroGraphData.PointToStations.get(e.Polyline.start).getELP(),this.metroGraphData.PointToStations.get(e.Polyline.end).getELP());this.TrySeparateOnPolyline(e,t,r,n)&&(i=!0)}return i&&this.metroGraphData.Initialize(!1),(e||i)&&sE.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,e?null:r),i}TrySeparateOnPolyline(e,t,r,i){let n=!1,s=!0;for(;s;){s=!1;for(let n=e.Polyline.startPoint;null!=n.next&&null!=n.next.next;n=n.next)this.TryShortcutPolypoint(n,t,r,i)&&(s=!0);s&&(n=!0)}return n}TryShortcutPolypoint(e,t,r,i){return!!this.SeparationShortcutAllowed(e,t,i)&&(r.add(e.point),r.add(e.next.point),r.add(e.next.next.point),this.RemoveShortcuttedPolypoint(e,t),!0)}SeparationShortcutAllowed(e,t,r){let i=e.point,n=e.next.point,s=e.next.next.point,o=this.metroGraphData.PointToStations.get(i),a=this.metroGraphData.PointToStations.get(n),l=this.metroGraphData.PointToStations.get(s),h=eD(o.getELP(),l.getELP()),u=function(e){if(0===e.length)return new Set;let t=e[0];for(let r=1;r<e.length;r++)t=eF(t,e[r]);return t}([r,a.getELP(),h]);return!(!this.metroGraphData.cdtIntersections.EdgeIsLegalSSPPS(o,l,u)||0>this.GetInkgain(e,t,i,n,s))&&!0}GetInkgain(e,t,r,i,n){let[s,o,a]=this.FindPolylines(e,t),l=0,h=this.ink,u=this.ink,c=r.sub(i).length,d=i.sub(n).length,f=r.sub(n).length;s.size===a.size&&(u-=c),o.size===a.size&&(u-=d);let p=t.get(new ek(r,n));for(let e of((!p||0===p.size)&&(u+=f),l+=sm.InkError(h,u,this.bundlingSettings),a)){let t=this.polylineLength.get(e),r=t-(c+d-f);l+=sm.PathLengthsError(t,r,e.IdealLength,this.bundlingSettings)}let g=this.GetCurrentHubRadius(this.metroGraphData.PointToStations.get(r)),m=this.metroGraphData.GetWidthAN(Array.from(a),this.bundlingSettings.EdgeSeparation),v=this.metroGraphData.GetWidthAN(Array.from(eL(s,a)),this.bundlingSettings.EdgeSeparation),b=su.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(g,r,n,i,m,v,this.bundlingSettings);b>g&&(l-=sm.RError(b,g,this.bundlingSettings)),g=this.GetCurrentHubRadius(this.metroGraphData.PointToStations.get(n));let y=this.metroGraphData.GetWidthAN(Array.from(eL(o,a)),this.bundlingSettings.EdgeSeparation);return(b=su.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(g,n,i,r,y,m,this.bundlingSettings))>g&&(l-=sm.RError(b,g,this.bundlingSettings)),l}RemoveShortcuttedPolypoint(e,t){let r=e.point,i=e.next.point,n=e.next.next.point,[s,o,a]=this.FindPolylines(e,t),l=p(r,i),h=p(i,n),u=p(r,n);s.size===a.size&&(this.ink-=l),o.size===a.size&&(this.ink-=h);let c=t.get(new ek(r,n));for(let e of((!c||0===c.size)&&(this.ink+=u),a)){let t=this.polylineLength.get(e);this.polylineLength.set(e,t-(l+h-u))}for(let e of a){var d,f,g;let s=Array.from(e.Polyline.polylinePoints()).find(e=>e.point.equal(i));this.RemovePolypoint(s),eW(t,[r,i],e),eW(t,[i,n],e),d=t,f=[r,n],g=e,eH(d,new ek(f[0],f[1]),g)}}FindPolylines(e,t){let r=e.point,i=e.next.point,n=e.next.next.point,s=t.getPP(r,i),o=t.getPP(i,n),a=eF(s,o);return[s,o,a]}RemovePolypoint(e){let t=e.prev,r=e.next;t.next=r,r.prev=t}GlueCollinearNeighbors(e){let t=new eN,r=!1;for(let i of this.metroGraphData.Stations)this.GlueCollinearNeighborsSPN(i,t,e)&&(r=!0);return r&&(this.metroGraphData.Initialize(!1),sE.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,t)),r}GlueCollinearNeighborsSPN(e,t,r){if(e.Neighbors.length<=1)return!1;let i=new sd,n=e.Neighbors;for(let t=0;t<n.length;t++)this.TryToGlueEdges(e,n[t],n[(t+1)%n.length],i,r);if(i.isEmpty)return!1;for(let e of i)this.GlueEdge(e),t.add(e[0].Position),t.add(e[1].Position),t.add(e[2]);return!0}TryToGlueEdges(e,t,r,i,n){if(g.anglePCP(t.Position,e.Position,r.Position)<this.bundlingSettings.AngleThreshold){let s=p(t.Position,e.Position),o=p(r.Position,e.Position),a=Math.min(s,o)/Math.max(s,o);if(!(a<.05)){if(s<o){if(this.EdgeGluingIsAllowedSSS(e,t,r)){this.AddEdgeToGlue(e,r,t,t.Position,i);return}}else if(this.EdgeGluingIsAllowedSSS(e,r,t)){this.AddEdgeToGlue(e,t,r,r.Position,i);return}if(n<5&&a>.5){let n=this.ConstructGluingPoint(e,t,r);this.EdgeGluingIsAllowedSSSP(e,t,r,n)&&this.AddEdgeToGlue(e,r,t,n,i)}}}}ConstructGluingPoint(e,t,r){let i=Math.min(p(t.Position,e.Position),p(r.Position,e.Position)/2),n=t.Position.sub(e.Position).normalize().add(r.Position.sub(e.Position).normalize());return e.Position.add(n.mul(i/2))}EdgeGluingIsAllowedSSS(e,t,r){if(t.IsReal||r.IsReal||!eG(t.getELP(),r.getELP())||!this.metroGraphData.cdtIntersections.EdgeIsLegal(t,r,t.Position,r.Position))return!1;let i=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,r);return!(rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(b.mkPP(e.Position,t.Position),this.metroGraphData.LooseTree).find(e=>!i.has(e.seg1))||rT.IntersectionsOfLineAndRectangleNodeOverPolylineLR(b.mkPP(t.Position,r.Position),this.metroGraphData.LooseTree).find(e=>!i.has(e.seg1))||0>this.ComputeCostDeltaAfterEdgeGluing(e,t,r,t.Position))&&!0}EdgeGluingIsAllowedSSSP(e,t,r,i){return!(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesPNS__(i,0,eF(t.getELP(),r.getELP()))||!this.metroGraphData.cdtIntersections.EdgeIsLegal(e,null,e.Position,i)||!this.metroGraphData.cdtIntersections.EdgeIsLegal(t,null,t.Position,i)||!this.metroGraphData.cdtIntersections.EdgeIsLegal(r,null,r.Position,i)||0>this.ComputeCostDeltaAfterEdgeGluing(e,t,r,i))||!1}ComputeCostDeltaAfterEdgeGluing(e,t,r,i){let n=0,s=this.metroGraphData.Ink,o=this.metroGraphData.Ink-p(e.Position,r.Position)-p(e.Position,t.Position)+p(e.Position,i)+p(i,t.Position)+p(i,r.Position);for(let t of(n+=sm.InkError(s,o,this.bundlingSettings),this.metroGraphData.GetIjInfo(e,r).Metrolines)){let s=t.Length,o=t.Length-p(e.Position,r.Position)+p(e.Position,i)+p(i,r.Position);n+=sm.PathLengthsError(s,o,t.IdealLength,this.bundlingSettings)}for(let r of this.metroGraphData.GetIjInfo(e,t).Metrolines){let s=r.Length,o=r.Length-p(e.Position,t.Position)+p(e.Position,i)+p(i,t.Position);n+=sm.PathLengthsError(s,o,r.IdealLength,this.bundlingSettings)}let a=e.cachedIdealRadius,l=this.GetCurrentHubRadius(e),h=su.GetMinRadiusForTwoAdjacentBundles(l,e,e.Position,t,r,this.metroGraphData,this.bundlingSettings);return h>l&&(n+=sm.RError(h,l,this.bundlingSettings)),a>p(e.Position,i)&&!e.IsReal&&(n-=sm.RError(a,p(e.Position,i),this.bundlingSettings)),n}AddEdgeToGlue(e,t,r,i,n){if(!(n.has(r,e)||n.has(t,e)||n.has(e,r)||n.has(e,t)))n.set(e,r,i),n.set(e,t,i)}GlueEdge(e){let t=e[0],r=e[1],i=e[2];for(let e of t.MetroNodeInfos.map(e=>e.PolyPoint))null!=e.next&&e.next.point.equal(r.Position)?this.SplitPolylinePoint(e,i):null!=e.prev&&e.prev.point.equal(r.Position)&&this.SplitPolylinePoint(e.prev,i)}SplitPolylinePoint(e,t){if(e.point===t||e.next.point===t)return;let r=m.mkFromPoint(t);r.polyline=e.polyline,r.next=e.next,r.prev=e,r.next.prev=r,r.prev.next=r}RelaxConstrainedEdges(){let e=new eN,t=!1;for(let r of this.metroGraphData.VirtualEdges())this.RelaxConstrainedEdge(r[0],r[1],e)&&(t=!0);return t&&(this.metroGraphData.Initialize(!1),sE.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,e)),t}RelaxConstrainedEdge(e,t,r){let i=this.metroGraphData.GetWidthSSN(e,t,this.bundlingSettings.EdgeSeparation),n={closestDist:[]};this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(e,t,e.Position,t.Position,.99*i/2,n);let s=n.closestDist;if(s.length>0){let i,n=-1;for(let r of s){let s=Math.min(p(e.Position,r[1]),p(t.Position,r[1]));if(s/p(e.Position,t.Position)<.1)continue;let o=p(r[0],r[1]);(-1===n||o<n)&&(n=o,i=r[1])}if(-1===n||!this.metroGraphData.looseIntersections.HubAvoidsObstaclesPNS__(i,0,eF(e.getELP(),t.getELP())))return!1;for(let n of(r.add(i),r.add(e.Position),r.add(t.Position),this.metroGraphData.GetIjInfo(e,t).Metrolines)){let r=null;for(let t of n.Polyline.polylinePoints())if(t.point.equal(e.Position)){r=t;break}null!=r.next&&r.next.point.equal(t.Position)?this.SplitPolylinePoint(r,i):this.SplitPolylinePoint(r.prev,i)}return!0}return!1}RemoveDoublePathCrossings(){let e=new sb(this.metroGraphData,this.metroGraphData.PointIsAcceptableForEdge.bind(this)).run();return e&&(this.metroGraphData.Initialize(!1),sE.FixRouting(this.metroGraphData,this.bundlingSettings)),e}}class sA{constructor(e,t,r){for(let e of(this.upperBound=Number.POSITIVE_INFINITY,this._visGraph=r,r.ClearPrevEdgesTable(),r.Vertices()))e.Distance=Number.POSITIVE_INFINITY;this.sources=e,this.targets=new Set(t)}GetPath(){let e=new rd;for(let t of this.sources)t.Distance=0,e.Enqueue(t,0);for(;!e.IsEmpty()&&(this._current=e.Dequeue(),!this.targets.has(this._current));){;for(let t of this._current.OutEdges)this.PassableOutEdge(t)&&this.ProcessNeighbor(e,t,t.Target);for(let t of this._current.InEdges.filter(this.PassableInEdge.bind))this.ProcessNeighbor(e,t,t.Source)}return null==this._visGraph.PreviosVertex(this._current)?null:this.CalculatePath()}PassableOutEdge(e){return this.targets.has(e.Target)||!sA.IsForbidden(e)}PassableInEdge(e){return this.targets.has(e.Source)||!sA.IsForbidden(e)}static IsForbidden(e){return(null!=e.IsPassable&&!e.IsPassable()||e)instanceof tx}ProcessNeighbor(e,t,r){let i=t.Length,n=this._current.Distance+i;if(!(n>=this.upperBound))this.targets.has(r)&&(this.upperBound=n,this.closestTarget=r),null==this._visGraph.PreviosVertex(r)?(r.Distance=n,this._visGraph.SetPreviousEdge(r,t),e.Enqueue(r,n)):n<r.Distance&&(r.Distance=n,this._visGraph.SetPreviousEdge(r,t),e.DecreasePriority(r,n))}CalculatePath(){if(null==this.closestTarget)return null;let e=[],t=this.closestTarget;do e.push(t),t=this._visGraph.PreviosVertex(t);while(t.Distance>0);return e.push(t),e.reverse()}}class sI extends e0{constructor(e,t,r,i,n,s,o,a,l,h){super(null),this.bundlingSettings=i,this.bundlingSettings.edgeWidthShrinkCoeff=1,this.edgesToRoute=e,this.regularEdges=e.filter(e=>e.source!==e.target),this.VisibilityGraph=r,this.shortestPathRouter=t,this.LoosePadding=n,this.LooseHierarchy=o,this.TightHierarchy=s,this.EdgeLooseEnterable=a,this.EdgeTightEnterable=l,this.loosePolylineOfPort=h,t6(0)}ThereAreOverlaps(e){return tQ(e,e,C.CurvesIntersect)}run(){if(this.ThereAreOverlaps(this.TightHierarchy)){this.Status=eT.Overlaps;return}this.FixLocationsForHookAnywherePorts(this.edgesToRoute),this.RoutePathsWithSteinerDijkstra(),this.FixChildParentEdges(),!this.bundlingSettings.StopAfterShortestPaths&&this.OrderOptimizeNudgeEtc(),this.RouteSelfEdges(),this.FixArrowheads()}OrderOptimizeNudgeEtc(){let e=new sf(this.regularEdges,this.LooseHierarchy,this.TightHierarchy,this.bundlingSettings,this.shortestPathRouter.cdt,this.EdgeLooseEnterable,this.EdgeTightEnterable,this.loosePolylineOfPort);sC.FixRouting(e,this.bundlingSettings),new sP(e,this.bundlingSettings).run()}FixChildParentEdges(){for(let e of this.regularEdges){let t=e.sourcePort,r=e.targetPort;if(t.Curve.boundingBox.containsRect(r.Curve.boundingBox)){let r=C.intersectionOne(t.Curve,b.mkPP(e.curve.start,e.curve.end),!1);e.curve.startPoint.point=r.x}if(r.Curve.boundingBox.containsRect(t.Curve.boundingBox)){let t=C.intersectionOne(r.Curve,b.mkPP(e.curve.start,e.curve.end),!0);e.curve.endPoint.point=t.x}}}FixLocationsForHookAnywherePorts(e){for(let t of e){let e=t.sourcePort instanceof tz;if(e){let e=t.sourcePort;e.SetLocation(this.FigureOutHookLocation(e.LoosePolyline,t.targetPort,t))}else if(e=t.targetPort instanceof tz){let e=t.targetPort;e.SetLocation(this.FigureOutHookLocation(e.LoosePolyline,t.sourcePort,t))}}}FigureOutHookLocation(e,t,r){return t instanceof tj?this.FigureOutHookLocationForClusterOtherPort(e,t,r):this.FigureOutHookLocationForSimpleOtherPort(e,t,r)}FigureOutHookLocationForClusterOtherPort(e,t,r){let i=this.shortestPathRouter.MakeTransparentShapesOfEdgeGeometry(r),n=new sA(Array.from(t.LoosePolyline).map(this.VisibilityGraph.FindVertex.bind),Array.from(e).map(this.VisibilityGraph.FindVertex.bind),this.VisibilityGraph).GetPath();for(let e of i)e.IsTransparent=!1;return n[n.length-1].point}FigureOutHookLocationForSimpleOtherPort(e,t,r){let i=t.Location,n=this.shortestPathRouter.MakeTransparentShapesOfEdgeGeometry(r),s=new rf(this.VisibilityGraph.FindVertex(i),Array.from(e).map(e=>this.VisibilityGraph.FindVertex(e)),this.VisibilityGraph).GetPath();for(let e of n)e.IsTransparent=!1;return s[s.length-1].point}RoutePathsWithSteinerDijkstra(){this.shortestPathRouter.VisibilityGraph=this.VisibilityGraph,this.shortestPathRouter.BundlingSettings=this.bundlingSettings,this.shortestPathRouter.geomEdges=this.regularEdges,this.shortestPathRouter.ObstacleHierarchy=this.LooseHierarchy,this.shortestPathRouter.RouteEdges(),null!=this.shortestPathRouter.cdt&&this.AdjustEdgeSeparation()}AdjustEdgeSeparation(){let e=new Map;this.shortestPathRouter.FillCrossedCdtEdges(e);let t=this.GetPathsOnCdtEdge(e);this.bundlingSettings.edgeWidthShrinkCoeff=this.CalculateEdgeWidthShrinkCoeff(t)}GetPathsOnCdtEdge(e){let t=new Map;for(let r of e.keys())for(let i of e.get(r))ez(t,i,r);return t}CalculateEdgeWidthShrinkCoeff(e){let t=0,r=this.bundlingSettings.edgeWidthShrinkCoeff;if(this.EdgeSeparationIsOkMN(e,r))return r;let i=!1;for(;!i||Math.abs(r-t)>.01;){let n=(t+r)/2;this.EdgeSeparationIsOkMN(e,n)?(t=n,i=!0):r=n}return t}EdgeSeparationIsOkMN(e,t){for(let r of e.keys())if(!this.EdgeSeparationIsOk(r,e.get(r),t))return!1;return!0}EdgeSeparationIsOk(e,t,r){return Array.from(t).map(e=>this.bundlingSettings.ActualEdgeWidth(e,r)).reduce((e,t)=>e+t,0)<=e.Capacity}RouteSelfEdges(){for(let e of this.edgesToRoute)if(e.source===e.target){let t={smoothedPolyline:null};e.curve=V.RouteSelfEdge(e.source.boundaryCurve,2*this.LoosePadding,t)}}FixArrowheads(){for(let e of this.edgesToRoute)rP.trimSplineAndCalculateArrowheadsII(e,e.source.boundaryCurve,e.target.boundaryCurve,e.curve,!1)}}sI.SuperLoosePaddingCoefficient=1.1;class sM{constructor(e,t,r){this.numberOfPassedPaths=0,this.VisibilityEdge=e,this.Source=t,this.Target=r}get TargetPoint(){return this.Target.Point}get SourcePoint(){return this.Source.Point}get IsOccupied(){return this.numberOfPassedPaths>0}get IsPassable(){return this.Target.IsTargetOfRouting||this.Source.IsSourceOfRouting||null==this.VisibilityEdge.IsPassable||this.VisibilityEdge.IsPassable()}AddOccupiedEdge(){this.numberOfPassedPaths++}RemoveOccupiedEdge(){this.numberOfPassedPaths--}}class sR{get Prev(){return null==this.PrevEdge?null:this.PrevEdge.Source===this?this.PrevEdge.Target:this.PrevEdge.Source}constructor(e){this.InBoneEdges=[],this.OutBoneEdges=[],this.VisibilityVertex=e}get Point(){return this.VisibilityVertex.point}get Cost(){return this.IsSourceOfRouting?this.cost:null==this.Prev?Number.POSITIVE_INFINITY:this.cost}set Cost(e){this.cost=e}SetPreviousToNull(){this.PrevEdge=null}}class sO{constructor(e,t,r){this.EdgesToRoutes=new Map,this.EdgesToRouteSources=new Map,this.MakeTransparentShapesOfEdgeGeometry=e,this.cdt=t,this.Gates=r}CreateGraphElements(){for(let e of this.vertexArray)for(let t of e.VisibilityVertex.InEdges){let r=new sM(t,this.VisibilityVerticesToSdVerts.get(t.Source),this.VisibilityVerticesToSdVerts.get(t.Target)),i=this.VisibilityVerticesToSdVerts.get(t.Source);e.InBoneEdges.push(r),i.OutBoneEdges.push(r)}}CreateRoutingGraph(){for(let e of(this.vertexArray=[],this.VisibilityVerticesToSdVerts=new Map,this.VisibilityGraph.Vertices())){let t=new sR(e);this.vertexArray.push(t),this.VisibilityVerticesToSdVerts.set(e,t)}this.CreateGraphElements()}RouteEdges(){for(let e of(this.Initialize(),this.RestoreCapacities(),this.geomEdges))this.EdgesToRoutes.set(e,this.RouteEdge(e));for(let e of(this.RerouteEdges(),this.geomEdges))this.SetEdgeGeometryCurve(e)}SetEdgeGeometryCurve(e){let t=new A,r=this.EdgesToRouteSources.get(e);for(let i of(t.addPoint(r.Point),this.EdgesToRoutes.get(e)))i.SourcePoint.equal(r.Point)?(t.addPoint(i.TargetPoint),r=i.Target):(t.addPoint(i.SourcePoint),r=i.Source);e.curve=t,e.sourcePort instanceof tj&&sO.ExtendPolylineStartToClusterBoundary(t,e.sourcePort.Curve),e.targetPort instanceof tj&&sO.ExtendPolylineEndToClusterBoundary(t,e.targetPort.Curve)}static ExtendPolylineEndToClusterBoundary(e,t){let r=t.closestParameter(e.end);e.addPoint(t.value(r))}static ExtendPolylineStartToClusterBoundary(e,t){let r=t.closestParameter(e.start);e.PrependPoint(t.value(r))}RerouteEdges(){for(let e of(this.RestoreCapacities(),this.geomEdges)){let t=this.RerouteEdge(e);this.EdgesToRoutes.set(e,t)}}RestoreCapacities(){null!=this.cdt&&this.cdt.RestoreEdgeCapacities()}RerouteEdge(e){for(let t of this.EdgesToRoutes.get(e))t.RemoveOccupiedEdge();return this.RouteEdge(e)}RouteEdge(e){this.CurrentEdgeGeometry=e;for(let e=0;e<this.vertexArray.length;e++){let t=this.vertexArray[e];t.SetPreviousToNull(),t.IsTargetOfRouting=t.IsSourceOfRouting=!1}let t=this.MakeTransparentShapesOfEdgeGeometry(e),r=this.RouteEdgeWithGroups();for(let e of t)e.IsTransparent=!1;return r}RouteEdgeWithGroups(){for(let e=0;e<2;e++){this.SetLengthCoefficient(),this.Queue=new rd,this.sourceLoosePoly=this.SetPortVerticesAndObstacles(this.CurrentEdgeGeometry.sourcePort,!0),this.targetLoosePoly=this.SetPortVerticesAndObstacles(this.CurrentEdgeGeometry.targetPort,!1);let t=this.RouteOnKnownSourceTargetVertices(this.CurrentEdgeGeometry.targetPort.Location.sub(this.CurrentEdgeGeometry.sourcePort.Location).normalize(),0===e);if(null!=t)return t;for(let e=0;e<this.vertexArray.length;e++)this.vertexArray[e].SetPreviousToNull()}throw Error()}RouteOnKnownSourceTargetVertices(e,t){for(this.LowestCostToTarget=Number.POSITIVE_INFINITY,this.ClosestTargetVertex=null;this.Queue.count>0;){let r={priority:0},i=this.Queue.DequeueAndGetPriority(r);if(!(r.priority>=this.LowestCostToTarget)){for(let r=0;r<i.OutBoneEdges.length;r++){let n=i.OutBoneEdges[r];n.IsPassable&&this.ProcessOutcomingBoneEdge(i,n,e,t)}for(let r=0;r<i.InBoneEdges.length;r++){let n=i.InBoneEdges[r];n.IsPassable&&this.ProcessIncomingBoneEdge(i,n,e,t)}}}return this.GetPathAndUpdateRelatedCosts()}ProcessOutcomingBoneEdge(e,t,r,i){if(!(i&&0>r.dot(t.TargetPoint.sub(t.SourcePoint))))this.ProcessBoneEdge(e,t.Target,t)}ProcessIncomingBoneEdge(e,t,r,i){if(!(i&&0>r.dot(t.SourcePoint.sub(t.TargetPoint))))this.ProcessBoneEdge(e,t.Source,t)}ProcessBoneEdge(e,t,r){let i=this.GetEdgeAdditionalCost(r,e.Cost);if(!(t.Cost<=i))if(t.Cost=i,t.PrevEdge=r,this.Queue.ContainsElement(t))this.Queue.DecreasePriority(t,i);else{if(t.IsTargetOfRouting){let e=0;this.CurrentEdgeGeometry.targetPort instanceof tj&&(e=this.LengthCoefficient*t.Point.sub(this.CurrentEdgeGeometry.targetPort.Location).length),i+e<this.LowestCostToTarget&&(this.LowestCostToTarget=i+e,this.ClosestTargetVertex=t);return}this.Enqueue(t)}}GetPathAndUpdateRelatedCosts(){let e=this.ClosestTargetVertex;if(null==e)return null;let t=[];for(;null!=e.PrevEdge;)t.push(e.PrevEdge),this.RegisterPathInBoneEdge(e.PrevEdge),e=e.Prev;return this.EdgesToRouteSources.set(this.CurrentEdgeGeometry,e),t.reverse(),t}RegisterPathInBoneEdge(e){e.AddOccupiedEdge(),null!=this.cdt&&0!==this.BundlingSettings.CapacityOverflowCoefficient&&this.UpdateResidualCostsOfCrossedCdtEdges(e)}UpdateResidualCostsOfCrossedCdtEdges(e){for(let t of e.CrossedCdtEdges)!this.AdjacentToSourceOrTarget(t)&&(t.ResidualCapacity===t.Capacity?t.ResidualCapacity-=this.BundlingSettings.edgeWidthShrinkCoeff*this.CurrentEdgeGeometry.lineWidth:t.ResidualCapacity-=this.BundlingSettings.ActualEdgeWidth(this.CurrentEdgeGeometry))}H(e){return e.Cost+this.LengthCoefficient*e.Point.sub(this.CurrentEdgeGeometry.targetPort.Location).length}GetEdgeAdditionalCost(e,t){let r=e.TargetPoint.sub(e.SourcePoint).length;return this.LengthCoefficient*r+t+(e.IsOccupied?0:this.BundlingSettings.InkImportance*r)+this.CapacityOverflowCost(e)}CapacityOverflowCost(e){if(null==this.cdt||0===this.BundlingSettings.CapacityOverflowCoefficient)return 0;let t=0;for(let r of this.CrossedCdtEdgesOfBoneEdge(e))t+=this.CostOfCrossingCdtEdgeLocal(this.capacityOverlowPenaltyMultiplier,this.BundlingSettings,this.CurrentEdgeGeometry,r);return t}CrossedCdtEdgesOfBoneEdge(e){return null!=e.CrossedCdtEdges?Array.from(e.CrossedCdtEdges):Array.from(e.CrossedCdtEdges=this.ThreadBoneEdgeThroughCdt(e))}ThreadBoneEdgeThroughCdt(e){let t=e.SourcePoint,r=e.Source.Triangle,i=new Set,n=e.TargetPoint;if(ng.PointIsInsideOfTriangle(n,r))return i;let s=new si(r,t,n);for(;s.MoveNext();){let e=s.CurrentPiercedEdge;this.Gates.has(e)&&i.add(e)}return i}static CostOfCrossingCdtEdge(e,t,r,i){let n=r.lineWidth*t.edgeWidthShrinkCoeff;i.Capacity!==i.ResidualCapacity&&(n+=t.EdgeSeparation*t.edgeWidthShrinkCoeff);let s=i.ResidualCapacity-n;return s>=0?0:-s*e}CostOfCrossingCdtEdgeLocal(e,t,r,i){return this.AdjacentToSourceOrTarget(i)?0:sO.CostOfCrossingCdtEdge(e,t,r,i)}AdjacentToSourceOrTarget(e){return e.upperSite.Owner===this.sourceLoosePoly||e.lowerSite.Owner===this.sourceLoosePoly||e.upperSite.Owner===this.targetLoosePoly||e.lowerSite.Owner===this.targetLoosePoly}SetLengthCoefficient(){let e=this.GetIdealDistanceBetweenSourceAndTarget(this.CurrentEdgeGeometry);this.LengthCoefficient=this.BundlingSettings.PathLengthImportance/e}GetIdealDistanceBetweenSourceAndTarget(e){return e.sourcePort.Location.sub(e.targetPort.Location).length}SetPortVerticesAndObstacles(e,t){let r;if(e instanceof tj)for(let i of r=e.LoosePolyline){let e=0;t&&(e=this.LengthCoefficient*i.sub(this.CurrentEdgeGeometry.sourcePort.Location).length),this.AddAndEnqueueVertexToEnds(i,t,e)}else if(e instanceof tz)for(let i of r=e.LoosePolyline)this.AddAndEnqueueVertexToEnds(i,t,0);else{this.AddAndEnqueueVertexToEnds(e.Location,t,0);let i=Array.from(this.ObstacleHierarchy.GetNodeItemsIntersectingRectangle(e.Curve.boundingBox)),n=i[0].boundingBox.diagonal;r=i[0];for(let e=1;e<i.length;e++){let t=i[e],s=t.boundingBox.diagonal;s<n&&(n=s,r=t)}}return r}Enqueue(e){this.Queue.Enqueue(e,this.H(e))}AddAndEnqueueVertexToEnds(e,t,r){let i=this.FindVertex(e),n=this.VisibilityVerticesToSdVerts.get(i);t?(n.IsSourceOfRouting=!0,n.Cost=r,this.Enqueue(n)):n.IsTargetOfRouting=!0}FindVertex(e){return this.VisibilityGraph.FindVertex(e)}Initialize(){this.CreateRoutingGraph(),null!=this.cdt&&(this.capacityOverlowPenaltyMultiplier=sO.CapacityOverflowPenaltyMultiplier(this.BundlingSettings),this.SetVertexTriangles(),this.CalculateCapacitiesOfTrianglulation())}CalculateCapacitiesOfTrianglulation(){for(let e of this.Gates)sO.CalculateCdtEdgeCapacityForEdge(e)}static CalculateCdtEdgeCapacityForEdge(e){if(e.constrained||null==e.CwTriangle||null==e.CcwTriangle)return;let t=e.upperSite.Owner,r=e.lowerSite.Owner;if(t!==r){let i=ra.DistancePoint(new ra(t),e.lowerSite.point),n=ra.DistancePoint(new ra(r),e.upperSite.point);e.Capacity=(i+n)/2}}SetVertexTriangles(){let e=eC(Array.from(this.cdt.GetTriangles()).map(e=>eR(e,e.BoundingBox())));tK(e,eC(this.vertexArray.map(e=>eR(e,M.mkOnPoints([e.Point])))),(e,t)=>this.TryToAssigenTriangleToVertex(e,t))}TryToAssigenTriangleToVertex(e,t){if(null==t.Triangle)ng.PointIsInsideOfTriangle(t.Point,e)&&(t.Triangle=e)}static CapacityOverflowPenaltyMultiplier(e){return e.CapacityOverflowCoefficient*(e.PathLengthImportance+e.InkImportance)}FillCrossedCdtEdges(e){for(let t of this.geomEdges)for(let r of(this.sourceLoosePoly=this.SetPortVerticesAndObstacles(t.sourcePort,!0),this.targetLoosePoly=this.SetPortVerticesAndObstacles(t.targetPort,!1),this.EdgesToRoutes.get(t)))for(let i of this.CrossedCdtEdgesOfBoneEdge(r))!this.AdjacentToSourceOrTarget(i)&&ez(e,t,i)}}class sk{constructor(e,t,r,i,n){this.multiEdges=e,this.interactiveEdgeRouter=t,this.bundlingSettings=i,this.bundlingSettings.edgeWidthShrinkCoeff=1,this.transparentShapeSetter=n,this.nodeTree=eI(r,e=>e.boundingBox)}run(){for(let e of this.GetIndependantPreGraphs())new sI(e.edges,new sO(this.transparentShapeSetter,null,null),this.interactiveEdgeRouter.VisibilityGraph,this.bundlingSettings,this.interactiveEdgeRouter.LoosePadding,this.interactiveEdgeRouter.TightHierarchy,this.interactiveEdgeRouter.LooseHierarchy,null,null,null).run()}GetPortCurve(e){return this.nodeTree.FirstHitNodeWithPredicate(e.Location,(e,t)=>C.PointRelativeToCurveLocation(e,t)!==el.Outside?eu.Stop:eu.Continue).UserData}GetIndependantPreGraphs(){let e=this.CreateInitialPregraphs();for(;;){let t=e.length,r={preGraphs:e};if(this.UniteConnectedPreGraphs(r),t<=e.length)break}return e}UniteConnectedPreGraphs(e){let t=sk.GetIntersectionGraphOfPreGraphs(e.preGraphs);if(null==t)return;let r=t9(t),i=[];for(let t of r){let r=null;for(let n of t)null==r?(r=e.preGraphs[n],i.push(r)):r.AddGraph(e.preGraphs[n])}for(let t of(e.preGraphs=i,e.preGraphs))this.AddIntersectingNodes(t)}AddIntersectingNodes(e){let t=e.boundingBox;for(let r of this.nodeTree.GetNodeItemsIntersectingRectangle(t))e.AddNodeBoundary(r)}static GetIntersectionGraphOfPreGraphs(e){let t=sk.EnumeratePairsOfIntersectedPreGraphs(e);return t.length?rt(t,e.length):null}static EnumeratePairsOfIntersectedPreGraphs(e){let t=eI(Array.from(Array(e.length).keys()),t=>e[t].boundingBox),r=[];return tJ(t,t,(e,t)=>r.push(new ri(e,t))),r}CreateInitialPregraphs(){return this.multiEdges.map(e=>this.CreatePregraphFromSetOfEdgeGeometries(e))}CreatePregraphFromSetOfEdgeGeometries(e){let t=new Set,r=e[0],i=this.GetPortCurve(r.sourcePort),n=i.boundingBox;for(let e of(t.add(i),t.add(r.targetPort.Curve),n.addRec(r.targetPort.Curve.boundingBox),this.nodeTree.GetNodeItemsIntersectingRectangle(n)))t.add(e);return sr.constructorStatic(e,t)}}class sN{constructor(){this.triangles=new Set}setCdt(e){this.cdt=e,this.cdt.SetInEdges();let t=new Set;for(let r of e.GetTriangles())for(let e of r.Sites)null!=e.Owner&&t.add(e.Owner)}outsideOfObstacles(e){var t;if(null==e)return!1;let r=null!==(t=e.Sites.item0.Owner)&&void 0!==t?t:e.Sites.item1.Owner;return r===this.sourcePoly||r===this.targetPoly||!function(e){return null==e.Sites.item0.Owner||null==e.Sites.item1.Owner||null==e.Sites.item2.Owner||e.Sites.item0.Owner==e.Sites.item1.Owner&&e.Sites.item0.Owner==e.Sites.item2.Owner}(e)}run(e){if(this.triangles.clear(),this.poly=e,this.d=[],e.count<=2||null==this.cdt)return;this.sourcePoly=this.findPoly(e.start),this.targetPoly=this.findPoly(e.end),this.findChannelTriangles();let t=this.getPerimeterEdges(),r=new ng([],[],Array.from(t=this.fillTheCollapedSites(t)).map(e=>({A:e.lowerSite.point,B:e.upperSite.point})));r.run();let i=this.getSleeve(this.findSourceTriangle(r));if(null==i){console.log("failed to create sleeve");return}if(0==i.length){this.poly=A.mkFromPoints([e.start,e.end]);return}this.initDiagonals(i),this.refineFunnel()}getAllCrossedTriangles(e,t,r){let i=[],n=[],s=null;for(n.push(e);n.length>0;){let e=n.pop();if(null==s&&e.containsPoint(r)&&(s=e),e.intersectsLine(t,r,0))for(let t of(i.push(e),e.Edges)){let r=t.GetOtherTriangle_T(e);r&&!i.includes(r)&&!n.includes(r)&&n.push(r)}}return{triangles:i,containsEnd:s}}findChannelTriangles(){let e=this.cdt.FindSite(this.poly.start).Triangles().next().value;this.triangles.clear();for(let t=this.poly.startPoint;null!=t.next;t=t.next){let r=this.getAllCrossedTriangles(e,t.point,t.next.point);for(let t of(e=r.containsEnd,r.triangles))this.outsideOfObstacles(t)&&this.triangles.add(t)}}findPoly(e){var t;for(let r of this.cdt.FindSite(e).Edges)return null!==(t=r.lowerSite.Owner)&&void 0!==t?t:r.upperSite.Owner}fillTheCollapedSites(e){let t=new Map;for(let t of e)i(t.lowerSite,t),i(t.upperSite,t);let r=[];for(let[e,i]of t)i.length>2&&r.push(e);if(0==r.length)return e;for(let e of r)for(let t of e.Triangles())this.outsideOfObstacles(t)&&this.triangles.add(t);return this.getPerimeterEdges();function i(e,r){let i=t.get(e);null==i&&t.set(e,i=[]),i.push(r)}}findSourceTriangle(e){let t;for(let r of e.GetTriangles())if(r.containsPoint(this.poly.start)){t=r;break}return t}refineFunnel(){let e;let t=[],r=this.poly.start,i={point:r},n={point:r},s={point:this.d[0].left,prev:i},o={point:this.d[0].right,prev:n};i.next=s,n.next=o;for(let e=1;e<this.d.length;e++)l(e,this.d);this.d.push({right:this.poly.end,left:s.point}),l(this.d.length-1,this.d);let a=A.mkFromPoints(t);for(let e=n;null!=e;e=e.next)a.addPoint(e.point);function l(a,l){if(l[a-1].left!==l[a].left){e=l[a].left;let u=s;for(;!(h(u)||function(t){return g.pointToTheLeftOfLine(e,t.prev.point,t.point)}(u));u=u.prev);h(u)?function(){var a;let l=n;for(;!(null==(a=l).next||g.pointToTheLeftOfLineOrOnLine(e,a.point,a.next.point));)l=l.next;if(!h(l)){let e=n;for(;!e.point.equal(l.point);e=e.next)t.push(e.point);n.point=e.point,n.next=e.next,r=e.point,o.point.equal(n.point)&&(o.prev=o.next=null)}i.point=r,s.point=e,s.prev=i,i.next=s}():function(t){t!=s?(s.point=e,s.prev=t):s={point:e,prev:t},t.next=s}(u)}else{e=l[a].right;let u=o;for(;!(h(u)||function(t){return g.pointToTheRightOfLine(e,t.prev.point,t.point)}(u));u=u.prev);h(u)?function(){var a;let l=i;for(;!(null==(a=l).next||g.pointToTheRightOfLineOrOnLine(e,a.point,a.next.point));)l=l.next;if(!h(l)){let e=i;for(;!e.point.equal(l.point);e=e.next)t.push(e.point);i.point=e.point,i.next=e.next,r=e.point,s.point.equal(i.point)&&(s.prev=i.next=null)}n.point=r,o.point=e,o.prev=n,n.next=o}():function(t){t!=o?(o.point=e,o.prev=t):o={point:e,prev:t},t.next=o}(u)}}this.poly=a;function h(e){return e.point==r}}initDiagonals(e){for(let t of e){let e=t.edge,r=t.source.OppositeSite(e);g.getTriangleOrientation(r.point,e.lowerSite.point,e.upperSite.point)==eo.Counterclockwise?this.d.push({left:e.upperSite.point,right:e.lowerSite.point}):this.d.push({right:e.upperSite.point,left:e.lowerSite.point})}}getSleeve(e){let t=new eq.Queue;t.enqueue(e);let r=new Map;for(r.set(e,void 0);t.length>0;){let i=t.dequeue(),n=r.get(i);if(i.containsPoint(this.poly.end))return this.recoverPath(e,r,i);for(let e of i.Edges){if(e.constrained||void 0!==n&&e===n)continue;let s=e.GetOtherTriangle_T(i);if(null!=s)!r.has(s)&&(r.set(s,e),t.enqueue(s))}}}recoverPath(e,t,r){let i=[];for(let n=r;n!=e&&n!==e;){let e=t.get(n);n=e.GetOtherTriangle_T(n),i.push({source:n,edge:e})}return i.reverse()}getPerimeterEdges(){let e=new Set;for(let t of this.triangles)for(let r of t.Edges)!this.triangles.has(r.GetOtherTriangle_T(t))&&e.add(r);return e}}class sL extends e0{get ContinueOnOverlaps(){return this.continueOnOverlaps}set ContinueOnOverlaps(e){this.continueOnOverlaps=e}get LoosePadding(){return this.loosePadding}set LoosePadding(e){this.loosePadding=e}get MultiEdgesSeparation(){return this.multiEdgesSeparation}set MultiEdgesSeparation(e){this.multiEdgesSeparation=e}static mk2(e,t){return sL.mk5(e,t.Padding,t.PolylinePadding,t.ConeAngle,t.bundlingSettings)}static mk4(e,t,r,i){return new sL(e,Array.from(e.deepEdges),t,r,i,null)}static mk5(e,t,r,i,n){return new sL(e,Array.from(e.deepEdges),t,r,i,n)}constructor(e,t,r=1,i=2,n=Math.PI/180*30,s=null,o=null){super(o),this.continueOnOverlaps=!0,this.shapesToTightLooseCouples=new Map,this.multiEdgesSeparation=.5,this.routeMultiEdgesAsBundles=!0,this.UsePolylineEndShortcutting=!0,this.UseInnerPolylingShortcutting=!0,this.AllowedShootingStraightLines=!0,this._overlapsDetected=!1,this.edges=t,this.BundlingSettings=s,this.geomGraph=e,this.LoosePadding=i,this.tightPadding=r,this.coneAngle=n,this.routeMultiEdgesAsBundles=t.length<1e3&&e.deepNodeCount<1e3}static mk6(e,t,r,i,n,s){let o=sL.mk4(e,t,r,i),a=tX.GetShapes(n,s);return o.Initialize(a,i),o}Initialize(e,t){this.rootShapes=e.filter(e=>null==e.Parents||0===e.Parents.length),this.coneAngle=t,0===this.coneAngle&&(this.coneAngle=Math.PI/6)}run(){if(0==this.edges.length||this.geomGraph.isEmpty())return;console.time("SplineRouter");let e=rM.GetShapes(this.geomGraph,this.edges);null==this.BundlingSettings&&this.geomGraph.layoutSettings&&this.geomGraph.layoutSettings.commonSettings.edgeRoutingSettings&&this.geomGraph.layoutSettings.commonSettings.edgeRoutingSettings.bundlingSettings&&(this.BundlingSettings=this.geomGraph.layoutSettings.commonSettings.edgeRoutingSettings.bundlingSettings),this.Initialize(e,this.coneAngle),this.GetOrCreateRoot(),this.RouteOnRoot(),this.RemoveRoot(),console.timeEnd("SplineRouter")}rerouteOnSubsetOfNodes(e){this.RouteMultiEdgesAsBundles=!1,this.edges=Array.from(this.geomGraph.deepEdges).filter(t=>eQ(t.edge,e));let t=rM.GetShapes(this.geomGraph,this.edges);this.rootShapes=t.filter(e=>null==e.Parents||0===e.Parents.length),this.GetOrCreateRoot(),this.CalculateShapeToBoundaries(this.root),this.calcLooseShapesToNodes(),this.CalculatePortsToShapes(),this.rerouteOnActiveNodes(e),this.RemoveRoot()}calcLooseShapesToNodes(){if(this.loosePolylinesToNodes=new Map,!this.OverlapsDetected){for(let[e,t]of this.shapesToTightLooseCouples)this.loosePolylinesToNodes.set(t.LooseShape.BoundaryCurve,new Set([e.node.node]));return}let e=eI(this.geomGraph.nodesBreadthFirst,e=>e.boundingBox);tK(this.GetLooseHierarchy(),e,(e,t)=>{if(C.CurveIsInsideOther(t.boundaryCurve,e)){let r=this.loosePolylinesToNodes.get(e);for(let r of t.getAncestors()){if(!(r instanceof ti)||null!=r.parent){if(null!=r.boundaryCurve&&C.CurveIsInsideOther(r.boundaryCurve,e))return}}null==r&&this.loosePolylinesToNodes.set(e,r=new Set),r.add(t.node)}})}RouteOnRoot(){if(t6(0),this.CalculatePortsToShapes(),this.CalculatePortsToEnterableShapes(),this.CalculateShapeToBoundaries(this.root),!this.OverlapsDetected||!!this.ContinueOnOverlaps)this.BindLooseShapes(),this.SetLoosePolylinesForAnywherePorts(),this.CalculateVisibilityGraph(),this.RouteOnVisGraph()}CalculatePortsToEnterableShapes(){for(let[e,t]of(this.portsToEnterableShapes=new Map,this.portsToShapes)){let r=new Set;!sL.EdgesAttachedToPortAvoidTheNode(e)&&r.add(t),this.portsToEnterableShapes.set(e,r)}for(let e of this.rootShapes)for(let t of e.Descendants())for(let e of t.Ports)eV(this.portsToEnterableShapes.get(e),Array.from(t.Ancestors()).filter(e=>null!=e.BoundaryCurve))}static EdgesAttachedToPortAvoidTheNode(e){return e instanceof tH||e instanceof tj}SetLoosePolylinesForAnywherePorts(){for(let[e,t]of this.shapesToTightLooseCouples)for(let r of e.Ports)r instanceof tz&&(r.LoosePolyline=t.LooseShape.BoundaryCurve),r instanceof tj&&(r.LoosePolyline=t.LooseShape.BoundaryCurve)}BindLooseShapes(){for(let e of(this.looseRoot=new ts,this.root.Children)){let t=this.shapesToTightLooseCouples.get(e).LooseShape;this.BindLooseShapesUnderShape(e),this.looseRoot.AddChild(t)}}BindLooseShapesUnderShape(e){let t=this.shapesToTightLooseCouples.get(e).LooseShape;for(let r of e.Children){let e=this.shapesToTightLooseCouples.get(r).LooseShape;t.AddChild(e),this.BindLooseShapesUnderShape(r)}}CalculateShapeToBoundaries(e){if(this.ProgressStep(),0===e.Children.length)return;for(let t of e.Children)this.CalculateShapeToBoundaries(t);let t=Number.POSITIVE_INFINITY;this.obstacleCalculator=new ru(e,this.tightPadding,Math.min(this.AdjustedLoosePadding,t),this.shapesToTightLooseCouples),this.obstacleCalculator.Calculate(.01),this.OverlapsDetected||(this.OverlapsDetected=this.obstacleCalculator.OverlapsDetected)}get OverlapsDetected(){return this._overlapsDetected}set OverlapsDetected(e){this._overlapsDetected=e}get AdjustedLoosePadding(){return null==this.BundlingSettings?this.LoosePadding:this.LoosePadding*sI.SuperLoosePaddingCoefficient}GroupEdgesByPassport(){let e=[];for(let t of this.edges){let r=this.EdgePassport(t),i=e.find(e=>eG(e.passport,r));!i&&(i={passport:r,edges:[]},e.push(i)),i.edges.push(t)}return e}RouteOnVisGraph(){if(this.ancestorSets=sL.GetAncestorSetsMap(Array.from(this.root.Descendants())),null==this.BundlingSettings){let e=this.GroupEdgesByPassport();for(let t=0;t<e.length;t++){let r=e[t],i=r.passport,n=this.GetObstaclesFromPassport(i),s=this.CreateInteractiveEdgeRouter(Array.from(n));this.RouteEdgesWithTheSamePassport(r,s,n)}}else this.RouteBundles()}rerouteOnActiveNodes(e){if(this.ancestorSets=sL.GetAncestorSetsMap(Array.from(this.root.Descendants())),null==this.BundlingSettings)for(let t of this.GroupEdgesByPassport()){let r=t.passport,i=this.GetObstaclesFromPassport(r),n=new Set;for(let t of i){let r=this.LooseShapeOfOriginalShape(t);for(let i of this.loosePolylinesToNodes.get(r.BoundaryCurve))e.has(i)&&n.add(t)}let s=this.CreateInteractiveEdgeRouter(Array.from(n));this.rerouteEdgesWithTheSamePassportActiveNodes(t,s,n,e)}else this.RouteBundles()}getDebugCurvesFromEdgesAndCdt(e){let t=Array.from(this.geomGraph.deepEdges).map(e=>e.curve).filter(e=>null!=e).filter(e=>e.count>5).map(e=>r0.mkDebugCurveTWCI(200,1,"Red",e));for(let r of e.PointsToSites.values())for(let e of r.Edges)t.push(r0.mkDebugCurveTWCI(200,.5,e.constrained?"Blue":"Green",b.mkPP(e.lowerSite.point,e.upperSite.point)));return t}RouteEdgesWithTheSamePassport(e,t,r){let i={regularEdges:[],multiEdges:[]};try{let e=this.getCdtFromPassport(r);t.pathOptimizer.setCdt(e)}catch(e){t.pathOptimizer.setCdt(null)}if(this.RouteMultiEdgesAsBundles){if(this.SplitOnRegularAndMultiedges(e.edges,i),i.regularEdges.length>0)for(let e=0;e<i.regularEdges.length;e++)this.routeEdge(t,i.regularEdges[e]);null!=i.multiEdges&&(this.ScaleDownLooseHierarchy(t,r),this.RouteMultiEdges(i.multiEdges,t,e.passport))}else for(let r=0;r<e.edges.length;r++)this.routeEdge(t,e.edges[r])}rerouteEdgesWithTheSamePassportActiveNodes(e,t,r,i){let n={regularEdges:[],multiEdges:[]};try{let e=this.getCdtFromPassport(r);t.pathOptimizer.setCdt(e)}catch(e){console.log(e),t.pathOptimizer.setCdt(null)}if(this.RouteMultiEdgesAsBundles){if(this.SplitOnRegularAndMultiedges(e.edges,n),n.regularEdges.length>0)for(let e=0;e<n.regularEdges.length;e++){let r=n.regularEdges[e];eX.assert(eQ(r.edge,i)),this.rerouteEdge(t,r)}null!=n.multiEdges&&(this.ScaleDownLooseHierarchy(t,r),this.RouteMultiEdges(n.multiEdges,t,e.passport))}else for(let r=0;r<e.edges.length;r++){let n=e.edges[r];eQ(n.edge,i)&&this.rerouteEdge(t,n)}}rerouteEdge(e,t){try{e.rerouteEdge(t),rP.trimSplineAndCalculateArrowheadsII(t,t.sourcePort.Curve,t.targetPort.Curve,t.curve,!1)}catch(e){console.log("failed")}}getCdtFromPassport(e){let t=new Set,r=[],i=M.mkEmpty();for(let n of e){let e=this.LoosePolyOfOriginalShape(n);if(null!=e){for(let i of(t.add(e),n.Ports))r.push(i.Location);i.addRecSelf(e.boundingBox)}}i.pad(Math.max(i.diagonal/4,100));let n=Array.from(t);n.push(i.perimeter());let s=new ng(r,n,[]);return s.run(),s}get RouteMultiEdgesAsBundles(){return this.routeMultiEdgesAsBundles}set RouteMultiEdgesAsBundles(e){this.routeMultiEdgesAsBundles=e}routeEdge(e,t){let r=this.makeTransparentShapesOfEdgeAndGetTheShapes(t);this.ProgressStep(),this.RouteEdgeInternal(t,e),sL.SetTransparency(r,!1)}ScaleDownLooseHierarchy(e,t){let r=[];for(let e of t){let t=this.shapesToTightLooseCouples.get(e);r.push(rl.LoosePolylineWithFewCorners(t.TightPolyline,t.Distance/1.1,0))}e.LooseHierarchy=sL.CreateLooseObstacleHierarachy(r),e.ClearActivePolygons(),e.AddActivePolygons(r.map(e=>new ra(e)))}RouteMultiEdges(e,t,r){let i=[];for(let e of r)for(let t of e.Children)i.push(t.BoundaryCurve);let n=new tW;n.InkImportance=1e-5,n.EdgeSeparation=this.MultiEdgesSeparation,new sk(e,t,i,n,e=>this.makeTransparentShapesOfEdgeAndGetTheShapes(e)).run()}SplitOnRegularAndMultiedges(e,t){let r=new rE;for(let i of e)sL.IsEdgeToParent(i)?t.regularEdges.push(i):sL.RegisterInPortLocationsToEdges(i,r);for(let e of(t.multiEdges=null,r.values()))1===e.length||this.OverlapsDetected?eB(t.regularEdges,e):(null==t.multiEdges&&(t.multiEdges=[]),t.multiEdges.push(e))}static RegisterInPortLocationsToEdges(e,t){let r;let i=new ek(e.sourcePort.Location,e.targetPort.Location);!(r=t.get(i))&&(r=[],t.set(i,r)),r.push(e)}static IsEdgeToParent(e){return e.sourcePort instanceof tz||e.targetPort instanceof tz}CreateInteractiveEdgeRouter(e){let t=new Set(e.map(e=>this.shapesToTightLooseCouples.get(e).LooseShape.BoundaryCurve)),r=new rT(this.cancelToken);return r.pathOptimizer=new sN,r.ObstacleCalculator=new rl(e.map(e=>e.BoundaryCurve),this.tightPadding,this.loosePadding,!1),r.VisibilityGraph=this.visGraph,r.TightHierarchy=this.CreateTightObstacleHierarachy(e),r.LooseHierarchy=sL.CreateLooseObstacleHierarachy(Array.from(t)),r.UseSpanner=!0,r.LookForRoundedVertices=!0,r.TightPadding=this.tightPadding,r.LoosePadding=this.LoosePadding,r.UseEdgeLengthMultiplier=this.UseEdgeLengthMultiplier,r.UsePolylineEndShortcutting=this.UsePolylineEndShortcutting,r.UseInnerPolylingShortcutting=this.UseInnerPolylingShortcutting,r.AllowedShootingStraightLines=this.AllowedShootingStraightLines,r.AddActivePolygons(Array.from(t).map(e=>new ra(e))),r}GetObstaclesFromPassport(e){if(0===e.size)return new Set(this.root.Children);let t=this.GetCommonAncestorsAbovePassport(e),r=this.GetAllAncestors(e),i=new Set;for(let t of e)for(let e of t.Children)!r.has(e)&&i.add(e);let n=eD(new Set(e),i),s=new eq.Queue;for(let r of e)!t.has(r)&&s.enqueue(r);for(;s.length>0;)for(let e of s.dequeue().Parents){for(let t of e.Children)!r.has(t)&&i.add(t);!t.has(e)&&!n.has(e)&&(s.enqueue(e),n.add(e))}return i}GetAllAncestors(e){if(0===e.size)return new Set;let t=new Set(e);for(let r of e)t=eD(t,this.ancestorSets.get(r));return t}GetCommonAncestorsAbovePassport(e){if(0===e.size)return new Set;let t=Array.from(e),r=this.ancestorSets.get(t[0]);for(let e=1;e<t.length;e++){let i=t[e];r=eF(r,this.ancestorSets.get(i))}return r}RouteBundles(){this.ScaleLooseShapesDown(),this.CalculateEdgeEnterablePolylines();let e=this.GetLooseHierarchy(),t=nm(e),r=new sO(e=>this.makeTransparentShapesOfEdgeAndGetTheShapes(e),t,this.FindCdtGates(t));new sI(this.edges,r,this.visGraph,this.BundlingSettings,this.LoosePadding,this.GetTightHierarchy(),e,this.enterableLoose,this.enterableTight,e=>this.LoosePolyOfOriginalShape(this.portsToShapes.get(e))).run()}CreateTheMapToParentLooseShapes(e,t){for(let r of e.Children){let i=this.shapesToTightLooseCouples.get(r).LooseShape.BoundaryCurve;t.set(i,e),this.CreateTheMapToParentLooseShapes(r,t)}}FindCdtGates(e){let t=new Map;this.CreateTheMapToParentLooseShapes(this.root,t);let r=new Set;for(let i of e.PointsToSites.values())for(let e of i.Edges){if(null==e.CwTriangle&&null==e.CcwTriangle)continue;let n=i.Owner,s=e.lowerSite.Owner;if(n===s)continue;let o=t.get(n);o&&o===t.get(s)&&r.add(e)}return r}CalculateEdgeEnterablePolylines(){for(let e of(this.enterableLoose=new Map,this.enterableTight=new Map,this.edges)){let t=new Set,r=new Set;this.GetEdgeEnterablePolylines(e,t,r),this.enterableLoose.set(e,t),this.enterableTight.set(e,r)}}GetEdgeEnterablePolylines(e,t,r){let i=this.portsToShapes.get(e.sourcePort),n=this.portsToShapes.get(e.targetPort);i!==this.root&&this.GetEnterablesForShape(i,t,r),n!==this.root&&this.GetEnterablesForShape(n,t,r)}GetEnterablesForShape(e,t,r){for(let i of this.ancestorSets.get(e)){let e=this.LoosePolyOfOriginalShape(i);e&&t.add(e);let n=this.TightPolyOfOriginalShape(i);n&&r.add(n)}}GetTightHierarchy(){return eC(Array.from(this.shapesToTightLooseCouples.values()).map(e=>eR(e.TightPolyline,e.TightPolyline.boundingBox)))}GetLooseHierarchy(){let e=new Set;for(let t of this.shapesToTightLooseCouples.values())e.add(t.LooseShape.BoundaryCurve);return eC(Array.from(e).map(e=>eR(e,e.boundingBox)))}ScaleLooseShapesDown(){for(let[,e]of this.shapesToTightLooseCouples)e.LooseShape.BoundaryCurve=rl.LoosePolylineWithFewCorners(e.TightPolyline,e.Distance/sI.SuperLoosePaddingCoefficient,0)}EdgePassport(e){let t=new Set,r=this.portsToShapes.get(e.sourcePort),i=this.portsToShapes.get(e.targetPort);return this.IsAncestor(r,i)?(eV(t,i.Parents),t.add(r),t):this.IsAncestor(i,r)?(eV(t,r.Parents),t.add(i),t):(r!==this.looseRoot&&eV(t,r.Parents),i!==this.looseRoot&&eV(t,i.Parents),t)}*AllPorts(){for(let e of this.edges)yield e.sourcePort,yield e.targetPort}CalculatePortsToShapes(){for(let e of(this.portsToShapes=new Map,this.root.Descendants()))for(let t of e.Ports)this.portsToShapes.set(t,e);for(let e of this.AllPorts())!this.portsToShapes.has(e)&&(this.root.Ports.add(e),this.portsToShapes.set(e,this.root))}RouteEdgeInternal(e,t){let r=[];!(e.sourcePort instanceof tz)&&eB(r,this.AddVisibilityEdgesFromPort(e.sourcePort)),!(e.targetPort instanceof tz)&&eB(r,this.AddVisibilityEdgesFromPort(e.targetPort));let i={smoothedPolyline:null};if(g.closeDistEps(e.sourcePort.Location,e.targetPort.Location)?e.curve=V.RouteSelfEdge(e.sourcePort.Curve,Math.max(2*this.LoosePadding,e.GetMaxArrowheadLength()),i):e.curve=t.RouteSplineFromPortToPortWhenTheWholeGraphIsReady(e.sourcePort,e.targetPort,!0,i),e.smoothedPolyline=null,null==e.curve)throw Error();for(let e of r)tT.RemoveEdge(e);rP.trimSplineAndCalculateArrowheadsII(e,e.sourcePort.Curve,e.targetPort.Curve,e.curve,!1)}*AddVisibilityEdgesFromPort(e){let t,r;if(!(e instanceof tH)&&!!(t=this.portsToShapes.get(e))&&!!(r=this.shapesToTightLooseCouples.get(t)))for(let t of r.LooseShape.BoundaryCurve)null==this.visGraph.FindEdgePP(e.Location,t)&&(yield this.visGraph.AddEdgePP(e.Location,t))}makeTransparentShapesOfEdgeAndGetTheShapes(e){let t=this.portsToShapes.get(e.sourcePort),r=this.portsToShapes.get(e.targetPort),i=[];for(let n of this.GetTransparentShapes(e.sourcePort,e.targetPort,t,r))null!=n&&i.push(this.LooseShapeOfOriginalShape(n));for(let t of this.portsToEnterableShapes.get(e.sourcePort))i.push(this.LooseShapeOfOriginalShape(t));for(let t of this.portsToEnterableShapes.get(e.targetPort))i.push(this.LooseShapeOfOriginalShape(t));return sL.SetTransparency(i,!0),i}LooseShapeOfOriginalShape(e){return e===this.root?this.looseRoot:this.shapesToTightLooseCouples.get(e).LooseShape}LoosePolyOfOriginalShape(e){return this.LooseShapeOfOriginalShape(e).BoundaryCurve}TightPolyOfOriginalShape(e){return e===this.root?null:this.shapesToTightLooseCouples.get(e).TightPolyline}*GetTransparentShapes(e,t,r,i){for(let e of this.ancestorSets.get(r))yield e;for(let e of this.ancestorSets.get(i))yield e;!sL.EdgesAttachedToPortAvoidTheNode(e)&&(yield r),!sL.EdgesAttachedToPortAvoidTheNode(t)&&(yield i)}static SetTransparency(e,t){for(let r of e)r.IsTransparent=t}IsAncestor(e,t){let r;return null!=t&&null!=(r=this.ancestorSets.get(t))&&r.has(e)}static CreateLooseObstacleHierarachy(e){return eC(e.map(e=>eR(e,e.boundingBox)))}CreateTightObstacleHierarachy(e){return eC(e.map(e=>this.shapesToTightLooseCouples.get(e).TightPolyline).map(e=>eR(e,e.boundingBox)))}CalculateVisibilityGraph(){let e=null!=this.LineSweeperPorts?eN.mk(this.LineSweeperPorts):new eN;this.ProcessHookAnyWherePorts(e),this.portRTree=e9(Array.from(e.values()).map(e=>[M.rectangleOnPoint(e),e])),this.visGraph=new tT,this.FillVisibilityGraphUnderShape(this.root)}ProcessHookAnyWherePorts(e){for(let t of this.edges)!(t.sourcePort instanceof tz||t.sourcePort instanceof tj)&&e.add(t.sourcePort.Location),!(t.targetPort instanceof tz||t.targetPort instanceof tj)&&e.add(t.targetPort.Location)}FillVisibilityGraphUnderShape(e){let t=e.Children;for(let e=0;e<t.length;e++){let r=t[e];this.FillVisibilityGraphUnderShape(r)}let r=this.shapesToTightLooseCouples.get(e),i=r?r.LooseShape.BoundaryCurve:null,n=r?r.LooseShape:this.looseRoot,s=new Set(n.Children.map(e=>e.BoundaryCurve)),o=this.RemoveInsidePortsAndSplitBoundaryIfNeeded(i),a=new tT,l=tU.mk([],a,this.coneAngle,o,i);for(let e of(l.run(),a=new tT,(l=tU.mk(Array.from(s),a,this.coneAngle,o,i)).run(),this.ProgressStep(),a.Edges))this.TryToCreateNewEdgeAndSetIsPassable(e,n);this.AddBoundaryEdgesToVisGraph(i)}TryToCreateNewEdgeAndSetIsPassable(e,t){let r=this.visGraph.FindEdgePP(e.SourcePoint,e.TargetPoint);if(null==r)r=this.visGraph.AddEdgePP(e.SourcePoint,e.TargetPoint),null!=t&&(r.IsPassable=()=>t.IsTransparent)}AddBoundaryEdgesToVisGraph(e){let t;if(null!=e)for(let r=e.startPoint;t=r.nextOnPolyline,this.visGraph.AddEdgePP(r.point,t.point),t!==e.startPoint;r=t);}RemoveInsidePortsAndSplitBoundaryIfNeeded(e){let t=new eN;if(null==e){for(let e of this.portRTree.GetAllLeaves())t.add(e);return this.portRTree.clear(),t}let r=e.boundingBox;for(let i of this.portRTree.GetAllIntersecting(r))switch(C.PointRelativeToCurveLocation(i,e)){case el.Inside:t.add(i),this.portRTree.Remove(M.rectangleOnPoint(i),i);break;case el.Boundary:this.portRTree.Remove(M.rectangleOnPoint(i),i);let r=sL.FindPointOnPolylineToInsertAfter(e,i);if(null!=r)tG.InsertPointIntoPolylineAfter(e,r,i);else throw Error()}return t}static FindPointOnPolylineToInsertAfter(e,t){for(let r=e.startPoint;;){let i=r.nextOnPolyline;if(g.closeDistEps(t,r.point)||g.closeDistEps(t,i.point))return null;if(c(g.distToLineSegment(t,r.point,i.point).dist,0))return r;if((r=i)===e.startPoint)throw Error()}}GetOrCreateRoot(){if(1===this.rootShapes.length){let e=this.rootShapes[0];if(null==e.BoundaryCurve){this.root=e;return}}for(let e of(this.rootWasCreated=!0,this.root=new ts(null),this.rootShapes))this.root.AddChild(e)}RemoveRoot(){if(this.rootWasCreated){for(let e of this.rootShapes)e.RemoveParent(this.root);this.root=null,this.rootWasCreated=!1}}static GetAncestorSetsMap(e){let t=new Map;for(let r of e.filter(e=>!t.has(e)))t.set(r,sL.GetAncestorSet(r,t));return t}static GetAncestorSet(e,t){let r=new Set(e.Parents);for(let i of e.Parents){let e=t.get(i);for(let n of(!e&&t.set(i,e=sL.GetAncestorSet(i,t)),e))r.add(n)}return r}static CreatePortsIfNeeded(e){for(let t of e){if(null==t.sourcePort){let e=t;new tl(()=>e.source.boundaryCurve,()=>e.source.center,new g(0,0))}if(null==t.targetPort){let e=t;new tl(()=>e.target.boundaryCurve,()=>e.target.center,new g(0,0))}}}}class sD extends rr{constructor(e,t){super(),this.SetEdges(e,t)}}class sB{*RegularMultiedges(){for(let[e,t]of this.Multiedges.keyValues())e.x!==e.y&&(yield t)}*AllIntEdges(){for(let e of this.Multiedges.values())for(let t of e)yield t}addFeedbackSet(e){for(let t of e){let e=new ri(t.source,t.target),r=new ri(t.target,t.source),i=this.Multiedges.get(e.x,e.y);for(let e of i)e.reverse();if(this.Multiedges.has(r.x,r.y)){let e=this.Multiedges.get(r.x,r.y);for(let t of i)e.push(t)}else this.Multiedges.set(r.x,r.y,i);this.Multiedges.delete(e.x,e.y)}}constructor(e){this.MultipleMiddles=new Set,this.Multiedges=new rR}registerOriginalEdgeInMultiedges(e){let t=this.Multiedges.get(e.source,e.target);null==t&&this.Multiedges.set(e.source,e.target,t=[]),t.push(e)}*SkeletonEdges(){for(let[e,t]of this.Multiedges.keyValues())e.x!==e.y&&(yield t[0])}GetMultiedge(e,t){return this.GetMultiedgeI(new ri(e,t))}GetMultiedgeI(e){return this.Multiedges.has(e.x,e.y)?this.Multiedges.get(e.x,e.y):[]}}function sF(e,t){for(let r=0;r<e.length;r++)t[r]=e[r]}class sV{constructor(e){this.initialize(e)}initialize(e){this.y=e,this.verticesToX=null,this.layers=null}DropEmptyLayers(){let e=Array(this.Layers.length),t=0;for(let r=0;r<this.Layers.length;r++)e[r]=t,0===this.Layers[r].length&&t++;if(0===t)return this;let r=Array(this.y.length);for(let t=0;t<r.length;t++)r[t]=this.y[t]-e[this.y[t]];let i=Array(this.layers.length-t);for(let t=0;t<this.layers.length;t++)this.layers[t].length>0&&(i[t-e[t]]=Array.from(this.layers[t]));let n=new sV(r);return n.layers=i,n}updateLayers(e){null==this.layers&&this.InitLayers();for(let t=0;t<this.layers.length;t++)sF(e[t],this.layers[t]);this.UpdateXFromLayers()}UpdateXFromLayers(){for(let e of(null==this.layers&&this.InitLayers(),null==this.verticesToX&&(this.verticesToX=Array(this.y.length)),this.layers)){let t=0;for(let r of e)this.verticesToX[r]=t++}}get x(){return null!=this.verticesToX?this.verticesToX:(this.verticesToX=Array(this.y.length),this.UpdateXFromLayers(),this.verticesToX)}ReversedClone(){let e=Array(this.y.length),t=this.Layers.length-1;for(let r=0;r<this.y.length;r++)e[r]=t-this.y[r];return new sV(e)}get Layers(){return null!=this.layers?this.layers:(this.InitLayers(),this.layers)}set Layers(e){this.layers=e}InitLayers(){let e=0;for(let t of this.y)t+1>e&&(e=t+1);let t=Array(e).fill(0);for(let e of this.y)t[e]++;this.layers=Array(e);for(let r=0;r<e;r++)this.layers[r]=Array(t[r]),t[r]=0;for(let e=0;e<this.y.length;e++){let r=this.y[e];this.layers[r][t[r]++]=e}}}class sG extends e0{static Balance(e,t,r,i){new sG(e,t,r,i).run()}constructor(e,t,r,i){super(i),this.jumpers=new Set,this.possibleJumperFeasibleIntervals=new Map,this.nodeCount=r,this.dag=e,this.layering=t,this.Init()}run(){for(;this.jumpers.size>0;)this.Jump(this.ChooseJumper())}Init(){this.CalculateLayerCounts(),this.InitJumpers()}Jump(e){this.jumpers.delete(e);let t=this.possibleJumperFeasibleIntervals.get(e),r=this.CalcJumpInfo(t.x,t.y,e);if(null==r)return;this.layering[e]=r.layerToJumpTo;let i=this.nodeCount[e];this.vertsCounts[r.jumperLayer]-=i,this.vertsCounts[r.layerToJumpTo]+=i,this.UpdateRegionsForPossibleJumpersAndInsertJumpers(r.jumperLayer,e)}IsJumper(e){return this.possibleJumperFeasibleIntervals.has(e)}UpdateRegionsForPossibleJumpersAndInsertJumpers(e,t){let r=new Set;for(let e of this.dag.pred(t))this.IsJumper(e)&&(this.CalculateRegionAndInsertJumper(e),r.add(e));for(let e of this.dag.succ(t))this.IsJumper(e)&&(this.CalculateRegionAndInsertJumper(e),r.add(e));let i=[];for(let t of this.possibleJumperFeasibleIntervals)!r.has(t[0])&&t[1].x>e&&t[1].y<e&&i.push(t[0]);for(let e of i)this.CalculateRegionAndInsertJumper(e)}InitJumpers(){let e=Array(this.dag.nodeCount).fill(0);for(let t of this.dag.edges)e[t.source]-=t.weight,e[t.target]+=t.weight;this.possibleJumperFeasibleIntervals=new Map;for(let t=0;t<this.dag.nodeCount;t++)0===e[t]&&this.CalculateRegionAndInsertJumper(t)}CalculateRegionAndInsertJumper(e){let t=new ri(this.Up(e),this.Down(e));this.possibleJumperFeasibleIntervals.set(e,t),this.InsertJumper(t.x,t.y,e)}InsertJumper(e,t,r){null!=this.CalcJumpInfo(e,t,r)&&this.jumpers.add(r)}CalcJumpInfo(e,t,r){let i=this.layering[r],n=-1,s=this.vertsCounts[i]-2*this.nodeCount[r];for(let t=e-1;t>i;t--)this.vertsCounts[t]<s&&(s=this.vertsCounts[t],n=t);for(let e=i-1;e>t;e--)this.vertsCounts[e]<s&&(s=this.vertsCounts[e],n=e);if(-1!==n)return{jumperLayer:i,layerToJumpTo:n}}Up(e){let t=Number.MAX_SAFE_INTEGER;for(let r of this.dag.inEdges[e]){let e=this.layering[r.source]-r.separation+1;e<t&&(t=e)}return t===Number.MAX_SAFE_INTEGER&&(t=this.layering[e]+1),t}Down(e){let t=Number.NEGATIVE_INFINITY;for(let r of this.dag.outEdges[e]){let e=this.layering[r.target]+r.separation-1;e>t&&(t=e)}return t===Number.NEGATIVE_INFINITY&&(t=this.layering[e]-1),t}CalculateLayerCounts(){for(let e of(this.vertsCounts=Array(Math.max(...this.layering)+1).fill(0),this.layering))this.vertsCounts[e]+=this.nodeCount[e]}ChooseJumper(){for(let e of this.jumpers)return e;throw Error("there are no jumpers to choose")}}class sU{constructor(e){this.Initialize(e)}Initialize(e){for(let t of(this.BaseGraph=e,this.totalNumberOfNodes=e.nodeCount,this.BaseGraph.edges))if(null!=t.LayerEdges)for(let e of t.LayerEdges){let t=Math.max(e.Source,e.Target)+1;t>this.totalNumberOfNodes&&(this.totalNumberOfNodes=t)}for(let e of(this.firstVirtualNode=Number.POSITIVE_INFINITY,this.BaseGraph.edges)){if(null!=e.LayerEdges)for(let t=1;t<e.LayerEdges.length;t++){let r=e.LayerEdges[t];this.firstVirtualNode=Math.min(this.firstVirtualNode,r.Source)}}for(let e of(this.firstVirtualNode===Number.POSITIVE_INFINITY&&(this.firstVirtualNode=this.BaseGraph.nodeCount,this.totalNumberOfNodes=this.BaseGraph.nodeCount),this.virtualNodesToInEdges=Array(this.totalNumberOfNodes-this.firstVirtualNode),this.virtualNodesToOutEdges=Array(this.totalNumberOfNodes-this.firstVirtualNode),this.BaseGraph.edges))if(e.LayerSpan>0)for(let t of e.LayerEdges)t.Target!==e.target&&(this.virtualNodesToInEdges[t.Target-this.firstVirtualNode]=t),t.Source!==e.source&&(this.virtualNodesToOutEdges[t.Source-this.firstVirtualNode]=t)}*edges_(){for(let e of this.BaseGraph.edges)if(e.LayerSpan>0)for(let t of e.LayerEdges)yield t}get Edges(){return this.edges_()}*InEdges(e){if(e<this.BaseGraph.nodeCount)for(let t of this.BaseGraph.inEdges[e])t.source!==t.target&&null!=t.LayerEdges&&(yield sU.LastEdge(t));else e>=this.firstVirtualNode&&(yield this.InEdgeOfVirtualNode(e))}static LastEdge(e){return e.LayerEdges[e.LayerEdges.length-1]}InEdgeOfVirtualNode(e){return this.virtualNodesToInEdges[e-this.firstVirtualNode]}*OutEdges(e){if(e<this.BaseGraph.nodeCount)for(let t of this.BaseGraph.outEdges[e])t.source!==t.target&&null!=t.LayerEdges&&(yield sU.FirstEdge(t));else e>=this.firstVirtualNode&&(yield this.OutEdgeOfVirtualNode(e))}OutDegreeIsMoreThanOne(e){return!!(e<this.BaseGraph.nodeCount)&&this.BaseGraph.outEdges[e].length>1}InDegreeIsMoreThanOne(e){return!!(e<this.BaseGraph.nodeCount)&&this.BaseGraph.inEdges[e].length>1}OutEdgeOfVirtualNode(e){return this.virtualNodesToOutEdges[e-this.firstVirtualNode]}static FirstEdge(e){return e.LayerEdges[0]}InEdgesCount(e){return this.RealInEdgesCount(e)}RealInEdgesCount(e){return e<this.BaseGraph.nodeCount?this.BaseGraph.inEdges[e].filter(e=>null!=e.LayerEdges).length:1}OutEdgesCount(e){return this.RealOutEdgesCount(e)}RealOutEdgesCount(e){return e<this.BaseGraph.nodeCount?this.BaseGraph.outEdges[e].filter(e=>null!=e.LayerEdges).length:1}get NodeCount(){return this.totalNumberOfNodes}IsRealNode(e){return e<this.BaseGraph.nodeCount}IsVirtualNode(e){return!this.IsRealNode(e)}ReversedClone(){return new sU(new sD(this.CreateReversedEdges(),this.BaseGraph.nodeCount))}CreateReversedEdges(){let e=[];for(let t of this.BaseGraph.edges)!t.isSelfEdge()&&e.push(t.reversedClone());return e}*Succ(e){for(let t of this.OutEdges(e))yield t.Target}*Pred(e){for(let t of this.InEdges(e))yield t.Source}}class sz{constructor(e,t,r,i){this.la=t,this.database=r,this.layeredGraph=e,this.intGraph=i}static InsertLayers(e,t,r,i){let n=new sz(e,t,r,i);return n.InsertLayers(),{layeredGraph:n.nLayeredGraph,la:n.Nla.DropEmptyLayers()}}get NLayering(){return this.Nla.y}InsertLayers(){this.EditOldLayering(),this.CreateFullLayeredGraph(),this.InitNewLayering(),this.MapVirtualNodesToEdges(),this.FillUnsortedNewOddLayers(),this.WidenOriginalLayers(),this.SortNewOddLayers()}EditOldLayering(){let e=this.intGraph.nodeCount;for(let t of this.database.RegularMultiedges()){let r=0,i=t[0];if((r=2*i.LayerSpan)>0){for(let t of i.LayerEdges)t.Target!==i.target&&(e++,this.UpdateOldLayer(e++,t.Target));e+=(r-1)*(t.length-1)+1}}}UpdateOldLayer(e,t){let r=this.la.x[t],i=this.la.y[t];this.la.Layers[i][r]=e}WidenOriginalLayers(){for(let e=0;e<this.la.Layers.length;e++){let t=this.Nla.Layers[2*e],r=0;for(let i of this.la.Layers[e]){let e=this.virtNodesToIntEdges[i];if(null!=e){let n=this.NLayering[e.source]-this.NLayering[i];for(let s of this.database.Multiedges.get(e.source,e.target))if(s!==e){let e=s.LayerEdges[n].Source;t[r]=e,this.Nla.x[e]=r++}else t[r]=i,this.Nla.x[i]=r++}else t[r]=i,this.Nla.x[i]=r++}}}FillUnsortedNewOddLayers(){let e=Array(this.Nla.Layers.length).fill(0);for(let t=this.intGraph.nodeCount;t<this.nLayeredGraph.NodeCount;t++){let r=this.NLayering[t];r%2==1&&(this.Nla.Layers[r][e[r]++]=t)}}MapVirtualNodesToEdges(){for(let e of(this.virtNodesToIntEdges=Array(this.NLayering.length),this.database.AllIntEdges()))if(e.source!==e.target&&null!=e.LayerEdges)for(let t of e.LayerEdges)t.Target!==e.target&&(this.virtNodesToIntEdges[t.Target]=e)}CreateFullLayeredGraph(){for(let e of(this.totalNodes=this.intGraph.nodeCount,this.database.RegularMultiedges())){let t=0,r=!0;for(let i of e)if(r&&(r=!1,t=2*i.LayerSpan),t>0){i.LayerEdges=Array(t);for(let e=0;e<t;e++){let r={currentVV:this.totalNodes},n=sj.GetSource(r,i,e);this.totalNodes=r.currentVV;let s=sj.GetTarget(this.totalNodes,i,e,t);i.LayerEdges[e]=new i0(n,s,i.CrossingWeight)}sz.RegisterDontStepOnVertex(this.database,i)}}this.nLayeredGraph=new sU(this.intGraph)}SortNewOddLayers(){for(let e=1;e<this.Nla.Layers.length;e+=2){let t=new Map,r=this.Nla.Layers[e];for(let e of r){let r=-1;for(let t of this.nLayeredGraph.InEdges(e))r=t.Source;let i=-1;for(let t of this.nLayeredGraph.OutEdges(e))i=t.Target;let n=this.Nla.x[r]+this.Nla.x[i];if(t.has(n)){let r=t.get(n);if("number"==typeof r){let i=[];i.push(r),i.push(e),t.set(n,i)}else r.push(e)}else t.set(n,e)}let i=Array.from(t.entries()).sort((e,t)=>e[0]-t[0]),n=0;for(let e of i.map(e=>e[1]))if("number"==typeof e)r[n++]=e;else for(let t of e)r[n++]=t;for(let e=0;e<r.length;e++)this.Nla.x[r[e]]=e}}InitNewLayering(){this.Nla=new sV(Array(this.totalNodes));for(let e=0;e<this.layeredGraph.NodeCount;e++)this.NLayering[e]=2*this.la.y[e];for(let[e,t]of this.database.Multiedges.keyValues())if(e.x!==e.y&&this.la.y[e.x]!==this.la.y[e.y]){let r=2*this.la.y[e.x];for(let e of t){let t=r-1;for(let r of e.LayerEdges)r.Target!==e.target&&(this.NLayering[r.Target]=t--)}}let e=Array(2*this.la.Layers.length-1),t=Array(e.length).fill(0);for(let e of this.NLayering)t[e]++;for(let r=0;r<t.length;r++)e[r]=Array(t[r]);this.Nla=new sV(this.NLayering),this.Nla.Layers=e}static RegisterDontStepOnVertex(e,t){if(e.Multiedges.get(t.source,t.target).length>1){let r=t.LayerEdges[Math.floor(t.LayerEdges.length/2)];e.MultipleMiddles.add(r.Source)}}}class sj{get NLayering(){return this.Nla.y}static InsertPaths(e,t,r,i){let n=new sj(e,t,r,i);return n.InsertPaths(),{layeredGraph:n.NLayeredGraph,la:n.Nla}}constructor(e,t,r,i){this.virtNodesToIntEdges=new Map,this.la=t,this.database=r,this.layeredGraph=e,this.intGraph=i}InsertPaths(){this.CreateFullLayeredGraph(),this.InitNewLayering(),this.MapVirtualNodesToEdges(),this.WidenOriginalLayers()}WidenOriginalLayers(){for(let e=0;e<this.la.Layers.length;e++){let t=this.Nla.Layers[e],r=0;for(let i of this.la.Layers[e]){let e=this.virtNodesToIntEdges.get(i);if(null!=e){let n=this.NLayering[e.source]-this.NLayering[i];for(let s of this.database.Multiedges.get(e.source,e.target))if(!this.EdgeIsFlat(s)){if(s!==e){let e=s.LayerEdges[n].Source;t[r]=e,this.Nla.x[e]=r++}else t[r]=i,this.Nla.x[i]=r++}}else t[r]=i,this.Nla.x[i]=r++}}}EdgeIsFlat(e){return this.la.y[e.source]===this.la.y[e.target]}MapVirtualNodesToEdges(){for(let e of this.database.RegularMultiedges())for(let t of e)if(!this.EdgeIsFlat(t))for(let e of t.LayerEdges)e.Target!==t.target&&this.virtNodesToIntEdges.set(e.Target,t)}CreateFullLayeredGraph(){let e=this.layeredGraph.NodeCount;for(let[t,r]of this.database.Multiedges.keyValues())if(t.x!==t.y){let t=!0,i=0;for(let n of r){if(t)t=!1,i=n.LayerSpan;else if(n.LayerEdges=Array(i),1===i)n.LayerEdges[0]=new i0(n.source,n.target,n.CrossingWeight);else for(let t=0;t<i;t++){let r={currentVV:e},s=sj.GetSource(r,n,t);e=r.currentVV;let o=sj.GetTarget(e,n,t,i);n.LayerEdges[t]=new i0(s,o,n.CrossingWeight)}sz.RegisterDontStepOnVertex(this.database,n)}}this.NLayeredGraph=new sU(this.intGraph)}static GetTarget(e,t,r,i){return r<i-1?e:t.target}static GetSource(e,t,r){return 0===r?t.source:e.currentVV++}InitNewLayering(){this.Nla=new sV(Array(this.NLayeredGraph.NodeCount));for(let e=0;e<this.layeredGraph.NodeCount;e++)this.NLayering[e]=this.la.y[e];for(let[e,t]of this.database.Multiedges.keyValues())if(e.x!==e.y&&this.la.y[e.x]!==this.la.y[e.y]){let e=0,r=!0;for(let i of t){r&&(r=!1,e=this.la.y[i.source]);let t=e-1;for(let e of i.LayerEdges)this.NLayering[e.Target]=t--}}let e=Array(this.la.Layers.length),t=Array(e.length).fill(0);for(let e of this.NLayering)t[e]++;for(let r=0;r<t.length;r++)e[r]=Array(t[r]);this.Nla=new sV(this.NLayering),this.Nla.Layers=e}}class sH{constructor(e,t,r){this.numberOfCrossings=t,this.la=e,this.virtVertexStart=r}LayerGroupDisbalance(e,t,r){return 1===t?this.LayerGroupDisbalanceWithOrigSeparators(e,r):this.LayerGroupDisbalanceWithVirtSeparators(e,t)}LayerGroupDisbalanceWithVirtSeparators(e,t){let r=0;for(let i=0;i<e.length;){let n=this.CurrentOrigGroupDelta(i,e,t);i=n.i,r+=n.ret}return r}CurrentOrigGroupDelta(e,t,r){let i=0,n=e;for(;n<t.length&&t[n]<this.virtVertexStart;n++)i++;return{ret:Math.abs(r-i),i:e=n+1}}LayerGroupDisbalanceWithOrigSeparators(e,t){let r=0;for(let i=0;i<e.length;){let n=this.CurrentVirtGroupDelta(i,e,t);r+=n.ret,i=n.i}return r}CurrentVirtGroupDelta(e,t,r){let i=0,n=e;for(;n<t.length&&t[n]>=this.virtVertexStart;n++)i++;return{ret:Math.abs(r-i),i:e=n+1}}static less(e,t){return e.numberOfCrossings<t.numberOfCrossings}static greater(e,t){return e.numberOfCrossings>t.numberOfCrossings}IsPerfect(){return 0===this.numberOfCrossings}}class sW{constructor(e){this.x=e}Compare(e,t){let r=this.x[e.Source]-this.x[t.Source];return 0!==r?r:this.x[e.Target]-this.x[t.Target]}}class sq{constructor(e){this.x=e}Compare(e,t){let r=this.x[e.Target]-this.x[t.Target];return 0!==r?r:this.x[e.Source]-this.x[t.Source]}}function sX(){return 0===t5(2)}function s$(e,t){return eU(e,e=>t.InEdges(e))}function sY(e,t){let r=0;for(let i=0;i<t.Layers.length-1;i++)r+=function(e,t,r){let i=r.Layers[e+1],n=r.Layers[e];return n.length<=i.length?function(e,t,r){let i=s$(e,t),n=new sW(r.x);i.sort((e,t)=>n.Compare(e,t));let s=1;for(;s<e.length;)s*=2;let o=Array(2*s-1).fill(0);s--;let a=0;for(let e of i){let t=s+r.x[e.Target],i=e.CrossingWeight;for(o[t]+=i;t>0;)t%2!=0&&(a+=i*o[t+1]),t=Math.floor((t-1)/2),o[t]+=i}return a}(n,t,r):function(e,t,r,i){let n=s$(t,r),s=new sq(i.x);n.sort((e,t)=>s.Compare(e,t));let o=1;for(;o<e.length;)o*=2;let a=Array(2*o-1).fill(0);o--;let l=0;for(let e of n){let t=o+i.x[e.Source],r=e.CrossingWeight;for(a[t]+=r;t>0;)t%2!=0&&(l+=r*a[t+1]),t=Math.floor((t-1)/2),a[t]+=r}return l}(i,n,t,r)}(i,e,t);return r}class sZ extends e0{get NoGainStepsBound(){return this.SugSettings.NoGainAdjacentSwapStepsBound*this.SugSettings.NoGainStepsForOrderingMultiplier}get SeedOfRandom(){return t5(100)}constructor(e,t,r,i,n,s,o){super(o),this.tryReverse=!0,this.MaxNumberOfAdjacentExchanges=50,this.cancelToken=o,this.tryReverse=t,this.startOfVirtNodes=i,this.layerArrays=r,this.layering=r.y,this.nOfLayers=r.Layers.length,this.layers=r.Layers,this.properLayeredGraph=e,this.hasCrossWeights=n,this.SugSettings=s}get MaxOfIterations(){return this.SugSettings.MaxNumberOfPassesInOrdering*this.SugSettings.NoGainStepsForOrderingMultiplier}static OrderLayers(e,t,r,i,n){let s=!1;for(let t of e.Edges)if(1!==t.CrossingWeight){s=!0;break}new sZ(e,!0,t,r,s,i,n).run()}run(){if(this.Calculate(),this.tryReverse){let e=this.layerArrays.ReversedClone(),t=new sZ(this.properLayeredGraph.ReversedClone(),!1,e,this.startOfVirtNodes,this.hasCrossWeights,this.SugSettings,this.cancelToken);if(t.run(),sH.less(t.measure,this.measure)){for(let t=0;t<this.nOfLayers;t++)sF(e.Layers[t],this.layerArrays.Layers[this.nOfLayers-1-t]);this.layerArrays.UpdateXFromLayers()}}}Calculate(){this.Init(),this.layerArraysCopy=sZ.CloneLayers(this.layers,this.layerArraysCopy);let e=0;this.measure=new sH(this.layerArraysCopy,sY(this.properLayeredGraph,this.layerArrays),this.startOfVirtNodes);for(let t=0;t<this.MaxOfIterations&&e<this.NoGainStepsBound&&!this.measure.IsPerfect();t++){let r=t%2==0;this.LayerByLayerSweep(r),this.AdjacentExchange();let i=new sH(this.layerArrays.Layers,sY(this.properLayeredGraph,this.layerArrays),this.startOfVirtNodes);sH.less(this.measure,i)?(this.Restore(),e++):(sH.less(i,this.measure)||sX())&&(e=0,this.layerArraysCopy=sZ.CloneLayers(this.layers,this.layerArraysCopy),this.measure=i)}}static CloneLayers(e,t){if(null==t){t=Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r].map(e=>e)}else for(let r=0;r<e.length;r++)sF(e[r],t[r]);return t}Restore(){this.layerArrays.updateLayers(this.layerArraysCopy)}LayerByLayerSweep(e){if(e)for(let e=1;e<this.nOfLayers;e++)this.SweepLayer(e,!0);else for(let e=this.nOfLayers-2;e>=0;e--)this.SweepLayer(e,!1)}SweepLayer(e,t){let r=this.layers[e],i=Array(r.length);for(let e=0;e<i.length;e++)i[e]=this.WMedian(r[e],t);this.Sort(e,i);let n=this.layerArrays.Layers[e];for(let e=0;e<n.length;e++)this.layerArrays.x[n[e]]=e}Sort(e,t){let r=new Map,i=this.layers[e],n=0;for(let e of t){let t=i[n++];if(-1!==e){if(r.has(e)){let i=r.get(e);if("number"!=typeof i){if(sX())i.push(t);else{let e=t5(i.length),r=i[e];i[e]=t,i.push(r)}}else{let n=[];r.set(e,n),sX()?(n.push(i),n.push(t)):(n.push(t),n.push(i))}}else r.set(e,t)}}let s=Array.from(r).sort((e,t)=>e[0]-t[0]).map(e=>e[1]),o=0;for(n=0;n<i.length;)if(-1!==t[n]){let e=s[o++];if("number"==typeof e)i[n++]=e;else for(let r of e){for(;-1===t[n];)n++;i[n++]=r}}else n++}WMedian(e,t){let r,i;if(t?(r=this.properLayeredGraph.OutEdges(e),i=this.properLayeredGraph.OutEdgesCount(e)):(r=this.properLayeredGraph.InEdges(e),i=this.properLayeredGraph.InEdgesCount(e)),0===i)return -1;let n=Array(i),s=0;if(t)for(let e of r)n[s++]=this.X[e.Target];else for(let e of r)n[s++]=this.X[e.Source];n.sort((e,t)=>e-t);let o=Math.floor(i/2);if(i%2==1)return n[o];if(2===i)return .5*(n[0]+n[1]);let a=n[o-1]-n[0],l=n[i-1]-n[o];return Math.floor((n[o-1]*a+n[o]*l)/(a+l))}Init(){let e=Array(this.nOfLayers).fill(0),t=new eE.Stack;for(let e=0;e<this.properLayeredGraph.NodeCount;e++)0===this.properLayeredGraph.InEdgesCount(e)&&t.push(e);let r=Array(this.properLayeredGraph.NodeCount).fill(!1);for(;t.size>0;){let i=t.pop(),n=this.layerArrays.y[i];for(let s of(this.layerArrays.Layers[n][e[n]]=i,this.layerArrays.x[i]=e[n],e[n]++,this.properLayeredGraph.Succ(i)))!r[s]&&(r[s]=!0,t.push(s))}this.X=this.layerArrays.x}AdjacentExchange(){this.InitArrays();let e=0,t=!0;for(;t&&e++<this.MaxNumberOfAdjacentExchanges;){t=!1;for(let e=0;e<this.layers.length;e++)t=this.AdjExchangeLayer(e)||t;for(let e=this.layers.length-2;e>=0;e--)t=this.AdjExchangeLayer(e)||t}}AllocArrays(){let e=this.properLayeredGraph.NodeCount;this.predecessors=Array(e),this.successors=Array(e),this.pOrder=Array(e),this.sOrder=Array(e),this.hasCrossWeights&&(this.outCrossingCount=Array(e),this.inCrossingCount=Array(e));for(let t=0;t<e;t++){let e=this.properLayeredGraph.InEdgesCount(t);if(this.predecessors[t]=Array(e),this.hasCrossWeights){let e=this.inCrossingCount[t]=new Map;for(let r of this.properLayeredGraph.InEdges(t))e.set(r.Source,r.CrossingWeight)}if(this.pOrder[t]=new Map,e=this.properLayeredGraph.OutEdgesCount(t),this.successors[t]=Array(e),this.sOrder[t]=new Map,this.hasCrossWeights){let e=this.outCrossingCount[t]=new Map;for(let r of this.properLayeredGraph.OutEdges(t))e.set(r.Target,r.CrossingWeight)}}}InitArrays(){null==this.successors&&this.AllocArrays();for(let e=0;e<this.properLayeredGraph.NodeCount;e++)this.pOrder[e]=new Map,this.sOrder[e]=new Map;for(let e of this.layers)this.InitPsArraysForLayer(e)}CalcPair(e,t){let r=this.successors[e],i=this.successors[t],n=this.predecessors[e],s=this.predecessors[t];if(!this.hasCrossWeights)return{cuv:this.CountOnArrays(r,i)+this.CountOnArrays(n,s),cvu:this.CountOnArrays(i,r)+this.CountOnArrays(s,n)};{let o=this.outCrossingCount[e],a=this.outCrossingCount[t],l=this.inCrossingCount[e],h=this.inCrossingCount[t];return{cuv:this.CountOnArraysUV(r,i,o,a)+this.CountOnArraysUV(n,s,l,h),cvu:this.CountOnArraysUV(i,r,a,o)+this.CountOnArraysUV(s,n,h,l)}}}InitPsArraysForLayer(e){for(let t of e){for(let e of this.properLayeredGraph.Pred(t)){let r=this.sOrder[e],i=r.size;this.successors[e][i]=t,r.set(t,i)}for(let e of this.properLayeredGraph.Succ(t)){let r=this.pOrder[e],i=r.size;this.predecessors[e][i]=t,r.set(t,i)}}}CountOnArrays(e,t){let r=0,i=t.length-1,n=-1,s=0;for(let o of e){let e=this.X[o];for(;n<i&&this.X[t[n+1]]<e;n++)s++;r+=s}return r}CountOnArraysUV(e,t,r,i){let n=0,s=t.length-1,o=-1,a=0;for(let l of e){let e;let h=this.X[l];for(;o<s&&this.X[e=t[o+1]]<h;o++)a+=i.get(e);n+=a*r.get(l)}return n}AdjExchangeLayer(e){let t=this.layers[e];return!!this.ExchangeWithGainWithNoDisturbance(t)||(this.DisturbLayer(t),this.ExchangeWithGainWithNoDisturbance(t))}Swap(e,t){let r=this.X[e],i=this.X[t],n=this.layering[e],s=this.layers[n];s[r]=t,s[i]=e,this.X[e]=i,this.X[t]=r,this.UpdateSsContainingUv(e,t),this.UpdatePsContainingUv(e,t)}UpdatePsContainingUv(e,t){if(this.successors[e].length<=this.successors[t].length)for(let r of this.successors[e]){let i=this.pOrder[r];if(i.has(t)){let n=i.get(t),s=this.predecessors[r];s[n-1]=t,s[n]=e,i.set(t,n-1),i.set(e,n)}}else for(let r of this.successors[t]){let i=this.pOrder[r];if(i.has(e)){let n=i.get(t),s=this.predecessors[r];s[n-1]=t,s[n]=e,i.set(t,n-1),i.set(e,n)}}}UpdateSsContainingUv(e,t){if(this.predecessors[e].length<=this.predecessors[t].length)for(let r of this.predecessors[e]){let i=this.sOrder[r];if(i.has(t)){let n=i.get(t),s=this.successors[r];s[n-1]=t,s[n]=e,i.set(t,n-1),i.set(e,n)}}else for(let r of this.predecessors[t]){let i=this.sOrder[r];if(i.has(e)){let n=i.get(t),s=this.successors[r];s[n-1]=t,s[n]=e,i.set(t,n-1),i.set(e,n)}}}DisturbLayer(e){for(let t=0;t<e.length-1;t++)this.AdjacentSwapToTheRight(e,t)}ExchangeWithGainWithNoDisturbance(e){let t,r=!1;do t=this.ExchangeWithGain(e),r=r||t;while(t);return r}ExchangeWithGain(e){for(let t=0;t<e.length-1;t++)if(this.SwapWithGain(e[t],e[t+1]))return this.SwapToTheLeft(e,t),this.SwapToTheRight(e,t+1),!0;return!1}SwapToTheLeft(e,t){for(let r=t-1;r>=0;r--)this.AdjacentSwapToTheRight(e,r)}SwapToTheRight(e,t){for(let r=t;r<e.length-1;r++)this.AdjacentSwapToTheRight(e,r)}AdjacentSwapToTheRight(e,t){let r=e[t],i=e[t+1],n=this.SwapGain(r,i);(n>0||0===n&&sX())&&this.Swap(r,i)}SwapGain(e,t){let r=this.CalcPair(e,t);return r.cuv-r.cvu}UvAreOfSameKind(e,t){return e<this.startOfVirtNodes&&t<this.startOfVirtNodes||e>=this.startOfVirtNodes&&t>=this.startOfVirtNodes}NeighborsForbidTheSwap(e,t){return this.UpperNeighborsForbidTheSwap(e,t)||this.LowerNeighborsForbidTheSwap(e,t)}LowerNeighborsForbidTheSwap(e,t){let r,i;return 0!==(r=this.properLayeredGraph.OutEdgesCount(e))&&0!==(i=this.properLayeredGraph.OutEdgesCount(t))&&this.X[this.successors[e][r>>1]]<this.X[this.successors[t][i>>1]]}UpperNeighborsForbidTheSwap(e,t){let r=this.properLayeredGraph.InEdgesCount(e),i=this.properLayeredGraph.InEdgesCount(t);return 0!==r&&0!==i&&this.X[this.predecessors[e][r>>1]]<this.X[this.predecessors[t][i>>1]]}CalcDeltaBetweenGroupsToTheLeftAndToTheRightOfTheSeparator(e,t,r){let i=this.GetKindDelegate(r),n=0;for(let r=t-1;r>=0&&!i(e[r]);r--)n++;let s=0;for(let r=t+1;r<e.length&&!i(e[r]);r++)s++;return n-s}IsOriginal(e){return e<this.startOfVirtNodes}IsVirtual(e){return e>=this.startOfVirtNodes}GetKindDelegate(e){return this.IsVirtual(e)?this.IsVirtual:this.IsOriginal}SwapWithGain(e,t){return!!(this.SwapGain(e,t)>0)&&(this.Swap(e,t),!0)}}class sK{constructor(e,t,r){this.properLayeredGraph=e,this.layerArrays=t,this.nodePositions=r}static UpdateLayerArrays0(e,t,r){new sK(e,t,r).UpdateLayerArrays()}static UpdateLayerArrays1(e,t){let r=sK.BuildInitialNodePositions(e,t);this.UpdateLayerArrays0(e,t,r)}static BuildInitialNodePositions(e,t){let r=new Map;for(let i=0;i<t.Layers.length;i++){let n=0,s=0;for(;n<t.Layers[i].length;){for(;n<t.Layers[i].length&&e.IsVirtualNode(t.Layers[i][n]);)n++;for(let e=s;e<n;e++)r.set(t.Layers[i][e],new g(i,s));n<t.Layers[i].length&&r.set(t.Layers[i][n],new g(i,n)),s=++n}}return r}UpdateLayerArrays(){let e=this.CreateInitialOrdering();e=this.BuildOrdering(e),this.RestoreLayerArrays(e)}CreateInitialOrdering(){let e=new t_;for(let t of this.layerArrays.Layers)for(let r of t){let t=this.nodePositions.get(r);!e.hasxy(t.x,t.y)&&e.setxy(t.x,t.y,[]),e.getxy(t.x,t.y).push(r)}return e}BuildOrdering(e){let t=new t_,r=new Map;for(let i of this.layerArrays.Layers)for(let n of i){let i=this.nodePositions.get(n);if(!t.hasxy(i.x,i.y))this.BuildNodeOrdering(e.get(i),r),t.set(i,e.get(i))}return t}BuildNodeOrdering(e,t){e.sort(this.Comparison(t));for(let r=0;r<e.length;r++)t.set(e[r],r)}firstSucc(e){for(let t of this.properLayeredGraph.Succ(e))return t}firstPred(e){for(let t of this.properLayeredGraph.Pred(e))return t}Comparison(e){return(t,r)=>{let i=this.firstSucc(t),n=this.firstSucc(r),s=this.firstPred(t),o=this.firstPred(r),a=this.nodePositions.get(i),l=this.nodePositions.get(n),u=this.nodePositions.get(s),c=this.nodePositions.get(o);if(!a.equal(l))return u.equal(c)?a.compareTo(l):u.compareTo(c);if(this.properLayeredGraph.IsVirtualNode(i)){if(!u.equal(c))return u.compareTo(c);let t=e.get(i);return h(t,e.get(n))}for(;this.nodePositions.get(s).equal(this.nodePositions.get(o))&&this.properLayeredGraph.IsVirtualNode(s);)s=this.firstPred(s),o=this.firstPred(o);return this.nodePositions.get(s).equal(this.nodePositions.get(o))?h(t,r):this.nodePositions.get(s).compareTo(this.nodePositions.get(o))}}RestoreLayerArrays(e){for(let t of this.layerArrays.Layers){let r=0,i=0;for(;r<t.length;){for(;r<t.length&&this.nodePositions.get(t[i]).equal(this.nodePositions.get(t[r]));)r++;let n=e.get(this.nodePositions.get(t[i]));for(let e=i;e<r;e++)t[e]=n[e-i];i=r}}this.layerArrays.UpdateXFromLayers()}}class sJ{static getOrder(e,t){let r=rt(t.map(([e,t])=>new ri(e,t)),e);return sJ.getOrderOnGraph(r)}static getOrderOnGraph(e){let t;let r=Array(e.nodeCount).fill(!1),i=new eE.Stack,n=[];for(let s=0;s<e.nodeCount;s++){if(r[s])continue;let o=s;r[o]=!0;let a=0;for(t=e.outEdges[s];;){for(;a<t.length;a++){let n=t[a].target;!r[n]&&(r[n]=!0,i.push({edges:t,index:a+1,current_u:o}),o=n,t=e.outEdges[o],a=-1)}if(n.push(o),i.length>0){let e=i.pop();t=e.edges,a=e.index,o=e.current_u}else break}}return n.reverse()}}class sQ{GetLayers(){let e=sJ.getOrderOnGraph(this.graph),t=Array(this.graph.nodeCount).fill(0),r=this.graph.nodeCount;for(;r-- >0;){let i=e[r];for(let e of this.graph.inEdges[i]){let r=e.source,n=t[i]+e.separation;t[r]<n&&(t[r]=n)}}return t}checkTopoOrder(e){for(let t of this.graph.edges)if(function(e,t){let r=t.findIndex(t=>t===e.source),i=t.findIndex(t=>t===e.target);return -1===r||-1===i||!!(r>=i)||!1}(t,e))return!1;return!0}constructor(e){this.graph=e}}class s1{constructor(e){this.inTree=!1,this.cut=s1.infinity,this.iedge=e}get source(){return this.iedge.source}get target(){return this.iedge.target}get separation(){return this.iedge.separation}get crossingWeight(){return this.iedge.CrossingWeight}get weight(){return this.iedge.weight}}s1.infinity=Number.MAX_SAFE_INTEGER;class s0{constructor(e,t,r,i,n){this.v=e,this.outEnum=t,this.i=r,this.inEnum=i,this.j=n}}class s2{get weight(){return this.graph.edges.map(e=>e.weight*(this.layers[e.source]-this.layers[e.target])).reduce((e,t)=>e+t,0)}get nodeCount(){return this.vertices.length}setLow(e,t){this.vertices[e].low=t}setLim(e,t){this.vertices[e].lim=t}setParent(e,t){this.vertices[e].parent=t}constructor(e,t){this.layers=null,this.treeVertices=[],this.vertices=[],this.leaves=[],this.graph=function(e){let t=[];for(let r of e.edges)t.push(new s1(r));return rt(t,e.nodeCount)}(e),this.networkCancelToken=t;for(let e=0;e<this.graph.nodeCount;e++)this.vertices.push({inTree:!1,lim:-1,low:-1,parent:null})}GetLayers(){return null==this.layers&&this.run(),this.layers}shiftLayerToZero(){let e=Math.min(...this.layers);for(let t=0;t<this.layers.length;t++)this.layers[t]-=e}addVertexToTree(e){this.vertices[e].inTree=!0}vertexInTree(e){return this.vertices[e].inTree}lim(e){return this.vertices[e].lim}low(e){return this.vertices[e].low}parent(e){return this.vertices[e].parent}feasibleTree(){for(this.initLayers();this.tightTree()<this.nodeCount;){let e=this.getNonTreeEdgeIncidentToTheTreeWithMinimalAmountOfSlack();if(null==e)break;let t=this.slack(e);for(let r of(this.vertexInTree(e.source)&&(t=-t),this.treeVertices))this.layers[r]+=t}this.initCutValues()}vertexSourceTargetVal(e,t){let r=t.source,i=t.target;if(this.lim(r)>this.lim(i)){if(this.lim(e)<=this.lim(i)&&this.low(i)<=this.lim(e))return 0;else return 1}if(this.lim(e)<=this.lim(r)&&this.low(r)<=this.lim(e))return 1;return 0}incidentEdges(e){return this.graph.incidentEdges(e)}allLowCutsHaveBeenDone(e){for(let t of this.incidentEdges(e))if(t.inTree&&t.cut===s1.infinity&&t!==this.parent(e))return!1;return!0}edgeSourceTargetVal(e,t){return this.vertexSourceTargetVal(e.source,t)-this.vertexSourceTargetVal(e.target,t)}initCutValues(){this.initLimLowAndParent();let e=new eE.Stack;for(let t of this.leaves)e.push(t);let t=new eE.Stack;for(;e.length>0;){for(;e.length>0;){let r=e.pop(),i=this.parent(r);if(null==i)continue;let n=0;for(let e of this.incidentEdges(r))if(!1===e.inTree){let t=this.edgeSourceTargetVal(e,i);0!==t&&(n+=t*e.weight)}else if(e===i)n+=e.weight;else{let t=i.source===e.target||i.target===e.source?1:-1;n+=this.edgeContribution(e,r)*t}i.cut=n;let s=i.source===r?i.target:i.source;this.allLowCutsHaveBeenDone(s)&&t.push(s)}let r=e;e=t,t=r}}edgeContribution(e,t){let r=e.cut-e.weight;for(let i of this.incidentEdges(t))if(!1===i.inTree){let t=this.edgeSourceTargetVal(i,e);-1===t?r+=i.weight:1===t&&(r-=i.weight)}return r}initLimLowAndParent(){this.initLowLimParentAndLeavesOnSubtree(1,0)}initLowLimParentAndLeavesOnSubtree(e,t){let r=new eE.Stack,i=this.graph.outEdges[t],n=-1,s=this.graph.inEdges[t],o=-1;for(r.push(new s0(t,i,n,s,o)),this.vertices[t].low=e;r.length>0;){let a;let l=r.pop();t=l.v,i=l.outEnum,n=l.i,s=l.inEnum,o=l.j;do{for(a=!0;++n<i.length;){let a=i[n];if(!!a.inTree&&!(this.vertices[a.target].low>0))r.push(new s0(t,i,n,s,o)),t=a.target,this.setParent(t,a),this.setLow(t,e),i=this.graph.outEdges[t],n=-1,s=this.graph.inEdges[t],o=-1}for(;++o<s.length;){let l=s[o];if(!!l.inTree&&!(this.vertices[l.source].low>0)){r.push(new s0(t,i,n,s,o)),t=l.source,this.setLow(t,e),this.setParent(t,l),i=this.graph.outEdges[t],n=-1,s=this.graph.inEdges[t],o=-1,a=!1;break}}}while(!a);this.setLim(t,e++),this.lim(t)===this.low(t)&&this.leaves.push(t)}}updateLimLowLeavesAndParentsUnderNode(e){let t=this.vertices[e].low,r=this.vertices[e].lim;this.leaves=[];for(let e=0;e<this.nodeCount;e++)t<=this.vertices[e].lim&&this.vertices[e].lim<=r?this.setLow(e,0):this.low(e)===this.lim(e)&&this.leaves.push(e);this.initLowLimParentAndLeavesOnSubtree(t,e)}slack(e){return this.layers[e.source]-this.layers[e.target]-e.separation}getNonTreeEdgeIncidentToTheTreeWithMinimalAmountOfSlack(){let e=null,t=s1.infinity;for(let r of this.treeVertices){for(let i of this.graph.outEdges[r]){if(this.vertexInTree(i.source)&&this.vertexInTree(i.target))continue;let r=this.slack(i);if(r<t&&(e=i,t=r,1===r))return i}for(let i of this.graph.inEdges[r]){if(this.vertexInTree(i.source)&&this.vertexInTree(i.target))continue;let r=this.slack(i);if(r<t&&(e=i,t=r,1===r))return i}}return e}tightTree(){for(let e of(this.treeVertices=[],this.graph.edges))e.inTree=!1;for(let e=1;e<this.nodeCount;e++)this.vertices[e].inTree=!1;this.vertices[0].inTree=!0,this.treeVertices.push(0);let e=new eE.Stack;for(e.push(0);e.length>0;){let t=e.pop();for(let r of this.graph.outEdges[t])!this.vertexInTree(r.target)&&this.layers[r.source]-this.layers[r.target]===r.separation&&(e.push(r.target),this.addVertexToTree(r.target),this.treeVertices.push(r.target),r.inTree=!0);for(let r of this.graph.inEdges[t])!this.vertexInTree(r.source)&&this.layers[r.source]-this.layers[r.target]===r.separation&&(e.push(r.source),this.addVertexToTree(r.source),this.treeVertices.push(r.source),r.inTree=!0)}return this.treeVertices.length}leaveEnterEdge(){let e,t;let r=0;for(let t of this.graph.edges)t.inTree&&t.cut<r&&(r=t.cut,e=t);if(null==e)return null;let i=!1,n=s1.infinity;for(let r of this.graph.edges){let s=this.slack(r);if(!1===r.inTree&&-1===this.edgeSourceTargetVal(r,e)&&(s<n||s===n&&(i=1===t5(2)))){if(n=s,t=r,0===n&&!i)break;i=!1}}if(null==t)throw Error();return{leaving:e,entering:t}}exchange(e,t){let r=this.commonPredecessorOfSourceAndTargetOfF(t);this.createPathForCutUpdates(e,t,r),this.updateLimLowLeavesAndParentsUnderNode(r),this.updateCuts(e),this.updateLayersUnderNode(r)}updateLayersUnderNode(e){let t=new eE.Stack;t.push(e);for(let t=0;t<this.nodeCount;t++)this.low(e)<=this.lim(t)&&this.lim(t)<=this.lim(e)&&t!==e&&(this.layers[t]=s1.infinity);for(;t.length>0;){let e=t.pop();for(let r of this.graph.outEdges[e])r.inTree&&this.layers[r.target]===s1.infinity&&(this.layers[r.target]=this.layers[e]-r.separation,t.push(r.target));for(let r of this.graph.inEdges[e])r.inTree&&this.layers[r.source]===s1.infinity&&(this.layers[r.source]=this.layers[e]+r.separation,t.push(r.source))}}updateCuts(e){let t=new eE.Stack,r=new eE.Stack;for(t.push(e.source),t.push(e.target);t.length>0;){for(;t.length>0;){let e=t.pop(),i=this.parent(e);if(null==i||i.cut!==s1.infinity)continue;let n=0;for(let t of this.incidentEdges(e))if(!1===t.inTree)n+=this.edgeSourceTargetVal(t,i)*t.weight;else if(t===i)n+=t.weight;else{let r=i.source===t.target||i.target===t.source?1:-1;n+=this.edgeContribution(t,e)*r}i.cut=n;let s=i.source===e?i.target:i.source;this.allLowCutsHaveBeenDone(s)&&r.push(s)}let e=t;t=r,r=e}}createPathForCutUpdates(e,t,r){let i=t.target;for(;i!==r;){let e=this.parent(i);e.cut=s1.infinity,i=e.source===i?e.target:e.source}t.cut=s1.infinity,e.inTree=!1,t.inTree=!0}commonPredecessorOfSourceAndTargetOfF(e){let t,r;this.lim(e.source)<this.lim(e.target)?(t=this.lim(e.source),r=this.lim(e.target)):(t=this.lim(e.target),r=this.lim(e.source));let i=e.source;for(;!1==(this.low(i)<=t&&r<=this.lim(i));){let e=this.parent(i);e.cut=s1.infinity,i=e.source===i?e.target:e.source}return i}checkCutValues(){for(let e of this.graph.edges)if(e.inTree){let t=0;for(let r of this.graph.edges)t+=this.edgeSourceTargetVal(r,e)*r.weight;e.cut!==t&&console.log(tb.String.format("cuts are wrong for {0}; should be {1} but is {2}",e,t,e.cut))}}initLayers(){let e=new sQ(this.graph);return this.layers=e.GetLayers()}run(){if(0===this.graph.edges.length&&0===this.graph.nodeCount)this.layers=[];else{let e;for(this.feasibleTree();null!=(e=this.leaveEnterEdge());)this.exchange(e.leaving,e.entering);this.shiftLayerToZero()}}}class s3{GetLayers(){return new s2(this.graph,this.Cancel).GetLayers()}ShrunkComponent(e){let t=[];for(let r of e){let i=r[0],n=r[1];for(let r of this.graph.outEdges[i]){let i=new i3(n,e.get(r.target),r.edge);i.separation=r.separation,i.weight=r.weight,t.push(i)}}return new sD(t,e.size)}constructor(e,t){this.graph=e,this.Cancel=t}}class s5{toString(){return"la:ra "+this.la+" "+this.ra+" ta:ba "+this.ta+" "+this.ba+" x:y "+this.x_+" "+this.y_}get leftAnchor(){return this.la}set leftAnchor(e){this.la=Math.max(e,0)}get rightAnchor(){return this.ra}set rightAnchor(e){this.ra=Math.max(e,0)}get topAnchor(){return this.ta}set topAnchor(e){this.ta=Math.max(e,0)}get bottomAnchor(){return this.ba}set bottomAnchor(e){this.ba=Math.max(e,0)}get left(){return this.x_-this.la}get right(){return this.x_+this.ra}get top(){return this.y_+this.ta}set top(e){this.y_+=e-this.ta}get bottom(){return this.y_-this.ba}set bottom(e){this.y_+=e-this.ba}get leftTop(){return new g(this.left,this.top)}get leftBottom(){return new g(this.left,this.bottom)}get rightBottom(){return new g(this.right,this.bottom)}get node(){return this.node_}set node(e){this.node_=e,this.polygonalBoundary_=null}get rightTop(){return new g(this.right,this.top)}constructor(e){this.padding=0,this.alreadySitsOnASpline=!1,this.labelIsToTheLeftOfTheSpline=!1,this.labelIsToTheRightOfTheSpline=!1,this.labelCornersPreserveCoefficient=e}static mkAnchor(e,t,r,i,n,s){let o=new s5(s);return o.la=e,o.ra=t,o.ta=r,o.ba=i,o.node=n,o}get x(){return this.x_}set x(e){this.polygonalBoundary_=null,this.x_=e}get y(){return this.y_}set y(e){this.polygonalBoundary_=null,this.y_=e}get origin(){return new g(this.x,this.y)}get width(){return this.la+this.ra}get height(){return this.ta+this.ba}get hasLabel(){return this.labelIsToTheLeftOfTheSpline||this.labelIsToTheLeftOfTheSpline}get LabelWidth(){if(this.labelIsToTheLeftOfTheSpline)return this.leftAnchor;if(this.labelIsToTheRightOfTheSpline)return this.rightAnchor;throw Error()}get polygonalBoundary(){return null!=this.polygonalBoundary_?this.polygonalBoundary_:this.polygonalBoundary_=s5.pad(this.creatPolygonalBoundaryWithoutPadding(),this.padding)}static pad(e,t){return 0===t?e:s5.curveIsConvex(e)?s5.padConvexCurve(e,t):s5.padConvexCurve(e.boundingBox.perimeter(),t)}static padCorner(e,t,r,i,n){let s=s5.getPaddedCorner(t,r,i,n);e.addPoint(s.a),2===s.numberOfPoints&&e.addPoint(s.b)}static padConvexCurve(e,t){let r=new A;s5.padCorner(r,e.endPoint.prev,e.endPoint,e.startPoint,t),s5.padCorner(r,e.endPoint,e.startPoint,e.startPoint.next,t);for(let i=e.startPoint;null!=i.next.next;i=i.next)s5.padCorner(r,i,i.next,i.next.next,t);return r.closed=!0,r}static getPaddedCorner(e,t,r,i){let n=e.point,s=t.point,o=r.point,a=g.getTriangleOrientation(n,s,o)===eo.Counterclockwise,h=s.sub(n),u=h.rotate((a?-Math.PI:Math.PI)/2).normalize(),c=h.normalize().add(s.sub(o).normalize());if(c.length<l.intersectionEpsilon)return{a:s.add(u.mul(i)),b:null,numberOfPoints:1};let d=c.normalize().mul(i),f=d.rotate(Math.PI/2),p=(i-d.dot(u))/f.dot(u);return{a:d.add(f.mul(p)).add(s),b:d.sub(f.mul(p)).add(s),numberOfPoints:2}}static*orientations(e){yield g.getTriangleOrientation(e.endPoint.point,e.startPoint.point,e.startPoint.next.point),yield g.getTriangleOrientation(e.endPoint.prev.point,e.endPoint.point,e.startPoint.point);let t=e.startPoint;for(;null!=t.next.next;)yield g.getTriangleOrientation(t.point,t.next.point,t.next.next.point),t=t.next}static curveIsConvex(e){let t=eo.Collinear;for(let r of s5.orientations(e))if(r!==eo.Collinear){if(t===eo.Collinear)t=r;else if(r!==t)return!1}return!0}creatPolygonalBoundaryWithoutPadding(){return this.hasLabel?this.labelIsToTheLeftOfTheSpline?this.polygonOnLeftLabel():this.polygonOnRightLabel():null==this.nodeBoundary?this.standardRectBoundary():C.polylineAroundClosedCurve(this.nodeBoundary)}get nodeBoundary(){return null==this.node?null:this.node.boundaryCurve}standardRectBoundary(){let e=new A;return e.addPoint(this.leftTop),e.addPoint(this.rightTop),e.addPoint(this.rightBottom),e.addPoint(this.leftBottom),e.closed=!0,e}polygonOnLeftLabel(){let e=this.left+(1-this.labelCornersPreserveCoefficient)*this.LabelWidth;return A.mkClosedFromPoints([new g(e,this.top),this.rightTop,this.rightBottom,new g(e,this.bottom),new g(this.left,this.y)])}polygonOnRightLabel(){let e=this.right-(1-this.labelCornersPreserveCoefficient)*this.LabelWidth;return A.mkClosedFromPoints([new g(e,this.top),new g(this.right,this.y),new g(e,this.bottom),this.leftBottom,this.leftTop])}move(e){this.x+=e.x,this.y+=e.y}}class s6{get CurrentEnumRightUp(){return(this.LR?0:1)+2*(this.BT?0:1)}IsVirtual(e){return e>=this.nOfOriginalVertices}Source(e){return this.BT?e.Source:e.Target}Target(e){return this.BT?e.Target:e.Source}static CalculateXCoordinates(e,t,r,i,n){new s6(e,t,r,i,n).Calculate()}Calculate(){this.SortInAndOutEdges(),this.RightUpSetup(),this.CalcBiasedAlignment(),this.LeftUpSetup(),this.CalcBiasedAlignment(),this.RightDownSetup(),this.CalcBiasedAlignment(),this.LeftDownSetup(),this.CalcBiasedAlignment(),this.HorizontalBalancing()}SortInAndOutEdges(){this.FillLowMedians(),this.FillUpperMedins()}FillUpperMedins(){this.upperMedians=Array(this.graph.NodeCount);for(let e=0;e<this.graph.NodeCount;e++)this.FillUpperMediansForNode(e)}CompareByX(e,t){return this.la.x[e]-this.la.x[t]}FillUpperMediansForNode(e){let t=this.graph.InEdgesCount(e);if(t>0){let r=Array(t);for(let i of(t=0,this.graph.InEdges(e)))r[t++]=i.Source;r.sort((e,t)=>this.CompareByX(e,t));let i=Math.floor(t/2);2*i===t?this.upperMedians[e]=new ri(r[i-1],r[i]):this.upperMedians[e]=r[i]}else this.upperMedians[e]=-1}FillLowMedians(){this.lowMedians=Array(this.graph.NodeCount);for(let e=0;e<this.graph.NodeCount;e++)this.FillLowMediansForNode(e)}FillLowMediansForNode(e){let t=this.graph.OutEdgesCount(e);if(t>0){let r=Array(t);for(let i of(t=0,this.graph.OutEdges(e)))r[t++]=i.Target;r.sort((e,t)=>this.CompareByX(e,t));let i=Math.floor(t/2);2*i===t?this.lowMedians[e]=new ri(r[i-1],r[i]):this.lowMedians[e]=r[i]}else this.lowMedians[e]=-1}HorizontalBalancing(){let e=-1,t=[,,,,],r=[,,,,],i=Number.MAX_VALUE;for(let n=0;n<4;n++){let s={a:0,b:0};this.AssignmentBounds(n,s),t[n]=s.a,r[n]=s.b;let o=r[n]-t[n];o<i&&(e=n,i=o)}for(let i=0;i<4;i++){let n;if(n=s6.IsLeftMostAssignment(i)?t[e]-t[i]:r[e]-r[i],this.x=this.xCoords[i],0!==n)for(let e=0;e<this.nOfVertices;e++)this.x[e]=this.x[e]+n}let n=[,,,,];for(let e=0;e<this.nOfVertices;e++)n[0]=this.xCoords[0][e],n[1]=this.xCoords[1][e],n[2]=this.xCoords[2][e],n[3]=this.xCoords[3][e],n.sort((e,t)=>e-t),this.anchors[e].x=(n[1]+n[2])/2}static IsLeftMostAssignment(e){return 0===e||2===e}AssignmentBounds(e,t){if(0===this.nOfVertices)t.a=0,t.b=0;else{this.x=this.xCoords[e],t.a=t.b=this.x[0];for(let e=1;e<this.nOfVertices;e++){let r=this.x[e];r<t.a?t.a=r:r>t.b&&(t.b=r)}}}CalcBiasedAlignment(){this.ConflictElimination(),this.Align()}LeftUpSetup(){this.LR=!1,this.BT=!0}LeftDownSetup(){this.LR=!1,this.BT=!1}RightDownSetup(){this.LR=!0,this.BT=!1}RightUpSetup(){this.LR=!0,this.BT=!0}ConflictElimination(){this.RemoveMarksFromEdges(),this.MarkConflictingEdges()}*UpperEdgeMedians(e){let t=this.BT?this.upperMedians[e]:this.lowMedians[e];"number"!=typeof t?this.LR?(yield t.x,yield t.y):(yield t.y,yield t.x):t>=0&&(yield t)}MarkConflictingEdges(){let e=this.LowerOf(0,this.h-1),t=e,r=this.UpperOf(0,this.h-1),i=this.NextLower(r);for(;this.IsBelow(e,r);e=this.NextUpper(e))this.IsBelow(t,e)&&this.IsBelow(e,i)&&this.ConflictsWithAtLeastOneInnerEdgeForALayer(e)}NextUpper(e){return this.BT?e+1:e-1}NextLower(e){return this.BT?e-1:e+1}UpperOf(e,t){return this.BT?Math.max(e,t):Math.min(e,t)}LowerOf(e,t){return this.BT?Math.min(e,t):Math.max(e,t)}IsBelow(e,t){return this.BT?e<t:t<e}LeftMost(e,t){return this.LR?Math.min(e,t):Math.max(e,t)}RightMost(e,t){return this.LR?Math.max(e,t):Math.min(e,t)}IsNotRightFrom(e,t){return this.LR?e<=t:t<=e}IsLeftFrom(e,t){return this.LR?e<t:t<e}NextRight(e){return this.LR?e+1:e-1}NextLeft(e){return this.LR?e-1:e+1}ConflictsWithAtLeastOneInnerEdgeForALayer(e){if(e>=0&&e<this.la.Layers.length){let t=this.la.Layers[e],r=null,i=this.LeftMost(0,t.length-1),n=this.RightMost(0,t.length-1);for(;this.IsNotRightFrom(i,n)&&null==r;i=this.NextRight(i))r=this.InnerEdgeByTarget(t[i]);if(null!=r){let e=this.Pos(this.Source(r));for(let r=this.LeftMost(0,t.length-1);this.IsLeftFrom(r,i);r=this.NextRight(r))for(let i of this.InEdges(t[r]))this.IsLeftFrom(e,this.Pos(this.Source(i)))&&this.MarkEdge(i);let s=this.Pos(this.Source(r));for(;this.IsNotRightFrom(i,n);){let n=this.AlignmentToTheRightOfInner(t,i,e);if(i=this.NextRight(i),null!=n){let e=this.Pos(this.Source(n));this.MarkEdgesBetweenInnerAndNewInnerEdges(t,r,n,s,e),r=n,s=e}}for(let e=this.NextRight(this.Pos(this.Target(r)));this.IsNotRightFrom(e,n);e=this.NextRight(e))for(let i of this.InEdges(t[e]))this.IsLeftFrom(this.Pos(this.Source(i)),this.Pos(this.Source(r)))&&this.MarkEdge(i)}}}InEdgeOfVirtualNode(e){return this.BT?this.graph.InEdgeOfVirtualNode(e):this.graph.OutEdgeOfVirtualNode(e)}InEdges(e){return this.BT?this.graph.InEdges(e):this.graph.OutEdges(e)}MarkEdgesBetweenInnerAndNewInnerEdges(e,t,r,i,n){let s=this.NextRight(this.Pos(this.Target(t)));for(;this.IsLeftFrom(s,this.Pos(this.Target(r)));s=this.NextRight(s))for(let t of this.InEdges(e[s])){let e=this.Pos(this.Source(t));this.IsLeftFrom(e,i)?this.MarkEdge(t):this.IsLeftFrom(n,e)&&this.MarkEdge(t)}}AlignmentToTheRightOfInner(e,t,r){if(1===this.NumberOfInEdges(e[t])){let i=null;for(let r of this.InEdges(e[t]))i=r;if(this.IsInnerEdge(i)&&this.IsLeftFrom(r,this.Pos(i.Source)))return i}return null}NumberOfInEdges(e){return this.BT?this.graph.InEdgesCount(e):this.graph.OutEdgesCount(e)}Pos(e){return this.la.x[e]}InnerEdgeByTarget(e){if(this.IsVirtual(e)){let t=this.InEdgeOfVirtualNode(e);if(this.IsVirtual(this.Source(t)))return t}return null}IsInnerEdge(e){return this.IsVirtual(e.Source)&&this.IsVirtual(e.Target)}RemoveMarksFromEdges(){this.markedEdges.clear()}constructor(e,t,r,i,n){this.xCoords=[,,,,],this.la=e,this.graph=t,this.nOfOriginalVertices=r,this.nOfVertices=this.graph.NodeCount,this.markedEdges=new ij,this.h=this.la.Layers.length,this.root=Array(this.nOfVertices),this.align=Array(this.nOfVertices),this.anchors=i,this.nodeSep=n}Align(){this.CreateBlocks(),this.AssignCoordinatesByLongestPath()}AssignCoordinatesByLongestPath(){this.x=this.xCoords[this.CurrentEnumRightUp]=Array(this.nOfVertices);let e=[];for(let t=0;t<this.nOfVertices;t++)if(t===this.root[t]){let r=t;do{let i={neighbor:0};this.TryToGetRightNeighbor(r,i)&&e.push(new i3(t,this.root[i.neighbor],null)),r=this.align[r]}while(r!==t)}let t=rt(e,this.nOfVertices),r=sJ.getOrderOnGraph(t);for(let e of r)if(e===this.root[e]){let t=0,r=!0,i=e;do{let e={neighbor:0};this.TryToGetLeftNeighbor(i,e)&&(r?(t=this.x[this.root[e.neighbor]]+this.DeltaBetweenVertices(e.neighbor,i),r=!1):t=this.RightMost(t,this.x[this.root[e.neighbor]]+this.DeltaBetweenVertices(e.neighbor,i))),i=this.align[i]}while(i!==e);this.x[e]=t}for(let e of r)if(e===this.root[e]&&0===t.inEdges[e].length){let t=e,r=this.RightMost(-s6.infinity,s6.infinity),i=r;do{let e={neighbor:0};this.TryToGetRightNeighbor(t,e)&&(r=this.LeftMost(r,this.x[this.root[e.neighbor]]-this.DeltaBetweenVertices(t,e.neighbor))),t=this.align[t]}while(t!==e);i!==r&&(this.x[e]=r)}for(let e=0;e<this.nOfVertices;e++)e!==this.root[e]&&(this.x[e]=this.x[this.root[e]])}TryToGetRightNeighbor(e,t){let r=this.NextRight(this.Pos(e)),i=this.la.Layers[this.la.y[e]];return!!(r>=0)&&!!(r<i.length)&&(t.neighbor=i[r],!0)}TryToGetLeftNeighbor(e,t){let r=this.NextLeft(this.Pos(e)),i=this.la.Layers[this.la.y[e]];return!!(r>=0)&&!!(r<i.length)&&(t.neighbor=i[r],!0)}CreateBlocks(){for(let e=0;e<this.nOfVertices;e++)this.root[e]=this.align[e]=e;let e=this.LowerOf(0,this.h-1);for(let t=this.NextLower(this.UpperOf(0,this.h-1));!this.IsBelow(t,e);t=this.NextLower(t)){let e=this.la.Layers[t],r=this.LeftMost(-1,this.la.Layers[this.NextUpper(t)].length),i=this.RightMost(0,e.length-1);for(let t=this.LeftMost(0,e.length-1);this.IsNotRightFrom(t,i);t=this.NextRight(t)){let i=e[t];for(let e of this.UpperEdgeMedians(i))if(!this.IsMarked(i,e)&&this.IsLeftFrom(r,this.Pos(e))){this.align[e]=i,this.root[i]=this.root[e],this.align[i]=this.root[e],r=this.Pos(e);break}}}}IsMarked(e,t){return this.BT?this.markedEdges.hasxy(t,e):this.markedEdges.hasxy(e,t)}MarkEdge(e){this.markedEdges.addNN(e.Source,e.Target)}DeltaBetweenVertices(e,t){let r;if(this.Pos(e)>this.Pos(t)){let i=e;e=t,t=i,r=-1}else r=1;return(this.anchors[e].rightAnchor+this.anchors[t].leftAnchor+this.nodeSep)*r}}s6.infinity=1e7;class s4 extends rr{constructor(e,t,r,i,n){super(),this.weightMultiplierOfOriginalOriginal=1,this.weightMultOfOneVirtual=3,this.weightMultiplierOfTwoVirtual=8,this.SetEdges(i,n),this.virtualVerticesStart=e.nodeCount,this.virtualVerticesEnd=t.NodeCount-1,this.layeredGraph=t,this.layerArrays=r}EdgeWeightMultiplier(e){let t=e.source,r=e.target;if(t<this.layeredGraph.NodeCount&&this.layerArrays.y[t]===this.layerArrays.y[r]&&this.layerArrays.x[t]===this.layerArrays.x[r]+1)return 0;let i=0,n=-1,s=-1;for(let e of this.outEdges[t])-1===s?s=e.target:n=e.target;return s>=this.virtualVerticesStart&&s<=this.virtualVerticesEnd&&i++,n>=this.virtualVerticesStart&&n<=this.virtualVerticesEnd&&i++,0===i?this.weightMultiplierOfOriginalOriginal:1===i?this.weightMultOfOneVirtual:this.weightMultiplierOfTwoVirtual}SetEdgeWeights(){for(let e of this.edges)e.weight=e.weight*this.EdgeWeightMultiplier(e)}}(et=eP||(eP={}))[et.Top=0]="Top",et[et.Internal=1]="Internal",et[et.Bottom=2]="Bottom";class s9{static Calculate(e,t=0){return new s9(e,t).Calculate()}constructor(e,t){this.groupSplitThreshold=2,this.initialNodes=e,this.groupSplitThreshold=t}Calculate(){return this.Calc(this.initialNodes)}Calc(e){let t;if(0===e.length)return null;if(1===e.length)return e[0];let r=e[0].parallelogram,i=1,n=v.parallelogramOfTwo(r,e[i].parallelogram).area;for(let t=2;t<e.length;t++){let s=v.parallelogramOfTwo(r,e[t].parallelogram).area;s>n&&(i=t,n=s)}for(let r=0;r<e.length;r++)if(r!==i){t=r;break}n=v.parallelogramOfTwo(e[i].parallelogram,e[t].parallelogram).area;for(let r=0;r<e.length;r++){if(r===i)continue;let s=v.parallelogramOfTwo(e[i].parallelogram,e[r].parallelogram).area;s>n&&(t=r,n=s)}let s=[],o=[];s.push(e[i]),o.push(e[t]);let a=e[i].parallelogram,l=e[t].parallelogram;for(let r=0;r<e.length;r++){if(r===i||r===t)continue;let n=v.parallelogramOfTwo(a,e[r].parallelogram),h=n.area-a.area,u=v.parallelogramOfTwo(l,e[r].parallelogram),c=u.area-l.area;s.length*this.groupSplitThreshold<o.length?(s.push(e[r]),a=n):o.length*this.groupSplitThreshold<s.length?(o.push(e[r]),l=u):h<c?(s.push(e[r]),a=n):(o.push(e[r]),l=u)}return{parallelogram:v.parallelogramOfTwo(a,l),node:{children:[this.Calc(s),this.Calc(o)]},seg:void 0,leafBoxesOffset:void 0}}}class s8{constructor(e,t,r,i,n,s,o,a){this.topNode=e,this.bottomNode=t,this.topSite=r,this.bottomSite=r.next,this.currentTopSite=r,this.currentBottomSite=r.next,this.layerArrays=i,this.layeredGraph=n,this.originalGraph=s,this.anchors=o,this.layerSeparation=a}static Refine(e,t,r,i,n,s,o,a){new s8(e,t,r,n,s,o,i,a).Refine()}Refine(){for(this.Init();this.InsertSites(););}FixCorner(e,t,r){if(e.equal(t))return t;let i=g.ClosestPointAtLineSegment(t,e,r),n=t.sub(i),s=Math.abs(n.y),o=this.layerSeparation/2;return s>o&&(n=n.mul(o/(2*s))),n.add(t)}InsertSites(){return 0===t5(2)?this.CalculateNewTopSite()||this.CalculateNewBottomSite():this.CalculateNewBottomSite()||this.CalculateNewTopSite()}CalculateNewBottomSite(){let e;let t=this.currentBottomSite.point.sub(this.currentTopSite.point),r=s8.absCotan(t),i=!1;for(let t of this.bottomCorners()){let n=s8.absCotan(t.sub(this.currentBottomSite.point));n<r&&(r=n,e=t,i=!0)}return!!i&&!c(r,s8.absCotan(t))&&(this.currentBottomSite=R.mkSiteSPS(this.currentTopSite,this.FixCorner(this.currentTopSite.point,e,this.currentBottomSite.point),this.currentBottomSite),!0)}static absCotan(e){return Math.abs(e.x/e.y)}CalculateNewTopSite(){let e;let t=this.currentBottomSite.point.sub(this.currentTopSite.point),r=s8.absCotan(t),i=!1;for(let t of this.topCorners()){let n=s8.absCotan(t.sub(this.currentTopSite.point));n<r&&(r=n,e=t,i=!0)}return!!i&&!c(r,s8.absCotan(t))&&(this.currentTopSite=R.mkSiteSPS(this.currentTopSite,this.FixCorner(this.currentTopSite.point,e,this.currentBottomSite.point),this.currentBottomSite),!0)}Init(){this.IsTopToTheLeftOfBottom()?(this.topCorners=()=>this.CornersToTheRightOfTop(),this.bottomCorners=()=>this.CornersToTheLeftOfBottom()):(this.topCorners=()=>this.CornersToTheLeftOfTop(),this.bottomCorners=()=>this.CornersToTheRightOfBottom())}IsTopToTheLeftOfBottom(){return this.topSite.point.x<this.topSite.next.point.x}*NodeCorners(e){for(let t of this.anchors[e].polygonalBoundary.polylinePoints())yield t.point}*CornersToTheLeftOfBottom(){let e=this.layerArrays.x[this.bottomNode],t=this.currentTopSite.point.x,r=this.currentBottomSite.point.x;for(let i of this.LeftFromTheNode(this.NodeLayer(this.bottomNode),e,eP.Bottom,t,r))for(let e of this.NodeCorners(i))e.y>this.currentBottomSite.point.y&&s8.PossibleCorner(t,r,e)&&(yield e)}*CornersToTheLeftOfTop(){let e=this.layerArrays.x[this.topNode],t=this.currentBottomSite.point.x,r=this.currentTopSite.point.x;for(let i of this.LeftFromTheNode(this.NodeLayer(this.topNode),e,eP.Top,t,r))for(let e of this.NodeCorners(i))e.y<this.currentTopSite.point.y&&s8.PossibleCorner(t,r,e)&&(yield e)}*CornersToTheRightOfBottom(){let e=this.layerArrays.x[this.bottomNode],t=this.currentBottomSite.point.x,r=this.currentTopSite.point.x;for(let i of this.RightFromTheNode(this.NodeLayer(this.bottomNode),e,eP.Bottom,t,r))for(let e of this.NodeCorners(i))e.y>this.currentBottomSite.point.y&&s8.PossibleCorner(t,r,e)&&(yield e)}*CornersToTheRightOfTop(){let e=this.layerArrays.x[this.topNode],t=this.currentTopSite.point.x,r=this.currentBottomSite.point.x;for(let i of this.RightFromTheNode(this.NodeLayer(this.topNode),e,eP.Top,t,r))for(let e of this.NodeCorners(i))e.y<this.currentTopSite.point.y&&s8.PossibleCorner(t,r,e)&&(yield e)}static PossibleCorner(e,t,r){return r.x>e&&r.x<t}NodeLayer(e){return this.layerArrays.Layers[this.layerArrays.y[e]]}IsLabel(e){return this.anchors[e].hasLabel}NodeUCanBeCrossedByNodeV(e,t){return!(this.IsLabel(e)||this.IsLabel(t))&&(!!(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t)&&this.AdjacentEdgesIntersect(e,t))||!1)}AdjacentEdgesIntersect(e,t){return this.Intersect(this.IncomingEdge(e),this.IncomingEdge(t))||this.Intersect(this.OutcomingEdge(e),this.OutcomingEdge(t))}Intersect(e,t){return(this.layerArrays.x[e.Source]-this.layerArrays.x[t.Source])*(this.layerArrays.x[e.Target]-this.layerArrays.x[t.Target])<0}IncomingEdge(e){for(let t of this.layeredGraph.InEdges(e))return t;throw Error()}OutcomingEdge(e){for(let t of this.layeredGraph.OutEdges(e))return t;throw Error()}IsVirtualVertex(e){return e>=this.originalGraph.shallowNodeCount}*RightFromTheNode(e,t,r,i,n){let s=0,o=0;r===eP.Bottom&&(s=Number.MAX_VALUE),r===eP.Top&&(o=Number.MAX_VALUE);let a=e[t];for(let r=t+1;r<e.length;r++){let t=e[r];if(this.NodeUCanBeCrossedByNodeV(t,a))continue;let h=this.anchors[t];if(h.left>=n)break;h.right>i&&(h.topAnchor>o+l.distanceEpsilon?(o=h.topAnchor,yield t):h.bottomAnchor>s+l.distanceEpsilon&&(s=h.bottomAnchor,yield t))}}*LeftFromTheNode(e,t,r,i,n){let s=0,o=0;r===eP.Bottom&&(s=Number.MAX_VALUE),r===eP.Top&&(o=Number.MAX_VALUE);let a=e[t];for(let r=t-1;r>-1;r--){let t=e[r];if(this.NodeUCanBeCrossedByNodeV(t,a))continue;let h=this.anchors[t];if(h.right<=i)break;h.left<n&&(h.topAnchor>o+l.distanceEpsilon?(o=h.topAnchor,yield t):h.bottomAnchor>s+l.distanceEpsilon&&(s=h.bottomAnchor,yield t))}}}class s7{constructor(e,t,r,i,n,s,o){this.thinRightNodes=[],this.thinWestNodes=[],this.database=o,this.edgePath=e,this.anchors=t,this.layerArrays=n,this.originalGraph=r,this.settings=i,this.layeredGraph=s,this.eastHierarchy=this.BuildEastHierarchy(),this.westHierarchy=this.BuildWestHierarchy()}BuildEastHierarchy(){let e=this.FindEastBoundaryAnchorCurves(),t=[];for(let r of e)t.push(r.pNodeOverICurve());return this.thinEastHierarchy=s9.Calculate(this.thinRightNodes),s9.Calculate(t)}BuildWestHierarchy(){let e=this.FindWestBoundaryAnchorCurves(),t=[];for(let r of e)t.push(r.pNodeOverICurve());return this.thinWestHierarchy=s9.Calculate(this.thinWestNodes),s9.Calculate(t)}FindEastBoundaryAnchorCurves(){let e=[],t=0;for(let r of this.edgePath){let i=null;for(let n of this.EastBoundaryNodesOfANode(r,oe.GetNodeKind(t,this.edgePath))){let t=this.anchors[n];(null==i||i.origin.x>t.origin.x)&&(i=t),e.push(t.polygonalBoundary)}null!=i&&this.thinRightNodes.push(b.mkLinePXY(i.origin,this.originalGraph.right,i.y).pNodeOverICurve()),t++}return e}FindWestBoundaryAnchorCurves(){let e=[],t=0;for(let r of this.edgePath.nodes()){let i=-1;for(let n of this.LeftBoundaryNodesOfANode(r,oe.GetNodeKind(t,this.edgePath)))(-1===i||this.layerArrays.x[n]>this.layerArrays.x[i])&&(i=n),e.push(this.anchors[n].polygonalBoundary);if(-1!==i){let e=this.anchors[i];this.thinWestNodes.push(b.mkLinePXY(e.origin,this.originalGraph.left,e.origin.y).pNodeOverICurve())}t++}return e}*FillRightTopAndBottomVerts(e,t,r){let i=0,n=0;r===eP.Bottom?i=Number.MAX_VALUE:r===eP.Top&&(n=Number.MAX_VALUE);let s=e[t];for(let r=t+1;r<e.length;r++){let t=e[r],o=this.anchors[t];o.topAnchor>n?!this.NodeUCanBeCrossedByNodeV(t,s)&&(n=o.topAnchor,o.bottomAnchor>i&&(i=o.bottomAnchor),yield t):o.bottomAnchor>i&&!this.NodeUCanBeCrossedByNodeV(t,s)&&(i=o.bottomAnchor,o.topAnchor>n&&(n=o.topAnchor),yield t)}}*FillLeftTopAndBottomVerts(e,t,r){let i=0,n=0;r===eP.Top?n=Number.MAX_VALUE:r===eP.Bottom&&(i=Number.MAX_VALUE);let s=e[t];for(let r=t-1;r>=0;r--){let t=e[r],o=this.anchors[t];o.topAnchor>n+l.distanceEpsilon?!this.NodeUCanBeCrossedByNodeV(t,s)&&(n=o.topAnchor,i=Math.max(i,o.bottomAnchor),yield t):o.bottomAnchor>i+l.distanceEpsilon&&!this.NodeUCanBeCrossedByNodeV(t,s)&&(n=Math.max(n,o.topAnchor),i=o.bottomAnchor,yield t)}}IsVirtualVertex(e){return e>=this.originalGraph.shallowNodeCount}IsLabel(e){return this.anchors[e].hasLabel}NodeUCanBeCrossedByNodeV(e,t){return!(this.IsLabel(e)||this.IsLabel(t))&&(!!(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t)&&this.EdgesIntersectSomewhere(e,t))||!1)}EdgesIntersectSomewhere(e,t){return!this.UVAreMiddlesOfTheSameMultiEdge(e,t)&&(this.IntersectAbove(e,t)||this.IntersectBelow(e,t))}UVAreMiddlesOfTheSameMultiEdge(e,t){return!!(this.database.MultipleMiddles.has(e)&&this.database.MultipleMiddles.has(t))&&this.SourceOfTheOriginalEdgeContainingAVirtualNode(e)===this.SourceOfTheOriginalEdgeContainingAVirtualNode(t)||!1}SourceOfTheOriginalEdgeContainingAVirtualNode(e){for(;this.IsVirtualVertex(e);)e=this.IncomingEdge(e).Source;return e}IntersectBelow(e,t){do{let r=this.OutcomingEdge(e),i=this.OutcomingEdge(t);if(this.Intersect(r,i))return!0;e=r.Target,t=i.Target}while(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t));return e===t}IntersectAbove(e,t){do{let r=this.IncomingEdge(e),i=this.IncomingEdge(t);if(this.Intersect(r,i))return!0;e=r.Source,t=i.Source}while(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t));return e===t}Intersect(e,t){let r=this.layerArrays.x[e.Source]-this.layerArrays.x[t.Source],i=this.layerArrays.x[e.Target]-this.layerArrays.x[t.Target];return r>0&&i<0||r<0&&i>0}IncomingEdge(e){return this.layeredGraph.InEdgeOfVirtualNode(e)}OutcomingEdge(e){return this.layeredGraph.OutEdgeOfVirtualNode(e)}EastBoundaryNodesOfANode(e,t){return this.FillRightTopAndBottomVerts(this.NodeLayer(e),this.layerArrays.x[e],t)}NodeLayer(e){return this.layerArrays.Layers[this.layerArrays.y[e]]}LeftBoundaryNodesOfANode(e,t){return this.FillLeftTopAndBottomVerts(this.NodeLayer(e),this.layerArrays.x[e],t)}getSpline(e){return this.createRefinedPolyline(e),this.createSmoothedPolyline()}get GetPolyline(){return new O(this.headSite)}LineSegIntersectBound(e,t){let r=b.mkPP(e,t);return s7.CurveIntersectsHierarchy(r,this.westHierarchy)||s7.CurveIntersectsHierarchy(r,this.thinWestHierarchy)||s7.CurveIntersectsHierarchy(r,this.eastHierarchy)||s7.CurveIntersectsHierarchy(r,this.thinEastHierarchy)}SegIntersectWestBound(e,t){return s7.SegIntersectsBound(e,t,this.westHierarchy)||s7.SegIntersectsBound(e,t,this.thinWestHierarchy)}SegIntersectEastBound(e,t){return s7.SegIntersectsBound(e,t,this.eastHierarchy)||s7.SegIntersectsBound(e,t,this.thinEastHierarchy)}TryToRemoveInflectionCorner(e){if(!e.s.next||!e.s.prev||e.s.turn===eo.Counterclockwise&&this.SegIntersectEastBound(e.s.prev,e.s.next)||e.s.turn===eo.Clockwise&&this.SegIntersectWestBound(e.s.prev,e.s.next)){e.cut=!1,e.s=e.s.next;return}let t=e.s.next;e.s.prev.next=t,t.prev=e.s.prev,e.s=t,e.cut=!0}static SegIntersectsBound(e,t,r){return s7.CurveIntersectsHierarchy(b.mkPP(e.point,t.point),r)}static CurveIntersectsHierarchy(e,t){if(null==t||!v.intersect(e.pNodeOverICurve().parallelogram,t.parallelogram))return!1;if(t.node.hasOwnProperty("children")){let r=t.node;return s7.CurveIntersectsHierarchy(e,r.children[0])||s7.CurveIntersectsHierarchy(e,r.children[1])}return null!=C.intersectionOne(e,t.seg,!1)}static Flat(e){return g.getTriangleOrientation(e.prev.point,e.point,e.next.point)===eo.Collinear}Reverse(){let e=new s7(this.edgePath,this.anchors,this.originalGraph,this.settings,this.layerArrays,this.layeredGraph,this.database),t=this.headSite,r=null;for(;null!=t;)e.headSite=t.clone(),e.headSite.next=r,null!=r&&(r.prev=e.headSite),r=e.headSite,t=t.next;return e}createRefinedPolyline(e){let t;this.CreateInitialListOfSites();let r=this.headSite;for(let e=0;e<this.edgePath.count;e++)t=r.next,this.RefineBeetweenNeighborLayers(r,this.EdgePathNode(e),this.EdgePathNode(e+1)),r=t;this.TryToRemoveInflections(),e&&this.OptimizeShortPath()}RefineBeetweenNeighborLayers(e,t,r){s8.Refine(t,r,e,this.anchors,this.layerArrays,this.layeredGraph,this.originalGraph,this.settings.LayerSeparation)}CreateInitialListOfSites(){let e=this.headSite=R.mkSiteP(this.EdgePathPoint(0));for(let t=1;t<=this.edgePath.count;t++)e=R.mkSiteSP(e,this.EdgePathPoint(t))}get TailSite(){let e=this.headSite;for(;null!=e.next;)e=e.next;return e}OptimizeForThreeSites(){let e=this.EdgePathNode(0),t=this.EdgePathNode(2),r=this.anchors[e],i=this.anchors[t];if(c(r.x,i.x))return;let n={ax:r.x,bx:i.x,sign:0};if(!this.FindLegalPositions(r,i,n))return;let s=(r.y-i.y)/(r.bottom-i.top),o=.5*(n.ax+n.bx),a=n.sign*((n.ax-n.bx)*.5);n.ax=o+s*(a*n.sign),n.bx=o-s*(a*n.sign),this.headSite.point=new g(n.ax,r.y);let l=this.headSite.next,h=l.point.y;l.point=new g(this.MiddlePos(n.ax,n.bx,r,i,h),h),l.next.point=new g(n.bx,i.y),this.anchors[this.EdgePathNode(1)].x=l.point.x}OptimizeForTwoSites(){let e=this.EdgePathNode(0),t=this.EdgePathNode(1),r=this.anchors[e],i=this.anchors[t];if(c(r.x,i.x))return;let n={ax:r.x,bx:i.x,sign:0};if(!this.FindPositions(r,i,n))return;let s=(r.y-i.y)/(r.bottom-i.top),o=.5*(n.ax+n.bx),a=n.sign*((n.ax-n.bx)*.5);n.ax=o+s*(a*n.sign),n.bx=o-s*(a*n.sign),this.headSite.point=new g(n.ax,r.y),this.headSite.next.point=new g(n.bx,i.y)}FindLegalPositions(e,t,r){return!!this.FindPositions(e,t,r)&&this.PositionsAreLegal(r.ax,r.bx,r.sign,e,t,this.EdgePathNode(1))}FindPositions(e,t,r){let i,n;if(r.ax<r.bx?(r.sign=1,n=Math.max(r.ax,t.left),i=Math.min(e.right,r.bx)):(r.sign=-1,n=Math.max(e.left,r.bx),i=Math.min(t.right,r.ax)),n<=i)r.bx=.5*(n+i),r.ax=.5*(n+i);else{if(this.OriginToOriginSegCrossesAnchorSide(e,t))return!1;1===r.sign?(r.ax=e.right-.1*e.rightAnchor,r.bx=t.left):(r.ax=e.left+.1*e.leftAnchor,r.bx=t.right)}return!0}OriginToOriginSegCrossesAnchorSide(e,t){let r=b.mkPP(e.origin,t.origin);return e.x<t.x&&C.CurvesIntersect(r,b.mkPP(e.rightBottom,e.rightTop))||C.CurvesIntersect(r,b.mkPP(t.leftBottom,e.leftTop))||e.x>t.x&&C.CurvesIntersect(r,b.mkPP(e.leftBottom,e.leftTop))||C.CurvesIntersect(r,b.mkPP(t.rightBottom,e.rightTop))}OptimizeShortPath(){if(!(this.edgePath.count>2))2===this.edgePath.count&&null!=this.headSite.next.next&&null==this.headSite.next.next.next&&null==this.anchors[this.EdgePathNode(1)].node?this.OptimizeForThreeSites():1===this.edgePath.count&&this.OptimizeForTwoSites()}PositionsAreLegal(e,t,r,i,n,s){if(!c(e,t)&&(e-t)*r>0)return!1;let o=this.anchors[s],a=this.MiddlePos(e,t,i,n,o.y);return!!this.MiddleAnchorLegal(a,s,o)&&!this.LineSegIntersectBound(new g(e,i.bottom),new g(t,n.top))}MiddleAnchorLegal(e,t,r){let i=this.NodeLayer(t),n=this.layerArrays.x[t],s=e-r.x;return(!(n>0)||!(this.anchors[i[n-1]].right>s+r.left))&&(!(n<i.length-1)||!(this.anchors[i[n+1]].left<s+r.right))&&!0}MiddlePos(e,t,r,i,n){let s=r.y-n,o=n-i.y;return(e*s+t*o)/(s+o)}TryToRemoveInflections(){if(this.TurningAlwaySameDirection())return;let e=!0;for(;e;){e=!1;for(let t={s:this.headSite,cut:!1};t.s;)this.TryToRemoveInflectionCorner(t),e=t.cut||e}}TurningAlwaySameDirection(){let e=0;for(let t=this.headSite.next;null!=t&&null!=t.next;t=t.next){let r=t.turn;if(0===e)r>0?e=1:r<0&&(e=-1);else if(e*r<0)return!1}return!0}EdgePathPoint(e){return this.anchors[this.EdgePathNode(e)].origin}EdgePathNode(e){return e===this.edgePath.count?this.edgePath.LayerEdges[this.edgePath.count-1].Target:this.edgePath.LayerEdges[e].Source}createSmoothedPolyline(){this.RemoveVerticesWithNoTurns();let e=new C,t=this.headSite,r=C.findCorner(t);return void 0!==r?(this.createFilletCurve(e,{a:t,b:r.b,c:r.c}),e=this.ExtendCurveToEndpoints(e)):e.addSegment(b.mkPP(this.headSite.point,this.TailSite.point)),e}curveIsLegal(e){return!0}RemoveVerticesWithNoTurns(){for(;this.RemoveVerticesWithNoTurnsOnePass(););}RemoveVerticesWithNoTurnsOnePass(){let e=!1;for(let t=this.headSite;null!=t.next&&null!=t.next.next;t=t.next)s7.Flat(t.next)&&(e=!0,t.next=t.next.next,t.next.prev=t);return e}ExtendCurveToEndpoints(e){let t=this.headSite.point;if(!g.closeDistEps(t,e.start)){let r=new C;r.addSegs([b.mkPP(t,e.start),e]),e=r}return t=this.TailSite.point,!g.closeDistEps(t,e.end)&&e.addSegment(b.mkPP(e.end,t)),e}createFilletCurve(e,t){for(;;)if(this.AddSmoothedCorner(t.a,t.b,t.c,e),t.a=t.b,t.b=t.c,null!=t.b.next)t.c=t.b.next;else break}AddSmoothedCorner(e,t,r,i){let n,s=.5;do n=C.createBezierSeg(s,s,e,t,r),t.previouisBezierCoefficient=s,s/=2;while(this.BezierSegIntersectsBoundary(n));if((s*=2)<.5){s=.5*(s+2*s);let i=C.createBezierSeg(s,s,e,t,r);!this.BezierSegIntersectsBoundary(i)&&(t.nextBezierCoefficient=s,t.previouisBezierCoefficient=s,n=i)}i.segs.length>0&&!g.closeDistEps(i.end,n.start)&&i.addSegment(b.mkPP(i.end,n.start)),i.addSegment(n)}BezierSegIntersectsBoundary(e){return 0>g.signedDoubledTriangleArea(e.B(0),e.B(1),e.B(2))?this.BezierSegIntersectsTree(e,this.thinWestHierarchy)||this.BezierSegIntersectsTree(e,this.westHierarchy):this.BezierSegIntersectsTree(e,this.thinEastHierarchy)||this.BezierSegIntersectsTree(e,this.eastHierarchy)}BezierSegIntersectsTree(e,t){if(null==t)return!1;if(!v.intersect(e.pNodeOverICurve().parallelogram,t.parallelogram))return!1;if(!t.node.hasOwnProperty("children"))return s7.BezierSegIntersectsBoundary(e,t.seg);{let r=t.node;return this.BezierSegIntersectsTree(e,r.children[0])||this.BezierSegIntersectsTree(e,r.children[1])}}static BezierSegIntersectsBoundary(e,t){for(let r of C.getAllIntersections(e,t,!1)){if(!(t instanceof C))return!0;if(C.realCutWithClosedCurve(r,t,!1))return!0}return!1}}class oe extends e0{constructor(e,t,r,i,n,s){super(null),this.settings=e,this.OriginalGraph=t,this.Database=r,this.ProperLayeredGraph=n,this.LayerArrays=i,this.IntGraph=s}run(){this.createSplines()}createSplines(){this.createRegularSplines(),this.createSelfSplines(),null!=this.IntGraph&&this.RouteFlatEdges(),null==this.OriginalGraph.graph.parent&&this.RouteUnroutedEdges()}RouteUnroutedEdges(){let e=[];for(let t of this.OriginalGraph.deepEdges)!t.curve&&e.push(t);if(0==e.length)return;let t=(this.OriginalGraph.layoutSettings?this.OriginalGraph.layoutSettings:new i8).commonSettings.edgeRoutingSettings;new sL(this.OriginalGraph,e,t.padding,t.polylinePadding,t.coneAngle,t.bundlingSettings,this.cancelToken).run(),nN.constructorGA(this.OriginalGraph,e).run()}RouteFlatEdges(){}createRegularSplines(){for(let e of this.Database.RegularMultiedges()){if(function(e){if(e.length<4)return!1;for(let t of e)if(t.edge.label)return!1;return!0}(e))continue;let t=e.length,r=1===t&&this.MayOptimizeEdge(e[0]);for(let i=Math.floor(t/2);i<t;i++)this.createSplineForNonSelfEdge(e[i],r);for(let i=Math.floor(t/2)-1;i>=0;i--)this.createSplineForNonSelfEdge(e[i],r)}}MayOptimizeEdge(e){return!(this.ProperLayeredGraph.OutDegreeIsMoreThanOne(e.source)||this.ProperLayeredGraph.InDegreeIsMoreThanOne(e.target)||ot(e.edge.source)||ot(e.edge.target))}createSelfSplines(){for(let[e,t]of this.Database.Multiedges.keyValues())if(e.x===e.y){let r=this.Database.Anchors[e.x],i=r.leftAnchor;for(let e of t){let t=this.settings.NodeSeparation+(this.settings.MinNodeWidth+i),n=r.bottomAnchor/2,s=r.origin,o=s.add(new g(0,n)),a=s.add(new g(t,n)),l=s.add(new g(t,-n)),h=s.add(new g(0,-n)),u=R.mkSiteP(s),c=new O(u);u=R.mkSiteSP(u,o),u=R.mkSiteSP(u,a),u=R.mkSiteSP(u,l),u=R.mkSiteSP(u,h),R.mkSiteSP(u,s);let d=c.createCurve();if(e.curve=d,i=t,null!=e.edge.label){i+=e.edge.label.width;let t=new g(d.value((d.parStart+d.parEnd)/2).x+e.labelWidth/2,r.y),n=new g(e.edge.label.width/2,e.edge.label.height/2),s=M.mkPP(t.add(n),t.sub(n));e.edge.label.width=s.width,e.edge.label.height=s.height,e.edge.label.positionCenter(t)}rP.trimSplineAndCalculateArrowheadsII(e.edge,e.edge.source.boundaryCurve,e.edge.target.boundaryCurve,d,!1)}}}createSplineForNonSelfEdge(e,t){null!=e.LayerEdges&&(this.drawSplineBySmothingThePolyline(e,t),!e.IsVirtualEdge&&(e.updateEdgeLabelPosition(this.Database.Anchors),rP.trimSplineAndCalculateArrowheadsII(e.edge,e.edge.source.boundaryCurve,e.edge.target.boundaryCurve,e.curve,!0)))}drawSplineBySmothingThePolyline(e,t){let r=new s7(e,this.Database.Anchors,this.OriginalGraph,this.settings,this.LayerArrays,this.ProperLayeredGraph,this.Database).getSpline(t);e.reversed?e.curve=r.reverse():e.curve=r}static UpdateLabel(e,t){let r=null;t.labelIsToTheRightOfTheSpline?(e.label.positionCenter(new g(t.x+t.rightAnchor/2,t.y)),r=b.mkPP(e.label.boundingBox.leftTop,e.label.boundingBox.leftBottom)):t.labelIsToTheLeftOfTheSpline&&(e.label.positionCenter(new g(t.x-t.leftAnchor/2,t.y)),r=b.mkPP(e.label.boundingBox.rightTop,e.label.boundingBox.rightBottom));let i=oe.GetSegmentInFrontOfLabel(e.curve,e.label.center.y);if(null!=i){if(0===C.getAllIntersections(e.curve,C.polyFromBox(e.label.boundingBox),!1).length){let t={curveClosestPoint:void 0,labelSideClosest:void 0};if(oe.FindClosestPoints(t,i,r))oe.ShiftLabel(e,t);else{let n=i.closestParameter(r.start),s=i.closestParameter(r.end);i.value(n).sub(r.start).length<i.value(s).sub(r.end).length?(t.curveClosestPoint=i.value(n),t.labelSideClosest=r.start):(t.curveClosestPoint=i.value(s),t.labelSideClosest=r.end),oe.ShiftLabel(e,t)}}}}static ShiftLabel(e,t){let r=e.lineWidth/2,i=t.curveClosestPoint.sub(t.labelSideClosest),n=i.length;n>r&&e.label.positionCenter(e.label.center.add(i.div(n*(n-r))))}static FindClosestPoints(e,t,r){let i=C.minDistWithinIntervals(t,r,t.parStart,t.parEnd,r.parStart,r.parEnd,(t.parStart+t.parEnd)/2,(r.parStart+r.parEnd)/2);return!!i&&(e.curveClosestPoint=i.aX,e.labelSideClosest=i.bX,!0)}static GetSegmentInFrontOfLabel(e,t){if(e instanceof C){for(let r of e.segs)if((r.start.y-t)*(r.end.y-t)<=0)return r}return null}static GetNodeKind(e,t){return 0===e?eP.Top:e<t.count?eP.Internal:eP.Bottom}}function ot(e){return e.node.selfEdges.size>0}class or extends e0{get extremeAspectRatio(){let e=this.originalGraph.boundingBox,t=e.width/e.height;return t<.02||t>50}get verticalConstraints(){return this.sugiyamaSettings.verticalConstraints}get HorizontalConstraints(){return this.sugiyamaSettings.horizontalConstraints}constructor(e,t,r){if(super(r),this.LayersAreDoubled=!1,null==e)return;this.originalGraph=e,this.sugiyamaSettings=t;let i=Array.from(e.shallowNodes);this.nodeIdToIndex=new Map;let n=0;for(let e of i)this.nodeIdToIndex.set(e.id,n++);let s=[];for(let e of this.originalGraph.shallowEdges){let t=this.nodeIdToIndex.get(e.source.id);if(null==t)continue;let r=this.nodeIdToIndex.get(e.target.id);if(null==r)continue;let i=new i3(t,r,e);s.push(i)}for(let t of(this.IntGraph=new sD(s,e.shallowNodeCount),this.IntGraph.nodes=i,this.database=new sB(i.length),this.IntGraph.edges))this.database.registerOriginalEdgeInMultiedges(t);this.cycleRemoval()}run(){if(0===this.originalGraph.shallowNodeCount){this.originalGraph.boundingBox=M.mkEmpty();return}(function(e,t){if(t.isIdentity())return;let r=t.inverse();for(let t of e.shallowNodes)t.transform(r);for(let t of e.shallowEdges)if(null!=t.label){let e=M.mkPP(r.multiplyPoint(new g(0,0)),r.multiplyPoint(new g(t.label.width,t.label.height)));t.label.width=e.width,t.label.height=e.height}})(this.originalGraph,this.sugiyamaSettings.transform),this.engineLayerArrays=this.calculateLayers(),this.sugiyamaSettings.edgeRoutingSettings.EdgeRoutingMode===eb.SugiyamaSplines&&this.runPostLayering(),function(e,t){if(!t.isIdentity()){for(let r of e.shallowNodes)r.transform(t);for(let r of e.shallowEdges)if(null!=r.label){let e=M.mkPP(t.multiplyPoint(new g(0,0)),t.multiplyPoint(new g(r.label.width,r.label.height)));r.label.width=e.width,r.label.height=e.height}(function(e,t){for(let r of e.shallowEdges)r.label&&r.label.transform(t),function(e,t){if(null!=t.curve){t.curve=t.curve.transform(e);null!=t.sourceArrowhead&&(t.sourceArrowhead.tipPosition=e.multiplyPoint(t.sourceArrowhead.tipPosition)),null!=t.targetArrowhead&&(t.targetArrowhead.tipPosition=e.multiplyPoint(t.targetArrowhead.tipPosition)),function(e,t){if(null!=e.smoothedPolyline)for(let r=e.smoothedPolyline.headSite;null!=r;r=r.next)r.point=t.multiplyPoint(r.point)}(t,e)}}(t,r)})(e,t),null==e.graph.parent&&(e.boundingBox=null)}}(this.originalGraph,this.sugiyamaSettings.transform)}runPostLayering(){let e=this.sugiyamaSettings.commonSettings.edgeRoutingSettings,t=null!=this.constrainedOrdering?eb.Spline:e.EdgeRoutingMode;this.extremeAspectRatio?nC(this.originalGraph,Array.from(this.originalGraph.deepEdges),this.cancelToken):t===eb.SugiyamaSplines?this.calculateEdgeSplines():se(this.originalGraph,Array.from(this.originalGraph.deepEdges),this.cancelToken)}SetLabels(){throw Error("not implementedt")}cycleRemoval(){let e=this.sugiyamaSettings.verticalConstraints,t=e.isEmpty?rk.getFeedbackSet(this.IntGraph):e.getFeedbackSetExternal(this.IntGraph,this.nodeIdToIndex);this.database.addFeedbackSet(t)}calculateLayers(){this.CreateGluedDagSkeletonForLayering();let e=this.CalculateLayerArrays();return this.UpdateNodePositionData(),e}UpdateNodePositionData(){for(let e=0;e<this.IntGraph.nodeCount&&e<this.database.Anchors.length;e++)this.IntGraph.nodes[e].center=this.database.Anchors[e].origin;if(this.sugiyamaSettings.GridSizeByX>0)for(let e=0;e<this.originalGraph.shallowNodeCount;e++)this.SnapLeftSidesOfTheNodeToGrid(e,this.sugiyamaSettings.GridSizeByX)}SnapLeftSidesOfTheNodeToGrid(e,t){let r=this.IntGraph.nodes[e],i=this.database.Anchors[e];i.leftAnchor-=t/2,i.rightAnchor-=t/2;let n=r.boundingBox.left,s=Math.floor(n/t),o=n-s*t;if(!(.001>Math.abs(o)))Math.abs(o)<=t/2?r.center=r.center.add(new g(-o,0)):r.center=r.center.add(new g(t-o,0)),i.x=r.center.x}GetCurrentHeight(){let e=new rN;for(let t of this.NodeAnchors())e.AddValue(t.top),e.AddValue(t.bottom);return e.length}*NodeAnchors(){let e=Math.min(this.IntGraph.nodeCount,this.anchors.length);for(let t=0;t<e;t++)yield this.anchors[t]}GetCurrentWidth(){let e=new rN;for(let t of this.NodeAnchors())e.AddValue(t.left),e.AddValue(t.right);return e.length}ExtendLayeringToUngluedSameLayerVertices(e){let t=this.verticalConstraints;for(let r=0;r<e.length;r++)e[r]=e[t.nodeToRepr(r)];return e}calculateEdgeSplines(){new oe(this.sugiyamaSettings,this.originalGraph,this.database,this.engineLayerArrays,this.properLayeredGraph,this.IntGraph).run()}YLayeringAndOrdering(e){let t=e.GetLayers();sG.Balance(this.gluedDagSkeletonForLayering,t,this.GetNodeCountsOfGluedDag(),null);let r=new sV(t=this.ExtendLayeringToUngluedSameLayerVertices(t));if(null==this.HorizontalConstraints||this.HorizontalConstraints.IsEmpty)return r=this.YLayeringAndOrderingWithoutHorizontalConstraints(r);throw Error("not implemented")}CreateProperLayeredGraph(e){let t=e.length,r=0;for(let i of this.database.SkeletonEdges()){let n=function(e,t){return e[t.source]-e[t.target]}(e,i);n>0&&(i.LayerEdges=Array(n));let s=0;if(n>1){let e=t+r++,o=new i0(i.source,e,i.CrossingWeight,i.weight);i.LayerEdges[s++]=o;for(let t=0;t<n-2;t++)e++,r++,o=new i0(e-1,e,i.CrossingWeight,i.weight),i.LayerEdges[s++]=o;o=new i0(e,i.target,i.CrossingWeight,i.weight),i.LayerEdges[s]=o}else if(1===n){let e=new i0(i.source,i.target,i.CrossingWeight,i.weight);i.LayerEdges[s]=e}}let i=Array(this.originalGraph.shallowNodeCount+r).fill(0);for(let t of this.database.SkeletonEdges())if(null!=t.LayerEdges){let r=e[t.source];for(let e of(i[t.source]=r--,t.LayerEdges))i[e.Target]=r--}else i[t.source]=e[t.source],i[t.target]=e[t.target];return this.properLayeredGraph=new sU(new sD(Array.from(this.database.SkeletonEdges()),e.length)),this.properLayeredGraph.BaseGraph.nodes=this.IntGraph.nodes,new sV(i)}YLayeringAndOrderingWithoutHorizontalConstraints(e){let t=this.CreateProperLayeredGraph(e.y);return sZ.OrderLayers(this.properLayeredGraph,t,this.originalGraph.shallowNodeCount,this.sugiyamaSettings,this.cancelToken),sK.UpdateLayerArrays1(this.properLayeredGraph,t),t}CalculateYLayers(){let e=this.YLayeringAndOrdering(new s3(this.gluedDagSkeletonForLayering,this.cancelToken));return null!=this.constrainedOrdering?e:this.InsertLayersIfNeeded(e)}InsertLayersIfNeeded(e){this.InsertVirtualEdgesIfNeeded(e);let t=this.AnalyzeNeedToInsertLayersAndHasMultiedges(e);if(t.needToInsertLayers){let t=sz.InsertLayers(this.properLayeredGraph,e,this.database,this.IntGraph);this.properLayeredGraph=t.layeredGraph,e=t.la,this.LayersAreDoubled=!0}else if(t.multipleEdges){let t=sj.InsertPaths(this.properLayeredGraph,e,this.database,this.IntGraph);this.properLayeredGraph=t.layeredGraph,e=t.la}return this.RecreateIntGraphFromDataBase(),e}RecreateIntGraphFromDataBase(){let e=[];for(let t of this.database.Multiedges.values())e=e.concat(t);this.IntGraph.SetEdges(e,this.IntGraph.nodeCount)}InsertVirtualEdgesIfNeeded(e){if(null==this.constrainedOrdering){for(let[t,r]of this.database.Multiedges.keyValues())if(r.length%2==0&&e.y[t.x]-1===e.y[t.y]){let e=new V(null),i=new i3(t.x,t.y,e);i.IsVirtualEdge=!0,r.splice(r.length/2,0,i),this.IntGraph.addEdge(i)}}}AnalyzeNeedToInsertLayersAndHasMultiedges(e){let t=!1,r=!1;for(let r of this.IntGraph.edges)if(r.hasLabel&&e.y[r.source]!==e.y[r.target]){t=!0;break}if(!1===t&&null==this.constrainedOrdering){for(let[i,n]of this.database.Multiedges.keyValues())if(n.length>1&&(r=!0,e.y[i.x]-e.y[i.y]==1)){t=!0;break}}return{needToInsertLayers:t,multipleEdges:r}}UseBrandesXCalculations(e){return e.x.length>=this.sugiyamaSettings.BrandesThreshold}CalculateAnchorsAndYPositions(e){this.anchors=function(e,t,r,i,n){let s=e.Anchors=Array(t.NodeCount);for(let e=0;e<s.length;e++)s[e]=new s5(n.LabelCornersPreserveCoefficient);for(let t=0;t<r.shallowNodeCount;t++)or.CalcAnchorsForOriginalNode(t,i,s,e,n);for(let t of e.AllIntEdges())if(null!=t.LayerEdges){for(let r of t.LayerEdges){let i=r.Target;if(i!==t.target){let t=s[i];e.MultipleMiddles.has(i)?t.leftAnchor=t.rightAnchor=4*on():t.leftAnchor=t.rightAnchor=on()/2,t.topAnchor=t.bottomAnchor=os(n)/2}}if(t.hasLabel){let e=s[t.LayerEdges[t.LayerEdges.length/2].Source],r=t.labelWidth,i=t.labelHeight;e.rightAnchor=r,e.leftAnchor=8*on(),e.topAnchor<i/2&&(e.topAnchor=e.bottomAnchor=i/2),e.labelIsToTheRightOfTheSpline=!0}}return s}(this.database,this.properLayeredGraph,this.originalGraph,this.IntGraph,this.sugiyamaSettings),function(e,t,r,i,n,s,o){let a=i.Anchors,l=r.margins.top+t,h=0;for(let t of e.Layers){let u=0,c=0;for(let e of t){let t=a[e];t.bottomAnchor>u&&(u=t.bottomAnchor),t.topAnchor>c&&(c=t.topAnchor)}(function(e,t,r,i,n){if(function(e,t){for(let r of e)if(r<t)return!0;return!1}(e,i)){for(let s of e)if(s>=i){let e=n[s];e.bottomAnchor=t,e.topAnchor=r}}})(t,u,c,r.shallowNodeCount,i.Anchors);let d=oo(i,e,h,n,s,l),f=l+u+d,p=f+c;if(function(e){return e.SnapToGridByY===ey.Top}(s))for(let e of(p+=oi(p,s.GridSizeByY),t))a[e].top=p;else if(function(e){return e.SnapToGridByY===ey.Bottom}(s)){let e=f-u;for(let r of(e+=oi(e,e),t))a[r].bottom=e,p=Math.max(a[r].top,p)}else for(let e of t)a[e].y=f;l=p+s.ActualLayerSeparation(o),h++}oo(i,e,h,n,s,l)}(e,500,this.originalGraph,this.database,this.IntGraph,this.sugiyamaSettings,this.LayersAreDoubled)}OptimizeEdgeLabelsLocations(){for(let e=0;e<this.anchors.length;e++){let t=this.anchors[e];if(t.labelIsToTheRightOfTheSpline){let r=this.GetSuccessorAndPredecessor(e);if(!function(e,t,r){if(e.labelIsToTheRightOfTheSpline){if(g.getTriangleOrientation(t.origin,e.origin,r.origin)===eo.Clockwise)return!0;let i=e.leftAnchor,n=e.rightAnchor,s=e.x;if(oa(e),g.getTriangleOrientation(t.origin,e.origin,r.origin)===eo.Counterclockwise)return!0;e.x=s,e.leftAnchor=i,e.rightAnchor=n,e.labelIsToTheRightOfTheSpline=!0,e.labelIsToTheLeftOfTheSpline=!1}return!1}(t,r.predecessor,r.successor)){let e=r.predecessor.origin.sub(t.origin).length+r.successor.origin.sub(t.origin).length,i=new g(t.right-t.leftAnchor,t.y);r.predecessor.origin.sub(i).length+r.successor.origin.sub(i).length<e&&oa(t)}}}}GetSuccessorAndPredecessor(e){let t,r;for(let r of this.properLayeredGraph.InEdges(e))t=r.Source;for(let t of this.properLayeredGraph.OutEdges(e))r=t.Target;return{predecessor:this.anchors[t],successor:this.anchors[r]}}CalculateLayerArrays(){let e=this.CalculateYLayers();return null==this.constrainedOrdering?(this.CalculateAnchorsAndYPositions(e),this.UseBrandesXCalculations(e)?this.CalculateXPositionsByBrandes(e):this.CalculateXLayersByGansnerNorth(e)):this.anchors=this.database.Anchors,this.OptimizeEdgeLabelsLocations(),this.engineLayerArrays=e,this.StraightensShortEdges(),this.CalculateOriginalGraphBox(),e}StretchToDesiredAspectRatio(e,t){e>t?this.StretchInYDirection(e/t):e<t&&this.StretchInXDirection(t/e)}StretchInYDirection(e){let t=(this.originalGraph.boundingBox.top+this.originalGraph.boundingBox.bottom)/2;for(let r of this.database.Anchors)r.bottomAnchor=r.bottomAnchor*e,r.topAnchor=r.topAnchor*e,r.y=t+e*(r.y-t);let r=this.originalGraph.height*e;this.originalGraph.boundingBox=new M({left:this.originalGraph.boundingBox.left,top:t+r/2,right:this.originalGraph.boundingBox.right,bottom:t-r/2})}StretchInXDirection(e){let t=(this.originalGraph.boundingBox.left+this.originalGraph.boundingBox.right)/2;for(let r of this.database.Anchors)r.leftAnchor=r.leftAnchor*e,r.rightAnchor=r.rightAnchor*e,r.x=t+e*(r.x-t);let r=this.originalGraph.width*e;this.originalGraph.boundingBox=new M({left:t-r/2,top:this.originalGraph.boundingBox.top,right:t+r/2,bottom:this.originalGraph.boundingBox.bottom})}CalculateOriginalGraphBox(){if(0===this.anchors.length)return;let e=new M({left:this.anchors[0].left,top:this.anchors[0].top,right:this.anchors[0].right,bottom:this.anchors[0].bottom});for(let t=1;t<this.anchors.length;t++){let r=this.anchors[t];e.add(r.leftTop),e.add(r.rightBottom)}this.originalGraph.labelSize&&this.originalGraph.addLabelToGraphBB(e),e.padEverywhere(this.originalGraph.margins),this.originalGraph.boundingBox=e}StraightensShortEdges(){if(!(this.anchors.length<20))for(;this.StraightenEdgePaths(););}StraightenEdgePaths(){let e=!1;for(let t of this.database.AllIntEdges())2===t.LayerSpan&&(e=this.ShiftVertexWithNeighbors(t.LayerEdges[0].Source,t.LayerEdges[0].Target,t.LayerEdges[1].Target)||e);return e}ShiftVertexWithNeighbors(e,t,r){let i=this.database.Anchors[e],n=this.database.Anchors[r],s=this.database.Anchors[t],o=(s.y-i.y)*((n.x-i.x)/(n.y-i.y))+i.x;return o>s.x+1e-4?this.TryShiftToTheRight(o,t):!!(o<s.x-1e-4)&&this.TryShiftToTheLeft(o,t)}TryShiftToTheLeft(e,t){let r=this.engineLayerArrays.Layers[this.engineLayerArrays.y[t]],i=this.engineLayerArrays.x[t];if(i>0){let n=Math.max(this.database.Anchors[r[i-1]].right+(this.sugiyamaSettings.NodeSeparation+this.database.Anchors[t].leftAnchor),e);return!!(n<this.database.Anchors[t].x-1)&&(this.database.Anchors[t].x=n,!0)}return this.database.Anchors[t].x=e,!0}TryShiftToTheRight(e,t){let r=this.engineLayerArrays.Layers[this.engineLayerArrays.y[t]],i=this.engineLayerArrays.x[t];if(i<r.length-1){let n=Math.min(this.database.Anchors[r[i+1]].left-(this.sugiyamaSettings.NodeSeparation-this.database.Anchors[t].rightAnchor),e);return!!(n>this.database.Anchors[t].x+1)&&(this.database.Anchors[t].x=n,!0)}return this.database.Anchors[t].x=e,!0}CalculateXLayersByGansnerNorth(e){this.xLayoutGraph=this.CreateXLayoutGraph(e),this.CalculateXLayersByGansnerNorthOnProperLayeredGraph()}CalculateXLayersByGansnerNorthOnProperLayeredGraph(){let e=new s2(this.xLayoutGraph,null).GetLayers();for(let t=0;t<this.database.Anchors.length;t++)this.anchors[t].x=e[t]}CreateXLayoutGraph(e){let t=this.properLayeredGraph.NodeCount,r=[];for(let e of this.properLayeredGraph.Edges){let i=new i3(t,e.Source,null),n=new i3(t,e.Target,null);n.weight=e.Weight,i.weight=e.Weight,i.separation=0,n.separation=0,t++,r.push(i),r.push(n)}for(let t of e.Layers)for(let e=t.length-1;e>0;e--){let i=t[e],n=t[e-1],s=new i3(i,n,null),o=this.database.Anchors[i],a=this.database.Anchors[n],l=o.leftAnchor+(a.rightAnchor+this.sugiyamaSettings.NodeSeparation);s.separation=Math.ceil(l+.5),r.push(s)}let i=new s4(this.IntGraph,this.properLayeredGraph,e,r,t);return i.SetEdgeWeights(),i}CalculateXPositionsByBrandes(e){s6.CalculateXCoordinates(e,this.properLayeredGraph,this.originalGraph.shallowNodeCount,this.database.Anchors,this.sugiyamaSettings.NodeSeparation)}GluedDagSkeletonEdges(){let e=new rR;for(let[t,r]of this.database.Multiedges.keyValues()){if(t.isDiagonal())continue;let i=this.verticalConstraints.gluedIntEdge(r[0]);i.source!==i.target&&e.set(i.source,i.target,i)}for(let t of Array.from(this.verticalConstraints.gluedUpDownIntConstraints.values()).map(e=>(function(e,t){let r=new i3(e.x,e.y,t);return r.weight=0,r.separation=1,r})(e,null)))e.set(t.source,t.target,t);return Array.from(e.values())}static CalcAnchorsForOriginalNode(e,t,r,i,n){let s={leftAnchor:0,rightAnchor:0,topAnchor:0,bottomAnchor:0};null!=t.nodes&&function(e,t,r){e.rightAnchor=e.leftAnchor=(t.width+r.GridSizeByX)/2,e.topAnchor=e.bottomAnchor=t.height/2}(s,t.nodes[e],n),function(e,t,r,i){let n=function(e,t,r,i){let n=0,s=e.GetMultiedge(t,t);if(s.length>0){for(let e of s)null!=e.edge.label&&(r.rightAnchor+=e.edge.label.width,r.topAnchor<e.edge.label.height/2&&(r.topAnchor=r.bottomAnchor=e.edge.label.height/2));n+=(i.NodeSeparation+i.MinNodeWidth)*s.length}return n}(r,e,t,i);t.rightAnchor+=n}(e,s,i,n);let o=n.MinNodeWidth/2;s.leftAnchor<o&&(s.leftAnchor=o),s.rightAnchor<o&&(s.rightAnchor=o);let a=n.MinNodeHeight/2;s.topAnchor<a&&(s.topAnchor=a),s.bottomAnchor<a&&(s.bottomAnchor=a),r[e]=s5.mkAnchor(s.leftAnchor,s.rightAnchor,s.topAnchor,s.bottomAnchor,t.nodes[e],n.LabelCornersPreserveCoefficient),r[e].padding=1}CreateGluedDagSkeletonForLayering(){this.gluedDagSkeletonForLayering=new sD(this.GluedDagSkeletonEdges(),this.originalGraph.shallowNodeCount),this.SetGluedEdgesWeights()}SetGluedEdgesWeights(){let e=new rR;for(let t of this.gluedDagSkeletonForLayering.edges)e.set(t.source,t.target,t);for(let[t,r]of this.database.Multiedges.keyValues())if(t.x!==t.y){let i=this.verticalConstraints.gluedIntPair(t);if(i.x===i.y)continue;let n=e.get(i.x,i.y);for(let e of r)n.weight+=e.weight}}GetNodeCountsOfGluedDag(){return this.verticalConstraints.isEmpty?Array(this.IntGraph.nodeCount).fill(1):this.verticalConstraints.getGluedNodeCounts()}}function oi(e,t){if(0===t)return 0;let r=Math.floor(e/t),i=e-r*t;return 1e-4>Math.abs(i)?0:t-i}function on(){return 1}function os(e){return 1.5*e.MinNodeHeight/8}function oo(e,t,r,i,n,s){let o=0;if(r>0){let a=function(e,t,r){let i=new ij;for(let n of e)if(!(n>=r.nodeCount))for(let e of r.outEdges[n])t[e.source]===t[e.target]&&i.addNN(e.source,e.target);return Array.from(i.values())}(t.Layers[r-1],t.y,i);if(a.length){let t=n.LayerSeparation/3;o=Math.max(...a.map(r=>(function(e,t,r,i){let n=0;for(let s of i.GetMultiedgeI(e)){n+=r;let e=s.edge.label;null!=e&&(e.positionCenter(new g(e.center.x,t+n+e.height/2)),n+=e.height)}return n})(r,s,t,e)))}}return o}function oa(e){let t=e.right,r=e.leftAnchor;e.leftAnchor=e.rightAnchor,e.rightAnchor=r,e.x=t-e.rightAnchor,e.labelIsToTheLeftOfTheSpline=!0,e.labelIsToTheRightOfTheSpline=!1}},412:function(e,t,r){"use strict";function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{_:function(){return i}})},591:function(e,t,r){"use strict";let i;r.d(t,{$V:function(){return s8},$YQ:function(){return nP},BFQ:function(){return eq},BG$:function(){return e9},BVF:function(){return z},Bf4:function(){return eu},Bgp:function(){return es},BtG:function(){return nt},CaW:function(){return eJ},CdI:function(){return et},CtA:function(){return ej},Cy:function(){return V},D1R:function(){return ex},D67:function(){return tS},D9w:function(){return eU},Djp:function(){return e4},DvJ:function(){return iQ},E2K:function(){return eH},EcG:function(){return or},EoG:function(){return ee},F1y:function(){return tw},FM8:function(){return tj},FT0:function(){return sC},FUD:function(){return ti},GG6:function(){return tt},GUF:function(){return tb},Gih:function(){return tr},H7L:function(){return tq},HdW:function(){return th},HkE:function(){return sX},Hy8:function(){return N},I3e:function(){return tL},ILR:function(){return e$},IOt:function(){return tp},Ilk:function(){return i_},JOQ:function(){return na},JQ4:function(){return eE},JUT:function(){return rs},Jjb:function(){return tC},KI_:function(){return tv},KhW:function(){return I},Kj0:function(){return iK},Kz5:function(){return eP},LSk:function(){return tI},LY2:function(){return ei},LgZ:function(){return O},LsT:function(){return eT},Ltg:function(){return rt},Lun:function(){return sE},M$G:function(){return tT},M5h:function(){return x},M6v:function(){return Y},M8C:function(){return tz},N4l:function(){return y},NDo:function(){return J},NKc:function(){return U},NYV:function(){return e8},Ns1:function(){return Z},O4K:function(){return tZ},O5A:function(){return t$},O78:function(){return tE},O7d:function(){return sd},ORg:function(){return eo},OTo:function(){return ek},OoA:function(){return ep},PA7:function(){return tg},Pa4:function(){return ra},PeU:function(){return a},QO2:function(){return tl},Qey:function(){return tK},QmN:function(){return o},Rhp:function(){return i0},RlZ:function(){return B},RsA:function(){return s},S2y:function(){return h},S9g:function(){return r$},Se2:function(){return j},Sm8:function(){return E},SvJ:function(){return ts},T6w:function(){return tA},T95:function(){return eS},T_1:function(){return oe},TlE:function(){return iA},TyD:function(){return eg},UCm:function(){return eN},USm:function(){return rX},UZH:function(){return n},VLJ:function(){return s7},Vdb:function(){return L},Vkp:function(){return tH},VzW:function(){return eC},WMw:function(){return b},Wbm:function(){return w},Wl3:function(){return f},Wpd:function(){return D},Xaj:function(){return _},Y8D:function(){return eD},YGz:function(){return er},YLQ:function(){return em},ZAu:function(){return nT},ZTh:function(){return tc},ZXd:function(){return ot},Zen:function(){return tP},Zr5:function(){return H},_12:function(){return sm},_AM:function(){return eY},_Li:function(){return p},_RZ:function(){return tM},_fP:function(){return ro},_iA:function(){return u},_wr:function(){return F},aCh:function(){return tm},aH4:function(){return ev},aNw:function(){return sG},av9:function(){return ez},bGH:function(){return S},bdR:function(){return v},brP:function(){return eV},bsb:function(){return to},c8b:function(){return C},cLu:function(){return eA},cPb:function(){return i7},cRx:function(){return eB},cac:function(){return tX},dSO:function(){return eh},dZ3:function(){return en},dd2:function(){return ri},dpR:function(){return sW},dwf:function(){return i1},dwk:function(){return d},eD:function(){return q},eaV:function(){return eK},ehD:function(){return g},ekQ:function(){return e0},epp:function(){return t2},f2y:function(){return ta},fSK:function(){return k},fY$:function(){return ea},fto:function(){return eQ},g8_:function(){return ec},ghN:function(){return A},gi4:function(){return e6},hEm:function(){return eG},hH6:function(){return sj},iAb:function(){return ew},iKG:function(){return sq},iMs:function(){return s6},iWC:function(){return M},iWj:function(){return nu},iiP:function(){return tn},irR:function(){return eM},j17:function(){return tx},jFi:function(){return m},jZA:function(){return e3},jes:function(){return G},jyz:function(){return i5},k0A:function(){return eI},k74:function(){return R},ksN:function(){return X},l0P:function(){return e1},l6D:function(){return ty},lCJ:function(){return iM},lGU:function(){return td},lRF:function(){return sP},mSO:function(){return tf},nls:function(){return nc},ntZ:function(){return c},oAp:function(){return nr},oDz:function(){return i2},p3g:function(){return rn},pBf:function(){return tR},pKu:function(){return te},ptH:function(){return e2},qhX:function(){return K},qkB:function(){return eF},qlB:function(){return iI},qyh:function(){return ey},rDY:function(){return i3},rOj:function(){return T},r_:function(){return P},rpg:function(){return ed},tNt:function(){return tJ},tQZ:function(){return eO},tm_:function(){return l},u9r:function(){return iV},uL9:function(){return Q},uWy:function(){return ef},v3W:function(){return eX},vBJ:function(){return iP},vCF:function(){return W},vCx:function(){return eZ},vuL:function(){return tu},vxC:function(){return el},w$m:function(){return $},wJv:function(){return eR},wem:function(){return eb},wk1:function(){return eL},wuA:function(){return eW},x12:function(){return ny},xEZ:function(){return re},xJs:function(){return e7},xoQ:function(){return t_},xsS:function(){return ni},y2t:function(){return e5},yGw:function(){return rB},yHo:function(){return tQ},ywz:function(){return e_},zHn:function(){return rD}});let n="171",s={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},a=0,l=1,h=2,u=1,c=2,d=3,f=0,p=1,g=2,m=0,v=1,b=2,y=3,x=4,_=5,S=100,w=101,T=102,P=103,E=104,C=200,A=201,I=202,M=203,R=204,O=205,k=206,N=207,L=208,D=209,B=210,F=211,V=212,G=213,U=214,z=0,j=1,H=2,W=3,q=4,X=5,$=6,Y=7,Z=0,K=1,J=2,Q=0,ee=1,et=2,er=3,ei=4,en=5,es=6,eo=7,ea=301,el=302,eh=303,eu=304,ec=306,ed=1e3,ef=1001,ep=1002,eg=1003,em=1004,ev=1005,eb=1006,ey=1007,ex=1008,e_=1009,eS=1010,ew=1011,eT=1012,eP=1013,eE=1014,eC=1015,eA=1016,eI=1017,eM=1018,eR=1020,eO=35902,ek=1021,eN=1022,eL=1023,eD=1024,eB=1025,eF=1026,eV=1027,eG=1028,eU=1029,ez=1030,ej=1031,eH=1033,eW=33776,eq=33777,eX=33778,e$=33779,eY=35840,eZ=35841,eK=35842,eJ=35843,eQ=36196,e1=37492,e0=37496,e2=37808,e3=37809,e5=37810,e6=37811,e4=37812,e9=37813,e8=37814,e7=37815,te=37816,tt=37817,tr=37818,ti=37819,tn=37820,ts=37821,to=36492,ta=36494,tl=36495,th=36283,tu=36284,tc=36285,td=36286,tf=3201,tp=0,tg=1,tm="",tv="srgb",tb="srgb-linear",ty="linear",tx="srgb",t_=512,tS=513,tw=514,tT=515,tP=516,tE=517,tC=518,tA=519,tI="300 es",tM=2e3;class tR{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,i=r.length;t<i;t++)r[t].call(this,e);e.target=null}}}let tO=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],tk=1234567,tN=Math.PI/180,tL=180/Math.PI;function tD(){let e=0xffffffff*Math.random()|0,t=0xffffffff*Math.random()|0,r=0xffffffff*Math.random()|0,i=0xffffffff*Math.random()|0;return(tO[255&e]+tO[e>>8&255]+tO[e>>16&255]+tO[e>>24&255]+"-"+tO[255&t]+tO[t>>8&255]+"-"+tO[t>>16&15|64]+tO[t>>24&255]+"-"+tO[63&r|128]+tO[r>>8&255]+"-"+tO[r>>16&255]+tO[r>>24&255]+tO[255&i]+tO[i>>8&255]+tO[i>>16&255]+tO[i>>24&255]).toLowerCase()}function tB(e,t,r){return Math.max(t,Math.min(r,e))}function tF(e,t){return(e%t+t)%t}function tV(e,t,r){return(1-r)*e+r*t}function tG(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/0xffffffff;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/0x7fffffff,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw Error("Invalid component type.")}}function tU(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(0xffffffff*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(0x7fffffff*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw Error("Invalid component type.")}}let tz={DEG2RAD:tN,RAD2DEG:tL,generateUUID:tD,clamp:tB,euclideanModulo:tF,mapLinear:function(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)},inverseLerp:function(e,t,r){return e!==t?(r-e)/(t-e):0},lerp:tV,damp:function(e,t,r,i){return tV(e,t,1-Math.exp(-r*i))},pingpong:function(e,t=1){return t-Math.abs(tF(e,2*t)-t)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(tk=e);let t=tk+=0x6d2b79f5;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/0x100000000},degToRad:function(e){return e*tN},radToDeg:function(e){return e*tL},isPowerOfTwo:function(e){return(e&e-1)==0&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,r,i,n){let s=Math.cos,o=Math.sin,a=s(r/2),l=o(r/2),h=s((t+i)/2),u=o((t+i)/2),c=s((t-i)/2),d=o((t-i)/2),f=s((i-t)/2),p=o((i-t)/2);switch(n){case"XYX":e.set(a*u,l*c,l*d,a*h);break;case"YZY":e.set(l*d,a*u,l*c,a*h);break;case"ZXZ":e.set(l*c,l*d,a*u,a*h);break;case"XZX":e.set(a*u,l*p,l*f,a*h);break;case"YXY":e.set(l*f,a*u,l*p,a*h);break;case"ZYZ":e.set(l*p,l*f,a*u,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}},normalize:tU,denormalize:tG};class tj{constructor(e=0,t=0){tj.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=tB(this.x,e.x,t.x),this.y=tB(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=tB(this.x,e,t),this.y=tB(this.y,e,t),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(tB(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:Math.acos(tB(this.dot(e)/t,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*r-s*i+e.x,this.y=n*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class tH{constructor(e,t,r,i,n,s,o,a,l){tH.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,i,n,s,o,a,l)}set(e,t,r,i,n,s,o,a,l){let h=this.elements;return h[0]=e,h[1]=i,h[2]=o,h[3]=t,h[4]=n,h[5]=a,h[6]=r,h[7]=s,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],h=r[4],u=r[7],c=r[2],d=r[5],f=r[8],p=i[0],g=i[3],m=i[6],v=i[1],b=i[4],y=i[7],x=i[2],_=i[5],S=i[8];return n[0]=s*p+o*v+a*x,n[3]=s*g+o*b+a*_,n[6]=s*m+o*y+a*S,n[1]=l*p+h*v+u*x,n[4]=l*g+h*b+u*_,n[7]=l*m+h*y+u*S,n[2]=c*p+d*v+f*x,n[5]=c*g+d*b+f*_,n[8]=c*m+d*y+f*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],h=e[8];return t*s*h-t*o*l-r*n*h+r*o*a+i*n*l-i*s*a}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],h=e[8],u=h*s-o*l,c=o*a-h*n,d=l*n-s*a,f=t*u+r*c+i*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=u*p,e[1]=(i*l-h*r)*p,e[2]=(o*r-i*s)*p,e[3]=c*p,e[4]=(h*t-i*a)*p,e[5]=(i*n-o*t)*p,e[6]=d*p,e[7]=(r*a-l*t)*p,e[8]=(s*t-r*n)*p,this}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,o){let a=Math.cos(n),l=Math.sin(n);return this.set(r*a,r*l,-r*(a*s+l*o)+s+e,-i*l,i*a,-i*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(tW.makeScale(e,t)),this}rotate(e){return this.premultiply(tW.makeRotation(-e)),this}translate(e,t){return this.premultiply(tW.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}let tW=new tH;function tq(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function tX(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function t$(){let e=tX("canvas");return e.style.display="block",e}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let tY={};function tZ(e){!(e in tY)&&(tY[e]=!0,console.warn(e))}function tK(e,t,r){return new Promise(function(i,n){setTimeout(function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:n();break;case e.TIMEOUT_EXPIRED:setTimeout(s,r);break;default:i()}},r)})}function tJ(e){let t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}function tQ(e){let t=e.elements;-1===t[11]?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=-t[14]+1)}let t1=new tH().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),t0=new tH().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715),t2=function(){let e={enabled:!0,workingColorSpace:tb,spaces:{},convert:function(e,t,r){return!1!==this.enabled&&t!==r&&t&&r?(this.spaces[t].transfer===tx&&(e.r=t3(e.r),e.g=t3(e.g),e.b=t3(e.b)),this.spaces[t].primaries!==this.spaces[r].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[r].fromXYZ)),this.spaces[r].transfer===tx&&(e.r=t5(e.r),e.g=t5(e.g),e.b=t5(e.b)),e):e},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===tm?ty:this.spaces[e].transfer},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,r){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[r].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],i=[.3127,.329];return e.define({[tb]:{primaries:t,whitePoint:i,transfer:ty,toXYZ:t1,fromXYZ:t0,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:tv},outputColorSpaceConfig:{drawingBufferColorSpace:tv}},[tv]:{primaries:t,whitePoint:i,transfer:tx,toXYZ:t1,fromXYZ:t0,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:tv}}}),e}();function t3(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function t5(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class t6{static getDataURL(e){let t;if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===i&&(i=tX("canvas")),i.width=e.width,i.height=e.height;let r=i.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=i}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){let t=tX("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let e=0;e<n.length;e++)n[e]=255*t3(n[e]/255);return r.putImageData(i,0,0),t}if(!e.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e;{let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*t3(t[e]/255)):t[e]=t3(t[e]);return{data:t,width:e.width,height:e.height}}}}let t4=0;class t9{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:t4++}),this.uuid=tD(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,r=i.length;t<r;t++)i[t].isDataTexture?e.push(t8(i[t].image)):e.push(t8(i[t]))}else e=t8(i);r.url=e}return!t&&(e.images[this.uuid]=r),r}}function t8(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?t6.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let t7=0;class re extends tR{constructor(e=re.DEFAULT_IMAGE,t=re.DEFAULT_MAPPING,r=ef,i=ef,n=eb,s=ex,o=eL,a=e_,l=re.DEFAULT_ANISOTROPY,h=tm){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:t7++}),this.uuid=tD(),this.name="",this.source=new t9(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new tj(0,0),this.repeat=new tj(1,1),this.center=new tj(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new tH,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),!t&&(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ed:e.x=e.x-Math.floor(e.x);break;case ef:e.x=e.x<0?0:1;break;case ep:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ed:e.y=e.y-Math.floor(e.y);break;case ef:e.y=e.y<0?0:1;break;case ep:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}re.DEFAULT_IMAGE=null,re.DEFAULT_MAPPING=300,re.DEFAULT_ANISOTROPY=1;class rt{constructor(e=0,t=0,r=0,i=1){rt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n;let s=e.elements,o=s[0],a=s[4],l=s[8],h=s[1],u=s[5],c=s[9],d=s[2],f=s[6],p=s[10];if(.01>Math.abs(a-h)&&.01>Math.abs(l-d)&&.01>Math.abs(c-f)){if(.1>Math.abs(a+h)&&.1>Math.abs(l+d)&&.1>Math.abs(c+f)&&.1>Math.abs(o+u+p-3))return this.set(1,0,0,0),this;t=Math.PI;let e=(o+1)/2,s=(u+1)/2,g=(p+1)/2,m=(a+h)/4,v=(l+d)/4,b=(c+f)/4;return e>s&&e>g?e<.01?(r=0,i=.707106781,n=.707106781):(i=m/(r=Math.sqrt(e)),n=v/r):s>g?s<.01?(r=.707106781,i=0,n=.707106781):(r=m/(i=Math.sqrt(s)),n=b/i):g<.01?(r=.707106781,i=.707106781,n=0):(r=v/(n=Math.sqrt(g)),i=b/n),this.set(r,i,n,t),this}let g=Math.sqrt((f-c)*(f-c)+(l-d)*(l-d)+(h-a)*(h-a));return .001>Math.abs(g)&&(g=1),this.x=(f-c)/g,this.y=(l-d)/g,this.z=(h-a)/g,this.w=Math.acos((o+u+p-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=tB(this.x,e.x,t.x),this.y=tB(this.y,e.y,t.y),this.z=tB(this.z,e.z,t.z),this.w=tB(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=tB(this.x,e,t),this.y=tB(this.y,e,t),this.z=tB(this.z,e,t),this.w=tB(this.w,e,t),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(tB(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rr extends tR{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new rt(0,0,e,t),this.scissorTest=!1,this.viewport=new rt(0,0,e,t);let i=new re({width:e,height:t,depth:1},(r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:eb,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r)).mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);i.flipY=!1,i.generateMipmaps=r.generateMipmaps,i.internalFormat=r.internalFormat,this.textures=[];let n=r.count;for(let e=0;e<n;e++)this.textures[e]=i.clone(),this.textures[e].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.textures.length;i<n;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++)this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new t9(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ri extends rr{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class rn extends re{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=eg,this.minFilter=eg,this.wrapR=ef,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class rs extends re{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=eg,this.minFilter=eg,this.wrapR=ef,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ro{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,s,o){let a=r[i+0],l=r[i+1],h=r[i+2],u=r[i+3],c=n[s+0],d=n[s+1],f=n[s+2],p=n[s+3];if(0===o){e[t+0]=a,e[t+1]=l,e[t+2]=h,e[t+3]=u;return}if(1===o){e[t+0]=c,e[t+1]=d,e[t+2]=f,e[t+3]=p;return}if(u!==p||a!==c||l!==d||h!==f){let e=1-o,t=a*c+l*d+h*f+u*p,r=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){let n=Math.sqrt(i),s=Math.atan2(n,t*r);e=Math.sin(e*s)/n,o=Math.sin(o*s)/n}let n=o*r;if(a=a*e+c*n,l=l*e+d*n,h=h*e+f*n,u=u*e+p*n,e===1-o){let e=1/Math.sqrt(a*a+l*l+h*h+u*u);a*=e,l*=e,h*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=h,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,s){let o=r[i],a=r[i+1],l=r[i+2],h=r[i+3],u=n[s],c=n[s+1],d=n[s+2],f=n[s+3];return e[t]=o*f+h*u+a*d-l*c,e[t+1]=a*f+h*c+l*u-o*d,e[t+2]=l*f+h*d+o*c-a*u,e[t+3]=h*f-o*u-a*c-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let r=e._x,i=e._y,n=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(r/2),h=o(i/2),u=o(n/2),c=a(r/2),d=a(i/2),f=a(n/2);switch(s){case"XYZ":this._x=c*h*u+l*d*f,this._y=l*d*u-c*h*f,this._z=l*h*f+c*d*u,this._w=l*h*u-c*d*f;break;case"YXZ":this._x=c*h*u+l*d*f,this._y=l*d*u-c*h*f,this._z=l*h*f-c*d*u,this._w=l*h*u+c*d*f;break;case"ZXY":this._x=c*h*u-l*d*f,this._y=l*d*u+c*h*f,this._z=l*h*f+c*d*u,this._w=l*h*u-c*d*f;break;case"ZYX":this._x=c*h*u-l*d*f,this._y=l*d*u+c*h*f,this._z=l*h*f-c*d*u,this._w=l*h*u+c*d*f;break;case"YZX":this._x=c*h*u+l*d*f,this._y=l*d*u+c*h*f,this._z=l*h*f-c*d*u,this._w=l*h*u-c*d*f;break;case"XZY":this._x=c*h*u-l*d*f,this._y=l*d*u-c*h*f,this._z=l*h*f+c*d*u,this._w=l*h*u+c*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],o=t[5],a=t[9],l=t[2],h=t[6],u=t[10],c=r+o+u;if(c>0){let e=.5/Math.sqrt(c+1);this._w=.25/e,this._x=(h-a)*e,this._y=(n-l)*e,this._z=(s-i)*e}else if(r>o&&r>u){let e=2*Math.sqrt(1+r-o-u);this._w=(h-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(n+l)/e}else if(o>u){let e=2*Math.sqrt(1+o-r-u);this._w=(n-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+h)/e}else{let e=2*Math.sqrt(1+u-r-o);this._w=(s-i)/e,this._x=(n+l)/e,this._y=(a+h)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y),this._w=r):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(tB(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(0===r)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,s=e._w,o=t._x,a=t._y,l=t._z,h=t._w;return this._x=r*h+s*o+i*l-n*a,this._y=i*h+s*a+n*o-r*l,this._z=n*h+s*l+r*a-i*o,this._w=s*h-r*o-i*a-n*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let r=this._x,i=this._y,n=this._z,s=this._w,o=s*e._w+r*e._x+i*e._y+n*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;let a=1-o*o;if(a<=Number.EPSILON){let e=1-t;return this._w=e*s+t*this._w,this._x=e*r+t*this._x,this._y=e*i+t*this._y,this._z=e*n+t*this._z,this.normalize(),this}let l=Math.sqrt(a),h=Math.atan2(l,o),u=Math.sin((1-t)*h)/l,c=Math.sin(t*h)/l;return this._w=s*u+this._w*c,this._x=r*u+this._x*c,this._y=i*u+this._y*c,this._z=n*u+this._z*c,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),n=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),n*Math.sin(t),n*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ra{constructor(e=0,t=0,r=0){ra.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(rh.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(rh.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,o=e.z,a=e.w,l=2*(s*i-o*r),h=2*(o*t-n*i),u=2*(n*r-s*t);return this.x=t+a*l+s*u-o*h,this.y=r+a*h+o*l-n*u,this.z=i+a*u+n*h-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=tB(this.x,e.x,t.x),this.y=tB(this.y,e.y,t.y),this.z=tB(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=tB(this.x,e,t),this.y=tB(this.y,e,t),this.z=tB(this.z,e,t),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(tB(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-n*o,this.y=n*s-r*a,this.z=r*o-i*s,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return rl.copy(this).projectOnVector(e),this.sub(rl)}reflect(e){return this.sub(rl.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:Math.acos(tB(this.dot(e)/t,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=2*Math.random()-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}let rl=new ra,rh=new ro;class ru{constructor(e=new ra(Infinity,Infinity,Infinity),t=new ra(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(rd.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(rd.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=rd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(void 0!==r){let i=r.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,r=i.count;t<r;t++)!0===e.isMesh?e.getVertexPosition(t,rd):rd.fromBufferAttribute(i,t),rd.applyMatrix4(e.matrixWorld),this.expandByPoint(rd);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),rf.copy(e.boundingBox)):(null===r.boundingBox&&r.computeBoundingBox(),rf.copy(r.boundingBox)),rf.applyMatrix4(e.matrixWorld),this.union(rf)}let i=e.children;for(let e=0,r=i.length;e<r;e++)this.expandByObject(i[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,rd),rd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(rx),r_.subVectors(this.max,rx),rp.subVectors(e.a,rx),rg.subVectors(e.b,rx),rm.subVectors(e.c,rx),rv.subVectors(rg,rp),rb.subVectors(rm,rg),ry.subVectors(rp,rm);let t=[0,-rv.z,rv.y,0,-rb.z,rb.y,0,-ry.z,ry.y,rv.z,0,-rv.x,rb.z,0,-rb.x,ry.z,0,-ry.x,-rv.y,rv.x,0,-rb.y,rb.x,0,-ry.y,ry.x,0];return!!(rT(t,rp,rg,rm,r_)&&rT(t=[1,0,0,0,1,0,0,0,1],rp,rg,rm,r_))&&(rS.crossVectors(rv,rb),rT(t=[rS.x,rS.y,rS.z],rp,rg,rm,r_))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,rd).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(rd).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(rc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),rc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),rc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),rc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),rc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),rc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),rc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),rc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(rc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}let rc=[new ra,new ra,new ra,new ra,new ra,new ra,new ra,new ra],rd=new ra,rf=new ru,rp=new ra,rg=new ra,rm=new ra,rv=new ra,rb=new ra,ry=new ra,rx=new ra,r_=new ra,rS=new ra,rw=new ra;function rT(e,t,r,i,n){for(let s=0,o=e.length-3;s<=o;s+=3){rw.fromArray(e,s);let o=n.x*Math.abs(rw.x)+n.y*Math.abs(rw.y)+n.z*Math.abs(rw.z),a=t.dot(rw),l=r.dot(rw),h=i.dot(rw);if(Math.max(-Math.max(a,l,h),Math.min(a,l,h))>o)return!1}return!0}let rP=new ru,rE=new ra,rC=new ra;class rA{constructor(e=new ra,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;void 0!==t?r.copy(t):rP.setFromPoints(e).getCenter(r);let i=0;for(let t=0,n=e.length;t<n;t++)i=Math.max(i,r.distanceToSquared(e[t]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;rE.subVectors(e,this.center);let t=rE.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),r=(e-this.radius)*.5;this.center.addScaledVector(rE,r/e),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(rC.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(rE.copy(e.center).add(rC)),this.expandByPoint(rE.copy(e.center).sub(rC))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}let rI=new ra,rM=new ra,rR=new ra,rO=new ra,rk=new ra,rN=new ra,rL=new ra;class rD{constructor(e=new ra,t=new ra(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,rI)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=rI.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(rI.copy(this.origin).addScaledVector(this.direction,t),rI.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){let n,s,o,a;rM.copy(e).add(t).multiplyScalar(.5),rR.copy(t).sub(e).normalize(),rO.copy(this.origin).sub(rM);let l=.5*e.distanceTo(t),h=-this.direction.dot(rR),u=rO.dot(this.direction),c=-rO.dot(rR),d=rO.lengthSq(),f=Math.abs(1-h*h);if(f>0){if(n=h*c-u,s=h*u-c,a=l*f,n>=0){if(s>=-a){if(s<=a){let e=1/f;n*=e,s*=e,o=n*(n+h*s+2*u)+s*(h*n+s+2*c)+d}else o=-(n=Math.max(0,-(h*(s=l)+u)))*n+s*(s+2*c)+d}else o=-(n=Math.max(0,-(h*(s=-l)+u)))*n+s*(s+2*c)+d}else s<=-a?(s=(n=Math.max(0,-(-h*l+u)))>0?-l:Math.min(Math.max(-l,-c),l),o=-n*n+s*(s+2*c)+d):s<=a?(n=0,o=(s=Math.min(Math.max(-l,-c),l))*(s+2*c)+d):(s=(n=Math.max(0,-(h*l+u)))>0?l:Math.min(Math.max(-l,-c),l),o=-n*n+s*(s+2*c)+d)}else s=h>0?-l:l,o=-(n=Math.max(0,-(h*s+u)))*n+s*(s+2*c)+d;return r&&r.copy(this.origin).addScaledVector(this.direction,n),i&&i.copy(rM).addScaledVector(rR,s),o}intersectSphere(e,t){rI.subVectors(e.center,this.origin);let r=rI.dot(this.direction),i=rI.dot(rI)-r*r,n=e.radius*e.radius;if(i>n)return null;let s=Math.sqrt(n-i),o=r-s,a=r+s;return a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return!!(0===t||e.normal.dot(this.direction)*t<0)||!1}intersectBox(e,t){let r,i,n,s,o,a;let l=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,c=this.origin;return(l>=0?(r=(e.min.x-c.x)*l,i=(e.max.x-c.x)*l):(r=(e.max.x-c.x)*l,i=(e.min.x-c.x)*l),h>=0?(n=(e.min.y-c.y)*h,s=(e.max.y-c.y)*h):(n=(e.max.y-c.y)*h,s=(e.min.y-c.y)*h),r>s||n>i)?null:((n>r||isNaN(r))&&(r=n),(s<i||isNaN(i))&&(i=s),u>=0?(o=(e.min.z-c.z)*u,a=(e.max.z-c.z)*u):(o=(e.max.z-c.z)*u,a=(e.min.z-c.z)*u),r>a||o>i)?null:((o>r||r!=r)&&(r=o),(a<i||i!=i)&&(i=a),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return null!==this.intersectBox(e,rI)}intersectTriangle(e,t,r,i,n){let s;rk.subVectors(t,e),rN.subVectors(r,e),rL.crossVectors(rk,rN);let o=this.direction.dot(rL);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}rO.subVectors(this.origin,e);let a=s*this.direction.dot(rN.crossVectors(rO,rN));if(a<0)return null;let l=s*this.direction.dot(rk.cross(rO));if(l<0||a+l>o)return null;let h=-s*rO.dot(rL);return h<0?null:this.at(h/o,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class rB{constructor(e,t,r,i,n,s,o,a,l,h,u,c,d,f,p,g){rB.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,i,n,s,o,a,l,h,u,c,d,f,p,g)}set(e,t,r,i,n,s,o,a,l,h,u,c,d,f,p,g){let m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=i,m[1]=n,m[5]=s,m[9]=o,m[13]=a,m[2]=l,m[6]=h,m[10]=u,m[14]=c,m[3]=d,m[7]=f,m[11]=p,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new rB().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,i=1/rF.setFromMatrixColumn(e,0).length(),n=1/rF.setFromMatrixColumn(e,1).length(),s=1/rF.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,i=e.y,n=e.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(i),l=Math.sin(i),h=Math.cos(n),u=Math.sin(n);if("XYZ"===e.order){let e=s*h,r=s*u,i=o*h,n=o*u;t[0]=a*h,t[4]=-a*u,t[8]=l,t[1]=r+i*l,t[5]=e-n*l,t[9]=-o*a,t[2]=n-e*l,t[6]=i+r*l,t[10]=s*a}else if("YXZ"===e.order){let e=a*h,r=a*u,i=l*h,n=l*u;t[0]=e+n*o,t[4]=i*o-r,t[8]=s*l,t[1]=s*u,t[5]=s*h,t[9]=-o,t[2]=r*o-i,t[6]=n+e*o,t[10]=s*a}else if("ZXY"===e.order){let e=a*h,r=a*u,i=l*h,n=l*u;t[0]=e-n*o,t[4]=-s*u,t[8]=i+r*o,t[1]=r+i*o,t[5]=s*h,t[9]=n-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){let e=s*h,r=s*u,i=o*h,n=o*u;t[0]=a*h,t[4]=i*l-r,t[8]=e*l+n,t[1]=a*u,t[5]=n*l+e,t[9]=r*l-i,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){let e=s*a,r=s*l,i=o*a,n=o*l;t[0]=a*h,t[4]=n-e*u,t[8]=i*u+r,t[1]=u,t[5]=s*h,t[9]=-o*h,t[2]=-l*h,t[6]=r*u+i,t[10]=e-n*u}else if("XZY"===e.order){let e=s*a,r=s*l,i=o*a,n=o*l;t[0]=a*h,t[4]=-u,t[8]=l*h,t[1]=e*u+n,t[5]=s*h,t[9]=r*u-i,t[2]=i*u-r,t[6]=o*h,t[10]=n*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rG,e,rU)}lookAt(e,t,r){let i=this.elements;return rH.subVectors(e,t),0===rH.lengthSq()&&(rH.z=1),rH.normalize(),rz.crossVectors(r,rH),0===rz.lengthSq()&&(1===Math.abs(r.z)?rH.x+=1e-4:rH.z+=1e-4,rH.normalize(),rz.crossVectors(r,rH)),rz.normalize(),rj.crossVectors(rH,rz),i[0]=rz.x,i[4]=rj.x,i[8]=rH.x,i[1]=rz.y,i[5]=rj.y,i[9]=rH.y,i[2]=rz.z,i[6]=rj.z,i[10]=rH.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],o=r[4],a=r[8],l=r[12],h=r[1],u=r[5],c=r[9],d=r[13],f=r[2],p=r[6],g=r[10],m=r[14],v=r[3],b=r[7],y=r[11],x=r[15],_=i[0],S=i[4],w=i[8],T=i[12],P=i[1],E=i[5],C=i[9],A=i[13],I=i[2],M=i[6],R=i[10],O=i[14],k=i[3],N=i[7],L=i[11],D=i[15];return n[0]=s*_+o*P+a*I+l*k,n[4]=s*S+o*E+a*M+l*N,n[8]=s*w+o*C+a*R+l*L,n[12]=s*T+o*A+a*O+l*D,n[1]=h*_+u*P+c*I+d*k,n[5]=h*S+u*E+c*M+d*N,n[9]=h*w+u*C+c*R+d*L,n[13]=h*T+u*A+c*O+d*D,n[2]=f*_+p*P+g*I+m*k,n[6]=f*S+p*E+g*M+m*N,n[10]=f*w+p*C+g*R+m*L,n[14]=f*T+p*A+g*O+m*D,n[3]=v*_+b*P+y*I+x*k,n[7]=v*S+b*E+y*M+x*N,n[11]=v*w+b*C+y*R+x*L,n[15]=v*T+b*A+y*O+x*D,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],s=e[1],o=e[5],a=e[9],l=e[13],h=e[2],u=e[6],c=e[10],d=e[14],f=e[3],p=e[7],g=e[11];return f*(+n*a*u-i*l*u-n*o*c+r*l*c+i*o*d-r*a*d)+p*(+t*a*d-t*l*c+n*s*c-i*s*d+i*l*h-n*a*h)+g*(+t*l*u-t*o*d-n*s*u+r*s*d+n*o*h-r*l*h)+e[15]*(-i*o*h-t*a*u+t*o*c+i*s*u-r*s*c+r*a*h)}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,r){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],h=e[8],u=e[9],c=e[10],d=e[11],f=e[12],p=e[13],g=e[14],m=e[15],v=u*g*l-p*c*l+p*a*d-o*g*d-u*a*m+o*c*m,b=f*c*l-h*g*l-f*a*d+s*g*d+h*a*m-s*c*m,y=h*p*l-f*u*l+f*o*d-s*p*d-h*o*m+s*u*m,x=f*u*a-h*p*a-f*o*c+s*p*c+h*o*g-s*u*g,_=t*v+r*b+i*y+n*x;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/_;return e[0]=v*S,e[1]=(p*c*n-u*g*n-p*i*d+r*g*d+u*i*m-r*c*m)*S,e[2]=(o*g*n-p*a*n+p*i*l-r*g*l-o*i*m+r*a*m)*S,e[3]=(u*a*n-o*c*n-u*i*l+r*c*l+o*i*d-r*a*d)*S,e[4]=b*S,e[5]=(h*g*n-f*c*n+f*i*d-t*g*d-h*i*m+t*c*m)*S,e[6]=(f*a*n-s*g*n-f*i*l+t*g*l+s*i*m-t*a*m)*S,e[7]=(s*c*n-h*a*n+h*i*l-t*c*l-s*i*d+t*a*d)*S,e[8]=y*S,e[9]=(f*u*n-h*p*n-f*r*d+t*p*d+h*r*m-t*u*m)*S,e[10]=(s*p*n-f*o*n+f*r*l-t*p*l-s*r*m+t*o*m)*S,e[11]=(h*o*n-s*u*n-h*r*l+t*u*l+s*r*d-t*o*d)*S,e[12]=x*S,e[13]=(h*p*i-f*u*i+f*r*c-t*p*c-h*r*g+t*u*g)*S,e[14]=(f*o*i-s*p*i-f*r*a+t*p*a+s*r*g-t*o*g)*S,e[15]=(s*u*i-h*o*i+h*r*a-t*u*a-s*r*c+t*o*c)*S,this}scale(e){let t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6];return Math.sqrt(Math.max(t,r,e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),i=Math.sin(t),n=1-r,s=e.x,o=e.y,a=e.z,l=n*s,h=n*o;return this.set(l*s+r,l*o-i*a,l*a+i*o,0,l*o+i*a,h*o+r,h*a-i*s,0,l*a-i*o,h*a+i*s,n*a*a+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,s){return this.set(1,r,n,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){let i=this.elements,n=t._x,s=t._y,o=t._z,a=t._w,l=n+n,h=s+s,u=o+o,c=n*l,d=n*h,f=n*u,p=s*h,g=s*u,m=o*u,v=a*l,b=a*h,y=a*u,x=r.x,_=r.y,S=r.z;return i[0]=(1-(p+m))*x,i[1]=(d+y)*x,i[2]=(f-b)*x,i[3]=0,i[4]=(d-y)*_,i[5]=(1-(c+m))*_,i[6]=(g+v)*_,i[7]=0,i[8]=(f+b)*S,i[9]=(g-v)*S,i[10]=(1-(c+p))*S,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){let i=this.elements,n=rF.set(i[0],i[1],i[2]).length(),s=rF.set(i[4],i[5],i[6]).length(),o=rF.set(i[8],i[9],i[10]).length();0>this.determinant()&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],rV.copy(this);let a=1/n,l=1/s,h=1/o;return rV.elements[0]*=a,rV.elements[1]*=a,rV.elements[2]*=a,rV.elements[4]*=l,rV.elements[5]*=l,rV.elements[6]*=l,rV.elements[8]*=h,rV.elements[9]*=h,rV.elements[10]*=h,t.setFromRotationMatrix(rV),r.x=n,r.y=s,r.z=o,this}makePerspective(e,t,r,i,n,s,o=tM){let a,l;let h=this.elements;if(o===tM)a=-(s+n)/(s-n),l=-2*s*n/(s-n);else if(2001===o)a=-s/(s-n),l=-s*n/(s-n);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return h[0]=2*n/(t-e),h[4]=0,h[8]=(t+e)/(t-e),h[12]=0,h[1]=0,h[5]=2*n/(r-i),h[9]=(r+i)/(r-i),h[13]=0,h[2]=0,h[6]=0,h[10]=a,h[14]=l,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,r,i,n,s,o=tM){let a,l;let h=this.elements,u=1/(t-e),c=1/(r-i),d=1/(s-n);if(o===tM)a=(s+n)*d,l=-2*d;else if(2001===o)a=n*d,l=-1*d;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return h[0]=2*u,h[4]=0,h[8]=0,h[12]=-((t+e)*u),h[1]=0,h[5]=2*c,h[9]=0,h[13]=-((r+i)*c),h[2]=0,h[6]=0,h[10]=l,h[14]=-a,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}let rF=new ra,rV=new rB,rG=new ra(0,0,0),rU=new ra(1,1,1),rz=new ra,rj=new ra,rH=new ra,rW=new rB,rq=new ro;class rX{constructor(e=0,t=0,r=0,i=rX.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],s=i[4],o=i[8],a=i[1],l=i[5],h=i[9],u=i[2],c=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(tB(o,-1,1)),.9999999>Math.abs(o)?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(c,l),this._z=0);break;case"YXZ":this._x=Math.asin(-tB(h,-1,1)),.9999999>Math.abs(h)?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(tB(c,-1,1)),.9999999>Math.abs(c)?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,n));break;case"ZYX":this._y=Math.asin(-tB(u,-1,1)),.9999999>Math.abs(u)?(this._x=Math.atan2(c,d),this._z=Math.atan2(a,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(tB(a,-1,1)),.9999999>Math.abs(a)?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-tB(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(c,l),this._y=Math.atan2(o,n)):(this._x=Math.atan2(-h,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return rW.makeRotationFromQuaternion(e),this.setFromRotationMatrix(rW,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return rq.setFromEuler(this),this.setFromQuaternion(rq,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}rX.DEFAULT_ORDER="XYZ";class r${constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}}let rY=0,rZ=new ra,rK=new ro,rJ=new rB,rQ=new ra,r1=new ra,r0=new ra,r2=new ro,r3=new ra(1,0,0),r5=new ra(0,1,0),r6=new ra(0,0,1),r4={type:"added"},r9={type:"removed"},r8={type:"childadded",child:null},r7={type:"childremoved",child:null};class ie extends tR{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:rY++}),this.uuid=tD(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ie.DEFAULT_UP.clone();let e=new ra,t=new rX,r=new ro,i=new ra(1,1,1);t._onChange(function(){r.setFromEuler(t,!1)}),r._onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new rB},normalMatrix:{value:new tH}}),this.matrix=new rB,this.matrixWorld=new rB,this.matrixAutoUpdate=ie.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ie.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new r$,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return rK.setFromAxisAngle(e,t),this.quaternion.multiply(rK),this}rotateOnWorldAxis(e,t){return rK.setFromAxisAngle(e,t),this.quaternion.premultiply(rK),this}rotateX(e){return this.rotateOnAxis(r3,e)}rotateY(e){return this.rotateOnAxis(r5,e)}rotateZ(e){return this.rotateOnAxis(r6,e)}translateOnAxis(e,t){return rZ.copy(e).applyQuaternion(this.quaternion),this.position.add(rZ.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(r3,e)}translateY(e){return this.translateOnAxis(r5,e)}translateZ(e){return this.translateOnAxis(r6,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(rJ.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?rQ.copy(e):rQ.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),r1.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?rJ.lookAt(r1,rQ,this.up):rJ.lookAt(rQ,r1,this.up),this.quaternion.setFromRotationMatrix(rJ),i&&(rJ.extractRotation(i.matrixWorld),rK.setFromRotationMatrix(rJ),this.quaternion.premultiply(rK.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(r4),r8.child=e,this.dispatchEvent(r8),r8.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return -1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(r9),r7.child=e,this.dispatchEvent(r7),r7.child=null),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),rJ.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),rJ.multiply(e.parent.matrixWorld)),e.applyMatrix4(rJ),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(r4),r8.child=e,this.dispatchEvent(r8),r8.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);let i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(r1,e,r0),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(r1,r2,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){let r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){let e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){let t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let i={};function n(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let r=t.shapes;if(Array.isArray(r))for(let t=0,i=r.length;t<i;t++){let i=r[t];n(e.shapes,i)}else n(e.shapes,r)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material){if(Array.isArray(this.material)){let t=[];for(let r=0,i=this.material.length;r<i;r++)t.push(n(e.materials,this.material[r]));i.material=t}else i.material=n(e.materials,this.material)}if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){let r=this.animations[t];i.animations.push(n(e.animations,r))}}if(t){let t=s(e.geometries),i=s(e.materials),n=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),h=s(e.animations),u=s(e.nodes);t.length>0&&(r.geometries=t),i.length>0&&(r.materials=i),n.length>0&&(r.textures=n),o.length>0&&(r.images=o),a.length>0&&(r.shapes=a),l.length>0&&(r.skeletons=l),h.length>0&&(r.animations=h),u.length>0&&(r.nodes=u)}return r.object=i,r;function s(e){let t=[];for(let r in e){let i=e[r];delete i.metadata,t.push(i)}return t}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){let r=e.children[t];this.add(r.clone())}return this}}ie.DEFAULT_UP=new ra(0,1,0),ie.DEFAULT_MATRIX_AUTO_UPDATE=!0,ie.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let it=new ra,ir=new ra,ii=new ra,is=new ra,io=new ra,ia=new ra,il=new ra,ih=new ra,iu=new ra,ic=new ra,id=new rt,ip=new rt,ig=new rt;class im{constructor(e=new ra,t=new ra,r=new ra){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),it.subVectors(e,t),i.cross(it);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){it.subVectors(i,t),ir.subVectors(r,t),ii.subVectors(e,t);let s=it.dot(it),o=it.dot(ir),a=it.dot(ii),l=ir.dot(ir),h=ir.dot(ii),u=s*l-o*o;if(0===u)return n.set(0,0,0),null;let c=1/u,d=(l*a-o*h)*c,f=(s*h-o*a)*c;return n.set(1-d-f,f,d)}static containsPoint(e,t,r,i){return null!==this.getBarycoord(e,t,r,i,is)&&is.x>=0&&is.y>=0&&is.x+is.y<=1}static getInterpolation(e,t,r,i,n,s,o,a){return null===this.getBarycoord(e,t,r,i,is)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(n,is.x),a.addScaledVector(s,is.y),a.addScaledVector(o,is.z),a)}static getInterpolatedAttribute(e,t,r,i,n,s){return id.setScalar(0),ip.setScalar(0),ig.setScalar(0),id.fromBufferAttribute(e,t),ip.fromBufferAttribute(e,r),ig.fromBufferAttribute(e,i),s.setScalar(0),s.addScaledVector(id,n.x),s.addScaledVector(ip,n.y),s.addScaledVector(ig,n.z),s}static isFrontFacing(e,t,r,i){return it.subVectors(r,t),ir.subVectors(e,t),0>it.cross(ir).dot(i)}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return it.subVectors(this.c,this.b),ir.subVectors(this.a,this.b),.5*it.cross(ir).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return im.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return im.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,n){return im.getInterpolation(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return im.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return im.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r,i;let n=this.a,s=this.b,o=this.c;io.subVectors(s,n),ia.subVectors(o,n),ih.subVectors(e,n);let a=io.dot(ih),l=ia.dot(ih);if(a<=0&&l<=0)return t.copy(n);iu.subVectors(e,s);let h=io.dot(iu),u=ia.dot(iu);if(h>=0&&u<=h)return t.copy(s);let c=a*u-h*l;if(c<=0&&a>=0&&h<=0)return r=a/(a-h),t.copy(n).addScaledVector(io,r);ic.subVectors(e,o);let d=io.dot(ic),f=ia.dot(ic);if(f>=0&&d<=f)return t.copy(o);let p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return i=l/(l-f),t.copy(n).addScaledVector(ia,i);let g=h*f-d*u;if(g<=0&&u-h>=0&&d-f>=0)return il.subVectors(o,s),i=(u-h)/(u-h+(d-f)),t.copy(s).addScaledVector(il,i);let m=1/(g+p+c);return r=p*m,i=c*m,t.copy(n).addScaledVector(io,r).addScaledVector(ia,i)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let iv={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32},ib={h:0,s:0,l:0},iy={h:0,s:0,l:0};function ix(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*6*(2/3-r):e}class i_{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){return void 0===t&&void 0===r?e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e):this.setRGB(e,t,r),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=tv){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,t2.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=t2.workingColorSpace){return this.r=e,this.g=t,this.b=r,t2.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=t2.workingColorSpace){if(e=tF(e,1),t=tB(t,0,1),r=tB(r,0,1),0===t)this.r=this.g=this.b=r;else{let i=r<=.5?r*(1+t):r+t-r*t,n=2*r-i;this.r=ix(n,i,e+1/3),this.g=ix(n,i,e),this.b=ix(n,i,e-1/3)}return t2.toWorkingColorSpace(this,i),this}setStyle(e,t=tv){let r;function i(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let n;let s=r[1],o=r[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(n[4]),this.setRGB(Math.min(255,parseInt(n[1],10))/255,Math.min(255,parseInt(n[2],10))/255,Math.min(255,parseInt(n[3],10))/255,t);if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(n[4]),this.setRGB(Math.min(100,parseInt(n[1],10))/100,Math.min(100,parseInt(n[2],10))/100,Math.min(100,parseInt(n[3],10))/100,t);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(n[4]),this.setHSL(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let i=r[1],n=i.length;if(3===n)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(6===n)return this.setHex(parseInt(i,16),t);else console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=tv){let r=iv[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=t3(e.r),this.g=t3(e.g),this.b=t3(e.b),this}copyLinearToSRGB(e){return this.r=t5(e.r),this.g=t5(e.g),this.b=t5(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=tv){return t2.fromWorkingColorSpace(iS.copy(this),e),65536*Math.round(tB(255*iS.r,0,255))+256*Math.round(tB(255*iS.g,0,255))+Math.round(tB(255*iS.b,0,255))}getHexString(e=tv){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=t2.workingColorSpace){let r,i;t2.fromWorkingColorSpace(iS.copy(this),t);let n=iS.r,s=iS.g,o=iS.b,a=Math.max(n,s,o),l=Math.min(n,s,o),h=(l+a)/2;if(l===a)r=0,i=0;else{let e=a-l;switch(i=h<=.5?e/(a+l):e/(2-a-l),a){case n:r=(s-o)/e+(s<o?6:0);break;case s:r=(o-n)/e+2;break;case o:r=(n-s)/e+4}r/=6}return e.h=r,e.s=i,e.l=h,e}getRGB(e,t=t2.workingColorSpace){return t2.fromWorkingColorSpace(iS.copy(this),t),e.r=iS.r,e.g=iS.g,e.b=iS.b,e}getStyle(e=tv){t2.fromWorkingColorSpace(iS.copy(this),e);let t=iS.r,r=iS.g,i=iS.b;return e!==tv?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*r)},${Math.round(255*i)})`}offsetHSL(e,t,r){return this.getHSL(ib),this.setHSL(ib.h+e,ib.s+t,ib.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(ib),e.getHSL(iy);let r=tV(ib.h,iy.h,t),i=tV(ib.s,iy.s,t),n=tV(ib.l,iy.l,t);return this.setHSL(r,i,n),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,r=this.g,i=this.b,n=e.elements;return this.r=n[0]*t+n[3]*r+n[6]*i,this.g=n[1]*t+n[4]*r+n[7]*i,this.b=n[2]*t+n[5]*r+n[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let iS=new i_;i_.NAMES=iv;let iw=0;class iT extends tR{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:iw++}),this.uuid=tD(),this.name="",this.type="Material",this.blending=v,this.side=f,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=R,this.blendDst=O,this.blendEquation=S,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new i_(0,0,0),this.blendAlpha=0,this.depthFunc=W,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let r=e[t];if(void 0===r){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let i=this[t];if(void 0===i){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(e){let t=[];for(let r in e){let i=e[r];delete i.metadata,t.push(i)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(r.dispersion=this.dispersion),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapRotation&&(r.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==v&&(r.blending=this.blending),this.side!==f&&(r.side=this.side),!0===this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=!0),this.blendSrc!==R&&(r.blendSrc=this.blendSrc),this.blendDst!==O&&(r.blendDst=this.blendDst),this.blendEquation!==S&&(r.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(r.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(r.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==W&&(r.depthFunc=this.depthFunc),!1===this.depthTest&&(r.depthTest=this.depthTest),!1===this.depthWrite&&(r.depthWrite=this.depthWrite),!1===this.colorWrite&&(r.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(r.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(r.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(r.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(r.stencilFuncMask=this.stencilFuncMask),7680!==this.stencilFail&&(r.stencilFail=this.stencilFail),7680!==this.stencilZFail&&(r.stencilZFail=this.stencilZFail),7680!==this.stencilZPass&&(r.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(r.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=!0),!0===this.alphaToCoverage&&(r.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=!0),!0===this.forceSinglePass&&(r.forceSinglePass=!0),!0===this.wireframe&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){let t=i(e.textures),n=i(e.images);t.length>0&&(r.textures=t),n.length>0&&(r.images=n)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(null!==t){let e=t.length;r=Array(e);for(let i=0;i!==e;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class iP extends iT{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new i_(0xffffff),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new rX,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}let iE=new ra,iC=new tj;class iA{constructor(e,t,r=!1){if(Array.isArray(e))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=35044,this.updateRanges=[],this.gpuType=eC,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)iC.fromBufferAttribute(this,t),iC.applyMatrix3(e),this.setXY(t,iC.x,iC.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)iE.fromBufferAttribute(this,t),iE.applyMatrix3(e),this.setXYZ(t,iE.x,iE.y,iE.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)iE.fromBufferAttribute(this,t),iE.applyMatrix4(e),this.setXYZ(t,iE.x,iE.y,iE.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)iE.fromBufferAttribute(this,t),iE.applyNormalMatrix(e),this.setXYZ(t,iE.x,iE.y,iE.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)iE.fromBufferAttribute(this,t),iE.transformDirection(e),this.setXYZ(t,iE.x,iE.y,iE.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=tG(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=tU(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=tG(t,this.array)),t}setX(e,t){return this.normalized&&(t=tU(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=tG(t,this.array)),t}setY(e,t){return this.normalized&&(t=tU(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=tG(t,this.array)),t}setZ(e,t){return this.normalized&&(t=tU(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=tG(t,this.array)),t}setW(e,t){return this.normalized&&(t=tU(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=tU(t,this.array),r=tU(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=tU(t,this.array),r=tU(r,this.array),i=tU(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=tU(t,this.array),r=tU(r,this.array),i=tU(i,this.array),n=tU(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class iI extends iA{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class iM extends iA{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class iR extends iA{constructor(e,t,r){super(new Float32Array(e),t,r)}}let iO=0,ik=new rB,iN=new ie,iL=new ra,iD=new ru,iB=new ru,iF=new ra;class iV extends tR{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:iO++}),this.uuid=tD(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(tq(e)?iM:iI)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(void 0!==r){let t=new tH().getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}let i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ik.makeRotationFromQuaternion(e),this.applyMatrix4(ik),this}rotateX(e){return ik.makeRotationX(e),this.applyMatrix4(ik),this}rotateY(e){return ik.makeRotationY(e),this.applyMatrix4(ik),this}rotateZ(e){return ik.makeRotationZ(e),this.applyMatrix4(ik),this}translate(e,t,r){return ik.makeTranslation(e,t,r),this.applyMatrix4(ik),this}scale(e,t,r){return ik.makeScale(e,t,r),this.applyMatrix4(ik),this}lookAt(e){return iN.lookAt(e),iN.updateMatrix(),this.applyMatrix4(iN.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(iL).negate(),this.translate(iL.x,iL.y,iL.z),this}setFromPoints(e){let t=this.getAttribute("position");if(void 0===t){let t=[];for(let r=0,i=e.length;r<i;r++){let i=e[r];t.push(i.x,i.y,i.z||0)}this.setAttribute("position",new iR(t,3))}else{let r=Math.min(e.length,t.count);for(let i=0;i<r;i++){let r=e[i];t.setXYZ(i,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ru);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ra(-1/0,-1/0,-1/0),new ra(Infinity,Infinity,Infinity));return}if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];iD.setFromBufferAttribute(r),this.morphTargetsRelative?(iF.addVectors(this.boundingBox.min,iD.min),this.boundingBox.expandByPoint(iF),iF.addVectors(this.boundingBox.max,iD.max),this.boundingBox.expandByPoint(iF)):(this.boundingBox.expandByPoint(iD.min),this.boundingBox.expandByPoint(iD.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new rA);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ra,1/0);return}if(e){let r=this.boundingSphere.center;if(iD.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];iB.setFromBufferAttribute(r),this.morphTargetsRelative?(iF.addVectors(iD.min,iB.min),iD.expandByPoint(iF),iF.addVectors(iD.max,iB.max),iD.expandByPoint(iF)):(iD.expandByPoint(iB.min),iD.expandByPoint(iB.max))}iD.getCenter(r);let i=0;for(let t=0,n=e.count;t<n;t++)iF.fromBufferAttribute(e,t),i=Math.max(i,r.distanceToSquared(iF));if(t)for(let n=0,s=t.length;n<s;n++){let s=t[n],o=this.morphTargetsRelative;for(let t=0,n=s.count;t<n;t++)iF.fromBufferAttribute(s,t),o&&(iL.fromBufferAttribute(e,t),iF.add(iL)),i=Math.max(i,r.distanceToSquared(iF))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=t.position,i=t.normal,n=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new iA(new Float32Array(4*r.count),4));let s=this.getAttribute("tangent"),o=[],a=[];for(let e=0;e<r.count;e++)o[e]=new ra,a[e]=new ra;let l=new ra,h=new ra,u=new ra,c=new tj,d=new tj,f=new tj,p=new ra,g=new ra,m=this.groups;0===m.length&&(m=[{start:0,count:e.count}]);for(let t=0,i=m.length;t<i;++t){let i=m[t],s=i.start,v=i.count;for(let t=s,i=s+v;t<i;t+=3)!function(e,t,i){l.fromBufferAttribute(r,e),h.fromBufferAttribute(r,t),u.fromBufferAttribute(r,i),c.fromBufferAttribute(n,e),d.fromBufferAttribute(n,t),f.fromBufferAttribute(n,i),h.sub(l),u.sub(l),d.sub(c),f.sub(c);let s=1/(d.x*f.y-f.x*d.y);isFinite(s)&&(p.copy(h).multiplyScalar(f.y).addScaledVector(u,-d.y).multiplyScalar(s),g.copy(u).multiplyScalar(d.x).addScaledVector(h,-f.x).multiplyScalar(s),o[e].add(p),o[t].add(p),o[i].add(p),a[e].add(g),a[t].add(g),a[i].add(g))}(e.getX(t+0),e.getX(t+1),e.getX(t+2))}let v=new ra,b=new ra,y=new ra,x=new ra;function _(e){y.fromBufferAttribute(i,e),x.copy(y);let t=o[e];v.copy(t),v.sub(y.multiplyScalar(y.dot(t))).normalize(),b.crossVectors(x,t);let r=b.dot(a[e]);s.setXYZW(e,v.x,v.y,v.z,r<0?-1:1)}for(let t=0,r=m.length;t<r;++t){let r=m[t],i=r.start,n=r.count;for(let t=i,r=i+n;t<r;t+=3)_(e.getX(t+0)),_(e.getX(t+1)),_(e.getX(t+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new iA(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);let i=new ra,n=new ra,s=new ra,o=new ra,a=new ra,l=new ra,h=new ra,u=new ra;if(e)for(let c=0,d=e.count;c<d;c+=3){let d=e.getX(c+0),f=e.getX(c+1),p=e.getX(c+2);i.fromBufferAttribute(t,d),n.fromBufferAttribute(t,f),s.fromBufferAttribute(t,p),h.subVectors(s,n),u.subVectors(i,n),h.cross(u),o.fromBufferAttribute(r,d),a.fromBufferAttribute(r,f),l.fromBufferAttribute(r,p),o.add(h),a.add(h),l.add(h),r.setXYZ(d,o.x,o.y,o.z),r.setXYZ(f,a.x,a.y,a.z),r.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)i.fromBufferAttribute(t,e+0),n.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),h.subVectors(s,n),u.subVectors(i,n),h.cross(u),r.setXYZ(e+0,h.x,h.y,h.z),r.setXYZ(e+1,h.x,h.y,h.z),r.setXYZ(e+2,h.x,h.y,h.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)iF.fromBufferAttribute(e,t),iF.normalize(),e.setXYZ(t,iF.x,iF.y,iF.z)}toNonIndexed(){function e(e,t){let r=e.array,i=e.itemSize,n=e.normalized,s=new r.constructor(t.length*i),o=0,a=0;for(let n=0,l=t.length;n<l;n++){o=e.isInterleavedBufferAttribute?t[n]*e.data.stride+e.offset:t[n]*i;for(let e=0;e<i;e++)s[a++]=r[o++]}return new iA(s,i,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new iV,r=this.index.array,i=this.attributes;for(let n in i){let s=e(i[n],r);t.setAttribute(n,s)}let n=this.morphAttributes;for(let i in n){let s=[],o=n[i];for(let t=0,i=o.length;t<i;t++){let i=e(o[t],r);s.push(i)}t.morphAttributes[i]=s}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let e=0,r=s.length;e<r;e++){let r=s[e];t.addGroup(r.start,r.count,r.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let t in r){let i=r[t];e.data.attributes[t]=i.toJSON(e.data)}let i={},n=!1;for(let t in this.morphAttributes){let r=this.morphAttributes[t],s=[];for(let t=0,i=r.length;t<i;t++){let i=r[t];s.push(i.toJSON(e.data))}s.length>0&&(i[t]=s,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;null!==r&&this.setIndex(r.clone(t));let i=e.attributes;for(let e in i){let r=i[e];this.setAttribute(e,r.clone(t))}let n=e.morphAttributes;for(let e in n){let r=[],i=n[e];for(let e=0,n=i.length;e<n;e++)r.push(i[e].clone(t));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let e=0,t=s.length;e<t;e++){let t=s[e];this.addGroup(t.start,t.count,t.materialIndex)}let o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());let a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let iG=new rB,iU=new rD,iz=new rA,ij=new ra,iH=new ra,iW=new ra,iq=new ra,iX=new ra,i$=new ra,iY=new ra,iZ=new ra;class iK extends ie{constructor(e=new iV,t=new iP){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(i,e);let o=this.morphTargetInfluences;if(n&&o){i$.set(0,0,0);for(let r=0,i=n.length;r<i;r++){let i=o[r],a=n[r];0!==i&&(iX.fromBufferAttribute(a,e),s?i$.addScaledVector(iX,i):i$.addScaledVector(iX.sub(t),i))}t.add(i$)}return t}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(void 0!==i){if(null===r.boundingSphere&&r.computeBoundingSphere(),iz.copy(r.boundingSphere),iz.applyMatrix4(n),iU.copy(e.ray).recast(e.near),!1===iz.containsPoint(iU.origin)&&(null===iU.intersectSphere(iz,ij)||iU.origin.distanceToSquared(ij)>(e.far-e.near)**2))return;if(iG.copy(n).invert(),iU.copy(e.ray).applyMatrix4(iG),null!==r.boundingBox&&!1===iU.intersectsBox(r.boundingBox))return;this._computeIntersections(e,t,iU)}}_computeIntersections(e,t,r){let i;let n=this.geometry,s=this.material,o=n.index,a=n.attributes.position,l=n.attributes.uv,h=n.attributes.uv1,u=n.attributes.normal,c=n.groups,d=n.drawRange;if(null!==o){if(Array.isArray(s))for(let n=0,a=c.length;n<a;n++){let a=c[n],f=s[a.materialIndex],p=Math.max(a.start,d.start),g=Math.min(o.count,Math.min(a.start+a.count,d.start+d.count));for(let n=p;n<g;n+=3){let s=o.getX(n),c=o.getX(n+1);(i=iJ(this,f,e,r,l,h,u,s,c,o.getX(n+2)))&&(i.faceIndex=Math.floor(n/3),i.face.materialIndex=a.materialIndex,t.push(i))}}else{let n=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);for(let c=n;c<a;c+=3){let n=o.getX(c),a=o.getX(c+1);(i=iJ(this,s,e,r,l,h,u,n,a,o.getX(c+2)))&&(i.faceIndex=Math.floor(c/3),t.push(i))}}}else if(void 0!==a){if(Array.isArray(s))for(let n=0,o=c.length;n<o;n++){let o=c[n],f=s[o.materialIndex],p=Math.max(o.start,d.start),g=Math.min(a.count,Math.min(o.start+o.count,d.start+d.count));for(let n=p;n<g;n+=3)(i=iJ(this,f,e,r,l,h,u,n,n+1,n+2))&&(i.faceIndex=Math.floor(n/3),i.face.materialIndex=o.materialIndex,t.push(i))}else{let n=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);for(let a=n;a<o;a+=3)(i=iJ(this,s,e,r,l,h,u,a,a+1,a+2))&&(i.faceIndex=Math.floor(a/3),t.push(i))}}}}function iJ(e,t,r,i,n,s,o,a,l,h){e.getVertexPosition(a,iH),e.getVertexPosition(l,iW),e.getVertexPosition(h,iq);let u=function(e,t,r,i,n,s,o,a){let l;if(null===(l=t.side===p?i.intersectTriangle(o,s,n,!0,a):i.intersectTriangle(n,s,o,t.side===f,a)))return null;iZ.copy(a),iZ.applyMatrix4(e.matrixWorld);let h=r.ray.origin.distanceTo(iZ);return h<r.near||h>r.far?null:{distance:h,point:iZ.clone(),object:e}}(e,t,r,i,iH,iW,iq,iY);if(u){let e=new ra;im.getBarycoord(iY,iH,iW,iq,e),n&&(u.uv=im.getInterpolatedAttribute(n,a,l,h,e,new tj)),s&&(u.uv1=im.getInterpolatedAttribute(s,a,l,h,e,new tj)),o&&(u.normal=im.getInterpolatedAttribute(o,a,l,h,e,new ra),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));let t={a:a,b:l,c:h,normal:new ra,materialIndex:0};im.getNormal(iH,iW,iq,t.normal),u.face=t,u.barycoord=e}return u}class iQ extends iV{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};let o=this;i=Math.floor(i),n=Math.floor(n);let a=[],l=[],h=[],u=[],c=0,d=0;function f(e,t,r,i,n,s,f,p,g,m,v){let b=s/g,y=f/m,x=s/2,_=f/2,S=p/2,w=g+1,T=m+1,P=0,E=0,C=new ra;for(let s=0;s<T;s++){let o=s*y-_;for(let a=0;a<w;a++){let c=a*b-x;C[e]=c*i,C[t]=o*n,C[r]=S,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[r]=p>0?1:-1,h.push(C.x,C.y,C.z),u.push(a/g),u.push(1-s/m),P+=1}}for(let e=0;e<m;e++)for(let t=0;t<g;t++){let r=c+t+w*e,i=c+t+w*(e+1),n=c+(t+1)+w*(e+1),s=c+(t+1)+w*e;a.push(r,i,s),a.push(i,n,s),E+=6}o.addGroup(d,E,v),d+=E,c+=P}f("z","y","x",-1,-1,r,t,e,s=Math.floor(s),n,0),f("z","y","x",1,-1,r,t,-e,s,n,1),f("x","z","y",1,1,e,r,t,i,s,2),f("x","z","y",1,-1,e,r,-t,i,s,3),f("x","y","z",1,-1,e,t,r,i,n,4),f("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(a),this.setAttribute("position",new iR(l,3)),this.setAttribute("normal",new iR(h,3)),this.setAttribute("uv",new iR(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iQ(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function i1(e){let t={};for(let r in e)for(let i in t[r]={},e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[r][i]=null):t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}return t}function i0(e){let t={};for(let r=0;r<e.length;r++){let i=i1(e[r]);for(let e in i)t[e]=i[e]}return t}function i2(e){let t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:t2.workingColorSpace}let i3={clone:i1,merge:i0};class i5 extends iT{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=i1(e.uniforms),this.uniformsGroups=function(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);for(let r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){let i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let r={};for(let e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class i6 extends ie{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rB,this.projectionMatrix=new rB,this.projectionMatrixInverse=new rB,this.coordinateSystem=tM}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let i4=new ra,i9=new tj,i8=new tj;class i7 extends i6{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*tL*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*tN*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*tL*Math.atan(Math.tan(.5*tN*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){i4.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(i4.x,i4.y).multiplyScalar(-e/i4.z),i4.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(i4.x,i4.y).multiplyScalar(-e/i4.z)}getViewSize(e,t){return this.getViewBounds(e,i9,i8),t.subVectors(i8,i9)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*tN*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,s=this.view;if(null!==this.view&&this.view.enabled){let e=s.fullWidth,o=s.fullHeight;n+=s.offsetX*i/e,t-=s.offsetY*r/o,i*=s.width/e,r*=s.height/o}let o=this.filmOffset;0!==o&&(n+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class ne extends ie{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;let i=new i7(-90,1,e,t);i.layers=this.layers,this.add(i);let n=new i7(-90,1,e,t);n.layers=this.layers,this.add(n);let s=new i7(-90,1,e,t);s.layers=this.layers,this.add(s);let o=new i7(-90,1,e,t);o.layers=this.layers,this.add(o);let a=new i7(-90,1,e,t);a.layers=this.layers,this.add(a);let l=new i7(-90,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[r,i,n,s,o,a]=t;for(let e of t)this.remove(e);if(e===tM)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),n.up.set(0,0,-1),n.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else if(2001===e)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),n.up.set(0,0,1),n.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();let{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[n,s,o,a,l,h]=this.children,u=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;let p=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,n),e.setRenderTarget(r,1,i),e.render(t,s),e.setRenderTarget(r,2,i),e.render(t,o),e.setRenderTarget(r,3,i),e.render(t,a),e.setRenderTarget(r,4,i),e.render(t,l),r.texture.generateMipmaps=p,e.setRenderTarget(r,5,i),e.render(t,h),e.setRenderTarget(u,c,d),e.xr.enabled=f,r.texture.needsPMREMUpdate=!0}}class nt extends re{constructor(e,t,r,i,n,s,o,a,l,h){super(e=void 0!==e?e:[],t=void 0!==t?t:ea,r,i,n,s,o,a,l,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class nr extends ri{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1};this.texture=new nt([r,r,r,r,r,r],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:eb}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new iQ(5,5,5),n=new i5({name:"CubemapFromEquirect",uniforms:i1(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:p,blending:m});n.uniforms.tEquirect.value=t;let s=new iK(i,n),o=t.minFilter;return t.minFilter===ex&&(t.minFilter=eb),new ne(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let n=0;n<6;n++)e.setRenderTarget(this,n),e.clear(t,r,i);e.setRenderTarget(n)}}class ni extends ie{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new rX,this.environmentIntensity=1,this.environmentRotation=new rX,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}let nn=new ra,ns=new ra,no=new tH;class na{constructor(e=new ra(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=nn.subVectors(r,t).cross(ns.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let r=e.delta(nn),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(e.start).addScaledVector(r,n)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||no.getNormalMatrix(e),i=this.coplanarPoint(nn).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}let nl=new rA,nh=new ra;class nu{constructor(e=new na,t=new na,r=new na,i=new na,n=new na,s=new na){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){let o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(n),o[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=tM){let r=this.planes,i=e.elements,n=i[0],s=i[1],o=i[2],a=i[3],l=i[4],h=i[5],u=i[6],c=i[7],d=i[8],f=i[9],p=i[10],g=i[11],m=i[12],v=i[13],b=i[14],y=i[15];if(r[0].setComponents(a-n,c-l,g-d,y-m).normalize(),r[1].setComponents(a+n,c+l,g+d,y+m).normalize(),r[2].setComponents(a+s,c+h,g+f,y+v).normalize(),r[3].setComponents(a-s,c-h,g-f,y-v).normalize(),r[4].setComponents(a-o,c-u,g-p,y-b).normalize(),t===tM)r[5].setComponents(a+o,c+u,g+p,y+b).normalize();else if(2001===t)r[5].setComponents(o,u,p,b).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),nl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),nl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(nl)}intersectsSprite(e){return nl.center.set(0,0,0),nl.radius=.7071067811865476,nl.applyMatrix4(e.matrixWorld),this.intersectsSphere(nl)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(nh.x=i.normal.x>0?e.max.x:e.min.x,nh.y=i.normal.y>0?e.max.y:e.min.y,nh.z=i.normal.z>0?e.max.z:e.min.z,0>i.distanceToPoint(nh))return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(0>t[r].distanceToPoint(e))return!1;return!0}clone(){return new this.constructor().copy(this)}}class nc extends iT{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new i_(0xffffff),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}let nd=new ra,nf=new ra,np=new rB,ng=new rD,nm=new rA,nv=new ra,nb=new ra;class ny extends ie{constructor(e=new iV,t=new nc){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[0];for(let e=1,i=t.count;e<i;e++)nd.fromBufferAttribute(t,e-1),nf.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=nd.distanceTo(nf);e.setAttribute("lineDistance",new iR(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),nm.copy(r.boundingSphere),nm.applyMatrix4(i),nm.radius+=n,!1===e.ray.intersectsSphere(nm))return;np.copy(i).invert(),ng.copy(e.ray).applyMatrix4(np);let o=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=this.isLineSegments?2:1,h=r.index,u=r.attributes.position;if(null!==h){let r=Math.max(0,s.start),i=Math.min(h.count,s.start+s.count);for(let n=r,s=i-1;n<s;n+=l){let r=h.getX(n),i=nx(this,e,ng,a,r,h.getX(n+1));i&&t.push(i)}if(this.isLineLoop){let n=h.getX(i-1),s=nx(this,e,ng,a,n,h.getX(r));s&&t.push(s)}}else{let r=Math.max(0,s.start),i=Math.min(u.count,s.start+s.count);for(let n=r,s=i-1;n<s;n+=l){let r=nx(this,e,ng,a,n,n+1);r&&t.push(r)}if(this.isLineLoop){let n=nx(this,e,ng,a,i-1,r);n&&t.push(n)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function nx(e,t,r,i,n,s){let o=e.geometry.attributes.position;if(nd.fromBufferAttribute(o,n),nf.fromBufferAttribute(o,s),r.distanceSqToSegment(nd,nf,nv,nb)>i)return;nv.applyMatrix4(e.matrixWorld);let a=t.ray.origin.distanceTo(nv);if(!(a<t.near)&&!(a>t.far))return{distance:a,point:nb.clone().applyMatrix4(e.matrixWorld),index:n,face:null,faceIndex:null,barycoord:null,object:e}}let n_=new ra,nS=new ra;class nw extends ny{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[];for(let e=0,i=t.count;e<i;e+=2)n_.fromBufferAttribute(t,e),nS.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+n_.distanceTo(nS);e.setAttribute("lineDistance",new iR(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class nT extends ie{constructor(){super(),this.isGroup=!0,this.type="Group"}}class nP extends re{constructor(e,t,r,i,n,s,o,a,l,h=eF){if(h!==eF&&h!==eV)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&h===eF&&(r=eE),void 0===r&&h===eV&&(r=eR),super(null,i,n,s,o,a,h,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:eg,this.minFilter=void 0!==a?a:eg,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class nE{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)n+=(r=this.getPoint(s/e)).distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r;let i=this.getLengths(),n=0,s=i.length;r=t?t:e*i[s-1];let o=0,a=s-1,l;for(;o<=a;)if((l=i[n=Math.floor(o+(a-o)/2)]-r)<0)o=n+1;else if(l>0)a=n-1;else{a=n;break}if(i[n=a]===r)return n/(s-1);let h=i[n],u=i[n+1];return(n+(r-h)/(u-h))/(s-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),s=this.getPoint(i),o=t||(n.isVector2?new tj:new ra);return o.copy(s).sub(n).normalize(),o}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new ra,i=[],n=[],s=[],o=new ra,a=new rB;for(let t=0;t<=e;t++){let r=t/e;i[t]=this.getTangentAt(r,new ra)}n[0]=new ra,s[0]=new ra;let l=Number.MAX_VALUE,h=Math.abs(i[0].x),u=Math.abs(i[0].y),c=Math.abs(i[0].z);h<=l&&(l=h,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),c<=l&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],o),s[0].crossVectors(i[0],n[0]);for(let t=1;t<=e;t++){if(n[t]=n[t-1].clone(),s[t]=s[t-1].clone(),o.crossVectors(i[t-1],i[t]),o.length()>Number.EPSILON){o.normalize();let e=Math.acos(tB(i[t-1].dot(i[t]),-1,1));n[t].applyMatrix4(a.makeRotationAxis(o,e))}s[t].crossVectors(i[t],n[t])}if(!0===t){let t=Math.acos(tB(n[0].dot(n[e]),-1,1));t/=e,i[0].dot(o.crossVectors(n[0],n[e]))>0&&(t=-t);for(let r=1;r<=e;r++)n[r].applyMatrix4(a.makeRotationAxis(i[r],t*r)),s[r].crossVectors(i[r],n[r])}return{tangents:i,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class nC extends nE{constructor(e=0,t=0,r=1,i=1,n=0,s=2*Math.PI,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e,t=new tj){let r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,n=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=n?0:r),!0===this.aClockwise&&!n&&(i===r?i=-r:i-=r);let s=this.aStartAngle+e*i,o=this.aX+this.xRadius*Math.cos(s),a=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=o-this.aX,i=a-this.aY;o=r*e-i*t+this.aX,a=r*t+i*e+this.aY}return t.set(o,a)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function nA(){let e=0,t=0,r=0,i=0;function n(n,s,o,a){e=n,t=o,r=-3*n+3*s-2*o-a,i=2*n-2*s+o+a}return{initCatmullRom:function(e,t,r,i,s){n(t,r,s*(r-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,r,i,s,o,a){let l=(t-e)/s-(r-e)/(s+o)+(r-t)/o,h=(r-t)/o-(i-t)/(o+a)+(i-r)/a;n(t,r,l*=o,h*=o)},calc:function(n){let s=n*n;return e+t*n+r*s+s*n*i}}}let nI=new ra,nM=new nA,nR=new nA,nO=new nA;function nk(e,t,r,i,n){let s=(i-t)*.5,o=(n-r)*.5,a=e*e;return e*a*(2*r-2*i+s+o)+(-3*r+3*i-2*s-o)*a+s*e+r}function nN(e,t,r,i){var n,s;return function(e,t){let r=1-e;return r*r*t}(e,t)+2*(1-(n=e))*n*r+(s=e)*s*i}function nL(e,t,r,i,n){var s,o;return function(e,t){let r=1-e;return r*r*r*t}(e,t)+function(e,t){let r=1-e;return 3*r*r*e*t}(e,r)+3*(1-(s=e))*s*s*i+(o=e)*o*o*n}class nD extends nE{constructor(e=new tj,t=new tj,r=new tj,i=new tj){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new tj){let r=this.v0,i=this.v1,n=this.v2,s=this.v3;return t.set(nL(e,r.x,i.x,n.x,s.x),nL(e,r.y,i.y,n.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class nB extends nE{constructor(e=new tj,t=new tj){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new tj){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new tj){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nF extends nE{constructor(e=new tj,t=new tj,r=new tj){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new tj){let r=this.v0,i=this.v1,n=this.v2;return t.set(nN(e,r.x,i.x,n.x),nN(e,r.y,i.y,n.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nV extends nE{constructor(e=new ra,t=new ra,r=new ra){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ra){let r=this.v0,i=this.v1,n=this.v2;return t.set(nN(e,r.x,i.x,n.x),nN(e,r.y,i.y,n.y),nN(e,r.z,i.z,n.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nG extends nE{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new tj){let r=this.points,i=(r.length-1)*e,n=Math.floor(i),s=i-n,o=r[0===n?n:n-1],a=r[n],l=r[n>r.length-2?r.length-1:n+1],h=r[n>r.length-3?r.length-1:n+2];return t.set(nk(s,o.x,a.x,l.x,h.x),nk(s,o.y,a.y,l.y,h.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new tj().fromArray(r))}return this}}var nU=Object.freeze({__proto__:null,ArcCurve:class e extends nC{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class e extends nE{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new ra){let r,i;let n=this.points,s=n.length,o=(s-(this.closed?0:1))*e,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?r=n[(a-1)%s]:(nI.subVectors(n[0],n[1]).add(n[0]),r=nI);let h=n[a%s],u=n[(a+1)%s];if(this.closed||a+2<s?i=n[(a+2)%s]:(nI.subVectors(n[s-1],n[s-2]).add(n[s-1]),i=nI),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,t=Math.pow(r.distanceToSquared(h),e),n=Math.pow(h.distanceToSquared(u),e),s=Math.pow(u.distanceToSquared(i),e);n<1e-4&&(n=1),t<1e-4&&(t=n),s<1e-4&&(s=n),nM.initNonuniformCatmullRom(r.x,h.x,u.x,i.x,t,n,s),nR.initNonuniformCatmullRom(r.y,h.y,u.y,i.y,t,n,s),nO.initNonuniformCatmullRom(r.z,h.z,u.z,i.z,t,n,s)}else"catmullrom"===this.curveType&&(nM.initCatmullRom(r.x,h.x,u.x,i.x,this.tension),nR.initCatmullRom(r.y,h.y,u.y,i.y,this.tension),nO.initCatmullRom(r.z,h.z,u.z,i.z,this.tension));return t.set(nM.calc(l),nR.calc(l),nO.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new ra().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:nD,CubicBezierCurve3:class e extends nE{constructor(e=new ra,t=new ra,r=new ra,i=new ra){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ra){let r=this.v0,i=this.v1,n=this.v2,s=this.v3;return t.set(nL(e,r.x,i.x,n.x,s.x),nL(e,r.y,i.y,n.y,s.y),nL(e,r.z,i.z,n.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:nC,LineCurve:nB,LineCurve3:class e extends nE{constructor(e=new ra,t=new ra){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ra){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ra){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:nF,QuadraticBezierCurve3:nV,SplineCurve:nG});class nz extends nE{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let r=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new nU[r](t,e))}return this}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let e=i[n]-r,s=this.curves[n],o=s.getLength(),a=0===o?0:1-e/o;return s.getPointAt(a,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t;let r=[];for(let i=0,n=this.curves;i<n.length;i++){let s=n[i],o=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let e=0;e<a.length;e++){let i=a[e];!(t&&t.equals(i))&&(r.push(i),t=i)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(new nU[r.type]().fromJSON(r))}return this}}class nj extends nz{constructor(e){super(),this.type="Path",this.currentPoint=new tj,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new nB(this.currentPoint.clone(),new tj(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new nF(this.currentPoint.clone(),new tj(e,t),new tj(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){let o=new nD(this.currentPoint.clone(),new tj(e,t),new tj(r,i),new tj(n,s));return this.curves.push(o),this.currentPoint.set(n,s),this}splineThru(e){let t=new nG([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){let o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,o,a){let l=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+l,t+h,r,i,n,s,o,a),this}absellipse(e,t,r,i,n,s,o,a){let l=new nC(e,t,r,i,n,s,o,a);if(this.curves.length>0){let e=l.getPoint(0);!e.equals(this.currentPoint)&&this.lineTo(e.x,e.y)}this.curves.push(l);let h=l.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class nH extends iV{constructor(e=[new tj(0,-.5),new tj(.5,0),new tj(0,.5)],t=12,r=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=tB(i,0,2*Math.PI);let n=[],s=[],o=[],a=[],l=[],h=1/t,u=new ra,c=new tj,d=new ra,f=new ra,p=new ra,g=0,m=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:g=e[t+1].x-e[t].x,m=e[t+1].y-e[t].y,d.x=1*m,d.y=-g,d.z=0*m,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(p.x,p.y,p.z);break;default:g=e[t+1].x-e[t].x,m=e[t+1].y-e[t].y,d.x=1*m,d.y=-g,d.z=0*m,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let n=0;n<=t;n++){let d=r+n*h*i,f=Math.sin(d),p=Math.cos(d);for(let r=0;r<=e.length-1;r++){u.x=e[r].x*f,u.y=e[r].y,u.z=e[r].x*p,s.push(u.x,u.y,u.z),c.x=n/t,c.y=r/(e.length-1),o.push(c.x,c.y);let i=a[3*r+0]*f,h=a[3*r+1],d=a[3*r+0]*p;l.push(i,h,d)}}for(let r=0;r<t;r++)for(let t=0;t<e.length-1;t++){let i=t+r*e.length,s=i+e.length,o=i+e.length+1,a=i+1;n.push(i,s,a),n.push(o,a,s)}this.setIndex(n),this.setAttribute("position",new iR(s,3)),this.setAttribute("uv",new iR(o,2)),this.setAttribute("normal",new iR(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nH(e.points,e.segments,e.phiStart,e.phiLength)}}class nW extends nH{constructor(e=1,t=1,r=4,i=8){let n=new nj;n.absarc(0,-t/2,e,1.5*Math.PI,0),n.absarc(0,t/2,e,0,.5*Math.PI),super(n.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new nW(e.radius,e.length,e.capSegments,e.radialSegments)}}class nq extends iV{constructor(e=1,t=32,r=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);let n=[],s=[],o=[],a=[],l=new ra,h=new tj;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let n=0,u=3;n<=t;n++,u+=3){let c=r+n/t*i;l.x=e*Math.cos(c),l.y=e*Math.sin(c),s.push(l.x,l.y,l.z),o.push(0,0,1),h.x=(s[u]/e+1)/2,h.y=(s[u+1]/e+1)/2,a.push(h.x,h.y)}for(let e=1;e<=t;e++)n.push(e,e+1,0);this.setIndex(n),this.setAttribute("position",new iR(s,3)),this.setAttribute("normal",new iR(o,3)),this.setAttribute("uv",new iR(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nq(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class nX extends iV{constructor(e=1,t=1,r=1,i=32,n=1,s=!1,o=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:o,thetaLength:a};let l=this;i=Math.floor(i),n=Math.floor(n);let h=[],u=[],c=[],d=[],f=0,p=[],g=r/2,m=0;(function(){let s=new ra,v=new ra,b=0,y=(t-e)/r;for(let l=0;l<=n;l++){let h=[],m=l/n,b=m*(t-e)+e;for(let e=0;e<=i;e++){let t=e/i,n=t*a+o,l=Math.sin(n),p=Math.cos(n);v.x=b*l,v.y=-m*r+g,v.z=b*p,u.push(v.x,v.y,v.z),s.set(l,y,p).normalize(),c.push(s.x,s.y,s.z),d.push(t,1-m),h.push(f++)}p.push(h)}for(let r=0;r<i;r++)for(let i=0;i<n;i++){let s=p[i][r],o=p[i+1][r],a=p[i+1][r+1],l=p[i][r+1];(e>0||0!==i)&&(h.push(s,o,l),b+=3),(t>0||i!==n-1)&&(h.push(o,a,l),b+=3)}l.addGroup(m,b,0),m+=b})(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(h),this.setAttribute("position",new iR(u,3)),this.setAttribute("normal",new iR(c,3)),this.setAttribute("uv",new iR(d,2));function v(r){let n=f,s=new tj,p=new ra,v=0,b=!0===r?e:t,y=!0===r?1:-1;for(let e=1;e<=i;e++)u.push(0,g*y,0),c.push(0,y,0),d.push(.5,.5),f++;let x=f;for(let e=0;e<=i;e++){let t=e/i*a+o,r=Math.cos(t),n=Math.sin(t);p.x=b*n,p.y=g*y,p.z=b*r,u.push(p.x,p.y,p.z),c.push(0,y,0),s.x=.5*r+.5,s.y=.5*n*y+.5,d.push(s.x,s.y),f++}for(let e=0;e<i;e++){let t=n+e,i=x+e;!0===r?h.push(i,i+1,t):h.push(i+1,i,t),v+=3}l.addGroup(m,v,!0===r?1:2),m+=v}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nX(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class n$ extends nX{constructor(e=1,t=1,r=32,i=1,n=!1,s=0,o=2*Math.PI){super(0,e,t,r,i,n,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:o}}static fromJSON(e){return new n$(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class nY extends iV{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],s=[];(function(e){let r=new ra,i=new ra,n=new ra;for(let s=0;s<t.length;s+=3)a(t[s+0],r),a(t[s+1],i),a(t[s+2],n),function(e,t,r,i){let n=i+1,s=[];for(let i=0;i<=n;i++){s[i]=[];let o=e.clone().lerp(r,i/n),a=t.clone().lerp(r,i/n),l=n-i;for(let e=0;e<=l;e++)0===e&&i===n?s[i][e]=o:s[i][e]=o.clone().lerp(a,e/l)}for(let e=0;e<n;e++)for(let t=0;t<2*(n-e)-1;t++){let r=Math.floor(t/2);t%2==0?(o(s[e][r+1]),o(s[e+1][r]),o(s[e][r])):(o(s[e][r+1]),o(s[e+1][r+1]),o(s[e+1][r]))}}(r,i,n,e)})(i),function(e){let t=new ra;for(let r=0;r<n.length;r+=3)t.x=n[r+0],t.y=n[r+1],t.z=n[r+2],t.normalize().multiplyScalar(e),n[r+0]=t.x,n[r+1]=t.y,n[r+2]=t.z}(r),function(){let e=new ra;for(let t=0;t<n.length;t+=3){e.x=n[t+0],e.y=n[t+1],e.z=n[t+2];let r=h(e)/2/Math.PI+.5,i=function(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(e)/Math.PI+.5;s.push(r,1-i)}(function(){let e=new ra,t=new ra,r=new ra,i=new ra,o=new tj,a=new tj,u=new tj;for(let c=0,d=0;c<n.length;c+=9,d+=6){e.set(n[c+0],n[c+1],n[c+2]),t.set(n[c+3],n[c+4],n[c+5]),r.set(n[c+6],n[c+7],n[c+8]),o.set(s[d+0],s[d+1]),a.set(s[d+2],s[d+3]),u.set(s[d+4],s[d+5]),i.copy(e).add(t).add(r).divideScalar(3);let f=h(i);l(o,d+0,e,f),l(a,d+2,t,f),l(u,d+4,r,f)}})(),function(){for(let e=0;e<s.length;e+=6){let t=s[e+0],r=s[e+2],i=s[e+4],n=Math.max(t,r,i),o=Math.min(t,r,i);n>.9&&o<.1&&(t<.2&&(s[e+0]+=1),r<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new iR(n,3)),this.setAttribute("normal",new iR(n.slice(),3)),this.setAttribute("uv",new iR(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals();function o(e){n.push(e.x,e.y,e.z)}function a(t,r){let i=3*t;r.x=e[i+0],r.y=e[i+1],r.z=e[i+2]}function l(e,t,r,i){i<0&&1===e.x&&(s[t]=e.x-1),0===r.x&&0===r.z&&(s[t]=i/2/Math.PI+.5)}function h(e){return Math.atan2(e.z,-e.x)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nY(e.vertices,e.indices,e.radius,e.details)}}class nZ extends nY{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new nZ(e.radius,e.detail)}}let nK=new ra,nJ=new ra,nQ=new ra,n1=new im;class n0 extends nj{constructor(e){super(e),this.uuid=tD(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(new nj().fromJSON(r))}return this}}let n2=function(e,t,r=2){let i,n,s,o,a,l,h;let u=t&&t.length,c=u?t[0]*r:e.length,d=n3(e,0,c,r,!0),f=[];if(!d||d.next===d.prev)return f;if(u&&(d=function(e,t,r,i){let n,s,o,a,l;let h=[];for(n=0,s=t.length;n<s;n++)o=t[n]*i,a=n<s-1?t[n+1]*i:e.length,(l=n3(e,o,a,i,!1))===l.next&&(l.steiner=!0),h.push(function(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}(l));for(h.sort(n4),n=0;n<h.length;n++)r=function(e,t){let r=function(e,t){let r=t,i=-1/0,n,s=e.x,o=e.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let e=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=s&&e>i&&(i=e,n=r.x<r.next.x?r:r.next,e===s))return n}r=r.next}while(r!==t);if(!n)return null;let a=n,l=n.x,h=n.y,u=1/0,c;r=n;do s>=r.x&&r.x>=l&&s!==r.x&&n8(o<h?s:i,o,l,h,o<h?i:s,o,r.x,r.y)&&(c=Math.abs(o-r.y)/(s-r.x),sn(r,e)&&(c<u||c===u&&(r.x>n.x||r.x===n.x&&function(e,t){return 0>n7(e.prev,e,t.prev)&&0>n7(t.next,e,e.next)}(n,r)))&&(n=r,u=c)),r=r.next;while(r!==a);return n}(e,t);if(!r)return t;let i=ss(r,e);return n5(i,i.next),n5(r,r.next)}(h[n],r);return r}(e,t,d,r)),e.length>80*r){i=s=e[0],n=o=e[1];for(let t=r;t<c;t+=r)a=e[t],l=e[t+1],a<i&&(i=a),l<n&&(n=l),a>s&&(s=a),l>o&&(o=l);h=0!==(h=Math.max(s-i,o-n))?32767/h:0}return n6(d,f,r,i,n,h,0),f};function n3(e,t,r,i,n){let s,o;if(n===function(e,t,r,i){let n=0;for(let s=t,o=r-i;s<r;s+=i)n+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return n}(e,t,r,i)>0)for(s=t;s<r;s+=i)o=so(s,e[s],e[s+1],o);else for(s=r-i;s>=t;s-=i)o=so(s,e[s],e[s+1],o);return o&&se(o,o.next)&&(sa(o),o=o.next),o}function n5(e,t){if(!e)return e;!t&&(t=e);let r=e,i;do if(i=!1,!r.steiner&&(se(r,r.next)||0===n7(r.prev,r,r.next))){if(sa(r),(r=t=r.prev)===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function n6(e,t,r,i,n,s,o){if(!e)return;!o&&s&&function(e,t,r,i){let n=e;do 0===n.z&&(n.z=n9(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){let t,r,i,n,s,o,a,l,h=1;do{for(r=e,e=null,s=null,o=0;r;){for(o++,i=r,a=0,t=0;t<h&&(a++,i=i.nextZ);t++);for(l=h;a>0||l>0&&i;)0!==a&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,h*=2}while(o>1);}(n)}(e,i,n,s);let a=e,l,h;for(;e.prev!==e.next;){if(l=e.prev,h=e.next,s?function(e,t,r,i){let n=e.prev,s=e.next;if(n7(n,e,s)>=0)return!1;let o=n.x,a=e.x,l=s.x,h=n.y,u=e.y,c=s.y,d=o<a?o<l?o:l:a<l?a:l,f=h<u?h<c?h:c:u<c?u:c,p=o>a?o>l?o:l:a>l?a:l,g=h>u?h>c?h:c:u>c?u:c,m=n9(d,f,t,r,i),v=n9(p,g,t,r,i),b=e.prevZ,y=e.nextZ;for(;b&&b.z>=m&&y&&y.z<=v;){if(b.x>=d&&b.x<=p&&b.y>=f&&b.y<=g&&b!==n&&b!==s&&n8(o,h,a,u,l,c,b.x,b.y)&&n7(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,y.x>=d&&y.x<=p&&y.y>=f&&y.y<=g&&y!==n&&y!==s&&n8(o,h,a,u,l,c,y.x,y.y)&&n7(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;b&&b.z>=m;){if(b.x>=d&&b.x<=p&&b.y>=f&&b.y<=g&&b!==n&&b!==s&&n8(o,h,a,u,l,c,b.x,b.y)&&n7(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;y&&y.z<=v;){if(y.x>=d&&y.x<=p&&y.y>=f&&y.y<=g&&y!==n&&y!==s&&n8(o,h,a,u,l,c,y.x,y.y)&&n7(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}(e,i,n,s):function(e){let t=e.prev,r=e.next;if(n7(t,e,r)>=0)return!1;let i=t.x,n=e.x,s=r.x,o=t.y,a=e.y,l=r.y,h=i<n?i<s?i:s:n<s?n:s,u=o<a?o<l?o:l:a<l?a:l,c=i>n?i>s?i:s:n>s?n:s,d=o>a?o>l?o:l:a>l?a:l,f=r.next;for(;f!==t;){if(f.x>=h&&f.x<=c&&f.y>=u&&f.y<=d&&n8(i,o,n,a,s,l,f.x,f.y)&&n7(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(h.i/r|0),sa(e),e=h.next,a=h.next;continue}if((e=h)===a){o?1===o?n6(e=function(e,t,r){let i=e;do{let n=i.prev,s=i.next.next;!se(n,s)&&st(n,i,i.next,s)&&sn(n,s)&&sn(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),sa(i),sa(i.next),i=e=s),i=i.next}while(i!==e);return n5(i)}(n5(e),t,r),t,r,i,n,s,2):2===o&&function(e,t,r,i,n,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&st(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(sn(e,t)&&sn(t,e)&&function(e,t){let r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}(e,t)&&(n7(e.prev,e,t.prev)||n7(e,t.prev,t))||se(e,t)&&n7(e.prev,e,e.next)>0&&n7(t.prev,t,t.next)>0)}(o,e)){let a=ss(o,e);o=n5(o,o.next),a=n5(a,a.next),n6(o,t,r,i,n,s,0),n6(a,t,r,i,n,s,0);return}e=e.next}o=o.next}while(o!==e)}(e,t,r,i,n,s):n6(n5(e),t,r,i,n,s,1);break}}}function n4(e,t){return e.x-t.x}function n9(e,t,r,i,n){return e=((e=((e=((e=((e=(e-r)*n|0)|e<<8)&0xff00ff)|e<<4)&0xf0f0f0f)|e<<2)&0x33333333)|e<<1)&0x55555555,e|(t=((t=((t=((t=((t=(t-i)*n|0)|t<<8)&0xff00ff)|t<<4)&0xf0f0f0f)|t<<2)&0x33333333)|t<<1)&0x55555555)<<1}function n8(e,t,r,i,n,s,o,a){return(n-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(i-a)>=(r-o)*(t-a)&&(r-o)*(s-a)>=(n-o)*(i-a)}function n7(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function se(e,t){return e.x===t.x&&e.y===t.y}function st(e,t,r,i){let n=si(n7(e,t,r)),s=si(n7(e,t,i)),o=si(n7(r,i,e)),a=si(n7(r,i,t));return!!(n!==s&&o!==a||0===n&&sr(e,r,t)||0===s&&sr(e,i,t)||0===o&&sr(r,e,i)||0===a&&sr(r,t,i))||!1}function sr(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function si(e){return e>0?1:e<0?-1:0}function sn(e,t){return 0>n7(e.prev,e,e.next)?n7(e,t,e.next)>=0&&n7(e,e.prev,t)>=0:0>n7(e,t,e.prev)||0>n7(e,e.next,t)}function ss(e,t){let r=new sl(e.i,e.x,e.y),i=new sl(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function so(e,t,r,i){let n=new sl(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function sa(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function sl(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class sh{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return .5*r}static isClockWise(e){return 0>sh.area(e)}static triangulateShape(e,t){let r=[],i=[],n=[];su(e),sc(r,e);let s=e.length;t.forEach(su);for(let e=0;e<t.length;e++)i.push(s),s+=t[e].length,sc(r,t[e]);let o=n2(r,i);for(let e=0;e<o.length;e+=3)n.push(o.slice(e,e+3));return n}}function su(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function sc(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}class sd extends iV{constructor(e=new n0([new tj(.5,.5),new tj(-.5,.5),new tj(-.5,-.5),new tj(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,i=[],n=[];for(let s=0,o=e.length;s<o;s++)(function(e){let s,o,a,l;let h=[],u=void 0!==t.curveSegments?t.curveSegments:12,c=void 0!==t.steps?t.steps:1,d=void 0!==t.depth?t.depth:1,f=void 0===t.bevelEnabled||t.bevelEnabled,p=void 0!==t.bevelThickness?t.bevelThickness:.2,g=void 0!==t.bevelSize?t.bevelSize:p-.1,m=void 0!==t.bevelOffset?t.bevelOffset:0,v=void 0!==t.bevelSegments?t.bevelSegments:3,b=t.extrudePath,y=void 0!==t.UVGenerator?t.UVGenerator:sf,x,_=!1;b&&(x=b.getSpacedPoints(c),_=!0,f=!1,s=b.computeFrenetFrames(c,!1),o=new ra,a=new ra,l=new ra),!f&&(v=0,p=0,g=0,m=0);let S=e.extractPoints(u),w=S.shape,T=S.holes;if(!sh.isClockWise(w)){w=w.reverse();for(let e=0,t=T.length;e<t;e++){let t=T[e];sh.isClockWise(t)&&(T[e]=t.reverse())}}let P=sh.triangulateShape(w,T),E=w;for(let e=0,t=T.length;e<t;e++){let t=T[e];w=w.concat(t)}function C(e,t,r){return!t&&console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,r)}let A=w.length,I=P.length;function M(e,t,r){let i,n,s;let o=e.x-t.x,a=e.y-t.y,l=r.x-e.x,h=r.y-e.y,u=o*o+a*a;if(Math.abs(o*h-a*l)>Number.EPSILON){let c=Math.sqrt(u),d=Math.sqrt(l*l+h*h),f=t.x-a/c,p=t.y+o/c,g=r.x-h/d,m=((g-f)*h-(r.y+l/d-p)*l)/(o*h-a*l);i=f+o*m-e.x;let v=i*i+(n=p+a*m-e.y)*n;if(v<=2)return new tj(i,n);s=Math.sqrt(v/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(h)&&(e=!0),e?(i=-a,n=o,s=Math.sqrt(u)):(i=o,n=a,s=Math.sqrt(u/2))}return new tj(i/s,n/s)}let R=[];for(let e=0,t=E.length,r=t-1,i=e+1;e<t;e++,r++,i++)r===t&&(r=0),i===t&&(i=0),R[e]=M(E[e],E[r],E[i]);let O=[],k,N=R.concat();for(let e=0,t=T.length;e<t;e++){let t=T[e];k=[];for(let e=0,r=t.length,i=r-1,n=e+1;e<r;e++,i++,n++)i===r&&(i=0),n===r&&(n=0),k[e]=M(t[e],t[i],t[n]);O.push(k),N=N.concat(k)}for(let e=0;e<v;e++){let t=e/v,r=p*Math.cos(t*Math.PI/2),i=g*Math.sin(t*Math.PI/2)+m;for(let e=0,t=E.length;e<t;e++){let t=C(E[e],R[e],i);B(t.x,t.y,-r)}for(let e=0,t=T.length;e<t;e++){let t=T[e];k=O[e];for(let e=0,n=t.length;e<n;e++){let n=C(t[e],k[e],i);B(n.x,n.y,-r)}}}let L=g+m;for(let e=0;e<A;e++){let t=f?C(w[e],N[e],L):w[e];_?(a.copy(s.normals[0]).multiplyScalar(t.x),o.copy(s.binormals[0]).multiplyScalar(t.y),l.copy(x[0]).add(a).add(o),B(l.x,l.y,l.z)):B(t.x,t.y,0)}for(let e=1;e<=c;e++)for(let t=0;t<A;t++){let r=f?C(w[t],N[t],L):w[t];_?(a.copy(s.normals[e]).multiplyScalar(r.x),o.copy(s.binormals[e]).multiplyScalar(r.y),l.copy(x[e]).add(a).add(o),B(l.x,l.y,l.z)):B(r.x,r.y,d/c*e)}for(let e=v-1;e>=0;e--){let t=e/v,r=p*Math.cos(t*Math.PI/2),i=g*Math.sin(t*Math.PI/2)+m;for(let e=0,t=E.length;e<t;e++){let t=C(E[e],R[e],i);B(t.x,t.y,d+r)}for(let e=0,t=T.length;e<t;e++){let t=T[e];k=O[e];for(let e=0,n=t.length;e<n;e++){let n=C(t[e],k[e],i);_?B(n.x,n.y+x[c-1].y,x[c-1].x+r):B(n.x,n.y,d+r)}}}(function(){let e=i.length/3;if(f){let e=0,t=0*A;for(let e=0;e<I;e++){let r=P[e];F(r[2]+t,r[1]+t,r[0]+t)}t=A*(e=c+2*v);for(let e=0;e<I;e++){let r=P[e];F(r[0]+t,r[1]+t,r[2]+t)}}else{for(let e=0;e<I;e++){let t=P[e];F(t[2],t[1],t[0])}for(let e=0;e<I;e++){let t=P[e];F(t[0]+A*c,t[1]+A*c,t[2]+A*c)}}r.addGroup(e,i.length/3-e,0)})(),function(){let e=i.length/3,t=0;D(E,0),t+=E.length;for(let e=0,r=T.length;e<r;e++){let r=T[e];D(r,t),t+=r.length}r.addGroup(e,i.length/3-e,1)}();function D(e,t){let n=e.length;for(;--n>=0;){let s=n,o=n-1;o<0&&(o=e.length-1);for(let e=0,n=c+2*v;e<n;e++){let n=A*e,a=A*(e+1);(function(e,t,n,s){V(e),V(t),V(s),V(t),V(n),V(s);let o=i.length/3,a=y.generateSideWallUV(r,i,o-6,o-3,o-2,o-1);G(a[0]),G(a[1]),G(a[3]),G(a[1]),G(a[2]),G(a[3])})(t+s+n,t+o+n,t+o+a,t+s+a)}}}function B(e,t,r){h.push(e),h.push(t),h.push(r)}function F(e,t,n){V(e),V(t),V(n);let s=i.length/3,o=y.generateTopUV(r,i,s-3,s-2,s-1);G(o[0]),G(o[1]),G(o[2])}function V(e){i.push(h[3*e+0]),i.push(h[3*e+1]),i.push(h[3*e+2])}function G(e){n.push(e.x),n.push(e.y)}})(e[s]);this.setAttribute("position",new iR(i,3)),this.setAttribute("uv",new iR(n,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return function(e,t,r){if(r.shapes=[],Array.isArray(e))for(let t=0,i=e.length;t<i;t++){let i=e[t];r.shapes.push(i.uuid)}else r.shapes.push(e.uuid);return r.options=Object.assign({},t),void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}(t,this.parameters.options,e)}static fromJSON(e,t){let r=[];for(let i=0,n=e.shapes.length;i<n;i++){let n=t[e.shapes[i]];r.push(n)}let i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=new nU[i.type]().fromJSON(i)),new sd(r,e.options)}}let sf={generateTopUV:function(e,t,r,i,n){let s=t[3*r],o=t[3*r+1],a=t[3*i],l=t[3*i+1],h=t[3*n],u=t[3*n+1];return[new tj(s,o),new tj(a,l),new tj(h,u)]},generateSideWallUV:function(e,t,r,i,n,s){let o=t[3*r],a=t[3*r+1],l=t[3*r+2],h=t[3*i],u=t[3*i+1],c=t[3*i+2],d=t[3*n],f=t[3*n+1],p=t[3*n+2],g=t[3*s],m=t[3*s+1],v=t[3*s+2];return Math.abs(a-u)<Math.abs(o-h)?[new tj(o,1-l),new tj(h,1-c),new tj(d,1-p),new tj(g,1-v)]:[new tj(a,1-l),new tj(u,1-c),new tj(f,1-p),new tj(m,1-v)]}};class sp extends nY{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2;super([-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sp(e.radius,e.detail)}}class sg extends nY{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sg(e.radius,e.detail)}}class sm extends iV{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,s=t/2,o=Math.floor(r),a=Math.floor(i),l=o+1,h=a+1,u=e/o,c=t/a,d=[],f=[],p=[],g=[];for(let e=0;e<h;e++){let t=e*c-s;for(let r=0;r<l;r++){let i=r*u-n;f.push(i,-t,0),p.push(0,0,1),g.push(r/o),g.push(1-e/a)}}for(let e=0;e<a;e++)for(let t=0;t<o;t++){let r=t+l*e,i=t+l*(e+1),n=t+1+l*(e+1),s=t+1+l*e;d.push(r,i,s),d.push(i,n,s)}this.setIndex(d),this.setAttribute("position",new iR(f,3)),this.setAttribute("normal",new iR(p,3)),this.setAttribute("uv",new iR(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sm(e.width,e.height,e.widthSegments,e.heightSegments)}}class sv extends iV{constructor(e=.5,t=1,r=32,i=1,n=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:n,thetaLength:s},r=Math.max(3,r);let o=[],a=[],l=[],h=[],u=e,c=(t-e)/(i=Math.max(1,i)),d=new ra,f=new tj;for(let e=0;e<=i;e++){for(let e=0;e<=r;e++){let i=n+e/r*s;d.x=u*Math.cos(i),d.y=u*Math.sin(i),a.push(d.x,d.y,d.z),l.push(0,0,1),f.x=(d.x/t+1)/2,f.y=(d.y/t+1)/2,h.push(f.x,f.y)}u+=c}for(let e=0;e<i;e++){let t=e*(r+1);for(let e=0;e<r;e++){let i=e+t,n=i+r+1,s=i+r+2,a=i+1;o.push(i,n,a),o.push(n,s,a)}}this.setIndex(o),this.setAttribute("position",new iR(a,3)),this.setAttribute("normal",new iR(l,3)),this.setAttribute("uv",new iR(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sv(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class sb extends iV{constructor(e=new n0([new tj(0,.5),new tj(-.5,-.5),new tj(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],i=[],n=[],s=[],o=0,a=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(o,a,t),o+=a,a=0;function l(e){let o=i.length/3,l=e.extractPoints(t),h=l.shape,u=l.holes;!1===sh.isClockWise(h)&&(h=h.reverse());for(let e=0,t=u.length;e<t;e++){let t=u[e];!0===sh.isClockWise(t)&&(u[e]=t.reverse())}let c=sh.triangulateShape(h,u);for(let e=0,t=u.length;e<t;e++){let t=u[e];h=h.concat(t)}for(let e=0,t=h.length;e<t;e++){let t=h[e];i.push(t.x,t.y,0),n.push(0,0,1),s.push(t.x,t.y)}for(let e=0,t=c.length;e<t;e++){let t=c[e],i=t[0]+o,n=t[1]+o,s=t[2]+o;r.push(i,n,s),a+=3}}this.setIndex(r),this.setAttribute("position",new iR(i,3)),this.setAttribute("normal",new iR(n,3)),this.setAttribute("uv",new iR(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){let i=e[r];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){let r=[];for(let i=0,n=e.shapes.length;i<n;i++){let n=t[e.shapes[i]];r.push(n)}return new sb(r,e.curveSegments)}}class sy extends iV{constructor(e=1,t=32,r=16,i=0,n=2*Math.PI,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let a=Math.min(s+o,Math.PI),l=0,h=[],u=new ra,c=new ra,d=[],f=[],p=[],g=[];for(let d=0;d<=r;d++){let m=[],v=d/r,b=0;0===d&&0===s?b=.5/t:d===r&&a===Math.PI&&(b=-.5/t);for(let r=0;r<=t;r++){let a=r/t;u.x=-e*Math.cos(i+a*n)*Math.sin(s+v*o),u.y=e*Math.cos(s+v*o),u.z=e*Math.sin(i+a*n)*Math.sin(s+v*o),f.push(u.x,u.y,u.z),c.copy(u).normalize(),p.push(c.x,c.y,c.z),g.push(a+b,1-v),m.push(l++)}h.push(m)}for(let e=0;e<r;e++)for(let i=0;i<t;i++){let t=h[e][i+1],n=h[e][i],o=h[e+1][i],l=h[e+1][i+1];(0!==e||s>0)&&d.push(t,n,l),(e!==r-1||a<Math.PI)&&d.push(n,o,l)}this.setIndex(d),this.setAttribute("position",new iR(f,3)),this.setAttribute("normal",new iR(p,3)),this.setAttribute("uv",new iR(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sy(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class sx extends nY{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sx(e.radius,e.detail)}}class s_ extends iV{constructor(e=1,t=.4,r=12,i=48,n=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n},r=Math.floor(r),i=Math.floor(i);let s=[],o=[],a=[],l=[],h=new ra,u=new ra,c=new ra;for(let s=0;s<=r;s++)for(let d=0;d<=i;d++){let f=d/i*n,p=s/r*Math.PI*2;u.x=(e+t*Math.cos(p))*Math.cos(f),u.y=(e+t*Math.cos(p))*Math.sin(f),u.z=t*Math.sin(p),o.push(u.x,u.y,u.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),c.subVectors(u,h).normalize(),a.push(c.x,c.y,c.z),l.push(d/i),l.push(s/r)}for(let e=1;e<=r;e++)for(let t=1;t<=i;t++){let r=(i+1)*e+t-1,n=(i+1)*(e-1)+t-1,o=(i+1)*(e-1)+t,a=(i+1)*e+t;s.push(r,n,a),s.push(n,o,a)}this.setIndex(s),this.setAttribute("position",new iR(o,3)),this.setAttribute("normal",new iR(a,3)),this.setAttribute("uv",new iR(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new s_(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class sS extends iV{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);let o=[],a=[],l=[],h=[],u=new ra,c=new ra,d=new ra,f=new ra,p=new ra,g=new ra,m=new ra;for(let o=0;o<=r;++o){let b=o/r*n*Math.PI*2;v(b,n,s,e,d),v(b+.01,n,s,e,f),g.subVectors(f,d),m.addVectors(f,d),p.crossVectors(g,m),m.crossVectors(p,g),p.normalize(),m.normalize();for(let e=0;e<=i;++e){let n=e/i*Math.PI*2,s=-t*Math.cos(n),f=t*Math.sin(n);u.x=d.x+(s*m.x+f*p.x),u.y=d.y+(s*m.y+f*p.y),u.z=d.z+(s*m.z+f*p.z),a.push(u.x,u.y,u.z),c.subVectors(u,d).normalize(),l.push(c.x,c.y,c.z),h.push(o/r),h.push(e/i)}}for(let e=1;e<=r;e++)for(let t=1;t<=i;t++){let r=(i+1)*(e-1)+(t-1),n=(i+1)*e+(t-1),s=(i+1)*e+t,a=(i+1)*(e-1)+t;o.push(r,n,a),o.push(n,s,a)}function v(e,t,r,i,n){let s=Math.cos(e),o=Math.sin(e),a=r/t*e,l=Math.cos(a);n.x=i*(2+l)*.5*s,n.y=i*(2+l)*o*.5,n.z=i*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new iR(a,3)),this.setAttribute("normal",new iR(l,3)),this.setAttribute("uv",new iR(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sS(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class sw extends iV{constructor(e=new nV(new ra(-1,-1,0),new ra(-1,1,0),new ra(1,1,0)),t=64,r=1,i=8,n=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:n};let s=e.computeFrenetFrames(t,n);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;let o=new ra,a=new ra,l=new tj,h=new ra,u=[],c=[],d=[],f=[];(function(){for(let e=0;e<t;e++)p(e);p(!1===n?t:0),function(){for(let e=0;e<=t;e++)for(let r=0;r<=i;r++)l.x=e/t,l.y=r/i,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){let r=(i+1)*(e-1)+(t-1),n=(i+1)*e+(t-1),s=(i+1)*e+t,o=(i+1)*(e-1)+t;f.push(r,n,o),f.push(n,s,o)}}()})(),this.setIndex(f),this.setAttribute("position",new iR(u,3)),this.setAttribute("normal",new iR(c,3)),this.setAttribute("uv",new iR(d,2));function p(n){h=e.getPointAt(n/t,h);let l=s.normals[n],d=s.binormals[n];for(let e=0;e<=i;e++){let t=e/i*Math.PI*2,n=Math.sin(t),s=-Math.cos(t);a.x=s*l.x+n*d.x,a.y=s*l.y+n*d.y,a.z=s*l.z+n*d.z,a.normalize(),c.push(a.x,a.y,a.z),o.x=h.x+r*a.x,o.y=h.y+r*a.y,o.z=h.z+r*a.z,u.push(o.x,o.y,o.z)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new sw(new nU[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}function sT(e,t,r){let i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,n=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==r.has(i)&&!0!==r.has(n)&&(r.add(i),r.add(n),!0)}class sP extends iT{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class sE extends iT{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class sC extends nc{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function sA(e,t,r){return e&&(r||e.constructor!==t)?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}class sI{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];t:{r:{let s;i:{n:if(!(e<i)){for(let s=r+2;;){if(void 0===i){if(e<n)break n;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===s)break;if(n=i,e<(i=t[++r]))break r}s=t.length;break i}if(!(e>=n)){let o=t[1];e<o&&(r=2,n=o);for(let s=r-2;;){if(void 0===n)return this._cachedIndex=0,this.copySampleValue_(0);if(r===s)break;if(i=n,e>=(n=t[--r-1]))break r}s=r,r=0;break i}break t}for(;r<s;){let i=r+s>>>1;e<t[i]?s=i:r=i+1}if(i=t[r],void 0===(n=t[r-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let e=0;e!==i;++e)t[e]=r[n+e];return t}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}}class sM extends sI{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,s=e+1,o=i[n],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:n=e,o=2*t-r;break;case 2402:n=i.length-2,o=t+i[n]-i[n+1];break;default:n=e,o=r}if(void 0===a)switch(this.getSettings_().endingEnd){case 2401:s=e,a=2*r-t;break;case 2402:s=1,a=r+i[1]-i[0];break;default:s=e-1,a=t}let l=(r-t)*.5,h=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-r),this._offsetPrev=n*h,this._offsetNext=s*h}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,h=this._offsetPrev,u=this._offsetNext,c=this._weightPrev,d=this._weightNext,f=(r-t)/(i-t),p=f*f,g=p*f,m=-c*g+2*c*p-c*f,v=(1+c)*g+(-1.5-2*c)*p+(-.5+c)*f+1,b=(-1-d)*g+(1.5+d)*p+.5*f,y=d*g-d*p;for(let e=0;e!==o;++e)n[e]=m*s[h+e]+v*s[l+e]+b*s[a+e]+y*s[u+e];return n}}class sR extends sI{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,h=(r-t)/(i-t),u=1-h;for(let e=0;e!==o;++e)n[e]=s[l+e]*u+s[a+e]*h;return n}}class sO extends sI{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class sk{constructor(e,t,r,i){if(void 0===e)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=sA(t,this.TimeBufferType),this.values=sA(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t;let r=e.constructor;if(r.toJSON!==this.toJSON)t=r.toJSON(e);else{t={name:e.name,times:sA(e.times,Array),values:sA(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new sO(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new sR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new sM(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,s=i-1;for(;n!==i&&r[n]<e;)++n;for(;-1!==s&&r[s]>t;)--s;if(++s,0!==n||s!==i){n>=s&&(n=(s=Math.max(s,1))-1);let e=this.getValueSize();this.times=r.slice(n,s),this.values=this.values.slice(n*e,s*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let t=0;t!==n;t++){let i=r[t];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,i),e=!1;break}if(null!==s&&s>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,i,s),e=!1;break}s=i}if(void 0!==i){var o;if(ArrayBuffer.isView(o=i)&&!(o instanceof DataView))for(let t=0,r=i.length;t!==r;++t){let r=i[t];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,r),e=!1;break}}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=2302===this.getInterpolation(),n=e.length-1,s=1;for(let o=1;o<n;++o){let n=!1,a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0])){if(i)n=!0;else{let e=o*r,i=e-r,s=e+r;for(let o=0;o!==r;++o){let r=t[e+o];if(r!==t[i+o]||r!==t[s+o]){n=!0;break}}}}if(n){if(o!==s){e[s]=e[o];let i=o*r,n=s*r;for(let e=0;e!==r;++e)t[n+e]=t[i+e]}++s}}if(n>0){e[s]=e[n];for(let e=n*r,i=s*r,o=0;o!==r;++o)t[i+o]=t[e+o];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*r)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),r=new this.constructor(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}sk.prototype.TimeBufferType=Float32Array,sk.prototype.ValueBufferType=Float32Array,sk.prototype.DefaultInterpolation=2301;class sN extends sk{constructor(e,t,r){super(e,t,r)}}sN.prototype.ValueTypeName="bool",sN.prototype.ValueBufferType=Array,sN.prototype.DefaultInterpolation=2300,sN.prototype.InterpolantFactoryMethodLinear=void 0,sN.prototype.InterpolantFactoryMethodSmooth=void 0;(class e extends sk{}).prototype.ValueTypeName="color";(class e extends sk{}).prototype.ValueTypeName="number";class sL extends sI{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(r-t)/(i-t),l=e*o;for(let e=l+o;l!==e;l+=4)ro.slerpFlat(n,0,s,l-o,s,l,a);return n}}class sD extends sk{InterpolantFactoryMethodLinear(e){return new sL(this.times,this.values,this.getValueSize(),e)}}sD.prototype.ValueTypeName="quaternion",sD.prototype.InterpolantFactoryMethodSmooth=void 0;class sB extends sk{constructor(e,t,r){super(e,t,r)}}sB.prototype.ValueTypeName="string",sB.prototype.ValueBufferType=Array,sB.prototype.DefaultInterpolation=2300,sB.prototype.InterpolantFactoryMethodLinear=void 0,sB.prototype.InterpolantFactoryMethodSmooth=void 0;(class e extends sk{}).prototype.ValueTypeName="vector";let sF={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},sV=new class e{constructor(e,t,r){let i,n=this,s=!1,o=0,a=0;let l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===s&&void 0!==n.onStart&&n.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return -1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){let r=l[t],i=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}};class sG{constructor(e){this.manager=void 0!==e?e:sV,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}sG.DEFAULT_MATERIAL_NAME="__DEFAULT";let sU={};class sz extends Error{constructor(e,t){super(e),this.response=t}}class sj extends sG{constructor(e){super(e)}load(e,t,r,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let n=sF.get(e);if(void 0!==n)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(void 0!==sU[e]){sU[e].push({onLoad:t,onProgress:r,onError:i});return}sU[e]=[],sU[e].push({onLoad:t,onProgress:r,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;let r=sU[e],i=t.body.getReader(),n=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),s=n?parseInt(n):0,o=0!==s,a=0;return new Response(new ReadableStream({start(e){(function t(){i.read().then(({done:i,value:n})=>{if(i)e.close();else{let i=new ProgressEvent("progress",{lengthComputable:o,loaded:a+=n.byteLength,total:s});for(let e=0,t=r.length;e<t;e++){let t=r[e];t.onProgress&&t.onProgress(i)}e.enqueue(n),t()}},t=>{e.error(t)})})()}}))}throw new sz(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)}).then(e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>new DOMParser().parseFromString(e,o));case"json":return e.json();default:if(void 0===o)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(o),r=new TextDecoder(t&&t[1]?t[1].toLowerCase():void 0);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{sF.add(e,t);let r=sU[e];delete sU[e];for(let e=0,i=r.length;e<i;e++){let i=r[e];i.onLoad&&i.onLoad(t)}}).catch(t=>{let r=sU[e];if(void 0===r)throw this.manager.itemError(e),t;delete sU[e];for(let e=0,i=r.length;e<i;e++){let i=r[e];i.onError&&i.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class sH extends sG{constructor(e){super(e)}load(e,t,r,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,s=sF.get(e);if(void 0!==s)return n.manager.itemStart(e),setTimeout(function(){t&&t(s),n.manager.itemEnd(e)},0),s;let o=tX("img");function a(){h(),sF.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(t){h(),i&&i(t),n.manager.itemError(e),n.manager.itemEnd(e)}function h(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),n.manager.itemStart(e),o.src=e,o}}class sW extends sG{constructor(e){super(e)}load(e,t,r,i){let n=new re,s=new sH(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(e){n.image=e,n.needsUpdate=!0,void 0!==t&&t(n)},r,i),n}}class sq extends i6{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,s=r+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=e*this.view.offsetX,s=n+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(n,s,o,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class sX extends i7{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let s$="\\[\\]\\.:\\/",sY=RegExp("["+s$+"]","g"),sZ="[^"+s$+"]",sK="[^"+s$.replace("\\.","")+"]",sJ=/((?:WC+[\/:])*)/.source.replace("WC",sZ),sQ=/(WCOD+)?/.source.replace("WCOD",sK),s1=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sZ),s0=RegExp("^"+sJ+sQ+s1+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sZ)+"$"),s2=["material","materials","bones","map"];class s3{constructor(e,t,r){this.path=t,this.parsedPath=r||s3.parseTrackName(t),this.node=s3.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new s3.Composite(e,t,r):new s3(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(sY,"")}static parseTrackName(e){let t=s0.exec(e);if(null===t)throw Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){let e=r.nodeName.substring(i+1);-1!==s2.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){let r=function(e){for(let i=0;i<e.length;i++){let n=e[i];if(n.name===t||n.uuid===t)return n;let s=r(n.children);if(s)return s}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(!e&&(e=s3.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let i=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(void 0===e[r]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(void 0!==i){if(void 0===e[i]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[i]}}let s=e[i];if(void 0===s){console.error("THREE.PropertyBinding: Trying to update property for track: "+t.nodeName+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===i){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}void 0!==e.morphTargetDictionary[n]&&(n=e.morphTargetDictionary[n])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}s3.Composite=class e{constructor(e,t,r){let i=r||s3.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];void 0!==i&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},s3.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},s3.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},s3.prototype.GetterByBindingType=[s3.prototype._getValue_direct,s3.prototype._getValue_array,s3.prototype._getValue_arrayElement,s3.prototype._getValue_toArray],s3.prototype.SetterByBindingTypeAndVersioning=[[s3.prototype._setValue_direct,s3.prototype._setValue_direct_setNeedsUpdate,s3.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[s3.prototype._setValue_array,s3.prototype._setValue_array_setNeedsUpdate,s3.prototype._setValue_array_setMatrixWorldNeedsUpdate],[s3.prototype._setValue_arrayElement,s3.prototype._setValue_arrayElement_setNeedsUpdate,s3.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[s3.prototype._setValue_fromArray,s3.prototype._setValue_fromArray_setNeedsUpdate,s3.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);let s5=new rB;class s6{constructor(e,t,r=0,i=1/0){this.ray=new rD(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new r$,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return s5.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(s5),this}intersectObject(e,t=!0,r=[]){return s9(e,this,r,t),r.sort(s4),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)s9(e[i],this,r,t);return r.sort(s4),r}}function s4(e,t){return e.distance-t.distance}function s9(e,t,r,i){let n=!0;if(e.layers.test(t.layers)&&!1===e.raycast(t,r)&&(n=!1),!0===n&&!0===i){let i=e.children;for(let e=0,n=i.length;e<n;e++)s9(i[e],t,r,!0)}}class s8{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=tB(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(tB(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class s7 extends nw{constructor(e=10,t=10,r=4473924,i=8947848){r=new i_(r),i=new i_(i);let n=t/2,s=e/t,o=e/2,a=[],l=[];for(let e=0,h=0,u=-o;e<=t;e++,u+=s){a.push(-o,0,u,o,0,u),a.push(u,0,-o,u,0,o);let t=e===n?r:i;t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3}let h=new iV;h.setAttribute("position",new iR(a,3)),h.setAttribute("color",new iR(l,3)),super(h,new nc({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class oe{constructor(){this.type="ShapePath",this.color=new i_,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new nj,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){return this.currentPath.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){let t,r,i,n,s;let o=sh.isClockWise,a=this.subPaths;if(0===a.length)return[];let l=[];if(1===a.length)return r=a[0],(i=new n0).curves=r.curves,l.push(i),l;let h=!o(a[0].getPoints());h=e?!h:h;let u=[],c=[],d=[],f=0;c[0]=void 0,d[f]=[];for(let i=0,s=a.length;i<s;i++)t=o(n=(r=a[i]).getPoints()),(t=e?!t:t)?(!h&&c[f]&&f++,c[f]={s:new n0,p:n},c[f].s.curves=r.curves,h&&f++,d[f]=[]):d[f].push({h:r,p:n[0]});if(!c[0])return function(e){let t=[];for(let r=0,i=e.length;r<i;r++){let i=e[r],n=new n0;n.curves=i.curves,t.push(n)}return t}(a);if(c.length>1){let e=!1,t=0;for(let e=0,t=c.length;e<t;e++)u[e]=[];for(let r=0,i=c.length;r<i;r++){let i=d[r];for(let n=0;n<i.length;n++){let s=i[n],o=!0;for(let i=0;i<c.length;i++)(function(e,t){let r=t.length,i=!1;for(let n=r-1,s=0;s<r;n=s++){let r=t[n],o=t[s],a=o.x-r.x,l=o.y-r.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(r=t[s],a=-a,o=t[n],l=-l),e.y<r.y||e.y>o.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{let t=l*(e.x-r.x)-a*(e.y-r.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==r.y)continue;if(o.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=o.x)return!0}}return i})(s.p,c[i].p)&&(r!==i&&t++,o?(o=!1,u[i].push(s)):e=!0);o&&u[r].push(s)}}t>0&&!1===e&&(d=u)}for(let e=0,t=c.length;e<t;e++){i=c[e].s,l.push(i),s=d[e];for(let e=0,t=s.length;e<t;e++)i.holes.push(s[e].h)}return l}}class ot extends tR{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function or(e,t,r,i){let n=function(e){switch(e){case e_:case eS:return{byteLength:1,components:1};case eT:case ew:case eA:return{byteLength:2,components:1};case eI:case eM:return{byteLength:2,components:4};case eE:case eP:case eC:return{byteLength:4,components:1};case eO:return{byteLength:4,components:3}}throw Error(`Unknown texture type ${e}.`)}(i);switch(r){case ek:case eD:return e*t;case eB:return e*t*2;case eG:case eU:return e*t/n.components*n.byteLength;case ez:case ej:return e*t*2/n.components*n.byteLength;case eN:return e*t*3/n.components*n.byteLength;case eL:case eH:return e*t*4/n.components*n.byteLength;case eW:case eq:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case eX:case e$:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case eZ:case eJ:return Math.max(e,16)*Math.max(t,8)/4;case eY:case eK:return Math.max(e,8)*Math.max(t,8)/2;case eQ:case e1:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case e0:case e2:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case e3:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case e5:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case e6:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case e4:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case e9:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case e8:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case e7:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case te:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case tt:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case tr:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case ti:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case tn:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case ts:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case to:case ta:case tl:return Math.ceil(e/4)*Math.ceil(t/4)*16;case th:case tu:return Math.ceil(e/4)*Math.ceil(t/4)*8;case tc:case td:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw Error(`Unable to determine texture byte length for ${r} format.`)}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=n)},795:function(e,t,r){"use strict";r.d(t,{CP7:function(){return tA}});var i=r(591);function n(){let e=null,t=!1,r=null,i=null;function n(t,s){r(t,s),i=e.requestAnimationFrame(n)}return{start:function(){if(!0!==t)null!==r&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function s(e){let t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);let i=t.get(r);i&&(e.deleteBuffer(i.buffer),t.delete(r))},update:function(r,i){if(r.isInterleavedBufferAttribute&&(r=r.data),r.isGLBufferAttribute){let e=t.get(r);(!e||e.version<r.version)&&t.set(r,{buffer:r.buffer,type:r.type,bytesPerElement:r.elementSize,version:r.version});return}let n=t.get(r);if(void 0===n)t.set(r,function(t,r){let i;let n=t.array,s=t.usage,o=n.byteLength,a=e.createBuffer();if(e.bindBuffer(r,a),e.bufferData(r,n,s),t.onUploadCallback(),n instanceof Float32Array)i=e.FLOAT;else if(n instanceof Uint16Array)i=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(n instanceof Int16Array)i=e.SHORT;else if(n instanceof Uint32Array)i=e.UNSIGNED_INT;else if(n instanceof Int32Array)i=e.INT;else if(n instanceof Int8Array)i=e.BYTE;else if(n instanceof Uint8Array)i=e.UNSIGNED_BYTE;else if(n instanceof Uint8ClampedArray)i=e.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+n);return{buffer:a,type:i,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version,size:o}}(r,i));else if(n.version<r.version){if(n.size!==r.array.byteLength)throw Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,r,i){let n=r.array,s=r.updateRanges;if(e.bindBuffer(i,t),0===s.length)e.bufferSubData(i,0,n);else{s.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<s.length;e++){let r=s[t],i=s[e];i.start<=r.start+r.count+1?r.count=Math.max(r.count,i.start+i.count-r.start):s[++t]=i}s.length=t+1;for(let t=0,r=s.length;t<r;t++){let r=s[t];e.bufferSubData(i,r.start*n.BYTES_PER_ELEMENT,n,r.start,r.count)}r.clearUpdateRanges()}r.onUploadCallback()}(n.buffer,r,i),n.version=r.version}}}}let o={alphahash_fragment:"#ifdef USE_ALPHAHASH\n	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n	const float ALPHA_HASH_SCALE = 0.05;\n	float hash2D( vec2 value ) {\n		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n	}\n	float hash3D( vec3 value ) {\n		return hash2D( vec2( hash2D( value.xy ), value.z ) );\n	}\n	float getAlphaHashThreshold( vec3 position ) {\n		float maxDeriv = max(\n			length( dFdx( position.xyz ) ),\n			length( dFdy( position.xyz ) )\n		);\n		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n		vec2 pixScales = vec2(\n			exp2( floor( log2( pixScale ) ) ),\n			exp2( ceil( log2( pixScale ) ) )\n		);\n		vec2 alpha = vec2(\n			hash3D( floor( pixScales.x * position.xyz ) ),\n			hash3D( floor( pixScales.y * position.xyz ) )\n		);\n		float lerpFactor = fract( log2( pixScale ) );\n		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n		float a = min( lerpFactor, 1.0 - lerpFactor );\n		vec3 cases = vec3(\n			x * x / ( 2.0 * a * ( 1.0 - a ) ),\n			( x - 0.5 * a ) / ( 1.0 - a ),\n			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n		);\n		float threshold = ( x < ( 1.0 - a ) )\n			? ( ( x < a ) ? cases.x : cases.y )\n			: cases.z;\n		return clamp( threshold , 1.0e-6, 1.0 );\n	}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n	#ifdef ALPHA_TO_COVERAGE\n	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n	if ( diffuseColor.a == 0.0 ) discard;\n	#else\n	if ( diffuseColor.a < alphaTest ) discard;\n	#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n	uniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_CLEARCOAT ) \n		clearcoatSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_SHEEN ) \n		sheenSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n	#if ! defined( GL_ANGLE_multi_draw )\n	#define gl_DrawID _gl_DrawID\n	uniform int _gl_DrawID;\n	#endif\n	uniform highp sampler2D batchingTexture;\n	uniform highp usampler2D batchingIdTexture;\n	mat4 getBatchingMatrix( const in float i ) {\n		int size = textureSize( batchingTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n	float getIndirectIndex( const in int i ) {\n		int size = textureSize( batchingIdTexture, 0 ).x;\n		int x = i % size;\n		int y = i / size;\n		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n	}\n#endif\n#ifdef USE_BATCHING_COLOR\n	uniform sampler2D batchingColorTexture;\n	vec3 getBatchingColor( const in float i ) {\n		int size = textureSize( batchingColorTexture, 0 ).x;\n		int j = int( i );\n		int x = j % size;\n		int y = j / size;\n		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n	}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n	vPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( specularColor, 1.0, dotVH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n	const mat3 XYZ_TO_REC709 = mat3(\n		 3.2404542, -0.9692660,  0.0556434,\n		-1.5371385,  1.8760108, -0.2040259,\n		-0.4985314,  0.0415560,  1.0572252\n	);\n	vec3 Fresnel0ToIor( vec3 fresnel0 ) {\n		vec3 sqrtF0 = sqrt( fresnel0 );\n		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n	}\n	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n	}\n	float IorToFresnel0( float transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n	}\n	vec3 evalSensitivity( float OPD, vec3 shift ) {\n		float phase = 2.0 * PI * OPD * 1.0e-9;\n		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n		xyz /= 1.0685e-7;\n		vec3 rgb = XYZ_TO_REC709 * xyz;\n		return rgb;\n	}\n	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n		vec3 I;\n		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n		float cosTheta2Sq = 1.0 - sinTheta2Sq;\n		if ( cosTheta2Sq < 0.0 ) {\n			return vec3( 1.0 );\n		}\n		float cosTheta2 = sqrt( cosTheta2Sq );\n		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n		float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n		float T121 = 1.0 - R12;\n		float phi12 = 0.0;\n		if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n		float phi21 = PI - phi12;\n		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n		vec3 phi23 = vec3( 0.0 );\n		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n		vec3 phi = vec3( phi21 ) + phi23;\n		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n		vec3 r123 = sqrt( R123 );\n		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n		vec3 C0 = R12 + Rs;\n		I = C0;\n		vec3 Cm = Rs - T121;\n		for ( int m = 1; m <= 2; ++ m ) {\n			Cm *= r123;\n			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n			I += Cm * Sm;\n		}\n		return max( I, vec3( 0.0 ) );\n	}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vBumpMapUv );\n		vec2 dSTdy = dFdy( vBumpMapUv );\n		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 ) * faceDirection;\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#ifdef ALPHA_TO_COVERAGE\n		float distanceToPlane, distanceGradient;\n		float clipOpacity = 1.0;\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n			distanceGradient = fwidth( distanceToPlane ) / 2.0;\n			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			if ( clipOpacity == 0.0 ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			float unionClipOpacity = 1.0;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n				distanceGradient = fwidth( distanceToPlane ) / 2.0;\n				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			}\n			#pragma unroll_loop_end\n			clipOpacity *= 1.0 - unionClipOpacity;\n		#endif\n		diffuseColor.a *= clipOpacity;\n		if ( diffuseColor.a == 0.0 ) discard;\n	#else\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			bool clipped = true;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n			}\n			#pragma unroll_loop_end\n			if ( clipped ) discard;\n		#endif\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n	diffuseColor *= vColor;\n#elif defined( USE_COLOR )\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR )\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n	vColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n	vColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n	varying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		uv.x += filterInt * 3.0 * cubeUV_minTileSize;\n		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n		uv.x *= CUBEUV_TEXEL_WIDTH;\n		uv.y *= CUBEUV_TEXEL_HEIGHT;\n		#ifdef texture2DGradEXT\n			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n		#else\n			return texture2D( envMap, uv ).rgb;\n		#endif\n	}\n	#define cubeUV_r0 1.0\n	#define cubeUV_m0 - 2.0\n	#define cubeUV_r1 0.8\n	#define cubeUV_m1 - 1.0\n	#define cubeUV_r4 0.4\n	#define cubeUV_m4 2.0\n	#define cubeUV_r5 0.305\n	#define cubeUV_m5 3.0\n	#define cubeUV_r6 0.21\n	#define cubeUV_m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= cubeUV_r1 ) {\n			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n		} else if ( roughness >= cubeUV_r4 ) {\n			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n		} else if ( roughness >= cubeUV_r5 ) {\n			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n		} else if ( roughness >= cubeUV_r6 ) {\n			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n	vec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n	mat3 bm = mat3( batchingMatrix );\n	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n	transformedNormal = bm * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = bm * transformedTangent;\n	#endif\n#endif\n#ifdef USE_INSTANCING\n	mat3 im = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n	transformedNormal = im * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = im * transformedTangent;\n	#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n		emissiveColor = sRGBTransferEOTF( emissiveColor );\n	#endif\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n	return value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	uniform mat3 envMapRotation;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n	vec3 getIBLIrradiance( const in vec3 normal ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n			return PI * envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 reflectVec = reflect( - viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n			return envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	#ifdef USE_ANISOTROPY\n		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n			#ifdef ENVMAP_TYPE_CUBE_UV\n				vec3 bentNormal = cross( bitangent, viewDir );\n				bentNormal = normalize( cross( bentNormal, bitangent ) );\n				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n				return getIBLRadiance( viewDir, bentNormal, roughness );\n			#else\n				return vec3( 0.0 );\n			#endif\n		}\n	#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	vFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float vFogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return vec3( texture2D( gradientMap, coord ).r );\n	#else\n		vec2 fw = fwidth( coord ) * 0.5;\n		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n	#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n	vec3 diffuseColor;\n	float specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Lambert\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n	uniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	return irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n	if ( cutoffDistance > 0.0 ) {\n		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n	}\n	return distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n	return smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n		light.color = directionalLight.color;\n		light.direction = directionalLight.direction;\n		light.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = pointLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		light.color = pointLight.color;\n		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n		light.visible = ( light.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = spotLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float angleCos = dot( light.direction, spotLight.direction );\n		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n		if ( spotAttenuation > 0.0 ) {\n			float lightDistance = length( lVector );\n			light.color = spotLight.color * spotAttenuation;\n			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n			light.visible = ( light.color != vec3( 0.0 ) );\n		} else {\n			light.color = vec3( 0.0 );\n			light.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n		float dotNL = dot( normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n	material.ior = ior;\n	#ifdef USE_SPECULAR\n		float specularIntensityFactor = specularIntensity;\n		vec3 specularColorFactor = specularColor;\n		#ifdef USE_SPECULAR_COLORMAP\n			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n		#endif\n		#ifdef USE_SPECULAR_INTENSITYMAP\n			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n		#endif\n		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n	#else\n		float specularIntensityFactor = 1.0;\n		vec3 specularColorFactor = vec3( 1.0 );\n		material.specularF90 = 1.0;\n	#endif\n	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n	material.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	material.clearcoatF0 = vec3( 0.04 );\n	material.clearcoatF90 = 1.0;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n	material.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	material.iridescence = iridescence;\n	material.iridescenceIOR = iridescenceIOR;\n	#ifdef USE_IRIDESCENCEMAP\n		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n	#endif\n	#ifdef USE_IRIDESCENCE_THICKNESSMAP\n		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n	#else\n		material.iridescenceThickness = iridescenceThicknessMaximum;\n	#endif\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheenColor;\n	#ifdef USE_SHEEN_COLORMAP\n		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n	#endif\n	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	#ifdef USE_ANISOTROPYMAP\n		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n	#else\n		vec2 anisotropyV = anisotropyVector;\n	#endif\n	material.anisotropy = length( anisotropyV );\n	if( material.anisotropy == 0.0 ) {\n		anisotropyV = vec2( 1.0, 0.0 );\n	} else {\n		anisotropyV /= material.anisotropy;\n		material.anisotropy = saturate( material.anisotropy );\n	}\n	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n	float dispersion;\n	#ifdef USE_CLEARCOAT\n		float clearcoat;\n		float clearcoatRoughness;\n		vec3 clearcoatF0;\n		float clearcoatF90;\n	#endif\n	#ifdef USE_IRIDESCENCE\n		float iridescence;\n		float iridescenceIOR;\n		float iridescenceThickness;\n		vec3 iridescenceFresnel;\n		vec3 iridescenceF0;\n	#endif\n	#ifdef USE_SHEEN\n		vec3 sheenColor;\n		float sheenRoughness;\n	#endif\n	#ifdef IOR\n		float ior;\n	#endif\n	#ifdef USE_TRANSMISSION\n		float transmission;\n		float transmissionAlpha;\n		float thickness;\n		float attenuationDistance;\n		vec3 attenuationColor;\n	#endif\n	#ifdef USE_ANISOTROPY\n		float anisotropy;\n		float alphaT;\n		vec3 anisotropyT;\n		vec3 anisotropyB;\n	#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n		float v = 0.5 / ( gv + gl );\n		return saturate(v);\n	}\n	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n		float a2 = alphaT * alphaB;\n		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n		highp float v2 = dot( v, v );\n		float w2 = a2 / v2;\n		return RECIPROCAL_PI * a2 * pow2 ( w2 );\n	}\n#endif\n#ifdef USE_CLEARCOAT\n	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n		vec3 f0 = material.clearcoatF0;\n		float f90 = material.clearcoatF90;\n		float roughness = material.clearcoatRoughness;\n		float alpha = pow2( roughness );\n		vec3 halfDir = normalize( lightDir + viewDir );\n		float dotNL = saturate( dot( normal, lightDir ) );\n		float dotNV = saturate( dot( normal, viewDir ) );\n		float dotNH = saturate( dot( normal, halfDir ) );\n		float dotVH = saturate( dot( viewDir, halfDir ) );\n		vec3 F = F_Schlick( f0, f90, dotVH );\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n		return F * ( V * D );\n	}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n	vec3 f0 = material.specularColor;\n	float f90 = material.specularF90;\n	float roughness = material.roughness;\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( f0, f90, dotVH );\n	#ifdef USE_IRIDESCENCE\n		F = mix( F, material.iridescenceFresnel, material.iridescence );\n	#endif\n	#ifdef USE_ANISOTROPY\n		float dotTL = dot( material.anisotropyT, lightDir );\n		float dotTV = dot( material.anisotropyT, viewDir );\n		float dotTH = dot( material.anisotropyT, halfDir );\n		float dotBL = dot( material.anisotropyB, lightDir );\n		float dotBV = dot( material.anisotropyB, viewDir );\n		float dotBH = dot( material.anisotropyB, halfDir );\n		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n	#else\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n	#endif\n	return F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n	float alpha = pow2( roughness );\n	float invAlpha = 1.0 / alpha;\n	float cos2h = dotNH * dotNH;\n	float sin2h = max( 1.0 - cos2h, 0.0078125 );\n	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float D = D_Charlie( sheenRoughness, dotNH );\n	float V = V_Neubelt( dotNV, dotNL );\n	return sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float r2 = roughness * roughness;\n	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n	return saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n	return fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	return specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	#ifdef USE_IRIDESCENCE\n		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n	#else\n		vec3 Fr = specularColor;\n	#endif\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometryNormal;\n		vec3 viewDir = geometryViewDir;\n		vec3 position = geometryPosition;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.roughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifdef USE_CLEARCOAT\n		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = dotNLcc * directLight.color;\n		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef USE_CLEARCOAT\n		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n	#endif\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	#ifdef USE_IRIDESCENCE\n		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n	#else\n		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n	#endif\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n	geometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n	float dotNVi = saturate( dot( normal, geometryViewDir ) );\n	if ( material.iridescenceThickness == 0.0 ) {\n		material.iridescence = 0.0;\n	} else {\n		material.iridescence = saturate( material.iridescence );\n	}\n	if ( material.iridescence > 0.0 ) {\n		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n	}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointLightInfo( pointLight, geometryPosition, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	vec4 spotColor;\n	vec3 spotLightCoord;\n	bool inSpotLightMap;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotLightInfo( spotLight, geometryPosition, directLight );\n		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n		#else\n		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#endif\n		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n		#endif\n		#undef SPOT_LIGHT_MAP_INDEX\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalLightInfo( directionalLight, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#if defined( USE_LIGHT_PROBES )\n		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getIBLIrradiance( geometryNormal );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	#ifdef USE_ANISOTROPY\n		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n	#else\n		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n	#endif\n	#ifdef USE_CLEARCOAT\n		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n	vFragDepth = 1.0 + gl_Position.w;\n	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 sampledDiffuseColor = texture2D( map, vMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n	#endif\n	diffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	#if defined( USE_POINTS_UV )\n		vec2 uv = vUv;\n	#else\n		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n	#endif\n#endif\n#ifdef USE_MAP\n	diffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n	varying vec2 vUv;\n#else\n	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n		uniform mat3 uvTransform;\n	#endif\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n	float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n	}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n	vColor *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		#if defined( USE_COLOR_ALPHA )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n		#elif defined( USE_COLOR )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n		#endif\n	}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	#ifndef USE_INSTANCING_MORPH\n		uniform float morphTargetBaseInfluence;\n		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	#endif\n	uniform sampler2DArray morphTargetsTexture;\n	uniform ivec2 morphTargetsTextureSize;\n	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n		int y = texelIndex / morphTargetsTextureSize.x;\n		int x = texelIndex - y * morphTargetsTextureSize.x;\n		ivec3 morphUV = ivec3( x, y, morphTargetIndex );\n		return texelFetch( morphTargetsTexture, morphUV, 0 );\n	}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal *= faceDirection;\n	#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n	#ifdef USE_TANGENT\n		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn = getTangentFrame( - vViewPosition, normal,\n		#if defined( USE_NORMALMAP )\n			vNormalMapUv\n		#elif defined( USE_CLEARCOAT_NORMALMAP )\n			vClearcoatNormalMapUv\n		#else\n			vUv\n		#endif\n		);\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn[0] *= faceDirection;\n		tbn[1] *= faceDirection;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	#ifdef USE_TANGENT\n		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn2[0] *= faceDirection;\n		tbn2[1] *= faceDirection;\n	#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	normal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( uv.st );\n		vec2 st1 = dFdy( uv.st );\n		vec3 N = surf_norm;\n		vec3 q1perp = cross( q1, N );\n		vec3 q0perp = cross( N, q0 );\n		vec3 T = q1perp * st0.x + q0perp * st1.x;\n		vec3 B = q1perp * st0.y + q0perp * st1.y;\n		float det = max( dot( T, T ), dot( B, B ) );\n		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n		return mat3( T * scale, B * scale, N );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n	vec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	clearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n	uniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n	if( v <= 0.0 )\n		return vec4( 0., 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec4( 1., 1., 1., 1. );\n	float vuf;\n	float af = modf( v * PackFactors.a, vuf );\n	float bf = modf( vuf * ShiftRight8, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n	if( v <= 0.0 )\n		return vec3( 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec3( 1., 1., 1. );\n	float vuf;\n	float bf = modf( v * PackFactors.b, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n	if( v <= 0.0 )\n		return vec2( 0., 0. );\n	if( v >= 1.0 )\n		return vec2( 1., 1. );\n	float vuf;\n	float gf = modf( v * 256., vuf );\n	return vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n	return dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n	mvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n						  f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n						  f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		float shadow = 1.0;\n		vec3 lightToPosition = shadowCoord.xyz;\n		\n		float lightToPositionLength = length( lightToPosition );\n		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;\n			vec3 bd3D = normalize( lightToPosition );\n			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n				shadow = (\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n				) * ( 1.0 / 9.0 );\n			#else\n				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n			#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n	vec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n		shadowWorldPosition = worldPosition;\n		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n		#endif\n		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	uniform highp sampler2D boneTexture;\n	mat4 getBoneMatrix( const in float i ) {\n		int size = textureSize( boneTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,  1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n	vec3( 1.6605, - 0.1246, - 0.0182 ),\n	vec3( - 0.5876, 1.1329, - 0.1006 ),\n	vec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n	vec3( 0.6274, 0.0691, 0.0164 ),\n	vec3( 0.3293, 0.9195, 0.0880 ),\n	vec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n	vec3 x2 = x * x;\n	vec3 x4 = x2 * x2;\n	return + 15.5 * x4 * x2\n		- 40.14 * x4 * x\n		+ 31.96 * x4\n		- 6.868 * x2 * x\n		+ 0.4298 * x2\n		+ 0.1191 * x\n		- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n	const mat3 AgXInsetMatrix = mat3(\n		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n	);\n	const mat3 AgXOutsetMatrix = mat3(\n		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n	);\n	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;\n	color *= toneMappingExposure;\n	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n	color = AgXInsetMatrix * color;\n	color = max( color, 1e-10 );	color = log2( color );\n	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n	color = clamp( color, 0.0, 1.0 );\n	color = agxDefaultContrastApprox( color );\n	color = AgXOutsetMatrix * color;\n	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n	color = clamp( color, 0.0, 1.0 );\n	return color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n	const float StartCompression = 0.8 - 0.04;\n	const float Desaturation = 0.15;\n	color *= toneMappingExposure;\n	float x = min( color.r, min( color.g, color.b ) );\n	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n	color -= offset;\n	float peak = max( color.r, max( color.g, color.b ) );\n	if ( peak < StartCompression ) return color;\n	float d = 1. - StartCompression;\n	float newPeak = 1. - d * d / ( peak + d - StartCompression );\n	color *= newPeak / peak;\n	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n	return mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n	material.transmission = transmission;\n	material.transmissionAlpha = 1.0;\n	material.thickness = thickness;\n	material.attenuationDistance = attenuationDistance;\n	material.attenuationColor = attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n	#endif\n	vec3 pos = vWorldPosition;\n	vec3 v = normalize( cameraPosition - pos );\n	vec3 n = inverseTransformDirection( normal, viewMatrix );\n	vec4 transmitted = getIBLVolumeRefraction(\n		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n		material.attenuationColor, material.attenuationDistance );\n	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n	uniform float transmission;\n	uniform float thickness;\n	uniform float attenuationDistance;\n	uniform vec3 attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		uniform sampler2D transmissionMap;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		uniform sampler2D thicknessMap;\n	#endif\n	uniform vec2 transmissionSamplerSize;\n	uniform sampler2D transmissionSamplerMap;\n	uniform mat4 modelMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec3 vWorldPosition;\n	float w0( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n	}\n	float w1( float a ) {\n		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n	}\n	float w2( float a ){\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n	}\n	float w3( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * a * a );\n	}\n	float g0( float a ) {\n		return w0( a ) + w1( a );\n	}\n	float g1( float a ) {\n		return w2( a ) + w3( a );\n	}\n	float h0( float a ) {\n		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n	}\n	float h1( float a ) {\n		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n	}\n	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n		uv = uv * texelSize.zw + 0.5;\n		vec2 iuv = floor( uv );\n		vec2 fuv = fract( uv );\n		float g0x = g0( fuv.x );\n		float g1x = g1( fuv.x );\n		float h0x = h0( fuv.x );\n		float h1x = h1( fuv.x );\n		float h0y = h0( fuv.y );\n		float h1y = h1( fuv.y );\n		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n	}\n	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n		vec2 fLodSizeInv = 1.0 / fLodSize;\n		vec2 cLodSizeInv = 1.0 / cLodSize;\n		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n		return mix( fSample, cSample, fract( lod ) );\n	}\n	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n		vec3 modelScale;\n		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n		return normalize( refractionVector ) * thickness * modelScale;\n	}\n	float applyIorToRoughness( const in float roughness, const in float ior ) {\n		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n	}\n	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n	}\n	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n		if ( isinf( attenuationDistance ) ) {\n			return vec3( 1.0 );\n		} else {\n			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;\n		}\n	}\n	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n		const in vec3 attenuationColor, const in float attenuationDistance ) {\n		vec4 transmittedLight;\n		vec3 transmittance;\n		#ifdef USE_DISPERSION\n			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n			for ( int i = 0; i < 3; i ++ ) {\n				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n				vec3 refractedRayExit = position + transmissionRay;\n		\n				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n				vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n				refractionCoords += 1.0;\n				refractionCoords /= 2.0;\n		\n				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n				transmittedLight[ i ] = transmissionSample[ i ];\n				transmittedLight.a += transmissionSample.a;\n				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n			}\n			transmittedLight.a /= 3.0;\n		\n		#else\n		\n			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n			vec3 refractedRayExit = position + transmissionRay;\n			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n			vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n			refractionCoords += 1.0;\n			refractionCoords /= 2.0;\n			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n		\n		#endif\n		vec3 attenuatedColor = transmittance * transmittedLight.rgb;\n		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n	}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	uniform mat3 mapTransform;\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform mat3 alphaMapTransform;\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	uniform mat3 lightMapTransform;\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	uniform mat3 aoMapTransform;\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	uniform mat3 bumpMapTransform;\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	uniform mat3 normalMapTransform;\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	uniform mat3 displacementMapTransform;\n	varying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	uniform mat3 emissiveMapTransform;\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	uniform mat3 metalnessMapTransform;\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	uniform mat3 roughnessMapTransform;\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	uniform mat3 anisotropyMapTransform;\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	uniform mat3 clearcoatMapTransform;\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform mat3 clearcoatNormalMapTransform;\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform mat3 clearcoatRoughnessMapTransform;\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	uniform mat3 sheenColorMapTransform;\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	uniform mat3 sheenRoughnessMapTransform;\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	uniform mat3 iridescenceMapTransform;\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform mat3 iridescenceThicknessMapTransform;\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	uniform mat3 specularMapTransform;\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	uniform mat3 specularColorMapTransform;\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	uniform mat3 specularIntensityMapTransform;\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	vUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_BATCHING\n		worldPosition = batchingMatrix * worldPosition;\n	#endif\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n	uniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n	uniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n	#else\n		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n	gl_FragColor = texColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#elif DEPTH_PACKING == 3202\n		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n	#elif DEPTH_PACKING == 3203\n		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n	#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinbase_vertex>\n		#include <skinnormal_vertex>\n		#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_lambert_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n	#else\n		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n	#ifdef OPAQUE\n		gl_FragColor.a = 1.0;\n	#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n	varying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n	vWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define IOR\n	#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n	uniform float ior;\n#endif\n#ifdef USE_SPECULAR\n	uniform float specularIntensity;\n	uniform vec3 specularColor;\n	#ifdef USE_SPECULAR_COLORMAP\n		uniform sampler2D specularColorMap;\n	#endif\n	#ifdef USE_SPECULAR_INTENSITYMAP\n		uniform sampler2D specularIntensityMap;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n	uniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	uniform float iridescence;\n	uniform float iridescenceIOR;\n	uniform float iridescenceThicknessMinimum;\n	uniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheenColor;\n	uniform float sheenRoughness;\n	#ifdef USE_SHEEN_COLORMAP\n		uniform sampler2D sheenColorMap;\n	#endif\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		uniform sampler2D sheenRoughnessMap;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	uniform vec2 anisotropyVector;\n	#ifdef USE_ANISOTROPYMAP\n		uniform sampler2D anisotropyMap;\n	#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n	#include <transmission_fragment>\n	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n	#ifdef USE_SHEEN\n		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n	#endif\n	#ifdef USE_CLEARCOAT\n		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n	#endif\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n	varying vec2 vUv;\n	uniform mat3 uvTransform;\n#endif\nvoid main() {\n	#ifdef USE_POINTS_UV\n		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	#endif\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	#include <logdepthbuf_fragment>\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix[ 3 ];\n	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}"},a={common:{diffuse:{value:new i.Ilk(0xffffff)},opacity:{value:1},map:{value:null},mapTransform:{value:new i.Vkp},alphaMap:{value:null},alphaMapTransform:{value:new i.Vkp},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new i.Vkp}},envmap:{envMap:{value:null},envMapRotation:{value:new i.Vkp},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new i.Vkp}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new i.Vkp}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new i.Vkp},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new i.Vkp},normalScale:{value:new i.FM8(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new i.Vkp},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new i.Vkp}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new i.Vkp}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new i.Vkp}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new i.Ilk(0xffffff)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new i.Ilk(0xffffff)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new i.Vkp},alphaTest:{value:0},uvTransform:{value:new i.Vkp}},sprite:{diffuse:{value:new i.Ilk(0xffffff)},opacity:{value:1},center:{value:new i.FM8(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new i.Vkp},alphaMap:{value:null},alphaMapTransform:{value:new i.Vkp},alphaTest:{value:0}}},l={basic:{uniforms:(0,i.Rhp)([a.common,a.specularmap,a.envmap,a.aomap,a.lightmap,a.fog]),vertexShader:o.meshbasic_vert,fragmentShader:o.meshbasic_frag},lambert:{uniforms:(0,i.Rhp)([a.common,a.specularmap,a.envmap,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.fog,a.lights,{emissive:{value:new i.Ilk(0)}}]),vertexShader:o.meshlambert_vert,fragmentShader:o.meshlambert_frag},phong:{uniforms:(0,i.Rhp)([a.common,a.specularmap,a.envmap,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.fog,a.lights,{emissive:{value:new i.Ilk(0)},specular:{value:new i.Ilk(1118481)},shininess:{value:30}}]),vertexShader:o.meshphong_vert,fragmentShader:o.meshphong_frag},standard:{uniforms:(0,i.Rhp)([a.common,a.envmap,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.roughnessmap,a.metalnessmap,a.fog,a.lights,{emissive:{value:new i.Ilk(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:o.meshphysical_vert,fragmentShader:o.meshphysical_frag},toon:{uniforms:(0,i.Rhp)([a.common,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.gradientmap,a.fog,a.lights,{emissive:{value:new i.Ilk(0)}}]),vertexShader:o.meshtoon_vert,fragmentShader:o.meshtoon_frag},matcap:{uniforms:(0,i.Rhp)([a.common,a.bumpmap,a.normalmap,a.displacementmap,a.fog,{matcap:{value:null}}]),vertexShader:o.meshmatcap_vert,fragmentShader:o.meshmatcap_frag},points:{uniforms:(0,i.Rhp)([a.points,a.fog]),vertexShader:o.points_vert,fragmentShader:o.points_frag},dashed:{uniforms:(0,i.Rhp)([a.common,a.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:o.linedashed_vert,fragmentShader:o.linedashed_frag},depth:{uniforms:(0,i.Rhp)([a.common,a.displacementmap]),vertexShader:o.depth_vert,fragmentShader:o.depth_frag},normal:{uniforms:(0,i.Rhp)([a.common,a.bumpmap,a.normalmap,a.displacementmap,{opacity:{value:1}}]),vertexShader:o.meshnormal_vert,fragmentShader:o.meshnormal_frag},sprite:{uniforms:(0,i.Rhp)([a.sprite,a.fog]),vertexShader:o.sprite_vert,fragmentShader:o.sprite_frag},background:{uniforms:{uvTransform:{value:new i.Vkp},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:o.background_vert,fragmentShader:o.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new i.Vkp}},vertexShader:o.backgroundCube_vert,fragmentShader:o.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:o.cube_vert,fragmentShader:o.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:o.equirect_vert,fragmentShader:o.equirect_frag},distanceRGBA:{uniforms:(0,i.Rhp)([a.common,a.displacementmap,{referencePosition:{value:new i.Pa4},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:o.distanceRGBA_vert,fragmentShader:o.distanceRGBA_frag},shadow:{uniforms:(0,i.Rhp)([a.lights,a.fog,{color:{value:new i.Ilk(0)},opacity:{value:1}}]),vertexShader:o.shadow_vert,fragmentShader:o.shadow_frag}};l.physical={uniforms:(0,i.Rhp)([l.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new i.Vkp},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new i.Vkp},clearcoatNormalScale:{value:new i.FM8(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new i.Vkp},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new i.Vkp},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new i.Vkp},sheen:{value:0},sheenColor:{value:new i.Ilk(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new i.Vkp},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new i.Vkp},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new i.Vkp},transmissionSamplerSize:{value:new i.FM8},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new i.Vkp},attenuationDistance:{value:0},attenuationColor:{value:new i.Ilk(0)},specularColor:{value:new i.Ilk(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new i.Vkp},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new i.Vkp},anisotropyVector:{value:new i.FM8},anisotropyMap:{value:null},anisotropyMapTransform:{value:new i.Vkp}}]),vertexShader:o.meshphysical_vert,fragmentShader:o.meshphysical_frag};let h={r:0,b:0,g:0},u=new i.USm,c=new i.yGw;function d(e,t,r,n,s,o,a){let d,f;let p=new i.Ilk(0),g=!0===o?0:1,m=null,v=0,b=null;function y(e){let i=!0===e.isScene?e.background:null;return i&&i.isTexture&&(i=(e.backgroundBlurriness>0?r:t).get(i)),i}function x(t,r){t.getRGB(h,(0,i.oDz)(e)),n.buffers.color.setClear(h.r,h.g,h.b,r,a)}return{getClearColor:function(){return p},setClearColor:function(e,t=1){p.set(e),x(p,g=t)},getClearAlpha:function(){return g},setClearAlpha:function(e){x(p,g=e)},render:function(t){let r=!1,i=y(t);null===i?x(p,g):i&&i.isColor&&(x(i,1),r=!0);let s=e.xr.getEnvironmentBlendMode();"additive"===s?n.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===s&&n.buffers.color.setClear(0,0,0,0,a),(e.autoClear||r)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,r){let n=y(r);n&&(n.isCubeTexture||n.mapping===i.g8_)?(void 0===f&&((f=new i.Kj0(new i.DvJ(1,1,1),new i.jyz({name:"BackgroundCubeMaterial",uniforms:(0,i.dwf)(l.backgroundCube.uniforms),vertexShader:l.backgroundCube.vertexShader,fragmentShader:l.backgroundCube.fragmentShader,side:i._Li,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(f)),u.copy(r.backgroundRotation),u.x*=-1,u.y*=-1,u.z*=-1,n.isCubeTexture&&!1===n.isRenderTargetTexture&&(u.y*=-1,u.z*=-1),f.material.uniforms.envMap.value=n,f.material.uniforms.flipEnvMap.value=n.isCubeTexture&&!1===n.isRenderTargetTexture?-1:1,f.material.uniforms.backgroundBlurriness.value=r.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=r.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(c.makeRotationFromEuler(u)),f.material.toneMapped=i.epp.getTransfer(n.colorSpace)!==i.j17,(m!==n||v!==n.version||b!==e.toneMapping)&&(f.material.needsUpdate=!0,m=n,v=n.version,b=e.toneMapping),f.layers.enableAll(),t.unshift(f,f.geometry,f.material,0,0,null)):n&&n.isTexture&&(void 0===d&&((d=new i.Kj0(new i._12(2,2),new i.jyz({name:"BackgroundMaterial",uniforms:(0,i.dwf)(l.background.uniforms),vertexShader:l.background.vertexShader,fragmentShader:l.background.fragmentShader,side:i.Wl3,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(d)),d.material.uniforms.t2D.value=n,d.material.uniforms.backgroundIntensity.value=r.backgroundIntensity,d.material.toneMapped=i.epp.getTransfer(n.colorSpace)!==i.j17,!0===n.matrixAutoUpdate&&n.updateMatrix(),d.material.uniforms.uvTransform.value.copy(n.matrix),(m!==n||v!==n.version||b!==e.toneMapping)&&(d.material.needsUpdate=!0,m=n,v=n.version,b=e.toneMapping),d.layers.enableAll(),t.unshift(d,d.geometry,d.material,0,0,null))},dispose:function(){void 0!==f&&(f.geometry.dispose(),f.material.dispose()),void 0!==d&&(d.geometry.dispose(),d.material.dispose())}}}function f(e,t){let r=e.getParameter(e.MAX_VERTEX_ATTRIBS),n={},s=u(null),o=s,a=!1;function l(t){return e.bindVertexArray(t)}function h(t){return e.deleteVertexArray(t)}function u(e){let t=[],i=[],n=[];for(let e=0;e<r;e++)t[e]=0,i[e]=0,n[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:n,object:e,attributes:{},index:null}}function c(){let e=o.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function d(e){f(e,0)}function f(t,r){let i=o.newAttributes,n=o.enabledAttributes,s=o.attributeDivisors;i[t]=1,0===n[t]&&(e.enableVertexAttribArray(t),n[t]=1),s[t]!==r&&(e.vertexAttribDivisor(t,r),s[t]=r)}function p(){let t=o.newAttributes,r=o.enabledAttributes;for(let i=0,n=r.length;i<n;i++)r[i]!==t[i]&&(e.disableVertexAttribArray(i),r[i]=0)}function g(t,r,i,n,s,o,a){!0===a?e.vertexAttribIPointer(t,r,i,s,o):e.vertexAttribPointer(t,r,i,n,s,o)}function m(){v(),a=!0,o!==s&&l((o=s).object)}function v(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:function(r,s,h,m,v){let b=!1,y=function(t,r,i){let s=!0===i.wireframe,o=n[t.id];void 0===o&&(o={},n[t.id]=o);let a=o[r.id];void 0===a&&(a={},o[r.id]=a);let l=a[s];return void 0===l&&(l=u(e.createVertexArray()),a[s]=l),l}(m,h,s);o!==y&&l((o=y).object),(b=function(e,t,r,i){let n=o.attributes,s=t.attributes,a=0,l=r.getAttributes();for(let t in l)if(l[t].location>=0){let r=n[t],i=s[t];if(void 0===i&&("instanceMatrix"===t&&e.instanceMatrix&&(i=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(i=e.instanceColor)),void 0===r||r.attribute!==i||i&&r.data!==i.data)return!0;a++}return o.attributesNum!==a||o.index!==i||!1}(r,m,h,v))&&function(e,t,r,i){let n={},s=t.attributes,a=0,l=r.getAttributes();for(let t in l)if(l[t].location>=0){let r=s[t];void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor));let i={};i.attribute=r,r&&r.data&&(i.data=r.data),n[t]=i,a++}o.attributes=n,o.attributesNum=a,o.index=i}(r,m,h,v),null!==v&&t.update(v,e.ELEMENT_ARRAY_BUFFER),(b||a)&&(a=!1,function(r,n,s,o){c();let a=o.attributes,l=s.getAttributes(),h=n.defaultAttributeValues;for(let n in l){let s=l[n];if(s.location>=0){let l=a[n];if(void 0===l&&("instanceMatrix"===n&&r.instanceMatrix&&(l=r.instanceMatrix),"instanceColor"===n&&r.instanceColor&&(l=r.instanceColor)),void 0!==l){let n=l.normalized,a=l.itemSize,h=t.get(l);if(void 0===h)continue;let u=h.buffer,c=h.type,p=h.bytesPerElement,m=c===e.INT||c===e.UNSIGNED_INT||l.gpuType===i.Kz5;if(l.isInterleavedBufferAttribute){let t=l.data,i=t.stride,h=l.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<s.locationSize;e++)f(s.location+e,t.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<s.locationSize;e++)d(s.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<s.locationSize;e++)g(s.location+e,a/s.locationSize,c,n,i*p,(h+a/s.locationSize*e)*p,m)}else{if(l.isInstancedBufferAttribute){for(let e=0;e<s.locationSize;e++)f(s.location+e,l.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=l.meshPerAttribute*l.count)}else for(let e=0;e<s.locationSize;e++)d(s.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<s.locationSize;e++)g(s.location+e,a/s.locationSize,c,n,a*p,a/s.locationSize*e*p,m)}}else if(void 0!==h){let t=h[n];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(s.location,t);break;case 3:e.vertexAttrib3fv(s.location,t);break;case 4:e.vertexAttrib4fv(s.location,t);break;default:e.vertexAttrib1fv(s.location,t)}}}}p()}(r,s,h,m),null!==v&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(v).buffer))},reset:m,resetDefaultState:v,dispose:function(){for(let e in m(),n){let t=n[e];for(let e in t){let r=t[e];for(let e in r)h(r[e].object),delete r[e];delete t[e]}delete n[e]}},releaseStatesOfGeometry:function(e){if(void 0===n[e.id])return;let t=n[e.id];for(let e in t){let r=t[e];for(let e in r)h(r[e].object),delete r[e];delete t[e]}delete n[e.id]},releaseStatesOfProgram:function(e){for(let t in n){let r=n[t];if(void 0===r[e.id])continue;let i=r[e.id];for(let e in i)h(i[e].object),delete i[e];delete r[e.id]}},initAttributes:c,enableAttribute:d,disableUnusedAttributes:p}}function p(e,t,r){let i;function n(t,n,s){0!==s&&(e.drawArraysInstanced(i,t,n,s),r.update(n,i,s))}this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i,1)},this.renderInstances=n,this.renderMultiDraw=function(e,n,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,e,0,n,0,s);let o=0;for(let e=0;e<s;e++)o+=n[e];r.update(o,i,1)},this.renderMultiDrawInstances=function(e,s,o,a){if(0===o)return;let l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)n(e[t],s[t],a[t]);else{l.multiDrawArraysInstancedWEBGL(i,e,0,s,0,a,0,o);let t=0;for(let e=0;e<o;e++)t+=s[e]*a[e];r.update(t,i,1)}}}function g(e,t,r,n){let s;function o(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==r.precision?r.precision:"highp",l=o(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let h=!0===r.logarithmicDepthBuffer,u=!0===r.reverseDepthBuffer&&t.has("EXT_clip_control"),c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=e.getParameter(e.MAX_TEXTURE_SIZE),p=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),g=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),v=e.getParameter(e.MAX_VARYING_VECTORS),b=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==s)return s;if(!0===t.has("EXT_texture_filter_anisotropic")){let r=t.get("EXT_texture_filter_anisotropic");s=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s},getMaxPrecision:o,textureFormatReadable:function(t){return(t===i.wk1||n.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT))&&!0},textureTypeReadable:function(r){let s=r===i.cLu&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return r===i.ywz||n.convert(r)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)||r===i.VzW||!!s||!1},precision:a,logarithmicDepthBuffer:h,reverseDepthBuffer:u,maxTextures:c,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:b,vertexTextures:d>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function m(e){let t=this,r=null,n=0,s=!1,o=!1,a=new i.JOQ,l=new i.Vkp,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let r=0!==e.length||t||0!==n||s;return s=t,n=e.length,r},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(e,t){r=u(e,t,0)},this.setState=function(i,a,l){let c=i.clippingPlanes,d=i.clipIntersection,f=i.clipShadows,p=e.get(i);if(s&&null!==c&&0!==c.length&&(!o||f)){let e=o?0:n,t=4*e,i=p.clippingState||null;h.value=i,i=u(c,a,t,l);for(let e=0;e!==t;++e)i[e]=r[e];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}else o?u(null):function(){h.value!==r&&(h.value=r,h.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}()};function u(e,r,i,n){let s=null!==e?e.length:0,o=null;if(0!==s){if(o=h.value,!0!==n||null===o){let t=i+4*s,n=r.matrixWorldInverse;l.getNormalMatrix(n),(null===o||o.length<t)&&(o=new Float32Array(t));for(let t=0,r=i;t!==s;++t,r+=4)a.copy(e[t]).applyMatrix4(n,l),a.normal.toArray(o,r),o[r+3]=a.constant}h.value=o,h.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,o}}function v(e){let t=new WeakMap;function r(e,t){return t===i.dSO?e.mapping=i.fY$:t===i.Bf4&&(e.mapping=i.vxC),e}function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(s){if(s&&s.isTexture){let o=s.mapping;if(o===i.dSO||o===i.Bf4){if(t.has(s))return r(t.get(s).texture,s.mapping);{let o=s.image;if(!o||!(o.height>0))return null;{let a=new i.oAp(o.height);return a.fromEquirectangularTexture(e,s),t.set(s,a),s.addEventListener("dispose",n),r(a.texture,s.mapping)}}}}return s},dispose:function(){t=new WeakMap}}}let b=[.125,.215,.35,.446,.526,.582],y=new i.iKG,x=new i.Ilk,_=null,S=0,w=0,T=!1,P=(1+Math.sqrt(5))/2,E=1/P,C=[new i.Pa4(-P,E,0),new i.Pa4(P,E,0),new i.Pa4(-E,0,P),new i.Pa4(E,0,P),new i.Pa4(0,P,-E),new i.Pa4(0,P,E),new i.Pa4(-1,1,-1),new i.Pa4(1,1,-1),new i.Pa4(-1,1,1),new i.Pa4(1,1,1)];class A{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){_=this._renderer.getRenderTarget(),S=this._renderer.getActiveCubeFace(),w=this._renderer.getActiveMipmapLevel(),T=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=O(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=R(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_,S,w),this._renderer.xr.enabled=T,e.scissorTest=!1,M(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===i.fY$||e.mapping===i.vxC?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),_=this._renderer.getRenderTarget(),S=this._renderer.getActiveCubeFace(),w=this._renderer.getActiveMipmapLevel(),T=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:i.wem,minFilter:i.wem,generateMipmaps:!1,type:i.cLu,format:i.wk1,colorSpace:i.GUF,depthBuffer:!1},n=I(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=I(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){let t=[],r=[],n=[],s=e,o=e-4+1+b.length;for(let a=0;a<o;a++){let o=Math.pow(2,s);r.push(o);let l=1/o;a>e-4?l=b[a-e+4-1]:0===a&&(l=0),n.push(l);let h=1/(o-2),u=-h,c=1+h,d=[u,u,c,u,c,c,u,u,c,c,u,c],f=new Float32Array(108),p=new Float32Array(72),g=new Float32Array(36);for(let e=0;e<6;e++){let t=e%3*2/3-1,r=e>2?0:-1,i=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];f.set(i,18*e),p.set(d,12*e);let n=[e,e,e,e,e,e];g.set(n,6*e)}let m=new i.u9r;m.setAttribute("position",new i.TlE(f,3)),m.setAttribute("uv",new i.TlE(p,2)),m.setAttribute("faceIndex",new i.TlE(g,1)),t.push(m),s>4&&s--}return{lodPlanes:t,sizeLods:r,sigmas:n}}(n)),this._blurMaterial=function(e,t,r){let n=new Float32Array(20),s=new i.Pa4(0,1,0);return new i.jyz({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:k(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:i.jFi,depthTest:!1,depthWrite:!1})}(n,e,t)}return n}_compileMaterial(e){let t=new i.Kj0(this._lodPlanes[0],e);this._renderer.compile(t,y)}_sceneToCubeUV(e,t,r,n){let s=new i.cPb(90,1,t,r),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],l=this._renderer,h=l.autoClear,u=l.toneMapping;l.getClearColor(x),l.toneMapping=i.uL9,l.autoClear=!1;let c=new i.vBJ({name:"PMREM.Background",side:i._Li,depthWrite:!1,depthTest:!1}),d=new i.Kj0(new i.DvJ,c),f=!1,p=e.background;p?p.isColor&&(c.color.copy(p),e.background=null,f=!0):(c.color.copy(x),f=!0);for(let t=0;t<6;t++){let r=t%3;0===r?(s.up.set(0,o[t],0),s.lookAt(a[t],0,0)):1===r?(s.up.set(0,0,o[t]),s.lookAt(0,a[t],0)):(s.up.set(0,o[t],0),s.lookAt(0,0,a[t]));let i=this._cubeSize;M(n,r*i,t>2?i:0,i,i),l.setRenderTarget(n),f&&l.render(d,s),l.render(e,s)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=u,l.autoClear=h,e.background=p}_textureToCubeUV(e,t){let r=this._renderer,n=e.mapping===i.fY$||e.mapping===i.vxC;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=O()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=R());let s=n?this._cubemapMaterial:this._equirectMaterial,o=new i.Kj0(this._lodPlanes[0],s);s.uniforms.envMap.value=e;let a=this._cubeSize;M(t,0,0,3*a,2*a),r.setRenderTarget(t),r.render(o,y)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;let i=this._lodPlanes.length;for(let t=1;t<i;t++){let r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),n=C[(i-t-1)%C.length];this._blur(e,t-1,t,r,n)}t.autoClear=r}_blur(e,t,r,i,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,n,s,o,a){let l=this._renderer,h=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");let u=new i.Kj0(this._lodPlanes[n],h),c=h.uniforms,d=this._sizeLods[r]-1,f=isFinite(s)?Math.PI/(2*d):2*Math.PI/39,p=s/f,g=isFinite(s)?1+Math.floor(3*p):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);let m=[],v=0;for(let e=0;e<20;++e){let t=e/p,r=Math.exp(-t*t/2);m.push(r),0===e?v+=r:e<g&&(v+=2*r)}for(let e=0;e<m.length;e++)m[e]=m[e]/v;c.envMap.value=e.texture,c.samples.value=g,c.weights.value=m,c.latitudinal.value="latitudinal"===o,a&&(c.poleAxis.value=a);let{_lodMax:b}=this;c.dTheta.value=f,c.mipInt.value=b-r;let x=this._sizeLods[n],_=4*(this._cubeSize-x);M(t,3*x*(n>b-4?n-b+4:0),_,3*x,2*x),l.setRenderTarget(t),l.render(u,y)}}function I(e,t,r){let n=new i.dd2(e,t,r);return n.texture.mapping=i.g8_,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function M(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function R(){return new i.jyz({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:k(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:i.jFi,depthTest:!1,depthWrite:!1})}function O(){return new i.jyz({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:k(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:i.jFi,depthTest:!1,depthWrite:!1})}function k(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function N(e){let t=new WeakMap,r=null;function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(s){if(s&&s.isTexture){let o=s.mapping,a=o===i.dSO||o===i.Bf4,l=o===i.fY$||o===i.vxC;if(a||l){let i=t.get(s),o=void 0!==i?i.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==o)return null===r&&(r=new A(e)),(i=a?r.fromEquirectangular(s,i):r.fromCubemap(s,i)).texture.pmremVersion=s.pmremVersion,t.set(s,i),i.texture;if(void 0!==i)return i.texture;{let o=s.image;return a&&o&&o.height>0||l&&o&&function(e){let t=0;for(let r=0;r<6;r++)void 0!==e[r]&&t++;return 6===t}(o)?(null===r&&(r=new A(e)),(i=a?r.fromEquirectangular(s):r.fromCubemap(s)).texture.pmremVersion=s.pmremVersion,t.set(s,i),s.addEventListener("dispose",n),i.texture):null}}}return s},dispose:function(){t=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function L(e){let t={};function r(r){let i;if(void 0!==t[r])return t[r];switch(r){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(r)}return t[r]=i,i}return{has:function(e){return null!==r(e)},init:function(){r("EXT_color_buffer_float"),r("WEBGL_clip_cull_distance"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture"),r("WEBGL_render_shared_exponent")},get:function(e){let t=r(e);return null===t&&(0,i.O4K)("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function D(e,t,r,n){let s={},o=new WeakMap;function a(e){let i=e.target;for(let e in null!==i.index&&t.remove(i.index),i.attributes)t.remove(i.attributes[e]);i.removeEventListener("dispose",a),delete s[i.id];let l=o.get(i);l&&(t.remove(l),o.delete(i)),n.releaseStatesOfGeometry(i),!0===i.isInstancedBufferGeometry&&delete i._maxInstanceCount,r.memory.geometries--}function l(e){let r=[],n=e.index,s=e.attributes.position,a=0;if(null!==n){let e=n.array;a=n.version;for(let t=0,i=e.length;t<i;t+=3){let i=e[t+0],n=e[t+1],s=e[t+2];r.push(i,n,n,s,s,i)}}else{if(void 0===s)return;let e=s.array;a=s.version;for(let t=0,i=e.length/3-1;t<i;t+=3){let e=t+0,i=t+1,n=t+2;r.push(e,i,i,n,n,e)}}let l=new((0,i.H7L)(r)?i.lCJ:i.qlB)(r,1);l.version=a;let h=o.get(e);h&&t.remove(h),o.set(e,l)}return{get:function(e,t){return!0===s[t.id]?t:(t.addEventListener("dispose",a),s[t.id]=!0,r.memory.geometries++,t)},update:function(r){let i=r.attributes;for(let r in i)t.update(i[r],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){let t=o.get(e);if(t){let r=e.index;null!==r&&t.version<r.version&&l(e)}else l(e);return o.get(e)}}}function B(e,t,r){let i,n,s;function o(t,o,a){0!==a&&(e.drawElementsInstanced(i,o,n,t*s,a),r.update(o,i,a))}this.setMode=function(e){i=e},this.setIndex=function(e){n=e.type,s=e.bytesPerElement},this.render=function(t,o){e.drawElements(i,o,n,t*s),r.update(o,i,1)},this.renderInstances=o,this.renderMultiDraw=function(e,s,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,s,0,n,e,0,o);let a=0;for(let e=0;e<o;e++)a+=s[e];r.update(a,i,1)},this.renderMultiDrawInstances=function(e,a,l,h){if(0===l)return;let u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)o(e[t]/s,a[t],h[t]);else{u.multiDrawElementsInstancedWEBGL(i,a,0,n,e,0,h,0,l);let t=0;for(let e=0;e<l;e++)t+=a[e]*h[e];r.update(t,i,1)}}}function F(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(r,i,n){switch(t.calls++,i){case e.TRIANGLES:t.triangles+=r/3*n;break;case e.LINES:t.lines+=r/2*n;break;case e.LINE_STRIP:t.lines+=n*(r-1);break;case e.LINE_LOOP:t.lines+=n*r;break;case e.POINTS:t.points+=n*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function V(e,t,r){let n=new WeakMap,s=new i.Ltg;return{update:function(o,a,l){let h=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,c=void 0!==u?u.length:0,d=n.get(a);if(void 0===d||d.count!==c){void 0!==d&&d.texture.dispose();let e=void 0!==a.morphAttributes.position,r=void 0!==a.morphAttributes.normal,o=void 0!==a.morphAttributes.color,l=a.morphAttributes.position||[],h=a.morphAttributes.normal||[],u=a.morphAttributes.color||[],f=0;!0===e&&(f=1),!0===r&&(f=2),!0===o&&(f=3);let p=a.attributes.position.count*f,g=1;p>t.maxTextureSize&&(g=Math.ceil(p/t.maxTextureSize),p=t.maxTextureSize);let m=new Float32Array(p*g*4*c),v=new i.p3g(m,p,g,c);v.type=i.VzW,v.needsUpdate=!0;let b=4*f;for(let t=0;t<c;t++){let i=l[t],n=h[t],a=u[t],c=p*g*4*t;for(let t=0;t<i.count;t++){let l=t*b;!0===e&&(s.fromBufferAttribute(i,t),m[c+l+0]=s.x,m[c+l+1]=s.y,m[c+l+2]=s.z,m[c+l+3]=0),!0===r&&(s.fromBufferAttribute(n,t),m[c+l+4]=s.x,m[c+l+5]=s.y,m[c+l+6]=s.z,m[c+l+7]=0),!0===o&&(s.fromBufferAttribute(a,t),m[c+l+8]=s.x,m[c+l+9]=s.y,m[c+l+10]=s.z,m[c+l+11]=4===a.itemSize?s.w:1)}}d={count:c,texture:v,size:new i.FM8(p,g)},n.set(a,d);a.addEventListener("dispose",function e(){v.dispose(),n.delete(a),a.removeEventListener("dispose",e)})}if(!0===o.isInstancedMesh&&null!==o.morphTexture)l.getUniforms().setValue(e,"morphTexture",o.morphTexture,r);else{let t=0;for(let e=0;e<h.length;e++)t+=h[e];let r=a.morphTargetsRelative?1:1-t;l.getUniforms().setValue(e,"morphTargetBaseInfluence",r),l.getUniforms().setValue(e,"morphTargetInfluences",h)}l.getUniforms().setValue(e,"morphTargetsTexture",d.texture,r),l.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function G(e,t,r,i){let n=new WeakMap;function s(e){let t=e.target;t.removeEventListener("dispose",s),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(o){let a=i.render.frame,l=o.geometry,h=t.get(o,l);if(n.get(h)!==a&&(t.update(h),n.set(h,a)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",s)&&o.addEventListener("dispose",s),n.get(o)!==a&&(r.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&r.update(o.instanceColor,e.ARRAY_BUFFER),n.set(o,a))),o.isSkinnedMesh){let e=o.skeleton;n.get(e)!==a&&(e.update(),n.set(e,a))}return h},dispose:function(){n=new WeakMap}}}let U=new i.xEZ,z=new i.$YQ(1,1),j=new i.p3g,H=new i.JUT,W=new i.BtG,q=[],X=[],$=new Float32Array(16),Y=new Float32Array(9),Z=new Float32Array(4);function K(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,s=q[n];if(void 0===s&&(s=new Float32Array(n),q[n]=s),0!==t){i.toArray(s,0);for(let i=1,n=0;i!==t;++i)n+=r,e[i].toArray(s,n)}return s}function J(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Q(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function ee(e,t){let r=X[t];void 0===r&&(r=new Int32Array(t),X[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function et(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function er(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(J(r,t))return;e.uniform2fv(this.addr,t),Q(r,t)}}function ei(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(J(r,t))return;e.uniform3fv(this.addr,t),Q(r,t)}}function en(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(J(r,t))return;e.uniform4fv(this.addr,t),Q(r,t)}}function es(e,t){let r=this.cache,i=t.elements;if(void 0===i){if(J(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Q(r,t)}else{if(J(r,i))return;Z.set(i),e.uniformMatrix2fv(this.addr,!1,Z),Q(r,i)}}function eo(e,t){let r=this.cache,i=t.elements;if(void 0===i){if(J(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Q(r,t)}else{if(J(r,i))return;Y.set(i),e.uniformMatrix3fv(this.addr,!1,Y),Q(r,i)}}function ea(e,t){let r=this.cache,i=t.elements;if(void 0===i){if(J(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Q(r,t)}else{if(J(r,i))return;$.set(i),e.uniformMatrix4fv(this.addr,!1,$),Q(r,i)}}function el(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function eh(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(J(r,t))return;e.uniform2iv(this.addr,t),Q(r,t)}}function eu(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(J(r,t))return;e.uniform3iv(this.addr,t),Q(r,t)}}function ec(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(J(r,t))return;e.uniform4iv(this.addr,t),Q(r,t)}}function ed(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function ef(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(J(r,t))return;e.uniform2uiv(this.addr,t),Q(r,t)}}function ep(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(J(r,t))return;e.uniform3uiv(this.addr,t),Q(r,t)}}function eg(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(J(r,t))return;e.uniform4uiv(this.addr,t),Q(r,t)}}function em(e,t,r){let n;let s=this.cache,o=r.allocateTextureUnit();s[0]!==o&&(e.uniform1i(this.addr,o),s[0]=o),this.type===e.SAMPLER_2D_SHADOW?(z.compareFunction=i.M$G,n=z):n=U,r.setTexture2D(t||n,o)}function ev(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||H,n)}function eb(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||W,n)}function ey(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||j,n)}function ex(e,t){e.uniform1fv(this.addr,t)}function e_(e,t){let r=K(t,this.size,2);e.uniform2fv(this.addr,r)}function eS(e,t){let r=K(t,this.size,3);e.uniform3fv(this.addr,r)}function ew(e,t){let r=K(t,this.size,4);e.uniform4fv(this.addr,r)}function eT(e,t){let r=K(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function eP(e,t){let r=K(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function eE(e,t){let r=K(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function eC(e,t){e.uniform1iv(this.addr,t)}function eA(e,t){e.uniform2iv(this.addr,t)}function eI(e,t){e.uniform3iv(this.addr,t)}function eM(e,t){e.uniform4iv(this.addr,t)}function eR(e,t){e.uniform1uiv(this.addr,t)}function eO(e,t){e.uniform2uiv(this.addr,t)}function ek(e,t){e.uniform3uiv(this.addr,t)}function eN(e,t){e.uniform4uiv(this.addr,t)}function eL(e,t,r){let i=this.cache,n=t.length,s=ee(r,n);!J(i,s)&&(e.uniform1iv(this.addr,s),Q(i,s));for(let e=0;e!==n;++e)r.setTexture2D(t[e]||U,s[e])}function eD(e,t,r){let i=this.cache,n=t.length,s=ee(r,n);!J(i,s)&&(e.uniform1iv(this.addr,s),Q(i,s));for(let e=0;e!==n;++e)r.setTexture3D(t[e]||H,s[e])}function eB(e,t,r){let i=this.cache,n=t.length,s=ee(r,n);!J(i,s)&&(e.uniform1iv(this.addr,s),Q(i,s));for(let e=0;e!==n;++e)r.setTextureCube(t[e]||W,s[e])}function eF(e,t,r){let i=this.cache,n=t.length,s=ee(r,n);!J(i,s)&&(e.uniform1iv(this.addr,s),Q(i,s));for(let e=0;e!==n;++e)r.setTexture2DArray(t[e]||j,s[e])}class eV{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return et;case 35664:return er;case 35665:return ei;case 35666:return en;case 35674:return es;case 35675:return eo;case 35676:return ea;case 5124:case 35670:return el;case 35667:case 35671:return eh;case 35668:case 35672:return eu;case 35669:case 35673:return ec;case 5125:return ed;case 36294:return ef;case 36295:return ep;case 36296:return eg;case 35678:case 36198:case 36298:case 36306:case 35682:return em;case 35679:case 36299:case 36307:return ev;case 35680:case 36300:case 36308:case 36293:return eb;case 36289:case 36303:case 36311:case 36292:return ey}}(t.type)}}class eG{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return ex;case 35664:return e_;case 35665:return eS;case 35666:return ew;case 35674:return eT;case 35675:return eP;case 35676:return eE;case 5124:case 35670:return eC;case 35667:case 35671:return eA;case 35668:case 35672:return eI;case 35669:case 35673:return eM;case 5125:return eR;case 36294:return eO;case 36295:return ek;case 36296:return eN;case 35678:case 36198:case 36298:case 36306:case 35682:return eL;case 35679:case 36299:case 36307:return eD;case 35680:case 36300:case 36308:case 36293:return eB;case 36289:case 36303:case 36311:case 36292:return eF}}(t.type)}}class eU{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,s=i.length;n!==s;++n){let s=i[n];s.setValue(e,t[s.id],r)}}}let ez=/(\w+)(\])?(\[|\.)?/g;function ej(e,t){e.seq.push(t),e.map[t.id]=t}class eH{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){let r=e.getActiveUniform(t,i),n=e.getUniformLocation(t,r.name);!function(e,t,r){let i=e.name,n=i.length;for(ez.lastIndex=0;;){let s=ez.exec(i),o=ez.lastIndex,a=s[1],l="]"===s[2],h=s[3];if(l&&(a|=0),void 0===h||"["===h&&o+2===n){ej(r,void 0===h?new eV(a,e,t):new eG(a,e,t));break}{let e=r.map[a];void 0===e&&ej(r,e=new eU(a)),r=e}}}(r,n,this)}}setValue(e,t,r,i){let n=this.map[t];void 0!==n&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];void 0!==i&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){let s=t[n],o=r[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let n=e[i];n.id in t&&r.push(n)}return r}}function eW(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}let eq=0,eX=new i.Vkp;function e$(e,t,r){let i=e.getShaderParameter(t,e.COMPILE_STATUS),n=e.getShaderInfoLog(t).trim();if(i&&""===n)return"";let s=/ERROR: 0:(\d+)/.exec(n);if(!s)return n;{let i=parseInt(s[1]);return r.toUpperCase()+"\n\n"+n+"\n\n"+function(e,t){let r=e.split("\n"),i=[],n=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let e=n;e<s;e++){let n=e+1;i.push(`${n===t?">":" "} ${n}: ${r[e]}`)}return i.join("\n")}(e.getShaderSource(t),i)}}let eY=new i.Pa4;function eZ(e){return""!==e}function eK(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function eJ(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}let eQ=/^[ \t]*#include +<([\w\d./]+)>/gm;function e1(e){return e.replace(eQ,e2)}let e0=new Map;function e2(e,t){let r=o[t];if(void 0===r){let e=e0.get(t);if(void 0!==e)r=o[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e);else throw Error("Can not resolve #include <"+t+">")}return e1(r)}let e3=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function e5(e){return e.replace(e3,e6)}function e6(e,t,r,i){let n="";for(let e=parseInt(t);e<parseInt(r);e++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return n}function e4(e){let t=`precision ${e.precision} float;
	precision ${e.precision} int;
	precision ${e.precision} sampler2D;
	precision ${e.precision} samplerCube;
	precision ${e.precision} sampler3D;
	precision ${e.precision} sampler2DArray;
	precision ${e.precision} sampler2DShadow;
	precision ${e.precision} samplerCubeShadow;
	precision ${e.precision} sampler2DArrayShadow;
	precision ${e.precision} isampler2D;
	precision ${e.precision} isampler3D;
	precision ${e.precision} isamplerCube;
	precision ${e.precision} isampler2DArray;
	precision ${e.precision} usampler2D;
	precision ${e.precision} usampler3D;
	precision ${e.precision} usamplerCube;
	precision ${e.precision} usampler2DArray;
	`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function e9(e,t,r,n){var s,a,l;let h,u,c,d,f,p;let g=e.getContext(),m=r.defines,v=r.vertexShader,b=r.fragmentShader;let y=(f="SHADOWMAP_TYPE_BASIC",(s=r).shadowMapType===i._iA?f="SHADOWMAP_TYPE_PCF":s.shadowMapType===i.ntZ?f="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===i.dwk&&(f="SHADOWMAP_TYPE_VSM"),f),x=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case i.fY$:case i.vxC:t="ENVMAP_TYPE_CUBE";break;case i.g8_:t="ENVMAP_TYPE_CUBE_UV"}return t}(r);let _=(p="ENVMAP_MODE_REFLECTION",(a=r).envMap&&a.envMapMode===i.vxC&&(p="ENVMAP_MODE_REFRACTION"),p),S=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case i.Ns1:t="ENVMAP_BLENDING_MULTIPLY";break;case i.qhX:t="ENVMAP_BLENDING_MIX";break;case i.NDo:t="ENVMAP_BLENDING_ADD"}return t}(r),w=function(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let r=Math.log2(t)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:1/t,maxMip:r}}(r);let T=[(l=r).extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",l.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(eZ).join("\n"),P=function(e){let t=[];for(let r in e){let i=e[r];!1!==i&&t.push("#define "+r+" "+i)}return t.join("\n")}(m),E=g.createProgram(),C=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?((h=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,P].filter(eZ).join("\n")).length>0&&(h+="\n"),(u=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,P].filter(eZ).join("\n")).length>0&&(u+="\n")):(h=[e4(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,P,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+_:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+y:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(eZ).join("\n"),u=[e4(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,P,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+x:"",r.envMap?"#define "+_:"",r.envMap?"#define "+S:"",w?"#define CUBEUV_TEXEL_WIDTH "+w.texelWidth:"",w?"#define CUBEUV_TEXEL_HEIGHT "+w.texelHeight:"",w?"#define CUBEUV_MAX_MIP "+w.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+y:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==i.uL9?"#define TONE_MAPPING":"",r.toneMapping!==i.uL9?o.tonemapping_pars_fragment:"",r.toneMapping!==i.uL9?function(e,t){let r;switch(t){case i.EoG:r="Linear";break;case i.CdI:r="Reinhard";break;case i.YGz:r="Cineon";break;case i.LY2:r="ACESFilmic";break;case i.Bgp:r="AgX";break;case i.ORg:r="Neutral";break;case i.dZ3:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",o.colorspace_pars_fragment,function(e,t){let r=function(e){i.epp._getMatrix(eX,i.epp.workingColorSpace,e);let t=`mat3( ${eX.elements.map(e=>e.toFixed(4))} )`;switch(i.epp.getTransfer(e)){case i.l6D:return[t,"LinearTransferOETF"];case i.j17:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return`vec4 ${e}( vec4 value ) {
	return ${r[1]}( vec4( value.rgb * ${r[0]}, value.a ) );
}`}("linearToOutputTexel",r.outputColorSpace),function(){i.epp.getLuminanceCoefficients(eY);let e=eY.x.toFixed(4),t=eY.y.toFixed(4),r=eY.z.toFixed(4);return`float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( ${e}, ${t}, ${r} );
	return dot( weights, rgb );
}`}(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(eZ).join("\n")),v=eJ(v=eK(v=e1(v),r),r),b=eJ(b=eK(b=e1(b),r),r),v=e5(v),b=e5(b),!0!==r.isRawShaderMaterial&&(C="#version 300 es\n",h=[T,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+h,u=["#define varying in",r.glslVersion===i.LSk?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===i.LSk?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+u);let A=C+h+v,I=C+u+b,M=eW(g,g.VERTEX_SHADER,A),R=eW(g,g.FRAGMENT_SHADER,I);function O(t){if(e.debug.checkShaderErrors){let r=g.getProgramInfoLog(E).trim(),i=g.getShaderInfoLog(M).trim(),n=g.getShaderInfoLog(R).trim(),s=!0,o=!0;if(!1===g.getProgramParameter(E,g.LINK_STATUS)){if(s=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(g,E,M,R);else{let e=e$(g,M,"vertex"),i=e$(g,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+g.getError()+" - VALIDATE_STATUS "+g.getProgramParameter(E,g.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+r+"\n"+e+"\n"+i)}}else""!==r?console.warn("THREE.WebGLProgram: Program Info Log:",r):(""===i||""===n)&&(o=!1);o&&(t.diagnostics={runnable:s,programLog:r,vertexShader:{log:i,prefix:h},fragmentShader:{log:n,prefix:u}})}g.deleteShader(M),g.deleteShader(R),c=new eH(g,E),d=function(e,t){let r={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let i=e.getActiveAttrib(t,n),s=i.name,o=1;i.type===e.FLOAT_MAT2&&(o=2),i.type===e.FLOAT_MAT3&&(o=3),i.type===e.FLOAT_MAT4&&(o=4),r[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:o}}return r}(g,E)}g.attachShader(E,M),g.attachShader(E,R),void 0!==r.index0AttributeName?g.bindAttribLocation(E,0,r.index0AttributeName):!0===r.morphTargets&&g.bindAttribLocation(E,0,"position"),g.linkProgram(E),this.getUniforms=function(){return void 0===c&&O(this),c},this.getAttributes=function(){return void 0===d&&O(this),d};let k=!1===r.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===k&&(k=g.getProgramParameter(E,37297)),k},this.destroy=function(){n.releaseStatesOfProgram(this),g.deleteProgram(E),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=eq++,this.cacheKey=t,this.usedTimes=1,this.program=E,this.vertexShader=M,this.fragmentShader=R,this}let e8=0;class e7{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(n)&&(s.add(n),n.usedTimes++),this}remove(e){for(let t of this.materialCache.get(e))t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return void 0===r&&(r=new te(e),t.set(e,r)),r}}class te{constructor(e){this.id=e8++,this.code=e,this.usedTimes=0}}function tt(e,t,r,n,s,o,a){let h=new i.S9g,u=new e7,c=new Set,d=[],f=s.logarithmicDepthBuffer,p=s.vertexTextures,g=s.precision,m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(e){return(c.add(e),0===e)?"uv":`uv${e}`}return{getParameters:function(o,h,d,b,y){let x,_,S,w;let T=b.fog,P=y.geometry,E=o.isMeshStandardMaterial?b.environment:null,C=(o.isMeshStandardMaterial?r:t).get(o.envMap||E),A=C&&C.mapping===i.g8_?C.image.height:null,I=m[o.type];null!==o.precision&&(g=s.getMaxPrecision(o.precision))!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",g,"instead.");let M=P.morphAttributes.position||P.morphAttributes.normal||P.morphAttributes.color,R=void 0!==M?M.length:0,O=0;if(void 0!==P.morphAttributes.position&&(O=1),void 0!==P.morphAttributes.normal&&(O=2),void 0!==P.morphAttributes.color&&(O=3),I){let e=l[I];x=e.vertexShader,_=e.fragmentShader}else x=o.vertexShader,_=o.fragmentShader,u.update(o),S=u.getVertexShaderID(o),w=u.getFragmentShaderID(o);let k=e.getRenderTarget(),N=e.state.buffers.depth.getReversed(),L=!0===y.isInstancedMesh,D=!0===y.isBatchedMesh,B=!!o.map,F=!!o.matcap,V=!!C,G=!!o.aoMap,U=!!o.lightMap,z=!!o.bumpMap,j=!!o.normalMap,H=!!o.displacementMap,W=!!o.emissiveMap,q=!!o.metalnessMap,X=!!o.roughnessMap,$=o.anisotropy>0,Y=o.clearcoat>0,Z=o.dispersion>0,K=o.iridescence>0,J=o.sheen>0,Q=o.transmission>0,ee=$&&!!o.anisotropyMap,et=Y&&!!o.clearcoatMap,er=Y&&!!o.clearcoatNormalMap,ei=Y&&!!o.clearcoatRoughnessMap,en=K&&!!o.iridescenceMap,es=K&&!!o.iridescenceThicknessMap,eo=J&&!!o.sheenColorMap,ea=J&&!!o.sheenRoughnessMap,el=!!o.specularMap,eh=!!o.specularColorMap,eu=!!o.specularIntensityMap,ec=Q&&!!o.transmissionMap,ed=Q&&!!o.thicknessMap,ef=!!o.gradientMap,ep=!!o.alphaMap,eg=o.alphaTest>0,em=!!o.alphaHash,ev=!!o.extensions,eb=i.uL9;o.toneMapped&&(null===k||!0===k.isXRRenderTarget)&&(eb=e.toneMapping);let ey={shaderID:I,shaderType:o.type,shaderName:o.name,vertexShader:x,fragmentShader:_,defines:o.defines,customVertexShaderID:S,customFragmentShaderID:w,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:g,batching:D,batchingColor:D&&null!==y._colorsTexture,instancing:L,instancingColor:L&&null!==y.instanceColor,instancingMorph:L&&null!==y.morphTexture,supportsVertexTextures:p,outputColorSpace:null===k?e.outputColorSpace:!0===k.isXRRenderTarget?k.texture.colorSpace:i.GUF,alphaToCoverage:!!o.alphaToCoverage,map:B,matcap:F,envMap:V,envMapMode:V&&C.mapping,envMapCubeUVHeight:A,aoMap:G,lightMap:U,bumpMap:z,normalMap:j,displacementMap:p&&H,emissiveMap:W,normalMapObjectSpace:j&&o.normalMapType===i.PA7,normalMapTangentSpace:j&&o.normalMapType===i.IOt,metalnessMap:q,roughnessMap:X,anisotropy:$,anisotropyMap:ee,clearcoat:Y,clearcoatMap:et,clearcoatNormalMap:er,clearcoatRoughnessMap:ei,dispersion:Z,iridescence:K,iridescenceMap:en,iridescenceThicknessMap:es,sheen:J,sheenColorMap:eo,sheenRoughnessMap:ea,specularMap:el,specularColorMap:eh,specularIntensityMap:eu,transmission:Q,transmissionMap:ec,thicknessMap:ed,gradientMap:ef,opaque:!1===o.transparent&&o.blending===i.bdR&&!1===o.alphaToCoverage,alphaMap:ep,alphaTest:eg,alphaHash:em,combine:o.combine,mapUv:B&&v(o.map.channel),aoMapUv:G&&v(o.aoMap.channel),lightMapUv:U&&v(o.lightMap.channel),bumpMapUv:z&&v(o.bumpMap.channel),normalMapUv:j&&v(o.normalMap.channel),displacementMapUv:H&&v(o.displacementMap.channel),emissiveMapUv:W&&v(o.emissiveMap.channel),metalnessMapUv:q&&v(o.metalnessMap.channel),roughnessMapUv:X&&v(o.roughnessMap.channel),anisotropyMapUv:ee&&v(o.anisotropyMap.channel),clearcoatMapUv:et&&v(o.clearcoatMap.channel),clearcoatNormalMapUv:er&&v(o.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ei&&v(o.clearcoatRoughnessMap.channel),iridescenceMapUv:en&&v(o.iridescenceMap.channel),iridescenceThicknessMapUv:es&&v(o.iridescenceThicknessMap.channel),sheenColorMapUv:eo&&v(o.sheenColorMap.channel),sheenRoughnessMapUv:ea&&v(o.sheenRoughnessMap.channel),specularMapUv:el&&v(o.specularMap.channel),specularColorMapUv:eh&&v(o.specularColorMap.channel),specularIntensityMapUv:eu&&v(o.specularIntensityMap.channel),transmissionMapUv:ec&&v(o.transmissionMap.channel),thicknessMapUv:ed&&v(o.thicknessMap.channel),alphaMapUv:ep&&v(o.alphaMap.channel),vertexTangents:!!P.attributes.tangent&&(j||$),vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!P.attributes.color&&4===P.attributes.color.itemSize,pointsUvs:!0===y.isPoints&&!!P.attributes.uv&&(B||ep),fog:!!T,useFog:!0===o.fog,fogExp2:!!T&&T.isFogExp2,flatShading:!0===o.flatShading,sizeAttenuation:!0===o.sizeAttenuation,logarithmicDepthBuffer:f,reverseDepthBuffer:N,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==P.morphAttributes.position,morphNormals:void 0!==P.morphAttributes.normal,morphColors:void 0!==P.morphAttributes.color,morphTargetsCount:R,morphTextureStride:O,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numSpotLightMaps:h.spotLightMap.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numSpotLightShadowsWithMaps:h.numSpotLightShadowsWithMaps,numLightProbes:h.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:eb,decodeVideoTexture:B&&!0===o.map.isVideoTexture&&i.epp.getTransfer(o.map.colorSpace)===i.j17,decodeVideoTextureEmissive:W&&!0===o.emissiveMap.isVideoTexture&&i.epp.getTransfer(o.emissiveMap.colorSpace)===i.j17,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===i.ehD,flipSided:o.side===i._Li,useDepthPacking:o.depthPacking>=0,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionClipCullDistance:ev&&!0===o.extensions.clipCullDistance&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ev&&!0===o.extensions.multiDraw||D)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:o.customProgramCacheKey()};return ey.vertexUv1s=c.has(1),ey.vertexUv2s=c.has(2),ey.vertexUv3s=c.has(3),c.clear(),ey},getProgramCacheKey:function(t){let r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.customVertexShaderID),r.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)r.push(e),r.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(r,t),function(e,t){h.disableAll(),t.supportsVertexTextures&&h.enable(0),t.instancing&&h.enable(1),t.instancingColor&&h.enable(2),t.instancingMorph&&h.enable(3),t.matcap&&h.enable(4),t.envMap&&h.enable(5),t.normalMapObjectSpace&&h.enable(6),t.normalMapTangentSpace&&h.enable(7),t.clearcoat&&h.enable(8),t.iridescence&&h.enable(9),t.alphaTest&&h.enable(10),t.vertexColors&&h.enable(11),t.vertexAlphas&&h.enable(12),t.vertexUv1s&&h.enable(13),t.vertexUv2s&&h.enable(14),t.vertexUv3s&&h.enable(15),t.vertexTangents&&h.enable(16),t.anisotropy&&h.enable(17),t.alphaHash&&h.enable(18),t.batching&&h.enable(19),t.dispersion&&h.enable(20),t.batchingColor&&h.enable(21),e.push(h.mask),h.disableAll(),t.fog&&h.enable(0),t.useFog&&h.enable(1),t.flatShading&&h.enable(2),t.logarithmicDepthBuffer&&h.enable(3),t.reverseDepthBuffer&&h.enable(4),t.skinning&&h.enable(5),t.morphTargets&&h.enable(6),t.morphNormals&&h.enable(7),t.morphColors&&h.enable(8),t.premultipliedAlpha&&h.enable(9),t.shadowMapEnabled&&h.enable(10),t.doubleSided&&h.enable(11),t.flipSided&&h.enable(12),t.useDepthPacking&&h.enable(13),t.dithering&&h.enable(14),t.transmission&&h.enable(15),t.sheen&&h.enable(16),t.opaque&&h.enable(17),t.pointsUvs&&h.enable(18),t.decodeVideoTexture&&h.enable(19),t.decodeVideoTextureEmissive&&h.enable(20),t.alphaToCoverage&&h.enable(21),e.push(h.mask)}(r,t),r.push(e.outputColorSpace)),r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){let t;let r=m[e.type];if(r){let e=l[r];t=i.rDY.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,r){let i;for(let e=0,t=d.length;e<t;e++){let t=d[e];if(t.cacheKey===r){i=t,++i.usedTimes;break}}return void 0===i&&(i=new e9(e,r,t,o),d.push(i)),i},releaseProgram:function(e){if(0==--e.usedTimes){let t=d.indexOf(e);d[t]=d[d.length-1],d.pop(),e.destroy()}},releaseShaderCache:function(e){u.remove(e)},programs:d,dispose:function(){u.dispose()}}}function tr(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,i){e.get(t)[r]=i},dispose:function(){e=new WeakMap}}}function ti(e,t){if(e.groupOrder!==t.groupOrder)return e.groupOrder-t.groupOrder;if(e.renderOrder!==t.renderOrder)return e.renderOrder-t.renderOrder;if(e.material.id!==t.material.id)return e.material.id-t.material.id;else if(e.z!==t.z)return e.z-t.z;else return e.id-t.id}function tn(e,t){if(e.groupOrder!==t.groupOrder)return e.groupOrder-t.groupOrder;if(e.renderOrder!==t.renderOrder)return e.renderOrder-t.renderOrder;if(e.z!==t.z)return t.z-e.z;else return e.id-t.id}function ts(){let e=[],t=0,r=[],i=[],n=[];function s(r,i,n,s,o,a){let l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:i,material:n,groupOrder:s,renderOrder:r.renderOrder,z:o,group:a},e[t]=l):(l.id=r.id,l.object=r,l.geometry=i,l.material=n,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:r,transmissive:i,transparent:n,init:function(){t=0,r.length=0,i.length=0,n.length=0},push:function(e,t,o,a,l,h){let u=s(e,t,o,a,l,h);o.transmission>0?i.push(u):!0===o.transparent?n.push(u):r.push(u)},unshift:function(e,t,o,a,l,h){let u=s(e,t,o,a,l,h);o.transmission>0?i.unshift(u):!0===o.transparent?n.unshift(u):r.unshift(u)},finish:function(){for(let r=t,i=e.length;r<i;r++){let t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||ti),i.length>1&&i.sort(t||tn),n.length>1&&n.sort(t||tn)}}}function to(){let e=new WeakMap;return{get:function(t,r){let i;let n=e.get(t);return void 0===n?(i=new ts,e.set(t,[i])):r>=n.length?(i=new ts,n.push(i)):i=n[r],i},dispose:function(){e=new WeakMap}}}function ta(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":r={direction:new i.Pa4,color:new i.Ilk};break;case"SpotLight":r={position:new i.Pa4,direction:new i.Pa4,color:new i.Ilk,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new i.Pa4,color:new i.Ilk,distance:0,decay:0};break;case"HemisphereLight":r={direction:new i.Pa4,skyColor:new i.Ilk,groundColor:new i.Ilk};break;case"RectAreaLight":r={color:new i.Ilk,position:new i.Pa4,halfWidth:new i.Pa4,halfHeight:new i.Pa4}}return e[t.id]=r,r}}}let tl=0;function th(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function tu(e){let t=new ta,r=function(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new i.FM8};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new i.FM8,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)n.probe.push(new i.Pa4);let s=new i.Pa4,o=new i.yGw,l=new i.yGw;return{setup:function(i){let s=0,o=0,l=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let h=0,u=0,c=0,d=0,f=0,p=0,g=0,m=0,v=0,b=0,y=0;i.sort(th);for(let e=0,a=i.length;e<a;e++){let a=i[e],x=a.color,_=a.intensity,S=a.distance,w=a.shadow&&a.shadow.map?a.shadow.map.texture:null;if(a.isAmbientLight)s+=x.r*_,o+=x.g*_,l+=x.b*_;else if(a.isLightProbe){for(let e=0;e<9;e++)n.probe[e].addScaledVector(a.sh.coefficients[e],_);y++}else if(a.isDirectionalLight){let e=t.get(a);if(e.color.copy(a.color).multiplyScalar(a.intensity),a.castShadow){let e=a.shadow,t=r.get(a);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,n.directionalShadow[h]=t,n.directionalShadowMap[h]=w,n.directionalShadowMatrix[h]=a.shadow.matrix,p++}n.directional[h]=e,h++}else if(a.isSpotLight){let e=t.get(a);e.position.setFromMatrixPosition(a.matrixWorld),e.color.copy(x).multiplyScalar(_),e.distance=S,e.coneCos=Math.cos(a.angle),e.penumbraCos=Math.cos(a.angle*(1-a.penumbra)),e.decay=a.decay,n.spot[c]=e;let i=a.shadow;if(a.map&&(n.spotLightMap[v]=a.map,v++,i.updateMatrices(a),a.castShadow&&b++),n.spotLightMatrix[c]=i.matrix,a.castShadow){let e=r.get(a);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,n.spotShadow[c]=e,n.spotShadowMap[c]=w,m++}c++}else if(a.isRectAreaLight){let e=t.get(a);e.color.copy(x).multiplyScalar(_),e.halfWidth.set(.5*a.width,0,0),e.halfHeight.set(0,.5*a.height,0),n.rectArea[d]=e,d++}else if(a.isPointLight){let e=t.get(a);if(e.color.copy(a.color).multiplyScalar(a.intensity),e.distance=a.distance,e.decay=a.decay,a.castShadow){let e=a.shadow,t=r.get(a);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,n.pointShadow[u]=t,n.pointShadowMap[u]=w,n.pointShadowMatrix[u]=a.shadow.matrix,g++}n.point[u]=e,u++}else if(a.isHemisphereLight){let e=t.get(a);e.skyColor.copy(a.color).multiplyScalar(_),e.groundColor.copy(a.groundColor).multiplyScalar(_),n.hemi[f]=e,f++}}d>0&&(!0===e.has("OES_texture_float_linear")?(n.rectAreaLTC1=a.LTC_FLOAT_1,n.rectAreaLTC2=a.LTC_FLOAT_2):(n.rectAreaLTC1=a.LTC_HALF_1,n.rectAreaLTC2=a.LTC_HALF_2)),n.ambient[0]=s,n.ambient[1]=o,n.ambient[2]=l;let x=n.hash;(x.directionalLength!==h||x.pointLength!==u||x.spotLength!==c||x.rectAreaLength!==d||x.hemiLength!==f||x.numDirectionalShadows!==p||x.numPointShadows!==g||x.numSpotShadows!==m||x.numSpotMaps!==v||x.numLightProbes!==y)&&(n.directional.length=h,n.spot.length=c,n.rectArea.length=d,n.point.length=u,n.hemi.length=f,n.directionalShadow.length=p,n.directionalShadowMap.length=p,n.pointShadow.length=g,n.pointShadowMap.length=g,n.spotShadow.length=m,n.spotShadowMap.length=m,n.directionalShadowMatrix.length=p,n.pointShadowMatrix.length=g,n.spotLightMatrix.length=m+v-b,n.spotLightMap.length=v,n.numSpotLightShadowsWithMaps=b,n.numLightProbes=y,x.directionalLength=h,x.pointLength=u,x.spotLength=c,x.rectAreaLength=d,x.hemiLength=f,x.numDirectionalShadows=p,x.numPointShadows=g,x.numSpotShadows=m,x.numSpotMaps=v,x.numLightProbes=y,n.version=tl++)},setupView:function(e,t){let r=0,i=0,a=0,h=0,u=0,c=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){let d=e[t];if(d.isDirectionalLight){let e=n.directional[r];e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(c),r++}else if(d.isSpotLight){let e=n.spot[a];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(c),e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(c),a++}else if(d.isRectAreaLight){let e=n.rectArea[h];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(c),l.identity(),o.copy(d.matrixWorld),o.premultiply(c),l.extractRotation(o),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(l),e.halfHeight.applyMatrix4(l),h++}else if(d.isPointLight){let e=n.point[i];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(c),i++}else if(d.isHemisphereLight){let e=n.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(c),u++}}},state:n}}function tc(e){let t=new tu(e),r=[],i=[],n={lightsArray:r,shadowsArray:i,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){n.camera=e,r.length=0,i.length=0},state:n,setupLights:function(){t.setup(r)},setupLightsView:function(e){t.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function td(e){let t=new WeakMap;return{get:function(r,i=0){let n;let s=t.get(r);return void 0===s?(n=new tc(e),t.set(r,[n])):i>=s.length?(n=new tc(e),s.push(n)):n=s[i],n},dispose:function(){t=new WeakMap}}}function tf(e,t,r){let n=new i.iWj,s=new i.FM8,o=new i.FM8,a=new i.Ltg,l=new i.lRF({depthPacking:i.mSO}),h=new i.Lun,u={},c=r.maxTextureSize,d={[i.Wl3]:i._Li,[i._Li]:i.Wl3,[i.ehD]:i.ehD},f=new i.jyz({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new i.FM8},radius:{value:4}},vertexShader:"void main() {\n	gl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	const float samples = float( VSM_SAMPLES );\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n	for ( float i = 0.0; i < samples; i ++ ) {\n		float uvOffset = uvStart + i * uvStride;\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean / samples;\n	squared_mean = squared_mean / samples;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=f.clone();p.defines.HORIZONTAL_PASS=1;let g=new i.u9r;g.setAttribute("position",new i.TlE(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new i.Kj0(g,f),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=i._iA;let b=this.type;this.render=function(r,l,h){if(!1===v.enabled||!1===v.autoUpdate&&!1===v.needsUpdate||0===r.length)return;let u=e.getRenderTarget(),d=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),x=e.state;x.setBlending(i.jFi),x.buffers.color.setClear(1,1,1,1),x.buffers.depth.setTest(!0),x.setScissorTest(!1);let _=b!==i.dwk&&this.type===i.dwk,S=b===i.dwk&&this.type!==i.dwk;for(let u=0,d=r.length;u<d;u++){let d=r[u],g=d.shadow;if(void 0===g){console.warn("THREE.WebGLShadowMap:",d,"has no shadow.");continue}if(!1===g.autoUpdate&&!1===g.needsUpdate)continue;s.copy(g.mapSize);let v=g.getFrameExtents();if(s.multiply(v),o.copy(g.mapSize),(s.x>c||s.y>c)&&(s.x>c&&(o.x=Math.floor(c/v.x),s.x=o.x*v.x,g.mapSize.x=o.x),s.y>c&&(o.y=Math.floor(c/v.y),s.y=o.y*v.y,g.mapSize.y=o.y)),null===g.map||!0===_||!0===S){let e=this.type!==i.dwk?{minFilter:i.TyD,magFilter:i.TyD}:{};null!==g.map&&g.map.dispose(),g.map=new i.dd2(s.x,s.y,e),g.map.texture.name=d.name+".shadowMap",g.camera.updateProjectionMatrix()}e.setRenderTarget(g.map),e.clear();let b=g.getViewportCount();for(let r=0;r<b;r++){let s=g.getViewport(r);a.set(o.x*s.x,o.y*s.y,o.x*s.z,o.y*s.w),x.viewport(a),g.updateMatrices(d,r),n=g.getFrustum(),function r(s,o,a,l,h){if(!1===s.visible)return;if(s.layers.test(o.layers)&&(s.isMesh||s.isLine||s.isPoints)&&(s.castShadow||s.receiveShadow&&h===i.dwk)&&(!s.frustumCulled||n.intersectsObject(s))){s.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,s.matrixWorld);let r=t.update(s),i=s.material;if(Array.isArray(i)){let t=r.groups;for(let n=0,u=t.length;n<u;n++){let u=t[n],c=i[u.materialIndex];if(c&&c.visible){let t=y(s,c,l,h);s.onBeforeShadow(e,s,o,a,r,t,u),e.renderBufferDirect(a,null,r,t,s,u),s.onAfterShadow(e,s,o,a,r,t,u)}}}else if(i.visible){let t=y(s,i,l,h);s.onBeforeShadow(e,s,o,a,r,t,null),e.renderBufferDirect(a,null,r,t,s,null),s.onAfterShadow(e,s,o,a,r,t,null)}}let u=s.children;for(let e=0,t=u.length;e<t;e++)r(u[e],o,a,l,h)}(l,h,g.camera,d,this.type)}!0!==g.isPointLightShadow&&this.type===i.dwk&&function(r,n){let o=t.update(m);f.defines.VSM_SAMPLES!==r.blurSamples&&(f.defines.VSM_SAMPLES=r.blurSamples,p.defines.VSM_SAMPLES=r.blurSamples,f.needsUpdate=!0,p.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new i.dd2(s.x,s.y)),f.uniforms.shadow_pass.value=r.map.texture,f.uniforms.resolution.value=r.mapSize,f.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,o,f,m,null),p.uniforms.shadow_pass.value=r.mapPass.texture,p.uniforms.resolution.value=r.mapSize,p.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,o,p,m,null)}(g,h),g.needsUpdate=!1}b=this.type,v.needsUpdate=!1,e.setRenderTarget(u,d,g)};function y(t,r,n,s){let o=null,a=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==a)o=a;else if(o=!0===n.isPointLight?h:l,e.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){let e=o.uuid,t=r.uuid,i=u[e];void 0===i&&(i={},u[e]=i);let n=i[t];void 0===n&&(n=o.clone(),i[t]=n,r.addEventListener("dispose",x)),o=n}return o.visible=r.visible,o.wireframe=r.wireframe,s===i.dwk?o.side=null!==r.shadowSide?r.shadowSide:r.side:o.side=null!==r.shadowSide?r.shadowSide:d[r.side],o.alphaMap=r.alphaMap,o.alphaTest=r.alphaTest,o.map=r.map,o.clipShadows=r.clipShadows,o.clippingPlanes=r.clippingPlanes,o.clipIntersection=r.clipIntersection,o.displacementMap=r.displacementMap,o.displacementScale=r.displacementScale,o.displacementBias=r.displacementBias,o.wireframeLinewidth=r.wireframeLinewidth,o.linewidth=r.linewidth,!0===n.isPointLight&&!0===o.isMeshDistanceMaterial&&(e.properties.get(o).light=n),o}function x(e){for(let t in e.target.removeEventListener("dispose",x),u){let r=u[t],i=e.target.uuid;i in r&&(r[i].dispose(),delete r[i])}}}let tp={[i.BVF]:i.Se2,[i.Zr5]:i.w$m,[i.eD]:i.M6v,[i.vCF]:i.ksN,[i.Se2]:i.BVF,[i.w$m]:i.Zr5,[i.M6v]:i.eD,[i.ksN]:i.vCF};function tg(e,t){let r=new function(){let t=!1,r=new i.Ltg,n=null,s=new i.Ltg(0,0,0,0);return{setMask:function(r){n!==r&&!t&&(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,i,n,o,a){!0===a&&(t*=o,i*=o,n*=o),r.set(t,i,n,o),!1===s.equals(r)&&(e.clearColor(t,i,n,o),s.copy(r))},reset:function(){t=!1,n=null,s.set(-1,0,0,0)}}},n=new function(){let r=!1,n=!1,s=null,o=null,a=null;return{setReversed:function(e){if(n!==e){let e=t.get("EXT_clip_control");n?e.clipControlEXT(e.LOWER_LEFT_EXT,e.ZERO_TO_ONE_EXT):e.clipControlEXT(e.LOWER_LEFT_EXT,e.NEGATIVE_ONE_TO_ONE_EXT);let r=a;a=null,this.setClear(r)}n=e},getReversed:function(){return n},setTest:function(t){t?U(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(t){s!==t&&!r&&(e.depthMask(t),s=t)},setFunc:function(t){if(n&&(t=tp[t]),o!==t){switch(t){case i.BVF:e.depthFunc(e.NEVER);break;case i.Se2:e.depthFunc(e.ALWAYS);break;case i.Zr5:e.depthFunc(e.LESS);break;case i.vCF:e.depthFunc(e.LEQUAL);break;case i.eD:e.depthFunc(e.EQUAL);break;case i.ksN:e.depthFunc(e.GEQUAL);break;case i.w$m:e.depthFunc(e.GREATER);break;case i.M6v:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}o=t}},setLocked:function(e){r=e},setClear:function(t){a!==t&&(n&&(t=1-t),e.clearDepth(t),a=t)},reset:function(){r=!1,s=null,o=null,a=null,n=!1}}},s=new function(){let t=!1,r=null,i=null,n=null,s=null,o=null,a=null,l=null,h=null;return{setTest:function(r){!t&&(r?U(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(i){r!==i&&!t&&(e.stencilMask(i),r=i)},setFunc:function(t,r,o){(i!==t||n!==r||s!==o)&&(e.stencilFunc(t,r,o),i=t,n=r,s=o)},setOp:function(t,r,i){(o!==t||a!==r||l!==i)&&(e.stencilOp(t,r,i),o=t,a=r,l=i)},setLocked:function(e){t=e},setClear:function(t){h!==t&&(e.clearStencil(t),h=t)},reset:function(){t=!1,r=null,i=null,n=null,s=null,o=null,a=null,l=null,h=null}}},o=new WeakMap,a=new WeakMap,l={},h={},u=new WeakMap,c=[],d=null,f=!1,p=null,g=null,m=null,v=null,b=null,y=null,x=null,_=new i.Ilk(0,0,0),S=0,w=!1,T=null,P=null,E=null,C=null,A=null,I=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),M=!1,R=0,O=e.getParameter(e.VERSION);-1!==O.indexOf("WebGL")?M=(R=parseFloat(/^WebGL (\d)/.exec(O)[1]))>=1:-1!==O.indexOf("OpenGL ES")&&(M=(R=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]))>=2);let k=null,N={},L=e.getParameter(e.SCISSOR_BOX),D=e.getParameter(e.VIEWPORT),B=new i.Ltg().fromArray(L),F=new i.Ltg().fromArray(D);function V(t,r,i,n){let s=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<i;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(r,0,e.RGBA,1,1,n,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage2D(r+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s);return o}let G={};function U(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function z(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}G[e.TEXTURE_2D]=V(e.TEXTURE_2D,e.TEXTURE_2D,1),G[e.TEXTURE_CUBE_MAP]=V(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),G[e.TEXTURE_2D_ARRAY]=V(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),G[e.TEXTURE_3D]=V(e.TEXTURE_3D,e.TEXTURE_3D,1,1),r.setClear(0,0,0,1),n.setClear(1),s.setClear(0),U(e.DEPTH_TEST),n.setFunc(i.vCF),q(!1),X(i.tm_),U(e.CULL_FACE),W(i.jFi);let j={[i.bGH]:e.FUNC_ADD,[i.Wbm]:e.FUNC_SUBTRACT,[i.rOj]:e.FUNC_REVERSE_SUBTRACT};j[i.r_]=e.MIN,j[i.Sm8]=e.MAX;let H={[i.c8b]:e.ZERO,[i.ghN]:e.ONE,[i.KhW]:e.SRC_COLOR,[i.k74]:e.SRC_ALPHA,[i.RlZ]:e.SRC_ALPHA_SATURATE,[i.Vdb]:e.DST_COLOR,[i.fSK]:e.DST_ALPHA,[i.iWC]:e.ONE_MINUS_SRC_COLOR,[i.LgZ]:e.ONE_MINUS_SRC_ALPHA,[i.Wpd]:e.ONE_MINUS_DST_COLOR,[i.Hy8]:e.ONE_MINUS_DST_ALPHA,[i._wr]:e.CONSTANT_COLOR,[i.Cy]:e.ONE_MINUS_CONSTANT_COLOR,[i.jes]:e.CONSTANT_ALPHA,[i.NKc]:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,r,n,s,o,a,l,h,u,c){if(t===i.jFi){!0===f&&(z(e.BLEND),f=!1);return}if(!1===f&&(U(e.BLEND),f=!0),t!==i.Xaj){if(t!==p||c!==w){if((g!==i.bGH||b!==i.bGH)&&(e.blendEquation(e.FUNC_ADD),g=i.bGH,b=i.bGH),c)switch(t){case i.bdR:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case i.WMw:e.blendFunc(e.ONE,e.ONE);break;case i.N4l:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case i.M5h:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case i.bdR:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case i.WMw:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case i.N4l:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case i.M5h:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}m=null,v=null,y=null,x=null,_.set(0,0,0),S=0,p=t,w=c}return}o=o||r,a=a||n,l=l||s,(r!==g||o!==b)&&(e.blendEquationSeparate(j[r],j[o]),g=r,b=o),(n!==m||s!==v||a!==y||l!==x)&&(e.blendFuncSeparate(H[n],H[s],H[a],H[l]),m=n,v=s,y=a,x=l),(!1===h.equals(_)||u!==S)&&(e.blendColor(h.r,h.g,h.b,u),_.copy(h),S=u),p=t,w=!1}function q(t){T!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),T=t)}function X(t){t!==i.PeU?(U(e.CULL_FACE),t!==P&&(t===i.tm_?e.cullFace(e.BACK):t===i.S2y?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),P=t}function $(t,r,i){t?(U(e.POLYGON_OFFSET_FILL),(C!==r||A!==i)&&(e.polygonOffset(r,i),C=r,A=i)):z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:n,stencil:s},enable:U,disable:z,bindFramebuffer:function(t,r){return h[t]!==r&&(e.bindFramebuffer(t,r),h[t]=r,t===e.DRAW_FRAMEBUFFER&&(h[e.FRAMEBUFFER]=r),t===e.FRAMEBUFFER&&(h[e.DRAW_FRAMEBUFFER]=r),!0)},drawBuffers:function(t,r){let i=c,n=!1;if(t){void 0===(i=u.get(r))&&(i=[],u.set(r,i));let s=t.textures;if(i.length!==s.length||i[0]!==e.COLOR_ATTACHMENT0){for(let t=0,r=s.length;t<r;t++)i[t]=e.COLOR_ATTACHMENT0+t;i.length=s.length,n=!0}}else i[0]!==e.BACK&&(i[0]=e.BACK,n=!0);n&&e.drawBuffers(i)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:W,setMaterial:function(t,o){t.side===i.ehD?z(e.CULL_FACE):U(e.CULL_FACE);let a=t.side===i._Li;o&&(a=!a),q(a),t.blending===i.bdR&&!1===t.transparent?W(i.jFi):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),n.setFunc(t.depthFunc),n.setTest(t.depthTest),n.setMask(t.depthWrite),r.setMask(t.colorWrite);let l=t.stencilWrite;s.setTest(l),l&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),$(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?U(e.SAMPLE_ALPHA_TO_COVERAGE):z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:X,setLineWidth:function(t){t!==E&&(M&&e.lineWidth(t),E=t)},setPolygonOffset:$,setScissorTest:function(t){t?U(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+I-1),k!==t&&(e.activeTexture(t),k=t)},bindTexture:function(t,r,i){void 0===i&&(i=null===k?e.TEXTURE0+I-1:k);let n=N[i];void 0===n&&(n={type:void 0,texture:void 0},N[i]=n),(n.type!==t||n.texture!==r)&&(k!==i&&(e.activeTexture(i),k=i),e.bindTexture(t,r||G[t]),n.type=t,n.texture=r)},unbindTexture:function(){let t=N[k];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,r){let i=a.get(r);void 0===i&&(i=new WeakMap,a.set(r,i));let n=i.get(t);void 0===n&&(n=e.getUniformBlockIndex(r,t.name),i.set(t,n))},uniformBlockBinding:function(t,r){let i=a.get(r).get(t);o.get(r)!==i&&(e.uniformBlockBinding(r,i,t.__bindingPointIndex),o.set(r,i))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===B.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),B.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),n.setReversed(!1),e.clearDepth(1),e.stencilMask(0xffffffff),e.stencilFunc(e.ALWAYS,0,0xffffffff),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},k=null,N={},h={},u=new WeakMap,c=[],d=null,f=!1,p=null,g=null,m=null,v=null,b=null,y=null,x=null,_=new i.Ilk(0,0,0),S=0,w=!1,T=null,P=null,E=null,C=null,A=null,B.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),r.reset(),n.reset(),s.reset()}}}function tm(e,t,r,n,s,o,a){let l;let h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,u="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new i.FM8,d=new WeakMap,f=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function g(e,t){return p?new OffscreenCanvas(e,t):(0,i.cac)("canvas")}function m(e,t,r){let i=1,n=U(e);if((n.width>r||n.height>r)&&(i=r/Math.max(n.width,n.height)),i<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){let r=Math.floor(i*n.width),s=Math.floor(i*n.height);void 0===l&&(l=g(r,s));let o=t?g(r,s):l;return o.width=r,o.height=s,o.getContext("2d").drawImage(e,0,0,r,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+n.width+"x"+n.height+") to ("+r+"x"+s+")."),o}"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+n.width+"x"+n.height+").")}return e}function v(e){return e.generateMipmaps}function b(t){e.generateMipmap(t)}function y(r,n,s,o,a=!1){if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let l=n;if(n===e.RED&&(s===e.FLOAT&&(l=e.R32F),s===e.HALF_FLOAT&&(l=e.R16F),s===e.UNSIGNED_BYTE&&(l=e.R8)),n===e.RED_INTEGER&&(s===e.UNSIGNED_BYTE&&(l=e.R8UI),s===e.UNSIGNED_SHORT&&(l=e.R16UI),s===e.UNSIGNED_INT&&(l=e.R32UI),s===e.BYTE&&(l=e.R8I),s===e.SHORT&&(l=e.R16I),s===e.INT&&(l=e.R32I)),n===e.RG&&(s===e.FLOAT&&(l=e.RG32F),s===e.HALF_FLOAT&&(l=e.RG16F),s===e.UNSIGNED_BYTE&&(l=e.RG8)),n===e.RG_INTEGER&&(s===e.UNSIGNED_BYTE&&(l=e.RG8UI),s===e.UNSIGNED_SHORT&&(l=e.RG16UI),s===e.UNSIGNED_INT&&(l=e.RG32UI),s===e.BYTE&&(l=e.RG8I),s===e.SHORT&&(l=e.RG16I),s===e.INT&&(l=e.RG32I)),n===e.RGB_INTEGER&&(s===e.UNSIGNED_BYTE&&(l=e.RGB8UI),s===e.UNSIGNED_SHORT&&(l=e.RGB16UI),s===e.UNSIGNED_INT&&(l=e.RGB32UI),s===e.BYTE&&(l=e.RGB8I),s===e.SHORT&&(l=e.RGB16I),s===e.INT&&(l=e.RGB32I)),n===e.RGBA_INTEGER&&(s===e.UNSIGNED_BYTE&&(l=e.RGBA8UI),s===e.UNSIGNED_SHORT&&(l=e.RGBA16UI),s===e.UNSIGNED_INT&&(l=e.RGBA32UI),s===e.BYTE&&(l=e.RGBA8I),s===e.SHORT&&(l=e.RGBA16I),s===e.INT&&(l=e.RGBA32I)),n===e.RGB&&s===e.UNSIGNED_INT_5_9_9_9_REV&&(l=e.RGB9_E5),n===e.RGBA){let t=a?i.l6D:i.epp.getTransfer(o);s===e.FLOAT&&(l=e.RGBA32F),s===e.HALF_FLOAT&&(l=e.RGBA16F),s===e.UNSIGNED_BYTE&&(l=t===i.j17?e.SRGB8_ALPHA8:e.RGBA8),s===e.UNSIGNED_SHORT_4_4_4_4&&(l=e.RGBA4),s===e.UNSIGNED_SHORT_5_5_5_1&&(l=e.RGB5_A1)}return(l===e.R16F||l===e.R32F||l===e.RG16F||l===e.RG32F||l===e.RGBA16F||l===e.RGBA32F)&&t.get("EXT_color_buffer_float"),l}function x(t,r){let n;return t?null===r||r===i.JQ4||r===i.wJv?n=e.DEPTH24_STENCIL8:r===i.VzW?n=e.DEPTH32F_STENCIL8:r===i.LsT&&(n=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===r||r===i.JQ4||r===i.wJv?n=e.DEPTH_COMPONENT24:r===i.VzW?n=e.DEPTH_COMPONENT32F:r===i.LsT&&(n=e.DEPTH_COMPONENT16),n}function _(e,t){if(!0===v(e)||e.isFramebufferTexture&&e.minFilter!==i.TyD&&e.minFilter!==i.wem)return Math.log2(Math.max(t.width,t.height))+1;if(void 0!==e.mipmaps&&e.mipmaps.length>0)return e.mipmaps.length;if(e.isCompressedTexture&&Array.isArray(e.image))return t.mipmaps.length;else return 1}function S(e){let t=e.target;t.removeEventListener("dispose",S),function(e){let t=n.get(e);if(void 0===t.__webglInit)return;let r=e.source,i=f.get(r);if(i){let n=i[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&T(e),0===Object.keys(i).length&&f.delete(r)}n.remove(e)}(t),t.isVideoTexture&&d.delete(t)}function w(t){let r=t.target;r.removeEventListener("dispose",w),function(t){let r=n.get(t);if(t.depthTexture&&(t.depthTexture.dispose(),n.remove(t.depthTexture)),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(r.__webglFramebuffer[t]))for(let i=0;i<r.__webglFramebuffer[t].length;i++)e.deleteFramebuffer(r.__webglFramebuffer[t][i]);else e.deleteFramebuffer(r.__webglFramebuffer[t]);r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[t])}else{if(Array.isArray(r.__webglFramebuffer))for(let t=0;t<r.__webglFramebuffer.length;t++)e.deleteFramebuffer(r.__webglFramebuffer[t]);else e.deleteFramebuffer(r.__webglFramebuffer);if(r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}let i=t.textures;for(let t=0,r=i.length;t<r;t++){let r=n.get(i[t]);r.__webglTexture&&(e.deleteTexture(r.__webglTexture),a.memory.textures--),n.remove(i[t])}n.remove(t)}(r)}function T(t){let r=n.get(t);e.deleteTexture(r.__webglTexture);let i=t.source,s=f.get(i);delete s[r.__cacheKey],a.memory.textures--}let P=0;function E(t,i){let s=n.get(t);if(t.isVideoTexture&&function(e){let t=a.render.frame;d.get(e)!==t&&(d.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version){let e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(!1===e.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{O(s,t,i);return}}r.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+i)}let C={[i.rpg]:e.REPEAT,[i.uWy]:e.CLAMP_TO_EDGE,[i.OoA]:e.MIRRORED_REPEAT},A={[i.TyD]:e.NEAREST,[i.YLQ]:e.NEAREST_MIPMAP_NEAREST,[i.aH4]:e.NEAREST_MIPMAP_LINEAR,[i.wem]:e.LINEAR,[i.qyh]:e.LINEAR_MIPMAP_NEAREST,[i.D1R]:e.LINEAR_MIPMAP_LINEAR},I={[i.xoQ]:e.NEVER,[i.T6w]:e.ALWAYS,[i.D67]:e.LESS,[i.M$G]:e.LEQUAL,[i.F1y]:e.EQUAL,[i.Jjb]:e.GEQUAL,[i.Zen]:e.GREATER,[i.O78]:e.NOTEQUAL};function M(r,o){if(o.type===i.VzW&&!1===t.has("OES_texture_float_linear")&&(o.magFilter===i.wem||o.magFilter===i.qyh||o.magFilter===i.aH4||o.magFilter===i.D1R||o.minFilter===i.wem||o.minFilter===i.qyh||o.minFilter===i.aH4||o.minFilter===i.D1R)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(r,e.TEXTURE_WRAP_S,C[o.wrapS]),e.texParameteri(r,e.TEXTURE_WRAP_T,C[o.wrapT]),(r===e.TEXTURE_3D||r===e.TEXTURE_2D_ARRAY)&&e.texParameteri(r,e.TEXTURE_WRAP_R,C[o.wrapR]),e.texParameteri(r,e.TEXTURE_MAG_FILTER,A[o.magFilter]),e.texParameteri(r,e.TEXTURE_MIN_FILTER,A[o.minFilter]),o.compareFunction&&(e.texParameteri(r,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(r,e.TEXTURE_COMPARE_FUNC,I[o.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(o.magFilter!==i.TyD&&(o.minFilter===i.aH4||o.minFilter===i.D1R)&&(o.type!==i.VzW||!1!==t.has("OES_texture_float_linear"))){if(o.anisotropy>1||n.get(o).__currentAnisotropy){let i=t.get("EXT_texture_filter_anisotropic");e.texParameterf(r,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,s.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy}}}}function R(t,r){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",S));let n=r.source,s=f.get(n);void 0===s&&(s={},f.set(n,s));let o=function(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(r);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;let n=s[t.__cacheKey];void 0!==n&&(s[t.__cacheKey].usedTimes--,0===n.usedTimes&&T(r)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return i}function O(t,a,l){let h=e.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(h=e.TEXTURE_2D_ARRAY),a.isData3DTexture&&(h=e.TEXTURE_3D);let u=R(t,a),c=a.source;r.bindTexture(h,t.__webglTexture,e.TEXTURE0+l);let d=n.get(c);if(c.version!==d.__version||!0===u){let t;r.activeTexture(e.TEXTURE0+l);let n=i.epp.getPrimaries(i.epp.workingColorSpace),f=a.colorSpace===i.aCh?null:i.epp.getPrimaries(a.colorSpace),p=a.colorSpace===i.aCh||n===f?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);let g=m(a.image,!1,s.maxTextureSize);g=G(a,g);let S=o.convert(a.format,a.colorSpace),w=o.convert(a.type),T=y(a.internalFormat,S,w,a.colorSpace,a.isVideoTexture);M(h,a);let P=a.mipmaps,E=!0!==a.isVideoTexture,C=void 0===d.__version||!0===u,A=c.dataReady,I=_(a,g);if(a.isDepthTexture)T=x(a.format===i.brP,a.type),C&&(E?r.texStorage2D(e.TEXTURE_2D,1,T,g.width,g.height):r.texImage2D(e.TEXTURE_2D,0,T,g.width,g.height,0,S,w,null));else if(a.isDataTexture){if(P.length>0){E&&C&&r.texStorage2D(e.TEXTURE_2D,I,T,P[0].width,P[0].height);for(let i=0,n=P.length;i<n;i++)t=P[i],E?A&&r.texSubImage2D(e.TEXTURE_2D,i,0,0,t.width,t.height,S,w,t.data):r.texImage2D(e.TEXTURE_2D,i,T,t.width,t.height,0,S,w,t.data);a.generateMipmaps=!1}else E?(C&&r.texStorage2D(e.TEXTURE_2D,I,T,g.width,g.height),A&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,g.width,g.height,S,w,g.data)):r.texImage2D(e.TEXTURE_2D,0,T,g.width,g.height,0,S,w,g.data)}else if(a.isCompressedTexture){if(a.isCompressedArrayTexture){E&&C&&r.texStorage3D(e.TEXTURE_2D_ARRAY,I,T,P[0].width,P[0].height,g.depth);for(let n=0,s=P.length;n<s;n++)if(t=P[n],a.format!==i.wk1){if(null!==S){if(E){if(A){if(a.layerUpdates.size>0){let s=(0,i.EcG)(t.width,t.height,a.format,a.type);for(let i of a.layerUpdates){let o=t.data.subarray(i*s/t.data.BYTES_PER_ELEMENT,(i+1)*s/t.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,i,t.width,t.height,1,S,o)}a.clearLayerUpdates()}else r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,0,t.width,t.height,g.depth,S,t.data)}}else r.compressedTexImage3D(e.TEXTURE_2D_ARRAY,n,T,t.width,t.height,g.depth,0,t.data,0,0)}else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()")}else E?A&&r.texSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,0,t.width,t.height,g.depth,S,w,t.data):r.texImage3D(e.TEXTURE_2D_ARRAY,n,T,t.width,t.height,g.depth,0,S,w,t.data)}else{E&&C&&r.texStorage2D(e.TEXTURE_2D,I,T,P[0].width,P[0].height);for(let n=0,s=P.length;n<s;n++)t=P[n],a.format!==i.wk1?null!==S?E?A&&r.compressedTexSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,S,t.data):r.compressedTexImage2D(e.TEXTURE_2D,n,T,t.width,t.height,0,t.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?A&&r.texSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,S,w,t.data):r.texImage2D(e.TEXTURE_2D,n,T,t.width,t.height,0,S,w,t.data)}}else if(a.isDataArrayTexture){if(E){if(C&&r.texStorage3D(e.TEXTURE_2D_ARRAY,I,T,g.width,g.height,g.depth),A){if(a.layerUpdates.size>0){let t=(0,i.EcG)(g.width,g.height,a.format,a.type);for(let i of a.layerUpdates){let n=g.data.subarray(i*t/g.data.BYTES_PER_ELEMENT,(i+1)*t/g.data.BYTES_PER_ELEMENT);r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,i,g.width,g.height,1,S,w,n)}a.clearLayerUpdates()}else r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,g.width,g.height,g.depth,S,w,g.data)}}else r.texImage3D(e.TEXTURE_2D_ARRAY,0,T,g.width,g.height,g.depth,0,S,w,g.data)}else if(a.isData3DTexture)E?(C&&r.texStorage3D(e.TEXTURE_3D,I,T,g.width,g.height,g.depth),A&&r.texSubImage3D(e.TEXTURE_3D,0,0,0,0,g.width,g.height,g.depth,S,w,g.data)):r.texImage3D(e.TEXTURE_3D,0,T,g.width,g.height,g.depth,0,S,w,g.data);else if(a.isFramebufferTexture){if(C){if(E)r.texStorage2D(e.TEXTURE_2D,I,T,g.width,g.height);else{let t=g.width,i=g.height;for(let n=0;n<I;n++)r.texImage2D(e.TEXTURE_2D,n,T,t,i,0,S,w,null),t>>=1,i>>=1}}}else if(P.length>0){if(E&&C){let t=U(P[0]);r.texStorage2D(e.TEXTURE_2D,I,T,t.width,t.height)}for(let i=0,n=P.length;i<n;i++)t=P[i],E?A&&r.texSubImage2D(e.TEXTURE_2D,i,0,0,S,w,t):r.texImage2D(e.TEXTURE_2D,i,T,S,w,t);a.generateMipmaps=!1}else if(E){if(C){let t=U(g);r.texStorage2D(e.TEXTURE_2D,I,T,t.width,t.height)}A&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,S,w,g)}else r.texImage2D(e.TEXTURE_2D,0,T,S,w,g);v(a)&&b(h),d.__version=c.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}function k(t,i,s,a,l,u){let c=o.convert(s.format,s.colorSpace),d=o.convert(s.type),f=y(s.internalFormat,c,d,s.colorSpace),p=n.get(i),g=n.get(s);if(g.__renderTarget=i,!p.__hasExternalTextures){let t=Math.max(1,i.width>>u),n=Math.max(1,i.height>>u);l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?r.texImage3D(l,u,f,t,n,i.depth,0,c,d,null):r.texImage2D(l,u,f,t,n,0,c,d,null)}r.bindFramebuffer(e.FRAMEBUFFER,t),V(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,a,l,g.__webglTexture,0,F(i)):(l===e.TEXTURE_2D||l>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,a,l,g.__webglTexture,u),r.bindFramebuffer(e.FRAMEBUFFER,null)}function N(t,r,i){if(e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer){let n=r.depthTexture,s=n&&n.isDepthTexture?n.type:null,o=x(r.stencilBuffer,s),a=r.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,l=F(r);V(r)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,l,o,r.width,r.height):i?e.renderbufferStorageMultisample(e.RENDERBUFFER,l,o,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,o,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,a,e.RENDERBUFFER,t)}else{let t=r.textures;for(let n=0;n<t.length;n++){let s=t[n],a=o.convert(s.format,s.colorSpace),l=o.convert(s.type),u=y(s.internalFormat,a,l,s.colorSpace),c=F(r);i&&!1===V(r)?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,u,r.width,r.height):V(r)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,u,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,u,r.width,r.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function L(t){let s=n.get(t),o=!0===t.isWebGLCubeRenderTarget;if(s.__boundDepthTexture!==t.depthTexture){let e=t.depthTexture;if(s.__depthDisposeCallback&&s.__depthDisposeCallback(),e){let t=()=>{delete s.__boundDepthTexture,delete s.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),s.__depthDisposeCallback=t}s.__boundDepthTexture=e}if(t.depthTexture&&!s.__autoAllocateDepthBuffer){if(o)throw Error("target.depthTexture not supported in Cube render targets");!function(t,s){if(s&&s.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(e.FRAMEBUFFER,t),!(s.depthTexture&&s.depthTexture.isDepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let o=n.get(s.depthTexture);o.__renderTarget=s,(!o.__webglTexture||s.depthTexture.image.width!==s.width||s.depthTexture.image.height!==s.height)&&(s.depthTexture.image.width=s.width,s.depthTexture.image.height=s.height,s.depthTexture.needsUpdate=!0),E(s.depthTexture,0);let a=o.__webglTexture,l=F(s);if(s.depthTexture.format===i.qkB)V(s)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else if(s.depthTexture.format===i.brP)V(s)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0);else throw Error("Unknown depthTexture format")}(s.__webglFramebuffer,t)}else if(o){s.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(r.bindFramebuffer(e.FRAMEBUFFER,s.__webglFramebuffer[i]),void 0===s.__webglDepthbuffer[i])s.__webglDepthbuffer[i]=e.createRenderbuffer(),N(s.__webglDepthbuffer[i],t,!1);else{let r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,n=s.__webglDepthbuffer[i];e.bindRenderbuffer(e.RENDERBUFFER,n),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,n)}}else if(r.bindFramebuffer(e.FRAMEBUFFER,s.__webglFramebuffer),void 0===s.__webglDepthbuffer)s.__webglDepthbuffer=e.createRenderbuffer(),N(s.__webglDepthbuffer,t,!1);else{let r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=s.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,i)}r.bindFramebuffer(e.FRAMEBUFFER,null)}let D=[],B=[];function F(e){return Math.min(s.maxSamples,e.samples)}function V(e){let r=n.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function G(e,t){let r=e.colorSpace,n=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture?t:(r!==i.GUF&&r!==i.aCh&&(i.epp.getTransfer(r)===i.j17?(n!==i.wk1||s!==i.ywz)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),t)}function U(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){let e=P;return e>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+s.maxTextures),P+=1,e},this.resetTextureUnits=function(){P=0},this.setTexture2D=E,this.setTexture2DArray=function(t,i){let s=n.get(t);if(t.version>0&&s.__version!==t.version){O(s,t,i);return}r.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){let s=n.get(t);if(t.version>0&&s.__version!==t.version){O(s,t,i);return}r.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,a){let l=n.get(t);if(t.version>0&&l.__version!==t.version){(function(t,a,l){if(6!==a.image.length)return;let h=R(t,a),u=a.source;r.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+l);let c=n.get(u);if(u.version!==c.__version||!0===h){let t;r.activeTexture(e.TEXTURE0+l);let n=i.epp.getPrimaries(i.epp.workingColorSpace),d=a.colorSpace===i.aCh?null:i.epp.getPrimaries(a.colorSpace),f=a.colorSpace===i.aCh||n===d?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,f);let p=a.isCompressedTexture||a.image[0].isCompressedTexture,g=a.image[0]&&a.image[0].isDataTexture,x=[];for(let e=0;e<6;e++)p||g?x[e]=g?a.image[e].image:a.image[e]:x[e]=m(a.image[e],!0,s.maxCubemapSize),x[e]=G(a,x[e]);let S=x[0],w=o.convert(a.format,a.colorSpace),T=o.convert(a.type),P=y(a.internalFormat,w,T,a.colorSpace),E=!0!==a.isVideoTexture,C=void 0===c.__version||!0===h,A=u.dataReady,I=_(a,S);if(M(e.TEXTURE_CUBE_MAP,a),p){E&&C&&r.texStorage2D(e.TEXTURE_CUBE_MAP,I,P,S.width,S.height);for(let n=0;n<6;n++){t=x[n].mipmaps;for(let s=0;s<t.length;s++){let o=t[s];a.format!==i.wk1?null!==w?E?A&&r.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,s,0,0,o.width,o.height,w,o.data):r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,s,P,o.width,o.height,0,o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,s,0,0,o.width,o.height,w,T,o.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,s,P,o.width,o.height,0,w,T,o.data)}}}else{if(t=a.mipmaps,E&&C){t.length>0&&I++;let i=U(x[0]);r.texStorage2D(e.TEXTURE_CUBE_MAP,I,P,i.width,i.height)}for(let i=0;i<6;i++)if(g){E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,0,0,x[i].width,x[i].height,w,T,x[i].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,P,x[i].width,x[i].height,0,w,T,x[i].data);for(let n=0;n<t.length;n++){let s=t[n].image[i].image;E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,n+1,0,0,s.width,s.height,w,T,s.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,n+1,P,s.width,s.height,0,w,T,s.data)}}else{E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,0,0,w,T,x[i]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,P,w,T,x[i]);for(let n=0;n<t.length;n++){let s=t[n];E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,n+1,0,0,w,T,s.image[i]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,n+1,P,w,T,s.image[i])}}}v(a)&&b(e.TEXTURE_CUBE_MAP),c.__version=u.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version})(l,t,a);return}r.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture,e.TEXTURE0+a)},this.rebindTextures=function(t,r,i){let s=n.get(t);void 0!==r&&k(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&L(t)},this.setupRenderTarget=function(t){let i=t.texture,s=n.get(t),l=n.get(i);t.addEventListener("dispose",w);let h=t.textures,u=!0===t.isWebGLCubeRenderTarget,c=h.length>1;if(!c&&(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,a.memory.textures++),u){s.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer[t]=[];for(let r=0;r<i.mipmaps.length;r++)s.__webglFramebuffer[t][r]=e.createFramebuffer()}else s.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)s.__webglFramebuffer[t]=e.createFramebuffer()}else s.__webglFramebuffer=e.createFramebuffer();if(c)for(let t=0,r=h.length;t<r;t++){let r=n.get(h[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),a.memory.textures++)}if(t.samples>0&&!1===V(t)){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=[],r.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer);for(let r=0;r<h.length;r++){let i=h[r];s.__webglColorRenderbuffer[r]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer[r]);let n=o.convert(i.format,i.colorSpace),a=o.convert(i.type),l=y(i.internalFormat,n,a,i.colorSpace,!0===t.isXRRenderTarget),u=F(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+r,e.RENDERBUFFER,s.__webglColorRenderbuffer[r])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),N(s.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){r.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),M(e.TEXTURE_CUBE_MAP,i);for(let r=0;r<6;r++)if(i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)k(s.__webglFramebuffer[r][n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,n);else k(s.__webglFramebuffer[r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0);v(i)&&b(e.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(c){for(let i=0,o=h.length;i<o;i++){let o=h[i],a=n.get(o);r.bindTexture(e.TEXTURE_2D,a.__webglTexture),M(e.TEXTURE_2D,o),k(s.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0+i,e.TEXTURE_2D,0),v(o)&&b(e.TEXTURE_2D)}r.unbindTexture()}else{let n=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(n=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(n,l.__webglTexture),M(n,i),i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)k(s.__webglFramebuffer[r],t,i,e.COLOR_ATTACHMENT0,n,r);else k(s.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,n,0);v(i)&&b(n),r.unbindTexture()}t.depthBuffer&&L(t)},this.updateRenderTargetMipmap=function(t){let i=t.textures;for(let o=0,a=i.length;o<a;o++){let a=i[o];if(v(a)){var s;let i=(s=t).isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:s.isWebGL3DRenderTarget?e.TEXTURE_3D:s.isWebGLArrayRenderTarget||s.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D,o=n.get(a).__webglTexture;r.bindTexture(i,o),b(i),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0){if(!1===V(t)){let i=t.textures,s=t.width,o=t.height,a=e.COLOR_BUFFER_BIT,l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,h=n.get(t),c=i.length>1;if(c)for(let t=0;t<i.length;t++)r.bindFramebuffer(e.FRAMEBUFFER,h.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),r.bindFramebuffer(e.FRAMEBUFFER,h.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);r.bindFramebuffer(e.READ_FRAMEBUFFER,h.__webglMultisampledFramebuffer),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,h.__webglFramebuffer);for(let r=0;r<i.length;r++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(a|=e.STENCIL_BUFFER_BIT)),c){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,h.__webglColorRenderbuffer[r]);let t=n.get(i[r]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,a,e.NEAREST),!0===u&&(D.length=0,B.length=0,D.push(e.COLOR_ATTACHMENT0+r),t.depthBuffer&&!1===t.resolveDepthBuffer&&(D.push(l),B.push(l),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,B)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,D))}if(r.bindFramebuffer(e.READ_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),c)for(let t=0;t<i.length;t++){r.bindFramebuffer(e.FRAMEBUFFER,h.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,h.__webglColorRenderbuffer[t]);let s=n.get(i[t]).__webglTexture;r.bindFramebuffer(e.FRAMEBUFFER,h.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}r.bindFramebuffer(e.DRAW_FRAMEBUFFER,h.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&u){let r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[r])}}},this.setupDepthRenderbuffer=L,this.setupFrameBufferTexture=k,this.useMultisampledRTT=V}function tv(e,t){return{convert:function(r,n=i.aCh){let s;let o=i.epp.getTransfer(n);if(r===i.ywz)return e.UNSIGNED_BYTE;if(r===i.k0A)return e.UNSIGNED_SHORT_4_4_4_4;if(r===i.irR)return e.UNSIGNED_SHORT_5_5_5_1;if(r===i.tQZ)return e.UNSIGNED_INT_5_9_9_9_REV;if(r===i.T95)return e.BYTE;if(r===i.iAb)return e.SHORT;if(r===i.LsT)return e.UNSIGNED_SHORT;if(r===i.Kz5)return e.INT;if(r===i.JQ4)return e.UNSIGNED_INT;if(r===i.VzW)return e.FLOAT;if(r===i.cLu)return e.HALF_FLOAT;if(r===i.OTo)return e.ALPHA;if(r===i.UCm)return e.RGB;if(r===i.wk1)return e.RGBA;if(r===i.Y8D)return e.LUMINANCE;if(r===i.cRx)return e.LUMINANCE_ALPHA;if(r===i.qkB)return e.DEPTH_COMPONENT;if(r===i.brP)return e.DEPTH_STENCIL;if(r===i.hEm)return e.RED;if(r===i.D9w)return e.RED_INTEGER;if(r===i.av9)return e.RG;if(r===i.CtA)return e.RG_INTEGER;if(r===i.E2K)return e.RGBA_INTEGER;if(r===i.wuA||r===i.BFQ||r===i.v3W||r===i.ILR){if(o===i.j17){if(null===(s=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(r===i.wuA)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===i.BFQ)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===i.v3W)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===i.ILR)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(s=t.get("WEBGL_compressed_texture_s3tc")))return null;if(r===i.wuA)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===i.BFQ)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===i.v3W)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===i.ILR)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}}if(r===i._AM||r===i.vCx||r===i.eaV||r===i.CaW){if(null===(s=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(r===i._AM)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===i.vCx)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===i.eaV)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===i.CaW)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===i.fto||r===i.l0P||r===i.ekQ){if(null===(s=t.get("WEBGL_compressed_texture_etc")))return null;if(r===i.fto||r===i.l0P)return o===i.j17?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===i.ekQ)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(r===i.ptH||r===i.jZA||r===i.y2t||r===i.gi4||r===i.Djp||r===i.BG$||r===i.NYV||r===i.xJs||r===i.pKu||r===i.GG6||r===i.Gih||r===i.FUD||r===i.iiP||r===i.SvJ){if(null===(s=t.get("WEBGL_compressed_texture_astc")))return null;if(r===i.ptH)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===i.jZA)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===i.y2t)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===i.gi4)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===i.Djp)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===i.BG$)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===i.NYV)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===i.xJs)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===i.pKu)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===i.GG6)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===i.Gih)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===i.FUD)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===i.iiP)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===i.SvJ)return o===i.j17?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===i.bsb||r===i.f2y||r===i.QO2){if(null===(s=t.get("EXT_texture_compression_bptc")))return null;if(r===i.bsb)return o===i.j17?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===i.f2y)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===i.QO2)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(r===i.HdW||r===i.vuL||r===i.ZTh||r===i.lGU){if(null===(s=t.get("EXT_texture_compression_rgtc")))return null;if(r===i.bsb)return s.COMPRESSED_RED_RGTC1_EXT;if(r===i.vuL)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===i.ZTh)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===i.lGU)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===i.wJv?e.UNSIGNED_INT_24_8:void 0!==e[r]?e[r]:null}}}let tb={type:"move"};class ty{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new i.ZAu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new i.ZAu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new i.Pa4,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new i.Pa4),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new i.ZAu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new i.Pa4,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new i.Pa4),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null,o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){for(let i of(s=!0,e.hand.values())){let e=t.getJointPose(i,r),n=this._getHandJoint(l,i);null!==e&&(n.matrix.fromArray(e.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.matrixWorldNeedsUpdate=!0,n.jointRadius=e.radius),n.visible=null!==e}let i=l.joints["index-finger-tip"],n=l.joints["thumb-tip"],o=i.position.distanceTo(n.position);l.inputState.pinching&&o>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&null!==(n=t.getPose(e.gripSpace,r))&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1);null!==o&&(null===(i=t.getPose(e.targetRaySpace,r))&&null!==n&&(i=n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(tb)))}return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==n),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let r=new i.ZAu;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}let tx=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,t_=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class tS{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(null===this.texture){let n=new i.xEZ;e.properties.get(n).__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){let t=e.cameras[0].viewport,r=new i.jyz({vertexShader:tx,fragmentShader:t_,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new i.Kj0(new i._12(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class tw extends i.pBf{constructor(e,t){super();let r=this,s=null,o=1,a=null,l="local-floor",h=1,u=null,c=null,d=null,f=null,p=null,g=null,m=new tS,v=t.getContextAttributes(),b=null,y=null,x=[],_=[],S=new i.FM8,w=null,T=new i.cPb;T.viewport=new i.Ltg;let P=new i.cPb;P.viewport=new i.Ltg;let E=[T,P],C=new i.HkE,A=null,I=null;function M(e){let t=_.indexOf(e.inputSource);if(-1===t)return;let r=x[t];void 0!==r&&(r.update(e.inputSource,e.frame,u||a),r.dispatchEvent({type:e.type,data:e.inputSource}))}function R(){s.removeEventListener("select",M),s.removeEventListener("selectstart",M),s.removeEventListener("selectend",M),s.removeEventListener("squeeze",M),s.removeEventListener("squeezestart",M),s.removeEventListener("squeezeend",M),s.removeEventListener("end",R),s.removeEventListener("inputsourceschange",O);for(let e=0;e<x.length;e++){let t=_[e];null!==t&&(_[e]=null,x[e].disconnect(t))}A=null,I=null,m.reset(),e.setRenderTarget(b),p=null,f=null,d=null,s=null,y=null,B.stop(),r.isPresenting=!1,e.setPixelRatio(w),e.setSize(S.width,S.height,!1),r.dispatchEvent({type:"sessionend"})}function O(e){for(let t=0;t<e.removed.length;t++){let r=e.removed[t],i=_.indexOf(r);i>=0&&(_[i]=null,x[i].disconnect(r))}for(let t=0;t<e.added.length;t++){let r=e.added[t],i=_.indexOf(r);if(-1===i){for(let e=0;e<x.length;e++){if(e>=_.length){_.push(r),i=e;break}if(null===_[e]){_[e]=r,i=e;break}}if(-1===i)break}let n=x[i];n&&n.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=x[e];return void 0===t&&(t=new ty,x[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=x[e];return void 0===t&&(t=new ty,x[e]=t),t.getGripSpace()},this.getHand=function(e){let t=x[e];return void 0===t&&(t=new ty,x[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){o=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){l=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(e){u=e},this.getBaseLayer=function(){return null!==f?f:p},this.getBinding=function(){return d},this.getFrame=function(){return g},this.getSession=function(){return s},this.setSession=async function(n){if(null!==(s=n)){if(b=e.getRenderTarget(),s.addEventListener("select",M),s.addEventListener("selectstart",M),s.addEventListener("selectend",M),s.addEventListener("squeeze",M),s.addEventListener("squeezestart",M),s.addEventListener("squeezeend",M),s.addEventListener("end",R),s.addEventListener("inputsourceschange",O),!0!==v.xrCompatible&&await t.makeXRCompatible(),w=e.getPixelRatio(),e.getSize(S),void 0===s.renderState.layers){let r={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(s,t,r),s.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),y=new i.dd2(p.framebufferWidth,p.framebufferHeight,{format:i.wk1,type:i.ywz,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let r=null,n=null,a=null;v.depth&&(a=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,r=v.stencil?i.brP:i.qkB,n=v.stencil?i.wJv:i.JQ4);let l={colorFormat:t.RGBA8,depthFormat:a,scaleFactor:o};f=(d=new XRWebGLBinding(s,t)).createProjectionLayer(l),s.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),y=new i.dd2(f.textureWidth,f.textureHeight,{format:i.wk1,type:i.ywz,depthTexture:new i.$YQ(f.textureWidth,f.textureHeight,n,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===f.ignoreDepthValues})}y.isXRRenderTarget=!0,this.setFoveation(h),u=null,a=await s.requestReferenceSpace(l),B.setContext(s),B.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};let k=new i.Pa4,N=new i.Pa4;function L(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===s)return;let t=e.near,r=e.far;null!==m.texture&&(m.depthNear>0&&(t=m.depthNear),m.depthFar>0&&(r=m.depthFar)),C.near=P.near=T.near=t,C.far=P.far=T.far=r,(A!==C.near||I!==C.far)&&(s.updateRenderState({depthNear:C.near,depthFar:C.far}),A=C.near,I=C.far),T.layers.mask=2|e.layers.mask,P.layers.mask=4|e.layers.mask,C.layers.mask=T.layers.mask|P.layers.mask;let n=e.parent,o=C.cameras;L(C,n);for(let e=0;e<o.length;e++)L(o[e],n);2===o.length?!function(e,t,r){k.setFromMatrixPosition(t.matrixWorld),N.setFromMatrixPosition(r.matrixWorld);let i=k.distanceTo(N),n=t.projectionMatrix.elements,s=r.projectionMatrix.elements,o=n[14]/(n[10]-1),a=n[14]/(n[10]+1),l=(n[9]+1)/n[5],h=(n[9]-1)/n[5],u=(n[8]-1)/n[0],c=(s[8]+1)/s[0],d=i/(-u+c),f=-(d*u);if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(d),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===n[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{let t=o+d,r=a+d;e.projectionMatrix.makePerspective(o*u-f,o*c+(i-f),l*a/r*t,h*a/r*t,t,r),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(C,T,P):C.projectionMatrix.copy(T.projectionMatrix),function(e,t,r){null===r?e.matrix.copy(t.matrixWorld):(e.matrix.copy(r.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld)),e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*i.I3e*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,C,n)};this.getCamera=function(){return C},this.getFoveation=function(){if(null!==f||null!==p)return h},this.setFoveation=function(e){h=e,null!==f&&(f.fixedFoveation=e),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(C)};let D=null,B=new n;B.setAnimationLoop(function(t,n){if(c=n.getViewerPose(u||a),g=n,null!==c){let t=c.views;null!==p&&(e.setRenderTargetFramebuffer(y,p.framebuffer),e.setRenderTarget(y));let r=!1;t.length!==C.cameras.length&&(C.cameras.length=0,r=!0);for(let n=0;n<t.length;n++){let s=t[n],o=null;if(null!==p)o=p.getViewport(s);else{let t=d.getViewSubImage(f,s);o=t.viewport,0===n&&(e.setRenderTargetTextures(y,t.colorTexture,f.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(y))}let a=E[n];void 0===a&&((a=new i.cPb).layers.enable(n),a.viewport=new i.Ltg,E[n]=a),a.matrix.fromArray(s.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(s.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(o.x,o.y,o.width,o.height),0===n&&(C.matrix.copy(a.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),!0===r&&C.cameras.push(a)}let n=s.enabledFeatures;if(n&&n.includes("depth-sensing")){let r=d.getDepthInformation(t[0]);r&&r.isValid&&r.texture&&m.init(e,r,s.renderState)}}for(let e=0;e<x.length;e++){let t=_[e],r=x[e];null!==t&&void 0!==r&&r.update(t,n,u||a)}D&&D(t,n),n.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:n}),g=null}),this.setAnimationLoop=function(e){D=e},this.dispose=function(){}}}let tT=new i.USm,tP=new i.yGw;function tE(e,t){function r(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function n(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map,r(n.map,e.mapTransform)),n.alphaMap&&(e.alphaMap.value=n.alphaMap,r(n.alphaMap,e.alphaMapTransform)),n.bumpMap&&(e.bumpMap.value=n.bumpMap,r(n.bumpMap,e.bumpMapTransform),e.bumpScale.value=n.bumpScale,n.side===i._Li&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,r(n.normalMap,e.normalMapTransform),e.normalScale.value.copy(n.normalScale),n.side===i._Li&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,r(n.displacementMap,e.displacementMapTransform),e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap,r(n.emissiveMap,e.emissiveMapTransform)),n.specularMap&&(e.specularMap.value=n.specularMap,r(n.specularMap,e.specularMapTransform)),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);let s=t.get(n),o=s.envMap,a=s.envMapRotation;o&&(e.envMap.value=o,tT.copy(a),tT.x*=-1,tT.y*=-1,tT.z*=-1,o.isCubeTexture&&!1===o.isRenderTargetTexture&&(tT.y*=-1,tT.z*=-1),e.envMapRotation.value.setFromMatrix4(tP.makeRotationFromEuler(tT)),e.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity,r(n.lightMap,e.lightMapTransform)),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity,r(n.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,r){r.color.getRGB(t.fogColor.value,(0,i.oDz)(e)),r.isFog?(t.fogNear.value=r.near,t.fogFar.value=r.far):r.isFogExp2&&(t.fogDensity.value=r.density)},refreshMaterialUniforms:function(e,s,o,a,l){s.isMeshBasicMaterial?n(e,s):s.isMeshLambertMaterial?n(e,s):s.isMeshToonMaterial?(n(e,s),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,s)):s.isMeshPhongMaterial?(n(e,s),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,s)):s.isMeshStandardMaterial?(n(e,s),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,r(t.metalnessMap,e.metalnessMapTransform)),e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,r(t.roughnessMap,e.roughnessMapTransform)),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,s),s.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,r(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,r(t.sheenRoughnessMap,e.sheenRoughnessMapTransform))),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,r(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,r(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,r(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===i._Li&&e.clearcoatNormalScale.value.negate())),t.dispersion>0&&(e.dispersion.value=t.dispersion),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,r(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,r(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,r(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,r(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,r(t.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,r(t.specularColorMap,e.specularColorMapTransform)),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,r(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,s,l)):s.isMeshMatcapMaterial?(n(e,s),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,s)):s.isMeshDepthMaterial?n(e,s):s.isMeshDistanceMaterial?(n(e,s),function(e,r){let i=t.get(r).light;e.referencePosition.value.setFromMatrixPosition(i.matrixWorld),e.nearDistance.value=i.shadow.camera.near,e.farDistance.value=i.shadow.camera.far}(e,s)):s.isMeshNormalMaterial?n(e,s):s.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,r(t.map,e.mapTransform))}(e,s),s.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,s)):s.isPointsMaterial?function(e,t,i,n){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*i,e.scale.value=.5*n,t.map&&(e.map.value=t.map,r(t.map,e.uvTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,r(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,s,o,a):s.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,r(t.map,e.mapTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,r(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,s):s.isShadowMaterial?(e.color.value.copy(s.color),e.opacity.value=s.opacity):s.isShaderMaterial&&(s.uniformsNeedUpdate=!1)}}}function tC(e,t,r,i){let n={},s={},o=[],a=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e){let t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function h(t){let r=t.target;r.removeEventListener("dispose",h);let i=o.indexOf(r.__bindingPointIndex);o.splice(i,1),e.deleteBuffer(n[r.id]),delete n[r.id],delete s[r.id]}return{bind:function(e,t){let r=t.program;i.uniformBlockBinding(e,r)},update:function(r,u){let c=n[r.id];void 0===c&&(function(e){let t=e.uniforms,r=0;for(let e=0,i=t.length;e<i;e++){let i=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=i.length;e<t;e++){let t=i[e],n=Array.isArray(t.value)?t.value:[t.value];for(let e=0,i=n.length;e<i;e++){let i=l(n[e]),s=r%16,o=s%i.boundary,a=s+o;r+=o,0!==a&&16-a<i.storage&&(r+=16-a),t.__data=new Float32Array(i.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=r,r+=i.storage}}}let i=r%16;i>0&&(r+=16-i),e.__size=r,e.__cache={},this}(r),c=function(t){let r=function(){for(let e=0;e<a;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=r;let i=e.createBuffer(),n=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,i),e.bufferData(e.UNIFORM_BUFFER,n,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,r,i),i}(r),n[r.id]=c,r.addEventListener("dispose",h));let d=u.program;i.updateUBOMapping(r,d);let f=t.render.frame;s[r.id]!==f&&(function(t){let r=n[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,r);for(let t=0,r=i.length;t<r;t++){let r=Array.isArray(i[t])?i[t]:[i[t]];for(let i=0,n=r.length;i<n;i++){let n=r[i];if(!0===function(e,t,r,i){let n=e.value,s=t+"_"+r;if(void 0===i[s])return"number"==typeof n||"boolean"==typeof n?i[s]=n:i[s]=n.clone(),!0;{let e=i[s];if("number"==typeof n||"boolean"==typeof n){if(e!==n)return i[s]=n,!0}else if(!1===e.equals(n))return e.copy(n),!0}return!1}(n,t,i,s)){let t=n.__offset,r=Array.isArray(n.value)?n.value:[n.value],i=0;for(let s=0;s<r.length;s++){let o=r[s],a=l(o);"number"==typeof o||"boolean"==typeof o?(n.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+i,n.__data)):o.isMatrix3?(n.__data[0]=o.elements[0],n.__data[1]=o.elements[1],n.__data[2]=o.elements[2],n.__data[3]=0,n.__data[4]=o.elements[3],n.__data[5]=o.elements[4],n.__data[6]=o.elements[5],n.__data[7]=0,n.__data[8]=o.elements[6],n.__data[9]=o.elements[7],n.__data[10]=o.elements[8],n.__data[11]=0):(o.toArray(n.__data,i),i+=a.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,n.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(r),s[r.id]=f)},dispose:function(){for(let t in n)e.deleteBuffer(n[t]);o=[],n={},s={}}}}class tA{constructor(e={}){let t,r,o,a,l,h,u,c,b,y,x,_,S,w,T,P,E,C,A,I,M,R,O,k,U;let{canvas:z=(0,i.O5A)(),context:j=null,depth:H=!0,stencil:W=!1,alpha:q=!1,antialias:X=!1,premultipliedAlpha:$=!0,preserveDrawingBuffer:Y=!1,powerPreference:Z="default",failIfMajorPerformanceCaveat:K=!1,reverseDepthBuffer:J=!1}=e;if(this.isWebGLRenderer=!0,null!==j){if("undefined"!=typeof WebGLRenderingContext&&j instanceof WebGLRenderingContext)throw Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");t=j.getContextAttributes().alpha}else t=q;let Q=new Uint32Array(4),ee=new Int32Array(4),et=null,er=null,ei=[],en=[];this.domElement=z,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=i.KI_,this.toneMapping=i.uL9,this.toneMappingExposure=1;let es=this,eo=!1,ea=0,el=0,eh=null,eu=-1,ec=null,ed=new i.Ltg,ef=new i.Ltg,ep=null,eg=new i.Ilk(0),em=0,ev=z.width,eb=z.height,ey=1,ex=null,e_=null,eS=new i.Ltg(0,0,ev,eb),ew=new i.Ltg(0,0,ev,eb),eT=!1,eP=new i.iWj,eE=!1,eC=!1,eA=new i.yGw,eI=new i.yGw,eM=new i.Pa4,eR=new i.Ltg,eO={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},ek=!1;function eN(){return null===eh?ey:1}let eL=j;function eD(e,t){return z.getContext(e,t)}try{if("setAttribute"in z&&z.setAttribute("data-engine",`three.js r${i.UZH}`),z.addEventListener("webglcontextlost",eV,!1),z.addEventListener("webglcontextrestored",eG,!1),z.addEventListener("webglcontextcreationerror",eU,!1),null===eL){let e="webgl2";if(eL=eD(e,{alpha:!0,depth:H,stencil:W,antialias:X,premultipliedAlpha:$,preserveDrawingBuffer:Y,powerPreference:Z,failIfMajorPerformanceCaveat:K}),null===eL){if(eD(e))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}}}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function eB(){(r=new L(eL)).init(),O=new tv(eL,r),o=new g(eL,r,e,O),a=new tg(eL,r),o.reverseDepthBuffer&&J&&a.buffers.depth.setReversed(!0),l=new F(eL),h=new tr,u=new tm(eL,r,a,h,o,O,l),c=new v(es),b=new N(es),y=new s(eL),k=new f(eL,y),x=new D(eL,y,l,k),_=new G(eL,x,y,l),I=new V(eL,o,u),E=new m(h),S=new tt(es,c,b,r,o,k,E),w=new tE(es,h),T=new to,P=new td(r),A=new d(es,c,b,a,_,t,$),C=new tf(es,_,o),U=new tC(eL,l,o,a),M=new p(eL,r,l),R=new B(eL,r,l),l.programs=S.programs,es.capabilities=o,es.extensions=r,es.properties=h,es.renderLists=T,es.shadowMap=C,es.state=a,es.info=l}eB();let eF=new tw(es,eL);function eV(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),eo=!0}function eG(){console.log("THREE.WebGLRenderer: Context Restored."),eo=!1;let e=l.autoReset,t=C.enabled,r=C.autoUpdate,i=C.needsUpdate,n=C.type;eB(),l.autoReset=e,C.enabled=t,C.autoUpdate=r,C.needsUpdate=i,C.type=n}function eU(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function ez(e){let t=e.target;t.removeEventListener("dispose",ez),function(e){(function(e){let t=h.get(e).programs;void 0!==t&&(t.forEach(function(e){S.releaseProgram(e)}),e.isShaderMaterial&&S.releaseShaderCache(e))})(e),h.remove(e)}(t)}this.xr=eF,this.getContext=function(){return eL},this.getContextAttributes=function(){return eL.getContextAttributes()},this.forceContextLoss=function(){let e=r.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=r.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return ey},this.setPixelRatio=function(e){void 0!==e&&(ey=e,this.setSize(ev,eb,!1))},this.getSize=function(e){return e.set(ev,eb)},this.setSize=function(e,t,r=!0){if(eF.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ev=e,eb=t,z.width=Math.floor(e*ey),z.height=Math.floor(t*ey),!0===r&&(z.style.width=e+"px",z.style.height=t+"px"),this.setViewport(0,0,e,t)},this.getDrawingBufferSize=function(e){return e.set(ev*ey,eb*ey).floor()},this.setDrawingBufferSize=function(e,t,r){ev=e,eb=t,ey=r,z.width=Math.floor(e*r),z.height=Math.floor(t*r),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(ed)},this.getViewport=function(e){return e.copy(eS)},this.setViewport=function(e,t,r,i){e.isVector4?eS.set(e.x,e.y,e.z,e.w):eS.set(e,t,r,i),a.viewport(ed.copy(eS).multiplyScalar(ey).round())},this.getScissor=function(e){return e.copy(ew)},this.setScissor=function(e,t,r,i){e.isVector4?ew.set(e.x,e.y,e.z,e.w):ew.set(e,t,r,i),a.scissor(ef.copy(ew).multiplyScalar(ey).round())},this.getScissorTest=function(){return eT},this.setScissorTest=function(e){a.setScissorTest(eT=e)},this.setOpaqueSort=function(e){ex=e},this.setTransparentSort=function(e){e_=e},this.getClearColor=function(e){return e.copy(A.getClearColor())},this.setClearColor=function(){A.setClearColor.apply(A,arguments)},this.getClearAlpha=function(){return A.getClearAlpha()},this.setClearAlpha=function(){A.setClearAlpha.apply(A,arguments)},this.clear=function(e=!0,t=!0,r=!0){let n=0;if(e){let e=!1;if(null!==eh){let t=eh.texture.format;e=t===i.E2K||t===i.CtA||t===i.D9w}if(e){let e=eh.texture.type,t=e===i.ywz||e===i.JQ4||e===i.LsT||e===i.wJv||e===i.k0A||e===i.irR,r=A.getClearColor(),n=A.getClearAlpha(),s=r.r,o=r.g,a=r.b;t?(Q[0]=s,Q[1]=o,Q[2]=a,Q[3]=n,eL.clearBufferuiv(eL.COLOR,0,Q)):(ee[0]=s,ee[1]=o,ee[2]=a,ee[3]=n,eL.clearBufferiv(eL.COLOR,0,ee))}else n|=eL.COLOR_BUFFER_BIT}t&&(n|=eL.DEPTH_BUFFER_BIT),r&&(n|=eL.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(0xffffffff)),eL.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){z.removeEventListener("webglcontextlost",eV,!1),z.removeEventListener("webglcontextrestored",eG,!1),z.removeEventListener("webglcontextcreationerror",eU,!1),A.dispose(),T.dispose(),P.dispose(),h.dispose(),c.dispose(),b.dispose(),_.dispose(),k.dispose(),U.dispose(),S.dispose(),eF.dispose(),eF.removeEventListener("sessionstart",eq),eF.removeEventListener("sessionend",eX),e$.stop()};function ej(e,t,r){!0===e.transparent&&e.side===i.ehD&&!1===e.forceSinglePass?(e.side=i._Li,e.needsUpdate=!0,e1(e,t,r),e.side=i.Wl3,e.needsUpdate=!0,e1(e,t,r),e.side=i.ehD):e1(e,t,r)}this.renderBufferDirect=function(e,t,n,s,l,d){let f;null===t&&(t=eO);let p=l.isMesh&&0>l.matrixWorld.determinant(),g=function(e,t,r,n,s){!0!==t.isScene&&(t=eO),u.resetTextureUnits();let l=t.fog,d=n.isMeshStandardMaterial?t.environment:null,f=null===eh?es.outputColorSpace:!0===eh.isXRRenderTarget?eh.texture.colorSpace:i.GUF,p=(n.isMeshStandardMaterial?b:c).get(n.envMap||d),g=!0===n.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,m=!!r.attributes.tangent&&(!!n.normalMap||n.anisotropy>0),v=!!r.morphAttributes.position,y=!!r.morphAttributes.normal,x=!!r.morphAttributes.color,_=i.uL9;n.toneMapped&&(null===eh||!0===eh.isXRRenderTarget)&&(_=es.toneMapping);let S=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,T=void 0!==S?S.length:0,P=h.get(n),C=er.state.lights;if(!0===eE&&(!0===eC||e!==ec)){let t=e===ec&&n.id===eu;E.setState(n,e,t)}let A=!1;n.version===P.__version?P.needsLights&&P.lightsStateVersion!==C.state.version?A=!0:P.outputColorSpace!==f?A=!0:s.isBatchedMesh&&!1===P.batching?A=!0:s.isBatchedMesh||!0!==P.batching?s.isBatchedMesh&&!0===P.batchingColor&&null===s.colorTexture?A=!0:s.isBatchedMesh&&!1===P.batchingColor&&null!==s.colorTexture?A=!0:s.isInstancedMesh&&!1===P.instancing?A=!0:s.isInstancedMesh||!0!==P.instancing?s.isSkinnedMesh&&!1===P.skinning?A=!0:s.isSkinnedMesh||!0!==P.skinning?s.isInstancedMesh&&!0===P.instancingColor&&null===s.instanceColor?A=!0:s.isInstancedMesh&&!1===P.instancingColor&&null!==s.instanceColor?A=!0:s.isInstancedMesh&&!0===P.instancingMorph&&null===s.morphTexture?A=!0:s.isInstancedMesh&&!1===P.instancingMorph&&null!==s.morphTexture?A=!0:P.envMap!==p?A=!0:!0===n.fog&&P.fog!==l?A=!0:void 0!==P.numClippingPlanes&&(P.numClippingPlanes!==E.numPlanes||P.numIntersection!==E.numIntersection)?A=!0:P.vertexAlphas!==g?A=!0:P.vertexTangents!==m?A=!0:P.morphTargets!==v?A=!0:P.morphNormals!==y?A=!0:P.morphColors!==x?A=!0:P.toneMapping!==_?A=!0:P.morphTargetsCount!==T&&(A=!0):A=!0:A=!0:A=!0:(A=!0,P.__version=n.version);let M=P.currentProgram;!0===A&&(M=e1(n,t,s));let R=!1,O=!1,k=!1,N=M.getUniforms(),L=P.uniforms;if(a.useProgram(M.program)&&(R=!0,O=!0,k=!0),n.id!==eu&&(eu=n.id,O=!0),R||ec!==e){a.buffers.depth.getReversed()?(eA.copy(e.projectionMatrix),(0,i.tNt)(eA),(0,i.yHo)(eA),N.setValue(eL,"projectionMatrix",eA)):N.setValue(eL,"projectionMatrix",e.projectionMatrix),N.setValue(eL,"viewMatrix",e.matrixWorldInverse);let t=N.map.cameraPosition;void 0!==t&&t.setValue(eL,eM.setFromMatrixPosition(e.matrixWorld)),o.logarithmicDepthBuffer&&N.setValue(eL,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&N.setValue(eL,"isOrthographic",!0===e.isOrthographicCamera),ec!==e&&(ec=e,O=!0,k=!0)}if(s.isSkinnedMesh){N.setOptional(eL,s,"bindMatrix"),N.setOptional(eL,s,"bindMatrixInverse");let e=s.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),N.setValue(eL,"boneTexture",e.boneTexture,u))}s.isBatchedMesh&&(N.setOptional(eL,s,"batchingTexture"),N.setValue(eL,"batchingTexture",s._matricesTexture,u),N.setOptional(eL,s,"batchingIdTexture"),N.setValue(eL,"batchingIdTexture",s._indirectTexture,u),N.setOptional(eL,s,"batchingColorTexture"),null!==s._colorsTexture&&N.setValue(eL,"batchingColorTexture",s._colorsTexture,u));let D=r.morphAttributes;if((void 0!==D.position||void 0!==D.normal||void 0!==D.color)&&I.update(s,r,M),(O||P.receiveShadow!==s.receiveShadow)&&(P.receiveShadow=s.receiveShadow,N.setValue(eL,"receiveShadow",s.receiveShadow)),n.isMeshGouraudMaterial&&null!==n.envMap&&(L.envMap.value=p,L.flipEnvMap.value=p.isCubeTexture&&!1===p.isRenderTargetTexture?-1:1),n.isMeshStandardMaterial&&null===n.envMap&&null!==t.environment&&(L.envMapIntensity.value=t.environmentIntensity),O&&(N.setValue(eL,"toneMappingExposure",es.toneMappingExposure),P.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(L,k),l&&!0===n.fog&&w.refreshFogUniforms(L,l),w.refreshMaterialUniforms(L,n,ey,eb,er.state.transmissionRenderTarget[e.id]),eH.upload(eL,e0(P),L,u)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(eH.upload(eL,e0(P),L,u),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&N.setValue(eL,"center",s.center),N.setValue(eL,"modelViewMatrix",s.modelViewMatrix),N.setValue(eL,"normalMatrix",s.normalMatrix),N.setValue(eL,"modelMatrix",s.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){let e=n.uniformsGroups;for(let t=0,r=e.length;t<r;t++){let r=e[t];U.update(r,M),U.bind(r,M)}}return M}(e,t,n,s,l);a.setMaterial(s,p);let m=n.index,v=1;if(!0===s.wireframe){if(void 0===(m=x.getWireframeAttribute(n)))return;v=2}let _=n.drawRange,S=n.attributes.position,T=_.start*v,P=(_.start+_.count)*v;null!==d&&(T=Math.max(T,d.start*v),P=Math.min(P,(d.start+d.count)*v)),null!==m?(T=Math.max(T,0),P=Math.min(P,m.count)):null!=S&&(T=Math.max(T,0),P=Math.min(P,S.count));let C=P-T;if(C<0||C===1/0)return;k.setup(l,s,g,n,m);let A=M;if(null!==m&&(f=y.get(m),(A=R).setIndex(f)),l.isMesh)!0===s.wireframe?(a.setLineWidth(s.wireframeLinewidth*eN()),A.setMode(eL.LINES)):A.setMode(eL.TRIANGLES);else if(l.isLine){let e=s.linewidth;void 0===e&&(e=1),a.setLineWidth(e*eN()),l.isLineSegments?A.setMode(eL.LINES):l.isLineLoop?A.setMode(eL.LINE_LOOP):A.setMode(eL.LINE_STRIP)}else l.isPoints?A.setMode(eL.POINTS):l.isSprite&&A.setMode(eL.TRIANGLES);if(l.isBatchedMesh){if(null!==l._multiDrawInstances)A.renderMultiDrawInstances(l._multiDrawStarts,l._multiDrawCounts,l._multiDrawCount,l._multiDrawInstances);else if(r.get("WEBGL_multi_draw"))A.renderMultiDraw(l._multiDrawStarts,l._multiDrawCounts,l._multiDrawCount);else{let e=l._multiDrawStarts,t=l._multiDrawCounts,r=l._multiDrawCount,i=m?y.get(m).bytesPerElement:1,n=h.get(s).currentProgram.getUniforms();for(let s=0;s<r;s++)n.setValue(eL,"_gl_DrawID",s),A.render(e[s]/i,t[s])}}else if(l.isInstancedMesh)A.renderInstances(T,C,l.count);else if(n.isInstancedBufferGeometry){let e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);A.renderInstances(T,C,t)}else A.render(T,C)},this.compile=function(e,t,r=null){null===r&&(r=e),(er=P.get(r)).init(t),en.push(er),r.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(er.pushLight(e),e.castShadow&&er.pushShadow(e))}),e!==r&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(er.pushLight(e),e.castShadow&&er.pushShadow(e))}),er.setupLights();let i=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;let t=e.material;if(t){if(Array.isArray(t))for(let n=0;n<t.length;n++){let s=t[n];ej(s,r,e),i.add(s)}else ej(t,r,e),i.add(t)}}),en.pop(),er=null,i},this.compileAsync=function(e,t,i=null){let n=this.compile(e,t,i);return new Promise(t=>{function i(){if(n.forEach(function(e){h.get(e).currentProgram.isReady()&&n.delete(e)}),0===n.size){t(e);return}setTimeout(i,10)}null!==r.get("KHR_parallel_shader_compile")?i():setTimeout(i,10)})};let eW=null;function eq(){e$.stop()}function eX(){e$.start()}let e$=new n;function eY(e,t,r,i){if(!1===e.visible)return;if(e.layers.test(t.layers)){if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)er.pushLight(e),e.castShadow&&er.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||eP.intersectsSprite(e)){i&&eR.setFromMatrixPosition(e.matrixWorld).applyMatrix4(eI);let t=_.update(e),n=e.material;n.visible&&et.push(e,t,n,r,eR.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||eP.intersectsObject(e))){let t=_.update(e),n=e.material;if(i&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),eR.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),eR.copy(t.boundingSphere.center)),eR.applyMatrix4(e.matrixWorld).applyMatrix4(eI)),Array.isArray(n)){let i=t.groups;for(let s=0,o=i.length;s<o;s++){let o=i[s],a=n[o.materialIndex];a&&a.visible&&et.push(e,t,a,r,eR.z,o)}}else n.visible&&et.push(e,t,n,r,eR.z,null)}}let n=e.children;for(let e=0,s=n.length;e<s;e++)eY(n[e],t,r,i)}function eZ(e,t,r,i){let n=e.opaque,s=e.transmissive,o=e.transparent;er.setupLightsView(r),!0===eE&&E.setGlobalState(es.clippingPlanes,r),i&&a.viewport(ed.copy(i)),n.length>0&&eJ(n,t,r),s.length>0&&eJ(s,t,r),o.length>0&&eJ(o,t,r),a.buffers.depth.setTest(!0),a.buffers.depth.setMask(!0),a.buffers.color.setMask(!0),a.setPolygonOffset(!1)}function eK(e,t,n,s){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===er.state.transmissionRenderTarget[s.id]&&(er.state.transmissionRenderTarget[s.id]=new i.dd2(1,1,{generateMipmaps:!0,type:r.has("EXT_color_buffer_half_float")||r.has("EXT_color_buffer_float")?i.cLu:i.ywz,minFilter:i.D1R,samples:4,stencilBuffer:W,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:i.epp.workingColorSpace}));let o=er.state.transmissionRenderTarget[s.id],a=s.viewport||ed;o.setSize(a.z,a.w);let l=es.getRenderTarget();es.setRenderTarget(o),es.getClearColor(eg),(em=es.getClearAlpha())<1&&es.setClearColor(0xffffff,.5),es.clear(),ek&&A.render(n);let h=es.toneMapping;es.toneMapping=i.uL9;let c=s.viewport;if(void 0!==s.viewport&&(s.viewport=void 0),er.setupLightsView(s),!0===eE&&E.setGlobalState(es.clippingPlanes,s),eJ(e,n,s),u.updateMultisampleRenderTarget(o),u.updateRenderTargetMipmap(o),!1===r.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,o=t.length;r<o;r++){let o=t[r],a=o.object,l=o.geometry,h=o.material,u=o.group;if(h.side===i.ehD&&a.layers.test(s.layers)){let t=h.side;h.side=i._Li,h.needsUpdate=!0,eQ(a,n,s,l,h,u),h.side=t,h.needsUpdate=!0,e=!0}}!0===e&&(u.updateMultisampleRenderTarget(o),u.updateRenderTargetMipmap(o))}es.setRenderTarget(l),es.setClearColor(eg,em),void 0!==c&&(s.viewport=c),es.toneMapping=h}function eJ(e,t,r){let i=!0===t.isScene?t.overrideMaterial:null;for(let n=0,s=e.length;n<s;n++){let s=e[n],o=s.object,a=s.geometry,l=null===i?s.material:i,h=s.group;o.layers.test(r.layers)&&eQ(o,t,r,a,l,h)}}function eQ(e,t,r,n,s,o){e.onBeforeRender(es,t,r,n,s,o),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),s.onBeforeRender(es,t,r,n,e,o),!0===s.transparent&&s.side===i.ehD&&!1===s.forceSinglePass?(s.side=i._Li,s.needsUpdate=!0,es.renderBufferDirect(r,t,n,s,e,o),s.side=i.Wl3,s.needsUpdate=!0,es.renderBufferDirect(r,t,n,s,e,o),s.side=i.ehD):es.renderBufferDirect(r,t,n,s,e,o),e.onAfterRender(es,t,r,n,s,o)}function e1(e,t,r){!0!==t.isScene&&(t=eO);let i=h.get(e),n=er.state.lights,s=er.state.shadowsArray,o=n.state.version,a=S.getParameters(e,n.state,s,t,r),l=S.getProgramCacheKey(a),u=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?b:c).get(e.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===u&&(e.addEventListener("dispose",ez),u=new Map,i.programs=u);let d=u.get(l);if(void 0!==d){if(i.currentProgram===d&&i.lightsStateVersion===o)return e2(e,a),d}else a.uniforms=S.getUniforms(e),e.onBeforeCompile(a,es),d=S.acquireProgram(a,l),u.set(l,d),i.uniforms=a.uniforms;let f=i.uniforms;return(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping)&&(f.clippingPlanes=E.uniform),e2(e,a),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(f.ambientLightColor.value=n.state.ambient,f.lightProbe.value=n.state.probe,f.directionalLights.value=n.state.directional,f.directionalLightShadows.value=n.state.directionalShadow,f.spotLights.value=n.state.spot,f.spotLightShadows.value=n.state.spotShadow,f.rectAreaLights.value=n.state.rectArea,f.ltc_1.value=n.state.rectAreaLTC1,f.ltc_2.value=n.state.rectAreaLTC2,f.pointLights.value=n.state.point,f.pointLightShadows.value=n.state.pointShadow,f.hemisphereLights.value=n.state.hemi,f.directionalShadowMap.value=n.state.directionalShadowMap,f.directionalShadowMatrix.value=n.state.directionalShadowMatrix,f.spotShadowMap.value=n.state.spotShadowMap,f.spotLightMatrix.value=n.state.spotLightMatrix,f.spotLightMap.value=n.state.spotLightMap,f.pointShadowMap.value=n.state.pointShadowMap,f.pointShadowMatrix.value=n.state.pointShadowMatrix),i.currentProgram=d,i.uniformsList=null,d}function e0(e){if(null===e.uniformsList){let t=e.currentProgram.getUniforms();e.uniformsList=eH.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function e2(e,t){let r=h.get(e);r.outputColorSpace=t.outputColorSpace,r.batching=t.batching,r.batchingColor=t.batchingColor,r.instancing=t.instancing,r.instancingColor=t.instancingColor,r.instancingMorph=t.instancingMorph,r.skinning=t.skinning,r.morphTargets=t.morphTargets,r.morphNormals=t.morphNormals,r.morphColors=t.morphColors,r.morphTargetsCount=t.morphTargetsCount,r.numClippingPlanes=t.numClippingPlanes,r.numIntersection=t.numClipIntersection,r.vertexAlphas=t.vertexAlphas,r.vertexTangents=t.vertexTangents,r.toneMapping=t.toneMapping}e$.setAnimationLoop(function(e){eW&&eW(e)}),"undefined"!=typeof self&&e$.setContext(self),this.setAnimationLoop=function(e){eW=e,eF.setAnimationLoop(e),null===e?e$.stop():e$.start()},eF.addEventListener("sessionstart",eq),eF.addEventListener("sessionend",eX),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!0===eo)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===eF.enabled&&!0===eF.isPresenting&&(!0===eF.cameraAutoUpdate&&eF.updateCamera(t),t=eF.getCamera()),!0===e.isScene&&e.onBeforeRender(es,e,t,eh),(er=P.get(e,en.length)).init(t),en.push(er),eI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),eP.setFromProjectionMatrix(eI),eC=this.localClippingEnabled,eE=E.init(this.clippingPlanes,eC),(et=T.get(e,ei.length)).init(),ei.push(et),!0===eF.enabled&&!0===eF.isPresenting){let e=es.xr.getDepthSensingMesh();null!==e&&eY(e,t,-1/0,es.sortObjects)}eY(e,t,0,es.sortObjects),et.finish(),!0===es.sortObjects&&et.sort(ex,e_),(ek=!1===eF.enabled||!1===eF.isPresenting||!1===eF.hasDepthSensing())&&A.addToRenderList(et,e),this.info.render.frame++,!0===eE&&E.beginShadows();let r=er.state.shadowsArray;C.render(r,e,t),!0===eE&&E.endShadows(),!0===this.info.autoReset&&this.info.reset();let i=et.opaque,n=et.transmissive;if(er.setupLights(),t.isArrayCamera){let r=t.cameras;if(n.length>0)for(let t=0,s=r.length;t<s;t++)eK(i,n,e,r[t]);ek&&A.render(e);for(let t=0,i=r.length;t<i;t++){let i=r[t];eZ(et,e,i,i.viewport)}}else n.length>0&&eK(i,n,e,t),ek&&A.render(e),eZ(et,e,t);null!==eh&&(u.updateMultisampleRenderTarget(eh),u.updateRenderTargetMipmap(eh)),!0===e.isScene&&e.onAfterRender(es,e,t),k.resetDefaultState(),eu=-1,ec=null,en.pop(),en.length>0?(er=en[en.length-1],!0===eE&&E.setGlobalState(es.clippingPlanes,er.state.camera)):er=null,ei.pop(),et=ei.length>0?ei[ei.length-1]:null};this.getActiveCubeFace=function(){return ea},this.getActiveMipmapLevel=function(){return el},this.getRenderTarget=function(){return eh},this.setRenderTargetTextures=function(e,t,i){h.get(e.texture).__webglTexture=t,h.get(e.depthTexture).__webglTexture=i;let n=h.get(e);n.__hasExternalTextures=!0,n.__autoAllocateDepthBuffer=void 0===i,!n.__autoAllocateDepthBuffer&&!0===r.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(e,t){let r=h.get(e);r.__webglFramebuffer=t,r.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,r=0){eh=e,ea=t,el=r;let i=!0,n=null,s=!1,o=!1;if(e){let l=h.get(e);if(void 0!==l.__useDefaultFramebuffer)a.bindFramebuffer(eL.FRAMEBUFFER,null),i=!1;else if(void 0===l.__webglFramebuffer)u.setupRenderTarget(e);else if(l.__hasExternalTextures)u.rebindTextures(e,h.get(e.texture).__webglTexture,h.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){let t=e.depthTexture;if(l.__boundDepthTexture!==t){if(null!==t&&h.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");u.setupDepthRenderbuffer(e)}}let c=e.texture;(c.isData3DTexture||c.isDataArrayTexture||c.isCompressedArrayTexture)&&(o=!0);let d=h.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(n=Array.isArray(d[t])?d[t][r]:d[t],s=!0):n=e.samples>0&&!1===u.useMultisampledRTT(e)?h.get(e).__webglMultisampledFramebuffer:Array.isArray(d)?d[r]:d,ed.copy(e.viewport),ef.copy(e.scissor),ep=e.scissorTest}else ed.copy(eS).multiplyScalar(ey).floor(),ef.copy(ew).multiplyScalar(ey).floor(),ep=eT;if(a.bindFramebuffer(eL.FRAMEBUFFER,n)&&i&&a.drawBuffers(e,n),a.viewport(ed),a.scissor(ef),a.setScissorTest(ep),s){let i=h.get(e.texture);eL.framebufferTexture2D(eL.FRAMEBUFFER,eL.COLOR_ATTACHMENT0,eL.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.__webglTexture,r)}else if(o){let i=h.get(e.texture);eL.framebufferTextureLayer(eL.FRAMEBUFFER,eL.COLOR_ATTACHMENT0,i.__webglTexture,r||0,t||0)}eu=-1},this.readRenderTargetPixels=function(e,t,r,i,n,s,l){if(!(e&&e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let u=h.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==l&&(u=u[l]),u){a.bindFramebuffer(eL.FRAMEBUFFER,u);try{let a=e.texture,l=a.format,h=a.type;if(!o.textureFormatReadable(l)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!o.textureTypeReadable(h)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}t>=0&&t<=e.width-i&&r>=0&&r<=e.height-n&&eL.readPixels(t,r,i,n,O.convert(l),O.convert(h),s)}finally{let e=null!==eh?h.get(eh).__webglFramebuffer:null;a.bindFramebuffer(eL.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,r,n,s,l,u){if(!(e&&e.isWebGLRenderTarget))throw Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let c=h.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==u&&(c=c[u]),c){let u=e.texture,d=u.format,f=u.type;if(!o.textureFormatReadable(d))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!o.textureTypeReadable(f))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(t>=0&&t<=e.width-n&&r>=0&&r<=e.height-s){a.bindFramebuffer(eL.FRAMEBUFFER,c);let e=eL.createBuffer();eL.bindBuffer(eL.PIXEL_PACK_BUFFER,e),eL.bufferData(eL.PIXEL_PACK_BUFFER,l.byteLength,eL.STREAM_READ),eL.readPixels(t,r,n,s,O.convert(d),O.convert(f),0);let o=null!==eh?h.get(eh).__webglFramebuffer:null;a.bindFramebuffer(eL.FRAMEBUFFER,o);let u=eL.fenceSync(eL.SYNC_GPU_COMMANDS_COMPLETE,0);return eL.flush(),await (0,i.Qey)(eL,u,4),eL.bindBuffer(eL.PIXEL_PACK_BUFFER,e),eL.getBufferSubData(eL.PIXEL_PACK_BUFFER,0,l),eL.deleteBuffer(e),eL.deleteSync(u),l}throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t=null,r=0){!0!==e.isTexture&&((0,i.O4K)("WebGLRenderer: copyFramebufferToTexture function signature has changed."),t=arguments[0]||null,e=arguments[1]);let n=Math.pow(2,-r),s=Math.floor(e.image.width*n),o=Math.floor(e.image.height*n),l=null!==t?t.x:0,h=null!==t?t.y:0;u.setTexture2D(e,0),eL.copyTexSubImage2D(eL.TEXTURE_2D,r,0,0,l,h,s,o),a.unbindTexture()};let e3=eL.createFramebuffer(),e5=eL.createFramebuffer();this.copyTextureToTexture=function(e,t,r=null,n=null,s=0,o=null){let l,c,d,f,p,g,m,v,b,y;!0!==e.isTexture&&((0,i.O4K)("WebGLRenderer: copyTextureToTexture function signature has changed."),n=arguments[0]||null,e=arguments[1],t=arguments[2],o=arguments[3]||0,r=null),null===o&&(0!==s?((0,i.O4K)("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),o=s,s=0):o=0);let x=e.isCompressedTexture?e.mipmaps[o]:e.image;if(null!==r)l=r.max.x-r.min.x,c=r.max.y-r.min.y,d=r.isBox3?r.max.z-r.min.z:1,f=r.min.x,p=r.min.y,g=r.isBox3?r.min.z:0;else{let t=Math.pow(2,-s);l=Math.floor(x.width*t),c=Math.floor(x.height*t),d=e.isDataArrayTexture?x.depth:e.isData3DTexture?Math.floor(x.depth*t):1,f=0,p=0,g=0}null!==n?(m=n.x,v=n.y,b=n.z):(m=0,v=0,b=0);let _=O.convert(t.format),S=O.convert(t.type);t.isData3DTexture?(u.setTexture3D(t,0),y=eL.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(u.setTexture2DArray(t,0),y=eL.TEXTURE_2D_ARRAY):(u.setTexture2D(t,0),y=eL.TEXTURE_2D),eL.pixelStorei(eL.UNPACK_FLIP_Y_WEBGL,t.flipY),eL.pixelStorei(eL.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),eL.pixelStorei(eL.UNPACK_ALIGNMENT,t.unpackAlignment);let w=eL.getParameter(eL.UNPACK_ROW_LENGTH),T=eL.getParameter(eL.UNPACK_IMAGE_HEIGHT),P=eL.getParameter(eL.UNPACK_SKIP_PIXELS),E=eL.getParameter(eL.UNPACK_SKIP_ROWS),C=eL.getParameter(eL.UNPACK_SKIP_IMAGES);eL.pixelStorei(eL.UNPACK_ROW_LENGTH,x.width),eL.pixelStorei(eL.UNPACK_IMAGE_HEIGHT,x.height),eL.pixelStorei(eL.UNPACK_SKIP_PIXELS,f),eL.pixelStorei(eL.UNPACK_SKIP_ROWS,p),eL.pixelStorei(eL.UNPACK_SKIP_IMAGES,g);let A=e.isDataArrayTexture||e.isData3DTexture,I=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){let r=h.get(e),i=h.get(t),n=h.get(r.__renderTarget),u=h.get(i.__renderTarget);a.bindFramebuffer(eL.READ_FRAMEBUFFER,n.__webglFramebuffer),a.bindFramebuffer(eL.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let r=0;r<d;r++)A&&(eL.framebufferTextureLayer(eL.READ_FRAMEBUFFER,eL.COLOR_ATTACHMENT0,h.get(e).__webglTexture,s,g+r),eL.framebufferTextureLayer(eL.DRAW_FRAMEBUFFER,eL.COLOR_ATTACHMENT0,h.get(t).__webglTexture,o,b+r)),eL.blitFramebuffer(f,p,l,c,m,v,l,c,eL.DEPTH_BUFFER_BIT,eL.NEAREST);a.bindFramebuffer(eL.READ_FRAMEBUFFER,null),a.bindFramebuffer(eL.DRAW_FRAMEBUFFER,null)}else if(0!==s||e.isRenderTargetTexture||h.has(e)){let r=h.get(e),i=h.get(t);a.bindFramebuffer(eL.READ_FRAMEBUFFER,e3),a.bindFramebuffer(eL.DRAW_FRAMEBUFFER,e5);for(let e=0;e<d;e++)A?eL.framebufferTextureLayer(eL.READ_FRAMEBUFFER,eL.COLOR_ATTACHMENT0,r.__webglTexture,s,g+e):eL.framebufferTexture2D(eL.READ_FRAMEBUFFER,eL.COLOR_ATTACHMENT0,eL.TEXTURE_2D,r.__webglTexture,s),I?eL.framebufferTextureLayer(eL.DRAW_FRAMEBUFFER,eL.COLOR_ATTACHMENT0,i.__webglTexture,o,b+e):eL.framebufferTexture2D(eL.DRAW_FRAMEBUFFER,eL.COLOR_ATTACHMENT0,eL.TEXTURE_2D,i.__webglTexture,o),0!==s?eL.blitFramebuffer(f,p,l,c,m,v,l,c,eL.COLOR_BUFFER_BIT,eL.NEAREST):I?eL.copyTexSubImage3D(y,o,m,v,b+e,f,p,l,c):eL.copyTexSubImage2D(y,o,m,v,f,p,l,c);a.bindFramebuffer(eL.READ_FRAMEBUFFER,null),a.bindFramebuffer(eL.DRAW_FRAMEBUFFER,null)}else I?e.isDataTexture||e.isData3DTexture?eL.texSubImage3D(y,o,m,v,b,l,c,d,_,S,x.data):t.isCompressedArrayTexture?eL.compressedTexSubImage3D(y,o,m,v,b,l,c,d,_,x.data):eL.texSubImage3D(y,o,m,v,b,l,c,d,_,S,x):e.isDataTexture?eL.texSubImage2D(eL.TEXTURE_2D,o,m,v,l,c,_,S,x.data):e.isCompressedTexture?eL.compressedTexSubImage2D(eL.TEXTURE_2D,o,m,v,x.width,x.height,_,x.data):eL.texSubImage2D(eL.TEXTURE_2D,o,m,v,l,c,_,S,x);eL.pixelStorei(eL.UNPACK_ROW_LENGTH,w),eL.pixelStorei(eL.UNPACK_IMAGE_HEIGHT,T),eL.pixelStorei(eL.UNPACK_SKIP_PIXELS,P),eL.pixelStorei(eL.UNPACK_SKIP_ROWS,E),eL.pixelStorei(eL.UNPACK_SKIP_IMAGES,C),0===o&&t.generateMipmaps&&eL.generateMipmap(y),a.unbindTexture()},this.copyTextureToTexture3D=function(e,t,r=null,n=null,s=0){return!0!==e.isTexture&&((0,i.O4K)("WebGLRenderer: copyTextureToTexture3D function signature has changed."),r=arguments[0]||null,n=arguments[1]||null,e=arguments[2],t=arguments[3],s=arguments[4]||0),(0,i.O4K)('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(e,t,r,n,s)},this.initRenderTarget=function(e){void 0===h.get(e).__webglFramebuffer&&u.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?u.setTextureCube(e,0):e.isData3DTexture?u.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?u.setTexture2DArray(e,0):u.setTexture2D(e,0),a.unbindTexture()},this.resetState=function(){ea=0,el=0,eh=null,a.reset(),k.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return i._RZ}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorspace=i.epp._getDrawingBufferColorSpace(e),t.unpackColorSpace=i.epp._getUnpackColorSpace()}}},889:function(e,t,r){"use strict";r.d(t,{S:function(){return b}});var i=r(591);let n=new i.JOQ,s=new i.FM8,o=new i.Pa4,a=new i.FM8,l=new i.FM8,h=new i.Pa4,u=new i.Pa4,c=new i.yGw,d=new i.Pa4,f=new i.Pa4,p=null,g=null,m=[],v={NONE:-1,PAN:0,ROTATE:1};class b extends i.ZXd{constructor(e,t,r=null){super(t,r),this.objects=e,this.recursive=!0,this.transformGroup=!1,this.rotateSpeed=1,this.raycaster=new i.iMs,this.mouseButtons={LEFT:i.RsA.PAN,MIDDLE:i.RsA.PAN,RIGHT:i.RsA.ROTATE},this.touches={ONE:i.QmN.PAN},this._onPointerMove=y.bind(this),this._onPointerDown=x.bind(this),this._onPointerCancel=_.bind(this),this._onContextMenu=S.bind(this),null!==r&&this.connect()}connect(){this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerCancel),this.domElement.addEventListener("pointerleave",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerCancel),this.domElement.removeEventListener("pointerleave",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto",this.domElement.style.cursor=""}dispose(){this.disconnect()}_updatePointer(e){let t=this.domElement.getBoundingClientRect();s.x=(e.clientX-t.left)/t.width*2-1,s.y=-(e.clientY-t.top)/t.height*2+1}_updateState(e){let t;if("touch"===e.pointerType)t=this.touches.ONE;else switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=null}switch(t){case i.RsA.PAN:case i.QmN.PAN:this.state=v.PAN;break;case i.RsA.ROTATE:case i.QmN.ROTATE:this.state=v.ROTATE;break;default:this.state=v.NONE}}getRaycaster(){return console.warn("THREE.DragControls: getRaycaster() has been deprecated. Use controls.raycaster instead."),this.raycaster}setObjects(e){console.warn("THREE.DragControls: setObjects() has been deprecated. Use controls.objects instead."),this.objects=e}getObjects(){return console.warn("THREE.DragControls: getObjects() has been deprecated. Use controls.objects instead."),this.objects}activate(){console.warn("THREE.DragControls: activate() has been renamed to connect()."),this.connect()}deactivate(){console.warn("THREE.DragControls: deactivate() has been renamed to disconnect()."),this.disconnect()}set mode(e){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}get mode(){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}}function y(e){let t=this.object,r=this.domElement,i=this.raycaster;if(!1!==this.enabled){if(this._updatePointer(e),i.setFromCamera(s,t),p)this.state===v.PAN?i.ray.intersectPlane(n,h)&&p.position.copy(h.sub(o).applyMatrix4(c)):this.state===v.ROTATE&&(a.subVectors(s,l).multiplyScalar(this.rotateSpeed),p.rotateOnWorldAxis(d,a.x),p.rotateOnWorldAxis(f.normalize(),-a.y)),this.dispatchEvent({type:"drag",object:p}),l.copy(s);else if("mouse"===e.pointerType||"pen"===e.pointerType){if(m.length=0,i.setFromCamera(s,t),i.intersectObjects(this.objects,this.recursive,m),m.length>0){let e=m[0].object;n.setFromNormalAndCoplanarPoint(t.getWorldDirection(n.normal),u.setFromMatrixPosition(e.matrixWorld)),g!==e&&null!==g&&(this.dispatchEvent({type:"hoveroff",object:g}),r.style.cursor="auto",g=null),g!==e&&(this.dispatchEvent({type:"hoveron",object:e}),r.style.cursor="pointer",g=e)}else null!==g&&(this.dispatchEvent({type:"hoveroff",object:g}),r.style.cursor="auto",g=null)}l.copy(s)}}function x(e){let t=this.object,r=this.domElement,i=this.raycaster;!1!==this.enabled&&(this._updatePointer(e),this._updateState(e),m.length=0,i.setFromCamera(s,t),i.intersectObjects(this.objects,this.recursive,m),m.length>0&&(p=!0===this.transformGroup?function e(t,r=null){return(t.isGroup&&(r=t),null===t.parent)?r:e(t.parent,r)}(m[0].object):m[0].object,n.setFromNormalAndCoplanarPoint(t.getWorldDirection(n.normal),u.setFromMatrixPosition(p.matrixWorld)),i.ray.intersectPlane(n,h)&&(this.state===v.PAN?(c.copy(p.parent.matrixWorld).invert(),o.copy(h).sub(u.setFromMatrixPosition(p.matrixWorld))):this.state===v.ROTATE&&(d.set(0,1,0).applyQuaternion(t.quaternion).normalize(),f.set(1,0,0).applyQuaternion(t.quaternion).normalize())),r.style.cursor="move",this.dispatchEvent({type:"dragstart",object:p})),l.copy(s))}function _(){!1!==this.enabled&&(p&&(this.dispatchEvent({type:"dragend",object:p}),p=null),this.domElement.style.cursor=g?"pointer":"auto",this.state=v.NONE)}function S(e){!1!==this.enabled&&e.preventDefault()}},526:function(e,t,r){"use strict";r.d(t,{z:function(){return f}});var i=r(591);let n={type:"change"},s={type:"start"},o={type:"end"},a=new i.zHn,l=new i.JOQ,h=Math.cos(70*i.M8C.DEG2RAD),u=new i.Pa4,c=2*Math.PI,d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};class f extends i.ZXd{constructor(e,t=null){super(e,t),this.state=d.NONE,this.enabled=!0,this.target=new i.Pa4,this.cursor=new i.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:i.RsA.ROTATE,MIDDLE:i.RsA.DOLLY,RIGHT:i.RsA.PAN},this.touches={ONE:i.QmN.ROTATE,TWO:i.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new i.Pa4,this._lastQuaternion=new i._fP,this._lastTargetPosition=new i.Pa4,this._quat=new i._fP().setFromUnitVectors(e.up,new i.Pa4(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new i.$V,this._sphericalDelta=new i.$V,this._scale=1,this._panOffset=new i.Pa4,this._rotateStart=new i.FM8,this._rotateEnd=new i.FM8,this._rotateDelta=new i.FM8,this._panStart=new i.FM8,this._panEnd=new i.FM8,this._panDelta=new i.FM8,this._dollyStart=new i.FM8,this._dollyEnd=new i.FM8,this._dollyDelta=new i.FM8,this._dollyDirection=new i.Pa4,this._mouse=new i.FM8,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=g.bind(this),this._onPointerDown=p.bind(this),this._onPointerUp=m.bind(this),this._onContextMenu=w.bind(this),this._onMouseWheel=y.bind(this),this._onKeyDown=x.bind(this),this._onTouchStart=_.bind(this),this._onTouchMove=S.bind(this),this._onMouseDown=v.bind(this),this._onMouseMove=b.bind(this),this._interceptControlDown=T.bind(this),this._interceptControlUp=P.bind(this),null!==this.domElement&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(n),this.update(),this.state=d.NONE}update(e=null){let t=this.object.position;u.copy(t).sub(this.target),u.applyQuaternion(this._quat),this._spherical.setFromVector3(u),this.autoRotate&&this.state===d.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let r=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(r)&&isFinite(s)&&(r<-Math.PI?r+=c:r>Math.PI&&(r-=c),s<-Math.PI?s+=c:s>Math.PI&&(s-=c),r<=s?this._spherical.theta=Math.max(r,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(r+s)/2?Math.max(r,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{let e=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=e!=this._spherical.radius}if(u.setFromSpherical(this._spherical),u.applyQuaternion(this._quatInverse),t.copy(this.target).add(u),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let e=null;if(this.object.isPerspectiveCamera){let t=u.length();e=this._clampDistance(t*this._scale);let r=t-e;this.object.position.addScaledVector(this._dollyDirection,r),this.object.updateMatrixWorld(),o=!!r}else if(this.object.isOrthographicCamera){let t=new i.Pa4(this._mouse.x,this._mouse.y,0);t.unproject(this.object);let r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=r!==this.object.zoom;let n=new i.Pa4(this._mouse.x,this._mouse.y,0);n.unproject(this.object),this.object.position.sub(n).add(t),this.object.updateMatrixWorld(),e=u.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==e&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(e).add(this.object.position):(a.origin.copy(this.object.position),a.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(a.direction))<h?this.object.lookAt(this.target):(l.setFromNormalAndCoplanarPoint(this.object.up,this.target),a.intersectPlane(l,this.target))))}else if(this.object.isOrthographicCamera){let e=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),e!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,!!(o||this._lastPosition.distanceToSquared(this.object.position)>1e-6||8*(1-this._lastQuaternion.dot(this.object.quaternion))>1e-6||this._lastTargetPosition.distanceToSquared(this.target)>1e-6)&&(this.dispatchEvent(n),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?c/60*this.autoRotateSpeed*e:c/60/60*this.autoRotateSpeed}_getZoomScale(e){let t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){u.setFromMatrixColumn(t,0),u.multiplyScalar(-e),this._panOffset.add(u)}_panUp(e,t){!0===this.screenSpacePanning?u.setFromMatrixColumn(t,1):(u.setFromMatrixColumn(t,0),u.crossVectors(this.object.up,u)),u.multiplyScalar(e),this._panOffset.add(u)}_pan(e,t){let r=this.domElement;if(this.object.isPerspectiveCamera){let i=this.object.position;u.copy(i).sub(this.target);let n=u.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*n/r.clientHeight,this.object.matrix),this._panUp(2*t*n/r.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;let r=this.domElement.getBoundingClientRect(),i=e-r.left,n=t-r.top,s=r.width,o=r.height;this._mouse.x=i/s*2-1,this._mouse.y=-(n/o*2)+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(c*this._rotateDelta.x/t.clientHeight),this._rotateUp(c*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(c*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-c*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(c*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-c*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._rotateStart.set(r,i)}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panStart.set(r,i)}}_handleTouchStartDolly(e){let t=this._getSecondPointerPosition(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this._dollyStart.set(0,n)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._rotateEnd.set(r,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(c*this._rotateDelta.x/t.clientHeight),this._rotateUp(c*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panEnd.set(r,i)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){let t=this._getSecondPointerPosition(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this._dollyEnd.set(0,n),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);let s=(e.pageX+t.x)*.5,o=(e.pageY+t.y)*.5;this._updateZoomParameters(s,o)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new i.FM8,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){let t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){let t=e.deltaMode,r={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:r.deltaY*=16;break;case 2:r.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(r.deltaY*=10),r}}function p(e){if(!1!==this.enabled)0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(e)&&(this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e))}function g(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function m(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(o),this.state=d.NONE;break;case 1:let t=this._pointers[0],r=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:r.x,pageY:r.y})}}function v(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case i.RsA.DOLLY:if(!1===this.enableZoom)return;this._handleMouseDownDolly(e),this.state=d.DOLLY;break;case i.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=d.PAN}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=d.ROTATE}break;case i.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=d.ROTATE}else{if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=d.PAN}break;default:this.state=d.NONE}this.state!==d.NONE&&this.dispatchEvent(s)}function b(e){switch(this.state){case d.ROTATE:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(e);break;case d.DOLLY:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(e);break;case d.PAN:if(!1===this.enablePan)return;this._handleMouseMovePan(e)}}function y(e){!1!==this.enabled&&!1!==this.enableZoom&&this.state===d.NONE&&(e.preventDefault(),this.dispatchEvent(s),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(o))}function x(e){!1!==this.enabled&&this._handleKeyDown(e)}function _(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case i.QmN.ROTATE:if(!1===this.enableRotate)return;this._handleTouchStartRotate(e),this.state=d.TOUCH_ROTATE;break;case i.QmN.PAN:if(!1===this.enablePan)return;this._handleTouchStartPan(e),this.state=d.TOUCH_PAN;break;default:this.state=d.NONE}break;case 2:switch(this.touches.TWO){case i.QmN.DOLLY_PAN:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(e),this.state=d.TOUCH_DOLLY_PAN;break;case i.QmN.DOLLY_ROTATE:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(e),this.state=d.TOUCH_DOLLY_ROTATE;break;default:this.state=d.NONE}break;default:this.state=d.NONE}this.state!==d.NONE&&this.dispatchEvent(s)}function S(e){switch(this._trackPointer(e),this.state){case d.TOUCH_ROTATE:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(e),this.update();break;case d.TOUCH_PAN:if(!1===this.enablePan)return;this._handleTouchMovePan(e),this.update();break;case d.TOUCH_DOLLY_PAN:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(e),this.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=d.NONE}}function w(e){!1!==this.enabled&&e.preventDefault()}function T(e){"Control"===e.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function P(e){"Control"===e.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}},509:function(e,t,r){"use strict";r.d(t,{M:function(){return n}});var i=r(591);class n extends i.O7d{constructor(e,t={}){let r=t.font;if(void 0===r)super();else{let i=r.generateShapes(e,t.size);void 0===t.depth&&void 0!==t.height&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),t.depth=void 0!==t.depth?t.depth:void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(i,t)}this.type="TextGeometry"}}},641:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});var i=r(591);class n extends i.aNw{constructor(e){super(e)}load(e,t,r,n){let s=this,o=new i.hH6(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(e){let r=s.parse(JSON.parse(e));t&&t(r)},r,n)}parse(e){return new s(e)}}class s{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){let r=[],n=function(e,t,r){let n=Array.from(e),s=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*s,a=[],l=0,h=0;for(let e=0;e<n.length;e++){let t=n[e];if("\n"===t)l=0,h-=o;else{let e=function(e,t,r,n,s){let o,a,l,h,u,c,d,f;let p=s.glyphs[e]||s.glyphs["?"];if(!p){console.error('THREE.Font: character "'+e+'" does not exists in font family '+s.familyName+".");return}let g=new i.T_1;if(p.o){let e=p._cachedOutline||(p._cachedOutline=p.o.split(" "));for(let i=0,s=e.length;i<s;)switch(e[i++]){case"m":o=e[i++]*t+r,a=e[i++]*t+n,g.moveTo(o,a);break;case"l":o=e[i++]*t+r,a=e[i++]*t+n,g.lineTo(o,a);break;case"q":l=e[i++]*t+r,h=e[i++]*t+n,u=e[i++]*t+r,c=e[i++]*t+n,g.quadraticCurveTo(u,c,l,h);break;case"b":l=e[i++]*t+r,h=e[i++]*t+n,u=e[i++]*t+r,c=e[i++]*t+n,d=e[i++]*t+r,f=e[i++]*t+n,g.bezierCurveTo(u,c,d,f,l,h)}}return{offsetX:p.ha*t,path:g}}(t,s,l,h,r);l+=e.offsetX,a.push(e.path)}}return a}(e,t,this.data);for(let e=0,t=n.length;e<t;e++)r.push(...n[e].toShapes());return r}}}}]);